examples/multimodal/pretrain-freeze-llm-hete-2080first.sh: line 4: activate: No such file or directory
2
[2025-01-02 13:27:44,907] torch.distributed.run: [WARNING] 
[2025-01-02 13:27:44,907] torch.distributed.run: [WARNING] *****************************************
[2025-01-02 13:27:44,907] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2025-01-02 13:27:44,907] torch.distributed.run: [WARNING] *****************************************
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
------pipeline_parallel_model_size:3------
------world_size:12------
------total_model_size:6------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:3------
------world_size:12------
------total_model_size:6------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:3------
------world_size:12------
------total_model_size:6------
------num_pipeline_model_parallel_groups:4------
> setting tensorboard ...
WARNING: one_logger package is required to enable e2e metrics tracking. please go to https://confluence.nvidia.com/display/MLWFO/Package+Repositories for details to install it
------pipeline_parallel_model_size:3------
------world_size:12------
------total_model_size:6------
------num_pipeline_model_parallel_groups:4------
---Rank 9---Tensor Parallel Group GPUs: [1, 1]
---Rank 8---Tensor Parallel Group GPUs: [0, 0]
---Rank 9---Pipeline Parallel Group GPUs: [2, 2, 2]
---Rank 8---Pipeline Parallel Group GPUs: [2, 2, 2]
[rank9]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank8]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
---Rank 10---Tensor Parallel Group GPUs: [0, 0]
---Rank 10---Pipeline Parallel Group GPUs: [2, 2, 2]
---Rank 11---Tensor Parallel Group GPUs: [1, 1]
---Rank 11---Pipeline Parallel Group GPUs: [2, 2, 2]
[rank10]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank11]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
 > number of parameters on (tensor, pipeline) model parallel rank (1, 2): 394293248
 > number of parameters on (tensor, pipeline) model parallel rank (0, 2): 394293248
INFO:megatron.core.distributed.param_and_grad_buffer:Number of buckets for gradient all-reduce / reduce-scatter: 1
Params for bucket 1 (394293248 elements):
	language_model.decoder.layers.1.mlp.linear_fc1.weight
	language_model.decoder.layers.0.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.2.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.1.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.0.mlp.linear_fc2.weight
	language_model.decoder.layers.0.self_attention.linear_proj.weight
	language_model.decoder.final_layernorm.weight
	language_model.decoder.layers.2.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.1.self_attention.linear_qkv.weight
	language_model.decoder.layers.2.mlp.linear_fc2.weight
	language_model.decoder.layers.1.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.0.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.2.self_attention.linear_proj.weight
	language_model.decoder.layers.0.self_attention.linear_qkv.weight
	language_model.output_layer.weight
	language_model.decoder.layers.1.self_attention.linear_proj.weight
	language_model.decoder.layers.0.mlp.linear_fc1.weight
	language_model.decoder.layers.2.mlp.linear_fc1.weight
	language_model.decoder.layers.2.self_attention.linear_qkv.weight
	language_model.decoder.layers.1.mlp.linear_fc2.weight
rank=1, worker=0: shard_range=[pretrain-31.tar[0, 100), pretrain-31.tar[100, 200), pretrain-31.tar[200, 300), ...<1244>, pretrain-42.tar[4700, 4800), pretrain-42.tar[4800, 4900), pretrain-42.tar[4900, 5000)] sum(count)=125000
rank=1, worker=1: shard_range=[pretrain-42.tar[5000, 5100), pretrain-42.tar[5100, 5200), pretrain-42.tar[5200, 5300), ...<1244>, pretrain-53.tar[9700, 9800), pretrain-53.tar[9800, 9900), pretrain-53.tar[9900, 10000)] sum(count)=125000
rank=0, worker=0: shard_range=[pretrain-0.tar[0, 100), pretrain-0.tar[100, 200), pretrain-0.tar[200, 300), ...<1244>, pretrain-2.tar[4700, 4800), pretrain-2.tar[4800, 4900), pretrain-2.tar[4900, 5000)] sum(count)=125000
rank=0, worker=1: shard_range=[pretrain-2.tar[5000, 5100), pretrain-2.tar[5100, 5200), pretrain-2.tar[5200, 5300), ...<1244>, pretrain-30.tar[9700, 9800), pretrain-30.tar[9800, 9900), pretrain-30.tar[9900, 10000)] sum(count)=125000
rank=1, worker=0: shard_range=[pretrain-7.tar[936, 10000), pretrain-8.tar[0, 5468)] sum(count)=14532
rank=1, worker=1: shard_range=[pretrain-8.tar[5468, 10000), pretrain-9.tar[0, 10000)] sum(count)=14532
rank=0, worker=0: shard_range=[pretrain-54.tar[0, 10000), pretrain-55.tar[0, 4532)] sum(count)=14532
rank=0, worker=1: shard_range=[pretrain-55.tar[4532, 8128), pretrain-6.tar[0, 10000), pretrain-7.tar[0, 936)] sum(count)=14532
times across ranks (ms):
  model-and-optimizer-setup:
     rank  0: 103.29
     rank  1: 101.86
     rank  2: 106.94
     rank  3: 101.10
     rank  4: 65.29
     rank  5: 69.83
     rank  6: 44.41
     rank  7: 65.45
     rank  8: 63.50
     rank  9: 62.45
     rank 10: 66.25
     rank 11: 67.59
  train/valid/test-data-iterators-setup:
     rank  0: 1000.59
     rank  1: 1000.88
     rank  2: 1391.31
     rank  3: 1000.59
     rank  4: 1194.77
     rank  5: 1195.19
     rank  6: 1194.78
     rank  7: 1194.81
     rank  8: 1391.23
     rank  9: 1393.05
     rank 10: 1333.31
     rank 11: 1392.18
 [2025-01-02 13:28:22] iteration        1/      10 | consumed samples:           32 | elapsed time per iteration (ms): 13018.1 | learning rate: 7.500000E-07 | global batch size:    32 | lm loss: 6.978814E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |[Rank 9] (after 1 iterations) memory (MB) | allocated: 6069.6904296875 | max allocated: 7573.478515625 | reserved: 8092.0 | max reserved: 8092.0

stage3 GPU utialization:67.23613739013672 %
[Rank 8] (after 1 iterations) memory (MB) | allocated: 6069.6904296875 | max allocated: 7573.478515625 | reserved: 8092.0 | max reserved: 8092.0
times across ranks (ms):
  forward-backward:
     rank  0: 12786.17
     rank  1: 12785.57
     rank  2: 12787.57
     rank  3: 12786.24
     rank  4: 12788.21
     rank  5: 12788.26
     rank  6: 12788.29
     rank  7: 12788.19
     rank  8: 12784.81
     rank  9: 12785.11
     rank 10: 12784.81
     rank 11: 12786.00
  forward-compute:
     rank  0: 3597.44
     rank  1: 3591.43
     rank  2: 3672.65
     rank  3: 3682.59
     rank  4: 3945.14
     rank  5: 3940.86
     rank  6: 3613.85
     rank  7: 3622.51
     rank  8: 3078.36
     rank  9: 3087.69
     rank 10: 3302.51
     rank 11: 3314.41
  backward-compute:
     rank  0: 2314.39
     rank  1: 2316.58
     rank  2: 2313.57
     rank  3: 2311.39
     rank  4: 2651.67
     rank  5: 2661.11
     rank  6: 2694.62
     rank  7: 2702.35
     rank  8: 2293.49
     rank  9: 2288.49
     rank 10: 2232.25
     rank 11: 2227.61
  pure-backward-compute:
     rank  0: 2313.48
     rank  1: 2315.61
     rank  2: 2312.59
     rank  3: 2310.49
     rank  4: 2649.88
     rank  5: 2659.17
     rank  6: 2693.16
     rank  7: 2700.70
     rank  8: 2290.33
     rank  9: 2285.51
     rank 10: 2228.19
     rank 11: 2223.27
  batch-generator:
     rank  0: 970.97
     rank  1: 979.30
     rank  2: 1043.52
     rank  3: 1052.50
     rank  4: 1052.52
     rank  5: 1061.56
     rank  6: 1057.41
     rank  7: 1063.23
     rank  8: 1357.65
     rank  9: 1361.24
     rank 10: 1447.20
     rank 11: 1468.40
  forward-recv:
     rank  4: 2157.61
     rank  5: 2156.56
     rank  6: 2212.78
     rank  7: 2208.06
     rank  8: 4404.66
     rank  9: 4408.39
     rank 10: 4137.80
     rank 11: 4135.08
  forward-send:
     rank  0: 2271.33
     rank  1: 2274.90
     rank  2: 1951.97
     rank  3: 1944.76
     rank  4: 23.09
     rank  5: 26.80
     rank  6: 27.13
     rank  7: 24.50
  backward-recv:
     rank  0: 357.38
     rank  1: 357.73
     rank  2: 343.30
     rank  3: 344.58
     rank  4: 81.46
     rank  5: 80.18
     rank  6: 72.30
     rank  7: 71.26
  backward-send:
     rank  4: 4.62
     rank  5: 5.49
     rank  6: 2.63
     rank  7: 3.23
     rank  8: 3.27
     rank  9: 2.83
     rank 10: 3.26
     rank 11: 2.94
  forward-send-backward-recv:
     rank  0: 2991.92
     rank  1: 2987.23
     rank  2: 3247.47
     rank  3: 3245.77
     rank  4: 1779.51
     rank  5: 1772.64
     rank  6: 2031.68
     rank  7: 2025.46
  backward-send-forward-recv:
     rank  4: 799.31
     rank  5: 798.52
     rank  6: 787.19
     rank  7: 784.55
     rank  8: 1499.80
     rank  9: 1492.57
     rank 10: 1597.70
     rank 11: 1594.17
  layernorm-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.09
     rank  2: 0.14
     rank  3: 0.11
     rank  4: 0.03
     rank  5: 0.09
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.07
     rank  9: 0.06
     rank 10: 0.05
     rank 11: 0.12
  embedding-grads-all-reduce:
     rank  0: 0.08
     rank  1: 0.12
     rank  2: 0.17
     rank  3: 0.16
     rank  4: 0.04
     rank  5: 0.06
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.17
     rank  9: 0.14
     rank 10: 0.10
     rank 11: 0.20
  all-grads-sync:
     rank  0: 416.88
     rank  1: 396.32
     rank  2: 416.87
     rank  3: 396.34
     rank  4: 1226.30
     rank  5: 1226.44
     rank  6: 1226.30
     rank  7: 1226.35
     rank  8: 634.97
     rank  9: 624.05
     rank 10: 634.89
     rank 11: 624.02
  optimizer-copy-to-main-grad:
     rank  0: 0.29
     rank  1: 0.39
     rank  2: 0.50
     rank  3: 0.39
     rank  4: 0.08
     rank  5: 0.14
     rank  6: 0.08
     rank  7: 0.07
     rank  8: 0.07
     rank  9: 0.11
     rank 10: 0.10
     rank 11: 0.09
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.04
     rank 10: 0.02
     rank 11: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
  optimizer-inner-step:
     rank  0: 56.13
     rank  1: 56.04
     rank  2: 56.24
     rank  3: 56.25
     rank  4: 214.78
     rank  5: 222.10
     rank  6: 218.43
     rank  7: 215.49
     rank  8: 81.16
     rank  9: 80.39
     rank 10: 83.64
     rank 11: 82.89
  optimizer:
     rank  0: 57.55
     rank  1: 57.44
     rank  2: 57.64
     rank  3: 57.66
     rank  4: 216.20
     rank  5: 223.51
     rank  6: 219.84
     rank  7: 216.90
     rank  8: 82.56
     rank  9: 81.79
     rank 10: 85.04
     rank 11: 84.29
 [2025-01-02 13:28:28] iteration        2/      10 | consumed samples:           64 | elapsed time per iteration (ms): 6111.5 | learning rate: 1.500000E-06 | global batch size:    32 | lm loss: 6.998645E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 5969.67
     rank  1: 5969.74
     rank  2: 5969.65
     rank  3: 5969.88
     rank  4: 5975.96
     rank  5: 5975.91
     rank  6: 5975.89
     rank  7: 5975.88
     rank  8: 5972.44
     rank  9: 5972.14
     rank 10: 5972.24
     rank 11: 5972.23
  forward-compute:
     rank  0: 1877.08
     rank  1: 1875.58
     rank  2: 1902.88
     rank  3: 1902.65
     rank  4: 1772.67
     rank  5: 1779.82
     rank  6: 1807.77
     rank  7: 1805.99
     rank  8: 1565.58
     rank  9: 1577.43
     rank 10: 1540.49
     rank 11: 1533.60
  backward-compute:
     rank  0: 1477.56
     rank  1: 1483.90
     rank  2: 1516.93
     rank  3: 1513.72
     rank  4: 2659.30
     rank  5: 2673.27
     rank  6: 2692.65
     rank  7: 2689.09
     rank  8: 2281.13
     rank  9: 2278.83
     rank 10: 2214.58
     rank 11: 2212.68
  pure-backward-compute:
     rank  0: 1476.78
     rank  1: 1482.99
     rank  2: 1516.07
     rank  3: 1512.88
     rank  4: 2658.43
     rank  5: 2672.26
     rank  6: 2691.66
     rank  7: 2687.89
     rank  8: 2277.03
     rank  9: 2275.95
     rank 10: 2211.02
     rank 11: 2207.41
  batch-generator:
     rank  0: 70.33
     rank  1: 73.49
     rank  2: 74.81
     rank  3: 83.00
     rank  4: 51.63
     rank  5: 61.53
     rank  6: 56.20
     rank  7: 59.79
     rank  8: 68.08
     rank  9: 82.11
     rank 10: 66.54
     rank 11: 63.25
  forward-recv:
     rank  4: 105.47
     rank  5: 105.38
     rank  6: 109.04
     rank  7: 108.90
     rank  8: 223.53
     rank  9: 223.23
     rank 10: 226.94
     rank 11: 227.07
  forward-send:
     rank  0: 14.62
     rank  1: 13.97
     rank  2: 14.59
     rank  3: 14.53
     rank  4: 6.73
     rank  5: 6.32
     rank  6: 7.25
     rank  7: 7.33
  backward-recv:
     rank  0: 349.14
     rank  1: 348.95
     rank  2: 332.62
     rank  3: 333.50
     rank  4: 77.48
     rank  5: 77.45
     rank  6: 64.31
     rank  7: 64.71
  backward-send:
     rank  4: 4.97
     rank  5: 4.95
     rank  6: 3.09
     rank  7: 2.84
     rank  8: 3.00
     rank  9: 2.60
     rank 10: 2.94
     rank 11: 3.22
  forward-send-backward-recv:
     rank  0: 1427.98
     rank  1: 1420.35
     rank  2: 1377.96
     rank  3: 1379.77
     rank  4: 256.12
     rank  5: 242.92
     rank  6: 208.57
     rank  7: 213.00
  backward-send-forward-recv:
     rank  4: 178.78
     rank  5: 171.62
     rank  6: 166.17
     rank  7: 166.04
     rank  8: 821.17
     rank  9: 813.51
     rank 10: 905.36
     rank 11: 912.69
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.05
     rank  4: 0.04
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.08
     rank  9: 0.04
     rank 10: 0.03
     rank 11: 0.07
  embedding-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.07
     rank  2: 0.06
     rank  3: 0.11
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.22
     rank  9: 0.08
     rank 10: 0.06
     rank 11: 0.16
  all-grads-sync:
     rank  0: 307.78
     rank  1: 295.25
     rank  2: 307.74
     rank  3: 295.27
     rank  4: 801.89
     rank  5: 802.34
     rank  6: 801.87
     rank  7: 802.34
     rank  8: 611.59
     rank  9: 594.12
     rank 10: 611.50
     rank 11: 594.17
  optimizer-copy-to-main-grad:
     rank  0: 0.25
     rank  1: 0.26
     rank  2: 0.28
     rank  3: 0.45
     rank  4: 0.10
     rank  5: 0.06
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.07
     rank  9: 0.09
     rank 10: 0.04
     rank 11: 0.10
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
  optimizer-inner-step:
     rank  0: 37.05
     rank  1: 36.85
     rank  2: 36.96
     rank  3: 37.17
     rank  4: 102.97
     rank  5: 102.95
     rank  6: 103.02
     rank  7: 102.90
     rank  8: 61.93
     rank  9: 62.43
     rank 10: 62.40
     rank 11: 61.97
  optimizer:
     rank  0: 38.20
     rank  1: 38.02
     rank  2: 38.12
     rank  3: 38.32
     rank  4: 104.12
     rank  5: 104.09
     rank  6: 104.17
     rank  7: 104.05
     rank  8: 63.07
     rank  9: 63.58
     rank 10: 63.55
     rank 11: 63.12
 [2025-01-02 13:28:34] iteration        3/      10 | consumed samples:           96 | elapsed time per iteration (ms): 6026.6 | learning rate: 2.250000E-06 | global batch size:    32 | lm loss: 6.383523E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 5889.00
     rank  1: 5889.07
     rank  2: 5889.07
     rank  3: 5889.05
     rank  4: 5895.46
     rank  5: 5895.16
     rank  6: 5895.21
     rank  7: 5895.18
     rank  8: 5891.43
     rank  9: 5891.40
     rank 10: 5891.39
     rank 11: 5891.54
  forward-compute:
     rank  0: 1667.24
     rank  1: 1666.82
     rank  2: 1690.99
     rank  3: 1689.40
     rank  4: 1779.50
     rank  5: 1787.37
     rank  6: 1801.75
     rank  7: 1800.99
     rank  8: 1587.15
     rank  9: 1595.59
     rank 10: 1584.70
     rank 11: 1589.07
  backward-compute:
     rank  0: 1492.96
     rank  1: 1499.24
     rank  2: 1513.69
     rank  3: 1514.57
     rank  4: 2662.20
     rank  5: 2669.60
     rank  6: 2689.18
     rank  7: 2692.32
     rank  8: 2285.81
     rank  9: 2281.82
     rank 10: 2220.93
     rank 11: 2217.47
  pure-backward-compute:
     rank  0: 1492.20
     rank  1: 1498.14
     rank  2: 1512.76
     rank  3: 1513.70
     rank  4: 2661.18
     rank  5: 2668.57
     rank  6: 2688.17
     rank  7: 2691.33
     rank  8: 2280.75
     rank  9: 2279.04
     rank 10: 2216.69
     rank 11: 2213.83
  batch-generator:
     rank  0: 65.16
     rank  1: 69.96
     rank  2: 69.81
     rank  3: 74.56
     rank  4: 54.18
     rank  5: 66.53
     rank  6: 59.12
     rank  7: 59.69
     rank  8: 81.97
     rank  9: 89.65
     rank 10: 71.70
     rank 11: 77.89
  forward-recv:
     rank  4: 104.15
     rank  5: 104.20
     rank  6: 112.18
     rank  7: 112.22
     rank  8: 219.60
     rank  9: 218.32
     rank 10: 224.01
     rank 11: 223.89
  forward-send:
     rank  0: 13.91
     rank  1: 12.37
     rank  2: 15.02
     rank  3: 14.83
     rank  4: 4.07
     rank  5: 3.67
     rank  6: 2.83
     rank  7: 2.75
  backward-recv:
     rank  0: 350.50
     rank  1: 350.15
     rank  2: 344.82
     rank  3: 345.65
     rank  4: 78.46
     rank  5: 78.43
     rank  6: 74.13
     rank  7: 73.83
  backward-send:
     rank  4: 5.43
     rank  5: 4.59
     rank  6: 3.81
     rank  7: 3.69
     rank  8: 3.04
     rank  9: 2.63
     rank 10: 3.30
     rank 11: 3.13
  forward-send-backward-recv:
     rank  0: 1527.73
     rank  1: 1519.72
     rank  2: 1488.16
     rank  3: 1488.27
     rank  4: 262.35
     rank  5: 253.70
     rank  6: 222.01
     rank  7: 220.50
  backward-send-forward-recv:
     rank  4: 70.58
     rank  5: 64.70
     rank  6: 59.40
     rank  7: 58.73
     rank  8: 703.74
     rank  9: 701.90
     rank 10: 762.88
     rank 11: 761.74
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.09
  embedding-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.08
     rank  2: 0.09
     rank  3: 0.12
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.09
     rank  9: 0.05
     rank 10: 0.07
     rank 11: 0.07
  all-grads-sync:
     rank  0: 319.59
     rank  1: 305.87
     rank  2: 319.58
     rank  3: 305.91
     rank  4: 814.10
     rank  5: 814.75
     rank  6: 814.10
     rank  7: 814.76
     rank  8: 609.53
     rank  9: 593.70
     rank 10: 609.50
     rank 11: 593.67
  optimizer-copy-to-main-grad:
     rank  0: 0.25
     rank  1: 0.35
     rank  2: 0.35
     rank  3: 0.25
     rank  4: 0.06
     rank  5: 0.06
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.05
     rank  9: 0.05
     rank 10: 0.11
     rank 11: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
  optimizer-inner-step:
     rank  0: 36.74
     rank  1: 37.55
     rank  2: 37.10
     rank  3: 37.44
     rank  4: 102.74
     rank  5: 102.89
     rank  6: 102.99
     rank  7: 102.90
     rank  8: 61.77
     rank  9: 62.44
     rank 10: 62.83
     rank 11: 62.15
  optimizer:
     rank  0: 37.71
     rank  1: 38.53
     rank  2: 38.07
     rank  3: 38.40
     rank  4: 103.70
     rank  5: 103.85
     rank  6: 103.96
     rank  7: 103.86
     rank  8: 62.73
     rank  9: 63.41
     rank 10: 63.79
     rank 11: 63.11
 [2025-01-02 13:28:40] iteration        4/      10 | consumed samples:          128 | elapsed time per iteration (ms): 6025.5 | learning rate: 3.000000E-06 | global batch size:    32 | lm loss: 3.412166E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 5892.34
     rank  1: 5892.27
     rank  2: 5892.41
     rank  3: 5892.36
     rank  4: 5898.53
     rank  5: 5898.47
     rank  6: 5898.53
     rank  7: 5898.45
     rank  8: 5894.88
     rank  9: 5894.56
     rank 10: 5894.84
     rank 11: 5894.64
  forward-compute:
     rank  0: 1681.25
     rank  1: 1675.77
     rank  2: 1672.16
     rank  3: 1673.20
     rank  4: 1795.64
     rank  5: 1801.94
     rank  6: 1780.67
     rank  7: 1779.90
     rank  8: 1560.40
     rank  9: 1571.14
     rank 10: 2098.84
     rank 11: 2102.17
  backward-compute:
     rank  0: 1475.53
     rank  1: 1482.71
     rank  2: 1511.01
     rank  3: 1509.66
     rank  4: 2663.32
     rank  5: 2677.14
     rank  6: 2685.68
     rank  7: 2689.52
     rank  8: 2286.87
     rank  9: 2285.43
     rank 10: 2210.24
     rank 11: 2205.86
  pure-backward-compute:
     rank  0: 1474.73
     rank  1: 1481.55
     rank  2: 1510.13
     rank  3: 1508.79
     rank  4: 2662.33
     rank  5: 2676.07
     rank  6: 2684.77
     rank  7: 2688.60
     rank  8: 2283.71
     rank  9: 2282.70
     rank 10: 2207.15
     rank 11: 2202.80
  batch-generator:
     rank  0: 70.06
     rank  1: 75.07
     rank  2: 67.98
     rank  3: 75.79
     rank  4: 65.18
     rank  5: 73.78
     rank  6: 49.60
     rank  7: 49.71
     rank  8: 61.33
     rank  9: 73.15
     rank 10: 68.18
     rank 11: 73.42
  forward-recv:
     rank  4: 108.00
     rank  5: 108.51
     rank  6: 108.99
     rank  7: 109.03
     rank  8: 221.34
     rank  9: 221.38
     rank 10: 222.75
     rank 11: 222.75
  forward-send:
     rank  0: 16.16
     rank  1: 15.84
     rank  2: 17.41
     rank  3: 17.44
     rank  4: 5.18
     rank  5: 4.70
     rank  6: 4.24
     rank  7: 4.32
  backward-recv:
     rank  0: 351.40
     rank  1: 352.16
     rank  2: 398.42
     rank  3: 398.83
     rank  4: 77.38
     rank  5: 76.55
     rank  6: 123.03
     rank  7: 122.79
  backward-send:
     rank  4: 4.97
     rank  5: 4.90
     rank  6: 2.97
     rank  7: 2.99
     rank  8: 3.32
     rank  9: 3.08
     rank 10: 3.40
     rank 11: 3.43
  forward-send-backward-recv:
     rank  0: 1540.65
     rank  1: 1538.02
     rank  2: 1460.78
     rank  3: 1457.41
     rank  4: 257.81
     rank  5: 243.20
     rank  6: 215.03
     rank  7: 212.35
  backward-send-forward-recv:
     rank  4: 68.80
     rank  5: 63.90
     rank  6: 55.15
     rank  7: 54.50
     rank  8: 740.95
     rank  9: 732.88
     rank 10: 273.02
     rank 11: 272.77
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.05
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.05
     rank  9: 0.02
     rank 10: 0.13
     rank 11: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.06
     rank  2: 0.08
     rank  3: 0.09
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.10
     rank  9: 0.06
     rank 10: 0.17
     rank 11: 0.07
  all-grads-sync:
     rank  0: 307.77
     rank  1: 295.87
     rank  2: 307.80
     rank  3: 295.84
     rank  4: 806.22
     rank  5: 805.97
     rank  6: 806.21
     rank  7: 805.96
     rank  8: 610.45
     rank  9: 592.48
     rank 10: 610.25
     rank 11: 592.47
  optimizer-copy-to-main-grad:
     rank  0: 0.25
     rank  1: 0.25
     rank  2: 0.41
     rank  3: 0.33
     rank  4: 0.05
     rank  5: 0.10
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.07
     rank  9: 0.04
     rank 10: 0.11
     rank 11: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.10
     rank 11: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
  optimizer-inner-step:
     rank  0: 36.96
     rank  1: 37.22
     rank  2: 37.04
     rank  3: 37.52
     rank  4: 102.73
     rank  5: 102.88
     rank  6: 102.90
     rank  7: 102.88
     rank  8: 61.77
     rank  9: 62.29
     rank 10: 63.05
     rank 11: 61.71
  optimizer:
     rank  0: 38.02
     rank  1: 38.30
     rank  2: 38.10
     rank  3: 38.58
     rank  4: 103.81
     rank  5: 103.95
     rank  6: 103.96
     rank  7: 103.94
     rank  8: 62.83
     rank  9: 63.35
     rank 10: 64.21
     rank 11: 62.77
 [2025-01-02 13:28:46] iteration        5/      10 | consumed samples:          160 | elapsed time per iteration (ms): 6032.5 | learning rate: 3.750000E-06 | global batch size:    32 | lm loss: 2.694690E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 5894.78
     rank  1: 5894.87
     rank  2: 5894.83
     rank  3: 5894.83
     rank  4: 5900.99
     rank  5: 5901.04
     rank  6: 5900.99
     rank  7: 5900.99
     rank  8: 5897.42
     rank  9: 5897.10
     rank 10: 5897.23
     rank 11: 5897.09
  forward-compute:
     rank  0: 1679.75
     rank  1: 1675.36
     rank  2: 1656.36
     rank  3: 1654.98
     rank  4: 1786.94
     rank  5: 1793.54
     rank  6: 1786.78
     rank  7: 1784.97
     rank  8: 1568.98
     rank  9: 1577.85
     rank 10: 2112.41
     rank 11: 2116.69
  backward-compute:
     rank  0: 1476.94
     rank  1: 1484.05
     rank  2: 1512.97
     rank  3: 1512.88
     rank  4: 2666.16
     rank  5: 2678.65
     rank  6: 2683.84
     rank  7: 2687.39
     rank  8: 2297.47
     rank  9: 2295.75
     rank 10: 2215.56
     rank 11: 2212.73
  pure-backward-compute:
     rank  0: 1476.18
     rank  1: 1483.05
     rank  2: 1512.17
     rank  3: 1511.99
     rank  4: 2665.26
     rank  5: 2677.68
     rank  6: 2682.79
     rank  7: 2686.46
     rank  8: 2294.39
     rank  9: 2293.14
     rank 10: 2212.08
     rank 11: 2209.68
  batch-generator:
     rank  0: 65.61
     rank  1: 70.03
     rank  2: 64.60
     rank  3: 67.73
     rank  4: 61.95
     rank  5: 69.27
     rank  6: 53.97
     rank  7: 52.42
     rank  8: 61.09
     rank  9: 70.98
     rank 10: 70.73
     rank 11: 78.20
  forward-recv:
     rank  4: 105.79
     rank  5: 105.72
     rank  6: 104.19
     rank  7: 104.97
     rank  8: 218.41
     rank  9: 218.74
     rank 10: 217.96
     rank 11: 217.28
  forward-send:
     rank  0: 16.58
     rank  1: 16.56
     rank  2: 17.57
     rank  3: 18.12
     rank  4: 5.11
     rank  5: 5.19
     rank  6: 4.70
     rank  7: 4.68
  backward-recv:
     rank  0: 354.35
     rank  1: 355.08
     rank  2: 396.43
     rank  3: 396.59
     rank  4: 79.66
     rank  5: 79.48
     rank  6: 124.83
     rank  7: 125.19
  backward-send:
     rank  4: 4.72
     rank  5: 5.26
     rank  6: 2.95
     rank  7: 2.72
     rank  8: 3.10
     rank  9: 2.73
     rank 10: 3.38
     rank 11: 3.32
  forward-send-backward-recv:
     rank  0: 1531.99
     rank  1: 1528.20
     rank  2: 1470.17
     rank  3: 1468.95
     rank  4: 257.63
     rank  5: 244.94
     rank  6: 208.47
     rank  7: 205.95
  backward-send-forward-recv:
     rank  4: 68.08
     rank  5: 62.10
     rank  6: 54.20
     rank  7: 54.10
     rank  8: 719.99
     rank  9: 713.65
     rank 10: 252.87
     rank 11: 252.29
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.05
     rank  2: 0.04
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.09
     rank  2: 0.09
     rank  3: 0.07
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.11
     rank  9: 0.06
     rank 10: 0.07
     rank 11: 0.06
  all-grads-sync:
     rank  0: 318.08
     rank  1: 304.47
     rank  2: 318.09
     rank  3: 304.43
     rank  4: 814.40
     rank  5: 814.73
     rank  6: 814.40
     rank  7: 814.73
     rank  8: 604.30
     rank  9: 597.92
     rank 10: 604.11
     rank 11: 597.91
  optimizer-copy-to-main-grad:
     rank  0: 0.26
     rank  1: 0.34
     rank  2: 0.34
     rank  3: 0.25
     rank  4: 0.06
     rank  5: 0.06
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.09
     rank  9: 0.05
     rank 10: 0.11
     rank 11: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.07
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
  optimizer-inner-step:
     rank  0: 36.90
     rank  1: 37.44
     rank  2: 37.35
     rank  3: 37.55
     rank  4: 102.82
     rank  5: 102.92
     rank  6: 103.05
     rank  7: 102.87
     rank  8: 62.40
     rank  9: 62.39
     rank 10: 62.50
     rank 11: 61.58
  optimizer:
     rank  0: 37.95
     rank  1: 38.50
     rank  2: 38.40
     rank  3: 38.61
     rank  4: 103.87
     rank  5: 103.97
     rank  6: 104.11
     rank  7: 103.93
     rank  8: 63.45
     rank  9: 63.45
     rank 10: 63.55
     rank 11: 62.63
 [2025-01-02 13:28:52] iteration        6/      10 | consumed samples:          192 | elapsed time per iteration (ms): 6033.3 | learning rate: 4.500000E-06 | global batch size:    32 | lm loss: 2.372221E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 5896.42
     rank  1: 5896.39
     rank  2: 5896.39
     rank  3: 5896.50
     rank  4: 5902.65
     rank  5: 5902.61
     rank  6: 5902.61
     rank  7: 5902.60
     rank  8: 5899.27
     rank  9: 5898.78
     rank 10: 5899.15
     rank 11: 5898.89
  forward-compute:
     rank  0: 1666.05
     rank  1: 1664.07
     rank  2: 1669.02
     rank  3: 1668.48
     rank  4: 1790.46
     rank  5: 1791.31
     rank  6: 1781.13
     rank  7: 1779.12
     rank  8: 1567.46
     rank  9: 1572.90
     rank 10: 1620.76
     rank 11: 1623.54
  backward-compute:
     rank  0: 1485.70
     rank  1: 1484.94
     rank  2: 1501.78
     rank  3: 1498.10
     rank  4: 2662.85
     rank  5: 2667.05
     rank  6: 2690.52
     rank  7: 2693.81
     rank  8: 2307.72
     rank  9: 2303.89
     rank 10: 2243.07
     rank 11: 2238.89
  pure-backward-compute:
     rank  0: 1484.91
     rank  1: 1483.98
     rank  2: 1500.99
     rank  3: 1497.25
     rank  4: 2661.88
     rank  5: 2665.65
     rank  6: 2689.59
     rank  7: 2692.86
     rank  8: 2304.54
     rank  9: 2301.65
     rank 10: 2238.68
     rank 11: 2235.24
  batch-generator:
     rank  0: 67.84
     rank  1: 69.42
     rank  2: 68.08
     rank  3: 70.62
     rank  4: 57.76
     rank  5: 68.08
     rank  6: 52.57
     rank  7: 51.45
     rank  8: 61.68
     rank  9: 65.08
     rank 10: 81.43
     rank 11: 86.27
  forward-recv:
     rank  4: 104.56
     rank  5: 104.62
     rank  6: 104.73
     rank  7: 104.72
     rank  8: 217.55
     rank  9: 217.53
     rank 10: 217.88
     rank 11: 217.87
  forward-send:
     rank  0: 21.12
     rank  1: 21.00
     rank  2: 21.76
     rank  3: 21.89
     rank  4: 5.47
     rank  5: 5.38
     rank  6: 5.37
     rank  7: 5.43
  backward-recv:
     rank  0: 356.87
     rank  1: 358.14
     rank  2: 360.82
     rank  3: 360.78
     rank  4: 77.98
     rank  5: 76.61
     rank  6: 89.79
     rank  7: 89.45
  backward-send:
     rank  4: 3.99
     rank  5: 5.30
     rank  6: 2.88
     rank  7: 3.05
     rank  8: 2.82
     rank  9: 2.60
     rank 10: 2.78
     rank 11: 2.79
  forward-send-backward-recv:
     rank  0: 1533.35
     rank  1: 1530.49
     rank  2: 1509.32
     rank  3: 1509.56
     rank  4: 260.73
     rank  5: 255.17
     rank  6: 234.93
     rank  7: 233.31
  backward-send-forward-recv:
     rank  4: 73.43
     rank  5: 72.85
     rank  6: 68.75
     rank  7: 69.14
     rank  8: 719.20
     rank  9: 719.14
     rank 10: 725.15
     rank 11: 725.95
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.04
     rank  3: 0.10
     rank  4: 0.02
     rank  5: 0.04
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.09
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.07
  embedding-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.06
     rank  2: 0.07
     rank  3: 0.15
     rank  4: 0.02
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.13
     rank  9: 0.06
     rank 10: 0.09
     rank 11: 0.14
  all-grads-sync:
     rank  0: 306.93
     rank  1: 294.60
     rank  2: 306.90
     rank  3: 294.63
     rank  4: 809.35
     rank  5: 809.90
     rank  6: 809.35
     rank  7: 810.07
     rank  8: 610.37
     rank  9: 592.26
     rank 10: 610.38
     rank 11: 592.31
  optimizer-copy-to-main-grad:
     rank  0: 0.25
     rank  1: 0.26
     rank  2: 0.28
     rank  3: 0.33
     rank  4: 0.06
     rank  5: 0.08
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.08
     rank  9: 0.05
     rank 10: 0.10
     rank 11: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
  optimizer-inner-step:
     rank  0: 36.78
     rank  1: 37.06
     rank  2: 37.27
     rank  3: 37.32
     rank  4: 102.83
     rank  5: 103.14
     rank  6: 102.95
     rank  7: 102.86
     rank  8: 61.87
     rank  9: 62.40
     rank 10: 62.51
     rank 11: 61.85
  optimizer:
     rank  0: 37.78
     rank  1: 38.05
     rank  2: 38.26
     rank  3: 38.30
     rank  4: 103.81
     rank  5: 104.14
     rank  6: 103.93
     rank  7: 103.84
     rank  8: 62.85
     rank  9: 63.39
     rank 10: 63.49
     rank 11: 62.83
 [2025-01-02 13:28:58] iteration        7/      10 | consumed samples:          224 | elapsed time per iteration (ms): 6026.1 | learning rate: 5.250000E-06 | global batch size:    32 | lm loss: 2.589381E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 5894.09
     rank  1: 5893.96
     rank  2: 5894.06
     rank  3: 5893.90
     rank  4: 5900.29
     rank  5: 5900.04
     rank  6: 5900.27
     rank  7: 5900.02
     rank  8: 5896.67
     rank  9: 5896.17
     rank 10: 5896.49
     rank 11: 5896.19
  forward-compute:
     rank  0: 1665.11
     rank  1: 1663.75
     rank  2: 1656.31
     rank  3: 1657.76
     rank  4: 1800.21
     rank  5: 1798.12
     rank  6: 1796.51
     rank  7: 1796.13
     rank  8: 1577.66
     rank  9: 1585.98
     rank 10: 1596.86
     rank 11: 1602.49
  backward-compute:
     rank  0: 1506.51
     rank  1: 1506.42
     rank  2: 1500.59
     rank  3: 1499.39
     rank  4: 2655.07
     rank  5: 2662.66
     rank  6: 2692.69
     rank  7: 2699.96
     rank  8: 2309.99
     rank  9: 2308.69
     rank 10: 2247.55
     rank 11: 2244.34
  pure-backward-compute:
     rank  0: 1505.71
     rank  1: 1505.37
     rank  2: 1499.82
     rank  3: 1498.55
     rank  4: 2654.15
     rank  5: 2661.47
     rank  6: 2691.61
     rank  7: 2698.99
     rank  8: 2306.75
     rank  9: 2306.40
     rank 10: 2244.11
     rank 11: 2241.17
  batch-generator:
     rank  0: 65.22
     rank  1: 68.91
     rank  2: 65.11
     rank  3: 68.75
     rank  4: 56.90
     rank  5: 74.31
     rank  6: 56.83
     rank  7: 58.01
     rank  8: 66.34
     rank  9: 74.36
     rank 10: 73.14
     rank 11: 81.14
  forward-recv:
     rank  4: 108.08
     rank  5: 108.09
     rank  6: 108.65
     rank  7: 108.71
     rank  8: 221.30
     rank  9: 221.11
     rank 10: 221.59
     rank 11: 221.53
  forward-send:
     rank  0: 22.36
     rank  1: 22.10
     rank  2: 23.18
     rank  3: 23.30
     rank  4: 5.52
     rank  5: 5.24
     rank  6: 5.29
     rank  7: 5.28
  backward-recv:
     rank  0: 347.12
     rank  1: 346.83
     rank  2: 345.15
     rank  3: 346.30
     rank  4: 77.60
     rank  5: 76.88
     rank  6: 71.52
     rank  7: 71.99
  backward-send:
     rank  4: 4.85
     rank  5: 4.90
     rank  6: 2.97
     rank  7: 3.34
     rank  8: 2.72
     rank  9: 2.42
     rank 10: 2.84
     rank 11: 2.78
  forward-send-backward-recv:
     rank  0: 1523.67
     rank  1: 1522.86
     rank  2: 1539.36
     rank  3: 1534.84
     rank  4: 257.85
     rank  5: 251.68
     rank  6: 236.11
     rank  7: 230.56
  backward-send-forward-recv:
     rank  4: 70.31
     rank  5: 71.95
     rank  6: 63.69
     rank  7: 62.95
     rank  8: 702.35
     rank  9: 697.52
     rank 10: 740.65
     rank 11: 738.35
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.04
     rank  2: 0.05
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.13
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.09
     rank  2: 0.08
     rank  3: 0.08
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.22
     rank  9: 0.06
     rank 10: 0.07
     rank 11: 0.06
  all-grads-sync:
     rank  0: 318.29
     rank  1: 303.93
     rank  2: 318.30
     rank  3: 303.91
     rank  4: 806.93
     rank  5: 807.27
     rank  6: 806.93
     rank  7: 807.30
     rank  8: 609.69
     rank  9: 593.79
     rank 10: 609.77
     rank 11: 593.78
  optimizer-copy-to-main-grad:
     rank  0: 0.26
     rank  1: 0.34
     rank  2: 0.40
     rank  3: 0.25
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.13
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
  optimizer-inner-step:
     rank  0: 36.73
     rank  1: 37.51
     rank  2: 36.81
     rank  3: 37.40
     rank  4: 102.72
     rank  5: 102.84
     rank  6: 103.03
     rank  7: 102.88
     rank  8: 61.94
     rank  9: 62.22
     rank 10: 62.28
     rank 11: 61.47
  optimizer:
     rank  0: 37.84
     rank  1: 38.53
     rank  2: 37.91
     rank  3: 38.42
     rank  4: 103.74
     rank  5: 103.86
     rank  6: 104.05
     rank  7: 103.90
     rank  8: 62.96
     rank  9: 63.24
     rank 10: 63.30
     rank 11: 62.49
 [2025-01-02 13:29:04] iteration        8/      10 | consumed samples:          256 | elapsed time per iteration (ms): 6013.6 | learning rate: 6.000000E-06 | global batch size:    32 | lm loss: 2.363217E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 5874.18
     rank  1: 5874.36
     rank  2: 5874.16
     rank  3: 5874.44
     rank  4: 5880.36
     rank  5: 5880.58
     rank  6: 5880.35
     rank  7: 5880.58
     rank  8: 5876.68
     rank  9: 5876.74
     rank 10: 5876.58
     rank 11: 5876.87
  forward-compute:
     rank  0: 1686.39
     rank  1: 1674.90
     rank  2: 1731.04
     rank  3: 1733.46
     rank  4: 1782.98
     rank  5: 1783.53
     rank  6: 1798.07
     rank  7: 1797.02
     rank  8: 1583.00
     rank  9: 1595.69
     rank 10: 1908.68
     rank 11: 1909.66
  backward-compute:
     rank  0: 1526.23
     rank  1: 1539.14
     rank  2: 1504.18
     rank  3: 1501.75
     rank  4: 2655.73
     rank  5: 2672.90
     rank  6: 2695.19
     rank  7: 2696.07
     rank  8: 2314.55
     rank  9: 2313.65
     rank 10: 2243.45
     rank 11: 2240.75
  pure-backward-compute:
     rank  0: 1525.43
     rank  1: 1538.11
     rank  2: 1502.84
     rank  3: 1500.88
     rank  4: 2654.95
     rank  5: 2671.73
     rank  6: 2694.20
     rank  7: 2695.07
     rank  8: 2311.64
     rank  9: 2311.64
     rank 10: 2239.61
     rank 11: 2237.35
  batch-generator:
     rank  0: 69.30
     rank  1: 64.79
     rank  2: 84.89
     rank  3: 88.32
     rank  4: 50.34
     rank  5: 59.57
     rank  6: 54.39
     rank  7: 57.06
     rank  8: 72.50
     rank  9: 85.04
     rank 10: 67.32
     rank 11: 69.60
  forward-recv:
     rank  4: 107.12
     rank  5: 107.83
     rank  6: 109.15
     rank  7: 109.17
     rank  8: 220.30
     rank  9: 220.16
     rank 10: 222.02
     rank 11: 221.98
  forward-send:
     rank  0: 15.47
     rank  1: 15.07
     rank  2: 16.34
     rank  3: 16.26
     rank  4: 5.06
     rank  5: 4.70
     rank  6: 3.81
     rank  7: 3.81
  backward-recv:
     rank  0: 351.22
     rank  1: 351.87
     rank  2: 375.99
     rank  3: 377.23
     rank  4: 82.43
     rank  5: 81.43
     rank  6: 106.75
     rank  7: 107.01
  backward-send:
     rank  4: 3.84
     rank  5: 4.72
     rank  6: 3.11
     rank  7: 2.85
     rank  8: 3.30
     rank  9: 2.89
     rank 10: 3.16
     rank 11: 3.48
  forward-send-backward-recv:
     rank  0: 1466.78
     rank  1: 1466.25
     rank  2: 1415.81
     rank  3: 1413.84
     rank  4: 261.14
     rank  5: 246.14
     rank  6: 190.52
     rank  7: 189.81
  backward-send-forward-recv:
     rank  4: 65.38
     rank  5: 62.90
     rank  6: 53.15
     rank  7: 53.34
     rank  8: 675.80
     rank  9: 666.63
     rank 10: 413.07
     rank 11: 415.45
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.04
     rank  9: 0.02
     rank 10: 0.04
     rank 11: 0.07
  embedding-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.06
     rank  2: 0.07
     rank  3: 0.08
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.09
     rank  9: 0.06
     rank 10: 0.07
     rank 11: 0.16
  all-grads-sync:
     rank  0: 305.55
     rank  1: 292.65
     rank  2: 305.50
     rank  3: 292.67
     rank  4: 805.17
     rank  5: 806.33
     rank  6: 805.18
     rank  7: 806.36
     rank  8: 610.23
     rank  9: 593.90
     rank 10: 610.26
     rank 11: 593.75
  optimizer-copy-to-main-grad:
     rank  0: 0.25
     rank  1: 0.26
     rank  2: 0.26
     rank  3: 0.25
     rank  4: 0.05
     rank  5: 0.06
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.06
     rank  9: 0.04
     rank 10: 0.06
     rank 11: 0.11
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
  optimizer-inner-step:
     rank  0: 36.69
     rank  1: 37.19
     rank  2: 36.93
     rank  3: 37.36
     rank  4: 102.77
     rank  5: 102.91
     rank  6: 102.96
     rank  7: 102.94
     rank  8: 61.55
     rank  9: 62.34
     rank 10: 62.44
     rank 11: 61.88
  optimizer:
     rank  0: 37.63
     rank  1: 38.13
     rank  2: 37.88
     rank  3: 38.30
     rank  4: 103.70
     rank  5: 103.85
     rank  6: 103.90
     rank  7: 103.88
     rank  8: 62.48
     rank  9: 63.28
     rank 10: 63.39
     rank 11: 62.96
 [2025-01-02 13:29:10] iteration        9/      10 | consumed samples:          288 | elapsed time per iteration (ms): 6018.4 | learning rate: 6.750000E-06 | global batch size:    32 | lm loss: 2.360395E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 5880.79
     rank  1: 5880.25
     rank  2: 5880.77
     rank  3: 5880.18
     rank  4: 5887.00
     rank  5: 5886.33
     rank  6: 5886.96
     rank  7: 5886.33
     rank  8: 5883.77
     rank  9: 5882.46
     rank 10: 5883.40
     rank 11: 5882.48
  forward-compute:
     rank  0: 1653.72
     rank  1: 1651.23
     rank  2: 1658.01
     rank  3: 1660.93
     rank  4: 1772.27
     rank  5: 1776.60
     rank  6: 1784.86
     rank  7: 1783.81
     rank  8: 1584.64
     rank  9: 1592.81
     rank 10: 1576.11
     rank 11: 1575.49
  backward-compute:
     rank  0: 1483.85
     rank  1: 1488.94
     rank  2: 1503.39
     rank  3: 1501.13
     rank  4: 2658.56
     rank  5: 2669.04
     rank  6: 2695.04
     rank  7: 2693.72
     rank  8: 2326.25
     rank  9: 2325.06
     rank 10: 2260.96
     rank 11: 2258.28
  pure-backward-compute:
     rank  0: 1483.06
     rank  1: 1487.93
     rank  2: 1502.39
     rank  3: 1500.38
     rank  4: 2657.76
     rank  5: 2667.99
     rank  6: 2694.17
     rank  7: 2692.74
     rank  8: 2322.97
     rank  9: 2322.70
     rank 10: 2257.74
     rank 11: 2255.12
  batch-generator:
     rank  0: 66.90
     rank  1: 68.49
     rank  2: 61.27
     rank  3: 72.32
     rank  4: 45.09
     rank  5: 54.89
     rank  6: 45.63
     rank  7: 49.41
     rank  8: 66.82
     rank  9: 73.57
     rank 10: 62.25
     rank 11: 63.82
  forward-recv:
     rank  4: 104.53
     rank  5: 105.24
     rank  6: 106.63
     rank  7: 106.83
     rank  8: 217.53
     rank  9: 217.39
     rank 10: 219.62
     rank 11: 219.68
  forward-send:
     rank  0: 15.76
     rank  1: 15.56
     rank  2: 17.91
     rank  3: 17.98
     rank  4: 5.02
     rank  5: 4.77
     rank  6: 3.62
     rank  7: 3.55
  backward-recv:
     rank  0: 353.90
     rank  1: 354.24
     rank  2: 343.01
     rank  3: 343.67
     rank  4: 80.77
     rank  5: 80.64
     rank  6: 72.76
     rank  7: 72.60
  backward-send:
     rank  4: 4.66
     rank  5: 4.95
     rank  6: 3.02
     rank  7: 2.94
     rank  8: 2.67
     rank  9: 2.31
     rank 10: 3.03
     rank 11: 3.06
  forward-send-backward-recv:
     rank  0: 1541.30
     rank  1: 1535.29
     rank  2: 1522.53
     rank  3: 1520.11
     rank  4: 263.43
     rank  5: 254.50
     rank  6: 231.83
     rank  7: 234.10
  backward-send-forward-recv:
     rank  4: 71.66
     rank  5: 66.43
     rank  6: 61.42
     rank  7: 61.28
     rank  8: 664.14
     rank  9: 659.32
     rank 10: 730.88
     rank 11: 733.76
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.04
     rank  2: 0.05
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.23
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.09
     rank  2: 0.09
     rank  3: 0.07
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.54
     rank  9: 0.06
     rank 10: 0.07
     rank 11: 0.06
  all-grads-sync:
     rank  0: 322.11
     rank  1: 308.82
     rank  2: 322.09
     rank  3: 308.78
     rank  4: 809.58
     rank  5: 809.51
     rank  6: 809.57
     rank  7: 809.54
     rank  8: 608.30
     rank  9: 597.98
     rank 10: 607.99
     rank 11: 597.97
  optimizer-copy-to-main-grad:
     rank  0: 0.26
     rank  1: 0.34
     rank  2: 0.34
     rank  3: 0.26
     rank  4: 0.05
     rank  5: 0.06
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.28
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
  optimizer-inner-step:
     rank  0: 37.08
     rank  1: 37.44
     rank  2: 36.84
     rank  3: 37.20
     rank  4: 102.80
     rank  5: 102.83
     rank  6: 102.96
     rank  7: 102.95
     rank  8: 62.59
     rank  9: 62.26
     rank 10: 62.26
     rank 11: 61.53
  optimizer:
     rank  0: 38.41
     rank  1: 38.77
     rank  2: 38.18
     rank  3: 38.53
     rank  4: 104.12
     rank  5: 104.15
     rank  6: 104.29
     rank  7: 104.28
     rank  8: 63.92
     rank  9: 63.59
     rank 10: 63.59
     rank 11: 62.85
 [2025-01-02 13:29:16] iteration       10/      10 | consumed samples:          320 | elapsed time per iteration (ms): 6024.6 | learning rate: 7.500000E-06 | global batch size:    32 | lm loss: 3.033570E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 5889.95
     rank  1: 5889.89
     rank  2: 5889.91
     rank  3: 5889.90
     rank  4: 5896.16
     rank  5: 5896.10
     rank  6: 5896.13
     rank  7: 5896.11
     rank  8: 5892.40
     rank  9: 5892.22
     rank 10: 5892.31
     rank 11: 5892.27
  forward-compute:
     rank  0: 1670.08
     rank  1: 1670.47
     rank  2: 1654.61
     rank  3: 1657.03
     rank  4: 1779.84
     rank  5: 1782.60
     rank  6: 1811.84
     rank  7: 1809.99
     rank  8: 1579.75
     rank  9: 1593.51
     rank 10: 1803.92
     rank 11: 1804.76
  backward-compute:
     rank  0: 1480.01
     rank  1: 1481.24
     rank  2: 1533.24
     rank  3: 1529.16
     rank  4: 2659.79
     rank  5: 2676.66
     rank  6: 2696.73
     rank  7: 2697.90
     rank  8: 2327.98
     rank  9: 2326.64
     rank 10: 2252.64
     rank 11: 2251.88
  pure-backward-compute:
     rank  0: 1479.25
     rank  1: 1480.28
     rank  2: 1532.40
     rank  3: 1528.40
     rank  4: 2659.02
     rank  5: 2675.81
     rank  6: 2695.80
     rank  7: 2696.89
     rank  8: 2324.76
     rank  9: 2324.24
     rank 10: 2249.11
     rank 11: 2248.87
  batch-generator:
     rank  0: 65.63
     rank  1: 72.13
     rank  2: 68.58
     rank  3: 74.90
     rank  4: 49.54
     rank  5: 56.46
     rank  6: 65.31
     rank  7: 65.82
     rank  8: 58.40
     rank  9: 73.79
     rank 10: 77.05
     rank 11: 79.71
  forward-recv:
     rank  4: 105.08
     rank  5: 104.69
     rank  6: 104.36
     rank  7: 104.60
     rank  8: 217.72
     rank  9: 217.56
     rank 10: 218.08
     rank 11: 218.04
  forward-send:
     rank  0: 18.40
     rank  1: 17.47
     rank  2: 19.07
     rank  3: 19.09
     rank  4: 5.58
     rank  5: 5.22
     rank  6: 5.33
     rank  7: 5.35
  backward-recv:
     rank  0: 353.19
     rank  1: 353.07
     rank  2: 334.59
     rank  3: 335.60
     rank  4: 80.40
     rank  5: 79.73
     rank  6: 93.01
     rank  7: 92.93
  backward-send:
     rank  4: 4.94
     rank  5: 5.17
     rank  6: 3.01
     rank  7: 2.97
     rank  8: 2.90
     rank  9: 2.59
     rank 10: 2.80
     rank 11: 2.95
  forward-send-backward-recv:
     rank  0: 1527.19
     rank  1: 1526.75
     rank  2: 1515.73
     rank  3: 1513.17
     rank  4: 262.81
     rank  5: 247.02
     rank  6: 193.12
     rank  7: 192.49
  backward-send-forward-recv:
     rank  4: 66.08
     rank  5: 63.86
     rank  6: 53.03
     rank  7: 53.63
     rank  8: 668.60
     rank  9: 658.34
     rank 10: 511.01
     rank 11: 513.62
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.04
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.07
     rank  1: 0.06
     rank  2: 0.08
     rank  3: 0.06
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.08
     rank  9: 0.06
     rank 10: 0.07
     rank 11: 0.07
  all-grads-sync:
     rank  0: 303.63
     rank  1: 291.59
     rank  2: 303.64
     rank  3: 291.59
     rank  4: 811.43
     rank  5: 811.90
     rank  6: 811.40
     rank  7: 811.93
     rank  8: 610.74
     rank  9: 592.88
     rank 10: 610.92
     rank 11: 592.87
  optimizer-copy-to-main-grad:
     rank  0: 0.26
     rank  1: 0.26
     rank  2: 0.27
     rank  3: 0.24
     rank  4: 0.07
     rank  5: 0.10
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.06
     rank  9: 0.04
     rank 10: 0.06
     rank 11: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
  optimizer-inner-step:
     rank  0: 37.19
     rank  1: 37.29
     rank  2: 37.20
     rank  3: 36.95
     rank  4: 102.84
     rank  5: 102.89
     rank  6: 102.97
     rank  7: 102.92
     rank  8: 61.56
     rank  9: 62.28
     rank 10: 62.43
     rank 11: 61.62
  optimizer:
     rank  0: 38.01
     rank  1: 38.11
     rank  2: 38.03
     rank  3: 37.77
     rank  4: 103.65
     rank  5: 103.70
     rank  6: 103.79
     rank  7: 103.73
     rank  8: 62.38
     rank  9: 63.10
     rank 10: 63.26
     rank 11: 62.45
