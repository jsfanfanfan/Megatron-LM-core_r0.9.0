examples/multimodal/pretrain-freeze-llm-homo.sh: line 4: activate: No such file or directory
4
[2024-12-16 19:17:50,529] torch.distributed.run: [WARNING] 
[2024-12-16 19:17:50,529] torch.distributed.run: [WARNING] *****************************************
[2024-12-16 19:17:50,529] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-12-16 19:17:50,529] torch.distributed.run: [WARNING] *****************************************
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
------pipeline_parallel_model_size:5------
------pipeline_parallel_model_size:5------------world_size:20------

------total_model_size:20------------world_size:20------

------num_pipeline_model_parallel_groups:4------------total_model_size:20------

------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:20------
------num_pipeline_model_parallel_groups:4------
> setting tensorboard ...
WARNING: one_logger package is required to enable e2e metrics tracking. please go to https://confluence.nvidia.com/display/MLWFO/Package+Repositories for details to install it
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:20------
------num_pipeline_model_parallel_groups:4------
---Rank 16---Tensor Parallel Group GPUs: [0, 0, 0, 0]
---Rank 19---Tensor Parallel Group GPUs: [3, 3, 3, 3]
---Rank 16---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]
---Rank 19---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]
[rank16]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank19]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
---Rank 17---Tensor Parallel Group GPUs: [1, 1, 1, 1]---Rank 18---Tensor Parallel Group GPUs: [2, 2, 2, 2]

---Rank 17---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]
---Rank 18---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]
[rank18]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank17]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
 > number of parameters on (tensor, pipeline) model parallel rank (1, 4): 469831680
 > number of parameters on (tensor, pipeline) model parallel rank (0, 4): 469831680
 > number of parameters on (tensor, pipeline) model parallel rank (2, 4): 469831680
 > number of parameters on (tensor, pipeline) model parallel rank (3, 4): 469831680
rank=0, worker=0: shard_range=[pretrain-0.tar[0, 100), pretrain-0.tar[100, 200), pretrain-0.tar[200, 300), ...<2494>, pretrain-30.tar[9700, 9800), pretrain-30.tar[9800, 9900), pretrain-30.tar[9900, 10000)] sum(count)=250000
rank=0, worker=1: shard_range=[pretrain-31.tar[0, 100), pretrain-31.tar[100, 200), pretrain-31.tar[200, 300), ...<2494>, pretrain-53.tar[9700, 9800), pretrain-53.tar[9800, 9900), pretrain-53.tar[9900, 10000)] sum(count)=250000
rank=0, worker=0: shard_range=[pretrain-54.tar[0, 10000), pretrain-55.tar[0, 8128), pretrain-6.tar[0, 10000), pretrain-7.tar[0, 936)] sum(count)=29064
rank=0, worker=1: shard_range=[pretrain-7.tar[936, 10000), pretrain-8.tar[0, 10000), pretrain-9.tar[0, 10000)] sum(count)=29064
times across ranks (ms):
  model-and-optimizer-setup:
     rank  0: 63.20
     rank  1: 63.07
     rank  2: 78.71
     rank  3: 63.15
     rank  4: 33.02
     rank  5: 26.38
     rank  6: 25.38
     rank  7: 26.46
     rank  8: 209.44
     rank  9: 209.62
     rank 10: 209.65
     rank 11: 209.49
     rank 12: 203.46
     rank 13: 203.60
     rank 14: 203.70
     rank 15: 203.92
     rank 16: 206.15
     rank 17: 206.17
     rank 18: 208.32
     rank 19: 208.43
  train/valid/test-data-iterators-setup:
     rank  0: 949.28
     rank  1: 949.22
     rank  2: 949.14
     rank  3: 949.17
     rank  4: 949.20
     rank  5: 949.18
     rank  6: 949.26
     rank  7: 949.20
     rank  8: 1305.19
     rank  9: 1305.25
     rank 10: 1305.23
     rank 11: 1305.20
     rank 12: 1305.24
     rank 13: 1305.31
     rank 14: 1305.25
     rank 15: 1305.28
     rank 16: 1334.46
     rank 17: 1334.72
     rank 18: 1334.49
     rank 19: 1334.46
[Rank 18] (after 1 iterations) memory (MB) | allocated: 1936.5185546875 | max allocated: 3972.1982421875 | reserved: 4740.0 | max reserved: 4740.0
[Rank 17] (after 1 iterations) memory (MB) | allocated: 1936.5185546875 | max allocated: 3972.1982421875 | reserved: 4740.0 | max reserved: 4740.0
 [2024-12-16 19:19:40] iteration        1/      10 | consumed samples:           32 | elapsed time per iteration (ms): 32796.8 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 7.106411E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
[Rank 16] (after 1 iterations) memory (MB) | allocated: 1936.5185546875 | max allocated: 3972.1982421875 | reserved: 4656.0 | max reserved: 4656.0
[Rank 19] (after 1 iterations) memory (MB) | allocated: 1936.5185546875 | max allocated: 3972.1982421875 | reserved: 4740.0 | max reserved: 4740.0
times across ranks (ms):
  forward-backward:
     rank  0: 32724.32
     rank  1: 32724.54
     rank  2: 32723.87
     rank  3: 32724.23
     rank  4: 32765.65
     rank  5: 32763.94
     rank  6: 32760.97
     rank  7: 32764.85
     rank  8: 32763.72
     rank  9: 32758.47
     rank 10: 32763.54
     rank 11: 32765.56
     rank 12: 32765.78
     rank 13: 32760.96
     rank 14: 32764.06
     rank 15: 32767.75
     rank 16: 32723.02
     rank 17: 32722.67
     rank 18: 32722.68
     rank 19: 32722.83
  forward-compute:
     rank  0: 5154.86
     rank  1: 5177.69
     rank  2: 5164.88
     rank  3: 5110.17
     rank  4: 5369.30
     rank  5: 5398.09
     rank  6: 5385.48
     rank  7: 5392.46
     rank  8: 9430.68
     rank  9: 9458.96
     rank 10: 9430.94
     rank 11: 9440.93
     rank 12: 9344.60
     rank 13: 9366.26
     rank 14: 9344.69
     rank 15: 9346.89
     rank 16: 8497.02
     rank 17: 8495.15
     rank 18: 8491.28
     rank 19: 8490.75
  backward-compute:
     rank  0: 1891.12
     rank  1: 1895.38
     rank  2: 1892.68
     rank  3: 1957.38
     rank  4: 3232.92
     rank  5: 3238.37
     rank  6: 3232.96
     rank  7: 3233.24
     rank  8: 3253.06
     rank  9: 3258.96
     rank 10: 3255.59
     rank 11: 3252.94
     rank 12: 3301.21
     rank 13: 3294.59
     rank 14: 3294.93
     rank 15: 3296.96
     rank 16: 3470.39
     rank 17: 3471.89
     rank 18: 3472.86
     rank 19: 3469.99
  pure-backward-compute:
     rank  0: 1890.22
     rank  1: 1894.35
     rank  2: 1891.45
     rank  3: 1956.35
     rank  4: 3231.30
     rank  5: 3237.25
     rank  6: 3231.57
     rank  7: 3232.02
     rank  8: 3251.61
     rank  9: 3258.03
     rank 10: 3254.07
     rank 11: 3251.57
     rank 12: 3300.09
     rank 13: 3293.33
     rank 14: 3293.76
     rank 15: 3295.63
     rank 16: 3467.80
     rank 17: 3469.76
     rank 18: 3470.56
     rank 19: 3467.28
  batch-generator:
     rank  0: 1262.63
     rank  1: 1288.11
     rank  2: 1327.52
     rank  3: 1277.52
     rank  4: 896.88
     rank  5: 923.87
     rank  6: 912.29
     rank  7: 922.23
     rank  8: 1697.59
     rank  9: 1729.10
     rank 10: 1702.29
     rank 11: 1710.99
     rank 12: 1302.55
     rank 13: 1330.48
     rank 14: 1308.85
     rank 15: 1307.73
     rank 16: 1366.98
     rank 17: 1366.00
     rank 18: 1362.96
     rank 19: 1366.25
  forward-recv:
     rank  4: 4319.27
     rank  5: 4317.01
     rank  6: 4308.37
     rank  7: 4310.85
     rank  8: 6538.83
     rank  9: 6531.89
     rank 10: 6538.24
     rank 11: 6532.31
     rank 12: 12881.67
     rank 13: 12867.04
     rank 14: 12882.94
     rank 15: 12880.26
     rank 16: 19145.70
     rank 17: 19143.56
     rank 18: 19145.97
     rank 19: 19146.24
  forward-send:
     rank  0: 14849.20
     rank  1: 14826.21
     rank  2: 14839.35
     rank  3: 14836.31
     rank  4: 12238.51
     rank  5: 12216.68
     rank  6: 12238.24
     rank  7: 12231.94
     rank  8: 6103.07
     rank  9: 6086.67
     rank 10: 6103.63
     rank 11: 6102.84
     rank 12: 36.59
     rank 13: 34.43
     rank 14: 36.94
     rank 15: 37.24
  backward-recv:
     rank  0: 1480.23
     rank  1: 1479.88
     rank  2: 1480.78
     rank  3: 1478.74
     rank  4: 689.55
     rank  5: 689.05
     rank  6: 688.08
     rank  7: 689.66
     rank  8: 452.23
     rank  9: 452.67
     rank 10: 452.21
     rank 11: 452.54
     rank 12: 226.43
     rank 13: 226.52
     rank 14: 226.47
     rank 15: 226.66
  backward-send:
     rank  4: 21.89
     rank  5: 21.77
     rank  6: 22.72
     rank  7: 20.88
     rank  8: 31.32
     rank  9: 30.47
     rank 10: 31.43
     rank 11: 31.06
     rank 12: 20.87
     rank 13: 20.24
     rank 14: 20.93
     rank 15: 20.85
     rank 16: 10.43
     rank 17: 10.21
     rank 18: 10.47
     rank 19: 10.43
  forward-send-backward-recv:
     rank  0: 9285.77
     rank  1: 9281.15
     rank  2: 9284.15
     rank  3: 9278.84
     rank  4: 6059.11
     rank  5: 6053.83
     rank  6: 6058.80
     rank  7: 6058.65
     rank  8: 5824.52
     rank  9: 5821.17
     rank 10: 5821.61
     rank 11: 5824.17
     rank 12: 5568.78
     rank 13: 5575.23
     rank 14: 5575.96
     rank 15: 5574.23
  backward-send-forward-recv:
     rank  4: 665.52
     rank  5: 663.38
     rank  6: 662.57
     rank  7: 659.53
     rank  8: 754.05
     rank  9: 748.52
     rank 10: 753.21
     rank 11: 751.56
     rank 12: 794.91
     rank 13: 789.01
     rank 14: 792.71
     rank 15: 793.34
     rank 16: 838.46
     rank 17: 843.32
     rank 18: 844.06
     rank 19: 844.69
  layernorm-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.06
     rank  2: 0.03
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.04
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
     rank 16: 0.05
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.14
     rank  1: 0.15
     rank  2: 0.06
     rank  3: 0.13
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
     rank 16: 0.17
     rank 17: 0.05
     rank 18: 0.05
     rank 19: 0.07
  all-grads-sync:
     rank  0: 47.03
     rank  1: 45.50
     rank  2: 36.73
     rank  3: 42.46
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.03
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.24
     rank  1: 0.24
     rank  2: 0.23
     rank  3: 0.24
     rank  4: 0.04
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.04
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.04
     rank 16: 0.03
     rank 17: 0.02
     rank 18: 0.01
     rank 19: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.03
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.03
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.02
  optimizer-inner-step:
     rank  0: 25.90
     rank  1: 25.60
     rank  2: 26.17
     rank  3: 26.07
     rank  4: 0.15
     rank  5: 0.12
     rank  6: 0.09
     rank  7: 0.12
     rank  8: 0.14
     rank  9: 0.11
     rank 10: 0.10
     rank 11: 0.14
     rank 12: 0.26
     rank 13: 0.10
     rank 14: 0.12
     rank 15: 0.18
     rank 16: 0.12
     rank 17: 0.07
     rank 18: 0.07
     rank 19: 0.10
  optimizer:
     rank  0: 27.22
     rank  1: 26.90
     rank  2: 27.48
     rank  3: 27.38
     rank  4: 1.47
     rank  5: 1.44
     rank  6: 1.39
     rank  7: 1.43
     rank  8: 1.42
     rank  9: 1.40
     rank 10: 1.39
     rank 11: 1.45
     rank 12: 1.58
     rank 13: 1.38
     rank 14: 1.43
     rank 15: 1.50
     rank 16: 1.42
     rank 17: 1.38
     rank 18: 1.38
     rank 19: 1.40
 [2024-12-16 19:19:48] iteration        2/      10 | consumed samples:           64 | elapsed time per iteration (ms): 8506.6 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 7.180277E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 8460.01
     rank  1: 8459.86
     rank  2: 8459.93
     rank  3: 8459.90
     rank  4: 8459.11
     rank  5: 8459.02
     rank  6: 8459.02
     rank  7: 8458.99
     rank  8: 8459.19
     rank  9: 8459.04
     rank 10: 8459.11
     rank 11: 8459.03
     rank 12: 8459.20
     rank 13: 8459.01
     rank 14: 8459.16
     rank 15: 8459.06
     rank 16: 8459.17
     rank 17: 8459.02
     rank 18: 8459.03
     rank 19: 8459.06
  forward-compute:
     rank  0: 957.93
     rank  1: 971.64
     rank  2: 958.56
     rank  3: 960.98
     rank  4: 3397.74
     rank  5: 3414.80
     rank  6: 3397.46
     rank  7: 3406.62
     rank  8: 3314.29
     rank  9: 3324.48
     rank 10: 3314.16
     rank 11: 3316.82
     rank 12: 3315.10
     rank 13: 3318.13
     rank 14: 3317.13
     rank 15: 3320.69
     rank 16: 3427.64
     rank 17: 3432.23
     rank 18: 3428.66
     rank 19: 3428.71
  backward-compute:
     rank  0: 1090.30
     rank  1: 1094.42
     rank  2: 1089.28
     rank  3: 1098.12
     rank  4: 3232.40
     rank  5: 3234.59
     rank  6: 3232.81
     rank  7: 3230.61
     rank  8: 3230.48
     rank  9: 3233.14
     rank 10: 3233.11
     rank 11: 3233.08
     rank 12: 3192.99
     rank 13: 3194.26
     rank 14: 3193.42
     rank 15: 3193.64
     rank 16: 3411.51
     rank 17: 3412.81
     rank 18: 3415.10
     rank 19: 3410.89
  pure-backward-compute:
     rank  0: 1089.53
     rank  1: 1093.73
     rank  2: 1088.61
     rank  3: 1097.45
     rank  4: 3231.17
     rank  5: 3233.51
     rank  6: 3231.38
     rank  7: 3229.84
     rank  8: 3229.57
     rank  9: 3232.41
     rank 10: 3231.97
     rank 11: 3232.35
     rank 12: 3191.60
     rank 13: 3193.26
     rank 14: 3192.57
     rank 15: 3192.63
     rank 16: 3408.93
     rank 17: 3410.96
     rank 18: 3412.96
     rank 19: 3408.38
  batch-generator:
     rank  0: 53.06
     rank  1: 68.07
     rank  2: 56.95
     rank  3: 58.72
     rank  4: 63.70
     rank  5: 84.35
     rank  6: 71.68
     rank  7: 76.00
     rank  8: 50.54
     rank  9: 63.84
     rank 10: 53.94
     rank 11: 54.95
     rank 12: 65.49
     rank 13: 69.55
     rank 14: 67.87
     rank 15: 67.97
     rank 16: 55.70
     rank 17: 63.16
     rank 18: 59.87
     rank 19: 60.75
  forward-recv:
     rank  4: 81.69
     rank  5: 76.06
     rank  6: 81.83
     rank  7: 80.80
     rank  8: 308.88
     rank  9: 304.78
     rank 10: 309.36
     rank 11: 308.90
     rank 12: 518.36
     rank 13: 517.32
     rank 14: 518.63
     rank 15: 518.71
     rank 16: 727.87
     rank 17: 727.45
     rank 18: 727.68
     rank 19: 727.71
  forward-send:
     rank  0: 507.31
     rank  1: 493.90
     rank  2: 507.15
     rank  3: 504.64
     rank  4: 34.47
     rank  5: 26.86
     rank  6: 33.96
     rank  7: 33.52
     rank  8: 22.54
     rank  9: 20.19
     rank 10: 22.05
     rank 11: 21.92
     rank 12: 10.66
     rank 13: 10.05
     rank 14: 10.37
     rank 15: 10.35
  backward-recv:
     rank  0: 1485.32
     rank  1: 1484.84
     rank  2: 1485.86
     rank  3: 1484.46
     rank  4: 695.79
     rank  5: 696.21
     rank  6: 695.33
     rank  7: 696.25
     rank  8: 459.78
     rank  9: 459.32
     rank 10: 459.02
     rank 11: 460.47
     rank 12: 228.64
     rank 13: 229.34
     rank 14: 228.80
     rank 15: 228.68
  backward-send:
     rank  4: 22.33
     rank  5: 22.18
     rank  6: 22.39
     rank  7: 21.29
     rank  8: 31.17
     rank  9: 30.44
     rank 10: 31.18
     rank 11: 30.38
     rank 12: 20.85
     rank 13: 19.46
     rank 14: 20.82
     rank 15: 20.76
     rank 16: 10.45
     rank 17: 10.29
     rank 18: 10.54
     rank 19: 10.37
  forward-send-backward-recv:
     rank  0: 4403.72
     rank  1: 4400.10
     rank  2: 4406.47
     rank  3: 4399.32
     rank  4: 843.06
     rank  5: 841.18
     rank  6: 843.08
     rank  7: 845.21
     rank  8: 661.25
     rank  9: 662.54
     rank 10: 658.46
     rank 11: 660.25
     rank 12: 515.74
     rank 13: 516.27
     rank 14: 518.94
     rank 15: 516.98
  backward-send-forward-recv:
     rank  4: 73.37
     rank  5: 71.69
     rank  6: 73.50
     rank  7: 69.43
     rank  8: 144.60
     rank  9: 140.61
     rank 10: 144.50
     rank 11: 143.66
     rank 12: 157.81
     rank 13: 156.38
     rank 14: 156.10
     rank 15: 155.14
     rank 16: 170.20
     rank 17: 167.36
     rank 18: 169.27
     rank 19: 170.08
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.04
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.06
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.11
     rank 17: 0.06
     rank 18: 0.07
     rank 19: 0.09
  all-grads-sync:
     rank  0: 0.63
     rank  1: 0.61
     rank  2: 0.66
     rank  3: 0.62
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.06
     rank 17: 0.02
     rank 18: 0.03
     rank 19: 0.03
  optimizer-copy-to-main-grad:
     rank  0: 0.18
     rank  1: 0.17
     rank  2: 0.17
     rank  3: 0.17
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.07
     rank 17: 0.02
     rank 18: 0.03
     rank 19: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 10.27
     rank  1: 10.20
     rank  2: 10.31
     rank  3: 10.32
     rank  4: 0.03
     rank  5: 0.07
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.07
     rank 10: 0.07
     rank 11: 0.03
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.08
     rank 16: 0.20
     rank 17: 0.10
     rank 18: 0.10
     rank 19: 0.09
  optimizer:
     rank  0: 10.95
     rank  1: 10.88
     rank  2: 10.99
     rank  3: 11.00
     rank  4: 0.71
     rank  5: 0.75
     rank  6: 0.71
     rank  7: 0.71
     rank  8: 0.71
     rank  9: 0.75
     rank 10: 0.75
     rank 11: 0.71
     rank 12: 0.73
     rank 13: 0.72
     rank 14: 0.73
     rank 15: 0.76
     rank 16: 0.88
     rank 17: 0.78
     rank 18: 0.78
     rank 19: 0.76
 [2024-12-16 19:19:57] iteration        3/      10 | consumed samples:           96 | elapsed time per iteration (ms): 8510.3 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 7.024859E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 8468.72
     rank  1: 8468.30
     rank  2: 8468.25
     rank  3: 8468.25
     rank  4: 8467.83
     rank  5: 8467.42
     rank  6: 8467.34
     rank  7: 8467.44
     rank  8: 8467.89
     rank  9: 8467.46
     rank 10: 8467.41
     rank 11: 8467.42
     rank 12: 8467.83
     rank 13: 8467.42
     rank 14: 8467.55
     rank 15: 8467.42
     rank 16: 8468.42
     rank 17: 8467.39
     rank 18: 8467.32
     rank 19: 8467.36
  forward-compute:
     rank  0: 1109.07
     rank  1: 1116.91
     rank  2: 1110.01
     rank  3: 1113.90
     rank  4: 3393.72
     rank  5: 3404.38
     rank  6: 3394.56
     rank  7: 3404.73
     rank  8: 3301.82
     rank  9: 3307.49
     rank 10: 3302.12
     rank 11: 3306.20
     rank 12: 3298.48
     rank 13: 3298.52
     rank 14: 3300.15
     rank 15: 3302.61
     rank 16: 3433.28
     rank 17: 3439.10
     rank 18: 3434.54
     rank 19: 3434.07
  backward-compute:
     rank  0: 1077.62
     rank  1: 1084.43
     rank  2: 1078.06
     rank  3: 1084.20
     rank  4: 3228.92
     rank  5: 3230.18
     rank  6: 3228.31
     rank  7: 3228.19
     rank  8: 3200.02
     rank  9: 3200.58
     rank 10: 3202.26
     rank 11: 3200.47
     rank 12: 3210.67
     rank 13: 3212.24
     rank 14: 3211.41
     rank 15: 3211.68
     rank 16: 3419.93
     rank 17: 3422.30
     rank 18: 3422.97
     rank 19: 3418.84
  pure-backward-compute:
     rank  0: 1076.87
     rank  1: 1083.75
     rank  2: 1077.35
     rank  3: 1083.51
     rank  4: 3227.42
     rank  5: 3229.20
     rank  6: 3227.19
     rank  7: 3227.36
     rank  8: 3199.11
     rank  9: 3199.83
     rank 10: 3201.24
     rank 11: 3199.75
     rank 12: 3209.72
     rank 13: 3211.02
     rank 14: 3210.67
     rank 15: 3210.92
     rank 16: 3417.82
     rank 17: 3420.83
     rank 18: 3421.49
     rank 19: 3416.60
  batch-generator:
     rank  0: 52.12
     rank  1: 62.23
     rank  2: 56.33
     rank  3: 61.06
     rank  4: 60.90
     rank  5: 74.13
     rank  6: 66.65
     rank  7: 75.54
     rank  8: 49.57
     rank  9: 57.02
     rank 10: 52.55
     rank 11: 56.20
     rank 12: 50.89
     rank 13: 55.44
     rank 14: 55.40
     rank 15: 55.77
     rank 16: 53.91
     rank 17: 60.18
     rank 18: 56.74
     rank 19: 58.47
  forward-recv:
     rank  4: 81.58
     rank  5: 78.22
     rank  6: 81.31
     rank  7: 79.53
     rank  8: 311.50
     rank  9: 310.05
     rank 10: 311.50
     rank 11: 310.76
     rank 12: 519.50
     rank 13: 518.53
     rank 14: 519.94
     rank 15: 519.55
     rank 16: 724.86
     rank 17: 724.74
     rank 18: 724.66
     rank 19: 724.85
  forward-send:
     rank  0: 510.31
     rank  1: 502.58
     rank  2: 509.90
     rank  3: 505.78
     rank  4: 31.67
     rank  5: 27.97
     rank  6: 31.82
     rank  7: 30.14
     rank  8: 20.91
     rank  9: 19.43
     rank 10: 20.94
     rank 11: 20.51
     rank 12: 10.57
     rank 13: 10.36
     rank 14: 10.20
     rank 15: 10.35
  backward-recv:
     rank  0: 1490.77
     rank  1: 1487.43
     rank  2: 1490.76
     rank  3: 1490.65
     rank  4: 698.96
     rank  5: 700.81
     rank  6: 698.66
     rank  7: 697.55
     rank  8: 457.25
     rank  9: 458.03
     rank 10: 456.83
     rank 11: 458.41
     rank 12: 226.20
     rank 13: 226.33
     rank 14: 226.47
     rank 15: 225.70
  backward-send:
     rank  4: 22.13
     rank  5: 19.41
     rank  6: 22.20
     rank  7: 22.69
     rank  8: 31.43
     rank  9: 30.63
     rank 10: 31.43
     rank 11: 30.60
     rank 12: 20.79
     rank 13: 20.50
     rank 14: 20.36
     rank 15: 21.02
     rank 16: 10.48
     rank 17: 10.54
     rank 18: 10.23
     rank 19: 10.47
  forward-send-backward-recv:
     rank  0: 4265.19
     rank  1: 4261.50
     rank  2: 4267.19
     rank  3: 4261.22
     rank  4: 858.53
     rank  5: 857.24
     rank  6: 858.62
     rank  7: 859.14
     rank  8: 712.85
     rank  9: 715.36
     rank 10: 710.48
     rank 11: 713.43
     rank 12: 526.39
     rank 13: 525.74
     rank 14: 529.02
     rank 15: 527.26
  backward-send-forward-recv:
     rank  4: 73.55
     rank  5: 72.26
     rank  6: 74.22
     rank  7: 69.60
     rank  8: 146.38
     rank  9: 143.82
     rank 10: 146.42
     rank 11: 144.47
     rank 12: 158.36
     rank 13: 158.31
     rank 14: 156.26
     rank 15: 155.84
     rank 16: 169.59
     rank 17: 165.18
     rank 18: 169.01
     rank 19: 169.84
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.04
     rank 16: 0.03
     rank 17: 0.03
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.03
     rank 16: 0.37
     rank 17: 0.08
     rank 18: 0.04
     rank 19: 0.05
  all-grads-sync:
     rank  0: 0.61
     rank  1: 0.62
     rank  2: 0.61
     rank  3: 0.63
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.04
     rank 16: 0.03
     rank 17: 0.04
     rank 18: 0.02
     rank 19: 0.01
  optimizer-copy-to-main-grad:
     rank  0: 0.17
     rank  1: 0.17
     rank  2: 0.16
     rank  3: 0.16
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
     rank 16: 0.06
     rank 17: 0.02
     rank 18: 0.01
     rank 19: 0.01
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.04
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.04
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 10.33
     rank  1: 10.30
     rank  2: 10.36
     rank  3: 10.40
     rank  4: 0.03
     rank  5: 0.04
     rank  6: 0.03
     rank  7: 0.05
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.04
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.07
     rank 16: 0.11
     rank 17: 0.06
     rank 18: 0.04
     rank 19: 0.04
  optimizer:
     rank  0: 11.50
     rank  1: 11.47
     rank  2: 11.53
     rank  3: 11.57
     rank  4: 1.20
     rank  5: 1.21
     rank  6: 1.20
     rank  7: 1.22
     rank  8: 1.20
     rank  9: 1.20
     rank 10: 1.20
     rank 11: 1.21
     rank 12: 1.20
     rank 13: 1.20
     rank 14: 1.20
     rank 15: 1.23
     rank 16: 1.27
     rank 17: 1.23
     rank 18: 1.20
     rank 19: 1.20
 [2024-12-16 19:20:05] iteration        4/      10 | consumed samples:          128 | elapsed time per iteration (ms): 8519.9 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 5.392888E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 8478.02
     rank  1: 8477.99
     rank  2: 8478.08
     rank  3: 8478.31
     rank  4: 8477.12
     rank  5: 8477.15
     rank  6: 8477.22
     rank  7: 8477.41
     rank  8: 8477.22
     rank  9: 8477.17
     rank 10: 8477.26
     rank 11: 8477.49
     rank 12: 8477.15
     rank 13: 8477.13
     rank 14: 8477.20
     rank 15: 8477.43
     rank 16: 8477.08
     rank 17: 8477.07
     rank 18: 8477.10
     rank 19: 8477.98
  forward-compute:
     rank  0: 955.89
     rank  1: 961.06
     rank  2: 956.37
     rank  3: 957.72
     rank  4: 3409.39
     rank  5: 3420.01
     rank  6: 3406.70
     rank  7: 3414.58
     rank  8: 3304.30
     rank  9: 3308.04
     rank 10: 3304.88
     rank 11: 3306.96
     rank 12: 3311.98
     rank 13: 3313.18
     rank 14: 3315.42
     rank 15: 3313.94
     rank 16: 3439.89
     rank 17: 3446.14
     rank 18: 3441.59
     rank 19: 3441.57
  backward-compute:
     rank  0: 1081.73
     rank  1: 1088.67
     rank  2: 1079.54
     rank  3: 1087.70
     rank  4: 3221.41
     rank  5: 3221.40
     rank  6: 3222.60
     rank  7: 3220.55
     rank  8: 3206.00
     rank  9: 3208.42
     rank 10: 3208.67
     rank 11: 3205.37
     rank 12: 3233.36
     rank 13: 3235.28
     rank 14: 3233.61
     rank 15: 3235.92
     rank 16: 3416.22
     rank 17: 3423.20
     rank 18: 3423.50
     rank 19: 3419.94
  pure-backward-compute:
     rank  0: 1081.07
     rank  1: 1087.98
     rank  2: 1078.86
     rank  3: 1087.01
     rank  4: 3219.89
     rank  5: 3220.69
     rank  6: 3220.91
     rank  7: 3219.71
     rank  8: 3205.10
     rank  9: 3207.61
     rank 10: 3207.68
     rank 11: 3204.55
     rank 12: 3232.37
     rank 13: 3234.14
     rank 14: 3232.73
     rank 15: 3235.07
     rank 16: 3413.42
     rank 17: 3421.78
     rank 18: 3421.94
     rank 19: 3417.59
  batch-generator:
     rank  0: 51.15
     rank  1: 57.97
     rank  2: 55.02
     rank  3: 56.96
     rank  4: 56.45
     rank  5: 70.89
     rank  6: 72.38
     rank  7: 76.60
     rank  8: 49.35
     rank  9: 55.27
     rank 10: 52.83
     rank 11: 54.42
     rank 12: 58.05
     rank 13: 62.59
     rank 14: 62.70
     rank 15: 59.26
     rank 16: 65.33
     rank 17: 69.93
     rank 18: 66.33
     rank 19: 68.69
  forward-recv:
     rank  4: 83.60
     rank  5: 80.98
     rank  6: 83.51
     rank  7: 83.20
     rank  8: 313.07
     rank  9: 312.96
     rank 10: 313.87
     rank 11: 312.96
     rank 12: 517.18
     rank 13: 517.05
     rank 14: 517.11
     rank 15: 516.70
     rank 16: 724.64
     rank 17: 724.15
     rank 18: 724.21
     rank 19: 724.30
  forward-send:
     rank  0: 511.03
     rank  1: 505.74
     rank  2: 510.92
     rank  3: 509.51
     rank  4: 31.64
     rank  5: 30.04
     rank  6: 31.65
     rank  7: 31.10
     rank  8: 21.82
     rank  9: 20.99
     rank 10: 20.86
     rank 11: 21.66
     rank 12: 10.56
     rank 13: 10.34
     rank 14: 10.31
     rank 15: 10.39
  backward-recv:
     rank  0: 1482.30
     rank  1: 1481.29
     rank  2: 1482.82
     rank  3: 1481.51
     rank  4: 696.70
     rank  5: 697.03
     rank  6: 694.98
     rank  7: 696.59
     rank  8: 454.85
     rank  9: 455.19
     rank 10: 454.72
     rank 11: 455.53
     rank 12: 224.76
     rank 13: 224.67
     rank 14: 225.04
     rank 15: 224.85
  backward-send:
     rank  4: 22.11
     rank  5: 21.12
     rank  6: 21.91
     rank  7: 21.27
     rank  8: 31.28
     rank  9: 30.62
     rank 10: 31.29
     rank 11: 30.66
     rank 12: 20.80
     rank 13: 20.25
     rank 14: 20.55
     rank 15: 20.90
     rank 16: 10.41
     rank 17: 10.03
     rank 18: 10.38
     rank 19: 10.56
  forward-send-backward-recv:
     rank  0: 4431.34
     rank  1: 4425.65
     rank  2: 4436.13
     rank  3: 4428.73
     rank  4: 861.72
     rank  5: 860.94
     rank  6: 861.47
     rank  7: 862.60
     rank  8: 715.66
     rank  9: 716.56
     rank 10: 712.71
     rank 11: 717.83
     rank 12: 502.29
     rank 13: 501.49
     rank 14: 505.47
     rank 15: 503.69
  backward-send-forward-recv:
     rank  4: 72.06
     rank  5: 69.03
     rank  6: 74.28
     rank  7: 70.79
     rank  8: 144.69
     rank  9: 142.00
     rank 10: 144.43
     rank 11: 143.38
     rank 12: 158.33
     rank 13: 156.95
     rank 14: 155.40
     rank 15: 157.24
     rank 16: 170.65
     rank 17: 166.32
     rank 18: 170.12
     rank 19: 170.46
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.02
     rank 19: 0.06
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.06
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.05
     rank 17: 0.04
     rank 18: 0.05
     rank 19: 0.16
  all-grads-sync:
     rank  0: 0.62
     rank  1: 0.62
     rank  2: 0.63
     rank  3: 0.64
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.02
     rank 19: 0.24
  optimizer-copy-to-main-grad:
     rank  0: 0.18
     rank  1: 0.17
     rank  2: 0.17
     rank  3: 0.17
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
     rank 16: 0.04
     rank 17: 0.01
     rank 18: 0.02
     rank 19: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.03
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.03
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.03
  optimizer-inner-step:
     rank  0: 10.30
     rank  1: 10.15
     rank  2: 10.34
     rank  3: 10.47
     rank  4: 0.03
     rank  5: 0.07
     rank  6: 0.04
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.04
     rank 11: 0.06
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.06
     rank 15: 0.04
     rank 16: 0.14
     rank 17: 0.05
     rank 18: 0.07
     rank 19: 0.09
  optimizer:
     rank  0: 11.29
     rank  1: 11.14
     rank  2: 11.34
     rank  3: 11.44
     rank  4: 1.02
     rank  5: 1.06
     rank  6: 1.03
     rank  7: 1.02
     rank  8: 1.02
     rank  9: 1.02
     rank 10: 1.02
     rank 11: 1.05
     rank 12: 1.02
     rank 13: 1.02
     rank 14: 1.05
     rank 15: 1.03
     rank 16: 1.13
     rank 17: 1.03
     rank 18: 1.05
     rank 19: 1.12
 [2024-12-16 19:20:14] iteration        5/      10 | consumed samples:          160 | elapsed time per iteration (ms): 8521.2 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 3.555741E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 8482.23
     rank  1: 8482.19
     rank  2: 8482.20
     rank  3: 8482.18
     rank  4: 8481.35
     rank  5: 8481.32
     rank  6: 8481.27
     rank  7: 8481.33
     rank  8: 8481.39
     rank  9: 8481.37
     rank 10: 8481.36
     rank 11: 8481.43
     rank 12: 8481.38
     rank 13: 8481.33
     rank 14: 8481.35
     rank 15: 8481.39
     rank 16: 8481.49
     rank 17: 8481.22
     rank 18: 8481.22
     rank 19: 8481.35
  forward-compute:
     rank  0: 956.47
     rank  1: 962.41
     rank  2: 957.29
     rank  3: 962.08
     rank  4: 3391.51
     rank  5: 3398.99
     rank  6: 3392.92
     rank  7: 3400.85
     rank  8: 3320.21
     rank  9: 3324.26
     rank 10: 3320.50
     rank 11: 3325.67
     rank 12: 3311.55
     rank 13: 3311.89
     rank 14: 3314.90
     rank 15: 3313.49
     rank 16: 3443.02
     rank 17: 3447.07
     rank 18: 3445.19
     rank 19: 3442.33
  backward-compute:
     rank  0: 1081.63
     rank  1: 1085.97
     rank  2: 1082.95
     rank  3: 1087.16
     rank  4: 3226.95
     rank  5: 3227.56
     rank  6: 3226.02
     rank  7: 3225.93
     rank  8: 3217.01
     rank  9: 3218.64
     rank 10: 3219.69
     rank 11: 3216.42
     rank 12: 3236.62
     rank 13: 3238.53
     rank 14: 3237.42
     rank 15: 3237.45
     rank 16: 3414.02
     rank 17: 3416.48
     rank 18: 3417.85
     rank 19: 3411.99
  pure-backward-compute:
     rank  0: 1080.97
     rank  1: 1085.24
     rank  2: 1082.30
     rank  3: 1086.38
     rank  4: 3225.56
     rank  5: 3226.70
     rank  6: 3225.04
     rank  7: 3225.18
     rank  8: 3216.15
     rank  9: 3217.91
     rank 10: 3218.53
     rank 11: 3215.65
     rank 12: 3235.65
     rank 13: 3237.30
     rank 14: 3236.70
     rank 15: 3236.72
     rank 16: 3411.64
     rank 17: 3414.86
     rank 18: 3416.46
     rank 19: 3408.99
  batch-generator:
     rank  0: 50.88
     rank  1: 58.83
     rank  2: 54.50
     rank  3: 60.07
     rank  4: 57.56
     rank  5: 66.22
     rank  6: 65.45
     rank  7: 75.27
     rank  8: 49.34
     rank  9: 55.45
     rank 10: 52.98
     rank 11: 56.42
     rank 12: 50.61
     rank 13: 55.64
     rank 14: 56.43
     rank 15: 53.11
     rank 16: 52.75
     rank 17: 59.08
     rank 18: 56.52
     rank 19: 57.31
  forward-recv:
     rank  4: 81.97
     rank  5: 79.19
     rank  6: 81.81
     rank  7: 79.22
     rank  8: 312.44
     rank  9: 311.82
     rank 10: 312.55
     rank 11: 311.31
     rank 12: 520.40
     rank 13: 520.03
     rank 14: 520.88
     rank 15: 520.12
     rank 16: 727.96
     rank 17: 727.95
     rank 18: 727.57
     rank 19: 727.88
  forward-send:
     rank  0: 511.76
     rank  1: 505.77
     rank  2: 511.38
     rank  3: 506.14
     rank  4: 32.79
     rank  5: 30.90
     rank  6: 32.59
     rank  7: 30.37
     rank  8: 21.32
     rank  9: 20.67
     rank 10: 20.91
     rank 11: 20.36
     rank 12: 10.59
     rank 13: 10.56
     rank 14: 10.02
     rank 15: 10.31
  backward-recv:
     rank  0: 1486.41
     rank  1: 1484.60
     rank  2: 1486.33
     rank  3: 1485.15
     rank  4: 697.24
     rank  5: 698.07
     rank  6: 697.76
     rank  7: 698.80
     rank  8: 455.06
     rank  9: 455.37
     rank 10: 454.47
     rank 11: 455.58
     rank 12: 226.84
     rank 13: 226.90
     rank 14: 227.00
     rank 15: 226.75
  backward-send:
     rank  4: 22.68
     rank  5: 21.21
     rank  6: 22.53
     rank  7: 21.39
     rank  8: 31.09
     rank  9: 30.04
     rank 10: 31.33
     rank 11: 30.99
     rank 12: 20.77
     rank 13: 20.14
     rank 14: 20.69
     rank 15: 20.85
     rank 16: 10.49
     rank 17: 9.98
     rank 18: 10.48
     rank 19: 10.45
  forward-send-backward-recv:
     rank  0: 4430.25
     rank  1: 4427.45
     rank  2: 4431.99
     rank  3: 4428.94
     rank  4: 874.84
     rank  5: 875.11
     rank  6: 874.78
     rank  7: 876.26
     rank  8: 692.92
     rank  9: 693.73
     rank 10: 689.79
     rank 11: 694.04
     rank 12: 494.31
     rank 13: 493.04
     rank 14: 496.15
     rank 15: 496.74
  backward-send-forward-recv:
     rank  4: 73.89
     rank  5: 72.69
     rank  6: 73.50
     rank  7: 71.57
     rank  8: 144.47
     rank  9: 141.77
     rank 10: 144.51
     rank 11: 143.01
     rank 12: 158.59
     rank 13: 157.89
     rank 14: 155.80
     rank 15: 157.65
     rank 16: 169.92
     rank 17: 167.01
     rank 18: 168.72
     rank 19: 170.69
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.03
     rank 17: 0.02
     rank 18: 0.01
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.07
     rank 17: 0.04
     rank 18: 0.04
     rank 19: 0.06
  all-grads-sync:
     rank  0: 0.61
     rank  1: 0.61
     rank  2: 0.62
     rank  3: 0.66
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.03
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.17
     rank  1: 0.17
     rank  2: 0.16
     rank  3: 0.17
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 10.09
     rank  1: 10.35
     rank  2: 10.37
     rank  3: 10.35
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.04
     rank  8: 0.04
     rank  9: 0.06
     rank 10: 0.06
     rank 11: 0.03
     rank 12: 0.06
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
     rank 16: 0.05
     rank 17: 0.03
     rank 18: 0.03
     rank 19: 0.08
  optimizer:
     rank  0: 10.68
     rank  1: 10.95
     rank  2: 10.96
     rank  3: 10.95
     rank  4: 0.63
     rank  5: 0.63
     rank  6: 0.63
     rank  7: 0.64
     rank  8: 0.64
     rank  9: 0.66
     rank 10: 0.66
     rank 11: 0.63
     rank 12: 0.66
     rank 13: 0.63
     rank 14: 0.63
     rank 15: 0.63
     rank 16: 0.65
     rank 17: 0.63
     rank 18: 0.63
     rank 19: 0.67
 [2024-12-16 19:20:22] iteration        6/      10 | consumed samples:          192 | elapsed time per iteration (ms): 8505.4 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 2.137064E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 8464.37
     rank  1: 8464.40
     rank  2: 8464.38
     rank  3: 8464.68
     rank  4: 8463.48
     rank  5: 8463.54
     rank  6: 8463.49
     rank  7: 8463.79
     rank  8: 8464.36
     rank  9: 8463.58
     rank 10: 8463.53
     rank 11: 8463.84
     rank 12: 8463.72
     rank 13: 8463.57
     rank 14: 8463.49
     rank 15: 8463.78
     rank 16: 8463.50
     rank 17: 8463.44
     rank 18: 8463.44
     rank 19: 8464.31
  forward-compute:
     rank  0: 957.36
     rank  1: 965.09
     rank  2: 957.81
     rank  3: 961.09
     rank  4: 3401.60
     rank  5: 3414.50
     rank  6: 3401.58
     rank  7: 3406.85
     rank  8: 3321.09
     rank  9: 3326.94
     rank 10: 3320.87
     rank 11: 3325.99
     rank 12: 3313.33
     rank 13: 3315.14
     rank 14: 3315.18
     rank 15: 3314.48
     rank 16: 3434.34
     rank 17: 3440.61
     rank 18: 3434.77
     rank 19: 3434.14
  backward-compute:
     rank  0: 1080.91
     rank  1: 1089.19
     rank  2: 1081.05
     rank  3: 1084.82
     rank  4: 3228.82
     rank  5: 3230.13
     rank  6: 3230.01
     rank  7: 3228.93
     rank  8: 3215.32
     rank  9: 3217.31
     rank 10: 3217.55
     rank 11: 3214.69
     rank 12: 3240.52
     rank 13: 3244.23
     rank 14: 3240.31
     rank 15: 3241.87
     rank 16: 3411.24
     rank 17: 3413.95
     rank 18: 3414.13
     rank 19: 3410.49
  pure-backward-compute:
     rank  0: 1080.25
     rank  1: 1088.47
     rank  2: 1080.42
     rank  3: 1084.15
     rank  4: 3227.62
     rank  5: 3229.44
     rank  6: 3228.49
     rank  7: 3227.98
     rank  8: 3214.40
     rank  9: 3216.59
     rank 10: 3216.52
     rank 11: 3213.95
     rank 12: 3239.59
     rank 13: 3243.18
     rank 14: 3239.60
     rank 15: 3241.03
     rank 16: 3409.15
     rank 17: 3412.45
     rank 18: 3412.29
     rank 19: 3407.76
  batch-generator:
     rank  0: 50.99
     rank  1: 60.46
     rank  2: 53.95
     rank  3: 57.74
     rank  4: 58.69
     rank  5: 74.93
     rank  6: 60.59
     rank  7: 70.79
     rank  8: 50.85
     rank  9: 59.21
     rank 10: 54.10
     rank 11: 56.94
     rank 12: 48.22
     rank 13: 54.67
     rank 14: 53.05
     rank 15: 50.43
     rank 16: 53.87
     rank 17: 60.93
     rank 18: 58.22
     rank 19: 57.67
  forward-recv:
     rank  4: 82.06
     rank  5: 79.25
     rank  6: 82.02
     rank  7: 81.08
     rank  8: 310.88
     rank  9: 309.32
     rank 10: 310.56
     rank 11: 310.29
     rank 12: 519.65
     rank 13: 518.15
     rank 14: 520.43
     rank 15: 519.67
     rank 16: 726.03
     rank 17: 725.90
     rank 18: 725.56
     rank 19: 725.97
  forward-send:
     rank  0: 509.77
     rank  1: 501.98
     rank  2: 509.70
     rank  3: 506.23
     rank  4: 33.09
     rank  5: 28.76
     rank  6: 33.08
     rank  7: 31.84
     rank  8: 20.67
     rank  9: 18.94
     rank 10: 20.85
     rank 11: 20.43
     rank 12: 10.53
     rank 13: 10.43
     rank 14: 9.97
     rank 15: 10.43
  backward-recv:
     rank  0: 1485.49
     rank  1: 1482.19
     rank  2: 1485.32
     rank  3: 1484.92
     rank  4: 695.20
     rank  5: 697.88
     rank  6: 695.23
     rank  7: 694.78
     rank  8: 457.34
     rank  9: 457.79
     rank 10: 457.34
     rank 11: 457.92
     rank 12: 226.82
     rank 13: 226.75
     rank 14: 226.89
     rank 15: 226.83
  backward-send:
     rank  4: 22.15
     rank  5: 19.43
     rank  6: 22.30
     rank  7: 22.20
     rank  8: 31.24
     rank  9: 30.34
     rank 10: 31.17
     rank 11: 31.06
     rank 12: 20.78
     rank 13: 20.26
     rank 14: 20.63
     rank 15: 20.90
     rank 16: 10.47
     rank 17: 10.04
     rank 18: 10.31
     rank 19: 10.53
  forward-send-backward-recv:
     rank  0: 4415.16
     rank  1: 4409.94
     rank  2: 4417.86
     rank  3: 4414.57
     rank  4: 847.67
     rank  5: 846.29
     rank  6: 847.29
     rank  7: 847.89
     rank  8: 675.89
     rank  9: 678.06
     rank 10: 674.34
     rank 11: 677.60
     rank 12: 475.11
     rank 13: 472.17
     rank 14: 478.22
     rank 15: 476.89
  backward-send-forward-recv:
     rank  4: 73.53
     rank  5: 70.25
     rank  6: 72.73
     rank  7: 72.61
     rank  8: 144.23
     rank  9: 141.36
     rank 10: 144.11
     rank 11: 142.23
     rank 12: 158.68
     rank 13: 157.58
     rank 14: 156.70
     rank 15: 157.87
     rank 16: 169.10
     rank 17: 164.17
     rank 18: 169.12
     rank 19: 169.51
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.09
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.01
     rank 19: 0.07
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.05
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.09
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.06
     rank 17: 0.04
     rank 18: 0.04
     rank 19: 0.17
  all-grads-sync:
     rank  0: 0.61
     rank  1: 0.65
     rank  2: 0.62
     rank  3: 0.62
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.12
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.24
  optimizer-copy-to-main-grad:
     rank  0: 0.18
     rank  1: 0.18
     rank  2: 0.16
     rank  3: 0.16
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.03
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.06
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.04
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.03
  optimizer-inner-step:
     rank  0: 10.35
     rank  1: 10.21
     rank  2: 10.35
     rank  3: 10.11
     rank  4: 0.03
     rank  5: 0.07
     rank  6: 0.07
     rank  7: 0.06
     rank  8: 0.06
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.03
     rank 13: 0.04
     rank 14: 0.03
     rank 15: 0.03
     rank 16: 0.06
     rank 17: 0.04
     rank 18: 0.04
     rank 19: 0.19
  optimizer:
     rank  0: 11.48
     rank  1: 11.34
     rank  2: 11.47
     rank  3: 11.22
     rank  4: 1.15
     rank  5: 1.19
     rank  6: 1.19
     rank  7: 1.18
     rank  8: 1.19
     rank  9: 1.16
     rank 10: 1.16
     rank 11: 1.16
     rank 12: 1.15
     rank 13: 1.16
     rank 14: 1.15
     rank 15: 1.16
     rank 16: 1.18
     rank 17: 1.16
     rank 18: 1.16
     rank 19: 1.36
 [2024-12-16 19:20:31] iteration        7/      10 | consumed samples:          224 | elapsed time per iteration (ms): 8520.1 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 1.488108E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 8479.53
     rank  1: 8479.48
     rank  2: 8479.49
     rank  3: 8479.52
     rank  4: 8478.69
     rank  5: 8478.61
     rank  6: 8478.59
     rank  7: 8478.63
     rank  8: 8478.74
     rank  9: 8478.65
     rank 10: 8478.66
     rank 11: 8478.69
     rank 12: 8478.70
     rank 13: 8478.61
     rank 14: 8478.61
     rank 15: 8478.64
     rank 16: 8478.56
     rank 17: 8478.58
     rank 18: 8478.55
     rank 19: 8478.74
  forward-compute:
     rank  0: 960.08
     rank  1: 971.13
     rank  2: 960.46
     rank  3: 963.64
     rank  4: 3403.40
     rank  5: 3420.69
     rank  6: 3403.93
     rank  7: 3408.11
     rank  8: 3334.07
     rank  9: 3342.20
     rank 10: 3334.76
     rank 11: 3339.52
     rank 12: 3316.04
     rank 13: 3317.27
     rank 14: 3317.76
     rank 15: 3318.51
     rank 16: 3440.69
     rank 17: 3446.10
     rank 18: 3443.08
     rank 19: 3440.28
  backward-compute:
     rank  0: 1084.67
     rank  1: 1090.84
     rank  2: 1085.32
     rank  3: 1089.61
     rank  4: 3228.22
     rank  5: 3230.27
     rank  6: 3228.50
     rank  7: 3227.71
     rank  8: 3224.54
     rank  9: 3225.51
     rank 10: 3226.32
     rank 11: 3223.94
     rank 12: 3232.38
     rank 13: 3234.05
     rank 14: 3233.46
     rank 15: 3232.25
     rank 16: 3413.85
     rank 17: 3416.03
     rank 18: 3416.47
     rank 19: 3412.04
  pure-backward-compute:
     rank  0: 1084.00
     rank  1: 1090.17
     rank  2: 1084.57
     rank  3: 1088.96
     rank  4: 3226.95
     rank  5: 3229.60
     rank  6: 3226.95
     rank  7: 3226.61
     rank  8: 3222.97
     rank  9: 3224.79
     rank 10: 3225.14
     rank 11: 3223.23
     rank 12: 3231.39
     rank 13: 3233.05
     rank 14: 3232.72
     rank 15: 3231.54
     rank 16: 3411.73
     rank 17: 3414.61
     rank 18: 3414.96
     rank 19: 3408.94
  batch-generator:
     rank  0: 53.95
     rank  1: 67.22
     rank  2: 57.19
     rank  3: 60.58
     rank  4: 52.48
     rank  5: 74.76
     rank  6: 57.98
     rank  7: 70.22
     rank  8: 61.93
     rank  9: 70.89
     rank 10: 64.72
     rank 11: 66.91
     rank 12: 51.56
     rank 13: 56.78
     rank 14: 55.61
     rank 15: 54.33
     rank 16: 51.82
     rank 17: 58.00
     rank 18: 56.60
     rank 19: 55.66
  forward-recv:
     rank  4: 80.86
     rank  5: 75.41
     rank  6: 80.71
     rank  7: 79.40
     rank  8: 308.83
     rank  9: 305.52
     rank 10: 308.73
     rank 11: 308.18
     rank 12: 519.89
     rank 13: 519.12
     rank 14: 520.76
     rank 15: 520.15
     rank 16: 726.25
     rank 17: 726.11
     rank 18: 725.86
     rank 19: 726.32
  forward-send:
     rank  0: 510.29
     rank  1: 499.23
     rank  2: 510.18
     rank  3: 506.86
     rank  4: 35.23
     rank  5: 29.73
     rank  6: 35.40
     rank  7: 34.38
     rank  8: 20.69
     rank  9: 19.55
     rank 10: 21.01
     rank 11: 20.71
     rank 12: 10.56
     rank 13: 10.41
     rank 14: 10.01
     rank 15: 10.40
  backward-recv:
     rank  0: 1490.85
     rank  1: 1490.12
     rank  2: 1491.09
     rank  3: 1489.48
     rank  4: 697.12
     rank  5: 697.52
     rank  6: 697.16
     rank  7: 699.49
     rank  8: 453.44
     rank  9: 454.38
     rank 10: 453.29
     rank 11: 453.70
     rank 12: 228.06
     rank 13: 227.85
     rank 14: 228.25
     rank 15: 228.68
  backward-send:
     rank  4: 22.47
     rank  5: 21.71
     rank  6: 22.64
     rank  7: 21.01
     rank  8: 31.26
     rank  9: 30.03
     rank 10: 31.32
     rank 11: 31.13
     rank 12: 20.93
     rank 13: 20.19
     rank 14: 20.66
     rank 15: 20.46
     rank 16: 10.47
     rank 17: 9.98
     rank 18: 10.39
     rank 19: 10.61
  forward-send-backward-recv:
     rank  0: 4417.40
     rank  1: 4412.36
     rank  2: 4419.99
     rank  3: 4417.43
     rank  4: 853.00
     rank  5: 850.07
     rank  6: 851.90
     rank  7: 851.75
     rank  8: 667.76
     rank  9: 671.12
     rank 10: 666.59
     rank 11: 669.48
     rank 12: 488.21
     rank 13: 487.28
     rank 14: 490.24
     rank 15: 490.75
  backward-send-forward-recv:
     rank  4: 73.52
     rank  5: 70.11
     rank  6: 73.58
     rank  7: 73.64
     rank  8: 144.32
     rank  9: 141.38
     rank 10: 144.14
     rank 11: 142.89
     rank 12: 158.58
     rank 13: 157.68
     rank 14: 156.68
     rank 15: 156.89
     rank 16: 170.04
     rank 17: 166.02
     rank 18: 168.48
     rank 19: 170.54
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.04
     rank  2: 0.05
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.05
     rank 17: 0.05
     rank 18: 0.05
     rank 19: 0.08
  all-grads-sync:
     rank  0: 0.65
     rank  1: 0.62
     rank  2: 0.66
     rank  3: 0.62
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.03
  optimizer-copy-to-main-grad:
     rank  0: 0.18
     rank  1: 0.17
     rank  2: 0.16
     rank  3: 0.16
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.02
     rank 18: 0.01
     rank 19: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 10.33
     rank  1: 10.36
     rank  2: 10.44
     rank  3: 10.41
     rank  4: 0.03
     rank  5: 0.07
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.07
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.06
     rank 14: 0.03
     rank 15: 0.06
     rank 16: 0.03
     rank 17: 0.06
     rank 18: 0.07
     rank 19: 0.10
  optimizer:
     rank  0: 10.96
     rank  1: 11.00
     rank  2: 11.08
     rank  3: 11.04
     rank  4: 0.67
     rank  5: 0.70
     rank  6: 0.67
     rank  7: 0.67
     rank  8: 0.70
     rank  9: 0.67
     rank 10: 0.67
     rank 11: 0.67
     rank 12: 0.67
     rank 13: 0.69
     rank 14: 0.66
     rank 15: 0.69
     rank 16: 0.67
     rank 17: 0.70
     rank 18: 0.71
     rank 19: 0.74
 [2024-12-16 19:20:39] iteration        8/      10 | consumed samples:          256 | elapsed time per iteration (ms): 8515.6 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 1.082686E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 8479.77
     rank  1: 8479.65
     rank  2: 8479.67
     rank  3: 8479.71
     rank  4: 8478.88
     rank  5: 8478.78
     rank  6: 8478.76
     rank  7: 8478.80
     rank  8: 8478.99
     rank  9: 8478.82
     rank 10: 8478.82
     rank 11: 8478.86
     rank 12: 8478.91
     rank 13: 8478.78
     rank 14: 8478.79
     rank 15: 8478.83
     rank 16: 8478.94
     rank 17: 8478.70
     rank 18: 8478.71
     rank 19: 8478.80
  forward-compute:
     rank  0: 960.18
     rank  1: 969.42
     rank  2: 960.71
     rank  3: 963.91
     rank  4: 3392.64
     rank  5: 3406.99
     rank  6: 3394.00
     rank  7: 3398.86
     rank  8: 3335.23
     rank  9: 3341.98
     rank 10: 3335.40
     rank 11: 3340.12
     rank 12: 3316.59
     rank 13: 3318.60
     rank 14: 3318.58
     rank 15: 3318.03
     rank 16: 3443.37
     rank 17: 3448.67
     rank 18: 3445.81
     rank 19: 3443.53
  backward-compute:
     rank  0: 1069.30
     rank  1: 1074.11
     rank  2: 1069.62
     rank  3: 1073.27
     rank  4: 3226.94
     rank  5: 3228.52
     rank  6: 3227.52
     rank  7: 3227.46
     rank  8: 3238.88
     rank  9: 3240.75
     rank 10: 3241.15
     rank 11: 3237.73
     rank 12: 3229.72
     rank 13: 3231.47
     rank 14: 3230.82
     rank 15: 3231.39
     rank 16: 3418.03
     rank 17: 3419.72
     rank 18: 3421.12
     rank 19: 3416.91
  pure-backward-compute:
     rank  0: 1068.63
     rank  1: 1073.44
     rank  2: 1068.92
     rank  3: 1072.59
     rank  4: 3225.91
     rank  5: 3227.81
     rank  6: 3226.33
     rank  7: 3226.43
     rank  8: 3237.35
     rank  9: 3240.04
     rank 10: 3240.27
     rank 11: 3236.98
     rank 12: 3228.80
     rank 13: 3230.50
     rank 14: 3230.13
     rank 15: 3230.62
     rank 16: 3415.61
     rank 17: 3418.21
     rank 18: 3419.76
     rank 19: 3414.36
  batch-generator:
     rank  0: 51.39
     rank  1: 62.79
     rank  2: 54.65
     rank  3: 58.16
     rank  4: 55.23
     rank  5: 69.70
     rank  6: 61.15
     rank  7: 67.51
     rank  8: 58.69
     rank  9: 66.83
     rank 10: 61.57
     rank 11: 63.55
     rank 12: 51.68
     rank 13: 58.40
     rank 14: 56.35
     rank 15: 53.73
     rank 16: 63.53
     rank 17: 68.34
     rank 18: 65.50
     rank 19: 66.00
  forward-recv:
     rank  4: 82.10
     rank  5: 79.08
     rank  6: 82.20
     rank  7: 81.43
     rank  8: 309.28
     rank  9: 307.11
     rank 10: 309.30
     rank 11: 308.82
     rank 12: 519.72
     rank 13: 518.30
     rank 14: 520.34
     rank 15: 519.65
     rank 16: 725.90
     rank 17: 725.79
     rank 18: 725.52
     rank 19: 725.95
  forward-send:
     rank  0: 509.61
     rank  1: 500.44
     rank  2: 509.41
     rank  3: 506.03
     rank  4: 34.12
     rank  5: 28.85
     rank  6: 33.83
     rank  7: 32.43
     rank  8: 20.94
     rank  9: 19.15
     rank 10: 20.90
     rank 11: 20.48
     rank 12: 10.54
     rank 13: 10.48
     rank 14: 10.04
     rank 15: 10.34
  backward-recv:
     rank  0: 1501.63
     rank  1: 1501.03
     rank  2: 1501.65
     rank  3: 1501.01
     rank  4: 708.54
     rank  5: 708.42
     rank  6: 708.65
     rank  7: 707.63
     rank  8: 458.78
     rank  9: 459.20
     rank 10: 458.95
     rank 11: 459.88
     rank 12: 229.69
     rank 13: 229.49
     rank 14: 229.86
     rank 15: 229.67
  backward-send:
     rank  4: 22.42
     rank  5: 21.89
     rank  6: 22.33
     rank  7: 21.92
     rank  8: 31.44
     rank  9: 30.67
     rank 10: 31.37
     rank 11: 30.57
     rank 12: 20.83
     rank 13: 20.33
     rank 14: 20.63
     rank 15: 20.83
     rank 16: 10.50
     rank 17: 10.00
     rank 18: 10.37
     rank 19: 10.47
  forward-send-backward-recv:
     rank  0: 4423.28
     rank  1: 4419.12
     rank  2: 4425.82
     rank  3: 4422.75
     rank  4: 859.88
     rank  5: 857.94
     rank  6: 858.43
     rank  7: 860.04
     rank  8: 654.03
     rank  9: 655.62
     rank 10: 651.96
     rank 11: 655.08
     rank 12: 494.85
     rank 13: 493.19
     rank 14: 496.26
     rank 15: 496.11
  backward-send-forward-recv:
     rank  4: 73.77
     rank  5: 71.28
     rank  6: 73.63
     rank  7: 72.40
     rank  8: 144.33
     rank  9: 141.68
     rank 10: 144.56
     rank 11: 143.27
     rank 12: 158.42
     rank 13: 157.46
     rank 14: 156.59
     rank 15: 157.61
     rank 16: 170.06
     rank 17: 166.44
     rank 18: 168.96
     rank 19: 170.74
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.03
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.08
     rank 17: 0.04
     rank 18: 0.04
     rank 19: 0.05
  all-grads-sync:
     rank  0: 0.63
     rank  1: 0.62
     rank  2: 0.64
     rank  3: 0.67
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.03
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.04
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.18
     rank  1: 0.17
     rank  2: 0.17
     rank  3: 0.17
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 10.13
     rank  1: 10.33
     rank  2: 10.39
     rank  3: 10.37
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.07
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.04
     rank 14: 0.03
     rank 15: 0.04
     rank 16: 0.09
     rank 17: 0.04
     rank 18: 0.04
     rank 19: 0.07
  optimizer:
     rank  0: 10.79
     rank  1: 11.01
     rank  2: 11.06
     rank  3: 11.04
     rank  4: 0.70
     rank  5: 0.70
     rank  6: 0.70
     rank  7: 0.70
     rank  8: 0.74
     rank  9: 0.70
     rank 10: 0.70
     rank 11: 0.70
     rank 12: 0.70
     rank 13: 0.71
     rank 14: 0.70
     rank 15: 0.71
     rank 16: 0.76
     rank 17: 0.71
     rank 18: 0.71
     rank 19: 0.74
 [2024-12-16 19:20:48] iteration        9/      10 | consumed samples:          288 | elapsed time per iteration (ms): 8506.3 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 9.932018E-01 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 8465.25
     rank  1: 8465.27
     rank  2: 8465.24
     rank  3: 8465.31
     rank  4: 8464.38
     rank  5: 8464.41
     rank  6: 8464.33
     rank  7: 8464.41
     rank  8: 8464.44
     rank  9: 8464.44
     rank 10: 8464.42
     rank 11: 8464.48
     rank 12: 8464.39
     rank 13: 8464.41
     rank 14: 8464.34
     rank 15: 8464.44
     rank 16: 8464.36
     rank 17: 8464.41
     rank 18: 8464.34
     rank 19: 8464.47
  forward-compute:
     rank  0: 957.09
     rank  1: 968.47
     rank  2: 957.02
     rank  3: 960.21
     rank  4: 3404.46
     rank  5: 3418.52
     rank  6: 3404.78
     rank  7: 3414.10
     rank  8: 3332.52
     rank  9: 3339.82
     rank 10: 3332.20
     rank 11: 3336.54
     rank 12: 3314.04
     rank 13: 3315.60
     rank 14: 3316.35
     rank 15: 3315.93
     rank 16: 3429.61
     rank 17: 3433.43
     rank 18: 3431.29
     rank 19: 3431.25
  backward-compute:
     rank  0: 1080.66
     rank  1: 1085.53
     rank  2: 1081.11
     rank  3: 1090.14
     rank  4: 3230.71
     rank  5: 3232.18
     rank  6: 3231.20
     rank  7: 3228.76
     rank  8: 3227.93
     rank  9: 3229.95
     rank 10: 3230.84
     rank 11: 3228.22
     rank 12: 3232.78
     rank 13: 3233.19
     rank 14: 3232.48
     rank 15: 3234.40
     rank 16: 3416.31
     rank 17: 3418.16
     rank 18: 3419.25
     rank 19: 3414.51
  pure-backward-compute:
     rank  0: 1080.00
     rank  1: 1084.84
     rank  2: 1080.44
     rank  3: 1089.48
     rank  4: 3229.38
     rank  5: 3231.30
     rank  6: 3229.57
     rank  7: 3227.97
     rank  8: 3226.93
     rank  9: 3229.23
     rank 10: 3229.87
     rank 11: 3227.47
     rank 12: 3231.91
     rank 13: 3232.09
     rank 14: 3231.77
     rank 15: 3233.69
     rank 16: 3414.24
     rank 17: 3416.67
     rank 18: 3417.95
     rank 19: 3412.42
  batch-generator:
     rank  0: 51.23
     rank  1: 64.53
     rank  2: 53.29
     rank  3: 57.27
     rank  4: 64.57
     rank  5: 82.17
     rank  6: 68.61
     rank  7: 80.64
     rank  8: 52.24
     rank  9: 62.04
     rank 10: 55.23
     rank 11: 57.36
     rank 12: 50.68
     rank 13: 56.92
     rank 14: 55.66
     rank 15: 53.26
     rank 16: 51.13
     rank 17: 56.37
     rank 18: 54.09
     rank 19: 56.72
  forward-recv:
     rank  4: 81.04
     rank  5: 75.76
     rank  6: 81.08
     rank  7: 80.07
     rank  8: 309.34
     rank  9: 306.07
     rank 10: 309.27
     rank 11: 309.00
     rank 12: 519.17
     rank 13: 518.05
     rank 14: 519.96
     rank 15: 519.27
     rank 16: 726.05
     rank 17: 726.05
     rank 18: 725.62
     rank 19: 726.07
  forward-send:
     rank  0: 509.24
     rank  1: 497.78
     rank  2: 509.55
     rank  3: 506.23
     rank  4: 35.29
     rank  5: 29.59
     rank  6: 35.19
     rank  7: 34.32
     rank  8: 20.90
     rank  9: 19.41
     rank 10: 20.92
     rank 11: 20.56
     rank 12: 10.56
     rank 13: 10.49
     rank 14: 9.87
     rank 15: 10.32
  backward-recv:
     rank  0: 1489.85
     rank  1: 1488.26
     rank  2: 1490.07
     rank  3: 1488.07
     rank  4: 696.50
     rank  5: 697.77
     rank  6: 696.37
     rank  7: 698.16
     rank  8: 453.55
     rank  9: 454.62
     rank 10: 453.70
     rank 11: 454.47
     rank 12: 228.67
     rank 13: 228.75
     rank 14: 228.72
     rank 15: 228.95
  backward-send:
     rank  4: 22.64
     rank  5: 21.02
     rank  6: 22.52
     rank  7: 21.07
     rank  8: 31.36
     rank  9: 30.16
     rank 10: 31.35
     rank 11: 30.86
     rank 12: 20.84
     rank 13: 20.41
     rank 14: 20.83
     rank 15: 20.63
     rank 16: 10.47
     rank 17: 10.39
     rank 18: 10.45
     rank 19: 10.31
  forward-send-backward-recv:
     rank  0: 4412.81
     rank  1: 4409.52
     rank  2: 4415.29
     rank  3: 4407.96
     rank  4: 843.18
     rank  5: 841.82
     rank  6: 842.97
     rank  7: 844.74
     rank  8: 659.27
     rank  9: 661.06
     rank 10: 657.21
     rank 11: 659.60
     rank 12: 480.82
     rank 13: 480.27
     rank 14: 483.82
     rank 15: 481.85
  backward-send-forward-recv:
     rank  4: 72.97
     rank  5: 72.03
     rank  6: 72.60
     rank  7: 68.27
     rank  8: 144.43
     rank  9: 141.33
     rank 10: 144.53
     rank 11: 143.33
     rank 12: 158.49
     rank 13: 157.68
     rank 14: 156.32
     rank 15: 157.45
     rank 16: 169.90
     rank 17: 167.33
     rank 18: 169.39
     rank 19: 169.37
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
     rank 16: 0.05
     rank 17: 0.06
     rank 18: 0.05
     rank 19: 0.07
  all-grads-sync:
     rank  0: 0.62
     rank  1: 0.62
     rank  2: 0.62
     rank  3: 0.62
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.03
  optimizer-copy-to-main-grad:
     rank  0: 0.18
     rank  1: 0.18
     rank  2: 0.16
     rank  3: 0.17
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.02
     rank 18: 0.01
     rank 19: 0.01
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 10.19
     rank  1: 10.38
     rank  2: 10.38
     rank  3: 10.38
     rank  4: 0.06
     rank  5: 0.07
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.04
     rank  9: 0.03
     rank 10: 0.04
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
     rank 16: 0.04
     rank 17: 0.04
     rank 18: 0.04
     rank 19: 0.04
  optimizer:
     rank  0: 10.79
     rank  1: 10.99
     rank  2: 10.98
     rank  3: 10.98
     rank  4: 0.65
     rank  5: 0.66
     rank  6: 0.63
     rank  7: 0.63
     rank  8: 0.64
     rank  9: 0.63
     rank 10: 0.63
     rank 11: 0.63
     rank 12: 0.63
     rank 13: 0.63
     rank 14: 0.63
     rank 15: 0.63
     rank 16: 0.64
     rank 17: 0.64
     rank 18: 0.63
     rank 19: 0.64
 [2024-12-16 19:20:56] iteration       10/      10 | consumed samples:          320 | elapsed time per iteration (ms): 8507.2 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 1.102679E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 8466.97
     rank  1: 8466.97
     rank  2: 8467.00
     rank  3: 8467.01
     rank  4: 8466.14
     rank  5: 8466.09
     rank  6: 8466.08
     rank  7: 8466.12
     rank  8: 8466.31
     rank  9: 8466.14
     rank 10: 8466.14
     rank 11: 8466.21
     rank 12: 8466.15
     rank 13: 8466.10
     rank 14: 8466.17
     rank 15: 8466.13
     rank 16: 8466.09
     rank 17: 8466.04
     rank 18: 8466.04
     rank 19: 8466.12
  forward-compute:
     rank  0: 978.55
     rank  1: 987.95
     rank  2: 979.59
     rank  3: 982.14
     rank  4: 3444.96
     rank  5: 3462.29
     rank  6: 3450.02
     rank  7: 3456.54
     rank  8: 3334.75
     rank  9: 3340.21
     rank 10: 3334.53
     rank 11: 3339.34
     rank 12: 3313.67
     rank 13: 3315.67
     rank 14: 3315.51
     rank 15: 3315.17
     rank 16: 3433.98
     rank 17: 3438.41
     rank 18: 3435.39
     rank 19: 3434.27
  backward-compute:
     rank  0: 1081.09
     rank  1: 1091.79
     rank  2: 1085.04
     rank  3: 1092.06
     rank  4: 3236.78
     rank  5: 3235.87
     rank  6: 3234.76
     rank  7: 3233.63
     rank  8: 3216.82
     rank  9: 3218.80
     rank 10: 3219.08
     rank 11: 3216.84
     rank 12: 3240.44
     rank 13: 3241.90
     rank 14: 3240.53
     rank 15: 3241.58
     rank 16: 3416.93
     rank 17: 3418.77
     rank 18: 3420.42
     rank 19: 3415.88
  pure-backward-compute:
     rank  0: 1080.35
     rank  1: 1091.10
     rank  2: 1084.34
     rank  3: 1091.41
     rank  4: 3234.68
     rank  5: 3235.02
     rank  6: 3233.50
     rank  7: 3232.77
     rank  8: 3215.60
     rank  9: 3218.10
     rank 10: 3218.17
     rank 11: 3215.92
     rank 12: 3239.55
     rank 13: 3240.91
     rank 14: 3239.76
     rank 15: 3240.85
     rank 16: 3414.78
     rank 17: 3417.17
     rank 18: 3419.12
     rank 19: 3413.79
  batch-generator:
     rank  0: 55.52
     rank  1: 65.76
     rank  2: 59.60
     rank  3: 62.31
     rank  4: 103.45
     rank  5: 111.92
     rank  6: 102.69
     rank  7: 105.77
     rank  8: 56.46
     rank  9: 63.35
     rank 10: 58.22
     rank 11: 60.85
     rank 12: 48.25
     rank 13: 55.09
     rank 14: 53.04
     rank 15: 50.70
     rank 16: 53.65
     rank 17: 59.59
     rank 18: 55.80
     rank 19: 57.17
  forward-recv:
     rank  4: 81.20
     rank  5: 77.51
     rank  6: 81.15
     rank  7: 80.38
     rank  8: 314.34
     rank  9: 313.15
     rank 10: 314.62
     rank 11: 314.18
     rank 12: 519.32
     rank 13: 517.72
     rank 14: 519.86
     rank 15: 519.24
     rank 16: 726.52
     rank 17: 726.41
     rank 18: 726.12
     rank 19: 726.57
  forward-send:
     rank  0: 516.98
     rank  1: 507.66
     rank  2: 516.46
     rank  3: 513.73
     rank  4: 33.51
     rank  5: 29.02
     rank  6: 33.26
     rank  7: 32.14
     rank  8: 20.84
     rank  9: 18.95
     rank 10: 20.76
     rank 11: 20.36
     rank 12: 10.57
     rank 13: 10.48
     rank 14: 10.00
     rank 15: 10.34
  backward-recv:
     rank  0: 1489.61
     rank  1: 1487.38
     rank  2: 1489.47
     rank  3: 1487.03
     rank  4: 693.49
     rank  5: 696.72
     rank  6: 695.40
     rank  7: 697.45
     rank  8: 454.89
     rank  9: 455.70
     rank 10: 455.24
     rank 11: 455.73
     rank 12: 227.71
     rank 13: 227.87
     rank 14: 228.15
     rank 15: 227.72
  backward-send:
     rank  4: 22.68
     rank  5: 20.13
     rank  6: 21.81
     rank  7: 19.99
     rank  8: 31.48
     rank  9: 30.50
     rank 10: 31.13
     rank 11: 30.91
     rank 12: 20.94
     rank 13: 20.17
     rank 14: 20.61
     rank 15: 20.70
     rank 16: 10.50
     rank 17: 9.89
     rank 18: 10.30
     rank 19: 10.49
  forward-send-backward-recv:
     rank  0: 4384.43
     rank  1: 4376.89
     rank  2: 4384.27
     rank  3: 4379.48
     rank  4: 799.51
     rank  5: 799.24
     rank  6: 800.17
     rank  7: 800.74
     rank  8: 658.87
     rank  9: 661.39
     rank 10: 657.77
     rank 11: 660.16
     rank 12: 477.31
     rank 13: 476.79
     rank 14: 480.37
     rank 15: 479.36
  backward-send-forward-recv:
     rank  4: 71.86
     rank  5: 68.98
     rank  6: 71.60
     rank  7: 69.09
     rank  8: 147.58
     rank  9: 144.84
     rank 10: 147.54
     rank 11: 145.73
     rank 12: 158.33
     rank 13: 157.30
     rank 14: 156.55
     rank 15: 157.65
     rank 16: 169.56
     rank 17: 166.36
     rank 18: 169.09
     rank 19: 170.15
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.03
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.01
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.05
     rank 17: 0.04
     rank 18: 0.04
     rank 19: 0.05
  all-grads-sync:
     rank  0: 0.62
     rank  1: 0.62
     rank  2: 0.62
     rank  3: 0.64
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.03
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.17
     rank  1: 0.17
     rank  2: 0.16
     rank  3: 0.17
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.03
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 10.21
     rank  1: 10.15
     rank  2: 10.40
     rank  3: 10.42
     rank  4: 0.04
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.08
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.08
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.06
     rank 15: 0.03
     rank 16: 0.03
     rank 17: 0.03
     rank 18: 0.03
     rank 19: 0.07
  optimizer:
     rank  0: 10.89
     rank  1: 10.84
     rank  2: 11.09
     rank  3: 11.11
     rank  4: 0.73
     rank  5: 0.72
     rank  6: 0.72
     rank  7: 0.72
     rank  8: 0.77
     rank  9: 0.72
     rank 10: 0.72
     rank 11: 0.76
     rank 12: 0.71
     rank 13: 0.71
     rank 14: 0.74
     rank 15: 0.72
     rank 16: 0.71
     rank 17: 0.72
     rank 18: 0.72
     rank 19: 0.76
