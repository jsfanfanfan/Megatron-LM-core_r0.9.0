examples/multimodal/pretrain-freeze-llm-hete-3090first.sh: line 4: activate: No such file or directory
4
[2024-12-16 20:08:26,666] torch.distributed.run: [WARNING] 
[2024-12-16 20:08:26,666] torch.distributed.run: [WARNING] *****************************************
[2024-12-16 20:08:26,666] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-12-16 20:08:26,666] torch.distributed.run: [WARNING] *****************************************
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:20------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:20------
------num_pipeline_model_parallel_groups:4------
> setting tensorboard ...
WARNING: one_logger package is required to enable e2e metrics tracking. please go to https://confluence.nvidia.com/display/MLWFO/Package+Repositories for details to install it
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:20------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:20------
------num_pipeline_model_parallel_groups:4------
---Rank 17---Tensor Parallel Group GPUs: [1, 1, 1, 1]---Rank 16---Tensor Parallel Group GPUs: [0, 0, 0, 0]

---Rank 19---Tensor Parallel Group GPUs: [3, 3, 3, 3]
---Rank 17---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]
---Rank 16---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]
---Rank 19---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]
[rank17]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank16]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank19]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
---Rank 18---Tensor Parallel Group GPUs: [2, 2, 2, 2]
---Rank 18---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]
[rank18]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
 > number of parameters on (tensor, pipeline) model parallel rank (1, 4): 251695104
 > number of parameters on (tensor, pipeline) model parallel rank (3, 4): 251695104
 > number of parameters on (tensor, pipeline) model parallel rank (0, 4): 251695104
 > number of parameters on (tensor, pipeline) model parallel rank (2, 4): 251695104
rank=0, worker=0: shard_range=[pretrain-0.tar[0, 100), pretrain-0.tar[100, 200), pretrain-0.tar[200, 300), ...<2494>, pretrain-30.tar[9700, 9800), pretrain-30.tar[9800, 9900), pretrain-30.tar[9900, 10000)] sum(count)=250000
rank=0, worker=1: shard_range=[pretrain-31.tar[0, 100), pretrain-31.tar[100, 200), pretrain-31.tar[200, 300), ...<2494>, pretrain-53.tar[9700, 9800), pretrain-53.tar[9800, 9900), pretrain-53.tar[9900, 10000)] sum(count)=250000
rank=0, worker=0: shard_range=[pretrain-54.tar[0, 10000), pretrain-55.tar[0, 8128), pretrain-6.tar[0, 10000), pretrain-7.tar[0, 936)] sum(count)=29064
rank=0, worker=1: shard_range=[pretrain-7.tar[936, 10000), pretrain-8.tar[0, 10000), pretrain-9.tar[0, 10000)] sum(count)=29064
times across ranks (ms):
  model-and-optimizer-setup:
     rank  0: 153.12
     rank  1: 144.70
     rank  2: 144.89
     rank  3: 142.34
     rank  4: 41.78
     rank  5: 38.36
     rank  6: 37.74
     rank  7: 45.39
     rank  8: 61.23
     rank  9: 65.14
     rank 10: 65.33
     rank 11: 61.55
     rank 12: 52.08
     rank 13: 57.16
     rank 14: 53.34
     rank 15: 53.31
     rank 16: 48.28
     rank 17: 46.89
     rank 18: 48.37
     rank 19: 48.12
  train/valid/test-data-iterators-setup:
     rank  0: 1094.98
     rank  1: 1094.94
     rank  2: 1094.92
     rank  3: 1095.00
     rank  4: 1134.05
     rank  5: 1134.09
     rank  6: 1134.02
     rank  7: 1134.05
     rank  8: 1222.25
     rank  9: 1222.24
     rank 10: 1134.43
     rank 11: 1222.29
     rank 12: 1222.23
     rank 13: 1222.56
     rank 14: 1222.26
     rank 15: 1222.34
     rank 16: 1222.23
     rank 17: 1222.48
     rank 18: 1222.44
     rank 19: 1222.29
 [2024-12-16 20:09:08] iteration        1/      10 | consumed samples:           32 | elapsed time per iteration (ms): 21259.4 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 7.055422E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
[Rank 17] (after 1 iterations) memory (MB) | allocated: 1104.3935546875 | max allocated: 2188.0107421875 | reserved: 2628.0 | max reserved: 2628.0
[Rank 18] (after 1 iterations) memory (MB) | allocated: 1104.3935546875 | max allocated: 2188.0107421875 | reserved: 2628.0 | max reserved: 2628.0
stage5 GPU utialization:26.709115505218506 %
[Rank 16] (after 1 iterations) memory (MB) | allocated: 1104.3935546875 | max allocated: 2188.0107421875 | reserved: 2628.0 | max reserved: 2628.0
[Rank 19] (after 1 iterations) memory (MB) | allocated: 1104.3935546875 | max allocated: 2188.0107421875 | reserved: 2628.0 | max reserved: 2628.0
times across ranks (ms):
  forward-backward:
     rank  0: 21173.26
     rank  1: 21174.24
     rank  2: 21174.15
     rank  3: 21174.13
     rank  4: 21216.55
     rank  5: 21220.68
     rank  6: 21213.75
     rank  7: 21217.91
     rank  8: 21205.31
     rank  9: 21206.24
     rank 10: 21209.54
     rank 11: 21201.13
     rank 12: 21213.55
     rank 13: 21209.79
     rank 14: 21212.14
     rank 15: 21211.01
     rank 16: 21172.85
     rank 17: 21172.56
     rank 18: 21172.71
     rank 19: 21172.72
  forward-compute:
     rank  0: 7205.65
     rank  1: 7234.87
     rank  2: 7262.94
     rank  3: 7237.08
     rank  4: 6090.90
     rank  5: 6124.58
     rank  6: 6154.04
     rank  7: 6124.00
     rank  8: 5650.21
     rank  9: 5666.87
     rank 10: 5680.43
     rank 11: 5661.56
     rank 12: 5719.37
     rank 13: 5737.35
     rank 14: 5751.73
     rank 15: 5728.53
     rank 16: 4775.98
     rank 17: 4786.58
     rank 18: 4792.31
     rank 19: 4778.15
  backward-compute:
     rank  0: 4974.10
     rank  1: 4979.01
     rank  2: 4980.40
     rank  3: 4976.79
     rank  4: 3968.51
     rank  5: 3970.30
     rank  6: 3969.77
     rank  7: 3973.30
     rank  8: 4050.99
     rank  9: 4056.20
     rank 10: 4052.96
     rank 11: 4054.17
     rank 12: 4081.53
     rank 13: 4087.73
     rank 14: 4083.84
     rank 15: 4080.51
     rank 16: 3686.99
     rank 17: 3686.85
     rank 18: 3692.77
     rank 19: 3684.77
  pure-backward-compute:
     rank  0: 4973.25
     rank  1: 4978.12
     rank  2: 4979.61
     rank  3: 4976.05
     rank  4: 3967.18
     rank  5: 3969.09
     rank  6: 3968.98
     rank  7: 3971.99
     rank  8: 4049.45
     rank  9: 4054.44
     rank 10: 4051.29
     rank 11: 4052.43
     rank 12: 4078.23
     rank 13: 4086.13
     rank 14: 4081.60
     rank 15: 4078.56
     rank 16: 3684.22
     rank 17: 3685.06
     rank 18: 3690.29
     rank 19: 3681.02
  batch-generator:
     rank  0: 1102.49
     rank  1: 1128.62
     rank  2: 1163.70
     rank  3: 1142.78
     rank  4: 1047.36
     rank  5: 1081.29
     rank  6: 1109.96
     rank  7: 1083.08
     rank  8: 1435.44
     rank  9: 1445.62
     rank 10: 1454.50
     rank 11: 1447.19
     rank 12: 1472.78
     rank 13: 1498.70
     rank 14: 1509.36
     rank 15: 1488.97
     rank 16: 1158.44
     rank 17: 1170.61
     rank 18: 1180.92
     rank 19: 1169.51
  forward-recv:
     rank  4: 3378.02
     rank  5: 3363.71
     rank  6: 3350.93
     rank  7: 3357.67
     rank  8: 5734.82
     rank  9: 5733.16
     rank 10: 5732.61
     rank 11: 5729.20
     rank 12: 7480.62
     rank 13: 7469.35
     rank 14: 7467.43
     rank 15: 7476.64
     rank 16: 9253.29
     rank 17: 9249.70
     rank 18: 9236.74
     rank 19: 9253.25
  forward-send:
     rank  0: 5286.94
     rank  1: 5256.29
     rank  2: 5226.65
     rank  3: 5255.45
     rank  4: 3060.29
     rank  5: 3043.44
     rank  6: 3027.85
     rank  7: 3048.98
     rank  8: 1566.94
     rank  9: 1551.33
     rank 10: 1537.49
     rank 11: 1562.00
     rank 12: 36.34
     rank 13: 32.72
     rank 14: 19.96
     rank 15: 36.03
  backward-recv:
     rank  0: 1053.13
     rank  1: 1052.84
     rank  2: 1052.76
     rank  3: 1053.06
     rank  4: 775.66
     rank  5: 774.73
     rank  6: 776.36
     rank  7: 775.15
     rank  8: 481.51
     rank  9: 483.40
     rank 10: 482.57
     rank 11: 482.42
     rank 12: 199.02
     rank 13: 199.45
     rank 14: 198.61
     rank 15: 199.02
  backward-send:
     rank  4: 41.49
     rank  5: 41.15
     rank  6: 40.80
     rank  7: 41.37
     rank  8: 39.08
     rank  9: 37.36
     rank 10: 38.52
     rank 11: 37.72
     rank 12: 21.58
     rank 13: 20.65
     rank 14: 21.57
     rank 15: 21.62
     rank 16: 11.15
     rank 17: 10.64
     rank 18: 11.09
     rank 19: 11.11
  forward-send-backward-recv:
     rank  0: 2572.20
     rank  1: 2566.52
     rank  2: 2566.71
     rank  3: 2569.81
     rank  4: 2573.53
     rank  5: 2574.43
     rank  6: 2576.44
     rank  7: 2571.19
     rank  8: 2062.03
     rank  9: 2056.72
     rank 10: 2064.96
     rank 11: 2062.77
     rank 12: 1724.01
     rank 13: 1722.93
     rank 14: 1724.21
     rank 15: 1724.17
  backward-send-forward-recv:
     rank  4: 943.25
     rank  5: 939.31
     rank  6: 940.33
     rank  7: 940.54
     rank  8: 990.05
     rank  9: 989.53
     rank 10: 989.07
     rank 11: 986.94
     rank 12: 1047.28
     rank 13: 1046.50
     rank 14: 1048.09
     rank 15: 1046.54
     rank 16: 2326.76
     rank 17: 2322.67
     rank 18: 2323.47
     rank 19: 2326.23
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.05
     rank  2: 0.05
     rank  3: 0.05
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.04
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.02
     rank 16: 0.03
     rank 17: 0.03
     rank 18: 0.04
     rank 19: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.08
     rank  1: 0.13
     rank  2: 0.13
     rank  3: 0.14
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.04
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
     rank 16: 0.08
     rank 17: 0.06
     rank 18: 0.09
     rank 19: 0.07
  all-grads-sync:
     rank  0: 58.97
     rank  1: 62.85
     rank  2: 59.04
     rank  3: 61.55
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.03
     rank 17: 0.02
     rank 18: 0.05
     rank 19: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.26
     rank  1: 0.25
     rank  2: 0.25
     rank  3: 0.25
     rank  4: 0.04
     rank  5: 0.09
     rank  6: 0.02
     rank  7: 0.04
     rank  8: 0.08
     rank  9: 0.03
     rank 10: 0.04
     rank 11: 0.03
     rank 12: 0.04
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
     rank 16: 0.03
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.08
     rank  6: 0.02
     rank  7: 0.04
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.03
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.03
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 35.07
     rank  1: 35.09
     rank  2: 35.00
     rank  3: 34.78
     rank  4: 0.14
     rank  5: 0.24
     rank  6: 0.06
     rank  7: 0.14
     rank  8: 0.18
     rank  9: 0.11
     rank 10: 0.20
     rank 11: 0.11
     rank 12: 0.19
     rank 13: 0.15
     rank 14: 0.18
     rank 15: 0.15
     rank 16: 0.10
     rank 17: 0.09
     rank 18: 0.09
     rank 19: 0.09
  optimizer:
     rank  0: 36.58
     rank  1: 36.61
     rank  2: 36.51
     rank  3: 36.29
     rank  4: 1.64
     rank  5: 1.76
     rank  6: 1.56
     rank  7: 1.66
     rank  8: 1.68
     rank  9: 1.61
     rank 10: 1.71
     rank 11: 1.58
     rank 12: 1.70
     rank 13: 1.64
     rank 14: 1.68
     rank 15: 1.66
     rank 16: 1.62
     rank 17: 1.61
     rank 18: 1.60
     rank 19: 1.60
 [2024-12-16 20:09:19] iteration        2/      10 | consumed samples:           64 | elapsed time per iteration (ms): 11002.5 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 6.907160E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 10954.78
     rank  1: 10954.89
     rank  2: 10954.81
     rank  3: 10954.79
     rank  4: 10953.89
     rank  5: 10954.01
     rank  6: 10953.86
     rank  7: 10954.03
     rank  8: 10953.98
     rank  9: 10954.13
     rank 10: 10954.25
     rank 11: 10954.15
     rank 12: 10954.17
     rank 13: 10954.17
     rank 14: 10954.23
     rank 15: 10954.30
     rank 16: 10954.03
     rank 17: 10954.13
     rank 18: 10954.03
     rank 19: 10954.04
  forward-compute:
     rank  0: 4426.98
     rank  1: 4435.92
     rank  2: 4429.64
     rank  3: 4437.88
     rank  4: 4008.60
     rank  5: 4018.28
     rank  6: 4009.13
     rank  7: 4016.92
     rank  8: 4206.38
     rank  9: 4212.59
     rank 10: 4208.66
     rank 11: 4213.63
     rank 12: 4225.20
     rank 13: 4230.64
     rank 14: 4229.14
     rank 15: 4229.65
     rank 16: 3536.02
     rank 17: 3542.45
     rank 18: 3536.62
     rank 19: 3537.04
  backward-compute:
     rank  0: 4232.19
     rank  1: 4233.29
     rank  2: 4231.26
     rank  3: 4231.67
     rank  4: 3955.38
     rank  5: 3956.77
     rank  6: 3956.99
     rank  7: 3960.86
     rank  8: 4012.39
     rank  9: 4015.90
     rank 10: 4012.49
     rank 11: 4013.53
     rank 12: 4054.54
     rank 13: 4061.42
     rank 14: 4056.95
     rank 15: 4053.40
     rank 16: 3667.60
     rank 17: 3666.04
     rank 18: 3669.75
     rank 19: 3664.81
  pure-backward-compute:
     rank  0: 4231.29
     rank  1: 4232.56
     rank  2: 4230.52
     rank  3: 4230.98
     rank  4: 3954.17
     rank  5: 3955.83
     rank  6: 3956.11
     rank  7: 3959.73
     rank  8: 4010.53
     rank  9: 4014.46
     rank 10: 4011.29
     rank 11: 4012.17
     rank 12: 4052.60
     rank 13: 4059.54
     rank 14: 4055.22
     rank 15: 4051.56
     rank 16: 3664.92
     rank 17: 3664.39
     rank 18: 3667.70
     rank 19: 3661.69
  batch-generator:
     rank  0: 61.04
     rank  1: 74.62
     rank  2: 67.46
     rank  3: 76.09
     rank  4: 57.72
     rank  5: 69.88
     rank  6: 60.21
     rank  7: 71.08
     rank  8: 84.13
     rank  9: 94.01
     rank 10: 91.06
     rank 11: 99.58
     rank 12: 79.63
     rank 13: 86.73
     rank 14: 83.21
     rank 15: 89.40
     rank 16: 69.54
     rank 17: 77.71
     rank 18: 74.73
     rank 19: 77.51
  forward-recv:
     rank  4: 310.72
     rank  5: 307.89
     rank  6: 311.75
     rank  7: 306.23
     rank  8: 560.94
     rank  9: 559.91
     rank 10: 559.79
     rank 11: 558.64
     rank 12: 829.69
     rank 13: 826.91
     rank 14: 829.28
     rank 15: 828.57
     rank 16: 1094.16
     rank 17: 1093.56
     rank 18: 1094.29
     rank 19: 1094.04
  forward-send:
     rank  0: 54.11
     rank  1: 44.93
     rank  2: 52.84
     rank  3: 44.21
     rank  4: 60.30
     rank  5: 54.51
     rank  6: 59.08
     rank  7: 55.78
     rank  8: 26.00
     rank  9: 21.73
     rank 10: 26.09
     rank 11: 24.46
     rank 12: 11.43
     rank 13: 10.30
     rank 14: 11.58
     rank 15: 11.13
  backward-recv:
     rank  0: 1057.51
     rank  1: 1057.12
     rank  2: 1057.77
     rank  3: 1057.97
     rank  4: 781.35
     rank  5: 781.65
     rank  6: 781.66
     rank  7: 779.60
     rank  8: 486.68
     rank  9: 486.84
     rank 10: 487.31
     rank 11: 488.12
     rank 12: 199.31
     rank 13: 199.63
     rank 14: 199.32
     rank 15: 199.59
  backward-send:
     rank  4: 41.39
     rank  5: 40.45
     rank  6: 41.18
     rank  7: 41.62
     rank  8: 39.98
     rank  9: 38.80
     rank 10: 40.00
     rank 11: 38.12
     rank 12: 21.72
     rank 13: 20.70
     rank 14: 21.76
     rank 15: 21.33
     rank 16: 10.75
     rank 17: 10.33
     rank 18: 10.67
     rank 19: 10.84
  forward-send-backward-recv:
     rank  0: 1165.07
     rank  1: 1164.03
     rank  2: 1163.82
     rank  3: 1164.95
     rank  4: 1230.07
     rank  5: 1233.72
     rank  6: 1233.29
     rank  7: 1228.56
     rank  8: 741.40
     rank  9: 739.30
     rank 10: 745.63
     rank 11: 744.53
     rank 12: 444.93
     rank 13: 441.72
     rank 14: 442.19
     rank 15: 442.68
  backward-send-forward-recv:
     rank  4: 286.77
     rank  5: 286.05
     rank  6: 286.81
     rank  7: 286.96
     rank  8: 344.93
     rank  9: 344.12
     rank 10: 343.52
     rank 11: 340.98
     rank 12: 370.21
     rank 13: 368.40
     rank 14: 368.63
     rank 15: 369.12
     rank 16: 1586.85
     rank 17: 1584.83
     rank 18: 1586.24
     rank 19: 1587.74
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.04
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.05
     rank 16: 0.02
     rank 17: 0.04
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.05
     rank  2: 0.06
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.04
     rank 16: 0.06
     rank 17: 0.09
     rank 18: 0.06
     rank 19: 0.06
  all-grads-sync:
     rank  0: 0.71
     rank  1: 0.65
     rank  2: 0.70
     rank  3: 0.66
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.06
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.04
     rank 16: 0.02
     rank 17: 0.03
     rank 18: 0.03
     rank 19: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.20
     rank  1: 0.19
     rank  2: 0.20
     rank  3: 0.20
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.03
     rank 18: 0.02
     rank 19: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 10.72
     rank  1: 10.70
     rank  2: 10.79
     rank  3: 10.47
     rank  4: 0.08
     rank  5: 0.13
     rank  6: 0.04
     rank  7: 0.09
     rank  8: 0.10
     rank  9: 0.09
     rank 10: 0.06
     rank 11: 0.10
     rank 12: 0.11
     rank 13: 0.07
     rank 14: 0.13
     rank 15: 0.13
     rank 16: 0.07
     rank 17: 0.09
     rank 18: 0.14
     rank 19: 0.09
  optimizer:
     rank  0: 11.49
     rank  1: 11.47
     rank  2: 11.56
     rank  3: 11.22
     rank  4: 0.84
     rank  5: 0.89
     rank  6: 0.80
     rank  7: 0.85
     rank  8: 0.86
     rank  9: 0.85
     rank 10: 0.82
     rank 11: 0.86
     rank 12: 0.88
     rank 13: 0.83
     rank 14: 0.89
     rank 15: 0.90
     rank 16: 0.84
     rank 17: 0.85
     rank 18: 0.91
     rank 19: 0.85
 [2024-12-16 20:09:30] iteration        3/      10 | consumed samples:           96 | elapsed time per iteration (ms): 10921.4 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 7.091413E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 10878.21
     rank  1: 10878.23
     rank  2: 10878.25
     rank  3: 10878.27
     rank  4: 10877.35
     rank  5: 10877.49
     rank  6: 10877.34
     rank  7: 10877.37
     rank  8: 10877.45
     rank  9: 10877.50
     rank 10: 10877.48
     rank 11: 10877.50
     rank 12: 10877.55
     rank 13: 10877.51
     rank 14: 10877.52
     rank 15: 10877.63
     rank 16: 10877.46
     rank 17: 10877.40
     rank 18: 10877.46
     rank 19: 10877.58
  forward-compute:
     rank  0: 4269.56
     rank  1: 4272.91
     rank  2: 4271.32
     rank  3: 4278.32
     rank  4: 4012.14
     rank  5: 4017.88
     rank  6: 4012.84
     rank  7: 4019.70
     rank  8: 4204.44
     rank  9: 4207.26
     rank 10: 4205.53
     rank 11: 4212.08
     rank 12: 4231.26
     rank 13: 4236.08
     rank 14: 4233.19
     rank 15: 4233.39
     rank 16: 3542.16
     rank 17: 3548.64
     rank 18: 3543.68
     rank 19: 3542.50
  backward-compute:
     rank  0: 4223.01
     rank  1: 4225.10
     rank  2: 4222.84
     rank  3: 4223.21
     rank  4: 3959.32
     rank  5: 3960.92
     rank  6: 3960.19
     rank  7: 3964.42
     rank  8: 4027.69
     rank  9: 4033.94
     rank 10: 4025.43
     rank 11: 4026.26
     rank 12: 4065.32
     rank 13: 4071.04
     rank 14: 4068.58
     rank 15: 4064.09
     rank 16: 3677.99
     rank 17: 3677.44
     rank 18: 3681.69
     rank 19: 3676.43
  pure-backward-compute:
     rank  0: 4222.20
     rank  1: 4224.35
     rank  2: 4222.13
     rank  3: 4222.51
     rank  4: 3958.33
     rank  5: 3959.97
     rank  6: 3959.50
     rank  7: 3963.57
     rank  8: 4025.67
     rank  9: 4032.65
     rank 10: 4024.23
     rank 11: 4024.99
     rank 12: 4063.55
     rank 13: 4069.77
     rank 14: 4067.21
     rank 15: 4062.44
     rank 16: 3675.45
     rank 17: 3675.66
     rank 18: 3679.44
     rank 19: 3673.37
  batch-generator:
     rank  0: 57.13
     rank  1: 63.75
     rank  2: 60.76
     rank  3: 69.87
     rank  4: 55.17
     rank  5: 63.21
     rank  6: 57.71
     rank  7: 67.48
     rank  8: 78.68
     rank  9: 85.74
     rank 10: 85.25
     rank 11: 94.85
     rank 12: 78.66
     rank 13: 84.63
     rank 14: 80.85
     rank 15: 86.77
     rank 16: 68.85
     rank 17: 77.25
     rank 18: 75.32
     rank 19: 76.39
  forward-recv:
     rank  4: 308.80
     rank  5: 307.88
     rank  6: 309.97
     rank  7: 304.81
     rank  8: 561.83
     rank  9: 560.93
     rank 10: 560.87
     rank 11: 558.75
     rank 12: 827.52
     rank 13: 827.16
     rank 14: 827.24
     rank 15: 826.40
     rank 16: 1091.62
     rank 17: 1090.87
     rank 18: 1091.70
     rank 19: 1091.62
  forward-send:
     rank  0: 52.48
     rank  1: 48.58
     rank  2: 51.95
     rank  3: 43.85
     rank  4: 61.40
     rank  5: 59.25
     rank  6: 60.53
     rank  7: 57.35
     rank  8: 22.70
     rank  9: 21.69
     rank 10: 22.93
     rank 11: 21.85
     rank 12: 10.85
     rank 13: 10.28
     rank 14: 10.85
     rank 15: 10.87
  backward-recv:
     rank  0: 1062.69
     rank  1: 1062.41
     rank  2: 1063.17
     rank  3: 1062.33
     rank  4: 783.68
     rank  5: 783.38
     rank  6: 783.36
     rank  7: 782.96
     rank  8: 484.98
     rank  9: 485.22
     rank 10: 485.28
     rank 11: 486.57
     rank 12: 198.30
     rank 13: 198.76
     rank 14: 198.32
     rank 15: 197.79
  backward-send:
     rank  4: 41.46
     rank  5: 40.68
     rank  6: 41.50
     rank  7: 41.18
     rank  8: 38.32
     rank  9: 36.76
     rank 10: 37.94
     rank 11: 36.85
     rank 12: 21.57
     rank 13: 20.55
     rank 14: 21.66
     rank 15: 22.25
     rank 16: 10.83
     rank 17: 10.36
     rank 18: 10.67
     rank 19: 10.89
  forward-send-backward-recv:
     rank  0: 1250.51
     rank  1: 1247.97
     rank  2: 1249.15
     rank  3: 1251.53
     rank  4: 1299.48
     rank  5: 1302.11
     rank  6: 1302.37
     rank  7: 1297.66
     rank  8: 756.41
     rank  9: 749.09
     rank 10: 760.99
     rank 11: 759.23
     rank 12: 447.56
     rank 13: 447.30
     rank 14: 447.47
     rank 15: 449.02
  backward-send-forward-recv:
     rank  4: 133.96
     rank  5: 131.47
     rank  6: 133.25
     rank  7: 134.13
     rank  8: 247.87
     rank  9: 247.93
     rank 10: 247.79
     rank 11: 244.36
     rank 12: 278.61
     rank 13: 275.00
     rank 14: 278.61
     rank 15: 278.78
     rank 16: 1498.23
     rank 17: 1495.40
     rank 18: 1495.69
     rank 19: 1498.89
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.03
     rank 19: 0.05
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.05
     rank  2: 0.05
     rank  3: 0.05
     rank  4: 0.03
     rank  5: 0.04
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.06
     rank 17: 0.06
     rank 18: 0.09
     rank 19: 0.10
  all-grads-sync:
     rank  0: 0.66
     rank  1: 0.67
     rank  2: 0.66
     rank  3: 0.64
     rank  4: 0.05
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.06
     rank 19: 0.05
  optimizer-copy-to-main-grad:
     rank  0: 0.20
     rank  1: 0.20
     rank  2: 0.20
     rank  3: 0.19
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.04
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.02
     rank 19: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 10.49
     rank  1: 10.76
     rank  2: 10.30
     rank  3: 10.26
     rank  4: 0.05
     rank  5: 0.30
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.08
     rank  9: 0.05
     rank 10: 0.10
     rank 11: 0.09
     rank 12: 0.06
     rank 13: 0.07
     rank 14: 0.07
     rank 15: 0.05
     rank 16: 0.07
     rank 17: 0.05
     rank 18: 0.08
     rank 19: 0.09
  optimizer:
     rank  0: 11.32
     rank  1: 11.59
     rank  2: 11.14
     rank  3: 11.08
     rank  4: 0.88
     rank  5: 1.13
     rank  6: 0.88
     rank  7: 0.88
     rank  8: 0.91
     rank  9: 0.88
     rank 10: 0.93
     rank 11: 0.93
     rank 12: 0.90
     rank 13: 0.90
     rank 14: 0.90
     rank 15: 0.88
     rank 16: 0.90
     rank 17: 0.88
     rank 18: 0.91
     rank 19: 0.92
 [2024-12-16 20:09:41] iteration        4/      10 | consumed samples:          128 | elapsed time per iteration (ms): 10946.1 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 6.019341E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 10896.46
     rank  1: 10896.44
     rank  2: 10896.43
     rank  3: 10896.42
     rank  4: 10895.52
     rank  5: 10895.48
     rank  6: 10895.51
     rank  7: 10895.54
     rank  8: 10895.65
     rank  9: 10895.64
     rank 10: 10895.61
     rank 11: 10895.69
     rank 12: 10895.82
     rank 13: 10895.69
     rank 14: 10895.69
     rank 15: 10895.71
     rank 16: 10895.62
     rank 17: 10895.69
     rank 18: 10895.64
     rank 19: 10895.63
  forward-compute:
     rank  0: 4263.78
     rank  1: 4274.94
     rank  2: 4264.16
     rank  3: 4264.90
     rank  4: 4023.71
     rank  5: 4038.17
     rank  6: 4023.48
     rank  7: 4024.42
     rank  8: 4207.27
     rank  9: 4215.74
     rank 10: 4208.16
     rank 11: 4216.53
     rank 12: 4239.82
     rank 13: 4248.75
     rank 14: 4243.33
     rank 15: 4242.54
     rank 16: 3541.80
     rank 17: 3548.80
     rank 18: 3542.56
     rank 19: 3542.59
  backward-compute:
     rank  0: 4231.75
     rank  1: 4235.12
     rank  2: 4231.54
     rank  3: 4232.03
     rank  4: 3965.57
     rank  5: 3966.63
     rank  6: 3966.53
     rank  7: 3972.02
     rank  8: 4018.55
     rank  9: 4025.00
     rank 10: 4019.80
     rank 11: 4018.86
     rank 12: 4072.39
     rank 13: 4078.64
     rank 14: 4074.63
     rank 15: 4071.51
     rank 16: 3683.80
     rank 17: 3682.76
     rank 18: 3686.03
     rank 19: 3682.12
  pure-backward-compute:
     rank  0: 4231.01
     rank  1: 4234.33
     rank  2: 4230.81
     rank  3: 4231.30
     rank  4: 3964.58
     rank  5: 3965.87
     rank  6: 3965.82
     rank  7: 3971.18
     rank  8: 4016.77
     rank  9: 4023.71
     rank 10: 4018.65
     rank 11: 4017.70
     rank 12: 4070.08
     rank 13: 4077.43
     rank 14: 4073.40
     rank 15: 4069.82
     rank 16: 3681.26
     rank 17: 3681.14
     rank 18: 3684.04
     rank 19: 3679.10
  batch-generator:
     rank  0: 59.25
     rank  1: 75.83
     rank  2: 63.68
     rank  3: 65.47
     rank  4: 55.32
     rank  5: 71.75
     rank  6: 56.64
     rank  7: 60.73
     rank  8: 77.70
     rank  9: 92.41
     rank 10: 85.21
     rank 11: 96.98
     rank 12: 79.02
     rank 13: 89.54
     rank 14: 82.81
     rank 15: 87.65
     rank 16: 67.92
     rank 17: 76.33
     rank 18: 73.20
     rank 19: 75.68
  forward-recv:
     rank  4: 315.85
     rank  5: 311.65
     rank  6: 317.22
     rank  7: 319.53
     rank  8: 560.27
     rank  9: 558.62
     rank 10: 559.00
     rank 11: 557.16
     rank 12: 827.85
     rank 13: 824.16
     rank 14: 826.94
     rank 15: 826.82
     rank 16: 1091.83
     rank 17: 1090.55
     rank 18: 1091.96
     rank 19: 1091.73
  forward-send:
     rank  0: 47.78
     rank  1: 35.97
     rank  2: 48.02
     rank  3: 46.29
     rank  4: 50.93
     rank  5: 43.42
     rank  6: 50.07
     rank  7: 46.10
     rank  8: 26.88
     rank  9: 21.70
     rank 10: 27.56
     rank 11: 25.88
     rank 12: 11.41
     rank 13: 10.16
     rank 14: 11.65
     rank 15: 11.42
  backward-recv:
     rank  0: 1062.33
     rank  1: 1061.37
     rank  2: 1062.95
     rank  3: 1062.49
     rank  4: 784.39
     rank  5: 784.96
     rank  6: 784.30
     rank  7: 782.70
     rank  8: 483.57
     rank  9: 483.00
     rank 10: 483.99
     rank 11: 485.48
     rank 12: 198.56
     rank 13: 198.76
     rank 14: 198.45
     rank 15: 198.36
  backward-send:
     rank  4: 41.42
     rank  5: 40.31
     rank  6: 41.36
     rank  7: 41.36
     rank  8: 39.62
     rank  9: 39.23
     rank 10: 39.34
     rank 11: 37.79
     rank 12: 21.80
     rank 13: 20.81
     rank 14: 21.67
     rank 15: 21.53
     rank 16: 10.90
     rank 17: 10.41
     rank 18: 10.86
     rank 19: 10.70
  forward-send-backward-recv:
     rank  0: 1270.31
     rank  1: 1269.26
     rank  2: 1270.98
     rank  3: 1271.06
     rank  4: 1304.24
     rank  5: 1305.30
     rank  6: 1305.80
     rank  7: 1298.94
     rank  8: 780.32
     rank  9: 773.29
     rank 10: 781.52
     rank 11: 782.52
     rank 12: 445.72
     rank 13: 442.59
     rank 14: 443.41
     rank 15: 444.61
  backward-send-forward-recv:
     rank  4: 133.87
     rank  5: 131.59
     rank  6: 133.67
     rank  7: 133.98
     rank  8: 246.30
     rank  9: 245.26
     rank 10: 245.91
     rank 11: 240.92
     rank 12: 281.75
     rank 13: 278.91
     rank 14: 281.47
     rank 15: 282.16
     rank 16: 1509.41
     rank 17: 1507.24
     rank 18: 1508.50
     rank 19: 1510.22
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.03
     rank 18: 0.04
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.05
     rank  2: 0.05
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.06
     rank 17: 0.07
     rank 18: 0.08
     rank 19: 0.06
  all-grads-sync:
     rank  0: 0.68
     rank  1: 0.66
     rank  2: 0.64
     rank  3: 0.68
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.03
     rank 18: 0.06
     rank 19: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.20
     rank  1: 0.20
     rank  2: 0.20
     rank  3: 0.20
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.06
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.03
     rank 19: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 10.49
     rank  1: 10.33
     rank  2: 10.70
     rank  3: 10.47
     rank  4: 0.07
     rank  5: 0.04
     rank  6: 0.08
     rank  7: 0.08
     rank  8: 0.05
     rank  9: 0.05
     rank 10: 0.07
     rank 11: 0.05
     rank 12: 0.13
     rank 13: 0.06
     rank 14: 0.05
     rank 15: 0.08
     rank 16: 0.04
     rank 17: 0.07
     rank 18: 0.08
     rank 19: 0.04
  optimizer:
     rank  0: 11.28
     rank  1: 11.10
     rank  2: 11.49
     rank  3: 11.26
     rank  4: 0.86
     rank  5: 0.82
     rank  6: 0.86
     rank  7: 0.86
     rank  8: 0.83
     rank  9: 0.84
     rank 10: 0.86
     rank 11: 0.84
     rank 12: 0.92
     rank 13: 0.84
     rank 14: 0.83
     rank 15: 0.87
     rank 16: 0.83
     rank 17: 0.86
     rank 18: 0.87
     rank 19: 0.82
 [2024-12-16 20:09:52] iteration        5/      10 | consumed samples:          160 | elapsed time per iteration (ms): 10951.9 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 4.156403E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 10912.42
     rank  1: 10912.48
     rank  2: 10912.42
     rank  3: 10912.43
     rank  4: 10911.50
     rank  5: 10911.48
     rank  6: 10911.50
     rank  7: 10911.51
     rank  8: 10911.64
     rank  9: 10911.63
     rank 10: 10911.61
     rank 11: 10911.80
     rank 12: 10911.67
     rank 13: 10911.67
     rank 14: 10911.68
     rank 15: 10911.73
     rank 16: 10911.64
     rank 17: 10911.57
     rank 18: 10911.59
     rank 19: 10911.65
  forward-compute:
     rank  0: 4281.35
     rank  1: 4281.77
     rank  2: 4284.84
     rank  3: 4281.43
     rank  4: 4061.28
     rank  5: 4063.69
     rank  6: 4064.19
     rank  7: 4061.04
     rank  8: 4217.61
     rank  9: 4218.99
     rank 10: 4219.12
     rank 11: 4221.19
     rank 12: 4246.43
     rank 13: 4250.42
     rank 14: 4249.81
     rank 15: 4248.05
     rank 16: 3549.05
     rank 17: 3554.65
     rank 18: 3550.14
     rank 19: 3549.54
  backward-compute:
     rank  0: 4242.62
     rank  1: 4244.77
     rank  2: 4242.31
     rank  3: 4243.52
     rank  4: 3960.00
     rank  5: 3961.18
     rank  6: 3960.79
     rank  7: 3965.92
     rank  8: 4025.12
     rank  9: 4030.73
     rank 10: 4025.02
     rank 11: 4025.14
     rank 12: 4082.10
     rank 13: 4087.72
     rank 14: 4084.29
     rank 15: 4081.33
     rank 16: 3691.78
     rank 17: 3690.92
     rank 18: 3694.97
     rank 19: 3692.35
  pure-backward-compute:
     rank  0: 4241.89
     rank  1: 4244.02
     rank  2: 4241.59
     rank  3: 4242.81
     rank  4: 3959.23
     rank  5: 3960.19
     rank  6: 3960.07
     rank  7: 3965.05
     rank  8: 4023.52
     rank  9: 4029.39
     rank 10: 4023.88
     rank 11: 4023.99
     rank 12: 4080.31
     rank 13: 4086.11
     rank 14: 4083.06
     rank 15: 4079.61
     rank 16: 3689.08
     rank 17: 3689.27
     rank 18: 3692.79
     rank 19: 3689.15
  batch-generator:
     rank  0: 55.27
     rank  1: 62.25
     rank  2: 64.83
     rank  3: 62.54
     rank  4: 54.14
     rank  5: 58.26
     rank  6: 58.68
     rank  7: 58.45
     rank  8: 76.83
     rank  9: 84.36
     rank 10: 84.71
     rank 11: 90.12
     rank 12: 77.77
     rank 13: 83.24
     rank 14: 81.85
     rank 15: 86.22
     rank 16: 68.54
     rank 17: 75.79
     rank 18: 74.33
     rank 19: 76.24
  forward-recv:
     rank  4: 328.37
     rank  5: 329.80
     rank  6: 328.80
     rank  7: 328.72
     rank  8: 564.40
     rank  9: 563.84
     rank 10: 563.58
     rank 11: 565.24
     rank 12: 829.02
     rank 13: 829.39
     rank 14: 828.06
     rank 15: 828.44
     rank 16: 1095.65
     rank 17: 1094.83
     rank 18: 1095.60
     rank 19: 1095.83
  forward-send:
     rank  0: 44.94
     rank  1: 44.03
     rank  2: 42.26
     rank  3: 44.74
     rank  4: 42.69
     rank  5: 40.93
     rank  6: 40.06
     rank  7: 42.45
     rank  8: 22.22
     rank  9: 21.76
     rank 10: 21.28
     rank 11: 21.76
     rank 12: 10.88
     rank 13: 10.09
     rank 14: 10.70
     rank 15: 10.88
  backward-recv:
     rank  0: 1060.70
     rank  1: 1060.33
     rank  2: 1061.08
     rank  3: 1060.21
     rank  4: 788.10
     rank  5: 787.96
     rank  6: 787.70
     rank  7: 786.49
     rank  8: 490.43
     rank  9: 489.86
     rank 10: 490.81
     rank 11: 492.06
     rank 12: 198.48
     rank 13: 198.88
     rank 14: 198.69
     rank 15: 198.66
  backward-send:
     rank  4: 41.38
     rank  5: 40.94
     rank  6: 41.54
     rank  7: 41.14
     rank  8: 33.37
     rank  9: 32.80
     rank 10: 33.24
     rank 11: 31.35
     rank 12: 21.72
     rank 13: 20.70
     rank 14: 21.78
     rank 15: 21.34
     rank 16: 10.88
     rank 17: 10.47
     rank 18: 10.79
     rank 19: 10.97
  forward-send-backward-recv:
     rank  0: 1262.89
     rank  1: 1261.87
     rank  2: 1262.59
     rank  3: 1262.38
     rank  4: 1278.78
     rank  5: 1279.99
     rank  6: 1280.16
     rank  7: 1275.05
     rank  8: 776.59
     rank  9: 770.72
     rank 10: 779.52
     rank 11: 779.53
     rank 12: 447.11
     rank 13: 444.94
     rank 14: 445.46
     rank 15: 446.51
  backward-send-forward-recv:
     rank  4: 134.80
     rank  5: 133.22
     rank  6: 134.35
     rank  7: 134.60
     rank  8: 248.86
     rank  9: 248.80
     rank 10: 248.87
     rank 11: 244.48
     rank 12: 282.19
     rank 13: 278.51
     rank 14: 281.70
     rank 15: 281.99
     rank 16: 1506.50
     rank 17: 1505.01
     rank 18: 1504.89
     rank 19: 1504.93
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.05
     rank  2: 0.05
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.03
     rank 16: 0.07
     rank 17: 0.06
     rank 18: 0.06
     rank 19: 0.06
  all-grads-sync:
     rank  0: 0.66
     rank  1: 0.70
     rank  2: 0.64
     rank  3: 0.66
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.03
  optimizer-copy-to-main-grad:
     rank  0: 0.20
     rank  1: 0.20
     rank  2: 0.20
     rank  3: 0.20
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 10.31
     rank  1: 10.47
     rank  2: 10.72
     rank  3: 10.32
     rank  4: 0.04
     rank  5: 0.04
     rank  6: 0.04
     rank  7: 0.05
     rank  8: 0.08
     rank  9: 0.07
     rank 10: 0.05
     rank 11: 0.10
     rank 12: 0.08
     rank 13: 0.09
     rank 14: 0.09
     rank 15: 0.09
     rank 16: 0.07
     rank 17: 0.04
     rank 18: 0.07
     rank 19: 0.08
  optimizer:
     rank  0: 11.06
     rank  1: 11.21
     rank  2: 11.46
     rank  3: 11.06
     rank  4: 0.78
     rank  5: 0.78
     rank  6: 0.78
     rank  7: 0.79
     rank  8: 0.82
     rank  9: 0.81
     rank 10: 0.80
     rank 11: 0.84
     rank 12: 0.82
     rank 13: 0.83
     rank 14: 0.83
     rank 15: 0.84
     rank 16: 0.81
     rank 17: 0.79
     rank 18: 0.82
     rank 19: 0.83
 [2024-12-16 20:10:03] iteration        6/      10 | consumed samples:          192 | elapsed time per iteration (ms): 10973.4 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 2.674123E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 10933.17
     rank  1: 10933.20
     rank  2: 10933.20
     rank  3: 10933.18
     rank  4: 10932.33
     rank  5: 10932.30
     rank  6: 10932.22
     rank  7: 10932.29
     rank  8: 10932.42
     rank  9: 10932.42
     rank 10: 10932.45
     rank 11: 10932.37
     rank 12: 10932.48
     rank 13: 10932.41
     rank 14: 10932.61
     rank 15: 10932.50
     rank 16: 10932.41
     rank 17: 10932.46
     rank 18: 10932.36
     rank 19: 10932.52
  forward-compute:
     rank  0: 4275.70
     rank  1: 4287.15
     rank  2: 4276.65
     rank  3: 4276.69
     rank  4: 4070.79
     rank  5: 4085.08
     rank  6: 4070.75
     rank  7: 4071.72
     rank  8: 4214.67
     rank  9: 4225.04
     rank 10: 4216.18
     rank 11: 4224.63
     rank 12: 4251.51
     rank 13: 4263.43
     rank 14: 4255.33
     rank 15: 4254.03
     rank 16: 3549.57
     rank 17: 3556.27
     rank 18: 3550.74
     rank 19: 3549.15
  backward-compute:
     rank  0: 4236.12
     rank  1: 4238.52
     rank  2: 4235.14
     rank  3: 4236.72
     rank  4: 3958.98
     rank  5: 3961.91
     rank  6: 3960.54
     rank  7: 3964.71
     rank  8: 4017.28
     rank  9: 4025.92
     rank 10: 4019.27
     rank 11: 4018.40
     rank 12: 4095.07
     rank 13: 4101.40
     rank 14: 4098.02
     rank 15: 4092.60
     rank 16: 3693.36
     rank 17: 3692.95
     rank 18: 3696.67
     rank 19: 3692.18
  pure-backward-compute:
     rank  0: 4235.43
     rank  1: 4237.80
     rank  2: 4234.42
     rank  3: 4236.03
     rank  4: 3958.20
     rank  5: 3960.61
     rank  6: 3959.81
     rank  7: 3963.93
     rank  8: 4015.61
     rank  9: 4024.64
     rank 10: 4018.12
     rank 11: 4017.21
     rank 12: 4093.11
     rank 13: 4100.17
     rank 14: 4096.83
     rank 15: 4090.89
     rank 16: 3690.91
     rank 17: 3691.36
     rank 18: 3694.55
     rank 19: 3689.24
  batch-generator:
     rank  0: 52.64
     rank  1: 68.87
     rank  2: 58.02
     rank  3: 58.94
     rank  4: 54.95
     rank  5: 71.44
     rank  6: 56.62
     rank  7: 60.12
     rank  8: 78.04
     rank  9: 92.71
     rank 10: 84.96
     rank 11: 96.74
     rank 12: 80.38
     rank 13: 93.40
     rank 14: 84.23
     rank 15: 89.14
     rank 16: 67.05
     rank 17: 75.37
     rank 18: 72.86
     rank 19: 73.75
  forward-recv:
     rank  4: 314.35
     rank  5: 311.14
     rank  6: 315.49
     rank  7: 319.58
     rank  8: 562.35
     rank  9: 560.28
     rank 10: 561.85
     rank 11: 558.69
     rank 12: 832.92
     rank 13: 828.00
     rank 14: 832.53
     rank 15: 831.71
     rank 16: 1097.43
     rank 17: 1096.07
     rank 18: 1097.56
     rank 19: 1097.47
  forward-send:
     rank  0: 52.20
     rank  1: 39.72
     rank  2: 52.39
     rank  3: 51.16
     rank  4: 49.70
     rank  5: 40.55
     rank  6: 48.95
     rank  7: 43.87
     rank  8: 27.88
     rank  9: 21.43
     rank 10: 27.97
     rank 11: 26.67
     rank 12: 11.70
     rank 13: 10.16
     rank 14: 11.68
     rank 15: 11.82
  backward-recv:
     rank  0: 1062.66
     rank  1: 1062.55
     rank  2: 1063.33
     rank  3: 1062.66
     rank  4: 791.31
     rank  5: 790.75
     rank  6: 791.17
     rank  7: 790.84
     rank  8: 490.59
     rank  9: 490.66
     rank 10: 490.72
     rank 11: 490.76
     rank 12: 196.81
     rank 13: 197.16
     rank 14: 197.20
     rank 15: 196.96
  backward-send:
     rank  4: 41.49
     rank  5: 40.55
     rank  6: 41.51
     rank  7: 41.25
     rank  8: 37.21
     rank  9: 35.84
     rank 10: 37.15
     rank 11: 36.07
     rank 12: 21.72
     rank 13: 20.70
     rank 14: 21.73
     rank 15: 21.47
     rank 16: 10.85
     rank 17: 10.37
     rank 18: 10.72
     rank 19: 10.80
  forward-send-backward-recv:
     rank  0: 1284.10
     rank  1: 1284.27
     rank  2: 1285.55
     rank  3: 1286.10
     rank  4: 1294.34
     rank  5: 1295.87
     rank  6: 1296.50
     rank  7: 1290.85
     rank  8: 799.72
     rank  9: 790.04
     rank 10: 800.74
     rank 11: 801.64
     rank 12: 441.00
     rank 13: 438.44
     rank 14: 438.72
     rank 15: 441.93
  backward-send-forward-recv:
     rank  4: 133.51
     rank  5: 131.21
     rank  6: 133.33
     rank  7: 133.15
     rank  8: 249.34
     rank  9: 247.84
     rank 10: 247.80
     rank 11: 243.84
     rank 12: 284.48
     rank 13: 279.93
     rank 14: 283.48
     rank 15: 284.69
     rank 16: 1521.17
     rank 17: 1518.84
     rank 18: 1519.05
     rank 19: 1522.62
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.04
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.03
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.05
     rank  2: 0.05
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.03
     rank 16: 0.06
     rank 17: 0.07
     rank 18: 0.06
     rank 19: 0.08
  all-grads-sync:
     rank  0: 0.67
     rank  1: 0.70
     rank  2: 0.71
     rank  3: 0.65
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.06
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.03
     rank 18: 0.02
     rank 19: 0.03
  optimizer-copy-to-main-grad:
     rank  0: 0.20
     rank  1: 0.21
     rank  2: 0.22
     rank  3: 0.20
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.01
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
     rank 16: 0.01
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 10.59
     rank  1: 10.38
     rank  2: 10.74
     rank  3: 10.33
     rank  4: 0.07
     rank  5: 0.07
     rank  6: 0.04
     rank  7: 0.04
     rank  8: 0.05
     rank  9: 0.05
     rank 10: 0.05
     rank 11: 0.04
     rank 12: 0.06
     rank 13: 0.03
     rank 14: 0.05
     rank 15: 0.09
     rank 16: 0.04
     rank 17: 0.07
     rank 18: 0.08
     rank 19: 0.05
  optimizer:
     rank  0: 11.37
     rank  1: 11.15
     rank  2: 11.51
     rank  3: 11.12
     rank  4: 0.84
     rank  5: 0.84
     rank  6: 0.80
     rank  7: 0.81
     rank  8: 0.82
     rank  9: 0.82
     rank 10: 0.82
     rank 11: 0.81
     rank 12: 0.82
     rank 13: 0.80
     rank 14: 0.81
     rank 15: 0.86
     rank 16: 0.81
     rank 17: 0.84
     rank 18: 0.85
     rank 19: 0.82
 [2024-12-16 20:10:14] iteration        7/      10 | consumed samples:          224 | elapsed time per iteration (ms): 10989.0 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 1.655027E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 10949.01
     rank  1: 10948.95
     rank  2: 10948.94
     rank  3: 10948.97
     rank  4: 10948.03
     rank  5: 10948.06
     rank  6: 10948.00
     rank  7: 10948.05
     rank  8: 10948.20
     rank  9: 10948.29
     rank 10: 10948.13
     rank 11: 10948.15
     rank 12: 10948.24
     rank 13: 10948.41
     rank 14: 10948.23
     rank 15: 10948.25
     rank 16: 10948.19
     rank 17: 10948.14
     rank 18: 10948.14
     rank 19: 10948.19
  forward-compute:
     rank  0: 4269.06
     rank  1: 4268.66
     rank  2: 4270.98
     rank  3: 4277.02
     rank  4: 4036.98
     rank  5: 4039.18
     rank  6: 4038.46
     rank  7: 4045.10
     rank  8: 4224.71
     rank  9: 4225.27
     rank 10: 4225.78
     rank 11: 4232.13
     rank 12: 4255.71
     rank 13: 4261.68
     rank 14: 4259.71
     rank 15: 4258.83
     rank 16: 3556.27
     rank 17: 3563.07
     rank 18: 3555.41
     rank 19: 3555.49
  backward-compute:
     rank  0: 4239.69
     rank  1: 4242.69
     rank  2: 4239.53
     rank  3: 4240.12
     rank  4: 3965.42
     rank  5: 3966.63
     rank  6: 3966.30
     rank  7: 3971.35
     rank  8: 4025.69
     rank  9: 4036.60
     rank 10: 4028.46
     rank 11: 4028.73
     rank 12: 4094.07
     rank 13: 4100.45
     rank 14: 4093.71
     rank 15: 4090.57
     rank 16: 3698.35
     rank 17: 3697.89
     rank 18: 3701.21
     rank 19: 3696.81
  pure-backward-compute:
     rank  0: 4238.90
     rank  1: 4241.95
     rank  2: 4238.84
     rank  3: 4239.39
     rank  4: 3964.65
     rank  5: 3965.84
     rank  6: 3965.61
     rank  7: 3970.53
     rank  8: 4023.92
     rank  9: 4035.30
     rank 10: 4027.27
     rank 11: 4027.64
     rank 12: 4092.22
     rank 13: 4099.24
     rank 14: 4092.50
     rank 15: 4088.79
     rank 16: 3695.87
     rank 17: 3696.24
     rank 18: 3699.44
     rank 19: 3693.86
  batch-generator:
     rank  0: 55.29
     rank  1: 60.16
     rank  2: 61.86
     rank  3: 68.76
     rank  4: 54.06
     rank  5: 58.06
     rank  6: 57.37
     rank  7: 66.47
     rank  8: 76.62
     rank  9: 81.77
     rank 10: 83.39
     rank 11: 93.05
     rank 12: 78.26
     rank 13: 85.52
     rank 14: 82.54
     rank 15: 88.81
     rank 16: 67.65
     rank 17: 75.98
     rank 18: 72.65
     rank 19: 74.90
  forward-recv:
     rank  4: 308.64
     rank  5: 308.35
     rank  6: 309.07
     rank  7: 304.43
     rank  8: 567.32
     rank  9: 567.56
     rank 10: 566.13
     rank 11: 564.85
     rank 12: 832.34
     rank 13: 832.86
     rank 14: 831.67
     rank 15: 831.09
     rank 16: 1098.85
     rank 17: 1098.26
     rank 18: 1098.87
     rank 19: 1098.72
  forward-send:
     rank  0: 62.70
     rank  1: 61.97
     rank  2: 61.32
     rank  3: 54.47
     rank  4: 58.01
     rank  5: 58.11
     rank  6: 56.77
     rank  7: 54.53
     rank  8: 22.06
     rank  9: 22.03
     rank 10: 22.19
     rank 11: 21.61
     rank 12: 10.86
     rank 13: 10.37
     rank 14: 10.90
     rank 15: 10.82
  backward-recv:
     rank  0: 1073.85
     rank  1: 1073.82
     rank  2: 1074.65
     rank  3: 1074.39
     rank  4: 795.76
     rank  5: 795.43
     rank  6: 795.34
     rank  7: 794.17
     rank  8: 492.28
     rank  9: 492.53
     rank 10: 492.78
     rank 11: 493.80
     rank 12: 201.24
     rank 13: 201.68
     rank 14: 201.22
     rank 15: 201.45
  backward-send:
     rank  4: 41.21
     rank  5: 40.62
     rank  6: 41.21
     rank  7: 41.63
     rank  8: 36.35
     rank  9: 35.02
     rank 10: 35.92
     rank 11: 34.45
     rank 12: 21.72
     rank 13: 20.70
     rank 14: 21.71
     rank 15: 21.49
     rank 16: 11.23
     rank 17: 10.70
     rank 18: 11.04
     rank 19: 11.11
  forward-send-backward-recv:
     rank  0: 1282.77
     rank  1: 1282.42
     rank  2: 1283.71
     rank  3: 1282.76
     rank  4: 1329.87
     rank  5: 1332.65
     rank  6: 1332.84
     rank  7: 1325.83
     rank  8: 796.23
     rank  9: 784.71
     rank 10: 796.37
     rank 11: 795.75
     rank 12: 448.68
     rank 13: 445.87
     rank 14: 449.54
     rank 15: 450.75
  backward-send-forward-recv:
     rank  4: 134.63
     rank  5: 132.91
     rank  6: 134.27
     rank  7: 134.43
     rank  8: 247.95
     rank  9: 247.52
     rank 10: 247.69
     rank 11: 243.25
     rank 12: 284.38
     rank 13: 278.89
     rank 14: 283.24
     rank 15: 283.82
     rank 16: 1520.90
     rank 17: 1517.70
     rank 18: 1521.57
     rank 19: 1523.04
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.06
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.05
     rank  2: 0.05
     rank  3: 0.06
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.04
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.02
     rank 16: 0.06
     rank 17: 0.06
     rank 18: 0.06
     rank 19: 0.06
  all-grads-sync:
     rank  0: 0.69
     rank  1: 0.65
     rank  2: 0.64
     rank  3: 0.67
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.07
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.22
     rank  1: 0.19
     rank  2: 0.20
     rank  3: 0.20
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.01
     rank 19: 0.01
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.02
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 10.51
     rank  1: 10.34
     rank  2: 10.27
     rank  3: 10.20
     rank  4: 0.04
     rank  5: 0.04
     rank  6: 0.04
     rank  7: 0.08
     rank  8: 0.04
     rank  9: 0.06
     rank 10: 0.07
     rank 11: 0.05
     rank 12: 0.08
     rank 13: 0.10
     rank 14: 0.08
     rank 15: 0.05
     rank 16: 0.04
     rank 17: 0.04
     rank 18: 0.07
     rank 19: 0.04
  optimizer:
     rank  0: 11.36
     rank  1: 11.19
     rank  2: 11.11
     rank  3: 11.03
     rank  4: 0.88
     rank  5: 0.88
     rank  6: 0.87
     rank  7: 0.91
     rank  8: 0.88
     rank  9: 0.90
     rank 10: 0.91
     rank 11: 0.89
     rank 12: 0.91
     rank 13: 0.93
     rank 14: 0.91
     rank 15: 0.89
     rank 16: 0.88
     rank 17: 0.88
     rank 18: 0.91
     rank 19: 0.88
 [2024-12-16 20:10:25] iteration        8/      10 | consumed samples:          256 | elapsed time per iteration (ms): 10986.0 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 1.117592E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 10944.01
     rank  1: 10944.04
     rank  2: 10944.02
     rank  3: 10944.02
     rank  4: 10943.08
     rank  5: 10943.11
     rank  6: 10943.10
     rank  7: 10943.09
     rank  8: 10943.26
     rank  9: 10943.29
     rank 10: 10943.31
     rank 11: 10943.21
     rank 12: 10943.35
     rank 13: 10943.28
     rank 14: 10943.28
     rank 15: 10943.33
     rank 16: 10943.25
     rank 17: 10943.29
     rank 18: 10943.20
     rank 19: 10943.25
  forward-compute:
     rank  0: 4296.25
     rank  1: 4297.86
     rank  2: 4298.45
     rank  3: 4295.94
     rank  4: 4026.23
     rank  5: 4029.24
     rank  6: 4026.95
     rank  7: 4026.03
     rank  8: 4231.73
     rank  9: 4232.24
     rank 10: 4231.36
     rank 11: 4239.81
     rank 12: 4258.33
     rank 13: 4263.66
     rank 14: 4262.96
     rank 15: 4262.50
     rank 16: 3556.98
     rank 17: 3562.87
     rank 18: 3558.27
     rank 19: 3557.05
  backward-compute:
     rank  0: 4240.29
     rank  1: 4243.90
     rank  2: 4239.93
     rank  3: 4240.56
     rank  4: 3963.27
     rank  5: 3963.91
     rank  6: 3963.37
     rank  7: 3970.02
     rank  8: 4043.54
     rank  9: 4050.25
     rank 10: 4043.10
     rank 11: 4042.61
     rank 12: 4093.68
     rank 13: 4099.62
     rank 14: 4097.02
     rank 15: 4091.84
     rank 16: 3697.10
     rank 17: 3696.69
     rank 18: 3699.88
     rank 19: 3695.68
  pure-backward-compute:
     rank  0: 4239.46
     rank  1: 4243.19
     rank  2: 4239.23
     rank  3: 4239.81
     rank  4: 3962.51
     rank  5: 3963.11
     rank  6: 3962.63
     rank  7: 3969.19
     rank  8: 4041.98
     rank  9: 4048.85
     rank 10: 4041.93
     rank 11: 4041.54
     rank 12: 4091.88
     rank 13: 4098.39
     rank 14: 4095.80
     rank 15: 4090.04
     rank 16: 3694.58
     rank 17: 3695.11
     rank 18: 3697.92
     rank 19: 3692.70
  batch-generator:
     rank  0: 57.84
     rank  1: 63.86
     rank  2: 64.19
     rank  3: 63.48
     rank  4: 53.92
     rank  5: 59.06
     rank  6: 56.40
     rank  7: 58.26
     rank  8: 81.20
     rank  9: 84.87
     rank 10: 84.88
     rank 11: 96.35
     rank 12: 79.75
     rank 13: 86.03
     rank 14: 84.53
     rank 15: 89.83
     rank 16: 67.27
     rank 17: 74.81
     rank 18: 73.12
     rank 19: 74.43
  forward-recv:
     rank  4: 334.20
     rank  5: 334.48
     rank  6: 335.89
     rank  7: 338.37
     rank  8: 568.40
     rank  9: 567.85
     rank 10: 567.51
     rank 11: 566.74
     rank 12: 832.67
     rank 13: 833.06
     rank 14: 831.51
     rank 15: 829.99
     rank 16: 1097.45
     rank 17: 1096.82
     rank 18: 1097.49
     rank 19: 1097.41
  forward-send:
     rank  0: 42.49
     rank  1: 40.52
     rank  2: 41.04
     rank  3: 42.12
     rank  4: 40.42
     rank  5: 39.31
     rank  6: 38.31
     rank  7: 36.24
     rank  8: 21.83
     rank  9: 22.03
     rank 10: 21.35
     rank 11: 20.00
     rank 12: 10.83
     rank 13: 10.20
     rank 14: 10.80
     rank 15: 10.84
  backward-recv:
     rank  0: 1072.07
     rank  1: 1071.89
     rank  2: 1072.69
     rank  3: 1072.33
     rank  4: 791.95
     rank  5: 792.47
     rank  6: 792.11
     rank  7: 790.10
     rank  8: 486.86
     rank  9: 486.61
     rank 10: 487.03
     rank 11: 488.50
     rank 12: 198.30
     rank 13: 197.95
     rank 14: 198.33
     rank 15: 198.68
  backward-send:
     rank  4: 41.36
     rank  5: 40.58
     rank  6: 41.41
     rank  7: 41.36
     rank  8: 39.82
     rank  9: 39.15
     rank 10: 39.86
     rank 11: 37.70
     rank 12: 21.72
     rank 13: 21.28
     rank 14: 21.65
     rank 15: 21.37
     rank 16: 10.97
     rank 17: 10.46
     rank 18: 10.82
     rank 19: 11.01
  forward-send-backward-recv:
     rank  0: 1271.80
     rank  1: 1272.09
     rank  2: 1273.82
     rank  3: 1272.99
     rank  4: 1332.75
     rank  5: 1336.52
     rank  6: 1337.01
     rank  7: 1329.98
     rank  8: 766.06
     rank  9: 759.44
     rank 10: 769.27
     rank 11: 769.77
     rank 12: 445.39
     rank 13: 442.94
     rank 14: 443.04
     rank 15: 445.67
  backward-send-forward-recv:
     rank  4: 134.81
     rank  5: 132.63
     rank  6: 134.54
     rank  7: 134.78
     rank  8: 250.62
     rank  9: 250.62
     rank 10: 252.11
     rank 11: 245.82
     rank 12: 282.99
     rank 13: 278.41
     rank 14: 281.64
     rank 15: 282.58
     rank 16: 1517.61
     rank 17: 1515.54
     rank 18: 1515.95
     rank 19: 1518.84
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.03
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.05
     rank  2: 0.06
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.06
     rank 17: 0.09
     rank 18: 0.05
     rank 19: 0.06
  all-grads-sync:
     rank  0: 0.68
     rank  1: 0.67
     rank  2: 0.65
     rank  3: 0.67
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.03
     rank 16: 0.02
     rank 17: 0.03
     rank 18: 0.02
     rank 19: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.20
     rank  1: 0.20
     rank  2: 0.20
     rank  3: 0.20
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.01
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
     rank 16: 0.01
     rank 17: 0.02
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 10.42
     rank  1: 10.29
     rank  2: 10.75
     rank  3: 10.50
     rank  4: 0.04
     rank  5: 0.04
     rank  6: 0.07
     rank  7: 0.05
     rank  8: 0.08
     rank  9: 0.08
     rank 10: 0.11
     rank 11: 0.08
     rank 12: 0.05
     rank 13: 0.04
     rank 14: 0.05
     rank 15: 0.08
     rank 16: 0.04
     rank 17: 0.08
     rank 18: 0.05
     rank 19: 0.04
  optimizer:
     rank  0: 11.16
     rank  1: 11.04
     rank  2: 11.50
     rank  3: 11.25
     rank  4: 0.78
     rank  5: 0.79
     rank  6: 0.82
     rank  7: 0.80
     rank  8: 0.83
     rank  9: 0.83
     rank 10: 0.86
     rank 11: 0.83
     rank 12: 0.80
     rank 13: 0.78
     rank 14: 0.80
     rank 15: 0.83
     rank 16: 0.79
     rank 17: 0.83
     rank 18: 0.80
     rank 19: 0.79
 [2024-12-16 20:10:36] iteration        9/      10 | consumed samples:          288 | elapsed time per iteration (ms): 11110.0 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 1.175104E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 11063.97
     rank  1: 11063.98
     rank  2: 11063.96
     rank  3: 11063.96
     rank  4: 11063.05
     rank  5: 11063.01
     rank  6: 11063.02
     rank  7: 11063.04
     rank  8: 11063.20
     rank  9: 11063.22
     rank 10: 11063.17
     rank 11: 11063.17
     rank 12: 11063.26
     rank 13: 11063.21
     rank 14: 11063.24
     rank 15: 11063.24
     rank 16: 11063.19
     rank 17: 11063.12
     rank 18: 11063.15
     rank 19: 11063.20
  forward-compute:
     rank  0: 4446.99
     rank  1: 4457.60
     rank  2: 4448.68
     rank  3: 4454.52
     rank  4: 4021.87
     rank  5: 4035.72
     rank  6: 4024.03
     rank  7: 4029.39
     rank  8: 4232.02
     rank  9: 4240.04
     rank 10: 4234.32
     rank 11: 4239.82
     rank 12: 4262.04
     rank 13: 4271.54
     rank 14: 4265.30
     rank 15: 4265.67
     rank 16: 3563.07
     rank 17: 3569.45
     rank 18: 3563.77
     rank 19: 3563.02
  backward-compute:
     rank  0: 4240.64
     rank  1: 4244.92
     rank  2: 4240.83
     rank  3: 4240.73
     rank  4: 3969.48
     rank  5: 3971.07
     rank  6: 3970.97
     rank  7: 3974.95
     rank  8: 4039.18
     rank  9: 4046.56
     rank 10: 4040.44
     rank 11: 4040.37
     rank 12: 4101.66
     rank 13: 4107.28
     rank 14: 4103.91
     rank 15: 4098.87
     rank 16: 3701.16
     rank 17: 3701.09
     rank 18: 3704.62
     rank 19: 3699.80
  pure-backward-compute:
     rank  0: 4239.92
     rank  1: 4244.16
     rank  2: 4240.14
     rank  3: 4240.04
     rank  4: 3968.67
     rank  5: 3970.34
     rank  6: 3970.25
     rank  7: 3974.09
     rank  8: 4037.50
     rank  9: 4045.03
     rank 10: 4039.01
     rank 11: 4038.97
     rank 12: 4099.80
     rank 13: 4106.16
     rank 14: 4102.68
     rank 15: 4097.19
     rank 16: 3698.67
     rank 17: 3699.55
     rank 18: 3702.72
     rank 19: 3696.87
  batch-generator:
     rank  0: 55.94
     rank  1: 71.23
     rank  2: 62.81
     rank  3: 69.94
     rank  4: 54.82
     rank  5: 71.25
     rank  6: 58.87
     rank  7: 67.10
     rank  8: 78.16
     rank  9: 90.06
     rank 10: 84.99
     rank 11: 93.91
     rank 12: 80.51
     rank 13: 91.02
     rank 14: 84.12
     rank 15: 90.38
     rank 16: 67.63
     rank 17: 75.95
     rank 18: 73.02
     rank 19: 74.92
  forward-recv:
     rank  4: 309.56
     rank  5: 306.57
     rank  6: 310.42
     rank  7: 307.01
     rank  8: 559.82
     rank  9: 557.99
     rank 10: 558.41
     rank 11: 557.00
     rank 12: 829.22
     rank 13: 825.40
     rank 14: 828.66
     rank 15: 827.65
     rank 16: 1095.34
     rank 17: 1094.12
     rank 18: 1095.50
     rank 19: 1095.21
  forward-send:
     rank  0: 50.70
     rank  1: 39.62
     rank  2: 49.13
     rank  3: 42.16
     rank  4: 59.69
     rank  5: 51.84
     rank  6: 57.66
     rank  7: 54.40
     rank  8: 26.12
     rank  9: 20.74
     rank 10: 26.02
     rank 11: 24.52
     rank 12: 11.73
     rank 13: 10.11
     rank 14: 11.79
     rank 15: 11.39
  backward-recv:
     rank  0: 1073.38
     rank  1: 1072.76
     rank  2: 1073.33
     rank  3: 1074.09
     rank  4: 794.74
     rank  5: 794.53
     rank  6: 794.56
     rank  7: 792.91
     rank  8: 495.17
     rank  9: 494.98
     rank 10: 495.50
     rank 11: 496.52
     rank 12: 197.41
     rank 13: 197.71
     rank 14: 197.47
     rank 15: 197.39
  backward-send:
     rank  4: 41.31
     rank  5: 40.46
     rank  6: 41.26
     rank  7: 41.69
     rank  8: 34.38
     rank  9: 33.33
     rank 10: 34.16
     rank 11: 32.75
     rank 12: 21.76
     rank 13: 20.72
     rank 14: 21.66
     rank 15: 21.57
     rank 16: 10.79
     rank 17: 10.32
     rank 18: 10.71
     rank 19: 10.74
  forward-send-backward-recv:
     rank  0: 1231.63
     rank  1: 1230.03
     rank  2: 1232.50
     rank  3: 1232.42
     rank  4: 1295.62
     rank  5: 1297.18
     rank  6: 1296.89
     rank  7: 1291.72
     rank  8: 779.68
     rank  9: 772.26
     rank 10: 781.38
     rank 11: 781.43
     rank 12: 447.85
     rank 13: 444.92
     rank 14: 446.86
     rank 15: 448.89
  backward-send-forward-recv:
     rank  4: 294.13
     rank  5: 291.19
     rank  6: 293.20
     rank  7: 294.17
     rank  8: 362.41
     rank  9: 361.57
     rank 10: 361.13
     rank 11: 358.48
     rank 12: 393.56
     rank 13: 390.29
     rank 14: 392.71
     rank 15: 393.15
     rank 16: 1629.32
     rank 17: 1627.20
     rank 18: 1627.89
     rank 19: 1630.65
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.05
     rank  2: 0.05
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.06
     rank 17: 0.05
     rank 18: 0.06
     rank 19: 0.06
  all-grads-sync:
     rank  0: 0.64
     rank  1: 0.66
     rank  2: 0.66
     rank  3: 0.65
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.19
     rank  1: 0.19
     rank  2: 0.20
     rank  3: 0.20
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 10.24
     rank  1: 10.68
     rank  2: 10.66
     rank  3: 10.66
     rank  4: 0.04
     rank  5: 0.04
     rank  6: 0.05
     rank  7: 0.04
     rank  8: 0.05
     rank  9: 0.05
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.08
     rank 13: 0.04
     rank 14: 0.08
     rank 15: 0.05
     rank 16: 0.04
     rank 17: 0.04
     rank 18: 0.07
     rank 19: 0.07
  optimizer:
     rank  0: 10.94
     rank  1: 11.39
     rank  2: 11.36
     rank  3: 11.36
     rank  4: 0.73
     rank  5: 0.74
     rank  6: 0.75
     rank  7: 0.74
     rank  8: 0.75
     rank  9: 0.75
     rank 10: 0.76
     rank 11: 0.75
     rank 12: 0.78
     rank 13: 0.75
     rank 14: 0.78
     rank 15: 0.75
     rank 16: 0.74
     rank 17: 0.74
     rank 18: 0.77
     rank 19: 0.78
 [2024-12-16 20:10:47] iteration       10/      10 | consumed samples:          320 | elapsed time per iteration (ms): 10992.9 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 1.265187E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 10951.38
     rank  1: 10951.33
     rank  2: 10951.39
     rank  3: 10951.34
     rank  4: 10950.42
     rank  5: 10950.41
     rank  6: 10950.41
     rank  7: 10950.42
     rank  8: 10950.60
     rank  9: 10950.58
     rank 10: 10950.54
     rank 11: 10950.55
     rank 12: 10950.67
     rank 13: 10950.66
     rank 14: 10950.83
     rank 15: 10950.69
     rank 16: 10950.59
     rank 17: 10950.52
     rank 18: 10950.53
     rank 19: 10950.59
  forward-compute:
     rank  0: 4296.75
     rank  1: 4296.94
     rank  2: 4297.93
     rank  3: 4296.24
     rank  4: 4027.66
     rank  5: 4030.18
     rank  6: 4028.38
     rank  7: 4027.03
     rank  8: 4236.65
     rank  9: 4236.47
     rank 10: 4238.62
     rank 11: 4245.91
     rank 12: 4265.21
     rank 13: 4269.50
     rank 14: 4267.89
     rank 15: 4267.78
     rank 16: 3564.05
     rank 17: 3569.98
     rank 18: 3564.37
     rank 19: 3564.76
  backward-compute:
     rank  0: 4241.29
     rank  1: 4244.09
     rank  2: 4240.71
     rank  3: 4241.00
     rank  4: 3967.42
     rank  5: 3968.32
     rank  6: 3968.34
     rank  7: 3973.11
     rank  8: 4047.90
     rank  9: 4055.03
     rank 10: 4047.86
     rank 11: 4047.46
     rank 12: 4093.17
     rank 13: 4099.47
     rank 14: 4095.28
     rank 15: 4092.84
     rank 16: 3712.16
     rank 17: 3711.56
     rank 18: 3714.87
     rank 19: 3709.51
  pure-backward-compute:
     rank  0: 4240.58
     rank  1: 4243.37
     rank  2: 4240.00
     rank  3: 4240.30
     rank  4: 3966.59
     rank  5: 3967.59
     rank  6: 3967.66
     rank  7: 3972.29
     rank  8: 4046.22
     rank  9: 4053.83
     rank 10: 4046.77
     rank 11: 4046.28
     rank 12: 4091.28
     rank 13: 4098.30
     rank 14: 4094.01
     rank 15: 4091.16
     rank 16: 3709.47
     rank 17: 3709.99
     rank 18: 3713.13
     rank 19: 3707.16
  batch-generator:
     rank  0: 53.73
     rank  1: 58.97
     rank  2: 59.55
     rank  3: 58.23
     rank  4: 53.40
     rank  5: 58.58
     rank  6: 56.25
     rank  7: 57.83
     rank  8: 76.69
     rank  9: 81.24
     rank 10: 83.76
     rank 11: 94.57
     rank 12: 78.76
     rank 13: 84.10
     rank 14: 81.99
     rank 15: 87.62
     rank 16: 67.15
     rank 17: 74.81
     rank 18: 72.28
     rank 19: 75.11
  forward-recv:
     rank  4: 329.06
     rank  5: 329.26
     rank  6: 331.37
     rank  7: 335.94
     rank  8: 563.02
     rank  9: 562.77
     rank 10: 561.28
     rank 11: 558.17
     rank 12: 829.98
     rank 13: 830.78
     rank 14: 829.66
     rank 15: 828.10
     rank 16: 1093.67
     rank 17: 1093.28
     rank 18: 1093.87
     rank 19: 1093.65
  forward-send:
     rank  0: 41.85
     rank  1: 41.16
     rank  2: 41.46
     rank  3: 41.85
     rank  4: 48.22
     rank  5: 47.93
     rank  6: 46.07
     rank  7: 41.46
     rank  8: 22.71
     rank  9: 22.97
     rank 10: 22.46
     rank 11: 21.13
     rank 12: 10.85
     rank 13: 10.25
     rank 14: 10.76
     rank 15: 10.90
  backward-recv:
     rank  0: 1075.67
     rank  1: 1075.97
     rank  2: 1077.10
     rank  3: 1076.45
     rank  4: 796.82
     rank  5: 796.45
     rank  6: 796.38
     rank  7: 794.88
     rank  8: 491.09
     rank  9: 491.00
     rank 10: 491.33
     rank 11: 492.41
     rank 12: 199.37
     rank 13: 199.94
     rank 14: 199.56
     rank 15: 199.48
  backward-send:
     rank  4: 41.26
     rank  5: 40.43
     rank  6: 41.34
     rank  7: 41.53
     rank  8: 38.45
     rank  9: 37.29
     rank 10: 38.28
     rank 11: 36.52
     rank 12: 21.62
     rank 13: 20.78
     rank 14: 21.76
     rank 15: 21.36
     rank 16: 10.88
     rank 17: 10.40
     rank 18: 10.77
     rank 19: 10.84
  forward-send-backward-recv:
     rank  0: 1275.75
     rank  1: 1273.32
     rank  2: 1274.14
     rank  3: 1276.21
     rank  4: 1328.64
     rank  5: 1330.65
     rank  6: 1330.36
     rank  7: 1324.25
     rank  8: 770.39
     rank  9: 762.99
     rank 10: 773.23
     rank 11: 774.30
     rank 12: 447.44
     rank 13: 444.18
     rank 14: 446.44
     rank 15: 446.24
  backward-send-forward-recv:
     rank  4: 134.73
     rank  5: 132.40
     rank  6: 134.04
     rank  7: 134.85
     rank  8: 244.93
     rank  9: 245.45
     rank 10: 244.86
     rank 11: 241.72
     rank 12: 282.95
     rank 13: 279.15
     rank 14: 282.47
     rank 15: 283.41
     rank 16: 1504.92
     rank 17: 1502.76
     rank 18: 1504.45
     rank 19: 1506.55
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.05
     rank 15: 0.04
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.05
     rank  2: 0.05
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.04
     rank 13: 0.03
     rank 14: 0.06
     rank 15: 0.05
     rank 16: 0.06
     rank 17: 0.06
     rank 18: 0.06
     rank 19: 0.06
  all-grads-sync:
     rank  0: 0.67
     rank  1: 0.64
     rank  2: 0.66
     rank  3: 0.65
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.04
     rank 15: 0.07
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.20
     rank  1: 0.18
     rank  2: 0.20
     rank  3: 0.20
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 10.45
     rank  1: 10.29
     rank  2: 10.50
     rank  3: 10.19
     rank  4: 0.04
     rank  5: 0.04
     rank  6: 0.04
     rank  7: 0.04
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.05
     rank 13: 0.07
     rank 14: 0.11
     rank 15: 0.06
     rank 16: 0.07
     rank 17: 0.05
     rank 18: 0.05
     rank 19: 0.05
  optimizer:
     rank  0: 11.26
     rank  1: 11.06
     rank  2: 11.27
     rank  3: 10.96
     rank  4: 0.81
     rank  5: 0.80
     rank  6: 0.81
     rank  7: 0.80
     rank  8: 0.81
     rank  9: 0.81
     rank 10: 0.81
     rank 11: 0.81
     rank 12: 0.82
     rank 13: 0.84
     rank 14: 0.88
     rank 15: 0.82
     rank 16: 0.84
     rank 17: 0.82
     rank 18: 0.82
     rank 19: 0.82
