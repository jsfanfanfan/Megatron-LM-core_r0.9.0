examples/multimodal/pretrain-freeze-llm-hete-2080first.sh: line 4: activate: No such file or directory
4
[2024-12-12 14:10:33,733] torch.distributed.run: [WARNING] 
[2024-12-12 14:10:33,733] torch.distributed.run: [WARNING] *****************************************
[2024-12-12 14:10:33,733] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-12-12 14:10:33,733] torch.distributed.run: [WARNING] *****************************************
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:20------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:20------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:20------
------num_pipeline_model_parallel_groups:4------
> setting tensorboard ...
WARNING: one_logger package is required to enable e2e metrics tracking. please go to https://confluence.nvidia.com/display/MLWFO/Package+Repositories for details to install it
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:20------
------num_pipeline_model_parallel_groups:4------
---Rank 19---Tensor Parallel Group GPUs: [3, 3, 3, 3]
---Rank 18---Tensor Parallel Group GPUs: [2, 2, 2, 2]
---Rank 19---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]
---Rank 18---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]
[rank18]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank19]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
---Rank 16---Tensor Parallel Group GPUs: [0, 0, 0, 0]
---Rank 17---Tensor Parallel Group GPUs: [1, 1, 1, 1]
---Rank 17---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]
---Rank 16---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]
[rank16]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank17]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
 > number of parameters on (tensor, pipeline) model parallel rank (1, 4): 306229248
 > number of parameters on (tensor, pipeline) model parallel rank (0, 4): 306229248
 > number of parameters on (tensor, pipeline) model parallel rank (3, 4): 306229248
INFO:megatron.core.distributed.param_and_grad_buffer:Number of buckets for gradient all-reduce / reduce-scatter: 1
Params for bucket 1 (306229248 elements):
	language_model.decoder.layers.3.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.3.self_attention.linear_proj.weight
	language_model.decoder.layers.1.self_attention.linear_proj.weight
	language_model.decoder.layers.4.mlp.linear_fc2.weight
	language_model.decoder.final_layernorm.weight
	language_model.decoder.layers.3.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.0.mlp.linear_fc2.weight
	language_model.output_layer.weight
	language_model.decoder.layers.3.self_attention.linear_qkv.weight
	language_model.decoder.layers.2.self_attention.linear_qkv.weight
	language_model.decoder.layers.1.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.2.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.4.self_attention.linear_proj.weight
	language_model.decoder.layers.2.self_attention.linear_proj.weight
	language_model.decoder.layers.0.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.4.self_attention.linear_qkv.weight
	language_model.decoder.layers.3.mlp.linear_fc1.weight
	language_model.decoder.layers.1.self_attention.linear_qkv.weight
	language_model.decoder.layers.0.self_attention.linear_proj.weight
	language_model.decoder.layers.4.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.4.mlp.linear_fc1.weight
	language_model.decoder.layers.4.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.3.mlp.linear_fc2.weight
	language_model.decoder.layers.2.mlp.linear_fc2.weight
	language_model.decoder.layers.2.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.2.mlp.linear_fc1.weight
	language_model.decoder.layers.1.mlp.linear_fc1.weight
	language_model.decoder.layers.1.mlp.linear_fc2.weight
	language_model.decoder.layers.1.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.0.mlp.linear_fc1.weight
	language_model.decoder.layers.0.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.0.self_attention.linear_qkv.weight
 > number of parameters on (tensor, pipeline) model parallel rank (2, 4): 306229248
rank=0, worker=0: shard_range=[pretrain-0.tar[0, 100), pretrain-0.tar[100, 200), pretrain-0.tar[200, 300), ...<2494>, pretrain-30.tar[9700, 9800), pretrain-30.tar[9800, 9900), pretrain-30.tar[9900, 10000)] sum(count)=250000
rank=0, worker=1: shard_range=[pretrain-31.tar[0, 100), pretrain-31.tar[100, 200), pretrain-31.tar[200, 300), ...<2494>, pretrain-53.tar[9700, 9800), pretrain-53.tar[9800, 9900), pretrain-53.tar[9900, 10000)] sum(count)=250000
rank=0, worker=0: shard_range=[pretrain-54.tar[0, 10000), pretrain-55.tar[0, 8128), pretrain-6.tar[0, 10000), pretrain-7.tar[0, 936)] sum(count)=29064
rank=0, worker=1: shard_range=[pretrain-7.tar[936, 10000), pretrain-8.tar[0, 10000), pretrain-9.tar[0, 10000)] sum(count)=29064
times across ranks (ms):
  model-and-optimizer-setup:
     rank  0: 151.16
     rank  1: 149.44
     rank  2: 148.45
     rank  3: 150.39
     rank  4: 52.02
     rank  5: 51.81
     rank  6: 51.77
     rank  7: 40.96
     rank  8: 42.91
     rank  9: 42.79
     rank 10: 42.67
     rank 11: 67.05
     rank 12: 60.14
     rank 13: 64.66
     rank 14: 60.97
     rank 15: 60.33
     rank 16: 58.28
     rank 17: 57.89
     rank 18: 64.30
     rank 19: 59.07
  train/valid/test-data-iterators-setup:
     rank  0: 1113.76
     rank  1: 1113.06
     rank  2: 1257.27
     rank  3: 1113.22
     rank  4: 1112.97
     rank  5: 1113.06
     rank  6: 1113.63
     rank  7: 1113.03
     rank  8: 1113.19
     rank  9: 1113.14
     rank 10: 1113.12
     rank 11: 1113.09
     rank 12: 1257.18
     rank 13: 1257.41
     rank 14: 1113.48
     rank 15: 1256.99
     rank 16: 1257.10
     rank 17: 1257.49
     rank 18: 1257.32
     rank 19: 1257.08
 [2024-12-12 14:11:08] iteration        1/      10 | consumed samples:           10 | elapsed time per iteration (ms): 14438.9 | learning rate: 7.500000E-07 | global batch size:    10 | lm loss: 7.039371E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
[Rank 18] (after 1 iterations) memory (MB) | allocated: 4757.9404296875 | max allocated: 5925.59814453125 | reserved: 6668.0 | max reserved: 6668.0
[Rank 17] (after 1 iterations) memory (MB) | allocated: 4757.9404296875 | max allocated: 5925.59814453125 | reserved: 6660.0 | max reserved: 6660.0
[Rank 16] (after 1 iterations) memory (MB) | allocated: 4757.9404296875 | max allocated: 5925.59814453125 | reserved: 6660.0 | max reserved: 6660.0
[Rank 19] (after 1 iterations) memory (MB) | allocated: 4757.9404296875 | max allocated: 5925.59814453125 | reserved: 6660.0 | max reserved: 6660.0
times across ranks (ms):
  forward-backward:
     rank  0: 14359.45
     rank  1: 14359.37
     rank  2: 14359.40
     rank  3: 14359.33
     rank  4: 14360.35
     rank  5: 14360.18
     rank  6: 14360.24
     rank  7: 14360.24
     rank  8: 14361.54
     rank  9: 14361.37
     rank 10: 14361.37
     rank 11: 14361.42
     rank 12: 14361.23
     rank 13: 14361.16
     rank 14: 14361.22
     rank 15: 14361.13
     rank 16: 14361.15
     rank 17: 14360.72
     rank 18: 14360.77
     rank 19: 14360.65
  forward-compute:
     rank  0: 3206.37
     rank  1: 3249.53
     rank  2: 3204.83
     rank  3: 3216.03
     rank  4: 3261.53
     rank  5: 3301.29
     rank  6: 3255.73
     rank  7: 3269.70
     rank  8: 3515.51
     rank  9: 3535.37
     rank 10: 3517.04
     rank 11: 3520.06
     rank 12: 2423.35
     rank 13: 2443.15
     rank 14: 2423.64
     rank 15: 2424.56
     rank 16: 2725.90
     rank 17: 2746.10
     rank 18: 2733.96
     rank 19: 2732.20
  backward-compute:
     rank  0: 703.43
     rank  1: 699.79
     rank  2: 697.09
     rank  3: 698.77
     rank  4: 1178.26
     rank  5: 1170.28
     rank  6: 1173.75
     rank  7: 1171.54
     rank  8: 1407.40
     rank  9: 1407.67
     rank 10: 1408.88
     rank 11: 1410.43
     rank 12: 1318.89
     rank 13: 1339.25
     rank 14: 1327.94
     rank 15: 1322.61
     rank 16: 1349.88
     rank 17: 1355.92
     rank 18: 1351.45
     rank 19: 1349.83
  pure-backward-compute:
     rank  0: 703.11
     rank  1: 699.48
     rank  2: 696.74
     rank  3: 698.47
     rank  4: 1177.97
     rank  5: 1169.98
     rank  6: 1173.24
     rank  7: 1171.01
     rank  8: 1407.06
     rank  9: 1407.33
     rank 10: 1408.59
     rank 11: 1410.02
     rank 12: 1317.85
     rank 13: 1338.55
     rank 14: 1327.03
     rank 15: 1321.94
     rank 16: 1348.73
     rank 17: 1355.12
     rank 18: 1350.47
     rank 19: 1349.03
  batch-generator:
     rank  0: 1007.66
     rank  1: 1063.97
     rank  2: 1008.46
     rank  3: 1018.23
     rank  4: 1190.67
     rank  5: 1231.94
     rank  6: 1188.23
     rank  7: 1201.46
     rank  8: 1250.37
     rank  9: 1268.02
     rank 10: 1249.88
     rank 11: 1253.93
     rank 12: 1239.94
     rank 13: 1254.76
     rank 14: 1238.59
     rank 15: 1238.04
     rank 16: 1424.96
     rank 17: 1449.00
     rank 18: 1438.78
     rank 19: 1433.66
  forward-recv:
     rank  4: 2426.75
     rank  5: 2410.16
     rank  6: 2433.06
     rank  7: 2425.79
     rank  8: 4917.95
     rank  9: 4911.05
     rank 10: 4915.41
     rank 11: 4907.56
     rank 12: 7511.65
     rank 13: 7496.80
     rank 14: 7509.00
     rank 15: 7512.16
     rank 16: 9063.11
     rank 17: 9057.83
     rank 18: 9062.73
     rank 19: 9061.35
  forward-send:
     rank  0: 6123.22
     rank  1: 6080.89
     rank  2: 6125.96
     rank  3: 6114.04
     rank  4: 3804.87
     rank  5: 3777.86
     rank  6: 3799.29
     rank  7: 3793.10
     rank  8: 1368.97
     rank  9: 1348.45
     rank 10: 1366.00
     rank 11: 1367.73
     rank 12: 33.55
     rank 13: 28.16
     rank 14: 33.79
     rank 15: 32.08
  backward-recv:
     rank  0: 1490.10
     rank  1: 1489.72
     rank  2: 1491.85
     rank  3: 1490.27
     rank  4: 817.04
     rank  5: 818.51
     rank  6: 817.54
     rank  7: 815.92
     rank  8: 427.40
     rank  9: 427.09
     rank 10: 424.14
     rank 11: 426.08
     rank 12: 237.38
     rank 13: 237.29
     rank 14: 238.52
     rank 15: 237.19
  backward-send:
     rank  4: 46.55
     rank  5: 45.29
     rank  6: 46.00
     rank  7: 47.62
     rank  8: 30.99
     rank  9: 31.19
     rank 10: 32.72
     rank 11: 31.53
     rank 12: 21.27
     rank 13: 21.36
     rank 14: 20.41
     rank 15: 20.53
     rank 16: 10.71
     rank 17: 10.55
     rank 18: 10.77
     rank 19: 9.86
  forward-send-backward-recv:
     rank  0: 2764.16
     rank  1: 2768.11
     rank  2: 2768.80
     rank  3: 2768.85
     rank  4: 2600.46
     rank  5: 2608.08
     rank  6: 2604.87
     rank  7: 2607.27
     rank  8: 2222.69
     rank  9: 2222.46
     rank 10: 2222.84
     rank 11: 2220.93
     rank 12: 1934.36
     rank 13: 1916.78
     rank 14: 1927.17
     rank 15: 1933.24
  backward-send-forward-recv:
     rank  4: 24.09
     rank  5: 27.67
     rank  6: 28.18
     rank  7: 27.85
     rank  8: 24.91
     rank  9: 32.39
     rank 10: 29.24
     rank 11: 31.65
     rank 12: 144.16
     rank 13: 144.60
     rank 14: 146.00
     rank 15: 143.81
     rank 16: 209.42
     rank 17: 189.29
     rank 18: 200.13
     rank 19: 205.75
  layernorm-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.05
     rank  2: 0.05
     rank  3: 0.05
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.04
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.08
     rank 13: 0.13
     rank 14: 0.13
     rank 15: 0.08
     rank 16: 0.14
     rank 17: 0.04
     rank 18: 0.05
     rank 19: 0.04
  embedding-grads-all-reduce:
     rank  0: 0.15
     rank  1: 0.16
     rank  2: 0.14
     rank  3: 0.12
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.08
     rank 13: 0.10
     rank 14: 0.09
     rank 15: 0.07
     rank 16: 0.27
     rank 17: 0.08
     rank 18: 0.14
     rank 19: 0.09
  all-grads-sync:
     rank  0: 61.01
     rank  1: 60.35
     rank  2: 60.80
     rank  3: 60.52
     rank  4: 37.43
     rank  5: 46.16
     rank  6: 42.39
     rank  7: 43.95
     rank  8: 45.80
     rank  9: 45.54
     rank 10: 45.86
     rank 11: 46.11
     rank 12: 61.09
     rank 13: 62.68
     rank 14: 62.18
     rank 15: 62.16
     rank 16: 26.77
     rank 17: 23.96
     rank 18: 24.86
     rank 19: 23.72
  optimizer-copy-to-main-grad:
     rank  0: 0.08
     rank  1: 0.07
     rank  2: 0.08
     rank  3: 0.06
     rank  4: 0.07
     rank  5: 0.06
     rank  6: 0.07
     rank  7: 0.09
     rank  8: 0.07
     rank  9: 0.07
     rank 10: 0.07
     rank 11: 0.11
     rank 12: 0.10
     rank 13: 0.17
     rank 14: 0.20
     rank 15: 0.10
     rank 16: 0.17
     rank 17: 0.11
     rank 18: 0.11
     rank 19: 0.08
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.04
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.04
     rank 14: 0.03
     rank 15: 0.03
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.02
     rank 19: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.01
     rank 17: 0.02
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 48.44
     rank  1: 49.22
     rank  2: 49.37
     rank  3: 48.91
     rank  4: 59.01
     rank  5: 58.86
     rank  6: 59.58
     rank  7: 59.53
     rank  8: 71.54
     rank  9: 71.29
     rank 10: 71.19
     rank 11: 72.11
     rank 12: 68.42
     rank 13: 65.43
     rank 14: 65.30
     rank 15: 64.73
     rank 16: 68.12
     rank 17: 67.75
     rank 18: 68.07
     rank 19: 67.56
  optimizer:
     rank  0: 49.71
     rank  1: 50.52
     rank  2: 50.67
     rank  3: 50.21
     rank  4: 60.31
     rank  5: 60.15
     rank  6: 60.88
     rank  7: 60.84
     rank  8: 72.84
     rank  9: 72.60
     rank 10: 72.49
     rank 11: 73.42
     rank 12: 69.73
     rank 13: 66.88
     rank 14: 66.59
     rank 15: 66.03
     rank 16: 69.42
     rank 17: 69.05
     rank 18: 69.37
     rank 19: 68.86
 [2024-12-12 14:11:13] iteration        2/      10 | consumed samples:           20 | elapsed time per iteration (ms): 4595.5 | learning rate: 1.500000E-06 | global batch size:    10 | lm loss: 7.191048E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4492.44
     rank  1: 4492.40
     rank  2: 4492.50
     rank  3: 4492.47
     rank  4: 4493.82
     rank  5: 4493.79
     rank  6: 4493.89
     rank  7: 4493.91
     rank  8: 4494.91
     rank  9: 4494.92
     rank 10: 4494.94
     rank 11: 4495.00
     rank 12: 4493.40
     rank 13: 4493.41
     rank 14: 4493.47
     rank 15: 4493.48
     rank 16: 4493.97
     rank 17: 4493.88
     rank 18: 4493.87
     rank 19: 4493.88
  forward-compute:
     rank  0: 1207.02
     rank  1: 1207.98
     rank  2: 1207.75
     rank  3: 1209.54
     rank  4: 984.38
     rank  5: 985.17
     rank  6: 985.70
     rank  7: 987.71
     rank  8: 1174.81
     rank  9: 1175.41
     rank 10: 1176.38
     rank 11: 1177.31
     rank 12: 1097.71
     rank 13: 1097.58
     rank 14: 1098.85
     rank 15: 1098.27
     rank 16: 1129.56
     rank 17: 1129.58
     rank 18: 1133.14
     rank 19: 1131.43
  backward-compute:
     rank  0: 640.12
     rank  1: 640.74
     rank  2: 641.30
     rank  3: 638.90
     rank  4: 1163.43
     rank  5: 1163.71
     rank  6: 1164.00
     rank  7: 1163.95
     rank  8: 1392.28
     rank  9: 1392.49
     rank 10: 1397.55
     rank 11: 1393.81
     rank 12: 1290.57
     rank 13: 1291.01
     rank 14: 1293.26
     rank 15: 1289.78
     rank 16: 1336.73
     rank 17: 1338.13
     rank 18: 1335.68
     rank 19: 1337.35
  pure-backward-compute:
     rank  0: 639.83
     rank  1: 640.48
     rank  2: 641.03
     rank  3: 638.62
     rank  4: 1163.17
     rank  5: 1163.36
     rank  6: 1163.76
     rank  7: 1163.67
     rank  8: 1391.86
     rank  9: 1392.22
     rank 10: 1397.33
     rank 11: 1393.34
     rank 12: 1290.04
     rank 13: 1290.67
     rank 14: 1292.73
     rank 15: 1289.29
     rank 16: 1335.80
     rank 17: 1337.50
     rank 18: 1334.76
     rank 19: 1336.65
  batch-generator:
     rank  0: 21.72
     rank  1: 24.35
     rank  2: 25.19
     rank  3: 27.59
     rank  4: 18.29
     rank  5: 18.99
     rank  6: 19.38
     rank  7: 21.54
     rank  8: 16.75
     rank  9: 17.53
     rank 10: 18.66
     rank 11: 20.42
     rank 12: 23.01
     rank 13: 24.06
     rank 14: 28.54
     rank 15: 26.29
     rank 16: 24.83
     rank 17: 26.43
     rank 18: 30.51
     rank 19: 28.97
  forward-recv:
     rank  4: 377.63
     rank  5: 376.83
     rank  6: 378.03
     rank  7: 378.15
     rank  8: 477.66
     rank  9: 477.23
     rank 10: 477.52
     rank 11: 476.30
     rank 12: 728.65
     rank 13: 729.12
     rank 14: 729.36
     rank 15: 727.90
     rank 16: 935.34
     rank 17: 934.85
     rank 18: 933.98
     rank 19: 934.96
  forward-send:
     rank  0: 43.92
     rank  1: 43.03
     rank  2: 43.15
     rank  3: 41.31
     rank  4: 40.45
     rank  5: 40.52
     rank  6: 39.11
     rank  7: 36.51
     rank  8: 21.61
     rank  9: 21.75
     rank 10: 20.87
     rank 11: 20.32
     rank 12: 10.77
     rank 13: 10.56
     rank 14: 9.96
     rank 15: 10.72
  backward-recv:
     rank  0: 1577.68
     rank  1: 1577.19
     rank  2: 1576.85
     rank  3: 1578.72
     rank  4: 812.02
     rank  5: 812.60
     rank  6: 813.31
     rank  7: 811.82
     rank  8: 430.83
     rank  9: 431.26
     rank 10: 429.91
     rank 11: 430.53
     rank 12: 233.78
     rank 13: 234.10
     rank 14: 234.08
     rank 15: 233.85
  backward-send:
     rank  4: 51.40
     rank  5: 50.31
     rank  6: 49.93
     rank  7: 51.53
     rank  8: 31.40
     rank  9: 30.87
     rank 10: 30.78
     rank 11: 31.39
     rank 12: 21.23
     rank 13: 21.11
     rank 14: 19.97
     rank 15: 20.94
     rank 16: 10.75
     rank 17: 10.63
     rank 18: 10.02
     rank 19: 10.46
  forward-send-backward-recv:
     rank  0: 1014.12
     rank  1: 1014.21
     rank  2: 1014.15
     rank  3: 1014.58
     rank  4: 903.35
     rank  5: 903.14
     rank  6: 902.88
     rank  7: 903.14
     rank  8: 558.26
     rank  9: 557.69
     rank 10: 555.37
     rank 11: 557.87
     rank 12: 314.28
     rank 13: 314.14
     rank 14: 312.27
     rank 15: 316.20
  backward-send-forward-recv:
     rank  4: 21.38
     rank  5: 21.19
     rank  6: 21.10
     rank  7: 21.34
     rank  8: 22.40
     rank  9: 22.08
     rank 10: 21.84
     rank 11: 22.36
     rank 12: 123.49
     rank 13: 123.37
     rank 14: 121.85
     rank 15: 123.23
     rank 16: 138.37
     rank 17: 138.06
     rank 18: 136.86
     rank 19: 136.82
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.10
     rank  1: 0.08
     rank  2: 0.07
     rank  3: 0.10
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.02
     rank 16: 0.07
     rank 17: 0.06
     rank 18: 0.06
     rank 19: 0.07
  all-grads-sync:
     rank  0: 1.72
     rank  1: 1.69
     rank  2: 1.70
     rank  3: 1.76
     rank  4: 2.39
     rank  5: 2.41
     rank  6: 2.50
     rank  7: 2.54
     rank  8: 2.91
     rank  9: 2.97
     rank 10: 2.90
     rank 11: 2.97
     rank 12: 2.13
     rank 13: 2.26
     rank 14: 2.28
     rank 15: 2.20
     rank 16: 2.51
     rank 17: 2.41
     rank 18: 2.40
     rank 19: 2.54
  optimizer-copy-to-main-grad:
     rank  0: 0.04
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.04
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.06
     rank  7: 0.06
     rank  8: 0.05
     rank  9: 0.05
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.06
     rank 13: 0.11
     rank 14: 0.13
     rank 15: 0.06
     rank 16: 0.06
     rank 17: 0.06
     rank 18: 0.06
     rank 19: 0.09
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 30.85
     rank  1: 30.85
     rank  2: 30.79
     rank  3: 30.99
     rank  4: 48.33
     rank  5: 48.31
     rank  6: 48.44
     rank  7: 48.39
     rank  8: 58.96
     rank  9: 59.04
     rank 10: 58.98
     rank 11: 59.02
     rank 12: 42.70
     rank 13: 43.51
     rank 14: 43.48
     rank 15: 42.82
     rank 16: 48.70
     rank 17: 48.62
     rank 18: 48.50
     rank 19: 48.64
  optimizer:
     rank  0: 31.63
     rank  1: 31.64
     rank  2: 31.57
     rank  3: 31.78
     rank  4: 49.12
     rank  5: 49.09
     rank  6: 49.24
     rank  7: 49.17
     rank  8: 59.74
     rank  9: 59.82
     rank 10: 59.76
     rank 11: 59.80
     rank 12: 43.48
     rank 13: 44.29
     rank 14: 44.27
     rank 15: 43.60
     rank 16: 49.49
     rank 17: 49.40
     rank 18: 49.29
     rank 19: 49.43
 [2024-12-12 14:11:17] iteration        3/      10 | consumed samples:           30 | elapsed time per iteration (ms): 4576.6 | learning rate: 2.250000E-06 | global batch size:    10 | lm loss: 2.887841E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4484.41
     rank  1: 4484.35
     rank  2: 4484.37
     rank  3: 4484.44
     rank  4: 4485.86
     rank  5: 4485.75
     rank  6: 4485.83
     rank  7: 4485.82
     rank  8: 4486.96
     rank  9: 4486.93
     rank 10: 4486.91
     rank 11: 4486.93
     rank 12: 4485.48
     rank 13: 4485.42
     rank 14: 4485.44
     rank 15: 4485.41
     rank 16: 4485.93
     rank 17: 4485.85
     rank 18: 4485.92
     rank 19: 4485.79
  forward-compute:
     rank  0: 1205.89
     rank  1: 1205.56
     rank  2: 1205.40
     rank  3: 1208.42
     rank  4: 977.13
     rank  5: 977.00
     rank  6: 977.85
     rank  7: 980.62
     rank  8: 1172.86
     rank  9: 1172.53
     rank 10: 1176.39
     rank 11: 1173.18
     rank 12: 1094.54
     rank 13: 1095.41
     rank 14: 1098.15
     rank 15: 1096.66
     rank 16: 1123.12
     rank 17: 1126.09
     rank 18: 1128.15
     rank 19: 1127.55
  backward-compute:
     rank  0: 641.68
     rank  1: 642.19
     rank  2: 643.62
     rank  3: 640.33
     rank  4: 1162.66
     rank  5: 1161.90
     rank  6: 1162.34
     rank  7: 1162.39
     rank  8: 1392.93
     rank  9: 1393.99
     rank 10: 1398.92
     rank 11: 1396.19
     rank 12: 1289.89
     rank 13: 1290.57
     rank 14: 1289.82
     rank 15: 1290.25
     rank 16: 1344.50
     rank 17: 1343.07
     rank 18: 1339.92
     rank 19: 1342.39
  pure-backward-compute:
     rank  0: 641.39
     rank  1: 641.92
     rank  2: 643.35
     rank  3: 640.06
     rank  4: 1162.39
     rank  5: 1161.59
     rank  6: 1161.99
     rank  7: 1162.00
     rank  8: 1392.68
     rank  9: 1393.56
     rank 10: 1398.66
     rank 11: 1395.71
     rank 12: 1288.83
     rank 13: 1289.89
     rank 14: 1289.32
     rank 15: 1289.89
     rank 16: 1343.18
     rank 17: 1342.39
     rank 18: 1338.62
     rank 19: 1341.70
  batch-generator:
     rank  0: 20.58
     rank  1: 21.98
     rank  2: 22.83
     rank  3: 26.61
     rank  4: 16.46
     rank  5: 17.32
     rank  6: 18.10
     rank  7: 20.28
     rank  8: 16.24
     rank  9: 16.67
     rank 10: 20.63
     rank 11: 17.43
     rank 12: 26.07
     rank 13: 28.04
     rank 14: 33.55
     rank 15: 30.68
     rank 16: 24.81
     rank 17: 28.08
     rank 18: 30.58
     rank 19: 30.25
  forward-recv:
     rank  4: 384.99
     rank  5: 384.89
     rank  6: 389.65
     rank  7: 383.03
     rank  8: 474.80
     rank  9: 474.83
     rank 10: 472.47
     rank 11: 475.05
     rank 12: 727.68
     rank 13: 728.19
     rank 14: 727.19
     rank 15: 727.92
     rank 16: 930.52
     rank 17: 930.10
     rank 18: 929.82
     rank 19: 929.84
  forward-send:
     rank  0: 43.99
     rank  1: 44.05
     rank  2: 44.14
     rank  3: 41.18
     rank  4: 37.04
     rank  5: 37.04
     rank  6: 32.39
     rank  7: 35.78
     rank  8: 21.95
     rank  9: 21.85
     rank 10: 20.54
     rank 11: 21.34
     rank 12: 10.85
     rank 13: 10.64
     rank 14: 10.61
     rank 15: 10.53
  backward-recv:
     rank  0: 1580.37
     rank  1: 1579.79
     rank  2: 1578.97
     rank  3: 1581.39
     rank  4: 818.45
     rank  5: 819.72
     rank  6: 819.52
     rank  7: 817.95
     rank  8: 434.93
     rank  9: 434.76
     rank 10: 432.74
     rank 11: 433.30
     rank 12: 229.59
     rank 13: 229.93
     rank 14: 231.02
     rank 15: 230.09
  backward-send:
     rank  4: 50.77
     rank  5: 49.72
     rank  6: 49.04
     rank  7: 51.52
     rank  8: 30.87
     rank  9: 31.06
     rank 10: 30.59
     rank 11: 31.25
     rank 12: 30.35
     rank 13: 30.25
     rank 14: 28.13
     rank 15: 29.69
     rank 16: 10.74
     rank 17: 10.78
     rank 18: 10.30
     rank 19: 10.40
  forward-send-backward-recv:
     rank  0: 1003.02
     rank  1: 1003.11
     rank  2: 1002.62
     rank  3: 1003.46
     rank  4: 893.14
     rank  5: 893.51
     rank  6: 893.47
     rank  7: 893.24
     rank  8: 550.05
     rank  9: 549.38
     rank 10: 547.46
     rank 11: 549.00
     rank 12: 307.30
     rank 13: 306.51
     rank 14: 306.68
     rank 15: 306.22
  backward-send-forward-recv:
     rank  4: 21.32
     rank  5: 21.22
     rank  6: 20.66
     rank  7: 21.27
     rank  8: 22.32
     rank  9: 22.52
     rank 10: 22.44
     rank 11: 22.29
     rank 12: 120.59
     rank 13: 120.74
     rank 14: 118.64
     rank 15: 120.04
     rank 16: 133.56
     rank 17: 132.38
     rank 18: 132.18
     rank 19: 131.92
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.05
     rank 15: 0.02
     rank 16: 0.03
     rank 17: 0.02
     rank 18: 0.03
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.10
     rank  1: 0.07
     rank  2: 0.08
     rank  3: 0.09
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.02
     rank 16: 0.08
     rank 17: 0.06
     rank 18: 0.07
     rank 19: 0.06
  all-grads-sync:
     rank  0: 1.75
     rank  1: 1.67
     rank  2: 1.67
     rank  3: 1.77
     rank  4: 2.43
     rank  5: 2.45
     rank  6: 2.40
     rank  7: 2.45
     rank  8: 2.93
     rank  9: 3.01
     rank 10: 2.90
     rank 11: 3.13
     rank 12: 2.23
     rank 13: 2.20
     rank 14: 2.46
     rank 15: 2.17
     rank 16: 2.58
     rank 17: 2.35
     rank 18: 2.54
     rank 19: 2.38
  optimizer-copy-to-main-grad:
     rank  0: 0.04
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.04
     rank  4: 0.06
     rank  5: 0.06
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.05
     rank  9: 0.09
     rank 10: 0.04
     rank 11: 0.10
     rank 12: 0.07
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.04
     rank 16: 0.11
     rank 17: 0.06
     rank 18: 0.07
     rank 19: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
     rank 16: 0.03
     rank 17: 0.01
     rank 18: 0.02
     rank 19: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 31.04
     rank  1: 30.81
     rank  2: 30.78
     rank  3: 30.98
     rank  4: 48.32
     rank  5: 48.43
     rank  6: 48.42
     rank  7: 48.54
     rank  8: 59.04
     rank  9: 59.06
     rank 10: 58.97
     rank 11: 59.11
     rank 12: 42.93
     rank 13: 43.47
     rank 14: 43.45
     rank 15: 42.85
     rank 16: 48.68
     rank 17: 48.54
     rank 18: 48.72
     rank 19: 48.63
  optimizer:
     rank  0: 31.71
     rank  1: 31.48
     rank  2: 31.46
     rank  3: 31.66
     rank  4: 48.99
     rank  5: 49.10
     rank  6: 49.09
     rank  7: 49.21
     rank  8: 59.71
     rank  9: 59.81
     rank 10: 59.64
     rank 11: 59.78
     rank 12: 43.61
     rank 13: 44.14
     rank 14: 44.13
     rank 15: 43.52
     rank 16: 49.36
     rank 17: 49.21
     rank 18: 49.39
     rank 19: 49.31
 [2024-12-12 14:11:22] iteration        4/      10 | consumed samples:           40 | elapsed time per iteration (ms): 4584.7 | learning rate: 3.000000E-06 | global batch size:    10 | lm loss: 6.479749E-01 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4490.25
     rank  1: 4490.33
     rank  2: 4490.28
     rank  3: 4490.31
     rank  4: 4491.72
     rank  5: 4491.72
     rank  6: 4491.68
     rank  7: 4491.72
     rank  8: 4492.82
     rank  9: 4492.82
     rank 10: 4492.77
     rank 11: 4492.83
     rank 12: 4491.33
     rank 13: 4491.29
     rank 14: 4491.28
     rank 15: 4491.32
     rank 16: 4491.86
     rank 17: 4491.69
     rank 18: 4491.70
     rank 19: 4491.69
  forward-compute:
     rank  0: 1206.65
     rank  1: 1206.26
     rank  2: 1206.57
     rank  3: 1209.19
     rank  4: 978.81
     rank  5: 978.62
     rank  6: 979.22
     rank  7: 982.30
     rank  8: 1175.80
     rank  9: 1176.38
     rank 10: 1180.25
     rank 11: 1176.13
     rank 12: 1093.40
     rank 13: 1093.31
     rank 14: 1095.28
     rank 15: 1092.80
     rank 16: 1128.89
     rank 17: 1129.83
     rank 18: 1134.33
     rank 19: 1133.19
  backward-compute:
     rank  0: 641.91
     rank  1: 642.50
     rank  2: 644.10
     rank  3: 640.56
     rank  4: 1164.08
     rank  5: 1163.57
     rank  6: 1164.11
     rank  7: 1164.47
     rank  8: 1398.69
     rank  9: 1398.69
     rank 10: 1402.56
     rank 11: 1399.65
     rank 12: 1289.55
     rank 13: 1290.14
     rank 14: 1292.41
     rank 15: 1292.42
     rank 16: 1340.36
     rank 17: 1339.51
     rank 18: 1337.55
     rank 19: 1339.38
  pure-backward-compute:
     rank  0: 641.64
     rank  1: 642.21
     rank  2: 643.84
     rank  3: 640.29
     rank  4: 1163.80
     rank  5: 1163.26
     rank  6: 1163.87
     rank  7: 1164.22
     rank  8: 1398.39
     rank  9: 1398.42
     rank 10: 1402.33
     rank 11: 1399.24
     rank 12: 1289.05
     rank 13: 1289.82
     rank 14: 1291.85
     rank 15: 1292.05
     rank 16: 1339.29
     rank 17: 1338.85
     rank 18: 1336.64
     rank 19: 1338.74
  batch-generator:
     rank  0: 20.31
     rank  1: 21.68
     rank  2: 22.81
     rank  3: 26.35
     rank  4: 18.51
     rank  5: 19.37
     rank  6: 19.66
     rank  7: 22.17
     rank  8: 17.16
     rank  9: 17.64
     rank 10: 21.63
     rank 11: 17.41
     rank 12: 21.72
     rank 13: 22.52
     rank 14: 27.66
     rank 15: 24.01
     rank 16: 23.14
     rank 17: 24.47
     rank 18: 29.45
     rank 19: 28.32
  forward-recv:
     rank  4: 379.44
     rank  5: 379.89
     rank  6: 384.19
     rank  7: 376.98
     rank  8: 476.32
     rank  9: 476.19
     rank 10: 473.82
     rank 11: 476.67
     rank 12: 730.44
     rank 13: 730.29
     rank 14: 730.21
     rank 15: 731.22
     rank 16: 934.91
     rank 17: 934.87
     rank 18: 933.63
     rank 19: 934.13
  forward-send:
     rank  0: 43.52
     rank  1: 43.73
     rank  2: 43.47
     rank  3: 40.79
     rank  4: 40.54
     rank  5: 40.11
     rank  6: 35.54
     rank  7: 39.62
     rank  8: 21.74
     rank  9: 21.49
     rank 10: 20.05
     rank 11: 21.16
     rank 12: 10.81
     rank 13: 10.71
     rank 14: 10.02
     rank 15: 10.43
  backward-recv:
     rank  0: 1582.15
     rank  1: 1581.70
     rank  2: 1580.34
     rank  3: 1582.94
     rank  4: 815.31
     rank  5: 816.64
     rank  6: 817.20
     rank  7: 815.56
     rank  8: 430.48
     rank  9: 430.49
     rank 10: 429.99
     rank 11: 430.25
     rank 12: 235.16
     rank 13: 235.36
     rank 14: 235.20
     rank 15: 234.99
  backward-send:
     rank  4: 51.91
     rank  5: 50.75
     rank  6: 49.65
     rank  7: 51.72
     rank  8: 31.30
     rank  9: 31.27
     rank 10: 30.46
     rank 11: 31.28
     rank 12: 21.30
     rank 13: 21.19
     rank 14: 20.17
     rank 15: 21.33
     rank 16: 10.66
     rank 17: 10.61
     rank 18: 10.00
     rank 19: 10.45
  forward-send-backward-recv:
     rank  0: 1006.92
     rank  1: 1006.65
     rank  2: 1006.02
     rank  3: 1007.51
     rank  4: 900.11
     rank  5: 900.36
     rank  6: 900.21
     rank  7: 900.05
     rank  8: 550.72
     rank  9: 550.33
     rank 10: 548.75
     rank 11: 550.10
     rank 12: 311.71
     rank 13: 311.35
     rank 14: 309.13
     rank 15: 309.81
  backward-send-forward-recv:
     rank  4: 21.63
     rank  5: 21.47
     rank  6: 21.43
     rank  7: 21.58
     rank  8: 22.42
     rank  9: 22.44
     rank 10: 22.31
     rank 11: 22.43
     rank 12: 123.17
     rank 13: 123.44
     rank 14: 121.78
     rank 15: 123.14
     rank 16: 130.96
     rank 17: 131.05
     rank 18: 129.12
     rank 19: 129.12
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.04
     rank  2: 0.03
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.02
     rank 16: 0.03
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.07
     rank  1: 0.11
     rank  2: 0.08
     rank  3: 0.12
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.08
     rank 17: 0.06
     rank 18: 0.06
     rank 19: 0.05
  all-grads-sync:
     rank  0: 1.69
     rank  1: 1.75
     rank  2: 1.73
     rank  3: 1.74
     rank  4: 2.39
     rank  5: 2.40
     rank  6: 2.51
     rank  7: 2.51
     rank  8: 2.93
     rank  9: 2.93
     rank 10: 2.91
     rank 11: 3.06
     rank 12: 2.13
     rank 13: 2.20
     rank 14: 2.24
     rank 15: 2.21
     rank 16: 2.58
     rank 17: 2.39
     rank 18: 2.39
     rank 19: 2.34
  optimizer-copy-to-main-grad:
     rank  0: 0.03
     rank  1: 0.04
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.06
     rank  7: 0.06
     rank  8: 0.05
     rank  9: 0.06
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.06
     rank 13: 0.05
     rank 14: 0.10
     rank 15: 0.04
     rank 16: 0.09
     rank 17: 0.06
     rank 18: 0.05
     rank 19: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 30.81
     rank  1: 30.94
     rank  2: 30.87
     rank  3: 30.96
     rank  4: 48.33
     rank  5: 48.31
     rank  6: 48.43
     rank  7: 48.40
     rank  8: 59.02
     rank  9: 59.13
     rank 10: 59.05
     rank 11: 59.14
     rank 12: 42.66
     rank 13: 43.42
     rank 14: 43.23
     rank 15: 42.83
     rank 16: 48.72
     rank 17: 48.72
     rank 18: 48.60
     rank 19: 48.57
  optimizer:
     rank  0: 31.52
     rank  1: 31.65
     rank  2: 31.58
     rank  3: 31.68
     rank  4: 49.03
     rank  5: 49.02
     rank  6: 49.14
     rank  7: 49.11
     rank  8: 59.73
     rank  9: 59.84
     rank 10: 59.76
     rank 11: 59.85
     rank 12: 43.39
     rank 13: 44.13
     rank 14: 43.94
     rank 15: 43.55
     rank 16: 49.41
     rank 17: 49.43
     rank 18: 49.29
     rank 19: 49.29
 [2024-12-12 14:11:26] iteration        5/      10 | consumed samples:           50 | elapsed time per iteration (ms): 4579.5 | learning rate: 3.750000E-06 | global batch size:    10 | lm loss: 1.652002E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4486.97
     rank  1: 4486.92
     rank  2: 4487.02
     rank  3: 4487.02
     rank  4: 4488.44
     rank  5: 4488.38
     rank  6: 4488.49
     rank  7: 4488.41
     rank  8: 4489.52
     rank  9: 4489.46
     rank 10: 4489.57
     rank 11: 4489.53
     rank 12: 4488.20
     rank 13: 4487.91
     rank 14: 4488.03
     rank 15: 4487.97
     rank 16: 4488.46
     rank 17: 4488.39
     rank 18: 4488.56
     rank 19: 4488.39
  forward-compute:
     rank  0: 1201.94
     rank  1: 1201.48
     rank  2: 1201.69
     rank  3: 1204.46
     rank  4: 981.27
     rank  5: 981.04
     rank  6: 981.95
     rank  7: 984.49
     rank  8: 1178.41
     rank  9: 1179.25
     rank 10: 1183.62
     rank 11: 1178.97
     rank 12: 1091.34
     rank 13: 1090.88
     rank 14: 1091.48
     rank 15: 1090.89
     rank 16: 1122.13
     rank 17: 1123.47
     rank 18: 1125.60
     rank 19: 1125.51
  backward-compute:
     rank  0: 642.72
     rank  1: 643.02
     rank  2: 643.95
     rank  3: 641.48
     rank  4: 1163.66
     rank  5: 1163.59
     rank  6: 1163.10
     rank  7: 1164.08
     rank  8: 1396.35
     rank  9: 1396.82
     rank 10: 1399.70
     rank 11: 1398.27
     rank 12: 1291.35
     rank 13: 1292.55
     rank 14: 1293.65
     rank 15: 1293.96
     rank 16: 1346.12
     rank 17: 1345.85
     rank 18: 1343.32
     rank 19: 1344.90
  pure-backward-compute:
     rank  0: 642.46
     rank  1: 642.76
     rank  2: 643.69
     rank  3: 641.21
     rank  4: 1163.37
     rank  5: 1163.27
     rank  6: 1162.74
     rank  7: 1163.80
     rank  8: 1396.08
     rank  9: 1396.55
     rank 10: 1399.47
     rank 11: 1397.79
     rank 12: 1290.81
     rank 13: 1292.18
     rank 14: 1293.14
     rank 15: 1293.61
     rank 16: 1345.07
     rank 17: 1345.05
     rank 18: 1342.11
     rank 19: 1344.28
  batch-generator:
     rank  0: 20.44
     rank  1: 21.74
     rank  2: 22.86
     rank  3: 26.32
     rank  4: 18.54
     rank  5: 19.41
     rank  6: 20.14
     rank  7: 22.09
     rank  8: 19.62
     rank  9: 19.34
     rank 10: 23.80
     rank 11: 19.33
     rank 12: 21.51
     rank 13: 22.01
     rank 14: 25.53
     rank 15: 23.79
     rank 16: 22.85
     rank 17: 24.62
     rank 18: 27.08
     rank 19: 27.15
  forward-recv:
     rank  4: 351.92
     rank  5: 352.31
     rank  6: 357.49
     rank  7: 350.22
     rank  8: 475.50
     rank  9: 475.07
     rank 10: 472.51
     rank 11: 475.19
     rank 12: 748.36
     rank 13: 748.73
     rank 14: 747.66
     rank 15: 748.87
     rank 16: 937.08
     rank 17: 936.77
     rank 18: 936.42
     rank 19: 936.54
  forward-send:
     rank  0: 45.12
     rank  1: 45.28
     rank  2: 45.05
     rank  3: 42.37
     rank  4: 64.56
     rank  5: 64.25
     rank  6: 58.84
     rank  7: 63.40
     rank  8: 36.80
     rank  9: 36.75
     rank 10: 34.75
     rank 11: 36.23
     rank 12: 10.82
     rank 13: 10.61
     rank 14: 10.56
     rank 15: 10.51
  backward-recv:
     rank  0: 1575.52
     rank  1: 1575.46
     rank  2: 1574.91
     rank  3: 1576.67
     rank  4: 814.07
     rank  5: 814.71
     rank  6: 815.00
     rank  7: 813.27
     rank  8: 427.67
     rank  9: 427.58
     rank 10: 426.18
     rank 11: 427.20
     rank 12: 238.96
     rank 13: 239.17
     rank 14: 239.29
     rank 15: 239.02
  backward-send:
     rank  4: 51.50
     rank  5: 50.60
     rank  6: 50.61
     rank  7: 52.05
     rank  8: 31.27
     rank  9: 30.99
     rank 10: 31.16
     rank 11: 31.17
     rank 12: 21.19
     rank 13: 21.09
     rank 14: 20.00
     rank 15: 20.86
     rank 16: 10.69
     rank 17: 10.57
     rank 18: 10.09
     rank 19: 10.34
  forward-send-backward-recv:
     rank  0: 1012.60
     rank  1: 1012.39
     rank  2: 1012.07
     rank  3: 1012.82
     rank  4: 899.46
     rank  5: 899.57
     rank  6: 899.88
     rank  7: 899.43
     rank  8: 535.26
     rank  9: 534.82
     rank 10: 534.34
     rank 11: 534.80
     rank 12: 296.76
     rank 13: 296.52
     rank 14: 295.07
     rank 15: 295.26
  backward-send-forward-recv:
     rank  4: 21.74
     rank  5: 21.67
     rank  6: 21.19
     rank  7: 21.63
     rank  8: 22.50
     rank  9: 22.26
     rank 10: 22.30
     rank 11: 22.43
     rank 12: 114.99
     rank 13: 115.37
     rank 14: 115.24
     rank 15: 115.03
     rank 16: 129.56
     rank 17: 129.13
     rank 18: 128.60
     rank 19: 128.28
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.03
     rank 17: 0.02
     rank 18: 0.03
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.08
     rank  1: 0.07
     rank  2: 0.07
     rank  3: 0.10
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.08
     rank 17: 0.05
     rank 18: 0.08
     rank 19: 0.06
  all-grads-sync:
     rank  0: 1.68
     rank  1: 1.67
     rank  2: 1.65
     rank  3: 1.76
     rank  4: 2.42
     rank  5: 2.42
     rank  6: 2.44
     rank  7: 2.39
     rank  8: 2.91
     rank  9: 2.91
     rank 10: 2.90
     rank 11: 3.05
     rank 12: 2.66
     rank 13: 2.10
     rank 14: 2.11
     rank 15: 2.09
     rank 16: 2.46
     rank 17: 2.33
     rank 18: 2.61
     rank 19: 2.34
  optimizer-copy-to-main-grad:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.04
     rank  4: 0.05
     rank  5: 0.06
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.05
     rank  9: 0.05
     rank 10: 0.05
     rank 11: 0.06
     rank 12: 0.22
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.04
     rank 16: 0.08
     rank 17: 0.05
     rank 18: 0.10
     rank 19: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.06
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 30.78
     rank  1: 30.78
     rank  2: 30.74
     rank  3: 30.99
     rank  4: 48.36
     rank  5: 48.34
     rank  6: 48.49
     rank  7: 48.39
     rank  8: 59.02
     rank  9: 59.00
     rank 10: 59.05
     rank 11: 59.18
     rank 12: 42.88
     rank 13: 43.32
     rank 14: 43.22
     rank 15: 42.70
     rank 16: 48.54
     rank 17: 48.57
     rank 18: 48.64
     rank 19: 48.47
  optimizer:
     rank  0: 31.61
     rank  1: 31.61
     rank  2: 31.56
     rank  3: 31.81
     rank  4: 49.18
     rank  5: 49.17
     rank  6: 49.32
     rank  7: 49.21
     rank  8: 59.84
     rank  9: 59.82
     rank 10: 59.87
     rank 11: 60.02
     rank 12: 43.70
     rank 13: 44.14
     rank 14: 44.04
     rank 15: 43.53
     rank 16: 49.36
     rank 17: 49.39
     rank 18: 49.46
     rank 19: 49.30
 [2024-12-12 14:11:31] iteration        6/      10 | consumed samples:           60 | elapsed time per iteration (ms): 4598.7 | learning rate: 4.500000E-06 | global batch size:    10 | lm loss: 1.985713E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4504.50
     rank  1: 4504.40
     rank  2: 4504.52
     rank  3: 4504.49
     rank  4: 4506.36
     rank  5: 4505.83
     rank  6: 4505.87
     rank  7: 4505.87
     rank  8: 4507.12
     rank  9: 4507.08
     rank 10: 4507.34
     rank 11: 4506.97
     rank 12: 4505.64
     rank 13: 4505.37
     rank 14: 4505.44
     rank 15: 4505.51
     rank 16: 4506.15
     rank 17: 4505.86
     rank 18: 4505.94
     rank 19: 4505.89
  forward-compute:
     rank  0: 1207.63
     rank  1: 1207.61
     rank  2: 1207.52
     rank  3: 1209.75
     rank  4: 978.33
     rank  5: 978.56
     rank  6: 978.59
     rank  7: 980.95
     rank  8: 1173.40
     rank  9: 1173.59
     rank 10: 1177.78
     rank 11: 1174.13
     rank 12: 1096.03
     rank 13: 1095.86
     rank 14: 1097.64
     rank 15: 1096.38
     rank 16: 1121.61
     rank 17: 1123.51
     rank 18: 1125.92
     rank 19: 1125.66
  backward-compute:
     rank  0: 643.08
     rank  1: 643.80
     rank  2: 643.83
     rank  3: 641.18
     rank  4: 1165.58
     rank  5: 1165.11
     rank  6: 1165.59
     rank  7: 1166.38
     rank  8: 1397.43
     rank  9: 1397.80
     rank 10: 1403.30
     rank 11: 1399.59
     rank 12: 1298.34
     rank 13: 1300.21
     rank 14: 1299.80
     rank 15: 1300.57
     rank 16: 1352.78
     rank 17: 1352.90
     rank 18: 1350.22
     rank 19: 1351.94
  pure-backward-compute:
     rank  0: 642.81
     rank  1: 643.54
     rank  2: 643.56
     rank  3: 640.91
     rank  4: 1165.30
     rank  5: 1164.84
     rank  6: 1165.24
     rank  7: 1166.00
     rank  8: 1397.12
     rank  9: 1397.42
     rank 10: 1403.07
     rank 11: 1399.27
     rank 12: 1297.81
     rank 13: 1299.85
     rank 14: 1299.30
     rank 15: 1300.19
     rank 16: 1351.89
     rank 17: 1352.30
     rank 18: 1348.95
     rank 19: 1351.29
  batch-generator:
     rank  0: 19.72
     rank  1: 21.43
     rank  2: 22.82
     rank  3: 25.26
     rank  4: 16.47
     rank  5: 17.87
     rank  6: 17.72
     rank  7: 19.34
     rank  8: 15.35
     rank  9: 17.57
     rank 10: 21.78
     rank 11: 18.29
     rank 12: 24.92
     rank 13: 25.44
     rank 14: 30.14
     rank 15: 27.56
     rank 16: 21.63
     rank 17: 23.95
     rank 18: 26.63
     rank 19: 26.76
  forward-recv:
     rank  4: 369.18
     rank  5: 369.49
     rank  6: 374.08
     rank  7: 368.25
     rank  8: 479.51
     rank  9: 479.41
     rank 10: 476.94
     rank 11: 479.42
     rank 12: 734.78
     rank 13: 736.14
     rank 14: 735.22
     rank 15: 736.19
     rank 16: 938.04
     rank 17: 936.93
     rank 18: 936.83
     rank 19: 937.33
  forward-send:
     rank  0: 43.84
     rank  1: 43.64
     rank  2: 43.47
     rank  3: 41.50
     rank  4: 51.19
     rank  5: 51.02
     rank  6: 46.13
     rank  7: 49.88
     rank  8: 23.07
     rank  9: 22.96
     rank 10: 21.49
     rank 11: 22.54
     rank 12: 11.39
     rank 13: 10.18
     rank 14: 10.02
     rank 15: 10.03
  backward-recv:
     rank  0: 1586.35
     rank  1: 1586.16
     rank  2: 1585.49
     rank  3: 1587.98
     rank  4: 823.18
     rank  5: 823.94
     rank  6: 824.85
     rank  7: 822.57
     rank  8: 438.74
     rank  9: 439.38
     rank 10: 436.68
     rank 11: 438.83
     rank 12: 232.90
     rank 13: 233.35
     rank 14: 233.67
     rank 15: 233.80
  backward-send:
     rank  4: 52.12
     rank  5: 51.27
     rank  6: 50.66
     rank  7: 52.42
     rank  8: 31.34
     rank  9: 31.19
     rank 10: 30.91
     rank 11: 31.06
     rank 12: 31.51
     rank 13: 31.11
     rank 14: 28.53
     rank 15: 30.92
     rank 16: 10.72
     rank 17: 10.67
     rank 18: 10.31
     rank 19: 10.56
  forward-send-backward-recv:
     rank  0: 1014.12
     rank  1: 1013.64
     rank  2: 1014.38
     rank  3: 1014.46
     rank  4: 903.31
     rank  5: 903.59
     rank  6: 903.53
     rank  7: 903.26
     rank  8: 553.78
     rank  9: 553.52
     rank 10: 551.50
     rank 11: 552.66
     rank 12: 305.57
     rank 13: 304.72
     rank 14: 304.70
     rank 15: 303.87
  backward-send-forward-recv:
     rank  4: 21.99
     rank  5: 21.49
     rank  6: 21.95
     rank  7: 21.95
     rank  8: 22.54
     rank  9: 22.61
     rank 10: 22.35
     rank 11: 22.27
     rank 12: 118.76
     rank 13: 119.02
     rank 14: 117.71
     rank 15: 118.42
     rank 16: 129.36
     rank 17: 129.31
     rank 18: 127.96
     rank 19: 127.37
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.04
     rank 15: 0.02
     rank 16: 0.06
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.07
     rank  2: 0.08
     rank  3: 0.08
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
     rank 16: 0.13
     rank 17: 0.05
     rank 18: 0.07
     rank 19: 0.06
  all-grads-sync:
     rank  0: 1.62
     rank  1: 1.66
     rank  2: 1.72
     rank  3: 1.73
     rank  4: 2.45
     rank  5: 2.40
     rank  6: 2.43
     rank  7: 2.44
     rank  8: 2.98
     rank  9: 2.94
     rank 10: 3.07
     rank 11: 2.98
     rank 12: 2.19
     rank 13: 2.09
     rank 14: 2.37
     rank 15: 2.22
     rank 16: 2.92
     rank 17: 2.37
     rank 18: 2.49
     rank 19: 2.40
  optimizer-copy-to-main-grad:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.04
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.06
     rank  7: 0.06
     rank  8: 0.11
     rank  9: 0.09
     rank 10: 0.11
     rank 11: 0.05
     rank 12: 0.06
     rank 13: 0.04
     rank 14: 0.05
     rank 15: 0.05
     rank 16: 0.16
     rank 17: 0.05
     rank 18: 0.06
     rank 19: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.04
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.02
     rank 19: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.03
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 30.77
     rank  1: 30.78
     rank  2: 30.79
     rank  3: 30.87
     rank  4: 48.36
     rank  5: 48.29
     rank  6: 48.39
     rank  7: 48.41
     rank  8: 59.07
     rank  9: 59.07
     rank 10: 59.51
     rank 11: 58.98
     rank 12: 42.85
     rank 13: 43.37
     rank 14: 43.49
     rank 15: 42.87
     rank 16: 48.81
     rank 17: 48.59
     rank 18: 48.61
     rank 19: 48.69
  optimizer:
     rank  0: 32.01
     rank  1: 32.02
     rank  2: 32.03
     rank  3: 32.11
     rank  4: 49.60
     rank  5: 49.53
     rank  6: 49.63
     rank  7: 49.65
     rank  8: 60.31
     rank  9: 60.31
     rank 10: 60.73
     rank 11: 60.22
     rank 12: 44.09
     rank 13: 44.60
     rank 14: 44.73
     rank 15: 44.10
     rank 16: 50.05
     rank 17: 49.82
     rank 18: 49.84
     rank 19: 49.93
 [2024-12-12 14:11:36] iteration        7/      10 | consumed samples:           70 | elapsed time per iteration (ms): 4593.3 | learning rate: 5.250000E-06 | global batch size:    10 | lm loss: 1.676361E-01 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4499.05
     rank  1: 4499.08
     rank  2: 4499.06
     rank  3: 4499.07
     rank  4: 4500.51
     rank  5: 4500.54
     rank  6: 4500.49
     rank  7: 4500.48
     rank  8: 4501.60
     rank  9: 4501.62
     rank 10: 4501.59
     rank 11: 4501.62
     rank 12: 4500.07
     rank 13: 4500.07
     rank 14: 4500.09
     rank 15: 4500.07
     rank 16: 4500.64
     rank 17: 4500.50
     rank 18: 4500.53
     rank 19: 4500.48
  forward-compute:
     rank  0: 1206.61
     rank  1: 1205.92
     rank  2: 1206.34
     rank  3: 1209.34
     rank  4: 977.52
     rank  5: 977.57
     rank  6: 977.87
     rank  7: 981.16
     rank  8: 1177.15
     rank  9: 1177.11
     rank 10: 1182.69
     rank 11: 1177.17
     rank 12: 1090.86
     rank 13: 1090.21
     rank 14: 1091.78
     rank 15: 1089.86
     rank 16: 1129.49
     rank 17: 1130.84
     rank 18: 1133.46
     rank 19: 1133.77
  backward-compute:
     rank  0: 643.82
     rank  1: 644.85
     rank  2: 644.16
     rank  3: 642.44
     rank  4: 1163.01
     rank  5: 1163.07
     rank  6: 1163.00
     rank  7: 1164.05
     rank  8: 1399.21
     rank  9: 1398.98
     rank 10: 1402.50
     rank 11: 1400.74
     rank 12: 1294.76
     rank 13: 1296.59
     rank 14: 1296.32
     rank 15: 1297.94
     rank 16: 1347.89
     rank 17: 1347.72
     rank 18: 1344.96
     rank 19: 1346.83
  pure-backward-compute:
     rank  0: 643.54
     rank  1: 644.55
     rank  2: 643.89
     rank  3: 642.16
     rank  4: 1162.73
     rank  5: 1162.81
     rank  6: 1162.67
     rank  7: 1163.65
     rank  8: 1398.90
     rank  9: 1398.73
     rank 10: 1402.26
     rank 11: 1400.44
     rank 12: 1294.22
     rank 13: 1296.23
     rank 14: 1295.70
     rank 15: 1297.50
     rank 16: 1347.02
     rank 17: 1347.08
     rank 18: 1344.01
     rank 19: 1346.20
  batch-generator:
     rank  0: 19.36
     rank  1: 20.49
     rank  2: 21.78
     rank  3: 25.53
     rank  4: 17.19
     rank  5: 18.20
     rank  6: 18.34
     rank  7: 21.04
     rank  8: 16.30
     rank  9: 17.29
     rank 10: 22.72
     rank 11: 16.91
     rank 12: 21.61
     rank 13: 21.95
     rank 14: 26.58
     rank 15: 23.40
     rank 16: 23.34
     rank 17: 24.95
     rank 18: 28.20
     rank 19: 28.46
  forward-recv:
     rank  4: 380.58
     rank  5: 380.68
     rank  6: 387.02
     rank  7: 377.65
     rank  8: 473.47
     rank  9: 473.58
     rank 10: 469.61
     rank 11: 473.61
     rank 12: 729.62
     rank 13: 729.94
     rank 14: 729.02
     rank 15: 730.40
     rank 16: 931.54
     rank 17: 931.55
     rank 18: 930.63
     rank 19: 930.90
  forward-send:
     rank  0: 44.05
     rank  1: 44.15
     rank  2: 44.09
     rank  3: 41.12
     rank  4: 41.40
     rank  5: 41.43
     rank  6: 34.88
     rank  7: 41.05
     rank  8: 21.38
     rank  9: 21.49
     rank 10: 19.71
     rank 11: 21.20
     rank 12: 10.82
     rank 13: 10.62
     rank 14: 10.35
     rank 15: 10.47
  backward-recv:
     rank  0: 1579.17
     rank  1: 1578.59
     rank  2: 1579.05
     rank  3: 1580.57
     rank  4: 818.47
     rank  5: 819.32
     rank  6: 818.14
     rank  7: 816.61
     rank  8: 430.03
     rank  9: 430.03
     rank 10: 429.26
     rank 11: 429.87
     rank 12: 236.23
     rank 13: 236.54
     rank 14: 236.70
     rank 15: 236.39
  backward-send:
     rank  4: 51.44
     rank  5: 50.10
     rank  6: 51.37
     rank  7: 52.45
     rank  8: 31.39
     rank  9: 30.87
     rank 10: 31.07
     rank 11: 30.94
     rank 12: 21.40
     rank 13: 21.17
     rank 14: 20.66
     rank 15: 20.88
     rank 16: 10.74
     rank 17: 10.65
     rank 18: 10.11
     rank 19: 10.45
  forward-send-backward-recv:
     rank  0: 1016.17
     rank  1: 1015.96
     rank  2: 1016.20
     rank  3: 1016.46
     rank  4: 906.55
     rank  5: 906.64
     rank  6: 906.86
     rank  7: 906.57
     rank  8: 561.02
     rank  9: 560.86
     rank 10: 559.27
     rank 11: 560.43
     rank 12: 306.72
     rank 13: 305.63
     rank 14: 306.11
     rank 15: 304.93
  backward-send-forward-recv:
     rank  4: 21.63
     rank  5: 21.31
     rank  6: 21.42
     rank  7: 21.50
     rank  8: 22.38
     rank  9: 22.26
     rank 10: 22.39
     rank 11: 22.35
     rank 12: 134.80
     rank 13: 135.39
     rank 14: 134.29
     rank 15: 134.98
     rank 16: 135.63
     rank 17: 135.04
     rank 18: 134.79
     rank 19: 133.51
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
     rank 16: 0.03
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.07
     rank  1: 0.08
     rank  2: 0.09
     rank  3: 0.09
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
     rank 16: 0.07
     rank 17: 0.05
     rank 18: 0.06
     rank 19: 0.06
  all-grads-sync:
     rank  0: 1.70
     rank  1: 1.70
     rank  2: 1.72
     rank  3: 1.70
     rank  4: 2.41
     rank  5: 2.38
     rank  6: 2.40
     rank  7: 2.40
     rank  8: 2.95
     rank  9: 2.95
     rank 10: 2.93
     rank 11: 2.95
     rank 12: 2.12
     rank 13: 2.13
     rank 14: 2.19
     rank 15: 2.11
     rank 16: 2.59
     rank 17: 2.39
     rank 18: 2.40
     rank 19: 2.37
  optimizer-copy-to-main-grad:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.06
     rank  9: 0.06
     rank 10: 0.06
     rank 11: 0.05
     rank 12: 0.06
     rank 13: 0.04
     rank 14: 0.09
     rank 15: 0.04
     rank 16: 0.09
     rank 17: 0.04
     rank 18: 0.05
     rank 19: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.02
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.02
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 30.90
     rank  1: 30.79
     rank  2: 30.75
     rank  3: 30.87
     rank  4: 48.34
     rank  5: 48.32
     rank  6: 48.39
     rank  7: 48.41
     rank  8: 59.09
     rank  9: 59.11
     rank 10: 59.11
     rank 11: 59.12
     rank 12: 42.82
     rank 13: 43.30
     rank 14: 43.41
     rank 15: 42.75
     rank 16: 48.57
     rank 17: 48.63
     rank 18: 48.55
     rank 19: 48.50
  optimizer:
     rank  0: 31.59
     rank  1: 31.47
     rank  2: 31.43
     rank  3: 31.56
     rank  4: 49.01
     rank  5: 48.99
     rank  6: 49.07
     rank  7: 49.08
     rank  8: 59.77
     rank  9: 59.79
     rank 10: 59.81
     rank 11: 59.79
     rank 12: 43.51
     rank 13: 43.98
     rank 14: 44.10
     rank 15: 43.43
     rank 16: 49.25
     rank 17: 49.32
     rank 18: 49.23
     rank 19: 49.18
 [2024-12-12 14:11:40] iteration        8/      10 | consumed samples:           80 | elapsed time per iteration (ms): 4603.8 | learning rate: 6.000000E-06 | global batch size:    10 | lm loss: 1.623102E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4508.76
     rank  1: 4508.75
     rank  2: 4508.76
     rank  3: 4508.71
     rank  4: 4510.24
     rank  5: 4510.15
     rank  6: 4510.19
     rank  7: 4510.22
     rank  8: 4511.30
     rank  9: 4511.28
     rank 10: 4511.29
     rank 11: 4511.24
     rank 12: 4509.89
     rank 13: 4509.82
     rank 14: 4509.74
     rank 15: 4509.72
     rank 16: 4510.24
     rank 17: 4510.19
     rank 18: 4510.23
     rank 19: 4510.18
  forward-compute:
     rank  0: 1209.09
     rank  1: 1208.87
     rank  2: 1209.01
     rank  3: 1211.56
     rank  4: 980.81
     rank  5: 981.06
     rank  6: 980.85
     rank  7: 983.89
     rank  8: 1169.73
     rank  9: 1169.93
     rank 10: 1171.71
     rank 11: 1171.29
     rank 12: 1094.05
     rank 13: 1092.46
     rank 14: 1093.56
     rank 15: 1094.02
     rank 16: 1129.82
     rank 17: 1131.62
     rank 18: 1133.40
     rank 19: 1133.47
  backward-compute:
     rank  0: 643.02
     rank  1: 643.93
     rank  2: 643.20
     rank  3: 641.51
     rank  4: 1155.07
     rank  5: 1155.27
     rank  6: 1155.00
     rank  7: 1156.40
     rank  8: 1400.96
     rank  9: 1400.45
     rank 10: 1404.84
     rank 11: 1402.12
     rank 12: 1297.79
     rank 13: 1298.88
     rank 14: 1299.24
     rank 15: 1299.83
     rank 16: 1353.02
     rank 17: 1353.12
     rank 18: 1350.30
     rank 19: 1352.21
  pure-backward-compute:
     rank  0: 642.75
     rank  1: 643.67
     rank  2: 642.95
     rank  3: 641.25
     rank  4: 1154.82
     rank  5: 1155.03
     rank  6: 1154.67
     rank  7: 1156.08
     rank  8: 1400.69
     rank  9: 1400.20
     rank 10: 1404.30
     rank 11: 1401.88
     rank 12: 1297.28
     rank 13: 1298.50
     rank 14: 1298.74
     rank 15: 1299.41
     rank 16: 1352.11
     rank 17: 1352.49
     rank 18: 1349.40
     rank 19: 1351.56
  batch-generator:
     rank  0: 19.79
     rank  1: 21.29
     rank  2: 22.33
     rank  3: 25.63
     rank  4: 16.55
     rank  5: 17.70
     rank  6: 17.45
     rank  7: 19.87
     rank  8: 15.24
     rank  9: 16.15
     rank 10: 18.07
     rank 11: 17.88
     rank 12: 21.61
     rank 13: 21.46
     rank 14: 25.15
     rank 15: 24.20
     rank 16: 23.84
     rank 17: 25.97
     rank 18: 28.23
     rank 19: 28.58
  forward-recv:
     rank  4: 363.14
     rank  5: 363.28
     rank  6: 366.11
     rank  7: 362.43
     rank  8: 480.21
     rank  9: 480.26
     rank 10: 479.52
     rank 11: 480.24
     rank 12: 741.91
     rank 13: 742.55
     rank 14: 742.12
     rank 15: 742.16
     rank 16: 939.02
     rank 17: 938.72
     rank 18: 938.26
     rank 19: 938.41
  forward-send:
     rank  0: 43.07
     rank  1: 43.03
     rank  2: 42.98
     rank  3: 40.39
     rank  4: 56.99
     rank  5: 56.90
     rank  6: 54.02
     rank  7: 54.81
     rank  8: 32.44
     rank  9: 32.23
     rank 10: 30.98
     rank 11: 31.24
     rank 12: 10.85
     rank 13: 10.66
     rank 14: 10.47
     rank 15: 10.47
  backward-recv:
     rank  0: 1585.79
     rank  1: 1585.27
     rank  2: 1585.55
     rank  3: 1586.70
     rank  4: 834.29
     rank  5: 835.15
     rank  6: 835.13
     rank  7: 833.39
     rank  8: 440.72
     rank  9: 440.88
     rank 10: 438.56
     rank 11: 441.07
     rank 12: 235.00
     rank 13: 235.27
     rank 14: 235.42
     rank 15: 235.18
  backward-send:
     rank  4: 49.88
     rank  5: 48.41
     rank  6: 49.27
     rank  7: 50.12
     rank  8: 31.11
     rank  9: 30.78
     rank 10: 31.49
     rank 11: 30.66
     rank 12: 31.67
     rank 13: 31.62
     rank 14: 29.88
     rank 15: 31.49
     rank 16: 10.72
     rank 17: 10.58
     rank 18: 10.02
     rank 19: 10.47
  forward-send-backward-recv:
     rank  0: 1018.59
     rank  1: 1018.22
     rank  2: 1018.68
     rank  3: 1019.26
     rank  4: 907.70
     rank  5: 907.67
     rank  6: 907.66
     rank  7: 907.13
     rank  8: 550.11
     rank  9: 550.67
     rank 10: 549.19
     rank 11: 549.79
     rank 12: 304.55
     rank 13: 304.55
     rank 14: 304.07
     rank 15: 303.83
  backward-send-forward-recv:
     rank  4: 21.84
     rank  5: 21.44
     rank  6: 21.93
     rank  7: 21.89
     rank  8: 22.55
     rank  9: 22.45
     rank 10: 22.50
     rank 11: 22.05
     rank 12: 118.43
     rank 13: 119.59
     rank 14: 118.55
     rank 15: 118.40
     rank 16: 121.67
     rank 17: 120.98
     rank 18: 121.10
     rank 19: 120.13
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.03
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.08
     rank  1: 0.07
     rank  2: 0.07
     rank  3: 0.08
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.07
     rank 17: 0.05
     rank 18: 0.06
     rank 19: 0.06
  all-grads-sync:
     rank  0: 1.68
     rank  1: 1.66
     rank  2: 1.66
     rank  3: 1.71
     rank  4: 2.44
     rank  5: 2.40
     rank  6: 2.44
     rank  7: 2.46
     rank  8: 2.90
     rank  9: 2.89
     rank 10: 3.10
     rank 11: 2.89
     rank 12: 2.38
     rank 13: 2.21
     rank 14: 2.12
     rank 15: 2.16
     rank 16: 2.44
     rank 17: 2.34
     rank 18: 2.40
     rank 19: 2.34
  optimizer-copy-to-main-grad:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.04
     rank  5: 0.04
     rank  6: 0.06
     rank  7: 0.06
     rank  8: 0.05
     rank  9: 0.05
     rank 10: 0.11
     rank 11: 0.05
     rank 12: 0.10
     rank 13: 0.04
     rank 14: 0.05
     rank 15: 0.04
     rank 16: 0.06
     rank 17: 0.04
     rank 18: 0.05
     rank 19: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 30.78
     rank  1: 30.83
     rank  2: 30.74
     rank  3: 30.88
     rank  4: 48.43
     rank  5: 48.33
     rank  6: 48.39
     rank  7: 48.38
     rank  8: 59.00
     rank  9: 58.99
     rank 10: 59.25
     rank 11: 59.03
     rank 12: 42.74
     rank 13: 43.51
     rank 14: 43.20
     rank 15: 42.79
     rank 16: 48.66
     rank 17: 48.48
     rank 18: 48.49
     rank 19: 48.45
  optimizer:
     rank  0: 31.47
     rank  1: 31.52
     rank  2: 31.43
     rank  3: 31.57
     rank  4: 49.12
     rank  5: 49.02
     rank  6: 49.17
     rank  7: 49.07
     rank  8: 59.69
     rank  9: 59.68
     rank 10: 59.95
     rank 11: 59.72
     rank 12: 43.42
     rank 13: 44.20
     rank 14: 43.89
     rank 15: 43.48
     rank 16: 49.34
     rank 17: 49.17
     rank 18: 49.17
     rank 19: 49.15
 [2024-12-12 14:11:45] iteration        9/      10 | consumed samples:           90 | elapsed time per iteration (ms): 4586.0 | learning rate: 6.750000E-06 | global batch size:    10 | lm loss: 1.636919E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4492.46
     rank  1: 4492.58
     rank  2: 4492.56
     rank  3: 4492.49
     rank  4: 4493.87
     rank  5: 4494.06
     rank  6: 4493.94
     rank  7: 4493.93
     rank  8: 4495.00
     rank  9: 4495.14
     rank 10: 4495.08
     rank 11: 4495.10
     rank 12: 4493.60
     rank 13: 4493.60
     rank 14: 4493.48
     rank 15: 4493.52
     rank 16: 4493.93
     rank 17: 4494.08
     rank 18: 4494.13
     rank 19: 4493.95
  forward-compute:
     rank  0: 1205.24
     rank  1: 1204.63
     rank  2: 1204.81
     rank  3: 1208.04
     rank  4: 971.10
     rank  5: 970.85
     rank  6: 971.70
     rank  7: 974.68
     rank  8: 1173.38
     rank  9: 1173.69
     rank 10: 1174.42
     rank 11: 1176.38
     rank 12: 1098.20
     rank 13: 1097.37
     rank 14: 1096.85
     rank 15: 1099.59
     rank 16: 1128.17
     rank 17: 1129.66
     rank 18: 1132.34
     rank 19: 1131.89
  backward-compute:
     rank  0: 643.57
     rank  1: 643.43
     rank  2: 643.12
     rank  3: 642.42
     rank  4: 1152.82
     rank  5: 1153.79
     rank  6: 1152.82
     rank  7: 1153.06
     rank  8: 1399.67
     rank  9: 1399.72
     rank 10: 1402.23
     rank 11: 1401.67
     rank 12: 1292.93
     rank 13: 1294.23
     rank 14: 1295.35
     rank 15: 1295.21
     rank 16: 1355.91
     rank 17: 1355.71
     rank 18: 1353.00
     rank 19: 1354.84
  pure-backward-compute:
     rank  0: 643.31
     rank  1: 643.15
     rank  2: 642.82
     rank  3: 642.15
     rank  4: 1152.59
     rank  5: 1153.46
     rank  6: 1152.50
     rank  7: 1152.76
     rank  8: 1399.41
     rank  9: 1399.45
     rank 10: 1401.84
     rank 11: 1401.25
     rank 12: 1292.42
     rank 13: 1293.89
     rank 14: 1294.84
     rank 15: 1294.85
     rank 16: 1355.05
     rank 17: 1355.12
     rank 18: 1352.07
     rank 19: 1354.21
  batch-generator:
     rank  0: 19.65
     rank  1: 20.80
     rank  2: 21.61
     rank  3: 25.78
     rank  4: 16.72
     rank  5: 17.14
     rank  6: 17.94
     rank  7: 20.56
     rank  8: 15.82
     rank  9: 16.03
     rank 10: 16.74
     rank 11: 18.59
     rank 12: 23.58
     rank 13: 23.64
     rank 14: 26.00
     rank 15: 27.57
     rank 16: 21.40
     rank 17: 23.47
     rank 18: 26.38
     rank 19: 26.41
  forward-recv:
     rank  4: 377.37
     rank  5: 377.40
     rank  6: 379.03
     rank  7: 377.87
     rank  8: 473.33
     rank  9: 473.14
     rank 10: 472.78
     rank 11: 471.79
     rank 12: 730.80
     rank 13: 731.52
     rank 14: 731.24
     rank 15: 730.47
     rank 16: 934.61
     rank 17: 934.77
     rank 18: 934.13
     rank 19: 934.27
  forward-send:
     rank  0: 43.87
     rank  1: 44.09
     rank  2: 44.03
     rank  3: 40.89
     rank  4: 48.08
     rank  5: 48.08
     rank  6: 46.39
     rank  7: 44.16
     rank  8: 27.93
     rank  9: 28.02
     rank 10: 27.32
     rank 11: 26.69
     rank 12: 10.81
     rank 13: 10.67
     rank 14: 10.31
     rank 15: 10.42
  backward-recv:
     rank  0: 1582.05
     rank  1: 1581.99
     rank  2: 1582.47
     rank  3: 1582.91
     rank  4: 827.58
     rank  5: 827.76
     rank  6: 826.95
     rank  7: 826.53
     rank  8: 433.82
     rank  9: 434.65
     rank 10: 432.08
     rank 11: 432.95
     rank 12: 240.91
     rank 13: 241.23
     rank 14: 241.39
     rank 15: 241.10
  backward-send:
     rank  4: 50.34
     rank  5: 49.50
     rank  6: 50.65
     rank  7: 50.78
     rank  8: 31.16
     rank  9: 30.07
     rank 10: 31.14
     rank 11: 31.28
     rank 12: 21.16
     rank 13: 21.08
     rank 14: 19.87
     rank 15: 20.90
     rank 16: 10.73
     rank 17: 10.68
     rank 18: 10.14
     rank 19: 10.46
  forward-send-backward-recv:
     rank  0: 1008.57
     rank  1: 1008.80
     rank  2: 1008.66
     rank  3: 1008.93
     rank  4: 904.91
     rank  5: 904.67
     rank  6: 905.09
     rank  7: 904.67
     rank  8: 549.16
     rank  9: 549.20
     rank 10: 548.02
     rank 11: 548.15
     rank 12: 312.39
     rank 13: 312.51
     rank 14: 311.19
     rank 15: 311.71
  backward-send-forward-recv:
     rank  4: 21.03
     rank  5: 21.17
     rank  6: 20.66
     rank  7: 21.17
     rank  8: 22.59
     rank  9: 22.23
     rank 10: 22.45
     rank 11: 22.45
     rank 12: 110.71
     rank 13: 110.95
     rank 14: 111.44
     rank 15: 109.81
     rank 16: 121.17
     rank 17: 120.27
     rank 18: 119.62
     rank 19: 119.23
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.04
     rank  2: 0.03
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.05
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.08
     rank 18: 0.03
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.07
     rank  1: 0.09
     rank  2: 0.09
     rank  3: 0.09
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.06
     rank 17: 0.11
     rank 18: 0.09
     rank 19: 0.06
  all-grads-sync:
     rank  0: 1.67
     rank  1: 1.72
     rank  2: 1.78
     rank  3: 1.70
     rank  4: 2.41
     rank  5: 2.42
     rank  6: 2.39
     rank  7: 2.41
     rank  8: 2.91
     rank  9: 2.89
     rank 10: 2.97
     rank 11: 3.06
     rank 12: 2.53
     rank 13: 2.15
     rank 14: 2.13
     rank 15: 2.10
     rank 16: 2.35
     rank 17: 2.71
     rank 18: 2.65
     rank 19: 2.38
  optimizer-copy-to-main-grad:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.04
     rank  5: 0.05
     rank  6: 0.04
     rank  7: 0.04
     rank  8: 0.05
     rank  9: 0.05
     rank 10: 0.11
     rank 11: 0.10
     rank 12: 0.07
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.04
     rank 16: 0.05
     rank 17: 0.06
     rank 18: 0.10
     rank 19: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 30.77
     rank  1: 30.87
     rank  2: 30.88
     rank  3: 30.86
     rank  4: 48.32
     rank  5: 48.41
     rank  6: 48.35
     rank  7: 48.38
     rank  8: 59.02
     rank  9: 59.00
     rank 10: 59.11
     rank 11: 59.15
     rank 12: 43.03
     rank 13: 43.38
     rank 14: 43.18
     rank 15: 42.73
     rank 16: 48.43
     rank 17: 48.69
     rank 18: 48.71
     rank 19: 48.53
  optimizer:
     rank  0: 31.46
     rank  1: 31.56
     rank  2: 31.58
     rank  3: 31.56
     rank  4: 49.01
     rank  5: 49.10
     rank  6: 49.04
     rank  7: 49.07
     rank  8: 59.71
     rank  9: 59.69
     rank 10: 59.72
     rank 11: 59.85
     rank 12: 43.72
     rank 13: 44.07
     rank 14: 43.88
     rank 15: 43.42
     rank 16: 49.12
     rank 17: 49.38
     rank 18: 49.41
     rank 19: 49.22
 [2024-12-12 14:11:49] iteration       10/      10 | consumed samples:          100 | elapsed time per iteration (ms): 4605.0 | learning rate: 7.500000E-06 | global batch size:    10 | lm loss: 9.962368E-01 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4510.65
     rank  1: 4510.71
     rank  2: 4510.66
     rank  3: 4510.72
     rank  4: 4512.12
     rank  5: 4512.13
     rank  6: 4512.13
     rank  7: 4512.12
     rank  8: 4513.19
     rank  9: 4513.19
     rank 10: 4513.28
     rank 11: 4513.21
     rank 12: 4511.68
     rank 13: 4511.68
     rank 14: 4511.69
     rank 15: 4511.67
     rank 16: 4512.13
     rank 17: 4512.11
     rank 18: 4512.16
     rank 19: 4512.16
  forward-compute:
     rank  0: 1212.29
     rank  1: 1212.58
     rank  2: 1212.54
     rank  3: 1213.65
     rank  4: 974.88
     rank  5: 975.32
     rank  6: 975.20
     rank  7: 976.58
     rank  8: 1175.18
     rank  9: 1175.42
     rank 10: 1176.93
     rank 11: 1177.85
     rank 12: 1101.29
     rank 13: 1102.85
     rank 14: 1103.78
     rank 15: 1103.87
     rank 16: 1133.22
     rank 17: 1135.43
     rank 18: 1136.15
     rank 19: 1137.76
  backward-compute:
     rank  0: 646.19
     rank  1: 645.91
     rank  2: 644.37
     rank  3: 644.34
     rank  4: 1147.06
     rank  5: 1147.25
     rank  6: 1147.15
     rank  7: 1147.35
     rank  8: 1403.24
     rank  9: 1402.39
     rank 10: 1406.06
     rank 11: 1405.38
     rank 12: 1292.72
     rank 13: 1294.18
     rank 14: 1293.88
     rank 15: 1295.98
     rank 16: 1360.83
     rank 17: 1360.64
     rank 18: 1357.94
     rank 19: 1359.73
  pure-backward-compute:
     rank  0: 645.93
     rank  1: 645.65
     rank  2: 644.11
     rank  3: 644.08
     rank  4: 1146.83
     rank  5: 1147.00
     rank  6: 1146.84
     rank  7: 1146.93
     rank  8: 1402.93
     rank  9: 1402.14
     rank 10: 1405.62
     rank 11: 1405.03
     rank 12: 1292.18
     rank 13: 1293.78
     rank 14: 1293.37
     rank 15: 1295.58
     rank 16: 1359.98
     rank 17: 1360.03
     rank 18: 1357.00
     rank 19: 1359.10
  batch-generator:
     rank  0: 20.00
     rank  1: 22.17
     rank  2: 26.25
     rank  3: 26.05
     rank  4: 16.73
     rank  5: 17.64
     rank  6: 17.32
     rank  7: 18.49
     rank  8: 14.81
     rank  9: 15.80
     rank 10: 17.68
     rank 11: 18.39
     rank 12: 22.99
     rank 13: 25.74
     rank 14: 29.21
     rank 15: 28.37
     rank 16: 22.20
     rank 17: 24.75
     rank 18: 26.22
     rank 19: 27.75
  forward-recv:
     rank  4: 384.38
     rank  5: 383.94
     rank  6: 386.39
     rank  7: 385.70
     rank  8: 477.73
     rank  9: 477.78
     rank 10: 476.71
     rank 11: 476.25
     rank 12: 730.88
     rank 13: 729.16
     rank 14: 728.98
     rank 15: 728.41
     rank 16: 939.71
     rank 17: 939.44
     rank 18: 939.40
     rank 19: 939.20
  forward-send:
     rank  0: 44.44
     rank  1: 43.85
     rank  2: 43.83
     rank  3: 42.61
     rank  4: 45.79
     rank  5: 45.62
     rank  6: 43.18
     rank  7: 42.61
     rank  8: 21.61
     rank  9: 21.42
     rank 10: 20.70
     rank 11: 20.65
     rank 12: 10.89
     rank 13: 10.64
     rank 14: 10.38
     rank 15: 10.48
  backward-recv:
     rank  0: 1582.05
     rank  1: 1582.04
     rank  2: 1583.54
     rank  3: 1583.33
     rank  4: 839.35
     rank  5: 840.06
     rank  6: 838.69
     rank  7: 839.32
     rank  8: 436.01
     rank  9: 436.04
     rank 10: 434.34
     rank 11: 435.93
     rank 12: 241.60
     rank 13: 241.89
     rank 14: 241.96
     rank 15: 241.73
  backward-send:
     rank  4: 47.92
     rank  5: 46.94
     rank  6: 48.52
     rank  7: 47.67
     rank  8: 31.30
     rank  9: 30.87
     rank 10: 31.30
     rank 11: 30.86
     rank 12: 21.25
     rank 13: 21.08
     rank 14: 20.02
     rank 15: 20.99
     rank 16: 10.70
     rank 17: 10.64
     rank 18: 10.11
     rank 19: 10.48
  forward-send-backward-recv:
     rank  0: 1016.73
     rank  1: 1017.02
     rank  2: 1017.16
     rank  3: 1017.39
     rank  4: 911.41
     rank  5: 911.41
     rank  6: 911.34
     rank  7: 911.22
     rank  8: 564.13
     rank  9: 564.89
     rank 10: 563.40
     rank 11: 562.90
     rank 12: 311.85
     rank 13: 312.01
     rank 14: 312.08
     rank 15: 310.36
  backward-send-forward-recv:
     rank  4: 21.32
     rank  5: 21.43
     rank  6: 21.90
     rank  7: 21.88
     rank  8: 22.51
     rank  9: 22.42
     rank 10: 22.41
     rank 11: 22.33
     rank 12: 128.75
     rank 13: 129.39
     rank 14: 128.32
     rank 15: 129.14
     rank 16: 124.94
     rank 17: 123.77
     rank 18: 124.30
     rank 19: 122.39
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.07
     rank  1: 0.08
     rank  2: 0.07
     rank  3: 0.08
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.06
     rank 17: 0.06
     rank 18: 0.06
     rank 19: 0.06
  all-grads-sync:
     rank  0: 1.67
     rank  1: 1.73
     rank  2: 1.65
     rank  3: 1.71
     rank  4: 2.48
     rank  5: 2.47
     rank  6: 2.45
     rank  7: 2.45
     rank  8: 2.91
     rank  9: 2.92
     rank 10: 3.02
     rank 11: 2.94
     rank 12: 2.16
     rank 13: 2.20
     rank 14: 2.15
     rank 15: 2.15
     rank 16: 2.37
     rank 17: 2.33
     rank 18: 2.46
     rank 19: 2.38
  optimizer-copy-to-main-grad:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.06
     rank  5: 0.06
     rank  6: 0.05
     rank  7: 0.06
     rank  8: 0.05
     rank  9: 0.10
     rank 10: 0.05
     rank 11: 0.10
     rank 12: 0.06
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.04
     rank 16: 0.05
     rank 17: 0.04
     rank 18: 0.06
     rank 19: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 30.75
     rank  1: 30.84
     rank  2: 30.74
     rank  3: 30.89
     rank  4: 48.37
     rank  5: 48.37
     rank  6: 48.42
     rank  7: 48.52
     rank  8: 58.99
     rank  9: 59.01
     rank 10: 59.12
     rank 11: 59.02
     rank 12: 42.78
     rank 13: 43.47
     rank 14: 43.35
     rank 15: 42.72
     rank 16: 48.44
     rank 17: 48.49
     rank 18: 48.59
     rank 19: 48.57
  optimizer:
     rank  0: 31.39
     rank  1: 31.48
     rank  2: 31.38
     rank  3: 31.53
     rank  4: 49.00
     rank  5: 49.00
     rank  6: 49.06
     rank  7: 49.16
     rank  8: 59.63
     rank  9: 59.65
     rank 10: 59.76
     rank 11: 59.66
     rank 12: 43.42
     rank 13: 44.10
     rank 14: 43.99
     rank 15: 43.45
     rank 16: 49.08
     rank 17: 49.13
     rank 18: 49.23
     rank 19: 49.21
