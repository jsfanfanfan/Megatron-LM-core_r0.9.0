examples/multimodal/pretrain-freeze-llm-hete-2080tifirst.sh: line 4: activate: No such file or directory
3
[2024-12-24 22:25:57,878] torch.distributed.run: [WARNING] 
[2024-12-24 22:25:57,878] torch.distributed.run: [WARNING] *****************************************
[2024-12-24 22:25:57,878] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-12-24 22:25:57,878] torch.distributed.run: [WARNING] *****************************************
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:8------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:8------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:8------
------num_pipeline_model_parallel_groups:4------
> setting tensorboard ...
WARNING: one_logger package is required to enable e2e metrics tracking. please go to https://confluence.nvidia.com/display/MLWFO/Package+Repositories for details to install it
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:8------
------num_pipeline_model_parallel_groups:4------
---Rank 15---Tensor Parallel Group GPUs: [1, 1]
---Rank 14---Tensor Parallel Group GPUs: [0, 0]---Rank 12---Tensor Parallel Group GPUs: [0, 0]---Rank 13---Tensor Parallel Group GPUs: [1, 1]---Rank 15---Pipeline Parallel Group GPUs: [3, 3, 3, 3]



---Rank 14---Pipeline Parallel Group GPUs: [3, 3, 3, 3]---Rank 12---Pipeline Parallel Group GPUs: [3, 3, 3, 3]

---Rank 13---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
[rank15]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank13]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank12]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank14]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
 > number of parameters on (tensor, pipeline) model parallel rank (0, 3): 285233152
 > number of parameters on (tensor, pipeline) model parallel rank (1, 3): 285233152
INFO:megatron.core.distributed.param_and_grad_buffer:Number of buckets for gradient all-reduce / reduce-scatter: 1
Params for bucket 1 (285233152 elements):
	language_model.output_layer.weight
	language_model.decoder.layers.1.mlp.linear_fc2.weight
	language_model.decoder.layers.1.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.0.mlp.linear_fc1.weight
	language_model.decoder.layers.0.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.0.self_attention.linear_qkv.weight
	language_model.decoder.layers.0.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.final_layernorm.weight
	language_model.decoder.layers.1.mlp.linear_fc1.weight
	language_model.decoder.layers.1.self_attention.linear_qkv.weight
	language_model.decoder.layers.1.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.1.self_attention.linear_proj.weight
	language_model.decoder.layers.0.mlp.linear_fc2.weight
	language_model.decoder.layers.0.self_attention.linear_proj.weight
rank=1, worker=0: shard_range=[pretrain-31.tar[0, 100), pretrain-31.tar[100, 200), pretrain-31.tar[200, 300), ...<1244>, pretrain-42.tar[4700, 4800), pretrain-42.tar[4800, 4900), pretrain-42.tar[4900, 5000)] sum(count)=125000
rank=1, worker=1: shard_range=[pretrain-42.tar[5000, 5100), pretrain-42.tar[5100, 5200), pretrain-42.tar[5200, 5300), ...<1244>, pretrain-53.tar[9700, 9800), pretrain-53.tar[9800, 9900), pretrain-53.tar[9900, 10000)] sum(count)=125000
rank=0, worker=0: shard_range=[pretrain-0.tar[0, 100), pretrain-0.tar[100, 200), pretrain-0.tar[200, 300), ...<1244>, pretrain-2.tar[4700, 4800), pretrain-2.tar[4800, 4900), pretrain-2.tar[4900, 5000)] sum(count)=125000
rank=0, worker=1: shard_range=[pretrain-2.tar[5000, 5100), pretrain-2.tar[5100, 5200), pretrain-2.tar[5200, 5300), ...<1244>, pretrain-30.tar[9700, 9800), pretrain-30.tar[9800, 9900), pretrain-30.tar[9900, 10000)] sum(count)=125000
rank=1, worker=0: shard_range=[pretrain-7.tar[936, 10000), pretrain-8.tar[0, 5468)] sum(count)=14532
rank=1, worker=1: shard_range=[pretrain-8.tar[5468, 10000), pretrain-9.tar[0, 10000)] sum(count)=14532
rank=0, worker=0: shard_range=[pretrain-54.tar[0, 10000), pretrain-55.tar[0, 4532)] sum(count)=14532
rank=0, worker=1: shard_range=[pretrain-55.tar[4532, 8128), pretrain-6.tar[0, 10000), pretrain-7.tar[0, 936)] sum(count)=14532
times across ranks (ms):
  model-and-optimizer-setup:
     rank  0: 94.42
     rank  1: 94.52
     rank  2: 94.42
     rank  3: 108.03
     rank  4: 30.52
     rank  5: 36.57
     rank  6: 28.69
     rank  7: 28.67
     rank  8: 46.82
     rank  9: 46.32
     rank 10: 46.87
     rank 11: 46.47
     rank 12: 46.79
     rank 13: 47.73
     rank 14: 46.66
     rank 15: 47.71
  train/valid/test-data-iterators-setup:
     rank  0: 1231.48
     rank  1: 1231.48
     rank  2: 1258.47
     rank  3: 1232.01
     rank  4: 1231.52
     rank  5: 1231.46
     rank  6: 1231.56
     rank  7: 1231.48
     rank  8: 1231.62
     rank  9: 1231.44
     rank 10: 1231.58
     rank 11: 1231.63
     rank 12: 1231.72
     rank 13: 1231.83
     rank 14: 1231.62
     rank 15: 1231.60
 [2024-12-24 22:26:34] iteration        1/      10 | consumed samples:           16 | elapsed time per iteration (ms): 10829.7 | learning rate: 7.500000E-07 | global batch size:    16 | lm loss: 7.255644E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
[Rank 13] (after 1 iterations) memory (MB) | allocated: 4405.5654296875 | max allocated: 5493.412109375 | reserved: 5902.0 | max reserved: 5902.0
stage4 GPU utialization:48.76963875510476 %
[Rank 12] (after 1 iterations) memory (MB) | allocated: 4405.5654296875 | max allocated: 5493.412109375 | reserved: 5902.0 | max reserved: 5902.0
times across ranks (ms):
  forward-backward:
     rank  0: 10744.86
     rank  1: 10745.21
     rank  2: 10744.78
     rank  3: 10744.82
     rank  4: 10746.35
     rank  5: 10746.49
     rank  6: 10746.38
     rank  7: 10746.45
     rank  8: 10745.91
     rank  9: 10745.81
     rank 10: 10746.04
     rank 11: 10745.84
     rank 12: 10746.30
     rank 13: 10746.38
     rank 14: 10746.24
     rank 15: 10746.39
  forward-compute:
     rank  0: 3094.47
     rank  1: 3079.16
     rank  2: 3185.85
     rank  3: 3156.98
     rank  4: 2413.06
     rank  5: 2398.85
     rank  6: 2610.61
     rank  7: 2585.09
     rank  8: 2605.65
     rank  9: 2602.28
     rank 10: 2776.32
     rank 11: 2771.24
     rank 12: 2196.23
     rank 13: 2201.89
     rank 14: 1797.57
     rank 15: 1815.46
  backward-compute:
     rank  0: 47.26
     rank  1: 50.46
     rank  2: 48.07
     rank  3: 47.51
     rank  4: 759.32
     rank  5: 759.38
     rank  6: 749.75
     rank  7: 751.90
     rank  8: 736.93
     rank  9: 743.50
     rank 10: 735.04
     rank 11: 756.20
     rank 12: 1007.04
     rank 13: 1003.03
     rank 14: 1008.85
     rank 15: 1005.61
  pure-backward-compute:
     rank  0: 46.78
     rank  1: 49.92
     rank  2: 47.60
     rank  3: 46.82
     rank  4: 758.29
     rank  5: 758.60
     rank  6: 748.86
     rank  7: 751.22
     rank  8: 735.54
     rank  9: 742.07
     rank 10: 734.00
     rank 11: 755.28
     rank 12: 1004.95
     rank 13: 1001.91
     rank 14: 1007.22
     rank 15: 1004.32
  batch-generator:
     rank  0: 1214.47
     rank  1: 1233.39
     rank  2: 1215.61
     rank  3: 1186.10
     rank  4: 1031.29
     rank  5: 1018.31
     rank  6: 1028.87
     rank  7: 1002.68
     rank  8: 894.02
     rank  9: 891.63
     rank 10: 1008.32
     rank 11: 1005.21
     rank 12: 1091.02
     rank 13: 1090.34
     rank 14: 984.28
     rank 15: 998.81
  forward-recv:
     rank  4: 2586.70
     rank  5: 2595.58
     rank  6: 2620.03
     rank  7: 2640.52
     rank  8: 4540.43
     rank  9: 4539.67
     rank 10: 4765.45
     rank 11: 4765.63
     rank 12: 6712.43
     rank 13: 6716.53
     rank 14: 7108.35
     rank 15: 7113.75
  forward-send:
     rank  0: 4099.05
     rank  1: 4110.07
     rank  2: 4433.47
     rank  3: 4460.93
     rank  4: 2130.35
     rank  5: 2133.38
     rank  6: 2301.17
     rank  7: 2307.32
     rank  8: 23.51
     rank  9: 27.90
     rank 10: 21.16
     rank 11: 26.71
  backward-recv:
     rank  0: 624.28
     rank  1: 623.59
     rank  2: 626.91
     rank  3: 627.62
     rank  4: 230.41
     rank  5: 233.26
     rank  6: 234.52
     rank  7: 234.63
     rank  8: 116.48
     rank  9: 116.09
     rank 10: 119.00
     rank 11: 118.61
  backward-send:
     rank  4: 7.77
     rank  5: 5.20
     rank  6: 7.76
     rank  7: 6.88
     rank  8: 7.21
     rank  9: 7.11
     rank 10: 7.65
     rank 11: 7.58
     rank 12: 2.68
     rank 13: 2.18
     rank 14: 3.50
     rank 15: 3.11
  forward-send-backward-recv:
     rank  0: 2322.21
     rank  1: 2323.77
     rank  2: 1896.60
     rank  3: 1896.43
     rank  4: 2021.93
     rank  5: 2023.99
     rank  6: 1629.88
     rank  7: 1629.70
     rank  8: 2009.47
     rank  9: 2004.27
     rank 10: 1619.83
     rank 11: 1598.14
  backward-send-forward-recv:
     rank  4: 27.30
     rank  5: 29.29
     rank  6: 29.02
     rank  7: 27.80
     rank  8: 42.65
     rank  9: 42.29
     rank 10: 42.54
     rank 11: 41.88
     rank 12: 73.39
     rank 13: 68.77
     rank 14: 77.26
     rank 15: 57.79
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.09
     rank  2: 0.04
     rank  3: 0.05
     rank  4: 0.03
     rank  5: 0.04
     rank  6: 0.03
     rank  7: 0.04
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.05
     rank 11: 0.04
     rank 12: 0.03
     rank 13: 0.04
     rank 14: 0.03
     rank 15: 0.04
  embedding-grads-all-reduce:
     rank  0: 0.08
     rank  1: 0.10
     rank  2: 0.08
     rank  3: 0.10
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.04
     rank 11: 0.03
     rank 12: 0.09
     rank 13: 0.09
     rank 14: 0.08
     rank 15: 0.08
  all-grads-sync:
     rank  0: 120.31
     rank  1: 120.45
     rank  2: 120.41
     rank  3: 120.51
     rank  4: 531.56
     rank  5: 544.33
     rank  6: 531.54
     rank  7: 544.30
     rank  8: 510.69
     rank  9: 516.30
     rank 10: 510.70
     rank 11: 516.30
     rank 12: 495.38
     rank 13: 477.13
     rank 14: 495.38
     rank 15: 477.11
  optimizer-copy-to-main-grad:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.03
     rank  3: 0.04
     rank  4: 0.05
     rank  5: 0.06
     rank  6: 0.05
     rank  7: 0.06
     rank  8: 0.06
     rank  9: 0.06
     rank 10: 0.06
     rank 11: 0.06
     rank 12: 0.04
     rank 13: 0.05
     rank 14: 0.04
     rank 15: 0.07
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 29.83
     rank  1: 30.24
     rank  2: 30.05
     rank  3: 30.26
     rank  4: 76.00
     rank  5: 74.92
     rank  6: 74.76
     rank  7: 78.38
     rank  8: 71.75
     rank  9: 70.65
     rank 10: 72.41
     rank 11: 72.15
     rank 12: 70.88
     rank 13: 71.39
     rank 14: 70.87
     rank 15: 72.16
  optimizer:
     rank  0: 30.85
     rank  1: 31.26
     rank  2: 31.07
     rank  3: 31.29
     rank  4: 77.01
     rank  5: 75.93
     rank  6: 75.78
     rank  7: 79.40
     rank  8: 72.78
     rank  9: 71.68
     rank 10: 73.42
     rank 11: 73.17
     rank 12: 71.89
     rank 13: 72.46
     rank 14: 71.89
     rank 15: 73.20
 [2024-12-24 22:26:37] iteration        2/      10 | consumed samples:           32 | elapsed time per iteration (ms): 3115.3 | learning rate: 1.500000E-06 | global batch size:    16 | lm loss: 7.121781E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 3016.73
     rank  1: 3017.20
     rank  2: 3016.82
     rank  3: 3017.33
     rank  4: 3021.82
     rank  5: 3022.04
     rank  6: 3021.81
     rank  7: 3022.13
     rank  8: 3021.18
     rank  9: 3021.43
     rank 10: 3021.25
     rank 11: 3021.51
     rank 12: 3021.44
     rank 13: 3021.57
     rank 14: 3021.41
     rank 15: 3021.50
  forward-compute:
     rank  0: 682.74
     rank  1: 681.48
     rank  2: 730.20
     rank  3: 732.33
     rank  4: 526.79
     rank  5: 527.41
     rank  6: 540.90
     rank  7: 539.64
     rank  8: 497.19
     rank  9: 499.25
     rank 10: 504.46
     rank 11: 504.75
     rank 12: 703.32
     rank 13: 712.23
     rank 14: 680.89
     rank 15: 680.70
  backward-compute:
     rank  0: 44.53
     rank  1: 47.44
     rank  2: 47.01
     rank  3: 43.92
     rank  4: 749.55
     rank  5: 749.25
     rank  6: 750.52
     rank  7: 749.70
     rank  8: 724.18
     rank  9: 732.67
     rank 10: 725.68
     rank 11: 726.09
     rank 12: 985.23
     rank 13: 984.39
     rank 14: 1001.22
     rank 15: 1000.75
  pure-backward-compute:
     rank  0: 44.14
     rank  1: 46.87
     rank  2: 46.58
     rank  3: 43.40
     rank  4: 749.02
     rank  5: 748.65
     rank  6: 750.00
     rank  7: 748.57
     rank  8: 722.83
     rank  9: 731.42
     rank 10: 724.89
     rank 11: 725.36
     rank 12: 982.97
     rank 13: 982.75
     rank 14: 999.78
     rank 15: 999.44
  batch-generator:
     rank  0: 30.48
     rank  1: 29.32
     rank  2: 31.14
     rank  3: 32.11
     rank  4: 25.43
     rank  5: 29.35
     rank  6: 26.91
     rank  7: 33.24
     rank  8: 28.12
     rank  9: 30.19
     rank 10: 31.08
     rank 11: 31.07
     rank 12: 32.20
     rank 13: 41.18
     rank 14: 35.68
     rank 15: 33.45
  forward-recv:
     rank  4: 108.28
     rank  5: 109.55
     rank  6: 146.83
     rank  7: 146.20
     rank  8: 167.36
     rank  9: 166.19
     rank 10: 190.92
     rank 11: 190.41
     rank 12: 219.11
     rank 13: 219.34
     rank 14: 236.80
     rank 15: 237.30
  forward-send:
     rank  0: 4.68
     rank  1: 4.68
     rank  2: 4.76
     rank  3: 4.68
     rank  4: 5.44
     rank  5: 4.62
     rank  6: 5.18
     rank  7: 5.54
     rank  8: 5.03
     rank  9: 5.31
     rank 10: 2.68
     rank 11: 2.95
  backward-recv:
     rank  0: 636.82
     rank  1: 635.15
     rank  2: 637.13
     rank  3: 639.07
     rank  4: 241.74
     rank  5: 242.70
     rank  6: 243.48
     rank  7: 243.29
     rank  8: 123.41
     rank  9: 121.32
     rank 10: 124.74
     rank 11: 124.04
  backward-send:
     rank  4: 6.10
     rank  5: 5.95
     rank  6: 4.06
     rank  7: 6.30
     rank  8: 7.20
     rank  9: 7.72
     rank 10: 8.17
     rank 11: 8.28
     rank 12: 2.98
     rank 13: 1.69
     rank 14: 3.41
     rank 15: 2.94
  forward-send-backward-recv:
     rank  0: 806.23
     rank  1: 806.05
     rank  2: 757.33
     rank  3: 757.10
     rank  4: 511.34
     rank  5: 511.45
     rank  6: 461.39
     rank  7: 460.71
     rank  8: 507.24
     rank  9: 500.71
     rank 10: 480.74
     rank 11: 480.76
  backward-send-forward-recv:
     rank  4: 15.83
     rank  5: 16.09
     rank  6: 15.97
     rank  7: 16.36
     rank  8: 35.48
     rank  9: 34.42
     rank 10: 34.97
     rank 11: 34.94
     rank 12: 66.18
     rank 13: 58.92
     rank 14: 57.51
     rank 15: 58.34
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.12
     rank  2: 0.03
     rank  3: 0.10
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.04
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.04
     rank 12: 0.03
     rank 13: 0.06
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.15
     rank  2: 0.06
     rank  3: 0.16
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.07
     rank 13: 0.12
     rank 14: 0.07
     rank 15: 0.06
  all-grads-sync:
     rank  0: 29.93
     rank  1: 30.85
     rank  2: 30.01
     rank  3: 30.88
     rank  4: 481.24
     rank  5: 481.22
     rank  6: 481.25
     rank  7: 481.17
     rank  8: 833.86
     rank  9: 833.93
     rank 10: 833.91
     rank 11: 833.98
     rank 12: 467.27
     rank 13: 445.79
     rank 14: 467.36
     rank 15: 445.92
  optimizer-copy-to-main-grad:
     rank  0: 0.04
     rank  1: 0.05
     rank  2: 0.02
     rank  3: 0.05
     rank  4: 0.04
     rank  5: 0.07
     rank  6: 0.03
     rank  7: 0.05
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.05
     rank 11: 0.06
     rank 12: 0.04
     rank 13: 0.05
     rank 14: 0.03
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 6.10
     rank  1: 6.31
     rank  2: 6.12
     rank  3: 6.44
     rank  4: 60.23
     rank  5: 60.20
     rank  6: 60.14
     rank  7: 60.41
     rank  8: 53.50
     rank  9: 53.58
     rank 10: 53.76
     rank 11: 53.78
     rank 12: 54.29
     rank 13: 54.47
     rank 14: 54.32
     rank 15: 54.30
  optimizer:
     rank  0: 6.83
     rank  1: 7.00
     rank  2: 6.80
     rank  3: 7.12
     rank  4: 60.91
     rank  5: 60.89
     rank  6: 60.82
     rank  7: 61.10
     rank  8: 54.18
     rank  9: 54.26
     rank 10: 54.46
     rank 11: 54.47
     rank 12: 54.98
     rank 13: 55.16
     rank 14: 55.01
     rank 15: 54.99
 [2024-12-24 22:26:39] iteration        3/      10 | consumed samples:           48 | elapsed time per iteration (ms): 2745.0 | learning rate: 2.250000E-06 | global batch size:    16 | lm loss: 6.814207E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2650.42
     rank  1: 2650.89
     rank  2: 2650.32
     rank  3: 2651.26
     rank  4: 2655.34
     rank  5: 2655.73
     rank  6: 2655.33
     rank  7: 2655.79
     rank  8: 2654.73
     rank  9: 2655.09
     rank 10: 2654.74
     rank 11: 2655.18
     rank 12: 2654.90
     rank 13: 2655.22
     rank 14: 2654.89
     rank 15: 2655.29
  forward-compute:
     rank  0: 655.32
     rank  1: 654.91
     rank  2: 705.82
     rank  3: 706.56
     rank  4: 521.72
     rank  5: 525.51
     rank  6: 543.01
     rank  7: 541.11
     rank  8: 490.71
     rank  9: 491.44
     rank 10: 503.74
     rank 11: 503.39
     rank 12: 688.89
     rank 13: 699.57
     rank 14: 675.32
     rank 15: 674.46
  backward-compute:
     rank  0: 46.78
     rank  1: 46.92
     rank  2: 47.49
     rank  3: 43.62
     rank  4: 752.43
     rank  5: 751.47
     rank  6: 749.08
     rank  7: 749.04
     rank  8: 723.26
     rank  9: 733.52
     rank 10: 728.24
     rank 11: 727.60
     rank 12: 985.33
     rank 13: 984.20
     rank 14: 1004.85
     rank 15: 1006.43
  pure-backward-compute:
     rank  0: 46.35
     rank  1: 46.36
     rank  2: 46.99
     rank  3: 43.25
     rank  4: 751.81
     rank  5: 751.08
     rank  6: 748.49
     rank  7: 748.03
     rank  8: 722.37
     rank  9: 732.68
     rank 10: 727.28
     rank 11: 726.00
     rank 12: 983.17
     rank 13: 982.83
     rank 14: 1003.55
     rank 15: 1003.66
  batch-generator:
     rank  0: 27.11
     rank  1: 27.52
     rank  2: 29.77
     rank  3: 30.95
     rank  4: 26.66
     rank  5: 29.06
     rank  6: 26.95
     rank  7: 31.78
     rank  8: 22.93
     rank  9: 23.90
     rank 10: 29.81
     rank 11: 29.42
     rank 12: 43.82
     rank 13: 52.01
     rank 14: 33.62
     rank 15: 31.27
  forward-recv:
     rank  4: 115.66
     rank  5: 116.96
     rank  6: 128.00
     rank  7: 127.75
     rank  8: 167.67
     rank  9: 167.29
     rank 10: 180.03
     rank 11: 179.86
     rank 12: 218.66
     rank 13: 218.61
     rank 14: 222.39
     rank 15: 222.51
  forward-send:
     rank  0: 4.66
     rank  1: 4.79
     rank  2: 5.15
     rank  3: 5.15
     rank  4: 5.55
     rank  5: 4.81
     rank  6: 5.39
     rank  7: 5.48
     rank  8: 5.01
     rank  9: 5.01
     rank 10: 3.00
     rank 11: 3.18
  backward-recv:
     rank  0: 631.06
     rank  1: 632.06
     rank  2: 632.86
     rank  3: 634.37
     rank  4: 236.21
     rank  5: 237.60
     rank  6: 239.99
     rank  7: 239.16
     rank  8: 119.51
     rank  9: 118.64
     rank 10: 119.67
     rank 11: 119.80
  backward-send:
     rank  4: 5.99
     rank  5: 5.50
     rank  6: 5.25
     rank  7: 6.29
     rank  8: 6.38
     rank  9: 6.60
     rank 10: 6.82
     rank 11: 6.61
     rank 12: 3.25
     rank 13: 2.78
     rank 14: 3.23
     rank 15: 3.06
  forward-send-backward-recv:
     rank  0: 825.19
     rank  1: 821.63
     rank  2: 771.25
     rank  3: 773.39
     rank  4: 498.63
     rank  5: 498.42
     rank  6: 470.25
     rank  7: 469.77
     rank  8: 507.20
     rank  9: 497.91
     rank 10: 485.52
     rank 11: 486.43
  backward-send-forward-recv:
     rank  4: 15.32
     rank  5: 12.81
     rank  6: 13.85
     rank  7: 15.84
     rank  8: 34.23
     rank  9: 33.94
     rank 10: 31.99
     rank 11: 32.10
     rank 12: 66.95
     rank 13: 58.72
     rank 14: 60.20
     rank 15: 60.31
  layernorm-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.09
     rank  2: 0.03
     rank  3: 0.24
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.04
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.05
     rank 14: 0.03
     rank 15: 0.04
  embedding-grads-all-reduce:
     rank  0: 0.13
     rank  1: 0.16
     rank  2: 0.06
     rank  3: 0.17
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.07
     rank 13: 0.13
     rank 14: 0.06
     rank 15: 0.12
  all-grads-sync:
     rank  0: 32.32
     rank  1: 32.18
     rank  2: 32.38
     rank  3: 32.20
     rank  4: 482.62
     rank  5: 482.60
     rank  6: 482.62
     rank  7: 482.62
     rank  8: 436.08
     rank  9: 436.13
     rank 10: 436.07
     rank 11: 436.13
     rank 12: 475.87
     rank 13: 456.05
     rank 14: 475.87
     rank 15: 456.16
  optimizer-copy-to-main-grad:
     rank  0: 0.03
     rank  1: 0.04
     rank  2: 0.02
     rank  3: 0.04
     rank  4: 0.04
     rank  5: 0.04
     rank  6: 0.03
     rank  7: 0.05
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.03
     rank 15: 0.10
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 6.31
     rank  1: 6.32
     rank  2: 6.12
     rank  3: 6.50
     rank  4: 60.19
     rank  5: 60.28
     rank  6: 60.25
     rank  7: 60.34
     rank  8: 53.54
     rank  9: 53.57
     rank 10: 53.62
     rank 11: 53.67
     rank 12: 54.41
     rank 13: 54.50
     rank 14: 54.32
     rank 15: 54.51
  optimizer:
     rank  0: 7.14
     rank  1: 7.15
     rank  2: 6.96
     rank  3: 7.36
     rank  4: 61.02
     rank  5: 61.11
     rank  6: 61.09
     rank  7: 61.19
     rank  8: 54.37
     rank  9: 54.41
     rank 10: 54.48
     rank 11: 54.51
     rank 12: 55.25
     rank 13: 55.34
     rank 14: 55.16
     rank 15: 55.36
 [2024-12-24 22:26:42] iteration        4/      10 | consumed samples:           64 | elapsed time per iteration (ms): 2750.1 | learning rate: 3.000000E-06 | global batch size:    16 | lm loss: 3.311645E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2654.32
     rank  1: 2654.10
     rank  2: 2654.22
     rank  3: 2654.16
     rank  4: 2659.26
     rank  5: 2659.23
     rank  6: 2659.30
     rank  7: 2659.24
     rank  8: 2658.65
     rank  9: 2658.65
     rank 10: 2658.76
     rank 11: 2658.72
     rank 12: 2658.98
     rank 13: 2658.82
     rank 14: 2659.05
     rank 15: 2658.83
  forward-compute:
     rank  0: 657.49
     rank  1: 660.32
     rank  2: 686.09
     rank  3: 688.80
     rank  4: 516.23
     rank  5: 517.92
     rank  6: 529.78
     rank  7: 530.64
     rank  8: 488.58
     rank  9: 488.03
     rank 10: 504.56
     rank 11: 503.99
     rank 12: 687.90
     rank 13: 699.70
     rank 14: 676.72
     rank 15: 676.99
  backward-compute:
     rank  0: 47.94
     rank  1: 44.50
     rank  2: 47.02
     rank  3: 44.59
     rank  4: 753.99
     rank  5: 751.98
     rank  6: 750.79
     rank  7: 750.40
     rank  8: 723.64
     rank  9: 735.69
     rank 10: 728.31
     rank 11: 728.49
     rank 12: 986.86
     rank 13: 985.98
     rank 14: 1006.68
     rank 15: 1006.91
  pure-backward-compute:
     rank  0: 47.51
     rank  1: 43.88
     rank  2: 46.57
     rank  3: 44.06
     rank  4: 753.56
     rank  5: 751.56
     rank  6: 750.14
     rank  7: 749.96
     rank  8: 722.55
     rank  9: 734.73
     rank 10: 727.25
     rank 11: 726.58
     rank 12: 985.07
     rank 13: 984.78
     rank 14: 1005.06
     rank 15: 1005.16
  batch-generator:
     rank  0: 30.61
     rank  1: 33.90
     rank  2: 29.53
     rank  3: 32.22
     rank  4: 24.00
     rank  5: 25.24
     rank  6: 27.73
     rank  7: 27.88
     rank  8: 22.78
     rank  9: 22.09
     rank 10: 28.60
     rank 11: 28.88
     rank 12: 38.25
     rank 13: 50.25
     rank 14: 31.28
     rank 15: 31.52
  forward-recv:
     rank  4: 114.96
     rank  5: 115.63
     rank  6: 120.65
     rank  7: 120.56
     rank  8: 170.33
     rank  9: 170.01
     rank 10: 174.64
     rank 11: 174.66
     rank 12: 222.74
     rank 13: 222.88
     rank 14: 224.12
     rank 15: 224.14
  forward-send:
     rank  0: 4.65
     rank  1: 4.68
     rank  2: 4.73
     rank  3: 4.72
     rank  4: 7.90
     rank  5: 7.35
     rank  6: 7.61
     rank  7: 7.56
     rank  8: 5.09
     rank  9: 5.28
     rank 10: 4.52
     rank 11: 4.58
  backward-recv:
     rank  0: 631.32
     rank  1: 634.10
     rank  2: 633.09
     rank  3: 632.73
     rank  4: 237.20
     rank  5: 238.42
     rank  6: 238.18
     rank  7: 238.66
     rank  8: 119.63
     rank  9: 118.27
     rank 10: 119.34
     rank 11: 119.34
  backward-send:
     rank  4: 6.53
     rank  5: 5.45
     rank  6: 7.69
     rank  7: 7.38
     rank  8: 7.32
     rank  9: 7.69
     rank 10: 7.94
     rank 11: 7.94
     rank 12: 4.15
     rank 13: 3.05
     rank 14: 4.02
     rank 15: 4.21
  forward-send-backward-recv:
     rank  0: 825.67
     rank  1: 823.35
     rank  2: 797.30
     rank  3: 797.08
     rank  4: 503.77
     rank  5: 506.75
     rank  6: 489.45
     rank  7: 489.26
     rank  8: 512.00
     rank  9: 501.37
     rank 10: 491.07
     rank 11: 491.67
  backward-send-forward-recv:
     rank  4: 16.30
     rank  5: 15.19
     rank  6: 15.85
     rank  7: 16.04
     rank  8: 35.08
     rank  9: 35.85
     rank 10: 32.96
     rank 11: 32.51
     rank 12: 65.46
     rank 13: 55.61
     rank 14: 57.20
     rank 15: 57.71
  layernorm-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.03
     rank  2: 0.05
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.06
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.11
     rank  1: 0.06
     rank  2: 0.08
     rank  3: 0.09
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.09
     rank 13: 0.07
     rank 14: 0.14
     rank 15: 0.06
  all-grads-sync:
     rank  0: 34.66
     rank  1: 34.48
     rank  2: 34.75
     rank  3: 34.57
     rank  4: 480.72
     rank  5: 482.00
     rank  6: 480.71
     rank  7: 481.97
     rank  8: 437.93
     rank  9: 437.98
     rank 10: 437.90
     rank 11: 437.97
     rank 12: 464.68
     rank 13: 443.77
     rank 14: 464.55
     rank 15: 443.77
  optimizer-copy-to-main-grad:
     rank  0: 0.04
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.04
     rank  6: 0.04
     rank  7: 0.03
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.05
     rank 11: 0.06
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.08
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 6.36
     rank  1: 6.00
     rank  2: 6.06
     rank  3: 6.18
     rank  4: 60.22
     rank  5: 60.19
     rank  6: 60.34
     rank  7: 60.16
     rank  8: 53.69
     rank  9: 53.57
     rank 10: 53.68
     rank 11: 53.73
     rank 12: 54.43
     rank 13: 54.33
     rank 14: 54.54
     rank 15: 54.43
  optimizer:
     rank  0: 6.98
     rank  1: 6.63
     rank  2: 6.69
     rank  3: 6.81
     rank  4: 60.85
     rank  5: 60.81
     rank  6: 60.97
     rank  7: 60.79
     rank  8: 54.31
     rank  9: 54.19
     rank 10: 54.31
     rank 11: 54.36
     rank 12: 55.06
     rank 13: 54.96
     rank 14: 55.16
     rank 15: 55.05
 [2024-12-24 22:26:45] iteration        5/      10 | consumed samples:           80 | elapsed time per iteration (ms): 2750.8 | learning rate: 3.750000E-06 | global batch size:    16 | lm loss: 2.848657E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2657.15
     rank  1: 2656.73
     rank  2: 2657.05
     rank  3: 2656.72
     rank  4: 2662.13
     rank  5: 2661.85
     rank  6: 2662.10
     rank  7: 2661.86
     rank  8: 2661.50
     rank  9: 2661.20
     rank 10: 2661.50
     rank 11: 2661.20
     rank 12: 2662.40
     rank 13: 2661.46
     rank 14: 2662.03
     rank 15: 2661.43
  forward-compute:
     rank  0: 653.94
     rank  1: 656.82
     rank  2: 694.44
     rank  3: 697.51
     rank  4: 522.06
     rank  5: 524.57
     rank  6: 528.20
     rank  7: 529.88
     rank  8: 491.55
     rank  9: 492.88
     rank 10: 503.37
     rank 11: 504.08
     rank 12: 686.20
     rank 13: 697.59
     rank 14: 676.27
     rank 15: 678.17
  backward-compute:
     rank  0: 46.42
     rank  1: 44.20
     rank  2: 47.15
     rank  3: 43.68
     rank  4: 752.80
     rank  5: 751.76
     rank  6: 750.12
     rank  7: 749.90
     rank  8: 723.85
     rank  9: 733.83
     rank 10: 726.76
     rank 11: 729.06
     rank 12: 989.68
     rank 13: 990.69
     rank 14: 1004.44
     rank 15: 1003.78
  pure-backward-compute:
     rank  0: 45.97
     rank  1: 43.71
     rank  2: 46.69
     rank  3: 43.20
     rank  4: 752.22
     rank  5: 751.37
     rank  6: 749.71
     rank  7: 749.52
     rank  8: 722.91
     rank  9: 733.05
     rank 10: 725.88
     rank 11: 727.93
     rank 12: 987.78
     rank 13: 989.83
     rank 14: 1002.57
     rank 15: 1002.85
  batch-generator:
     rank  0: 35.89
     rank  1: 36.54
     rank  2: 29.35
     rank  3: 32.39
     rank  4: 28.32
     rank  5: 29.84
     rank  6: 25.23
     rank  7: 26.96
     rank  8: 24.39
     rank  9: 25.62
     rank 10: 30.59
     rank 11: 30.88
     rank 12: 34.99
     rank 13: 46.87
     rank 14: 35.67
     rank 15: 37.10
  forward-recv:
     rank  4: 112.32
     rank  5: 114.19
     rank  6: 132.44
     rank  7: 133.40
     rank  8: 167.70
     rank  9: 165.94
     rank 10: 182.04
     rank 11: 181.70
     rank 12: 220.06
     rank 13: 220.37
     rank 14: 223.00
     rank 15: 222.87
  forward-send:
     rank  0: 4.97
     rank  1: 4.84
     rank  2: 4.87
     rank  3: 4.76
     rank  4: 5.11
     rank  5: 3.97
     rank  6: 5.46
     rank  7: 4.80
     rank  8: 4.88
     rank  9: 5.36
     rank 10: 3.00
     rank 11: 3.11
  backward-recv:
     rank  0: 636.90
     rank  1: 638.18
     rank  2: 635.30
     rank  3: 637.40
     rank  4: 241.87
     rank  5: 242.36
     rank  6: 242.78
     rank  7: 242.49
     rank  8: 126.22
     rank  9: 125.59
     rank 10: 122.91
     rank 11: 121.35
  backward-send:
     rank  4: 7.14
     rank  5: 6.91
     rank  6: 6.92
     rank  7: 7.21
     rank  8: 7.13
     rank  9: 7.49
     rank 10: 7.81
     rank 11: 7.76
     rank 12: 4.74
     rank 13: 4.54
     rank 14: 4.53
     rank 15: 3.15
  forward-send-backward-recv:
     rank  0: 824.56
     rank  1: 821.82
     rank  2: 784.53
     rank  3: 783.09
     rank  4: 499.09
     rank  5: 500.23
     rank  6: 475.53
     rank  7: 475.69
     rank  8: 500.56
     rank  9: 491.05
     rank 10: 480.23
     rank 11: 479.94
  backward-send-forward-recv:
     rank  4: 16.65
     rank  5: 14.54
     rank  6: 16.66
     rank  7: 15.34
     rank  8: 34.38
     rank  9: 34.37
     rank 10: 33.80
     rank 11: 33.57
     rank 12: 63.17
     rank 13: 53.49
     rank 14: 56.19
     rank 15: 56.57
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.05
     rank 13: 0.03
     rank 14: 0.04
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.08
     rank  1: 0.06
     rank  2: 0.08
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.15
     rank 13: 0.07
     rank 14: 0.10
     rank 15: 0.06
  all-grads-sync:
     rank  0: 31.59
     rank  1: 31.33
     rank  2: 31.70
     rank  3: 31.41
     rank  4: 486.24
     rank  5: 486.40
     rank  6: 486.21
     rank  7: 486.39
     rank  8: 436.98
     rank  9: 437.00
     rank 10: 437.02
     rank 11: 436.98
     rank 12: 475.56
     rank 13: 455.42
     rank 14: 475.45
     rank 15: 455.43
  optimizer-copy-to-main-grad:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.04
     rank  5: 0.04
     rank  6: 0.03
     rank  7: 0.04
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.06
     rank 11: 0.04
     rank 12: 0.22
     rank 13: 0.05
     rank 14: 0.06
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 6.10
     rank  1: 6.07
     rank  2: 6.18
     rank  3: 6.00
     rank  4: 60.21
     rank  5: 60.20
     rank  6: 60.15
     rank  7: 60.20
     rank  8: 53.53
     rank  9: 53.56
     rank 10: 53.78
     rank 11: 53.58
     rank 12: 54.74
     rank 13: 54.31
     rank 14: 54.43
     rank 15: 54.31
  optimizer:
     rank  0: 7.00
     rank  1: 6.97
     rank  2: 7.08
     rank  3: 6.90
     rank  4: 61.11
     rank  5: 61.10
     rank  6: 61.05
     rank  7: 61.11
     rank  8: 54.43
     rank  9: 54.46
     rank 10: 54.69
     rank 11: 54.48
     rank 12: 55.64
     rank 13: 55.21
     rank 14: 55.38
     rank 15: 55.21
 [2024-12-24 22:26:48] iteration        6/      10 | consumed samples:           96 | elapsed time per iteration (ms): 2757.1 | learning rate: 4.500000E-06 | global batch size:    16 | lm loss: 1.694954E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2659.97
     rank  1: 2660.09
     rank  2: 2659.87
     rank  3: 2660.13
     rank  4: 2665.03
     rank  5: 2665.05
     rank  6: 2664.99
     rank  7: 2665.09
     rank  8: 2664.41
     rank  9: 2664.47
     rank 10: 2664.39
     rank 11: 2664.51
     rank 12: 2664.69
     rank 13: 2664.51
     rank 14: 2664.65
     rank 15: 2664.47
  forward-compute:
     rank  0: 655.25
     rank  1: 659.65
     rank  2: 695.55
     rank  3: 698.59
     rank  4: 524.67
     rank  5: 528.28
     rank  6: 523.43
     rank  7: 524.91
     rank  8: 492.64
     rank  9: 493.70
     rank 10: 502.42
     rank 11: 502.78
     rank 12: 683.16
     rank 13: 688.92
     rank 14: 688.50
     rank 15: 689.84
  backward-compute:
     rank  0: 45.84
     rank  1: 43.09
     rank  2: 46.36
     rank  3: 43.89
     rank  4: 755.03
     rank  5: 753.64
     rank  6: 750.71
     rank  7: 750.81
     rank  8: 724.93
     rank  9: 730.25
     rank 10: 729.10
     rank 11: 728.73
     rank 12: 988.57
     rank 13: 987.59
     rank 14: 1003.76
     rank 15: 1003.73
  pure-backward-compute:
     rank  0: 45.38
     rank  1: 42.74
     rank  2: 45.90
     rank  3: 43.41
     rank  4: 754.46
     rank  5: 753.23
     rank  6: 750.24
     rank  7: 750.38
     rank  8: 723.88
     rank  9: 729.42
     rank 10: 727.68
     rank 11: 727.88
     rank 12: 987.29
     rank 13: 986.60
     rank 14: 1002.18
     rank 15: 1002.78
  batch-generator:
     rank  0: 28.87
     rank  1: 33.64
     rank  2: 31.07
     rank  3: 34.05
     rank  4: 28.32
     rank  5: 30.66
     rank  6: 23.26
     rank  7: 23.73
     rank  8: 24.02
     rank  9: 24.94
     rank 10: 28.05
     rank 11: 27.55
     rank 12: 35.49
     rank 13: 41.01
     rank 14: 34.17
     rank 15: 35.33
  forward-recv:
     rank  4: 122.61
     rank  5: 123.14
     rank  6: 129.42
     rank  7: 129.19
     rank  8: 180.76
     rank  9: 180.64
     rank 10: 177.17
     rank 11: 177.48
     rank 12: 233.19
     rank 13: 233.03
     rank 14: 219.19
     rank 15: 219.13
  forward-send:
     rank  0: 4.71
     rank  1: 4.40
     rank  2: 4.69
     rank  3: 4.49
     rank  4: 5.38
     rank  5: 4.87
     rank  6: 5.33
     rank  7: 5.54
     rank  8: 4.87
     rank  9: 4.59
     rank 10: 3.37
     rank 11: 3.28
  backward-recv:
     rank  0: 631.76
     rank  1: 633.68
     rank  2: 632.14
     rank  3: 632.68
     rank  4: 238.58
     rank  5: 239.64
     rank  6: 241.49
     rank  7: 240.90
     rank  8: 123.63
     rank  9: 121.84
     rank 10: 122.11
     rank 11: 122.15
  backward-send:
     rank  4: 7.55
     rank  5: 6.24
     rank  6: 7.08
     rank  7: 7.59
     rank  8: 7.77
     rank  9: 7.88
     rank 10: 8.07
     rank 11: 8.09
     rank 12: 4.25
     rank 13: 3.13
     rank 14: 4.39
     rank 15: 4.40
  forward-send-backward-recv:
     rank  0: 832.10
     rank  1: 828.36
     rank  2: 791.42
     rank  3: 790.67
     rank  4: 490.77
     rank  5: 491.48
     rank  6: 488.92
     rank  7: 488.08
     rank  8: 491.52
     rank  9: 487.54
     rank 10: 489.05
     rank 11: 488.81
  backward-send-forward-recv:
     rank  4: 16.21
     rank  5: 13.96
     rank  6: 15.89
     rank  7: 15.05
     rank  8: 35.10
     rank  9: 34.79
     rank 10: 32.79
     rank 11: 33.11
     rank 12: 60.36
     rank 13: 56.29
     rank 14: 53.63
     rank 15: 54.09
  layernorm-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.05
     rank  2: 0.03
     rank  3: 0.06
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.05
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.07
     rank  1: 0.07
     rank  2: 0.05
     rank  3: 0.10
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.08
     rank 13: 0.06
     rank 14: 0.12
     rank 15: 0.05
  all-grads-sync:
     rank  0: 33.53
     rank  1: 33.33
     rank  2: 33.63
     rank  3: 33.41
     rank  4: 485.57
     rank  5: 485.55
     rank  6: 485.57
     rank  7: 485.54
     rank  8: 444.16
     rank  9: 444.20
     rank 10: 444.16
     rank 11: 444.20
     rank 12: 460.67
     rank 13: 439.41
     rank 14: 460.56
     rank 15: 439.37
  optimizer-copy-to-main-grad:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.04
     rank  4: 0.04
     rank  5: 0.07
     rank  6: 0.04
     rank  7: 0.04
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.05
     rank 11: 0.04
     rank 12: 0.04
     rank 13: 0.03
     rank 14: 0.05
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 6.13
     rank  1: 6.06
     rank  2: 6.00
     rank  3: 6.11
     rank  4: 60.26
     rank  5: 60.22
     rank  6: 60.19
     rank  7: 60.23
     rank  8: 53.58
     rank  9: 53.57
     rank 10: 53.64
     rank 11: 53.58
     rank 12: 54.35
     rank 13: 54.38
     rank 14: 54.47
     rank 15: 54.29
  optimizer:
     rank  0: 6.76
     rank  1: 6.69
     rank  2: 6.62
     rank  3: 6.74
     rank  4: 60.88
     rank  5: 60.85
     rank  6: 60.82
     rank  7: 60.86
     rank  8: 54.21
     rank  9: 54.20
     rank 10: 54.27
     rank 11: 54.20
     rank 12: 54.98
     rank 13: 55.01
     rank 14: 55.12
     rank 15: 54.92
 [2024-12-24 22:26:50] iteration        7/      10 | consumed samples:          112 | elapsed time per iteration (ms): 2766.4 | learning rate: 5.250000E-06 | global batch size:    16 | lm loss: 3.087190E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2669.43
     rank  1: 2668.25
     rank  2: 2668.96
     rank  3: 2668.25
     rank  4: 2673.80
     rank  5: 2673.40
     rank  6: 2673.74
     rank  7: 2673.38
     rank  8: 2673.14
     rank  9: 2672.79
     rank 10: 2673.11
     rank 11: 2672.84
     rank 12: 2673.13
     rank 13: 2673.12
     rank 14: 2673.10
     rank 15: 2673.05
  forward-compute:
     rank  0: 675.07
     rank  1: 678.55
     rank  2: 690.68
     rank  3: 692.96
     rank  4: 536.45
     rank  5: 537.63
     rank  6: 519.70
     rank  7: 521.72
     rank  8: 493.95
     rank  9: 493.85
     rank 10: 501.88
     rank 11: 502.46
     rank 12: 676.00
     rank 13: 687.53
     rank 14: 690.47
     rank 15: 691.32
  backward-compute:
     rank  0: 47.95
     rank  1: 42.98
     rank  2: 46.31
     rank  3: 44.93
     rank  4: 754.64
     rank  5: 753.74
     rank  6: 751.27
     rank  7: 751.69
     rank  8: 726.04
     rank  9: 734.83
     rank 10: 729.12
     rank 11: 729.47
     rank 12: 991.91
     rank 13: 990.94
     rank 14: 1002.76
     rank 15: 1001.75
  pure-backward-compute:
     rank  0: 47.44
     rank  1: 42.68
     rank  2: 45.88
     rank  3: 44.42
     rank  4: 754.05
     rank  5: 753.31
     rank  6: 750.86
     rank  7: 751.29
     rank  8: 724.91
     rank  9: 733.43
     rank 10: 727.90
     rank 11: 728.83
     rank 12: 989.00
     rank 13: 989.31
     rank 14: 1001.09
     rank 15: 1000.30
  batch-generator:
     rank  0: 36.57
     rank  1: 38.46
     rank  2: 29.00
     rank  3: 31.14
     rank  4: 35.18
     rank  5: 35.38
     rank  6: 21.56
     rank  7: 22.96
     rank  8: 24.98
     rank  9: 24.87
     rank 10: 27.63
     rank 11: 27.09
     rank 12: 39.96
     rank 13: 50.34
     rank 14: 32.85
     rank 15: 33.51
  forward-recv:
     rank  4: 127.94
     rank  5: 128.52
     rank  6: 132.87
     rank  7: 133.05
     rank  8: 182.08
     rank  9: 181.55
     rank 10: 176.03
     rank 11: 176.10
     rank 12: 235.18
     rank 13: 235.44
     rank 14: 217.70
     rank 15: 217.74
  forward-send:
     rank  0: 4.58
     rank  1: 4.64
     rank  2: 4.70
     rank  3: 4.76
     rank  4: 5.47
     rank  5: 5.02
     rank  6: 5.69
     rank  7: 5.57
     rank  8: 4.56
     rank  9: 4.82
     rank 10: 3.49
     rank 11: 3.46
  backward-recv:
     rank  0: 632.89
     rank  1: 635.48
     rank  2: 632.95
     rank  3: 633.52
     rank  4: 237.48
     rank  5: 239.01
     rank  6: 238.93
     rank  7: 238.29
     rank  8: 120.23
     rank  9: 118.80
     rank 10: 118.28
     rank 11: 117.02
  backward-send:
     rank  4: 8.10
     rank  5: 7.51
     rank  6: 7.47
     rank  7: 7.97
     rank  8: 8.87
     rank  9: 9.80
     rank 10: 9.90
     rank 11: 9.51
     rank 12: 5.01
     rank 13: 4.76
     rank 14: 4.76
     rank 15: 3.48
  forward-send-backward-recv:
     rank  0: 814.85
     rank  1: 813.09
     rank  2: 799.77
     rank  3: 798.46
     rank  4: 480.33
     rank  5: 481.01
     rank  6: 494.32
     rank  7: 494.01
     rank  8: 496.14
     rank  9: 487.98
     rank 10: 496.06
     rank 11: 496.64
  backward-send-forward-recv:
     rank  4: 16.39
     rank  5: 14.84
     rank  6: 15.81
     rank  7: 14.42
     rank  8: 33.71
     rank  9: 34.22
     rank 10: 33.79
     rank 11: 34.09
     rank 12: 64.55
     rank 13: 55.80
     rank 14: 57.29
     rank 15: 57.84
  layernorm-grads-all-reduce:
     rank  0: 0.14
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.04
     rank 12: 0.03
     rank 13: 0.04
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.24
     rank  1: 0.06
     rank  2: 0.06
     rank  3: 0.06
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.04
     rank 12: 0.08
     rank 13: 0.10
     rank 14: 0.09
     rank 15: 0.07
  all-grads-sync:
     rank  0: 31.81
     rank  1: 31.56
     rank  2: 31.90
     rank  3: 31.65
     rank  4: 488.61
     rank  5: 488.65
     rank  6: 488.62
     rank  7: 488.65
     rank  8: 437.18
     rank  9: 437.19
     rank 10: 437.19
     rank 11: 437.13
     rank 12: 471.34
     rank 13: 450.51
     rank 14: 471.27
     rank 15: 450.26
  optimizer-copy-to-main-grad:
     rank  0: 0.16
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.04
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.05
     rank 11: 0.08
     rank 12: 0.05
     rank 13: 0.05
     rank 14: 0.06
     rank 15: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.05
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 7.19
     rank  1: 6.08
     rank  2: 6.05
     rank  3: 6.10
     rank  4: 60.28
     rank  5: 60.20
     rank  6: 60.14
     rank  7: 60.15
     rank  8: 53.52
     rank  9: 53.65
     rank 10: 53.69
     rank 11: 53.71
     rank 12: 54.43
     rank 13: 54.50
     rank 14: 54.46
     rank 15: 54.42
  optimizer:
     rank  0: 8.18
     rank  1: 7.07
     rank  2: 7.01
     rank  3: 7.10
     rank  4: 61.24
     rank  5: 61.15
     rank  6: 61.10
     rank  7: 61.10
     rank  8: 54.48
     rank  9: 54.60
     rank 10: 54.65
     rank 11: 54.66
     rank 12: 55.40
     rank 13: 55.45
     rank 14: 55.42
     rank 15: 55.38
 [2024-12-24 22:26:53] iteration        8/      10 | consumed samples:          128 | elapsed time per iteration (ms): 2771.8 | learning rate: 6.000000E-06 | global batch size:    16 | lm loss: 2.115960E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2673.32
     rank  1: 2673.14
     rank  2: 2673.23
     rank  3: 2673.14
     rank  4: 2678.32
     rank  5: 2678.40
     rank  6: 2678.30
     rank  7: 2678.32
     rank  8: 2677.72
     rank  9: 2677.68
     rank 10: 2677.75
     rank 11: 2677.71
     rank 12: 2677.94
     rank 13: 2677.94
     rank 14: 2678.02
     rank 15: 2677.90
  forward-compute:
     rank  0: 670.92
     rank  1: 675.71
     rank  2: 682.57
     rank  3: 685.53
     rank  4: 537.13
     rank  5: 539.41
     rank  6: 523.79
     rank  7: 525.89
     rank  8: 491.30
     rank  9: 491.90
     rank 10: 503.05
     rank 11: 503.43
     rank 12: 681.40
     rank 13: 689.60
     rank 14: 696.29
     rank 15: 696.60
  backward-compute:
     rank  0: 47.76
     rank  1: 42.83
     rank  2: 46.28
     rank  3: 42.78
     rank  4: 755.98
     rank  5: 754.67
     rank  6: 752.92
     rank  7: 752.90
     rank  8: 725.77
     rank  9: 735.46
     rank 10: 729.35
     rank 11: 728.18
     rank 12: 990.06
     rank 13: 988.10
     rank 14: 1006.65
     rank 15: 1006.04
  pure-backward-compute:
     rank  0: 47.26
     rank  1: 42.53
     rank  2: 45.86
     rank  3: 42.34
     rank  4: 755.41
     rank  5: 754.10
     rank  6: 752.48
     rank  7: 752.53
     rank  8: 724.47
     rank  9: 734.36
     rank 10: 727.96
     rank 11: 727.46
     rank 12: 987.59
     rank 13: 986.59
     rank 14: 1004.94
     rank 15: 1004.56
  batch-generator:
     rank  0: 31.64
     rank  1: 35.65
     rank  2: 28.22
     rank  3: 31.00
     rank  4: 36.23
     rank  5: 38.00
     rank  6: 23.76
     rank  7: 24.81
     rank  8: 24.25
     rank  9: 24.48
     rank 10: 28.69
     rank 11: 28.60
     rank 12: 37.70
     rank 13: 44.95
     rank 14: 30.02
     rank 15: 30.67
  forward-recv:
     rank  4: 135.76
     rank  5: 136.25
     rank  6: 125.43
     rank  7: 125.32
     rank  8: 191.79
     rank  9: 191.40
     rank 10: 175.33
     rank 11: 175.64
     rank 12: 237.64
     rank 13: 237.69
     rank 14: 216.44
     rank 15: 216.33
  forward-send:
     rank  0: 4.80
     rank  1: 4.24
     rank  2: 4.68
     rank  3: 4.65
     rank  4: 5.49
     rank  5: 4.94
     rank  6: 5.61
     rank  7: 5.71
     rank  8: 4.97
     rank  9: 4.97
     rank 10: 3.34
     rank 11: 3.27
  backward-recv:
     rank  0: 635.14
     rank  1: 639.16
     rank  2: 636.52
     rank  3: 638.35
     rank  4: 240.61
     rank  5: 240.91
     rank  6: 241.34
     rank  7: 241.60
     rank  8: 120.45
     rank  9: 116.70
     rank 10: 119.02
     rank 11: 118.71
  backward-send:
     rank  4: 7.19
     rank  5: 7.23
     rank  6: 7.96
     rank  7: 7.87
     rank  8: 8.47
     rank  9: 8.92
     rank 10: 9.16
     rank 11: 9.26
     rank 12: 4.30
     rank 13: 1.72
     rank 14: 4.13
     rank 15: 3.90
  forward-send-backward-recv:
     rank  0: 820.36
     rank  1: 817.49
     rank  2: 809.86
     rank  3: 808.46
     rank  4: 471.38
     rank  5: 472.13
     rank  6: 498.78
     rank  7: 497.23
     rank  8: 495.14
     rank  9: 488.93
     rank 10: 501.34
     rank 11: 502.40
  backward-send-forward-recv:
     rank  4: 16.75
     rank  5: 15.52
     rank  6: 16.01
     rank  7: 14.90
     rank  8: 34.19
     rank  9: 34.36
     rank 10: 33.19
     rank 11: 33.62
     rank 12: 63.81
     rank 13: 57.94
     rank 14: 55.14
     rank 15: 56.22
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.06
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.10
     rank  1: 0.05
     rank  2: 0.05
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.04
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.07
     rank 13: 0.06
     rank 14: 0.08
     rank 15: 0.06
  all-grads-sync:
     rank  0: 31.26
     rank  1: 31.00
     rank  2: 31.33
     rank  3: 31.09
     rank  4: 489.49
     rank  5: 489.51
     rank  6: 489.50
     rank  7: 489.50
     rank  8: 442.56
     rank  9: 442.59
     rank 10: 442.55
     rank 11: 442.58
     rank 12: 474.33
     rank 13: 452.12
     rank 14: 474.35
     rank 15: 452.11
  optimizer-copy-to-main-grad:
     rank  0: 0.04
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.07
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.04
     rank 10: 0.06
     rank 11: 0.05
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.06
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 6.25
     rank  1: 6.00
     rank  2: 6.01
     rank  3: 5.98
     rank  4: 60.21
     rank  5: 60.45
     rank  6: 60.19
     rank  7: 60.22
     rank  8: 53.56
     rank  9: 53.61
     rank 10: 53.72
     rank 11: 53.63
     rank 12: 54.29
     rank 13: 54.41
     rank 14: 54.40
     rank 15: 54.32
  optimizer:
     rank  0: 6.88
     rank  1: 6.62
     rank  2: 6.63
     rank  3: 6.60
     rank  4: 60.84
     rank  5: 61.08
     rank  6: 60.82
     rank  7: 60.85
     rank  8: 54.19
     rank  9: 54.24
     rank 10: 54.35
     rank 11: 54.27
     rank 12: 54.92
     rank 13: 55.05
     rank 14: 55.03
     rank 15: 54.95
 [2024-12-24 22:26:56] iteration        9/      10 | consumed samples:          144 | elapsed time per iteration (ms): 2754.5 | learning rate: 6.750000E-06 | global batch size:    16 | lm loss: 1.728295E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2662.13
     rank  1: 2661.52
     rank  2: 2661.75
     rank  3: 2661.52
     rank  4: 2666.74
     rank  5: 2666.51
     rank  6: 2666.72
     rank  7: 2666.63
     rank  8: 2666.12
     rank  9: 2666.01
     rank 10: 2666.13
     rank 11: 2666.07
     rank 12: 2666.31
     rank 13: 2666.23
     rank 14: 2666.37
     rank 15: 2666.21
  forward-compute:
     rank  0: 640.00
     rank  1: 643.82
     rank  2: 691.59
     rank  3: 696.26
     rank  4: 527.13
     rank  5: 528.93
     rank  6: 522.11
     rank  7: 523.65
     rank  8: 489.67
     rank  9: 491.99
     rank 10: 503.33
     rank 11: 503.54
     rank 12: 685.25
     rank 13: 693.30
     rank 14: 680.09
     rank 15: 680.57
  backward-compute:
     rank  0: 47.27
     rank  1: 42.82
     rank  2: 47.86
     rank  3: 42.77
     rank  4: 756.72
     rank  5: 755.39
     rank  6: 753.28
     rank  7: 752.87
     rank  8: 726.64
     rank  9: 734.49
     rank 10: 729.55
     rank 11: 729.42
     rank 12: 992.70
     rank 13: 991.69
     rank 14: 1004.06
     rank 15: 1004.18
  pure-backward-compute:
     rank  0: 46.78
     rank  1: 42.52
     rank  2: 47.39
     rank  3: 42.34
     rank  4: 756.03
     rank  5: 755.04
     rank  6: 752.86
     rank  7: 752.51
     rank  8: 725.30
     rank  9: 733.47
     rank 10: 728.61
     rank 11: 728.63
     rank 12: 990.66
     rank 13: 990.65
     rank 14: 1002.59
     rank 15: 1002.97
  batch-generator:
     rank  0: 29.28
     rank  1: 33.31
     rank  2: 29.74
     rank  3: 34.32
     rank  4: 29.06
     rank  5: 30.18
     rank  6: 21.69
     rank  7: 22.49
     rank  8: 22.34
     rank  9: 24.36
     rank 10: 28.43
     rank 11: 28.55
     rank 12: 39.04
     rank 13: 46.96
     rank 14: 30.47
     rank 15: 30.05
  forward-recv:
     rank  4: 108.10
     rank  5: 109.80
     rank  6: 127.95
     rank  7: 128.38
     rank  8: 166.09
     rank  9: 164.85
     rank 10: 178.00
     rank 11: 177.74
     rank 12: 224.66
     rank 13: 224.37
     rank 14: 225.31
     rank 15: 225.31
  forward-send:
     rank  0: 5.94
     rank  1: 5.78
     rank  2: 6.13
     rank  3: 5.99
     rank  4: 7.22
     rank  5: 5.83
     rank  6: 7.62
     rank  7: 7.23
     rank  8: 6.12
     rank  9: 5.74
     rank 10: 5.33
     rank 11: 5.40
  backward-recv:
     rank  0: 633.64
     rank  1: 636.75
     rank  2: 635.55
     rank  3: 637.13
     rank  4: 238.29
     rank  5: 240.63
     rank  6: 240.23
     rank  7: 240.78
     rank  8: 121.05
     rank  9: 118.47
     rank 10: 120.66
     rank 11: 120.37
  backward-send:
     rank  4: 7.89
     rank  5: 6.34
     rank  6: 7.90
     rank  7: 7.73
     rank  8: 8.46
     rank  9: 9.07
     rank 10: 9.21
     rank 11: 9.28
     rank 12: 4.37
     rank 13: 1.99
     rank 14: 4.08
     rank 15: 4.10
  forward-send-backward-recv:
     rank  0: 844.86
     rank  1: 842.38
     rank  2: 791.37
     rank  3: 790.24
     rank  4: 500.19
     rank  5: 501.91
     rank  6: 489.83
     rank  7: 489.62
     rank  8: 508.53
     rank  9: 503.14
     rank 10: 486.86
     rank 11: 487.32
  backward-send-forward-recv:
     rank  4: 16.28
     rank  5: 15.17
     rank  6: 15.70
     rank  7: 14.97
     rank  8: 34.75
     rank  9: 34.51
     rank 10: 33.94
     rank 11: 34.09
     rank 12: 63.38
     rank 13: 58.00
     rank 14: 57.78
     rank 15: 58.59
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.11
     rank  1: 0.05
     rank  2: 0.06
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.07
     rank 13: 0.06
     rank 14: 0.08
     rank 15: 0.05
  all-grads-sync:
     rank  0: 32.58
     rank  1: 32.23
     rank  2: 32.64
     rank  3: 32.31
     rank  4: 485.03
     rank  5: 485.05
     rank  6: 485.07
     rank  7: 485.05
     rank  8: 441.57
     rank  9: 441.62
     rank 10: 441.57
     rank 11: 442.15
     rank 12: 472.13
     rank 13: 451.74
     rank 14: 472.15
     rank 15: 451.76
  optimizer-copy-to-main-grad:
     rank  0: 0.15
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.04
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.04
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.04
     rank 13: 0.03
     rank 14: 0.06
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.06
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 7.08
     rank  1: 5.97
     rank  2: 6.11
     rank  3: 6.01
     rank  4: 60.17
     rank  5: 60.23
     rank  6: 60.25
     rank  7: 60.18
     rank  8: 53.54
     rank  9: 53.56
     rank 10: 53.66
     rank 11: 53.67
     rank 12: 54.31
     rank 13: 54.36
     rank 14: 54.35
     rank 15: 54.30
  optimizer:
     rank  0: 7.91
     rank  1: 6.79
     rank  2: 6.93
     rank  3: 6.83
     rank  4: 60.99
     rank  5: 61.05
     rank  6: 61.07
     rank  7: 60.99
     rank  8: 54.35
     rank  9: 54.37
     rank 10: 54.48
     rank 11: 54.48
     rank 12: 55.13
     rank 13: 55.18
     rank 14: 55.18
     rank 15: 55.12
 [2024-12-24 22:26:59] iteration       10/      10 | consumed samples:          160 | elapsed time per iteration (ms): 2738.6 | learning rate: 7.500000E-06 | global batch size:    16 | lm loss: 3.008001E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2645.57
     rank  1: 2645.13
     rank  2: 2645.43
     rank  3: 2645.20
     rank  4: 2650.59
     rank  5: 2650.22
     rank  6: 2650.52
     rank  7: 2650.18
     rank  8: 2649.91
     rank  9: 2649.53
     rank 10: 2649.89
     rank 11: 2649.59
     rank 12: 2650.61
     rank 13: 2649.79
     rank 14: 2650.44
     rank 15: 2649.73
  forward-compute:
     rank  0: 642.32
     rank  1: 645.55
     rank  2: 688.68
     rank  3: 690.83
     rank  4: 552.59
     rank  5: 557.10
     rank  6: 525.22
     rank  7: 525.56
     rank  8: 490.97
     rank  9: 492.87
     rank 10: 507.45
     rank 11: 507.46
     rank 12: 678.70
     rank 13: 689.25
     rank 14: 672.41
     rank 15: 674.22
  backward-compute:
     rank  0: 46.43
     rank  1: 43.98
     rank  2: 46.46
     rank  3: 43.12
     rank  4: 758.19
     rank  5: 759.05
     rank  6: 755.40
     rank  7: 754.07
     rank  8: 725.99
     rank  9: 734.93
     rank 10: 730.95
     rank 11: 731.99
     rank 12: 994.19
     rank 13: 993.23
     rank 14: 1005.34
     rank 15: 1004.76
  pure-backward-compute:
     rank  0: 45.84
     rank  1: 43.62
     rank  2: 46.08
     rank  3: 42.72
     rank  4: 757.00
     rank  5: 758.42
     rank  6: 754.98
     rank  7: 753.62
     rank  8: 724.65
     rank  9: 733.67
     rank 10: 729.96
     rank 11: 730.97
     rank 12: 992.16
     rank 13: 992.36
     rank 14: 1003.73
     rank 15: 1003.86
  batch-generator:
     rank  0: 30.39
     rank  1: 33.38
     rank  2: 28.89
     rank  3: 30.76
     rank  4: 42.35
     rank  5: 43.11
     rank  6: 24.11
     rank  7: 23.94
     rank  8: 22.83
     rank  9: 24.41
     rank 10: 28.83
     rank 11: 28.73
     rank 12: 33.31
     rank 13: 44.39
     rank 14: 28.79
     rank 15: 30.44
  forward-recv:
     rank  4: 108.32
     rank  5: 110.31
     rank  6: 129.46
     rank  7: 129.83
     rank  8: 165.26
     rank  9: 163.69
     rank 10: 177.86
     rank 11: 177.52
     rank 12: 217.38
     rank 13: 217.12
     rank 14: 220.36
     rank 15: 220.27
  forward-send:
     rank  0: 5.01
     rank  1: 5.11
     rank  2: 5.50
     rank  3: 5.36
     rank  4: 5.41
     rank  5: 3.90
     rank  6: 5.71
     rank  7: 5.38
     rank  8: 4.90
     rank  9: 4.56
     rank 10: 3.12
     rank 11: 3.26
  backward-recv:
     rank  0: 628.50
     rank  1: 630.73
     rank  2: 630.03
     rank  3: 631.08
     rank  4: 233.13
     rank  5: 232.88
     rank  6: 236.61
     rank  7: 235.84
     rank  8: 118.81
     rank  9: 118.29
     rank 10: 118.69
     rank 11: 118.70
  backward-send:
     rank  4: 8.11
     rank  5: 8.02
     rank  6: 7.35
     rank  7: 8.14
     rank  8: 8.39
     rank  9: 8.45
     rank 10: 8.75
     rank 11: 8.76
     rank 12: 6.02
     rank 13: 4.06
     rank 14: 4.61
     rank 15: 4.75
  forward-send-backward-recv:
     rank  0: 833.42
     rank  1: 829.32
     rank  2: 786.37
     rank  3: 786.48
     rank  4: 462.02
     rank  5: 462.63
     rank  6: 475.47
     rank  7: 475.68
     rank  8: 498.83
     rank  9: 490.92
     rank 10: 470.70
     rank 11: 470.04
  backward-send-forward-recv:
     rank  4: 15.97
     rank  5: 13.07
     rank  6: 13.92
     rank  7: 15.09
     rank  8: 35.27
     rank  9: 35.60
     rank 10: 34.37
     rank 11: 34.22
     rank 12: 60.65
     rank 13: 53.11
     rank 14: 54.35
     rank 15: 54.59
  layernorm-grads-all-reduce:
     rank  0: 0.14
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.06
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.07
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.18
     rank  1: 0.06
     rank  2: 0.05
     rank  3: 0.07
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.24
     rank 13: 0.07
     rank 14: 0.08
     rank 15: 0.06
  all-grads-sync:
     rank  0: 32.22
     rank  1: 31.92
     rank  2: 32.28
     rank  3: 32.01
     rank  4: 483.80
     rank  5: 483.89
     rank  6: 483.87
     rank  7: 483.90
     rank  8: 440.49
     rank  9: 440.45
     rank 10: 440.50
     rank 11: 440.45
     rank 12: 467.98
     rank 13: 446.52
     rank 14: 467.98
     rank 15: 446.50
  optimizer-copy-to-main-grad:
     rank  0: 0.06
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.05
     rank  5: 0.04
     rank  6: 0.03
     rank  7: 0.04
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.20
     rank 13: 0.03
     rank 14: 0.06
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 6.47
     rank  1: 6.15
     rank  2: 5.97
     rank  3: 6.04
     rank  4: 60.41
     rank  5: 60.23
     rank  6: 60.15
     rank  7: 60.26
     rank  8: 53.58
     rank  9: 53.55
     rank 10: 53.64
     rank 11: 53.64
     rank 12: 54.80
     rank 13: 54.37
     rank 14: 54.42
     rank 15: 54.32
  optimizer:
     rank  0: 7.38
     rank  1: 7.07
     rank  2: 6.88
     rank  3: 6.96
     rank  4: 61.34
     rank  5: 61.15
     rank  6: 61.07
     rank  7: 61.18
     rank  8: 54.49
     rank  9: 54.47
     rank 10: 54.56
     rank 11: 54.56
     rank 12: 55.71
     rank 13: 55.30
     rank 14: 55.34
     rank 15: 55.25
