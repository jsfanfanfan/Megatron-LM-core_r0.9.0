examples/multimodal/pretrain-freeze-llm-homo.sh: line 4: activate: No such file or directory
[2024-12-24 23:01:27,565] torch.distributed.run: [WARNING] 
[2024-12-24 23:01:27,565] torch.distributed.run: [WARNING] *****************************************
[2024-12-24 23:01:27,565] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-12-24 23:01:27,565] torch.distributed.run: [WARNING] *****************************************
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:8------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:8------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:8------
------num_pipeline_model_parallel_groups:4------
> setting tensorboard ...
WARNING: one_logger package is required to enable e2e metrics tracking. please go to https://confluence.nvidia.com/display/MLWFO/Package+Repositories for details to install it
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:8------
------num_pipeline_model_parallel_groups:4------
---Rank 13---Tensor Parallel Group GPUs: [1, 1]---Rank 15---Tensor Parallel Group GPUs: [1, 1]---Rank 12---Tensor Parallel Group GPUs: [0, 0]---Rank 14---Tensor Parallel Group GPUs: [0, 0]



---Rank 13---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
---Rank 15---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
---Rank 12---Pipeline Parallel Group GPUs: [3, 3, 3, 3]---Rank 14---Pipeline Parallel Group GPUs: [3, 3, 3, 3]

[rank15]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank12]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank13]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank14]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
 > number of parameters on (tensor, pipeline) model parallel rank (1, 3): 503353344
 > number of parameters on (tensor, pipeline) model parallel rank (0, 3): 503353344
INFO:megatron.core.distributed.param_and_grad_buffer:Number of buckets for gradient all-reduce / reduce-scatter: 1
Params for bucket 1 (503353344 elements):
	language_model.decoder.layers.2.mlp.linear_fc1.weight
	language_model.decoder.layers.1.mlp.linear_fc2.weight
	language_model.decoder.layers.1.self_attention.linear_proj.weight
	language_model.decoder.final_layernorm.weight
	language_model.decoder.layers.3.self_attention.linear_proj.weight
	language_model.decoder.layers.1.mlp.linear_fc1.weight
	language_model.decoder.layers.1.self_attention.linear_qkv.weight
	language_model.decoder.layers.0.mlp.linear_fc2.weight
	language_model.decoder.layers.0.mlp.linear_fc1.weight
	language_model.decoder.layers.0.self_attention.linear_proj.weight
	language_model.decoder.layers.3.mlp.linear_fc1.weight
	language_model.decoder.layers.2.pre_mlp_layernorm.weight
	language_model.decoder.layers.2.self_attention.linear_qkv.weight
	language_model.decoder.layers.2.self_attention.linear_proj.weight
	language_model.decoder.layers.1.input_layernorm.weight
	language_model.decoder.layers.1.pre_mlp_layernorm.weight
	language_model.decoder.layers.3.mlp.linear_fc2.weight
	language_model.decoder.layers.3.pre_mlp_layernorm.weight
	language_model.decoder.layers.2.mlp.linear_fc2.weight
	language_model.decoder.layers.2.input_layernorm.weight
	language_model.decoder.layers.0.input_layernorm.weight
	language_model.decoder.layers.3.self_attention.linear_qkv.weight
	language_model.decoder.layers.3.input_layernorm.weight
	language_model.decoder.layers.0.pre_mlp_layernorm.weight
	language_model.output_layer.weight
	language_model.decoder.layers.0.self_attention.linear_qkv.weight
rank=0, worker=0: shard_range=[pretrain-0.tar[0, 100), pretrain-0.tar[100, 200), pretrain-0.tar[200, 300), ...<1244>, pretrain-2.tar[4700, 4800), pretrain-2.tar[4800, 4900), pretrain-2.tar[4900, 5000)] sum(count)=125000
rank=0, worker=1: shard_range=[pretrain-2.tar[5000, 5100), pretrain-2.tar[5100, 5200), pretrain-2.tar[5200, 5300), ...<1244>, pretrain-30.tar[9700, 9800), pretrain-30.tar[9800, 9900), pretrain-30.tar[9900, 10000)] sum(count)=125000
rank=1, worker=0: shard_range=[pretrain-31.tar[0, 100), pretrain-31.tar[100, 200), pretrain-31.tar[200, 300), ...<1244>, pretrain-42.tar[4700, 4800), pretrain-42.tar[4800, 4900), pretrain-42.tar[4900, 5000)] sum(count)=125000
rank=1, worker=1: shard_range=[pretrain-42.tar[5000, 5100), pretrain-42.tar[5100, 5200), pretrain-42.tar[5200, 5300), ...<1244>, pretrain-53.tar[9700, 9800), pretrain-53.tar[9800, 9900), pretrain-53.tar[9900, 10000)] sum(count)=125000
rank=1, worker=0: shard_range=[pretrain-7.tar[936, 10000), pretrain-8.tar[0, 5468)] sum(count)=14532
rank=1, worker=1: shard_range=[pretrain-8.tar[5468, 10000), pretrain-9.tar[0, 10000)] sum(count)=14532
rank=0, worker=0: shard_range=[pretrain-54.tar[0, 10000), pretrain-55.tar[0, 4532)] sum(count)=14532
rank=0, worker=1: shard_range=[pretrain-55.tar[4532, 8128), pretrain-6.tar[0, 10000), pretrain-7.tar[0, 936)] sum(count)=14532
times across ranks (ms):
  model-and-optimizer-setup:
     rank  0: 74.88
     rank  1: 76.95
     rank  2: 51.06
     rank  3: 54.98
     rank  4: 29.60
     rank  5: 21.18
     rank  6: 29.68
     rank  7: 32.05
     rank  8: 33.66
     rank  9: 26.50
     rank 10: 26.42
     rank 11: 26.13
     rank 12: 27.90
     rank 13: 21.56
     rank 14: 27.94
     rank 15: 17.69
  train/valid/test-data-iterators-setup:
     rank  0: 1124.23
     rank  1: 1124.13
     rank  2: 1124.14
     rank  3: 1124.16
     rank  4: 1126.91
     rank  5: 1126.92
     rank  6: 1126.91
     rank  7: 1126.95
     rank  8: 1127.07
     rank  9: 1127.24
     rank 10: 1128.54
     rank 11: 1128.32
     rank 12: 1127.90
     rank 13: 1128.06
     rank 14: 1127.93
     rank 15: 1128.04
 [2024-12-24 23:02:02] iteration        1/      10 | consumed samples:           16 | elapsed time per iteration (ms): 12934.6 | learning rate: 7.500000E-07 | global batch size:    16 | lm loss: 7.019982E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
[Rank 13] (after 1 iterations) memory (MB) | allocated: 7792.8154296875 | max allocated: 9712.818359375 | reserved: 10418.0 | max reserved: 10418.0
stage4 GPU utialization:86.22885617342862 %
[Rank 12] (after 1 iterations) memory (MB) | allocated: 7792.8154296875 | max allocated: 9712.818359375 | reserved: 10406.0 | max reserved: 10406.0
times across ranks (ms):
  forward-backward:
     rank  0: 12853.34
     rank  1: 12853.34
     rank  2: 12853.31
     rank  3: 12853.44
     rank  4: 12857.59
     rank  5: 12857.51
     rank  6: 12857.61
     rank  7: 12857.55
     rank  8: 12857.11
     rank  9: 12856.96
     rank 10: 12857.12
     rank 11: 12856.99
     rank 12: 12857.70
     rank 13: 12857.62
     rank 14: 12857.69
     rank 15: 12857.67
  forward-compute:
     rank  0: 4329.35
     rank  1: 4327.47
     rank  2: 4181.81
     rank  3: 4173.98
     rank  4: 2920.45
     rank  5: 2917.64
     rank  6: 2864.27
     rank  7: 2856.31
     rank  8: 2655.13
     rank  9: 2656.31
     rank 10: 2667.66
     rank 11: 2666.04
     rank 12: 2535.38
     rank 13: 2543.39
     rank 14: 2724.26
     rank 15: 2735.22
  backward-compute:
     rank  0: 38.89
     rank  1: 37.55
     rank  2: 36.41
     rank  3: 35.47
     rank  4: 755.11
     rank  5: 754.08
     rank  6: 781.72
     rank  7: 781.09
     rank  8: 706.78
     rank  9: 711.61
     rank 10: 729.74
     rank 11: 736.90
     rank 12: 810.28
     rank 13: 806.60
     rank 14: 814.97
     rank 15: 812.67
  pure-backward-compute:
     rank  0: 38.49
     rank  1: 37.03
     rank  2: 35.99
     rank  3: 35.11
     rank  4: 754.45
     rank  5: 753.26
     rank  6: 780.96
     rank  7: 780.13
     rank  8: 705.83
     rank  9: 710.69
     rank 10: 728.88
     rank 11: 736.14
     rank 12: 807.55
     rank 13: 804.92
     rank 14: 813.13
     rank 15: 811.34
  batch-generator:
     rank  0: 1127.51
     rank  1: 1127.91
     rank  2: 1057.11
     rank  3: 1050.70
     rank  4: 1016.84
     rank  5: 1024.89
     rank  6: 979.82
     rank  7: 972.34
     rank  8: 1071.77
     rank  9: 1073.88
     rank 10: 1112.54
     rank 11: 1110.06
     rank 12: 854.15
     rank 13: 857.68
     rank 14: 994.50
     rank 15: 1001.67
  forward-recv:
     rank  4: 4119.42
     rank  5: 4122.51
     rank  6: 3999.87
     rank  7: 4007.84
     rank  8: 6549.50
     rank  9: 6548.30
     rank 10: 6355.98
     rank 11: 6354.90
     rank 12: 8760.56
     rank 13: 8760.24
     rank 14: 8566.15
     rank 15: 8566.12
  forward-send:
     rank  0: 4706.10
     rank  1: 4707.13
     rank  2: 4638.11
     rank  3: 4645.61
     rank  4: 2170.55
     rank  5: 2168.50
     rank  6: 2164.87
     rank  7: 2163.92
     rank  8: 27.54
     rank  9: 26.96
     rank 10: 26.48
     rank 11: 26.56
  backward-recv:
     rank  0: 530.45
     rank  1: 530.86
     rank  2: 520.34
     rank  3: 521.21
     rank  4: 174.27
     rank  5: 174.10
     rank  6: 159.77
     rank  7: 158.52
     rank  8: 91.23
     rank  9: 90.51
     rank 10: 88.18
     rank 11: 89.05
  backward-send:
     rank  4: 4.13
     rank  5: 4.46
     rank  6: 3.22
     rank  7: 4.04
     rank  8: 5.25
     rank  9: 5.46
     rank 10: 5.49
     rank 11: 5.30
     rank 12: 5.04
     rank 13: 4.41
     rank 14: 4.74
     rank 15: 4.68
  forward-send-backward-recv:
     rank  0: 2752.69
     rank  1: 2754.59
     rank  2: 2986.05
     rank  3: 2986.84
     rank  4: 2183.16
     rank  5: 2182.83
     rank  6: 2358.87
     rank  7: 2360.18
     rank  8: 2161.82
     rank  9: 2157.83
     rank 10: 2294.61
     rank 11: 2288.50
  backward-send-forward-recv:
     rank  4: 23.12
     rank  5: 25.02
     rank  6: 23.62
     rank  7: 23.90
     rank  8: 59.28
     rank  9: 59.99
     rank 10: 91.80
     rank 11: 93.60
     rank 12: 55.18
     rank 13: 51.89
     rank 14: 56.68
     rank 15: 49.29
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.04
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.04
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.08
     rank  2: 0.07
     rank  3: 0.08
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.04
     rank 11: 0.03
     rank 12: 0.08
     rank 13: 0.05
     rank 14: 0.08
     rank 15: 0.08
  all-grads-sync:
     rank  0: 89.56
     rank  1: 99.07
     rank  2: 89.55
     rank  3: 99.07
     rank  4: 478.02
     rank  5: 486.57
     rank  6: 478.03
     rank  7: 486.58
     rank  8: 425.45
     rank  9: 426.81
     rank 10: 425.45
     rank 11: 426.82
     rank 12: 415.99
     rank 13: 415.54
     rank 14: 415.99
     rank 15: 416.10
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.04
     rank  5: 0.04
     rank  6: 0.04
     rank  7: 0.04
     rank  8: 0.06
     rank  9: 0.05
     rank 10: 0.06
     rank 11: 0.05
     rank 12: 0.11
     rank 13: 0.08
     rank 14: 0.05
     rank 15: 0.11
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 4.08
     rank  1: 4.35
     rank  2: 4.08
     rank  3: 4.28
     rank  4: 59.98
     rank  5: 60.00
     rank  6: 59.93
     rank  7: 60.08
     rank  8: 56.75
     rank  9: 56.71
     rank 10: 56.81
     rank 11: 56.83
     rank 12: 72.20
     rank 13: 65.55
     rank 14: 64.39
     rank 15: 63.52
  optimizer:
     rank  0: 5.02
     rank  1: 5.30
     rank  2: 5.02
     rank  3: 5.23
     rank  4: 60.93
     rank  5: 60.94
     rank  6: 60.87
     rank  7: 61.02
     rank  8: 57.70
     rank  9: 57.77
     rank 10: 57.89
     rank 11: 57.78
     rank 12: 73.15
     rank 13: 66.49
     rank 14: 65.34
     rank 15: 64.47
 [2024-12-24 23:02:04] iteration        2/      10 | consumed samples:           32 | elapsed time per iteration (ms): 2385.2 | learning rate: 1.500000E-06 | global batch size:    16 | lm loss: 7.128254E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2301.65
     rank  1: 2301.58
     rank  2: 2301.67
     rank  3: 2301.61
     rank  4: 2306.01
     rank  5: 2306.07
     rank  6: 2306.01
     rank  7: 2306.21
     rank  8: 2305.44
     rank  9: 2305.46
     rank 10: 2305.46
     rank 11: 2305.51
     rank 12: 2306.03
     rank 13: 2305.95
     rank 14: 2306.13
     rank 15: 2305.95
  forward-compute:
     rank  0: 426.00
     rank  1: 426.07
     rank  2: 419.66
     rank  3: 418.01
     rank  4: 583.03
     rank  5: 582.56
     rank  6: 602.74
     rank  7: 599.62
     rank  8: 536.83
     rank  9: 537.76
     rank 10: 551.05
     rank 11: 549.88
     rank 12: 620.01
     rank 13: 621.79
     rank 14: 612.62
     rank 15: 616.07
  backward-compute:
     rank  0: 35.02
     rank  1: 33.36
     rank  2: 34.63
     rank  3: 33.34
     rank  4: 754.72
     rank  5: 756.02
     rank  6: 773.52
     rank  7: 775.55
     rank  8: 708.44
     rank  9: 709.88
     rank 10: 725.65
     rank 11: 726.91
     rank 12: 809.55
     rank 13: 808.89
     rank 14: 812.94
     rank 15: 812.65
  pure-backward-compute:
     rank  0: 34.64
     rank  1: 33.03
     rank  2: 34.27
     rank  3: 32.99
     rank  4: 754.23
     rank  5: 755.31
     rank  6: 772.95
     rank  7: 774.89
     rank  8: 707.37
     rank  9: 708.73
     rank 10: 724.44
     rank 11: 725.79
     rank 12: 807.47
     rank 13: 807.27
     rank 14: 810.82
     rank 15: 811.34
  batch-generator:
     rank  0: 23.50
     rank  1: 23.67
     rank  2: 23.17
     rank  3: 21.37
     rank  4: 23.79
     rank  5: 27.92
     rank  6: 27.93
     rank  7: 27.16
     rank  8: 29.32
     rank  9: 29.64
     rank 10: 30.31
     rank 11: 29.54
     rank 12: 34.53
     rank 13: 34.67
     rank 14: 28.97
     rank 15: 32.37
  forward-recv:
     rank  4: 60.41
     rank  5: 60.09
     rank  6: 60.79
     rank  7: 60.69
     rank  8: 136.04
     rank  9: 135.77
     rank 10: 139.36
     rank 11: 140.13
     rank 12: 199.10
     rank 13: 199.14
     rank 14: 204.18
     rank 15: 203.98
  forward-send:
     rank  0: 43.00
     rank  1: 43.05
     rank  2: 43.76
     rank  3: 44.88
     rank  4: 5.75
     rank  5: 5.30
     rank  6: 4.82
     rank  7: 5.44
     rank  8: 2.90
     rank  9: 2.82
     rank 10: 2.82
     rank 11: 2.72
  backward-recv:
     rank  0: 530.77
     rank  1: 531.76
     rank  2: 535.15
     rank  3: 535.23
     rank  4: 173.13
     rank  5: 172.47
     rank  6: 174.45
     rank  7: 173.63
     rank  8: 92.62
     rank  9: 91.83
     rank 10: 90.14
     rank 11: 89.68
  backward-send:
     rank  4: 3.67
     rank  5: 4.09
     rank  6: 4.02
     rank  7: 4.15
     rank  8: 5.25
     rank  9: 5.52
     rank 10: 5.33
     rank 11: 5.39
     rank 12: 4.83
     rank 13: 4.46
     rank 14: 4.95
     rank 15: 4.86
  forward-send-backward-recv:
     rank  0: 833.28
     rank  1: 834.12
     rank  2: 839.80
     rank  3: 841.94
     rank  4: 267.58
     rank  5: 267.06
     rank  6: 238.20
     rank  7: 236.80
     rank  8: 247.04
     rank  9: 246.47
     rank 10: 225.24
     rank 11: 223.49
  backward-send-forward-recv:
     rank  4: 12.80
     rank  5: 13.51
     rank  6: 8.68
     rank  7: 9.51
     rank  8: 35.92
     rank  9: 35.30
     rank 10: 31.52
     rank 11: 32.35
     rank 12: 41.80
     rank 13: 40.73
     rank 14: 41.00
     rank 15: 38.53
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.05
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.04
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.07
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.05
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.07
     rank 13: 0.05
     rank 14: 0.12
     rank 15: 0.07
  all-grads-sync:
     rank  0: 30.50
     rank  1: 30.41
     rank  2: 30.50
     rank  3: 30.43
     rank  4: 425.10
     rank  5: 424.85
     rank  6: 425.05
     rank  7: 424.93
     rank  8: 354.40
     rank  9: 354.75
     rank 10: 354.40
     rank 11: 354.64
     rank 12: 424.83
     rank 13: 424.72
     rank 14: 424.81
     rank 15: 424.76
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.08
     rank  5: 0.04
     rank  6: 0.04
     rank  7: 0.09
     rank  8: 0.05
     rank  9: 0.09
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.05
     rank 13: 0.05
     rank 14: 0.11
     rank 15: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 3.75
     rank  1: 3.76
     rank  2: 3.75
     rank  3: 3.89
     rank  4: 49.52
     rank  5: 49.44
     rank  6: 49.47
     rank  7: 49.78
     rank  8: 43.39
     rank  9: 43.50
     rank 10: 43.51
     rank 11: 43.54
     rank 12: 49.92
     rank 13: 49.80
     rank 14: 50.07
     rank 15: 49.89
  optimizer:
     rank  0: 4.64
     rank  1: 4.66
     rank  2: 4.64
     rank  3: 4.78
     rank  4: 50.40
     rank  5: 50.33
     rank  6: 50.36
     rank  7: 50.67
     rank  8: 44.28
     rank  9: 44.39
     rank 10: 44.43
     rank 11: 44.46
     rank 12: 50.82
     rank 13: 50.70
     rank 14: 51.09
     rank 15: 50.79
 [2024-12-24 23:02:07] iteration        3/      10 | consumed samples:           48 | elapsed time per iteration (ms): 2812.3 | learning rate: 2.250000E-06 | global batch size:    16 | lm loss: 6.875628E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2728.33
     rank  1: 2728.57
     rank  2: 2728.36
     rank  3: 2728.55
     rank  4: 2732.69
     rank  5: 2732.85
     rank  6: 2732.69
     rank  7: 2732.82
     rank  8: 2732.18
     rank  9: 2732.41
     rank 10: 2732.25
     rank 11: 2732.33
     rank 12: 2732.85
     rank 13: 2733.24
     rank 14: 2732.96
     rank 15: 2733.09
  forward-compute:
     rank  0: 393.02
     rank  1: 394.06
     rank  2: 392.92
     rank  3: 390.88
     rank  4: 575.70
     rank  5: 576.09
     rank  6: 605.55
     rank  7: 603.24
     rank  8: 541.03
     rank  9: 540.52
     rank 10: 551.23
     rank 11: 550.52
     rank 12: 622.37
     rank 13: 625.25
     rank 14: 614.47
     rank 15: 615.59
  backward-compute:
     rank  0: 34.19
     rank  1: 33.43
     rank  2: 34.01
     rank  3: 33.70
     rank  4: 750.85
     rank  5: 749.60
     rank  6: 782.80
     rank  7: 783.55
     rank  8: 709.20
     rank  9: 711.29
     rank 10: 725.61
     rank 11: 725.67
     rank 12: 808.82
     rank 13: 808.71
     rank 14: 814.98
     rank 15: 814.90
  pure-backward-compute:
     rank  0: 33.74
     rank  1: 33.09
     rank  2: 33.63
     rank  3: 33.38
     rank  4: 750.32
     rank  5: 749.11
     rank  6: 782.12
     rank  7: 782.80
     rank  8: 708.37
     rank  9: 710.24
     rank 10: 724.56
     rank 11: 724.84
     rank 12: 807.01
     rank 13: 806.99
     rank 14: 813.00
     rank 15: 813.60
  batch-generator:
     rank  0: 23.57
     rank  1: 24.00
     rank  2: 22.72
     rank  3: 20.26
     rank  4: 23.35
     rank  5: 25.73
     rank  6: 29.06
     rank  7: 27.49
     rank  8: 31.26
     rank  9: 29.61
     rank 10: 30.02
     rank 11: 29.62
     rank 12: 31.51
     rank 13: 33.84
     rank 14: 29.66
     rank 15: 30.05
  forward-recv:
     rank  4: 54.06
     rank  5: 53.71
     rank  6: 52.86
     rank  7: 53.01
     rank  8: 130.51
     rank  9: 130.58
     rank 10: 133.84
     rank 11: 134.14
     rank 12: 193.48
     rank 13: 193.54
     rank 14: 198.40
     rank 15: 198.30
  forward-send:
     rank  0: 48.47
     rank  1: 48.29
     rank  2: 54.59
     rank  3: 56.31
     rank  4: 5.55
     rank  5: 5.57
     rank  6: 4.62
     rank  7: 5.28
     rank  8: 2.87
     rank  9: 2.86
     rank 10: 2.84
     rank 11: 2.74
  backward-recv:
     rank  0: 534.72
     rank  1: 535.05
     rank  2: 533.19
     rank  3: 533.05
     rank  4: 175.51
     rank  5: 176.70
     rank  6: 167.19
     rank  7: 167.78
     rank  8: 94.63
     rank  9: 93.95
     rank 10: 91.67
     rank 11: 92.05
  backward-send:
     rank  4: 4.15
     rank  5: 3.93
     rank  6: 3.73
     rank  7: 3.81
     rank  8: 5.43
     rank  9: 5.82
     rank 10: 6.04
     rank 11: 5.87
     rank 12: 4.98
     rank 13: 4.56
     rank 14: 5.11
     rank 15: 4.91
  forward-send-backward-recv:
     rank  0: 855.84
     rank  1: 856.11
     rank  2: 854.39
     rank  3: 855.79
     rank  4: 280.86
     rank  5: 281.46
     rank  6: 237.94
     rank  7: 237.19
     rank  8: 243.66
     rank  9: 242.29
     rank 10: 222.65
     rank 11: 222.59
  backward-send-forward-recv:
     rank  4: 13.06
     rank  5: 13.11
     rank  6: 7.87
     rank  7: 8.51
     rank  8: 36.21
     rank  9: 36.31
     rank 10: 32.75
     rank 11: 33.40
     rank 12: 43.12
     rank 13: 40.33
     rank 14: 40.28
     rank 15: 39.82
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.04
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.08
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.08
     rank 13: 0.19
     rank 14: 0.09
     rank 15: 0.08
  all-grads-sync:
     rank  0: 30.46
     rank  1: 30.47
     rank  2: 30.42
     rank  3: 30.43
     rank  4: 422.17
     rank  5: 422.16
     rank  6: 422.15
     rank  7: 422.17
     rank  8: 726.29
     rank  9: 726.18
     rank 10: 726.31
     rank 11: 726.17
     rank 12: 855.22
     rank 13: 855.22
     rank 14: 855.17
     rank 15: 855.26
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.04
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.04
     rank  8: 0.06
     rank  9: 0.07
     rank 10: 0.13
     rank 11: 0.12
     rank 12: 0.06
     rank 13: 0.11
     rank 14: 0.13
     rank 15: 0.06
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 3.76
     rank  1: 3.77
     rank  2: 3.76
     rank  3: 3.77
     rank  4: 49.50
     rank  5: 49.49
     rank  6: 49.43
     rank  7: 49.47
     rank  8: 43.59
     rank  9: 43.76
     rank 10: 43.83
     rank 11: 43.67
     rank 12: 50.14
     rank 13: 50.43
     rank 14: 50.34
     rank 15: 50.12
  optimizer:
     rank  0: 4.81
     rank  1: 4.83
     rank  2: 4.80
     rank  3: 4.81
     rank  4: 50.54
     rank  5: 50.53
     rank  6: 50.48
     rank  7: 50.61
     rank  8: 44.63
     rank  9: 44.80
     rank 10: 44.86
     rank 11: 44.71
     rank 12: 51.18
     rank 13: 51.46
     rank 14: 51.38
     rank 15: 51.16
 [2024-12-24 23:02:10] iteration        4/      10 | consumed samples:           64 | elapsed time per iteration (ms): 2842.9 | learning rate: 3.000000E-06 | global batch size:    16 | lm loss: 2.540079E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2756.00
     rank  1: 2755.72
     rank  2: 2755.91
     rank  3: 2755.72
     rank  4: 2760.23
     rank  5: 2760.05
     rank  6: 2760.19
     rank  7: 2760.17
     rank  8: 2759.73
     rank  9: 2759.75
     rank 10: 2759.63
     rank 11: 2760.02
     rank 12: 2760.29
     rank 13: 2760.22
     rank 14: 2760.30
     rank 15: 2760.12
  forward-compute:
     rank  0: 445.18
     rank  1: 445.42
     rank  2: 390.19
     rank  3: 388.97
     rank  4: 573.16
     rank  5: 571.53
     rank  6: 591.23
     rank  7: 589.09
     rank  8: 544.09
     rank  9: 545.78
     rank 10: 549.50
     rank 11: 549.92
     rank 12: 631.71
     rank 13: 632.73
     rank 14: 625.22
     rank 15: 626.37
  backward-compute:
     rank  0: 34.79
     rank  1: 34.46
     rank  2: 33.47
     rank  3: 32.75
     rank  4: 749.32
     rank  5: 749.95
     rank  6: 778.96
     rank  7: 779.70
     rank  8: 708.87
     rank  9: 710.56
     rank 10: 724.66
     rank 11: 725.35
     rank 12: 809.29
     rank 13: 809.06
     rank 14: 817.82
     rank 15: 817.94
  pure-backward-compute:
     rank  0: 34.27
     rank  1: 34.16
     rank  2: 33.10
     rank  3: 32.45
     rank  4: 748.85
     rank  5: 749.31
     rank  6: 778.46
     rank  7: 779.23
     rank  8: 707.81
     rank  9: 709.73
     rank 10: 723.78
     rank 11: 724.44
     rank 12: 806.94
     rank 13: 807.12
     rank 14: 815.75
     rank 15: 816.55
  batch-generator:
     rank  0: 30.17
     rank  1: 27.60
     rank  2: 24.82
     rank  3: 21.68
     rank  4: 22.94
     rank  5: 21.07
     rank  6: 21.61
     rank  7: 19.44
     rank  8: 34.21
     rank  9: 33.15
     rank 10: 29.72
     rank 11: 29.12
     rank 12: 35.59
     rank 13: 34.83
     rank 14: 38.78
     rank 15: 38.01
  forward-recv:
     rank  4: 52.07
     rank  5: 51.79
     rank  6: 52.21
     rank  7: 52.21
     rank  8: 130.04
     rank  9: 129.61
     rank 10: 131.63
     rank 11: 132.20
     rank 12: 195.02
     rank 13: 195.68
     rank 14: 197.12
     rank 15: 197.13
  forward-send:
     rank  0: 52.66
     rank  1: 53.46
     rank  2: 56.66
     rank  3: 57.67
     rank  4: 6.84
     rank  5: 7.57
     rank  6: 6.63
     rank  7: 7.03
     rank  8: 3.58
     rank  9: 3.76
     rank 10: 3.86
     rank 11: 3.89
  backward-recv:
     rank  0: 542.33
     rank  1: 543.15
     rank  2: 542.08
     rank  3: 542.60
     rank  4: 182.63
     rank  5: 181.04
     rank  6: 178.34
     rank  7: 178.51
     rank  8: 95.86
     rank  9: 95.32
     rank 10: 93.27
     rank 11: 93.28
  backward-send:
     rank  4: 3.59
     rank  5: 4.40
     rank  6: 4.27
     rank  7: 4.22
     rank  8: 5.39
     rank  9: 5.61
     rank 10: 5.75
     rank 11: 5.64
     rank 12: 5.09
     rank 13: 4.48
     rank 14: 4.60
     rank 15: 4.59
  forward-send-backward-recv:
     rank  0: 802.22
     rank  1: 801.42
     rank  2: 859.37
     rank  3: 860.44
     rank  4: 290.05
     rank  5: 289.63
     rank  6: 254.62
     rank  7: 254.59
     rank  8: 248.42
     rank  9: 247.68
     rank 10: 239.04
     rank 11: 237.15
  backward-send-forward-recv:
     rank  4: 12.95
     rank  5: 13.55
     rank  6: 9.29
     rank  7: 10.54
     rank  8: 38.12
     rank  9: 36.87
     rank 10: 31.10
     rank 11: 31.23
     rank 12: 43.35
     rank 13: 42.15
     rank 14: 40.59
     rank 15: 39.71
  layernorm-grads-all-reduce:
     rank  0: 0.09
     rank  1: 0.07
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.04
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.08
     rank  8: 0.04
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.05
     rank 12: 0.04
     rank 13: 0.03
     rank 14: 0.04
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.11
     rank  1: 0.09
     rank  2: 0.05
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.04
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.08
     rank 12: 0.11
     rank 13: 0.09
     rank 14: 0.12
     rank 15: 0.08
  all-grads-sync:
     rank  0: 31.09
     rank  1: 31.06
     rank  2: 31.11
     rank  3: 31.35
     rank  4: 417.46
     rank  5: 417.19
     rank  6: 417.47
     rank  7: 417.20
     rank  8: 362.33
     rank  9: 362.44
     rank 10: 362.37
     rank 11: 362.44
     rank 12: 869.69
     rank 13: 869.57
     rank 14: 869.70
     rank 15: 869.65
  optimizer-copy-to-main-grad:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.04
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.06
     rank  8: 0.11
     rank  9: 0.09
     rank 10: 0.06
     rank 11: 0.10
     rank 12: 0.12
     rank 13: 0.07
     rank 14: 0.08
     rank 15: 0.07
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.05
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.04
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 3.93
     rank  1: 3.85
     rank  2: 3.76
     rank  3: 3.80
     rank  4: 49.45
     rank  5: 49.43
     rank  6: 49.43
     rank  7: 49.61
     rank  8: 43.57
     rank  9: 43.49
     rank 10: 43.54
     rank 11: 44.49
     rank 12: 50.19
     rank 13: 50.27
     rank 14: 50.35
     rank 15: 50.17
  optimizer:
     rank  0: 5.23
     rank  1: 5.16
     rank  2: 5.06
     rank  3: 5.10
     rank  4: 50.76
     rank  5: 50.73
     rank  6: 50.74
     rank  7: 50.92
     rank  8: 44.88
     rank  9: 44.80
     rank 10: 44.85
     rank 11: 45.82
     rank 12: 51.50
     rank 13: 51.57
     rank 14: 51.64
     rank 15: 51.55
 [2024-12-24 23:02:12] iteration        5/      10 | consumed samples:           80 | elapsed time per iteration (ms): 2405.2 | learning rate: 3.750000E-06 | global batch size:    16 | lm loss: 2.158345E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2316.06
     rank  1: 2315.95
     rank  2: 2316.04
     rank  3: 2315.95
     rank  4: 2320.33
     rank  5: 2320.27
     rank  6: 2320.38
     rank  7: 2320.36
     rank  8: 2319.80
     rank  9: 2319.83
     rank 10: 2319.83
     rank 11: 2319.78
     rank 12: 2320.36
     rank 13: 2320.43
     rank 14: 2320.31
     rank 15: 2320.36
  forward-compute:
     rank  0: 400.04
     rank  1: 400.06
     rank  2: 411.76
     rank  3: 410.69
     rank  4: 582.79
     rank  5: 580.75
     rank  6: 604.90
     rank  7: 603.41
     rank  8: 539.67
     rank  9: 540.30
     rank 10: 554.98
     rank 11: 555.26
     rank 12: 622.11
     rank 13: 627.25
     rank 14: 622.17
     rank 15: 616.95
  backward-compute:
     rank  0: 34.88
     rank  1: 33.78
     rank  2: 33.82
     rank  3: 32.69
     rank  4: 751.51
     rank  5: 751.38
     rank  6: 781.31
     rank  7: 782.77
     rank  8: 707.41
     rank  9: 710.40
     rank 10: 730.90
     rank 11: 725.07
     rank 12: 811.37
     rank 13: 810.53
     rank 14: 814.21
     rank 15: 814.17
  pure-backward-compute:
     rank  0: 34.50
     rank  1: 33.47
     rank  2: 33.46
     rank  3: 32.29
     rank  4: 751.02
     rank  5: 750.68
     rank  6: 780.76
     rank  7: 782.14
     rank  8: 706.43
     rank  9: 709.58
     rank 10: 729.50
     rank 11: 723.67
     rank 12: 809.20
     rank 13: 808.97
     rank 14: 812.58
     rank 15: 812.84
  batch-generator:
     rank  0: 25.96
     rank  1: 24.57
     rank  2: 23.04
     rank  3: 21.85
     rank  4: 23.33
     rank  5: 28.98
     rank  6: 27.58
     rank  7: 27.89
     rank  8: 30.76
     rank  9: 30.02
     rank 10: 32.73
     rank 11: 32.94
     rank 12: 35.64
     rank 13: 39.92
     rank 14: 29.35
     rank 15: 25.25
  forward-recv:
     rank  4: 56.33
     rank  5: 56.97
     rank  6: 53.64
     rank  7: 53.21
     rank  8: 130.92
     rank  9: 131.53
     rank 10: 134.40
     rank 11: 134.76
     rank 12: 200.95
     rank 13: 200.36
     rank 14: 201.06
     rank 15: 201.06
  forward-send:
     rank  0: 50.77
     rank  1: 51.60
     rank  2: 58.16
     rank  3: 59.10
     rank  4: 7.59
     rank  5: 7.58
     rank  6: 7.54
     rank  7: 8.00
     rank  8: 5.17
     rank  9: 4.53
     rank 10: 5.09
     rank 11: 5.09
  backward-recv:
     rank  0: 538.51
     rank  1: 538.52
     rank  2: 536.38
     rank  3: 536.89
     rank  4: 180.14
     rank  5: 179.33
     rank  6: 169.53
     rank  7: 169.53
     rank  8: 91.90
     rank  9: 91.65
     rank 10: 89.16
     rank 11: 89.10
  backward-send:
     rank  4: 4.11
     rank  5: 4.35
     rank  6: 4.29
     rank  7: 4.42
     rank  8: 5.51
     rank  9: 5.73
     rank 10: 6.01
     rank 11: 6.02
     rank 12: 5.19
     rank 13: 4.91
     rank 14: 5.06
     rank 15: 5.18
  forward-send-backward-recv:
     rank  0: 851.50
     rank  1: 852.30
     rank  2: 839.39
     rank  3: 840.51
     rank  4: 274.27
     rank  5: 274.53
     rank  6: 242.80
     rank  7: 240.84
     rank  8: 256.65
     rank  9: 254.22
     rank 10: 226.63
     rank 11: 231.38
  backward-send-forward-recv:
     rank  4: 12.26
     rank  5: 13.15
     rank  6: 9.04
     rank  7: 9.83
     rank  8: 35.92
     rank  9: 35.59
     rank 10: 29.63
     rank 11: 29.30
     rank 12: 42.47
     rank 13: 39.22
     rank 14: 40.10
     rank 15: 45.44
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.07
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.05
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.04
     rank  2: 0.10
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.05
     rank 11: 0.02
     rank 12: 0.07
     rank 13: 0.08
     rank 14: 0.05
     rank 15: 0.06
  all-grads-sync:
     rank  0: 30.66
     rank  1: 30.65
     rank  2: 30.65
     rank  3: 30.64
     rank  4: 432.92
     rank  5: 432.87
     rank  6: 432.91
     rank  7: 432.92
     rank  8: 357.16
     rank  9: 357.52
     rank 10: 357.18
     rank 11: 357.48
     rank 12: 424.12
     rank 13: 424.35
     rank 14: 424.11
     rank 15: 424.34
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.04
     rank  7: 0.04
     rank  8: 0.11
     rank  9: 0.10
     rank 10: 0.10
     rank 11: 0.05
     rank 12: 0.05
     rank 13: 0.10
     rank 14: 0.04
     rank 15: 0.06
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 3.81
     rank  1: 3.80
     rank  2: 3.90
     rank  3: 3.76
     rank  4: 49.47
     rank  5: 49.45
     rank  6: 49.53
     rank  7: 49.57
     rank  8: 43.50
     rank  9: 43.37
     rank 10: 43.58
     rank 11: 43.69
     rank 12: 50.00
     rank 13: 50.57
     rank 14: 49.81
     rank 15: 50.00
  optimizer:
     rank  0: 4.52
     rank  1: 4.51
     rank  2: 4.61
     rank  3: 4.47
     rank  4: 50.18
     rank  5: 50.22
     rank  6: 50.25
     rank  7: 50.28
     rank  8: 44.22
     rank  9: 44.09
     rank 10: 44.31
     rank 11: 44.40
     rank 12: 50.72
     rank 13: 51.29
     rank 14: 50.52
     rank 15: 50.72
 [2024-12-24 23:02:15] iteration        6/      10 | consumed samples:           96 | elapsed time per iteration (ms): 2388.9 | learning rate: 4.500000E-06 | global batch size:    16 | lm loss: 2.100175E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2305.94
     rank  1: 2306.08
     rank  2: 2305.91
     rank  3: 2306.06
     rank  4: 2310.30
     rank  5: 2310.40
     rank  6: 2310.29
     rank  7: 2310.38
     rank  8: 2309.77
     rank  9: 2309.85
     rank 10: 2309.71
     rank 11: 2309.83
     rank 12: 2310.32
     rank 13: 2310.56
     rank 14: 2310.29
     rank 15: 2310.47
  forward-compute:
     rank  0: 398.49
     rank  1: 401.45
     rank  2: 404.10
     rank  3: 403.85
     rank  4: 580.12
     rank  5: 581.38
     rank  6: 600.76
     rank  7: 600.20
     rank  8: 540.26
     rank  9: 539.91
     rank 10: 553.47
     rank 11: 553.03
     rank 12: 614.58
     rank 13: 616.88
     rank 14: 611.17
     rank 15: 611.85
  backward-compute:
     rank  0: 35.43
     rank  1: 34.46
     rank  2: 34.21
     rank  3: 33.92
     rank  4: 751.45
     rank  5: 751.41
     rank  6: 777.80
     rank  7: 778.84
     rank  8: 712.85
     rank  9: 713.20
     rank 10: 728.11
     rank 11: 728.32
     rank 12: 812.76
     rank 13: 812.79
     rank 14: 817.73
     rank 15: 818.00
  pure-backward-compute:
     rank  0: 35.03
     rank  1: 34.16
     rank  2: 33.75
     rank  3: 33.57
     rank  4: 750.88
     rank  5: 750.55
     rank  6: 777.03
     rank  7: 778.33
     rank  8: 711.58
     rank  9: 712.07
     rank 10: 727.14
     rank 11: 726.85
     rank 12: 810.40
     rank 13: 810.95
     rank 14: 816.07
     rank 15: 816.55
  batch-generator:
     rank  0: 25.47
     rank  1: 26.92
     rank  2: 27.20
     rank  3: 24.95
     rank  4: 27.81
     rank  5: 29.92
     rank  6: 29.96
     rank  7: 32.45
     rank  8: 29.86
     rank  9: 29.09
     rank 10: 31.91
     rank 11: 32.26
     rank 12: 31.74
     rank 13: 33.03
     rank 14: 23.35
     rank 15: 25.00
  forward-recv:
     rank  4: 55.68
     rank  5: 55.45
     rank  6: 55.31
     rank  7: 55.32
     rank  8: 134.26
     rank  9: 134.26
     rank 10: 135.82
     rank 11: 136.36
     rank 12: 201.28
     rank 13: 201.21
     rank 14: 202.18
     rank 15: 202.03
  forward-send:
     rank  0: 56.18
     rank  1: 54.06
     rank  2: 60.53
     rank  3: 61.16
     rank  4: 9.33
     rank  5: 7.67
     rank  6: 7.73
     rank  7: 7.98
     rank  8: 4.79
     rank  9: 4.71
     rank 10: 4.63
     rank 11: 4.67
  backward-recv:
     rank  0: 534.87
     rank  1: 535.56
     rank  2: 533.68
     rank  3: 534.09
     rank  4: 176.32
     rank  5: 175.53
     rank  6: 169.68
     rank  7: 170.27
     rank  8: 91.71
     rank  9: 92.39
     rank 10: 90.39
     rank 11: 90.47
  backward-send:
     rank  4: 3.72
     rank  5: 4.54
     rank  6: 4.54
     rank  7: 4.10
     rank  8: 7.14
     rank  9: 7.28
     rank 10: 7.68
     rank 11: 7.75
     rank 12: 4.49
     rank 13: 5.34
     rank 14: 5.01
     rank 15: 4.99
  forward-send-backward-recv:
     rank  0: 844.78
     rank  1: 845.15
     rank  2: 841.77
     rank  3: 841.87
     rank  4: 272.91
     rank  5: 273.37
     rank  6: 242.44
     rank  7: 242.17
     rank  8: 241.80
     rank  9: 241.23
     rank 10: 219.34
     rank 11: 218.38
  backward-send-forward-recv:
     rank  4: 12.78
     rank  5: 13.31
     rank  6: 9.22
     rank  7: 9.21
     rank  8: 35.60
     rank  9: 36.09
     rank 10: 31.70
     rank 11: 31.69
     rank 12: 42.33
     rank 13: 40.75
     rank 14: 40.91
     rank 15: 40.12
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.06
     rank 14: 0.02
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.07
     rank 13: 0.15
     rank 14: 0.05
     rank 15: 0.07
  all-grads-sync:
     rank  0: 32.08
     rank  1: 32.14
     rank  2: 32.05
     rank  3: 32.09
     rank  4: 428.11
     rank  5: 427.70
     rank  6: 428.10
     rank  7: 427.72
     rank  8: 356.04
     rank  9: 356.41
     rank 10: 356.01
     rank 11: 356.38
     rank 12: 414.39
     rank 13: 414.48
     rank 14: 414.42
     rank 15: 414.43
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.04
     rank  7: 0.03
     rank  8: 0.06
     rank  9: 0.05
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.05
     rank 13: 0.09
     rank 14: 0.04
     rank 15: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 3.77
     rank  1: 3.75
     rank  2: 3.76
     rank  3: 3.83
     rank  4: 49.47
     rank  5: 49.45
     rank  6: 49.54
     rank  7: 49.46
     rank  8: 43.46
     rank  9: 43.44
     rank 10: 43.47
     rank 11: 43.50
     rank 12: 49.94
     rank 13: 50.16
     rank 14: 49.78
     rank 15: 49.91
  optimizer:
     rank  0: 4.47
     rank  1: 4.45
     rank  2: 4.46
     rank  3: 4.53
     rank  4: 50.18
     rank  5: 50.15
     rank  6: 50.25
     rank  7: 50.16
     rank  8: 44.17
     rank  9: 44.15
     rank 10: 44.19
     rank 11: 44.21
     rank 12: 50.65
     rank 13: 50.86
     rank 14: 50.48
     rank 15: 50.62
 [2024-12-24 23:02:17] iteration        7/      10 | consumed samples:          112 | elapsed time per iteration (ms): 2396.4 | learning rate: 5.250000E-06 | global batch size:    16 | lm loss: 3.791330E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2313.09
     rank  1: 2312.99
     rank  2: 2313.11
     rank  3: 2312.99
     rank  4: 2317.36
     rank  5: 2317.33
     rank  6: 2317.36
     rank  7: 2317.41
     rank  8: 2316.87
     rank  9: 2316.77
     rank 10: 2316.83
     rank 11: 2316.79
     rank 12: 2317.38
     rank 13: 2317.40
     rank 14: 2317.36
     rank 15: 2317.36
  forward-compute:
     rank  0: 402.92
     rank  1: 402.31
     rank  2: 396.96
     rank  3: 398.62
     rank  4: 586.32
     rank  5: 584.12
     rank  6: 596.22
     rank  7: 595.44
     rank  8: 538.94
     rank  9: 540.32
     rank 10: 550.93
     rank 11: 551.49
     rank 12: 622.34
     rank 13: 623.35
     rank 14: 622.24
     rank 15: 621.06
  backward-compute:
     rank  0: 35.91
     rank  1: 34.83
     rank  2: 35.06
     rank  3: 32.79
     rank  4: 752.31
     rank  5: 754.17
     rank  6: 776.01
     rank  7: 778.03
     rank  8: 712.38
     rank  9: 713.29
     rank 10: 728.10
     rank 11: 727.76
     rank 12: 813.80
     rank 13: 813.68
     rank 14: 814.81
     rank 15: 815.17
  pure-backward-compute:
     rank  0: 35.51
     rank  1: 34.52
     rank  2: 34.66
     rank  3: 32.46
     rank  4: 751.73
     rank  5: 753.07
     rank  6: 775.56
     rank  7: 777.40
     rank  8: 711.40
     rank  9: 712.27
     rank 10: 727.30
     rank 11: 726.37
     rank 12: 812.03
     rank 13: 812.22
     rank 14: 813.43
     rank 15: 813.87
  batch-generator:
     rank  0: 24.36
     rank  1: 22.60
     rank  2: 22.81
     rank  3: 23.66
     rank  4: 24.78
     rank  5: 27.67
     rank  6: 25.47
     rank  7: 26.72
     rank  8: 28.65
     rank  9: 29.09
     rank 10: 29.47
     rank 11: 30.43
     rank 12: 37.63
     rank 13: 36.28
     rank 14: 23.69
     rank 15: 23.63
  forward-recv:
     rank  4: 54.13
     rank  5: 54.32
     rank  6: 51.71
     rank  7: 51.53
     rank  8: 131.81
     rank  9: 132.14
     rank 10: 134.87
     rank 11: 133.49
     rank 12: 197.96
     rank 13: 197.91
     rank 14: 199.07
     rank 15: 199.08
  forward-send:
     rank  0: 49.56
     rank  1: 50.48
     rank  2: 58.68
     rank  3: 57.18
     rank  4: 7.50
     rank  5: 7.81
     rank  6: 8.13
     rank  7: 6.91
     rank  8: 4.40
     rank  9: 4.38
     rank 10: 4.40
     rank 11: 4.36
  backward-recv:
     rank  0: 538.23
     rank  1: 539.15
     rank  2: 540.13
     rank  3: 540.86
     rank  4: 177.81
     rank  5: 177.06
     rank  6: 173.66
     rank  7: 172.94
     rank  8: 88.76
     rank  9: 88.43
     rank 10: 88.04
     rank 11: 87.69
  backward-send:
     rank  4: 3.60
     rank  5: 4.54
     rank  6: 3.14
     rank  7: 4.25
     rank  8: 8.21
     rank  9: 8.64
     rank 10: 8.84
     rank 11: 8.85
     rank 12: 4.72
     rank 13: 4.54
     rank 14: 5.07
     rank 15: 4.94
  forward-send-backward-recv:
     rank  0: 848.61
     rank  1: 849.63
     rank  2: 849.22
     rank  3: 851.15
     rank  4: 272.99
     rank  5: 271.27
     rank  6: 256.05
     rank  7: 255.78
     rank  8: 251.33
     rank  9: 250.79
     rank 10: 230.40
     rank 11: 231.32
  backward-send-forward-recv:
     rank  4: 13.01
     rank  5: 13.64
     rank  6: 8.10
     rank  7: 8.98
     rank  8: 37.72
     rank  9: 36.57
     rank 10: 31.13
     rank 11: 31.10
     rank 12: 42.77
     rank 13: 42.01
     rank 14: 41.41
     rank 15: 42.01
  layernorm-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.02
     rank  2: 0.04
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.08
     rank  9: 0.03
     rank 10: 0.05
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.09
     rank  1: 0.04
     rank  2: 0.08
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.04
     rank  9: 0.02
     rank 10: 0.04
     rank 11: 0.03
     rank 12: 0.07
     rank 13: 0.07
     rank 14: 0.08
     rank 15: 0.07
  all-grads-sync:
     rank  0: 30.23
     rank  1: 29.87
     rank  2: 29.91
     rank  3: 29.87
     rank  4: 428.98
     rank  5: 428.97
     rank  6: 428.97
     rank  7: 428.96
     rank  8: 369.79
     rank  9: 370.13
     rank 10: 369.78
     rank 11: 370.13
     rank 12: 429.02
     rank 13: 429.33
     rank 14: 429.07
     rank 15: 429.33
  optimizer-copy-to-main-grad:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.04
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.04
     rank  8: 0.10
     rank  9: 0.05
     rank 10: 0.10
     rank 11: 0.05
     rank 12: 0.05
     rank 13: 0.04
     rank 14: 0.08
     rank 15: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 3.92
     rank  1: 3.74
     rank  2: 3.92
     rank  3: 3.75
     rank  4: 49.49
     rank  5: 49.46
     rank  6: 49.45
     rank  7: 49.51
     rank  8: 43.52
     rank  9: 43.37
     rank 10: 43.56
     rank 11: 43.53
     rank 12: 49.92
     rank 13: 49.91
     rank 14: 49.89
     rank 15: 49.88
  optimizer:
     rank  0: 4.77
     rank  1: 4.59
     rank  2: 4.77
     rank  3: 4.61
     rank  4: 50.34
     rank  5: 50.31
     rank  6: 50.29
     rank  7: 50.37
     rank  8: 44.37
     rank  9: 44.23
     rank 10: 44.42
     rank 11: 44.38
     rank 12: 50.78
     rank 13: 50.85
     rank 14: 50.74
     rank 15: 50.73
 [2024-12-24 23:02:19] iteration        8/      10 | consumed samples:          128 | elapsed time per iteration (ms): 2403.2 | learning rate: 6.000000E-06 | global batch size:    16 | lm loss: 2.395798E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2320.49
     rank  1: 2320.42
     rank  2: 2320.54
     rank  3: 2320.41
     rank  4: 2324.79
     rank  5: 2324.82
     rank  6: 2324.85
     rank  7: 2324.89
     rank  8: 2324.19
     rank  9: 2324.25
     rank 10: 2324.14
     rank 11: 2324.37
     rank 12: 2324.82
     rank 13: 2324.81
     rank 14: 2324.76
     rank 15: 2324.80
  forward-compute:
     rank  0: 436.92
     rank  1: 438.38
     rank  2: 390.47
     rank  3: 390.03
     rank  4: 589.70
     rank  5: 588.26
     rank  6: 611.62
     rank  7: 610.86
     rank  8: 544.12
     rank  9: 544.72
     rank 10: 561.82
     rank 11: 560.62
     rank 12: 626.85
     rank 13: 629.12
     rank 14: 617.20
     rank 15: 618.15
  backward-compute:
     rank  0: 36.38
     rank  1: 34.32
     rank  2: 34.29
     rank  3: 33.64
     rank  4: 755.06
     rank  5: 755.77
     rank  6: 779.53
     rank  7: 780.96
     rank  8: 713.92
     rank  9: 715.41
     rank 10: 727.32
     rank 11: 727.50
     rank 12: 813.57
     rank 13: 813.57
     rank 14: 817.74
     rank 15: 817.83
  pure-backward-compute:
     rank  0: 35.79
     rank  1: 34.01
     rank  2: 33.93
     rank  3: 33.34
     rank  4: 754.50
     rank  5: 754.69
     rank  6: 778.86
     rank  7: 780.23
     rank  8: 713.04
     rank  9: 714.54
     rank 10: 726.45
     rank 11: 726.10
     rank 12: 811.70
     rank 13: 811.99
     rank 14: 816.08
     rank 15: 816.46
  batch-generator:
     rank  0: 26.71
     rank  1: 26.52
     rank  2: 24.66
     rank  3: 23.42
     rank  4: 23.89
     rank  5: 33.33
     rank  6: 34.81
     rank  7: 32.85
     rank  8: 33.41
     rank  9: 32.20
     rank 10: 38.27
     rank 11: 36.67
     rank 12: 33.87
     rank 13: 34.68
     rank 14: 24.73
     rank 15: 26.78
  forward-recv:
     rank  4: 56.26
     rank  5: 55.71
     rank  6: 55.90
     rank  7: 55.80
     rank  8: 131.99
     rank  9: 131.96
     rank 10: 142.28
     rank 11: 143.20
     rank 12: 198.47
     rank 13: 198.39
     rank 14: 207.18
     rank 15: 207.08
  forward-send:
     rank  0: 53.22
     rank  1: 52.14
     rank  2: 64.87
     rank  3: 65.66
     rank  4: 5.64
     rank  5: 5.44
     rank  6: 4.94
     rank  7: 5.31
     rank  8: 2.93
     rank  9: 2.80
     rank 10: 2.84
     rank 11: 2.78
  backward-recv:
     rank  0: 538.59
     rank  1: 539.66
     rank  2: 538.71
     rank  3: 539.33
     rank  4: 179.50
     rank  5: 178.23
     rank  6: 173.79
     rank  7: 172.55
     rank  8: 92.02
     rank  9: 91.87
     rank 10: 89.22
     rank 11: 89.19
  backward-send:
     rank  4: 3.46
     rank  5: 4.72
     rank  6: 3.83
     rank  7: 4.68
     rank  8: 7.83
     rank  9: 7.67
     rank 10: 7.86
     rank 11: 7.86
     rank 12: 4.86
     rank 13: 4.79
     rank 14: 5.24
     rank 15: 5.11
  forward-send-backward-recv:
     rank  0: 818.85
     rank  1: 820.38
     rank  2: 858.68
     rank  3: 858.99
     rank  4: 275.06
     rank  5: 275.25
     rank  6: 240.68
     rank  7: 240.14
     rank  8: 251.73
     rank  9: 250.72
     rank 10: 219.60
     rank 11: 219.71
  backward-send-forward-recv:
     rank  4: 11.89
     rank  5: 13.28
     rank  6: 9.58
     rank  7: 9.34
     rank  8: 37.53
     rank  9: 36.90
     rank 10: 32.47
     rank 11: 32.52
     rank 12: 43.47
     rank 13: 41.73
     rank 14: 40.98
     rank 15: 40.17
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.10
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.05
     rank 11: 0.06
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.04
     rank  2: 0.12
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.05
     rank 12: 0.07
     rank 13: 0.07
     rank 14: 0.05
     rank 15: 0.07
  all-grads-sync:
     rank  0: 32.40
     rank  1: 32.33
     rank  2: 32.43
     rank  3: 32.33
     rank  4: 429.83
     rank  5: 429.34
     rank  6: 429.84
     rank  7: 429.41
     rank  8: 370.34
     rank  9: 370.29
     rank 10: 370.34
     rank 11: 370.22
     rank 12: 412.79
     rank 13: 412.71
     rank 14: 412.81
     rank 15: 412.72
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.04
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.04
     rank  7: 0.07
     rank  8: 0.05
     rank  9: 0.04
     rank 10: 0.05
     rank 11: 0.09
     rank 12: 0.05
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 3.82
     rank  1: 3.75
     rank  2: 3.94
     rank  3: 3.76
     rank  4: 49.47
     rank  5: 49.46
     rank  6: 49.52
     rank  7: 49.60
     rank  8: 43.57
     rank  9: 43.39
     rank 10: 43.48
     rank 11: 43.70
     rank 12: 49.95
     rank 13: 49.93
     rank 14: 49.87
     rank 15: 49.94
  optimizer:
     rank  0: 4.55
     rank  1: 4.48
     rank  2: 4.67
     rank  3: 4.49
     rank  4: 50.19
     rank  5: 50.19
     rank  6: 50.26
     rank  7: 50.33
     rank  8: 44.30
     rank  9: 44.12
     rank 10: 44.23
     rank 11: 44.43
     rank 12: 50.68
     rank 13: 50.66
     rank 14: 50.60
     rank 15: 50.69
 [2024-12-24 23:02:22] iteration        9/      10 | consumed samples:          144 | elapsed time per iteration (ms): 2852.6 | learning rate: 6.750000E-06 | global batch size:    16 | lm loss: 2.050182E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2769.58
     rank  1: 2769.39
     rank  2: 2769.54
     rank  3: 2769.41
     rank  4: 2773.78
     rank  5: 2773.74
     rank  6: 2773.75
     rank  7: 2773.73
     rank  8: 2773.32
     rank  9: 2773.20
     rank 10: 2773.32
     rank 11: 2773.19
     rank 12: 2773.89
     rank 13: 2773.97
     rank 14: 2773.99
     rank 15: 2773.88
  forward-compute:
     rank  0: 456.54
     rank  1: 458.53
     rank  2: 394.02
     rank  3: 390.96
     rank  4: 581.34
     rank  5: 583.03
     rank  6: 606.60
     rank  7: 603.41
     rank  8: 540.54
     rank  9: 541.30
     rank 10: 553.10
     rank 11: 549.95
     rank 12: 623.68
     rank 13: 625.25
     rank 14: 631.72
     rank 15: 634.90
  backward-compute:
     rank  0: 35.22
     rank  1: 35.81
     rank  2: 34.36
     rank  3: 32.67
     rank  4: 754.68
     rank  5: 755.49
     rank  6: 774.80
     rank  7: 776.76
     rank  8: 711.75
     rank  9: 713.03
     rank 10: 730.90
     rank 11: 732.57
     rank 12: 814.32
     rank 13: 813.92
     rank 14: 816.34
     rank 15: 816.51
  pure-backward-compute:
     rank  0: 34.81
     rank  1: 35.51
     rank  2: 33.96
     rank  3: 32.38
     rank  4: 754.08
     rank  5: 754.90
     rank  6: 774.38
     rank  7: 776.12
     rank  8: 710.75
     rank  9: 712.10
     rank 10: 729.67
     rank 11: 731.45
     rank 12: 812.27
     rank 13: 812.32
     rank 14: 814.60
     rank 15: 815.15
  batch-generator:
     rank  0: 28.29
     rank  1: 27.88
     rank  2: 24.06
     rank  3: 20.74
     rank  4: 25.01
     rank  5: 28.54
     rank  6: 26.01
     rank  7: 25.24
     rank  8: 30.63
     rank  9: 30.24
     rank 10: 29.48
     rank 11: 27.82
     rank 12: 34.45
     rank 13: 34.38
     rank 14: 32.86
     rank 15: 35.16
  forward-recv:
     rank  4: 74.58
     rank  5: 73.94
     rank  6: 53.42
     rank  7: 53.34
     rank  8: 151.33
     rank  9: 151.37
     rank 10: 135.05
     rank 11: 137.93
     rank 12: 208.41
     rank 13: 208.37
     rank 14: 199.04
     rank 15: 198.91
  forward-send:
     rank  0: 20.79
     rank  1: 19.64
     rank  2: 59.07
     rank  3: 62.13
     rank  4: 5.42
     rank  5: 5.24
     rank  6: 3.93
     rank  7: 4.75
     rank  8: 2.91
     rank  9: 2.78
     rank 10: 2.83
     rank 11: 2.73
  backward-recv:
     rank  0: 538.77
     rank  1: 539.45
     rank  2: 537.18
     rank  3: 538.19
     rank  4: 179.24
     rank  5: 178.85
     rank  6: 175.96
     rank  7: 175.08
     rank  8: 93.20
     rank  9: 93.01
     rank 10: 90.42
     rank 11: 89.84
  backward-send:
     rank  4: 3.86
     rank  5: 4.49
     rank  6: 3.69
     rank  7: 4.44
     rank  8: 5.17
     rank  9: 5.43
     rank 10: 5.69
     rank 11: 6.33
     rank 12: 5.19
     rank 13: 5.05
     rank 14: 5.19
     rank 15: 5.20
  forward-send-backward-recv:
     rank  0: 835.54
     rank  1: 834.87
     rank  2: 866.22
     rank  3: 867.82
     rank  4: 267.21
     rank  5: 266.90
     rank  6: 257.71
     rank  7: 256.22
     rank  8: 241.54
     rank  9: 240.94
     rank 10: 239.40
     rank 11: 237.59
  backward-send-forward-recv:
     rank  4: 13.75
     rank  5: 12.11
     rank  6: 8.62
     rank  7: 9.63
     rank  8: 37.94
     rank  9: 37.52
     rank 10: 31.17
     rank 11: 31.38
     rank 12: 41.85
     rank 13: 41.10
     rank 14: 40.99
     rank 15: 38.49
  layernorm-grads-all-reduce:
     rank  0: 0.10
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.09
     rank  9: 0.03
     rank 10: 0.13
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.04
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.12
     rank  1: 0.04
     rank  2: 0.05
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.05
     rank  9: 0.02
     rank 10: 0.06
     rank 11: 0.02
     rank 12: 0.08
     rank 13: 0.08
     rank 14: 0.09
     rank 15: 0.08
  all-grads-sync:
     rank  0: 29.93
     rank  1: 30.00
     rank  2: 29.95
     rank  3: 30.00
     rank  4: 427.38
     rank  5: 427.62
     rank  6: 427.38
     rank  7: 427.64
     rank  8: 375.01
     rank  9: 375.09
     rank 10: 375.06
     rank 11: 375.07
     rank 12: 874.32
     rank 13: 874.25
     rank 14: 874.30
     rank 15: 874.34
  optimizer-copy-to-main-grad:
     rank  0: 0.04
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.04
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.04
     rank  8: 0.10
     rank  9: 0.09
     rank 10: 0.10
     rank 11: 0.10
     rank 12: 0.06
     rank 13: 0.06
     rank 14: 0.06
     rank 15: 0.06
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 3.96
     rank  1: 3.77
     rank  2: 3.78
     rank  3: 3.77
     rank  4: 49.50
     rank  5: 49.49
     rank  6: 49.46
     rank  7: 49.54
     rank  8: 43.68
     rank  9: 43.39
     rank 10: 43.69
     rank 11: 43.46
     rank 12: 50.12
     rank 13: 50.17
     rank 14: 50.20
     rank 15: 50.11
  optimizer:
     rank  0: 4.79
     rank  1: 4.60
     rank  2: 4.61
     rank  3: 4.60
     rank  4: 50.32
     rank  5: 50.32
     rank  6: 50.29
     rank  7: 50.37
     rank  8: 44.58
     rank  9: 44.22
     rank 10: 44.52
     rank 11: 44.29
     rank 12: 50.95
     rank 13: 51.01
     rank 14: 51.03
     rank 15: 50.94
 [2024-12-24 23:02:25] iteration       10/      10 | consumed samples:          160 | elapsed time per iteration (ms): 2837.0 | learning rate: 7.500000E-06 | global batch size:    16 | lm loss: 2.456998E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2750.02
     rank  1: 2749.96
     rank  2: 2750.02
     rank  3: 2749.94
     rank  4: 2754.27
     rank  5: 2754.27
     rank  6: 2754.30
     rank  7: 2754.25
     rank  8: 2753.73
     rank  9: 2753.71
     rank 10: 2753.72
     rank 11: 2753.72
     rank 12: 2754.43
     rank 13: 2754.50
     rank 14: 2754.46
     rank 15: 2754.44
  forward-compute:
     rank  0: 436.47
     rank  1: 436.70
     rank  2: 398.01
     rank  3: 397.45
     rank  4: 584.16
     rank  5: 581.35
     rank  6: 595.63
     rank  7: 592.46
     rank  8: 550.37
     rank  9: 549.48
     rank 10: 553.17
     rank 11: 551.58
     rank 12: 632.33
     rank 13: 633.29
     rank 14: 627.04
     rank 15: 628.45
  backward-compute:
     rank  0: 36.40
     rank  1: 34.16
     rank  2: 35.12
     rank  3: 32.86
     rank  4: 754.39
     rank  5: 754.77
     rank  6: 776.83
     rank  7: 778.33
     rank  8: 713.38
     rank  9: 714.37
     rank 10: 728.03
     rank 11: 729.45
     rank 12: 815.59
     rank 13: 814.99
     rank 14: 818.41
     rank 15: 818.90
  pure-backward-compute:
     rank  0: 35.93
     rank  1: 33.85
     rank  2: 34.75
     rank  3: 32.56
     rank  4: 753.90
     rank  5: 753.93
     rank  6: 776.40
     rank  7: 777.67
     rank  8: 712.52
     rank  9: 713.54
     rank 10: 727.24
     rank 11: 728.20
     rank 12: 813.63
     rank 13: 813.39
     rank 14: 816.74
     rank 15: 817.55
  batch-generator:
     rank  0: 27.40
     rank  1: 25.78
     rank  2: 26.33
     rank  3: 24.53
     rank  4: 24.71
     rank  5: 25.85
     rank  6: 22.19
     rank  7: 24.28
     rank  8: 38.47
     rank  9: 37.15
     rank 10: 31.27
     rank 11: 30.13
     rank 12: 37.49
     rank 13: 36.78
     rank 14: 39.08
     rank 15: 38.38
  forward-recv:
     rank  4: 54.11
     rank  5: 53.91
     rank  6: 54.65
     rank  7: 54.54
     rank  8: 131.48
     rank  9: 132.51
     rank 10: 132.90
     rank 11: 133.23
     rank 12: 197.74
     rank 13: 197.57
     rank 14: 200.14
     rank 15: 200.08
  forward-send:
     rank  0: 52.07
     rank  1: 52.63
     rank  2: 53.49
     rank  3: 54.23
     rank  4: 6.81
     rank  5: 7.86
     rank  6: 6.96
     rank  7: 7.30
     rank  8: 2.96
     rank  9: 2.86
     rank 10: 3.07
     rank 11: 3.09
  backward-recv:
     rank  0: 538.14
     rank  1: 539.09
     rank  2: 539.40
     rank  3: 539.74
     rank  4: 178.04
     rank  5: 176.63
     rank  6: 173.13
     rank  7: 171.94
     rank  8: 90.58
     rank  9: 90.61
     rank 10: 91.30
     rank 11: 91.11
  backward-send:
     rank  4: 3.29
     rank  5: 4.25
     rank  6: 3.52
     rank  7: 4.35
     rank  8: 8.00
     rank  9: 8.33
     rank 10: 8.31
     rank 11: 8.41
     rank 12: 4.77
     rank 13: 4.95
     rank 14: 5.28
     rank 15: 5.09
  forward-send-backward-recv:
     rank  0: 822.81
     rank  1: 824.18
     rank  2: 863.82
     rank  3: 866.27
     rank  4: 286.13
     rank  5: 286.30
     rank  6: 265.08
     rank  7: 265.11
     rank  8: 249.75
     rank  9: 249.19
     rank 10: 240.34
     rank 11: 240.12
  backward-send-forward-recv:
     rank  4: 11.95
     rank  5: 13.37
     rank  6: 8.11
     rank  7: 9.57
     rank  8: 36.75
     rank  9: 36.49
     rank 10: 29.89
     rank 11: 29.44
     rank 12: 41.77
     rank 13: 41.73
     rank 14: 42.01
     rank 15: 40.62
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.04
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.04
     rank  2: 0.05
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.08
     rank 13: 0.09
     rank 14: 0.09
     rank 15: 0.08
  all-grads-sync:
     rank  0: 30.24
     rank  1: 29.64
     rank  2: 30.23
     rank  3: 29.60
     rank  4: 438.12
     rank  5: 437.62
     rank  6: 438.12
     rank  7: 437.62
     rank  8: 367.98
     rank  9: 367.92
     rank 10: 367.95
     rank 11: 367.89
     rank 12: 856.35
     rank 13: 856.45
     rank 14: 856.40
     rank 15: 856.46
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.01
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.10
     rank  9: 0.05
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.06
     rank 13: 0.12
     rank 14: 0.06
     rank 15: 0.06
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 3.80
     rank  1: 3.76
     rank  2: 3.83
     rank  3: 3.77
     rank  4: 49.43
     rank  5: 49.48
     rank  6: 49.48
     rank  7: 49.47
     rank  8: 43.44
     rank  9: 43.36
     rank 10: 43.40
     rank 11: 43.51
     rank 12: 50.14
     rank 13: 50.15
     rank 14: 50.21
     rank 15: 50.20
  optimizer:
     rank  0: 4.70
     rank  1: 4.67
     rank  2: 4.74
     rank  3: 4.68
     rank  4: 50.34
     rank  5: 50.39
     rank  6: 50.39
     rank  7: 50.38
     rank  8: 44.35
     rank  9: 44.28
     rank 10: 44.32
     rank 11: 44.43
     rank 12: 51.05
     rank 13: 51.05
     rank 14: 51.12
     rank 15: 51.11
