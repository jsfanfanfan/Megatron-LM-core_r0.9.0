examples/multimodal/pretrain-freeze-llm-homo.sh: line 4: activate: No such file or directory
[2024-12-24 23:13:01,350] torch.distributed.run: [WARNING] 
[2024-12-24 23:13:01,350] torch.distributed.run: [WARNING] *****************************************
[2024-12-24 23:13:01,350] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-12-24 23:13:01,350] torch.distributed.run: [WARNING] *****************************************
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
------pipeline_parallel_model_size:4------------pipeline_parallel_model_size:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------world_size:16------
------world_size:16------
------total_model_size:8------
------total_model_size:8------
------total_model_size:8------
------num_pipeline_model_parallel_groups:4------
------num_pipeline_model_parallel_groups:4------
------num_pipeline_model_parallel_groups:4------

> setting tensorboard ...
WARNING: one_logger package is required to enable e2e metrics tracking. please go to https://confluence.nvidia.com/display/MLWFO/Package+Repositories for details to install it
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:8------
------num_pipeline_model_parallel_groups:4------
---Rank 12---Tensor Parallel Group GPUs: [0, 0]
---Rank 15---Tensor Parallel Group GPUs: [1, 1]---Rank 13---Tensor Parallel Group GPUs: [1, 1]
---Rank 12---Pipeline Parallel Group GPUs: [3, 3, 3, 3]

---Rank 15---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
---Rank 13---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
---Rank 14---Tensor Parallel Group GPUs: [0, 0]
[rank15]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank13]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
---Rank 14---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
[rank12]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank14]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
 > number of parameters on (tensor, pipeline) model parallel rank (0, 3): 503353344
 > number of parameters on (tensor, pipeline) model parallel rank (1, 3): 503353344
INFO:megatron.core.distributed.param_and_grad_buffer:Number of buckets for gradient all-reduce / reduce-scatter: 1
Params for bucket 1 (503353344 elements):
	language_model.decoder.layers.3.mlp.linear_fc2.weight
	language_model.decoder.layers.3.self_attention.linear_qkv.weight
	language_model.decoder.layers.2.self_attention.linear_proj.weight
	language_model.decoder.layers.1.mlp.linear_fc1.weight
	language_model.decoder.layers.1.self_attention.linear_proj.weight
	language_model.decoder.layers.0.mlp.linear_fc2.weight
	language_model.decoder.layers.3.pre_mlp_layernorm.weight
	language_model.decoder.layers.3.self_attention.linear_proj.weight
	language_model.decoder.layers.2.pre_mlp_layernorm.weight
	language_model.decoder.layers.2.input_layernorm.weight
	language_model.decoder.layers.2.mlp.linear_fc1.weight
	language_model.decoder.layers.2.self_attention.linear_qkv.weight
	language_model.decoder.layers.0.input_layernorm.weight
	language_model.decoder.layers.3.mlp.linear_fc1.weight
	language_model.decoder.layers.2.mlp.linear_fc2.weight
	language_model.decoder.layers.1.self_attention.linear_qkv.weight
	language_model.decoder.layers.0.pre_mlp_layernorm.weight
	language_model.decoder.layers.0.self_attention.linear_qkv.weight
	language_model.decoder.layers.0.self_attention.linear_proj.weight
	language_model.decoder.layers.3.input_layernorm.weight
	language_model.decoder.layers.1.mlp.linear_fc2.weight
	language_model.decoder.layers.0.mlp.linear_fc1.weight
	language_model.decoder.final_layernorm.weight
	language_model.output_layer.weight
	language_model.decoder.layers.1.pre_mlp_layernorm.weight
	language_model.decoder.layers.1.input_layernorm.weight
rank=1, worker=0: shard_range=[pretrain-31.tar[0, 100), pretrain-31.tar[100, 200), pretrain-31.tar[200, 300), ...<1244>, pretrain-42.tar[4700, 4800), pretrain-42.tar[4800, 4900), pretrain-42.tar[4900, 5000)] sum(count)=125000
rank=1, worker=1: shard_range=[pretrain-42.tar[5000, 5100), pretrain-42.tar[5100, 5200), pretrain-42.tar[5200, 5300), ...<1244>, pretrain-53.tar[9700, 9800), pretrain-53.tar[9800, 9900), pretrain-53.tar[9900, 10000)] sum(count)=125000
rank=0, worker=0: shard_range=[pretrain-0.tar[0, 100), pretrain-0.tar[100, 200), pretrain-0.tar[200, 300), ...<1244>, pretrain-2.tar[4700, 4800), pretrain-2.tar[4800, 4900), pretrain-2.tar[4900, 5000)] sum(count)=125000
rank=0, worker=1: shard_range=[pretrain-2.tar[5000, 5100), pretrain-2.tar[5100, 5200), pretrain-2.tar[5200, 5300), ...<1244>, pretrain-30.tar[9700, 9800), pretrain-30.tar[9800, 9900), pretrain-30.tar[9900, 10000)] sum(count)=125000
rank=0, worker=0: shard_range=[pretrain-54.tar[0, 10000), pretrain-55.tar[0, 4532)] sum(count)=14532
rank=0, worker=1: shard_range=[pretrain-55.tar[4532, 8128), pretrain-6.tar[0, 10000), pretrain-7.tar[0, 936)] sum(count)=14532
rank=1, worker=0: shard_range=[pretrain-7.tar[936, 10000), pretrain-8.tar[0, 5468)] sum(count)=14532
rank=1, worker=1: shard_range=[pretrain-8.tar[5468, 10000), pretrain-9.tar[0, 10000)] sum(count)=14532
times across ranks (ms):
  model-and-optimizer-setup:
     rank  0: 156.12
     rank  1: 155.68
     rank  2: 156.67
     rank  3: 154.34
     rank  4: 319.43
     rank  5: 319.24
     rank  6: 319.09
     rank  7: 319.73
     rank  8: 319.03
     rank  9: 318.91
     rank 10: 318.84
     rank 11: 319.32
     rank 12: 319.36
     rank 13: 321.42
     rank 14: 313.64
     rank 15: 319.28
  train/valid/test-data-iterators-setup:
     rank  0: 1318.60
     rank  1: 1318.56
     rank  2: 1318.38
     rank  3: 1318.53
     rank  4: 1318.50
     rank  5: 1319.09
     rank  6: 1318.52
     rank  7: 1318.56
     rank  8: 1364.82
     rank  9: 1365.49
     rank 10: 1364.85
     rank 11: 1364.94
     rank 12: 1364.85
     rank 13: 1365.47
     rank 14: 1364.86
     rank 15: 1364.89
 [2024-12-24 23:17:54] iteration        1/      10 | consumed samples:           16 | elapsed time per iteration (ms): 43636.8 | learning rate: 7.500000E-07 | global batch size:    16 | lm loss: 7.019983E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
[Rank 13] (after 1 iterations) memory (MB) | allocated: 7792.8154296875 | max allocated: 9712.818359375 | reserved: 10362.0 | max reserved: 10362.0
stage4 GPU utialization:86.22885617342862 %
[Rank 12] (after 1 iterations) memory (MB) | allocated: 7792.8154296875 | max allocated: 9712.818359375 | reserved: 10370.0 | max reserved: 10370.0
times across ranks (ms):
  forward-backward:
     rank  0: 43484.27
     rank  1: 43484.20
     rank  2: 43484.45
     rank  3: 43484.21
     rank  4: 43457.10
     rank  5: 43456.89
     rank  6: 43457.21
     rank  7: 43456.95
     rank  8: 43456.27
     rank  9: 43456.17
     rank 10: 43456.29
     rank 11: 43456.25
     rank 12: 43456.71
     rank 13: 43456.54
     rank 14: 43456.82
     rank 15: 43456.49
  forward-compute:
     rank  0: 16627.96
     rank  1: 16621.41
     rank  2: 16657.77
     rank  3: 16649.41
     rank  4: 7876.34
     rank  5: 7866.53
     rank  6: 7864.87
     rank  7: 7857.23
     rank  8: 7305.59
     rank  9: 7313.18
     rank 10: 7297.92
     rank 11: 7297.74
     rank 12: 7267.79
     rank 13: 7277.51
     rank 14: 7274.31
     rank 15: 7277.22
  backward-compute:
     rank  0: 4335.58
     rank  1: 4333.39
     rank  2: 4320.88
     rank  3: 4321.03
     rank  4: 830.18
     rank  5: 832.93
     rank  6: 839.42
     rank  7: 836.50
     rank  8: 740.67
     rank  9: 747.82
     rank 10: 733.36
     rank 11: 743.85
     rank 12: 892.47
     rank 13: 895.31
     rank 14: 885.67
     rank 15: 889.96
  pure-backward-compute:
     rank  0: 4334.82
     rank  1: 4332.55
     rank  2: 4320.17
     rank  3: 4320.01
     rank  4: 829.31
     rank  5: 832.19
     rank  6: 838.74
     rank  7: 835.66
     rank  8: 739.81
     rank  9: 746.97
     rank 10: 732.49
     rank 11: 742.84
     rank 12: 890.78
     rank 13: 894.10
     rank 14: 883.62
     rank 15: 889.06
  batch-generator:
     rank  0: 1670.83
     rank  1: 1667.26
     rank  2: 1678.68
     rank  3: 1672.36
     rank  4: 1795.30
     rank  5: 1787.10
     rank  6: 1783.90
     rank  7: 1776.94
     rank  8: 1683.31
     rank  9: 1690.01
     rank 10: 1677.24
     rank 11: 1676.61
     rank 12: 1732.14
     rank 13: 1742.58
     rank 14: 1735.44
     rank 15: 1740.19
  forward-recv:
     rank  4: 16288.29
     rank  5: 16295.99
     rank  6: 16294.46
     rank  7: 16303.09
     rank  8: 23688.16
     rank  9: 23687.53
     rank 10: 23688.43
     rank 11: 23685.52
     rank 12: 30547.79
     rank 13: 30542.95
     rank 14: 30546.91
     rank 15: 30548.45
  forward-send:
     rank  0: 14313.08
     rank  1: 14317.92
     rank  2: 14305.34
     rank  3: 14313.69
     rank  4: 6822.53
     rank  5: 6818.38
     rank  6: 6819.28
     rank  7: 6818.31
     rank  8: 33.53
     rank  9: 29.13
     rank 10: 32.92
     rank 11: 34.66
  backward-recv:
     rank  0: 336.89
     rank  1: 333.33
     rank  2: 337.67
     rank  3: 335.62
     rank  4: 182.22
     rank  5: 183.19
     rank  6: 181.04
     rank  7: 183.89
     rank  8: 89.68
     rank  9: 89.77
     rank 10: 91.96
     rank 11: 87.87
  backward-send:
     rank  4: 6.20
     rank  5: 5.68
     rank  6: 5.79
     rank  7: 4.58
     rank  8: 7.74
     rank  9: 7.90
     rank 10: 6.08
     rank 11: 7.69
     rank 12: 3.83
     rank 13: 3.78
     rank 14: 4.11
     rank 15: 1.72
  forward-send-backward-recv:
     rank  0: 7269.24
     rank  1: 7273.97
     rank  2: 7259.45
     rank  3: 7261.25
     rank  4: 7015.02
     rank  5: 7011.90
     rank  6: 7004.94
     rank  7: 7005.86
     rank  8: 6931.02
     rank  9: 6924.42
     rank 10: 6935.04
     rank 11: 6926.23
  backward-send-forward-recv:
     rank  4: 3799.73
     rank  5: 3805.80
     rank  6: 3810.38
     rank  7: 3809.81
     rank  8: 3931.29
     rank  9: 3928.96
     rank 10: 3941.23
     rank 11: 3942.12
     rank 12: 3923.46
     rank 13: 3916.82
     rank 14: 3922.65
     rank 15: 3916.08
  layernorm-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.05
     rank  2: 0.06
     rank  3: 0.05
     rank  4: 0.04
     rank  5: 0.02
     rank  6: 0.05
     rank  7: 0.03
     rank  8: 0.04
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.04
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.04
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.11
     rank  1: 0.10
     rank  2: 0.11
     rank  3: 0.11
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.05
     rank  7: 0.04
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.07
     rank 13: 0.06
     rank 14: 0.10
     rank 15: 0.06
  all-grads-sync:
     rank  0: 389.86
     rank  1: 393.39
     rank  2: 389.87
     rank  3: 393.43
     rank  4: 558.08
     rank  5: 557.22
     rank  6: 558.12
     rank  7: 557.23
     rank  8: 507.35
     rank  9: 508.42
     rank 10: 507.37
     rank 11: 508.43
     rank 12: 475.67
     rank 13: 474.96
     rank 14: 475.72
     rank 15: 474.97
  optimizer-copy-to-main-grad:
     rank  0: 0.41
     rank  1: 0.66
     rank  2: 0.71
     rank  3: 0.55
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.11
     rank  7: 0.13
     rank  8: 0.05
     rank  9: 0.05
     rank 10: 0.05
     rank 11: 0.06
     rank 12: 0.08
     rank 13: 0.07
     rank 14: 0.06
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.04
     rank  1: 0.05
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.02
     rank  1: 0.04
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 88.36
     rank  1: 93.07
     rank  2: 90.46
     rank  3: 92.97
     rank  4: 116.95
     rank  5: 115.37
     rank  6: 116.26
     rank  7: 115.38
     rank  8: 143.45
     rank  9: 144.59
     rank 10: 143.89
     rank 11: 143.46
     rank 12: 129.52
     rank 13: 125.33
     rank 14: 127.97
     rank 15: 127.90
  optimizer:
     rank  0: 90.73
     rank  1: 95.36
     rank  2: 92.85
     rank  3: 95.35
     rank  4: 119.36
     rank  5: 117.77
     rank  6: 118.51
     rank  7: 117.78
     rank  8: 145.85
     rank  9: 146.99
     rank 10: 146.30
     rank 11: 145.99
     rank 12: 131.94
     rank 13: 127.73
     rank 14: 130.40
     rank 15: 130.30
 [2024-12-24 23:17:57] iteration        2/      10 | consumed samples:           32 | elapsed time per iteration (ms): 2476.2 | learning rate: 1.500000E-06 | global batch size:    16 | lm loss: 7.128254E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2391.02
     rank  1: 2392.79
     rank  2: 2390.99
     rank  3: 2392.70
     rank  4: 2393.77
     rank  5: 2393.90
     rank  6: 2393.81
     rank  7: 2393.88
     rank  8: 2393.24
     rank  9: 2393.44
     rank 10: 2393.22
     rank 11: 2393.35
     rank 12: 2393.78
     rank 13: 2393.61
     rank 14: 2393.85
     rank 15: 2393.60
  forward-compute:
     rank  0: 697.96
     rank  1: 696.29
     rank  2: 660.69
     rank  3: 660.13
     rank  4: 575.85
     rank  5: 575.89
     rank  6: 580.70
     rank  7: 582.86
     rank  8: 542.10
     rank  9: 542.27
     rank 10: 554.29
     rank 11: 542.73
     rank 12: 614.30
     rank 13: 613.07
     rank 14: 616.51
     rank 15: 632.24
  backward-compute:
     rank  0: 543.01
     rank  1: 547.06
     rank  2: 533.47
     rank  3: 538.51
     rank  4: 730.49
     rank  5: 729.61
     rank  6: 746.64
     rank  7: 732.17
     rank  8: 716.33
     rank  9: 715.39
     rank 10: 706.50
     rank 11: 722.33
     rank 12: 818.47
     rank 13: 824.63
     rank 14: 812.41
     rank 15: 812.39
  pure-backward-compute:
     rank  0: 542.45
     rank  1: 546.43
     rank  2: 532.86
     rank  3: 537.94
     rank  4: 729.72
     rank  5: 729.06
     rank  6: 745.88
     rank  7: 731.54
     rank  8: 715.43
     rank  9: 714.12
     rank 10: 705.86
     rank 11: 720.77
     rank 12: 817.01
     rank 13: 823.53
     rank 14: 810.10
     rank 15: 811.75
  batch-generator:
     rank  0: 36.47
     rank  1: 36.39
     rank  2: 37.76
     rank  3: 37.27
     rank  4: 34.26
     rank  5: 34.64
     rank  6: 40.28
     rank  7: 42.64
     rank  8: 28.87
     rank  9: 29.81
     rank 10: 35.72
     rank 11: 28.53
     rank 12: 26.55
     rank 13: 23.99
     rank 14: 32.38
     rank 15: 45.34
  forward-recv:
     rank  4: 123.67
     rank  5: 124.57
     rank  6: 97.39
     rank  7: 97.88
     rank  8: 179.54
     rank  9: 179.29
     rank 10: 173.77
     rank 11: 173.27
     rank 12: 235.33
     rank 13: 235.11
     rank 14: 235.45
     rank 15: 235.54
  forward-send:
     rank  0: 5.49
     rank  1: 5.62
     rank  2: 11.40
     rank  3: 11.48
     rank  4: 8.00
     rank  5: 7.26
     rank  6: 8.04
     rank  7: 7.72
     rank  8: 5.09
     rank  9: 4.92
     rank 10: 5.01
     rank 11: 5.24
  backward-recv:
     rank  0: 339.13
     rank  1: 336.91
     rank  2: 346.66
     rank  3: 345.45
     rank  4: 179.92
     rank  5: 180.45
     rank  6: 179.41
     rank  7: 181.30
     rank  8: 90.23
     rank  9: 90.29
     rank 10: 91.73
     rank 11: 89.19
  backward-send:
     rank  4: 6.46
     rank  5: 5.73
     rank  6: 6.25
     rank  7: 5.73
     rank  8: 8.52
     rank  9: 8.48
     rank 10: 7.38
     rank 11: 8.24
     rank 12: 4.32
     rank 13: 4.20
     rank 14: 4.34
     rank 15: 2.19
  forward-send-backward-recv:
     rank  0: 372.26
     rank  1: 370.36
     rank  2: 404.09
     rank  3: 400.98
     rank  4: 238.30
     rank  5: 239.30
     rank  6: 241.83
     rank  7: 255.28
     rank  8: 227.44
     rank  9: 229.27
     rank 10: 239.09
     rank 11: 224.33
  backward-send-forward-recv:
     rank  4: 28.85
     rank  5: 29.04
     rank  6: 31.86
     rank  7: 30.46
     rank  8: 30.61
     rank  9: 30.09
     rank 10: 20.84
     rank 11: 31.56
     rank 12: 33.93
     rank 13: 30.88
     rank 14: 36.27
     rank 15: 22.81
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.06
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.06
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.11
     rank  2: 0.05
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.05
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.05
     rank 13: 0.04
     rank 14: 0.07
     rank 15: 0.04
  all-grads-sync:
     rank  0: 239.87
     rank  1: 239.98
     rank  2: 239.89
     rank  3: 240.02
     rank  4: 420.57
     rank  5: 419.64
     rank  6: 420.58
     rank  7: 419.64
     rank  8: 359.91
     rank  9: 359.55
     rank 10: 359.93
     rank 11: 359.52
     rank 12: 402.99
     rank 13: 403.01
     rank 14: 402.95
     rank 15: 403.03
  optimizer-copy-to-main-grad:
     rank  0: 0.20
     rank  1: 0.43
     rank  2: 0.24
     rank  3: 0.26
     rank  4: 0.04
     rank  5: 0.06
     rank  6: 0.04
     rank  7: 0.04
     rank  8: 0.21
     rank  9: 0.10
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.04
     rank 13: 0.03
     rank 14: 0.05
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 19.54
     rank  1: 20.18
     rank  2: 19.89
     rank  3: 19.71
     rank  4: 49.65
     rank  5: 49.56
     rank  6: 49.57
     rank  7: 49.54
     rank  8: 43.55
     rank  9: 43.65
     rank 10: 43.40
     rank 11: 43.57
     rank 12: 49.79
     rank 13: 49.82
     rank 14: 49.91
     rank 15: 49.74
  optimizer:
     rank  0: 20.60
     rank  1: 21.26
     rank  2: 20.96
     rank  3: 20.78
     rank  4: 50.73
     rank  5: 50.63
     rank  6: 50.64
     rank  7: 50.61
     rank  8: 44.62
     rank  9: 44.73
     rank 10: 44.48
     rank 11: 44.65
     rank 12: 50.89
     rank 13: 50.89
     rank 14: 50.99
     rank 15: 50.81
 [2024-12-24 23:17:59] iteration        3/      10 | consumed samples:           48 | elapsed time per iteration (ms): 2733.3 | learning rate: 2.250000E-06 | global batch size:    16 | lm loss: 6.854866E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2651.20
     rank  1: 2650.85
     rank  2: 2651.12
     rank  3: 2650.83
     rank  4: 2654.02
     rank  5: 2653.72
     rank  6: 2654.03
     rank  7: 2653.69
     rank  8: 2653.66
     rank  9: 2653.34
     rank 10: 2653.46
     rank 11: 2653.50
     rank 12: 2654.30
     rank 13: 2653.70
     rank 14: 2654.09
     rank 15: 2653.69
  forward-compute:
     rank  0: 522.19
     rank  1: 520.61
     rank  2: 414.07
     rank  3: 413.78
     rank  4: 573.73
     rank  5: 576.48
     rank  6: 572.01
     rank  7: 577.44
     rank  8: 559.47
     rank  9: 566.26
     rank 10: 544.03
     rank 11: 539.56
     rank 12: 624.89
     rank 13: 627.59
     rank 14: 662.63
     rank 15: 676.34
  backward-compute:
     rank  0: 458.21
     rank  1: 459.67
     rank  2: 443.95
     rank  3: 450.50
     rank  4: 731.31
     rank  5: 735.93
     rank  6: 742.62
     rank  7: 733.45
     rank  8: 719.97
     rank  9: 717.92
     rank 10: 707.73
     rank 11: 722.83
     rank 12: 821.08
     rank 13: 822.62
     rank 14: 804.38
     rank 15: 804.79
  pure-backward-compute:
     rank  0: 457.68
     rank  1: 458.97
     rank  2: 443.53
     rank  3: 450.10
     rank  4: 730.79
     rank  5: 735.47
     rank  6: 741.59
     rank  7: 732.88
     rank  8: 716.58
     rank  9: 717.13
     rank 10: 707.00
     rank 11: 721.48
     rank 12: 819.21
     rank 13: 821.62
     rank 14: 802.24
     rank 15: 804.03
  batch-generator:
     rank  0: 28.25
     rank  1: 33.32
     rank  2: 25.79
     rank  3: 26.04
     rank  4: 33.57
     rank  5: 35.41
     rank  6: 31.99
     rank  7: 35.68
     rank  8: 39.67
     rank  9: 44.94
     rank 10: 31.01
     rank 11: 26.42
     rank 12: 34.27
     rank 13: 33.65
     rank 14: 35.63
     rank 15: 46.29
  forward-recv:
     rank  4: 74.20
     rank  5: 74.39
     rank  6: 57.23
     rank  7: 56.96
     rank  8: 151.70
     rank  9: 151.62
     rank 10: 133.34
     rank 11: 132.93
     rank 12: 217.31
     rank 13: 217.40
     rank 14: 194.97
     rank 15: 195.25
  forward-send:
     rank  0: 26.06
     rank  1: 25.32
     rank  2: 50.57
     rank  3: 49.87
     rank  4: 5.57
     rank  5: 5.05
     rank  6: 5.84
     rank  7: 5.65
     rank  8: 3.41
     rank  9: 2.78
     rank 10: 2.56
     rank 11: 2.86
  backward-recv:
     rank  0: 373.01
     rank  1: 373.61
     rank  2: 384.41
     rank  3: 385.79
     rank  4: 183.63
     rank  5: 184.39
     rank  6: 180.40
     rank  7: 182.27
     rank  8: 91.40
     rank  9: 91.11
     rank 10: 91.57
     rank 11: 90.13
  backward-send:
     rank  4: 4.02
     rank  5: 3.43
     rank  6: 4.00
     rank  7: 3.03
     rank  8: 5.52
     rank  9: 5.31
     rank 10: 5.09
     rank 11: 5.70
     rank 12: 2.77
     rank 13: 2.25
     rank 14: 2.36
     rank 15: 1.93
  forward-send-backward-recv:
     rank  0: 554.69
     rank  1: 551.93
     rank  2: 635.61
     rank  3: 630.95
     rank  4: 295.51
     rank  5: 290.70
     rank  6: 300.64
     rank  7: 305.36
     rank  8: 235.04
     rank  9: 233.77
     rank 10: 282.38
     rank 11: 267.35
  backward-send-forward-recv:
     rank  4: 18.83
     rank  5: 16.61
     rank  6: 19.36
     rank  7: 18.12
     rank  8: 27.21
     rank  9: 25.62
     rank 10: 23.50
     rank 11: 27.60
     rank 12: 34.49
     rank 13: 33.32
     rank 14: 33.79
     rank 15: 21.69
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.04
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.07
     rank 12: 0.13
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.07
     rank  1: 0.06
     rank  2: 0.05
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.05
     rank 12: 0.18
     rank 13: 0.05
     rank 14: 0.08
     rank 15: 0.05
  all-grads-sync:
     rank  0: 233.12
     rank  1: 233.07
     rank  2: 233.17
     rank  3: 233.14
     rank  4: 409.30
     rank  5: 409.19
     rank  6: 409.26
     rank  7: 409.19
     rank  8: 705.61
     rank  9: 705.72
     rank 10: 705.64
     rank 11: 705.56
     rank 12: 404.31
     rank 13: 404.12
     rank 14: 404.34
     rank 15: 404.23
  optimizer-copy-to-main-grad:
     rank  0: 0.25
     rank  1: 0.31
     rank  2: 0.19
     rank  3: 0.26
     rank  4: 0.04
     rank  5: 0.03
     rank  6: 0.04
     rank  7: 0.03
     rank  8: 0.08
     rank  9: 0.06
     rank 10: 0.06
     rank 11: 0.08
     rank 12: 0.11
     rank 13: 0.07
     rank 14: 0.05
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.07
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 19.97
     rank  1: 20.04
     rank  2: 19.73
     rank  3: 19.71
     rank  4: 49.51
     rank  5: 49.54
     rank  6: 49.56
     rank  7: 49.54
     rank  8: 44.79
     rank  9: 43.61
     rank 10: 43.54
     rank 11: 44.02
     rank 12: 50.33
     rank 13: 49.82
     rank 14: 50.04
     rank 15: 49.74
  optimizer:
     rank  0: 21.27
     rank  1: 21.34
     rank  2: 21.03
     rank  3: 21.01
     rank  4: 50.81
     rank  5: 50.84
     rank  6: 50.87
     rank  7: 50.84
     rank  8: 46.09
     rank  9: 44.91
     rank 10: 44.84
     rank 11: 45.32
     rank 12: 51.70
     rank 13: 51.12
     rank 14: 51.35
     rank 15: 51.04
 [2024-12-24 23:18:02] iteration        4/      10 | consumed samples:           64 | elapsed time per iteration (ms): 2452.1 | learning rate: 3.000000E-06 | global batch size:    16 | lm loss: 2.421344E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2368.06
     rank  1: 2367.88
     rank  2: 2368.04
     rank  3: 2367.83
     rank  4: 2370.97
     rank  5: 2370.76
     rank  6: 2370.94
     rank  7: 2370.73
     rank  8: 2370.40
     rank  9: 2370.19
     rank 10: 2370.34
     rank 11: 2370.18
     rank 12: 2371.16
     rank 13: 2370.66
     rank 14: 2371.09
     rank 15: 2370.64
  forward-compute:
     rank  0: 476.47
     rank  1: 478.95
     rank  2: 424.03
     rank  3: 423.87
     rank  4: 561.15
     rank  5: 562.17
     rank  6: 575.83
     rank  7: 578.85
     rank  8: 545.18
     rank  9: 546.62
     rank 10: 545.10
     rank 11: 538.25
     rank 12: 631.13
     rank 13: 633.01
     rank 14: 659.71
     rank 15: 675.44
  backward-compute:
     rank  0: 442.13
     rank  1: 441.16
     rank  2: 452.66
     rank  3: 459.85
     rank  4: 729.07
     rank  5: 728.25
     rank  6: 743.76
     rank  7: 732.49
     rank  8: 716.74
     rank  9: 717.42
     rank 10: 711.04
     rank 11: 729.97
     rank 12: 823.49
     rank 13: 824.85
     rank 14: 808.92
     rank 15: 808.74
  pure-backward-compute:
     rank  0: 441.72
     rank  1: 440.51
     rank  2: 452.24
     rank  3: 459.42
     rank  4: 728.47
     rank  5: 727.63
     rank  6: 742.97
     rank  7: 732.01
     rank  8: 715.50
     rank  9: 716.45
     rank 10: 710.50
     rank 11: 728.53
     rank 12: 821.58
     rank 13: 823.83
     rank 14: 806.65
     rank 15: 808.11
  batch-generator:
     rank  0: 26.25
     rank  1: 31.25
     rank  2: 23.16
     rank  3: 23.06
     rank  4: 23.67
     rank  5: 25.60
     rank  6: 37.62
     rank  7: 37.55
     rank  8: 29.94
     rank  9: 31.05
     rank 10: 25.84
     rank 11: 25.20
     rank 12: 37.82
     rank 13: 36.47
     rank 14: 35.41
     rank 15: 46.84
  forward-recv:
     rank  4: 68.85
     rank  5: 68.81
     rank  6: 56.15
     rank  7: 56.27
     rank  8: 141.93
     rank  9: 141.53
     rank 10: 131.14
     rank 11: 130.14
     rank 12: 207.25
     rank 13: 207.38
     rank 14: 194.47
     rank 15: 195.06
  forward-send:
     rank  0: 22.14
     rank  1: 21.08
     rank  2: 52.12
     rank  3: 51.32
     rank  4: 5.47
     rank  5: 4.95
     rank  6: 5.69
     rank  7: 5.25
     rank  8: 2.76
     rank  9: 2.85
     rank 10: 2.24
     rank 11: 2.72
  backward-recv:
     rank  0: 394.65
     rank  1: 390.63
     rank  2: 388.94
     rank  3: 386.67
     rank  4: 183.13
     rank  5: 184.61
     rank  6: 181.08
     rank  7: 184.50
     rank  8: 90.68
     rank  9: 90.62
     rank 10: 92.83
     rank 11: 89.28
  backward-send:
     rank  4: 6.93
     rank  5: 6.03
     rank  6: 6.28
     rank  7: 5.32
     rank  8: 8.96
     rank  9: 8.98
     rank 10: 6.48
     rank 11: 8.88
     rank 12: 4.34
     rank 13: 4.27
     rank 14: 4.24
     rank 15: 2.83
  forward-send-backward-recv:
     rank  0: 606.86
     rank  1: 605.34
     rank  2: 625.44
     rank  3: 621.37
     rank  4: 313.40
     rank  5: 313.15
     rank  6: 297.67
     rank  7: 305.21
     rank  8: 259.44
     rank  9: 258.39
     rank 10: 284.02
     rank 11: 266.13
  backward-send-forward-recv:
     rank  4: 20.98
     rank  5: 20.90
     rank  6: 21.23
     rank  7: 20.53
     rank  8: 29.75
     rank  9: 29.41
     rank 10: 21.76
     rank 11: 27.91
     rank 12: 34.55
     rank 13: 33.73
     rank 14: 32.48
     rank 15: 19.05
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.07
     rank 13: 0.02
     rank 14: 0.04
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.05
     rank  2: 0.05
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.19
     rank 13: 0.05
     rank 14: 0.10
     rank 15: 0.04
  all-grads-sync:
     rank  0: 235.63
     rank  1: 235.70
     rank  2: 235.61
     rank  3: 235.70
     rank  4: 415.30
     rank  5: 415.13
     rank  6: 415.30
     rank  7: 415.13
     rank  8: 362.59
     rank  9: 362.58
     rank 10: 362.62
     rank 11: 362.60
     rank 12: 405.29
     rank 13: 405.38
     rank 14: 405.35
     rank 15: 405.38
  optimizer-copy-to-main-grad:
     rank  0: 0.20
     rank  1: 0.29
     rank  2: 0.33
     rank  3: 0.25
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.05
     rank  9: 0.05
     rank 10: 0.04
     rank 11: 0.05
     rank 12: 0.12
     rank 13: 0.04
     rank 14: 0.06
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 19.36
     rank  1: 19.90
     rank  2: 19.54
     rank  3: 19.52
     rank  4: 49.48
     rank  5: 49.53
     rank  6: 49.55
     rank  7: 49.52
     rank  8: 43.43
     rank  9: 43.46
     rank 10: 43.19
     rank 11: 44.17
     rank 12: 50.27
     rank 13: 49.85
     rank 14: 50.20
     rank 15: 49.71
  optimizer:
     rank  0: 20.26
     rank  1: 20.80
     rank  2: 20.44
     rank  3: 20.42
     rank  4: 50.38
     rank  5: 50.43
     rank  6: 50.45
     rank  7: 50.52
     rank  8: 44.34
     rank  9: 44.36
     rank 10: 44.09
     rank 11: 45.07
     rank 12: 51.16
     rank 13: 50.75
     rank 14: 51.10
     rank 15: 50.61
 [2024-12-24 23:18:04] iteration        5/      10 | consumed samples:           80 | elapsed time per iteration (ms): 2548.9 | learning rate: 3.750000E-06 | global batch size:    16 | lm loss: 2.226856E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2468.31
     rank  1: 2468.55
     rank  2: 2468.28
     rank  3: 2469.30
     rank  4: 2471.28
     rank  5: 2471.29
     rank  6: 2471.23
     rank  7: 2471.30
     rank  8: 2470.74
     rank  9: 2470.69
     rank 10: 2470.63
     rank 11: 2470.72
     rank 12: 2471.32
     rank 13: 2470.98
     rank 14: 2471.26
     rank 15: 2470.95
  forward-compute:
     rank  0: 657.32
     rank  1: 660.26
     rank  2: 620.72
     rank  3: 625.07
     rank  4: 566.64
     rank  5: 566.37
     rank  6: 569.95
     rank  7: 574.08
     rank  8: 551.88
     rank  9: 551.74
     rank 10: 541.84
     rank 11: 541.39
     rank 12: 623.02
     rank 13: 624.79
     rank 14: 686.16
     rank 15: 695.46
  backward-compute:
     rank  0: 431.32
     rank  1: 428.54
     rank  2: 461.45
     rank  3: 459.33
     rank  4: 734.23
     rank  5: 733.93
     rank  6: 740.10
     rank  7: 736.46
     rank  8: 720.75
     rank  9: 722.18
     rank 10: 710.95
     rank 11: 721.46
     rank 12: 825.19
     rank 13: 827.99
     rank 14: 805.92
     rank 15: 805.67
  pure-backward-compute:
     rank  0: 430.92
     rank  1: 427.86
     rank  2: 461.10
     rank  3: 458.85
     rank  4: 733.69
     rank  5: 733.46
     rank  6: 739.26
     rank  7: 735.94
     rank  8: 719.58
     rank  9: 721.05
     rank 10: 710.39
     rank 11: 720.34
     rank 12: 822.86
     rank 13: 827.23
     rank 14: 803.22
     rank 15: 805.04
  batch-generator:
     rank  0: 23.65
     rank  1: 29.78
     rank  2: 23.31
     rank  3: 28.93
     rank  4: 26.29
     rank  5: 26.04
     rank  6: 32.01
     rank  7: 34.96
     rank  8: 36.59
     rank  9: 35.03
     rank 10: 23.98
     rank 11: 27.40
     rank 12: 31.95
     rank 13: 31.68
     rank 14: 36.50
     rank 15: 43.34
  forward-recv:
     rank  4: 58.48
     rank  5: 58.54
     rank  6: 55.51
     rank  7: 55.17
     rank  8: 133.14
     rank  9: 133.15
     rank 10: 133.43
     rank 11: 129.87
     rank 12: 199.76
     rank 13: 199.82
     rank 14: 198.34
     rank 15: 199.02
  forward-send:
     rank  0: 47.06
     rank  1: 46.46
     rank  2: 47.62
     rank  3: 44.40
     rank  4: 8.46
     rank  5: 8.32
     rank  6: 8.64
     rank  7: 6.17
     rank  8: 4.59
     rank  9: 4.54
     rank 10: 3.72
     rank 11: 4.59
  backward-recv:
     rank  0: 394.14
     rank  1: 392.34
     rank  2: 411.96
     rank  3: 412.42
     rank  4: 179.66
     rank  5: 180.34
     rank  6: 188.63
     rank  7: 189.44
     rank  8: 92.44
     rank  9: 92.99
     rank 10: 97.45
     rank 11: 94.11
  backward-send:
     rank  4: 4.35
     rank  5: 3.44
     rank  6: 4.54
     rank  7: 4.05
     rank  8: 5.29
     rank  9: 4.88
     rank 10: 4.99
     rank 11: 5.49
     rank 12: 3.60
     rank 13: 3.46
     rank 14: 3.55
     rank 15: 1.47
  forward-send-backward-recv:
     rank  0: 507.29
     rank  1: 507.06
     rank  2: 499.75
     rank  3: 498.40
     rank  4: 272.03
     rank  5: 272.59
     rank  6: 288.78
     rank  7: 292.02
     rank  8: 221.24
     rank  9: 220.77
     rank 10: 272.16
     rank 11: 263.86
  backward-send-forward-recv:
     rank  4: 165.58
     rank  5: 166.21
     rank  6: 131.67
     rank  7: 131.36
     rank  8: 168.22
     rank  9: 167.51
     rank 10: 131.46
     rank 11: 134.16
     rank 12: 152.70
     rank 13: 150.99
     rank 14: 108.98
     rank 15: 101.81
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.04
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.04
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.06
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.05
     rank  2: 0.05
     rank  3: 0.23
     rank  4: 0.02
     rank  5: 0.04
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.04
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.15
     rank 13: 0.05
     rank 14: 0.08
     rank 15: 0.05
  all-grads-sync:
     rank  0: 231.51
     rank  1: 231.54
     rank  2: 231.55
     rank  3: 231.64
     rank  4: 412.24
     rank  5: 412.20
     rank  6: 412.21
     rank  7: 412.18
     rank  8: 366.08
     rank  9: 366.28
     rank 10: 366.05
     rank 11: 366.42
     rank 12: 416.97
     rank 13: 416.34
     rank 14: 417.21
     rank 15: 416.33
  optimizer-copy-to-main-grad:
     rank  0: 0.20
     rank  1: 0.30
     rank  2: 0.20
     rank  3: 0.28
     rank  4: 0.05
     rank  5: 0.08
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.10
     rank  9: 0.06
     rank 10: 0.03
     rank 11: 0.04
     rank 12: 0.11
     rank 13: 0.03
     rank 14: 0.10
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 19.41
     rank  1: 19.92
     rank  2: 19.58
     rank  3: 20.29
     rank  4: 49.56
     rank  5: 49.61
     rank  6: 49.53
     rank  7: 49.55
     rank  8: 43.80
     rank  9: 43.50
     rank 10: 43.17
     rank 11: 43.45
     rank 12: 50.23
     rank 13: 49.74
     rank 14: 50.03
     rank 15: 49.75
  optimizer:
     rank  0: 20.39
     rank  1: 20.90
     rank  2: 20.56
     rank  3: 21.30
     rank  4: 50.55
     rank  5: 50.60
     rank  6: 50.52
     rank  7: 50.53
     rank  8: 44.87
     rank  9: 44.49
     rank 10: 44.15
     rank 11: 44.44
     rank 12: 51.22
     rank 13: 50.72
     rank 14: 51.02
     rank 15: 50.74
 [2024-12-24 23:18:07] iteration        6/      10 | consumed samples:           96 | elapsed time per iteration (ms): 2700.5 | learning rate: 4.500000E-06 | global batch size:    16 | lm loss: 2.188767E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2619.73
     rank  1: 2619.57
     rank  2: 2619.74
     rank  3: 2619.54
     rank  4: 2622.68
     rank  5: 2622.47
     rank  6: 2622.68
     rank  7: 2622.44
     rank  8: 2622.22
     rank  9: 2622.07
     rank 10: 2622.17
     rank 11: 2622.16
     rank 12: 2622.79
     rank 13: 2622.43
     rank 14: 2622.72
     rank 15: 2622.40
  forward-compute:
     rank  0: 425.55
     rank  1: 426.59
     rank  2: 419.93
     rank  3: 423.24
     rank  4: 572.90
     rank  5: 575.55
     rank  6: 563.85
     rank  7: 565.97
     rank  8: 551.94
     rank  9: 553.07
     rank 10: 544.14
     rank 11: 538.79
     rank 12: 621.60
     rank 13: 623.37
     rank 14: 632.00
     rank 15: 646.63
  backward-compute:
     rank  0: 390.49
     rank  1: 394.64
     rank  2: 459.23
     rank  3: 455.16
     rank  4: 732.84
     rank  5: 732.83
     rank  6: 739.23
     rank  7: 732.82
     rank  8: 718.21
     rank  9: 718.89
     rank 10: 713.51
     rank 11: 729.22
     rank 12: 825.03
     rank 13: 826.90
     rank 14: 812.56
     rank 15: 814.12
  pure-backward-compute:
     rank  0: 390.02
     rank  1: 394.07
     rank  2: 458.89
     rank  3: 454.79
     rank  4: 732.28
     rank  5: 732.36
     rank  6: 738.57
     rank  7: 732.34
     rank  8: 717.21
     rank  9: 718.09
     rank 10: 712.91
     rank 11: 727.92
     rank 12: 822.88
     rank 13: 825.94
     rank 14: 809.98
     rank 15: 813.44
  batch-generator:
     rank  0: 23.98
     rank  1: 29.19
     rank  2: 23.57
     rank  3: 27.30
     rank  4: 33.38
     rank  5: 34.08
     rank  6: 28.29
     rank  7: 29.65
     rank  8: 35.59
     rank  9: 33.84
     rank 10: 24.87
     rank 11: 23.85
     rank 12: 29.45
     rank 13: 29.11
     rank 14: 33.95
     rank 15: 46.65
  forward-recv:
     rank  4: 57.89
     rank  5: 57.66
     rank  6: 60.18
     rank  7: 59.17
     rank  8: 135.80
     rank  9: 135.63
     rank 10: 138.82
     rank 11: 137.03
     rank 12: 200.80
     rank 13: 200.77
     rank 14: 198.23
     rank 15: 199.40
  forward-send:
     rank  0: 53.05
     rank  1: 51.50
     rank  2: 53.05
     rank  3: 51.58
     rank  4: 10.07
     rank  5: 9.66
     rank  6: 10.09
     rank  7: 9.48
     rank  8: 3.68
     rank  9: 3.68
     rank 10: 2.56
     rank 11: 3.67
  backward-recv:
     rank  0: 406.49
     rank  1: 403.88
     rank  2: 378.98
     rank  3: 381.13
     rank  4: 177.88
     rank  5: 178.50
     rank  6: 175.65
     rank  7: 175.62
     rank  8: 88.14
     rank  9: 87.81
     rank 10: 86.44
     rank 11: 85.57
  backward-send:
     rank  4: 6.51
     rank  5: 5.83
     rank  6: 6.22
     rank  7: 5.86
     rank  8: 7.92
     rank  9: 7.63
     rank 10: 7.12
     rank 11: 7.65
     rank 12: 3.68
     rank 13: 2.23
     rank 14: 2.65
     rank 15: 2.20
  forward-send-backward-recv:
     rank  0: 642.12
     rank  1: 638.70
     rank  2: 611.12
     rank  3: 610.83
     rank  4: 291.45
     rank  5: 291.24
     rank  6: 289.13
     rank  7: 296.62
     rank  8: 240.27
     rank  9: 239.70
     rank 10: 257.85
     rank 11: 240.66
  backward-send-forward-recv:
     rank  4: 20.65
     rank  5: 19.44
     rank  6: 22.53
     rank  7: 21.79
     rank  8: 31.79
     rank  9: 31.54
     rank 10: 24.83
     rank 11: 30.23
     rank 12: 34.73
     rank 13: 33.91
     rank 14: 35.48
     rank 15: 22.19
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.05
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.04
     rank 12: 0.06
     rank 13: 0.03
     rank 14: 0.06
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.06
     rank  2: 0.10
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.14
     rank 13: 0.05
     rank 14: 0.10
     rank 15: 0.04
  all-grads-sync:
     rank  0: 235.92
     rank  1: 236.03
     rank  2: 235.95
     rank  3: 236.05
     rank  4: 420.93
     rank  5: 420.46
     rank  6: 420.96
     rank  7: 420.46
     rank  8: 687.44
     rank  9: 687.54
     rank 10: 687.45
     rank 11: 687.59
     rank 12: 399.57
     rank 13: 399.08
     rank 14: 399.84
     rank 15: 399.19
  optimizer-copy-to-main-grad:
     rank  0: 0.20
     rank  1: 0.29
     rank  2: 0.24
     rank  3: 0.25
     rank  4: 0.04
     rank  5: 0.03
     rank  6: 0.04
     rank  7: 0.03
     rank  8: 0.06
     rank  9: 0.05
     rank 10: 0.06
     rank 11: 0.06
     rank 12: 0.11
     rank 13: 0.06
     rank 14: 0.06
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 19.42
     rank  1: 19.49
     rank  2: 19.61
     rank  3: 19.53
     rank  4: 49.60
     rank  5: 49.54
     rank  6: 49.66
     rank  7: 49.55
     rank  8: 43.54
     rank  9: 43.58
     rank 10: 43.52
     rank 11: 43.84
     rank 12: 50.32
     rank 13: 49.83
     rank 14: 50.13
     rank 15: 49.73
  optimizer:
     rank  0: 20.57
     rank  1: 20.63
     rank  2: 20.75
     rank  3: 20.67
     rank  4: 50.75
     rank  5: 50.69
     rank  6: 50.80
     rank  7: 50.69
     rank  8: 44.70
     rank  9: 44.76
     rank 10: 44.67
     rank 11: 44.99
     rank 12: 51.47
     rank 13: 50.97
     rank 14: 51.28
     rank 15: 50.88
 [2024-12-24 23:18:10] iteration        7/      10 | consumed samples:          112 | elapsed time per iteration (ms): 2445.9 | learning rate: 5.250000E-06 | global batch size:    16 | lm loss: 3.741390E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2362.71
     rank  1: 2362.65
     rank  2: 2362.75
     rank  3: 2362.60
     rank  4: 2365.55
     rank  5: 2365.54
     rank  6: 2365.50
     rank  7: 2365.52
     rank  8: 2364.92
     rank  9: 2364.90
     rank 10: 2364.93
     rank 11: 2364.89
     rank 12: 2365.57
     rank 13: 2365.42
     rank 14: 2365.56
     rank 15: 2365.38
  forward-compute:
     rank  0: 431.03
     rank  1: 429.55
     rank  2: 416.98
     rank  3: 419.58
     rank  4: 576.05
     rank  5: 575.88
     rank  6: 570.80
     rank  7: 568.43
     rank  8: 543.44
     rank  9: 544.70
     rank 10: 550.53
     rank 11: 546.94
     rank 12: 630.53
     rank 13: 632.72
     rank 14: 644.46
     rank 15: 660.76
  backward-compute:
     rank  0: 419.02
     rank  1: 420.27
     rank  2: 447.16
     rank  3: 436.15
     rank  4: 732.73
     rank  5: 732.63
     rank  6: 740.75
     rank  7: 735.32
     rank  8: 719.92
     rank  9: 721.11
     rank 10: 714.83
     rank 11: 736.23
     rank 12: 825.49
     rank 13: 826.77
     rank 14: 811.97
     rank 15: 810.79
  pure-backward-compute:
     rank  0: 418.63
     rank  1: 419.67
     rank  2: 446.61
     rank  3: 435.79
     rank  4: 731.57
     rank  5: 732.16
     rank  6: 740.20
     rank  7: 734.65
     rank  8: 718.35
     rank  9: 720.31
     rank 10: 714.08
     rank 11: 734.98
     rank 12: 823.60
     rank 13: 825.54
     rank 14: 808.98
     rank 15: 809.77
  batch-generator:
     rank  0: 25.83
     rank  1: 23.98
     rank  2: 24.38
     rank  3: 27.12
     rank  4: 37.54
     rank  5: 34.32
     rank  6: 25.58
     rank  7: 29.33
     rank  8: 28.85
     rank  9: 29.32
     rank 10: 34.20
     rank 11: 31.16
     rank 12: 35.88
     rank 13: 35.48
     rank 14: 35.86
     rank 15: 49.42
  forward-recv:
     rank  4: 59.21
     rank  5: 59.75
     rank  6: 59.80
     rank  7: 60.04
     rank  8: 136.67
     rank  9: 137.02
     rank 10: 135.26
     rank 11: 135.26
     rank 12: 202.48
     rank 13: 202.25
     rank 14: 202.62
     rank 15: 202.80
  forward-send:
     rank  0: 49.63
     rank  1: 50.20
     rank  2: 50.35
     rank  3: 50.47
     rank  4: 9.47
     rank  5: 9.37
     rank  6: 9.15
     rank  7: 9.20
     rank  8: 5.10
     rank  9: 4.82
     rank 10: 5.09
     rank 11: 5.24
  backward-recv:
     rank  0: 398.41
     rank  1: 395.98
     rank  2: 395.16
     rank  3: 400.51
     rank  4: 187.53
     rank  5: 188.39
     rank  6: 190.65
     rank  7: 188.26
     rank  8: 90.71
     rank  9: 91.29
     rank 10: 94.62
     rank 11: 88.88
  backward-send:
     rank  4: 6.92
     rank  5: 5.77
     rank  6: 4.85
     rank  7: 7.93
     rank  8: 9.15
     rank  9: 8.41
     rank 10: 7.80
     rank 11: 9.03
     rank 12: 4.00
     rank 13: 3.21
     rank 14: 5.51
     rank 15: 1.45
  forward-send-backward-recv:
     rank  0: 642.89
     rank  1: 640.85
     rank  2: 624.11
     rank  3: 626.72
     rank  4: 292.97
     rank  5: 292.63
     rank  6: 287.31
     rank  7: 292.69
     rank  8: 255.58
     rank  9: 255.66
     rank 10: 258.12
     rank 11: 239.37
  backward-send-forward-recv:
     rank  4: 21.57
     rank  5: 22.32
     rank  6: 22.67
     rank  7: 24.37
     rank  8: 30.57
     rank  9: 29.82
     rank 10: 26.14
     rank 11: 29.07
     rank 12: 34.56
     rank 13: 33.07
     rank 14: 32.54
     rank 15: 18.86
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.06
     rank  2: 0.04
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.08
     rank 13: 0.06
     rank 14: 0.08
     rank 15: 0.05
  all-grads-sync:
     rank  0: 233.72
     rank  1: 232.74
     rank  2: 232.72
     rank  3: 232.90
     rank  4: 412.88
     rank  5: 412.79
     rank  6: 412.90
     rank  7: 412.80
     rank  8: 377.48
     rank  9: 377.21
     rank 10: 377.50
     rank 11: 377.20
     rank 12: 407.53
     rank 13: 407.67
     rank 14: 407.53
     rank 15: 407.65
  optimizer-copy-to-main-grad:
     rank  0: 0.19
     rank  1: 0.30
     rank  2: 0.18
     rank  3: 0.29
     rank  4: 0.04
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.05
     rank  9: 0.03
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.06
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 19.55
     rank  1: 20.03
     rank  2: 19.55
     rank  3: 19.62
     rank  4: 49.55
     rank  5: 49.55
     rank  6: 49.57
     rank  7: 49.59
     rank  8: 43.46
     rank  9: 43.27
     rank 10: 43.40
     rank 11: 43.41
     rank 12: 50.15
     rank 13: 49.80
     rank 14: 49.96
     rank 15: 49.80
  optimizer:
     rank  0: 20.46
     rank  1: 20.95
     rank  2: 20.46
     rank  3: 20.53
     rank  4: 50.47
     rank  5: 50.46
     rank  6: 50.48
     rank  7: 50.51
     rank  8: 44.37
     rank  9: 44.19
     rank 10: 44.32
     rank 11: 44.32
     rank 12: 51.06
     rank 13: 50.71
     rank 14: 50.87
     rank 15: 50.71
 [2024-12-24 23:18:12] iteration        8/      10 | consumed samples:          128 | elapsed time per iteration (ms): 2453.6 | learning rate: 6.000000E-06 | global batch size:    16 | lm loss: 2.279715E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2373.41
     rank  1: 2373.31
     rank  2: 2373.37
     rank  3: 2373.28
     rank  4: 2376.36
     rank  5: 2376.20
     rank  6: 2376.33
     rank  7: 2376.19
     rank  8: 2375.77
     rank  9: 2375.61
     rank 10: 2375.71
     rank 11: 2375.66
     rank 12: 2376.40
     rank 13: 2376.14
     rank 14: 2376.34
     rank 15: 2376.11
  forward-compute:
     rank  0: 435.71
     rank  1: 437.78
     rank  2: 414.94
     rank  3: 416.42
     rank  4: 580.26
     rank  5: 581.97
     rank  6: 581.40
     rank  7: 584.48
     rank  8: 547.87
     rank  9: 549.83
     rank 10: 547.73
     rank 11: 547.11
     rank 12: 631.93
     rank 13: 634.39
     rank 14: 646.98
     rank 15: 661.18
  backward-compute:
     rank  0: 454.69
     rank  1: 455.13
     rank  2: 468.19
     rank  3: 470.28
     rank  4: 732.41
     rank  5: 732.59
     rank  6: 737.66
     rank  7: 735.12
     rank  8: 722.35
     rank  9: 722.57
     rank 10: 712.33
     rank 11: 728.68
     rank 12: 827.97
     rank 13: 828.48
     rank 14: 813.80
     rank 15: 813.41
  pure-backward-compute:
     rank  0: 454.29
     rank  1: 454.52
     rank  2: 467.73
     rank  3: 469.88
     rank  4: 731.07
     rank  5: 732.11
     rank  6: 737.06
     rank  7: 734.58
     rank  8: 721.07
     rank  9: 721.89
     rank 10: 711.52
     rank 11: 727.67
     rank 12: 825.79
     rank 13: 827.39
     rank 14: 811.37
     rank 15: 812.51
  batch-generator:
     rank  0: 22.83
     rank  1: 31.42
     rank  2: 22.62
     rank  3: 24.60
     rank  4: 41.69
     rank  5: 39.55
     rank  6: 33.78
     rank  7: 37.91
     rank  8: 33.51
     rank  9: 34.05
     rank 10: 30.87
     rank 11: 31.33
     rank 12: 36.79
     rank 13: 36.63
     rank 14: 36.34
     rank 15: 47.43
  forward-recv:
     rank  4: 59.84
     rank  5: 60.36
     rank  6: 59.34
     rank  7: 58.13
     rank  8: 137.24
     rank  9: 137.21
     rank 10: 136.63
     rank 11: 135.96
     rank 12: 202.67
     rank 13: 202.70
     rank 14: 202.79
     rank 15: 202.84
  forward-send:
     rank  0: 52.63
     rank  1: 51.94
     rank  2: 53.28
     rank  3: 51.28
     rank  4: 10.28
     rank  5: 9.86
     rank  6: 9.96
     rank  7: 9.34
     rank  8: 5.08
     rank  9: 4.99
     rank 10: 5.14
     rank 11: 5.24
  backward-recv:
     rank  0: 383.43
     rank  1: 380.09
     rank  2: 384.63
     rank  3: 384.54
     rank  4: 183.82
     rank  5: 185.89
     rank  6: 180.35
     rank  7: 181.79
     rank  8: 93.37
     rank  9: 93.59
     rank 10: 94.94
     rank 11: 91.31
  backward-send:
     rank  4: 6.28
     rank  5: 4.30
     rank  6: 5.58
     rank  7: 5.79
     rank  8: 7.33
     rank  9: 6.87
     rank 10: 5.82
     rank 11: 7.16
     rank 12: 3.48
     rank 13: 3.53
     rank 14: 3.81
     rank 15: 1.87
  forward-send-backward-recv:
     rank  0: 615.94
     rank  1: 613.17
     rank  2: 612.47
     rank  3: 610.69
     rank  4: 295.04
     rank  5: 295.09
     rank  6: 290.14
     rank  7: 291.89
     rank  8: 250.94
     rank  9: 250.53
     rank 10: 263.39
     rank 11: 247.97
  backward-send-forward-recv:
     rank  4: 18.01
     rank  5: 17.43
     rank  6: 20.07
     rank  7: 19.02
     rank  8: 29.57
     rank  9: 29.30
     rank 10: 25.54
     rank 11: 27.09
     rank 12: 34.41
     rank 13: 33.64
     rank 14: 31.97
     rank 15: 20.32
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.04
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.05
     rank  2: 0.05
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.10
     rank 13: 0.05
     rank 14: 0.08
     rank 15: 0.04
  all-grads-sync:
     rank  0: 234.21
     rank  1: 234.22
     rank  2: 234.23
     rank  3: 234.36
     rank  4: 422.15
     rank  5: 420.55
     rank  6: 422.16
     rank  7: 420.56
     rank  8: 368.33
     rank  9: 368.12
     rank 10: 368.32
     rank 11: 368.11
     rank 12: 420.56
     rank 13: 420.61
     rank 14: 420.65
     rank 15: 420.72
  optimizer-copy-to-main-grad:
     rank  0: 0.19
     rank  1: 0.29
     rank  2: 0.19
     rank  3: 0.25
     rank  4: 0.04
     rank  5: 0.03
     rank  6: 0.04
     rank  7: 0.03
     rank  8: 0.10
     rank  9: 0.04
     rank 10: 0.05
     rank 11: 0.04
     rank 12: 0.07
     rank 13: 0.04
     rank 14: 0.05
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 19.62
     rank  1: 20.06
     rank  2: 19.45
     rank  3: 19.53
     rank  4: 49.56
     rank  5: 49.53
     rank  6: 49.60
     rank  7: 49.77
     rank  8: 43.44
     rank  9: 43.29
     rank 10: 43.37
     rank 11: 43.40
     rank 12: 50.22
     rank 13: 49.86
     rank 14: 50.06
     rank 15: 49.73
  optimizer:
     rank  0: 20.55
     rank  1: 20.98
     rank  2: 20.37
     rank  3: 20.45
     rank  4: 50.50
     rank  5: 50.47
     rank  6: 50.53
     rank  7: 50.75
     rank  8: 44.39
     rank  9: 44.21
     rank 10: 44.30
     rank 11: 44.33
     rank 12: 51.16
     rank 13: 50.79
     rank 14: 50.99
     rank 15: 50.66
 [2024-12-24 23:18:14] iteration        9/      10 | consumed samples:          144 | elapsed time per iteration (ms): 2429.1 | learning rate: 6.750000E-06 | global batch size:    16 | lm loss: 1.792665E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2348.72
     rank  1: 2348.64
     rank  2: 2348.69
     rank  3: 2348.56
     rank  4: 2351.62
     rank  5: 2351.50
     rank  6: 2351.64
     rank  7: 2351.54
     rank  8: 2351.11
     rank  9: 2350.89
     rank 10: 2351.04
     rank 11: 2350.91
     rank 12: 2351.67
     rank 13: 2351.41
     rank 14: 2351.64
     rank 15: 2351.40
  forward-compute:
     rank  0: 429.97
     rank  1: 433.07
     rank  2: 412.23
     rank  3: 411.38
     rank  4: 575.34
     rank  5: 582.02
     rank  6: 574.85
     rank  7: 576.22
     rank  8: 545.49
     rank  9: 547.19
     rank 10: 544.69
     rank 11: 543.99
     rank 12: 624.67
     rank 13: 626.31
     rank 14: 631.47
     rank 15: 650.27
  backward-compute:
     rank  0: 442.37
     rank  1: 444.55
     rank  2: 444.08
     rank  3: 448.75
     rank  4: 733.39
     rank  5: 733.52
     rank  6: 740.69
     rank  7: 738.81
     rank  8: 720.39
     rank  9: 720.59
     rank 10: 713.55
     rank 11: 734.11
     rank 12: 825.61
     rank 13: 826.07
     rank 14: 814.73
     rank 15: 813.97
  pure-backward-compute:
     rank  0: 441.91
     rank  1: 443.97
     rank  2: 443.58
     rank  3: 448.39
     rank  4: 732.69
     rank  5: 733.07
     rank  6: 739.83
     rank  7: 738.21
     rank  8: 719.40
     rank  9: 719.82
     rank 10: 712.71
     rank 11: 733.11
     rank 12: 823.54
     rank 13: 825.01
     rank 14: 812.03
     rank 15: 813.02
  batch-generator:
     rank  0: 23.07
     rank  1: 28.94
     rank  2: 23.39
     rank  3: 22.63
     rank  4: 36.60
     rank  5: 41.56
     rank  6: 29.79
     rank  7: 33.57
     rank  8: 30.61
     rank  9: 30.97
     rank 10: 28.39
     rank 11: 28.91
     rank 12: 30.98
     rank 13: 30.34
     rank 14: 32.66
     rank 15: 52.18
  forward-recv:
     rank  4: 59.43
     rank  5: 59.17
     rank  6: 58.92
     rank  7: 58.97
     rank  8: 136.68
     rank  9: 136.61
     rank 10: 135.63
     rank 11: 135.05
     rank 12: 202.89
     rank 13: 202.72
     rank 14: 202.93
     rank 15: 202.98
  forward-send:
     rank  0: 54.96
     rank  1: 53.60
     rank  2: 53.42
     rank  3: 52.79
     rank  4: 9.47
     rank  5: 9.11
     rank  6: 9.42
     rank  7: 8.80
     rank  8: 5.18
     rank  9: 4.96
     rank 10: 5.10
     rank 11: 5.19
  backward-recv:
     rank  0: 386.98
     rank  1: 384.14
     rank  2: 373.42
     rank  3: 371.70
     rank  4: 180.45
     rank  5: 181.73
     rank  6: 175.48
     rank  7: 177.87
     rank  8: 90.64
     rank  9: 90.59
     rank 10: 92.20
     rank 11: 88.60
  backward-send:
     rank  4: 5.17
     rank  5: 3.64
     rank  6: 5.64
     rank  7: 4.74
     rank  8: 6.54
     rank  9: 6.23
     rank 10: 5.65
     rank 11: 6.65
     rank 12: 3.77
     rank 13: 3.65
     rank 14: 4.03
     rank 15: 1.84
  forward-send-backward-recv:
     rank  0: 610.83
     rank  1: 605.51
     rank  2: 639.30
     rank  3: 638.16
     rank  4: 290.47
     rank  5: 290.45
     rank  6: 284.69
     rank  7: 286.58
     rank  8: 247.97
     rank  9: 247.76
     rank 10: 255.34
     rank 11: 235.74
  backward-send-forward-recv:
     rank  4: 22.46
     rank  5: 17.07
     rank  6: 23.56
     rank  7: 22.86
     rank  8: 31.89
     rank  9: 31.10
     rank 10: 28.77
     rank 11: 30.37
     rank 12: 33.83
     rank 13: 33.76
     rank 14: 36.08
     rank 15: 20.15
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.04
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.04
     rank 12: 0.05
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.05
     rank  2: 0.04
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.05
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.12
     rank 13: 0.04
     rank 14: 0.08
     rank 15: 0.04
  all-grads-sync:
     rank  0: 230.57
     rank  1: 230.73
     rank  2: 230.61
     rank  3: 230.80
     rank  4: 414.76
     rank  5: 414.65
     rank  6: 414.76
     rank  7: 414.65
     rank  8: 373.66
     rank  9: 373.61
     rank 10: 373.63
     rank 11: 373.56
     rank 12: 407.31
     rank 13: 406.90
     rank 14: 406.99
     rank 15: 406.94
  optimizer-copy-to-main-grad:
     rank  0: 0.19
     rank  1: 0.30
     rank  2: 0.19
     rank  3: 0.25
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.04
     rank  7: 0.04
     rank  8: 0.10
     rank  9: 0.03
     rank 10: 0.05
     rank 11: 0.04
     rank 12: 0.08
     rank 13: 0.03
     rank 14: 0.05
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 19.63
     rank  1: 19.90
     rank  2: 19.68
     rank  3: 19.65
     rank  4: 49.51
     rank  5: 49.54
     rank  6: 49.60
     rank  7: 49.65
     rank  8: 43.54
     rank  9: 43.33
     rank 10: 43.45
     rank 11: 43.50
     rank 12: 50.02
     rank 13: 49.77
     rank 14: 50.09
     rank 15: 49.76
  optimizer:
     rank  0: 20.55
     rank  1: 20.81
     rank  2: 20.60
     rank  3: 20.57
     rank  4: 50.43
     rank  5: 50.46
     rank  6: 50.53
     rank  7: 50.58
     rank  8: 44.47
     rank  9: 44.25
     rank 10: 44.38
     rank 11: 44.43
     rank 12: 50.94
     rank 13: 50.70
     rank 14: 51.02
     rank 15: 50.69
 [2024-12-24 23:18:17] iteration       10/      10 | consumed samples:          160 | elapsed time per iteration (ms): 2439.2 | learning rate: 7.500000E-06 | global batch size:    16 | lm loss: 2.748606E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2358.50
     rank  1: 2358.52
     rank  2: 2358.48
     rank  3: 2358.51
     rank  4: 2361.43
     rank  5: 2361.25
     rank  6: 2362.20
     rank  7: 2361.22
     rank  8: 2360.85
     rank  9: 2360.63
     rank 10: 2360.80
     rank 11: 2360.67
     rank 12: 2361.43
     rank 13: 2361.16
     rank 14: 2361.39
     rank 15: 2361.14
  forward-compute:
     rank  0: 431.80
     rank  1: 436.52
     rank  2: 426.59
     rank  3: 425.33
     rank  4: 567.53
     rank  5: 574.11
     rank  6: 575.76
     rank  7: 577.68
     rank  8: 554.69
     rank  9: 558.04
     rank 10: 545.48
     rank 11: 544.02
     rank 12: 622.05
     rank 13: 622.92
     rank 14: 628.82
     rank 15: 644.23
  backward-compute:
     rank  0: 435.70
     rank  1: 437.15
     rank  2: 446.87
     rank  3: 452.87
     rank  4: 732.30
     rank  5: 732.77
     rank  6: 742.84
     rank  7: 740.03
     rank  8: 720.90
     rank  9: 720.47
     rank 10: 712.28
     rank 11: 730.88
     rank 12: 824.08
     rank 13: 825.08
     rank 14: 816.03
     rank 15: 816.03
  pure-backward-compute:
     rank  0: 435.36
     rank  1: 436.59
     rank  2: 446.44
     rank  3: 452.47
     rank  4: 731.59
     rank  5: 732.31
     rank  6: 741.80
     rank  7: 739.40
     rank  8: 719.70
     rank  9: 719.83
     rank 10: 711.51
     rank 11: 729.73
     rank 12: 822.52
     rank 13: 824.29
     rank 14: 813.89
     rank 15: 815.28
  batch-generator:
     rank  0: 23.58
     rank  1: 33.53
     rank  2: 26.06
     rank  3: 24.23
     rank  4: 31.09
     rank  5: 37.11
     rank  6: 34.16
     rank  7: 34.73
     rank  8: 35.49
     rank  9: 35.00
     rank 10: 32.08
     rank 11: 30.48
     rank 12: 29.57
     rank 13: 27.54
     rank 14: 31.79
     rank 15: 45.07
  forward-recv:
     rank  4: 58.31
     rank  5: 56.83
     rank  6: 58.09
     rank  7: 58.22
     rank  8: 134.21
     rank  9: 132.94
     rank 10: 136.92
     rank 11: 135.76
     rank 12: 201.65
     rank 13: 201.60
     rank 14: 200.20
     rank 15: 201.09
  forward-send:
     rank  0: 51.21
     rank  1: 48.27
     rank  2: 55.46
     rank  3: 55.06
     rank  4: 9.99
     rank  5: 8.57
     rank  6: 9.61
     rank  7: 9.56
     rank  8: 4.69
     rank  9: 4.60
     rank 10: 3.77
     rank 11: 4.78
  backward-recv:
     rank  0: 391.21
     rank  1: 386.70
     rank  2: 379.72
     rank  3: 379.10
     rank  4: 181.41
     rank  5: 183.49
     rank  6: 179.65
     rank  7: 180.96
     rank  8: 90.36
     rank  9: 90.52
     rank 10: 91.62
     rank 11: 88.70
  backward-send:
     rank  4: 7.67
     rank  5: 4.71
     rank  6: 7.68
     rank  7: 6.85
     rank  8: 9.37
     rank  9: 9.28
     rank 10: 8.66
     rank 11: 9.14
     rank 12: 4.22
     rank 13: 4.21
     rank 14: 4.41
     rank 15: 2.20
  forward-send-backward-recv:
     rank  0: 618.75
     rank  1: 615.15
     rank  2: 620.83
     rank  3: 617.14
     rank  4: 294.59
     rank  5: 294.27
     rank  6: 276.58
     rank  7: 280.56
     rank  8: 236.48
     rank  9: 236.65
     rank 10: 254.98
     rank 11: 237.72
  backward-send-forward-recv:
     rank  4: 22.74
     rank  5: 19.43
     rank  6: 24.09
     rank  7: 22.32
     rank  8: 30.77
     rank  9: 30.46
     rank 10: 27.27
     rank 11: 28.83
     rank 12: 35.61
     rank 13: 35.42
     rank 14: 36.64
     rank 15: 22.68
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.05
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.05
     rank  2: 0.04
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.12
     rank 13: 0.04
     rank 14: 0.07
     rank 15: 0.04
  all-grads-sync:
     rank  0: 236.18
     rank  1: 236.15
     rank  2: 236.20
     rank  3: 236.29
     rank  4: 418.28
     rank  5: 416.82
     rank  6: 418.27
     rank  7: 416.82
     rank  8: 367.85
     rank  9: 367.77
     rank 10: 367.85
     rank 11: 367.76
     rank 12: 411.98
     rank 13: 412.02
     rank 14: 412.06
     rank 15: 412.03
  optimizer-copy-to-main-grad:
     rank  0: 0.20
     rank  1: 0.29
     rank  2: 0.18
     rank  3: 0.25
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.04
     rank  7: 0.03
     rank  8: 0.05
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.08
     rank 13: 0.03
     rank 14: 0.05
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 19.48
     rank  1: 19.72
     rank  2: 19.35
     rank  3: 19.52
     rank  4: 49.48
     rank  5: 49.54
     rank  6: 49.63
     rank  7: 49.56
     rank  8: 43.46
     rank  9: 43.20
     rank 10: 43.40
     rank 11: 43.40
     rank 12: 50.05
     rank 13: 49.75
     rank 14: 49.97
     rank 15: 49.73
  optimizer:
     rank  0: 20.41
     rank  1: 20.64
     rank  2: 20.27
     rank  3: 20.44
     rank  4: 50.41
     rank  5: 50.46
     rank  6: 50.56
     rank  7: 50.48
     rank  8: 44.39
     rank  9: 44.13
     rank 10: 44.33
     rank 11: 44.33
     rank 12: 50.99
     rank 13: 50.68
     rank 14: 50.90
     rank 15: 50.66
