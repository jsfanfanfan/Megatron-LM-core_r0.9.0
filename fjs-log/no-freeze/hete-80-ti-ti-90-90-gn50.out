examples/multimodal/pretrain-freeze-llm-hete-2080first.sh: line 4: activate: No such file or directory
4
[2024-12-31 14:12:07,405] torch.distributed.run: [WARNING] 
[2024-12-31 14:12:07,405] torch.distributed.run: [WARNING] *****************************************
[2024-12-31 14:12:07,405] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-12-31 14:12:07,405] torch.distributed.run: [WARNING] *****************************************
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:20------
------num_pipeline_model_parallel_groups:4------
> setting tensorboard ...
WARNING: one_logger package is required to enable e2e metrics tracking. please go to https://confluence.nvidia.com/display/MLWFO/Package+Repositories for details to install it
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:20------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:20------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:20------
------num_pipeline_model_parallel_groups:4------
---Rank 19---Tensor Parallel Group GPUs: [3, 3, 3, 3]---Rank 16---Tensor Parallel Group GPUs: [0, 0, 0, 0]---Rank 18---Tensor Parallel Group GPUs: [2, 2, 2, 2]---Rank 17---Tensor Parallel Group GPUs: [1, 1, 1, 1]



---Rank 16---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]---Rank 19---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]

---Rank 17---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]---Rank 18---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]

[rank16]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank19]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank17]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank18]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
 > number of parameters on (tensor, pipeline) model parallel rank (1, 4): 578899968
 > number of parameters on (tensor, pipeline) model parallel rank (3, 4): 578899968
 > number of parameters on (tensor, pipeline) model parallel rank (2, 4): 578899968
 > number of parameters on (tensor, pipeline) model parallel rank (0, 4): 578899968
INFO:megatron.core.distributed.param_and_grad_buffer:Number of buckets for gradient all-reduce / reduce-scatter: 1
Params for bucket 1 (578899968 elements):
	language_model.decoder.layers.9.mlp.linear_fc1.weight
	language_model.decoder.layers.6.mlp.linear_fc1.weight
	language_model.decoder.layers.6.self_attention.linear_qkv.weight
	language_model.decoder.layers.5.mlp.linear_fc2.weight
	language_model.decoder.layers.4.mlp.linear_fc2.weight
	language_model.decoder.layers.3.mlp.linear_fc1.weight
	language_model.decoder.layers.2.self_attention.linear_qkv.weight
	language_model.decoder.layers.1.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.0.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.7.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.9.self_attention.linear_proj.weight
	language_model.decoder.layers.6.self_attention.linear_proj.weight
	language_model.decoder.layers.5.mlp.linear_fc1.weight
	language_model.decoder.layers.5.self_attention.linear_proj.weight
	language_model.decoder.layers.4.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.3.self_attention.linear_proj.weight
	language_model.decoder.layers.2.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.0.mlp.linear_fc2.weight
	language_model.decoder.layers.0.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.8.mlp.linear_fc2.weight
	language_model.decoder.layers.8.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.7.self_attention.linear_qkv.weight
	language_model.decoder.layers.4.self_attention.linear_qkv.weight
	language_model.decoder.layers.3.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.1.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.0.self_attention.linear_proj.weight
	language_model.output_layer.weight
	language_model.decoder.layers.9.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.8.mlp.linear_fc1.weight
	language_model.decoder.layers.6.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.4.mlp.linear_fc1.weight
	language_model.decoder.layers.3.mlp.linear_fc2.weight
	language_model.decoder.layers.2.self_attention.linear_proj.weight
	language_model.decoder.layers.1.mlp.linear_fc2.weight
	language_model.decoder.layers.9.self_attention.linear_qkv.weight
	language_model.decoder.layers.8.self_attention.linear_proj.weight
	language_model.decoder.layers.3.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.1.self_attention.linear_proj.weight
	language_model.decoder.final_layernorm.weight
	language_model.decoder.layers.7.mlp.linear_fc2.weight
	language_model.decoder.layers.7.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.5.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.4.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.4.self_attention.linear_proj.weight
	language_model.decoder.layers.2.mlp.linear_fc1.weight
	language_model.decoder.layers.0.self_attention.linear_qkv.weight
	language_model.decoder.layers.8.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.7.mlp.linear_fc1.weight
	language_model.decoder.layers.6.mlp.linear_fc2.weight
	language_model.decoder.layers.5.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.3.self_attention.linear_qkv.weight
	language_model.decoder.layers.2.mlp.linear_fc2.weight
	language_model.decoder.layers.9.mlp.linear_fc2.weight
	language_model.decoder.layers.9.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.8.self_attention.linear_qkv.weight
	language_model.decoder.layers.7.self_attention.linear_proj.weight
	language_model.decoder.layers.6.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.5.self_attention.linear_qkv.weight
	language_model.decoder.layers.2.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.1.mlp.linear_fc1.weight
	language_model.decoder.layers.1.self_attention.linear_qkv.weight
	language_model.decoder.layers.0.mlp.linear_fc1.weight
rank=0, worker=0: shard_range=[pretrain-0.tar[0, 100), pretrain-0.tar[100, 200), pretrain-0.tar[200, 300), ...<2494>, pretrain-30.tar[9700, 9800), pretrain-30.tar[9800, 9900), pretrain-30.tar[9900, 10000)] sum(count)=250000
rank=0, worker=1: shard_range=[pretrain-31.tar[0, 100), pretrain-31.tar[100, 200), pretrain-31.tar[200, 300), ...<2494>, pretrain-53.tar[9700, 9800), pretrain-53.tar[9800, 9900), pretrain-53.tar[9900, 10000)] sum(count)=250000
rank=0, worker=0: shard_range=[pretrain-54.tar[0, 10000), pretrain-55.tar[0, 8128), pretrain-6.tar[0, 10000), pretrain-7.tar[0, 936)] sum(count)=29064
rank=0, worker=1: shard_range=[pretrain-7.tar[936, 10000), pretrain-8.tar[0, 10000), pretrain-9.tar[0, 10000)] sum(count)=29064
times across ranks (ms):
  model-and-optimizer-setup:
     rank  0: 98.01
     rank  1: 97.55
     rank  2: 95.64
     rank  3: 96.85
     rank  4: 73.53
     rank  5: 79.00
     rank  6: 69.52
     rank  7: 66.30
     rank  8: 74.34
     rank  9: 62.34
     rank 10: 73.49
     rank 11: 65.91
     rank 12: 48.11
     rank 13: 43.47
     rank 14: 38.73
     rank 15: 57.62
     rank 16: 54.19
     rank 17: 38.82
     rank 18: 38.96
     rank 19: 38.95
  train/valid/test-data-iterators-setup:
     rank  0: 1025.29
     rank  1: 1025.15
     rank  2: 1307.98
     rank  3: 1025.08
     rank  4: 1307.38
     rank  5: 1307.33
     rank  6: 1025.15
     rank  7: 1307.55
     rank  8: 1307.36
     rank  9: 1307.79
     rank 10: 1307.62
     rank 11: 1307.42
     rank 12: 1307.44
     rank 13: 1307.42
     rank 14: 1307.37
     rank 15: 1307.37
     rank 16: 1307.41
     rank 17: 1307.53
     rank 18: 1307.44
     rank 19: 1307.53
 [2024-12-31 14:12:47] iteration        1/      10 | consumed samples:           32 | elapsed time per iteration (ms): 20350.2 | learning rate: 7.500000E-07 | global batch size:    32 | lm loss: 7.004793E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
[Rank 18] (after 1 iterations) memory (MB) | allocated: 8886.5654296875 | max allocated: 11093.923828125 | reserved: 11896.0 | max reserved: 11896.0
[Rank 17] (after 1 iterations) memory (MB) | allocated: 8886.5654296875 | max allocated: 11093.923828125 | reserved: 11998.0 | max reserved: 11998.0
[Rank 19] (after 1 iterations) memory (MB) | allocated: 8886.5654296875 | max allocated: 11093.923828125 | reserved: 11896.0 | max reserved: 11896.0
stage5 GPU utialization:135.4238748550415 %
[Rank 16] (after 1 iterations) memory (MB) | allocated: 8886.5654296875 | max allocated: 11093.923828125 | reserved: 11998.0 | max reserved: 11998.0
times across ranks (ms):
  forward-backward:
     rank  0: 20260.91
     rank  1: 20261.00
     rank  2: 20260.94
     rank  3: 20260.96
     rank  4: 20260.83
     rank  5: 20260.71
     rank  6: 20260.70
     rank  7: 20260.48
     rank  8: 20261.47
     rank  9: 20261.08
     rank 10: 20262.78
     rank 11: 20260.44
     rank 12: 20260.71
     rank 13: 20260.55
     rank 14: 20260.45
     rank 15: 20260.46
     rank 16: 20260.13
     rank 17: 20260.11
     rank 18: 20260.12
     rank 19: 20260.20
  forward-compute:
     rank  0: 5535.48
     rank  1: 5528.76
     rank  2: 5523.76
     rank  3: 5520.38
     rank  4: 5101.10
     rank  5: 5094.85
     rank  6: 5104.78
     rank  7: 5076.12
     rank  8: 4694.16
     rank  9: 4693.06
     rank 10: 4688.96
     rank 11: 4688.65
     rank 12: 6398.95
     rank 13: 6398.23
     rank 14: 6398.81
     rank 15: 6406.76
     rank 16: 5772.92
     rank 17: 5767.80
     rank 18: 5789.27
     rank 19: 5792.26
  backward-compute:
     rank  0: 3794.06
     rank  1: 3800.10
     rank  2: 3842.70
     rank  3: 3802.39
     rank  4: 4173.92
     rank  5: 4158.02
     rank  6: 4150.45
     rank  7: 4174.84
     rank  8: 4300.90
     rank  9: 4308.67
     rank 10: 4316.84
     rank 11: 4325.01
     rank 12: 4668.21
     rank 13: 4661.07
     rank 14: 4682.76
     rank 15: 4684.33
     rank 16: 4434.66
     rank 17: 4432.99
     rank 18: 4431.86
     rank 19: 4428.20
  pure-backward-compute:
     rank  0: 3792.41
     rank  1: 3798.38
     rank  2: 3841.02
     rank  3: 3800.63
     rank  4: 4171.04
     rank  5: 4155.39
     rank  6: 4148.25
     rank  7: 4171.67
     rank  8: 4298.02
     rank  9: 4304.78
     rank 10: 4311.41
     rank 11: 4321.75
     rank 12: 4664.60
     rank 13: 4657.51
     rank 14: 4681.15
     rank 15: 4682.66
     rank 16: 4430.11
     rank 17: 4428.75
     rank 18: 4428.41
     rank 19: 4424.05
  batch-generator:
     rank  0: 1109.77
     rank  1: 1113.35
     rank  2: 1111.93
     rank  3: 1122.22
     rank  4: 1332.03
     rank  5: 1336.38
     rank  6: 1362.29
     rank  7: 1316.40
     rank  8: 1330.74
     rank  9: 1331.68
     rank 10: 1324.11
     rank 11: 1336.48
     rank 12: 1259.31
     rank 13: 1264.21
     rank 14: 1261.25
     rank 15: 1270.27
     rank 16: 1002.02
     rank 17: 999.28
     rank 18: 1016.08
     rank 19: 1019.34
  forward-recv:
     rank  4: 2232.48
     rank  5: 2234.52
     rank  6: 2229.46
     rank  7: 2231.09
     rank  8: 3707.41
     rank  9: 3713.92
     rank 10: 3716.52
     rank 11: 3716.86
     rank 12: 5141.56
     rank 13: 5141.33
     rank 14: 5145.58
     rank 15: 5146.36
     rank 16: 7733.92
     rank 17: 7732.85
     rank 18: 7733.49
     rank 19: 7732.86
  forward-send:
     rank  0: 5322.61
     rank  1: 5328.17
     rank  2: 5331.78
     rank  3: 5333.86
     rank  4: 3809.05
     rank  5: 3813.06
     rank  6: 3822.47
     rank  7: 3822.07
     rank  8: 2505.70
     rank  9: 2503.00
     rank 10: 2508.79
     rank 11: 2508.95
     rank 12: 32.96
     rank 13: 31.32
     rank 14: 32.41
     rank 15: 31.57
  backward-recv:
     rank  0: 732.55
     rank  1: 731.99
     rank  2: 727.55
     rank  3: 730.19
     rank  4: 426.03
     rank  5: 427.32
     rank  6: 430.94
     rank  7: 428.62
     rank  8: 263.82
     rank  9: 262.79
     rank 10: 262.84
     rank 11: 261.74
     rank 12: 109.20
     rank 13: 109.40
     rank 14: 109.82
     rank 15: 109.86
  backward-send:
     rank  4: 10.53
     rank  5: 10.29
     rank  6: 7.45
     rank  7: 9.90
     rank  8: 15.10
     rank  9: 15.11
     rank 10: 15.64
     rank 11: 15.53
     rank 12: 10.46
     rank 13: 10.36
     rank 14: 10.07
     rank 15: 9.47
     rank 16: 5.16
     rank 17: 5.10
     rank 18: 4.97
     rank 19: 4.56
  forward-send-backward-recv:
     rank  0: 4770.35
     rank  1: 4764.32
     rank  2: 4730.75
     rank  3: 4768.53
     rank  4: 3290.05
     rank  5: 3301.62
     rank  6: 3302.15
     rank  7: 3293.00
     rank  8: 3264.90
     rank  9: 3253.98
     rank 10: 3248.79
     rank 11: 3241.56
     rank 12: 2347.61
     rank 13: 2356.39
     rank 14: 2344.92
     rank 15: 2342.83
  backward-send-forward-recv:
     rank  4: 1037.50
     rank  5: 1040.90
     rank  6: 1026.06
     rank  7: 1042.62
     rank  8: 1196.38
     rank  9: 1193.77
     rank 10: 1188.77
     rank 11: 1191.24
     rank 12: 1089.86
     rank 13: 1092.45
     rank 14: 1087.67
     rank 15: 1080.28
     rank 16: 1708.66
     rank 17: 1717.07
     rank 18: 1701.47
     rank 19: 1701.39
  layernorm-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.05
     rank  2: 0.06
     rank  3: 0.05
     rank  4: 0.08
     rank  5: 0.06
     rank  6: 0.06
     rank  7: 0.06
     rank  8: 0.07
     rank  9: 0.07
     rank 10: 0.10
     rank 11: 0.04
     rank 12: 0.03
     rank 13: 0.04
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.04
  embedding-grads-all-reduce:
     rank  0: 0.12
     rank  1: 0.11
     rank  2: 0.12
     rank  3: 0.12
     rank  4: 0.07
     rank  5: 0.07
     rank  6: 0.06
     rank  7: 0.06
     rank  8: 0.06
     rank  9: 0.06
     rank 10: 0.07
     rank 11: 0.03
     rank 12: 0.04
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.05
     rank 17: 0.05
     rank 18: 0.05
     rank 19: 0.09
  all-grads-sync:
     rank  0: 56.72
     rank  1: 59.33
     rank  2: 59.60
     rank  3: 59.36
     rank  4: 64.20
     rank  5: 64.29
     rank  6: 64.30
     rank  7: 59.03
     rank  8: 65.91
     rank  9: 59.36
     rank 10: 64.69
     rank 11: 63.45
     rank 12: 45.48
     rank 13: 47.20
     rank 14: 47.15
     rank 15: 47.49
     rank 16: 3.07
     rank 17: 3.08
     rank 18: 3.19
     rank 19: 3.39
  optimizer-copy-to-main-grad:
     rank  0: 0.30
     rank  1: 0.29
     rank  2: 0.29
     rank  3: 0.28
     rank  4: 0.10
     rank  5: 0.09
     rank  6: 0.09
     rank  7: 0.09
     rank  8: 0.18
     rank  9: 0.07
     rank 10: 0.08
     rank 11: 0.11
     rank 12: 0.14
     rank 13: 0.08
     rank 14: 0.07
     rank 15: 0.07
     rank 16: 0.06
     rank 17: 0.07
     rank 18: 0.06
     rank 19: 0.10
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.04
     rank  9: 0.02
     rank 10: 0.08
     rank 11: 0.04
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.04
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.04
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 42.52
     rank  1: 42.33
     rank  2: 41.84
     rank  3: 45.40
     rank  4: 74.71
     rank  5: 75.21
     rank  6: 75.03
     rank  7: 70.09
     rank  8: 78.23
     rank  9: 75.12
     rank 10: 81.47
     rank 11: 77.84
     rank 12: 79.25
     rank 13: 79.07
     rank 14: 79.03
     rank 15: 78.31
     rank 16: 78.53
     rank 17: 75.42
     rank 18: 76.34
     rank 19: 76.07
  optimizer:
     rank  0: 44.23
     rank  1: 44.03
     rank  2: 43.54
     rank  3: 47.10
     rank  4: 76.41
     rank  5: 76.91
     rank  6: 76.74
     rank  7: 71.79
     rank  8: 79.90
     rank  9: 76.83
     rank 10: 83.18
     rank 11: 79.52
     rank 12: 80.98
     rank 13: 80.77
     rank 14: 80.72
     rank 15: 80.01
     rank 16: 80.24
     rank 17: 77.13
     rank 18: 78.05
     rank 19: 77.77
 [2024-12-31 14:12:57] iteration        2/      10 | consumed samples:           64 | elapsed time per iteration (ms): 10048.5 | learning rate: 1.500000E-06 | global batch size:    32 | lm loss: 6.954518E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 9940.20
     rank  1: 9940.20
     rank  2: 9940.33
     rank  3: 9940.36
     rank  4: 9942.86
     rank  5: 9942.82
     rank  6: 9942.86
     rank  7: 9942.90
     rank  8: 9943.23
     rank  9: 9943.15
     rank 10: 9943.29
     rank 11: 9943.25
     rank 12: 9943.87
     rank 13: 9943.85
     rank 14: 9943.88
     rank 15: 9943.88
     rank 16: 9943.63
     rank 17: 9943.62
     rank 18: 9943.61
     rank 19: 9943.60
  forward-compute:
     rank  0: 3446.08
     rank  1: 3446.06
     rank  2: 3449.16
     rank  3: 3446.73
     rank  4: 3698.70
     rank  5: 3695.70
     rank  6: 3715.62
     rank  7: 3695.96
     rank  8: 3375.19
     rank  9: 3375.84
     rank 10: 3381.21
     rank 11: 3379.31
     rank 12: 3935.06
     rank 13: 3931.12
     rank 14: 3943.18
     rank 15: 3941.55
     rank 16: 3735.82
     rank 17: 3737.19
     rank 18: 3749.81
     rank 19: 3746.74
  backward-compute:
     rank  0: 2952.70
     rank  1: 2955.32
     rank  2: 3001.45
     rank  3: 2969.83
     rank  4: 4126.47
     rank  5: 4109.06
     rank  6: 4094.88
     rank  7: 4108.14
     rank  8: 4299.09
     rank  9: 4303.95
     rank 10: 4314.99
     rank 11: 4311.77
     rank 12: 4651.49
     rank 13: 4652.04
     rank 14: 4675.00
     rank 15: 4668.98
     rank 16: 4430.93
     rank 17: 4429.65
     rank 18: 4438.28
     rank 19: 4435.35
  pure-backward-compute:
     rank  0: 2951.20
     rank  1: 2953.76
     rank  2: 2999.91
     rank  3: 2968.12
     rank  4: 4124.02
     rank  5: 4106.85
     rank  6: 4092.70
     rank  7: 4105.65
     rank  8: 4296.30
     rank  9: 4300.72
     rank 10: 4312.26
     rank 11: 4308.99
     rank 12: 4648.75
     rank 13: 4649.28
     rank 14: 4673.55
     rank 15: 4667.35
     rank 16: 4426.59
     rank 17: 4425.49
     rank 18: 4435.05
     rank 19: 4431.98
  batch-generator:
     rank  0: 209.81
     rank  1: 219.99
     rank  2: 223.87
     rank  3: 232.22
     rank  4: 119.11
     rank  5: 123.30
     rank  6: 163.67
     rank  7: 146.94
     rank  8: 107.02
     rank  9: 106.50
     rank 10: 108.44
     rank 11: 114.51
     rank 12: 104.09
     rank 13: 104.23
     rank 14: 112.97
     rank 15: 113.86
     rank 16: 94.61
     rank 17: 97.45
     rank 18: 108.91
     rank 19: 107.04
  forward-recv:
     rank  4: 113.34
     rank  5: 113.42
     rank  6: 111.66
     rank  7: 111.38
     rank  8: 242.95
     rank  9: 241.65
     rank 10: 240.72
     rank 11: 240.86
     rank 12: 341.14
     rank 13: 343.50
     rank 14: 342.31
     rank 15: 342.22
     rank 16: 464.16
     rank 17: 464.10
     rank 18: 463.92
     rank 19: 463.84
  forward-send:
     rank  0: 54.05
     rank  1: 53.84
     rank  2: 49.20
     rank  3: 49.29
     rank  4: 21.26
     rank  5: 21.44
     rank  6: 19.66
     rank  7: 19.42
     rank  8: 21.76
     rank  9: 22.38
     rank 10: 21.20
     rank 11: 21.30
     rank 12: 5.23
     rank 13: 5.13
     rank 14: 4.75
     rank 15: 4.75
  backward-recv:
     rank  0: 739.12
     rank  1: 738.55
     rank  2: 733.68
     rank  3: 736.68
     rank  4: 422.69
     rank  5: 426.12
     rank  6: 429.65
     rank  7: 426.58
     rank  8: 260.98
     rank  9: 259.18
     rank 10: 259.03
     rank 11: 259.19
     rank 12: 110.26
     rank 13: 110.29
     rank 14: 110.62
     rank 15: 110.72
  backward-send:
     rank  4: 10.51
     rank  5: 10.12
     rank  6: 6.94
     rank  7: 9.74
     rank  8: 14.05
     rank  9: 15.61
     rank 10: 15.57
     rank 11: 15.33
     rank 12: 10.44
     rank 13: 10.31
     rank 14: 10.08
     rank 15: 9.58
     rank 16: 5.18
     rank 17: 5.22
     rank 18: 4.94
     rank 19: 4.76
  forward-send-backward-recv:
     rank  0: 2709.80
     rank  1: 2707.34
     rank  2: 2670.14
     rank  3: 2699.89
     rank  4: 1291.18
     rank  5: 1306.31
     rank  6: 1314.45
     rank  7: 1308.14
     rank  8: 1252.20
     rank  9: 1240.79
     rank 10: 1229.38
     rank 11: 1237.22
     rank 12: 298.85
     rank 13: 300.15
     rank 14: 287.83
     rank 15: 292.96
  backward-send-forward-recv:
     rank  4: 144.46
     rank  5: 147.06
     rank  6: 129.29
     rank  7: 148.64
     rank  8: 232.94
     rank  9: 236.42
     rank 10: 235.50
     rank 11: 233.66
     rank 12: 196.71
     rank 13: 198.09
     rank 14: 187.22
     rank 15: 188.74
     rank 16: 766.17
     rank 17: 767.32
     rank 18: 753.07
     rank 19: 757.90
  layernorm-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.03
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.08
     rank  1: 0.08
     rank  2: 0.08
     rank  3: 0.09
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.05
     rank 17: 0.05
     rank 18: 0.05
     rank 19: 0.05
  all-grads-sync:
     rank  0: 1.06
     rank  1: 1.13
     rank  2: 1.21
     rank  3: 1.25
     rank  4: 2.52
     rank  5: 2.43
     rank  6: 2.43
     rank  7: 2.42
     rank  8: 2.58
     rank  9: 2.47
     rank 10: 2.61
     rank 11: 2.53
     rank 12: 2.99
     rank 13: 3.00
     rank 14: 2.89
     rank 15: 2.93
     rank 16: 2.89
     rank 17: 2.89
     rank 18: 2.86
     rank 19: 2.86
  optimizer-copy-to-main-grad:
     rank  0: 0.27
     rank  1: 0.27
     rank  2: 0.32
     rank  3: 0.28
     rank  4: 0.11
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.06
     rank  8: 0.06
     rank  9: 0.05
     rank 10: 0.10
     rank 11: 0.05
     rank 12: 0.07
     rank 13: 0.06
     rank 14: 0.05
     rank 15: 0.05
     rank 16: 0.06
     rank 17: 0.06
     rank 18: 0.06
     rank 19: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 19.79
     rank  1: 19.76
     rank  2: 20.15
     rank  3: 19.97
     rank  4: 48.00
     rank  5: 48.82
     rank  6: 48.54
     rank  7: 48.08
     rank  8: 52.02
     rank  9: 52.00
     rank 10: 52.28
     rank 11: 52.18
     rank 12: 59.00
     rank 13: 59.05
     rank 14: 59.05
     rank 15: 59.03
     rank 16: 57.02
     rank 17: 56.93
     rank 18: 57.01
     rank 19: 57.02
  optimizer:
     rank  0: 21.09
     rank  1: 21.07
     rank  2: 21.49
     rank  3: 21.28
     rank  4: 49.31
     rank  5: 50.13
     rank  6: 49.85
     rank  7: 49.39
     rank  8: 53.34
     rank  9: 53.31
     rank 10: 53.59
     rank 11: 53.59
     rank 12: 60.32
     rank 13: 60.36
     rank 14: 60.37
     rank 15: 60.34
     rank 16: 58.33
     rank 17: 58.23
     rank 18: 58.32
     rank 19: 58.33
 [2024-12-31 14:13:07] iteration        3/      10 | consumed samples:           96 | elapsed time per iteration (ms): 10077.2 | learning rate: 2.250000E-06 | global batch size:    32 | lm loss: 3.857646E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 9964.33
     rank  1: 9964.49
     rank  2: 9964.31
     rank  3: 9964.47
     rank  4: 9967.03
     rank  5: 9967.04
     rank  6: 9967.02
     rank  7: 9967.02
     rank  8: 9967.40
     rank  9: 9967.42
     rank 10: 9967.32
     rank 11: 9967.37
     rank 12: 9967.97
     rank 13: 9968.06
     rank 14: 9967.98
     rank 15: 9968.02
     rank 16: 9967.77
     rank 17: 9967.92
     rank 18: 9967.77
     rank 19: 9967.84
  forward-compute:
     rank  0: 3410.02
     rank  1: 3411.48
     rank  2: 3417.76
     rank  3: 3415.99
     rank  4: 3689.19
     rank  5: 3686.34
     rank  6: 3699.24
     rank  7: 3687.34
     rank  8: 3407.40
     rank  9: 3410.26
     rank 10: 3417.33
     rank 11: 3417.14
     rank 12: 3939.12
     rank 13: 3937.65
     rank 14: 3943.88
     rank 15: 3950.15
     rank 16: 3766.00
     rank 17: 3765.42
     rank 18: 3776.83
     rank 19: 3775.79
  backward-compute:
     rank  0: 2941.99
     rank  1: 2943.16
     rank  2: 2977.76
     rank  3: 2955.47
     rank  4: 4134.65
     rank  5: 4123.69
     rank  6: 4111.59
     rank  7: 4126.85
     rank  8: 4335.46
     rank  9: 4338.68
     rank 10: 4352.59
     rank 11: 4356.97
     rank 12: 4656.37
     rank 13: 4654.28
     rank 14: 4675.18
     rank 15: 4672.17
     rank 16: 4441.76
     rank 17: 4439.20
     rank 18: 4448.77
     rank 19: 4446.82
  pure-backward-compute:
     rank  0: 2940.37
     rank  1: 2941.17
     rank  2: 2976.24
     rank  3: 2953.75
     rank  4: 4132.45
     rank  5: 4121.55
     rank  6: 4108.82
     rank  7: 4124.17
     rank  8: 4331.69
     rank  9: 4335.44
     rank 10: 4350.45
     rank 11: 4354.25
     rank 12: 4653.78
     rank 13: 4651.52
     rank 14: 4673.72
     rank 15: 4670.70
     rank 16: 4437.28
     rank 17: 4433.82
     rank 18: 4445.86
     rank 19: 4443.52
  batch-generator:
     rank  0: 263.01
     rank  1: 279.18
     rank  2: 282.27
     rank  3: 290.79
     rank  4: 111.51
     rank  5: 115.66
     rank  6: 144.94
     rank  7: 134.34
     rank  8: 115.63
     rank  9: 115.28
     rank 10: 118.71
     rank 11: 130.25
     rank 12: 96.79
     rank 13: 100.41
     rank 14: 103.99
     rank 15: 112.83
     rank 16: 90.19
     rank 17: 101.10
     rank 18: 105.59
     rank 19: 104.73
  forward-recv:
     rank  4: 112.20
     rank  5: 112.27
     rank  6: 108.73
     rank  7: 110.53
     rank  8: 235.65
     rank  9: 235.19
     rank 10: 233.62
     rank 11: 233.91
     rank 12: 342.17
     rank 13: 342.48
     rank 14: 342.48
     rank 15: 341.87
     rank 16: 464.38
     rank 17: 464.55
     rank 18: 464.07
     rank 19: 463.94
  forward-send:
     rank  0: 74.05
     rank  1: 73.20
     rank  2: 67.34
     rank  3: 68.16
     rank  4: 23.09
     rank  5: 23.07
     rank  6: 21.17
     rank  7: 19.84
     rank  8: 24.34
     rank  9: 24.59
     rank 10: 23.30
     rank 11: 22.42
     rank 12: 5.15
     rank 13: 5.10
     rank 14: 4.62
     rank 15: 4.48
  backward-recv:
     rank  0: 744.81
     rank  1: 743.63
     rank  2: 740.67
     rank  3: 742.17
     rank  4: 427.48
     rank  5: 427.00
     rank  6: 430.21
     rank  7: 429.38
     rank  8: 259.95
     rank  9: 260.26
     rank 10: 259.51
     rank 11: 258.88
     rank 12: 113.32
     rank 13: 113.59
     rank 14: 113.54
     rank 15: 114.20
  backward-send:
     rank  4: 10.70
     rank  5: 10.34
     rank  6: 8.17
     rank  7: 9.49
     rank  8: 15.55
     rank  9: 14.74
     rank 10: 15.55
     rank 11: 15.61
     rank 12: 10.34
     rank 13: 10.37
     rank 14: 10.17
     rank 15: 9.62
     rank 16: 4.97
     rank 17: 5.28
     rank 18: 4.71
     rank 19: 5.00
  forward-send-backward-recv:
     rank  0: 2754.58
     rank  1: 2752.05
     rank  2: 2725.47
     rank  3: 2746.60
     rank  4: 1308.89
     rank  5: 1320.13
     rank  6: 1325.85
     rank  7: 1318.98
     rank  8: 1199.40
     rank  9: 1191.70
     rank 10: 1179.34
     rank 11: 1177.87
     rank 12: 297.25
     rank 13: 299.49
     rank 14: 290.58
     rank 15: 291.61
  backward-send-forward-recv:
     rank  4: 146.77
     rank  5: 148.95
     rank  6: 138.65
     rank  7: 148.95
     rank  8: 239.57
     rank  9: 241.37
     rank 10: 240.15
     rank 11: 237.35
     rank 12: 206.82
     rank 13: 208.44
     rank 14: 200.78
     rank 15: 196.18
     rank 16: 746.16
     rank 17: 747.83
     rank 18: 736.89
     rank 19: 739.63
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.03
     rank 18: 0.02
     rank 19: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.09
     rank  1: 0.10
     rank  2: 0.06
     rank  3: 0.09
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.05
     rank 17: 0.07
     rank 18: 0.04
     rank 19: 0.08
  all-grads-sync:
     rank  0: 1.08
     rank  1: 1.23
     rank  2: 1.11
     rank  3: 1.24
     rank  4: 2.44
     rank  5: 2.37
     rank  6: 2.44
     rank  7: 2.40
     rank  8: 2.60
     rank  9: 2.59
     rank 10: 2.51
     rank 11: 2.59
     rank 12: 2.95
     rank 13: 2.94
     rank 14: 2.92
     rank 15: 2.92
     rank 16: 2.87
     rank 17: 2.98
     rank 18: 2.81
     rank 19: 2.98
  optimizer-copy-to-main-grad:
     rank  0: 0.27
     rank  1: 0.30
     rank  2: 0.26
     rank  3: 0.28
     rank  4: 0.07
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.07
     rank  9: 0.05
     rank 10: 0.06
     rank 11: 0.06
     rank 12: 0.07
     rank 13: 0.06
     rank 14: 0.05
     rank 15: 0.10
     rank 16: 0.06
     rank 17: 0.10
     rank 18: 0.05
     rank 19: 0.08
  optimizer-clip-main-grad:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.02
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.02
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 19.64
     rank  1: 19.97
     rank  2: 19.93
     rank  3: 20.01
     rank  4: 48.01
     rank  5: 48.59
     rank  6: 48.52
     rank  7: 48.05
     rank  8: 52.00
     rank  9: 52.20
     rank 10: 52.09
     rank 11: 52.04
     rank 12: 59.08
     rank 13: 58.96
     rank 14: 59.03
     rank 15: 59.02
     rank 16: 57.01
     rank 17: 57.11
     rank 18: 56.93
     rank 19: 57.05
  optimizer:
     rank  0: 20.72
     rank  1: 21.08
     rank  2: 21.02
     rank  3: 21.12
     rank  4: 49.10
     rank  5: 49.68
     rank  6: 49.61
     rank  7: 49.15
     rank  8: 53.09
     rank  9: 53.29
     rank 10: 53.18
     rank 11: 53.13
     rank 12: 60.17
     rank 13: 60.04
     rank 14: 60.12
     rank 15: 60.10
     rank 16: 58.10
     rank 17: 58.20
     rank 18: 58.01
     rank 19: 58.19
 [2024-12-31 14:13:17] iteration        4/      10 | consumed samples:          128 | elapsed time per iteration (ms): 10130.7 | learning rate: 3.000000E-06 | global batch size:    32 | lm loss: 3.810259E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 10022.72
     rank  1: 10022.76
     rank  2: 10022.85
     rank  3: 10022.96
     rank  4: 10025.41
     rank  5: 10025.41
     rank  6: 10025.42
     rank  7: 10025.49
     rank  8: 10025.76
     rank  9: 10025.75
     rank 10: 10025.79
     rank 11: 10025.83
     rank 12: 10026.39
     rank 13: 10026.40
     rank 14: 10026.42
     rank 15: 10026.46
     rank 16: 10026.24
     rank 17: 10026.24
     rank 18: 10026.18
     rank 19: 10026.20
  forward-compute:
     rank  0: 3569.06
     rank  1: 3568.28
     rank  2: 3574.18
     rank  3: 3574.31
     rank  4: 3700.40
     rank  5: 3696.19
     rank  6: 3715.19
     rank  7: 3703.19
     rank  8: 3415.54
     rank  9: 3419.17
     rank 10: 3425.24
     rank 11: 3422.91
     rank 12: 3940.53
     rank 13: 3937.76
     rank 14: 3944.70
     rank 15: 3951.69
     rank 16: 3752.49
     rank 17: 3752.91
     rank 18: 3764.81
     rank 19: 3762.52
  backward-compute:
     rank  0: 2932.93
     rank  1: 2933.74
     rank  2: 2971.81
     rank  3: 2953.39
     rank  4: 4154.45
     rank  5: 4146.97
     rank  6: 4130.32
     rank  7: 4138.77
     rank  8: 4379.73
     rank  9: 4379.83
     rank 10: 4394.72
     rank 11: 4403.54
     rank 12: 4642.12
     rank 13: 4641.62
     rank 14: 4661.27
     rank 15: 4657.40
     rank 16: 4447.71
     rank 17: 4446.73
     rank 18: 4452.51
     rank 19: 4452.91
  pure-backward-compute:
     rank  0: 2931.33
     rank  1: 2932.24
     rank  2: 2970.36
     rank  3: 2951.78
     rank  4: 4152.05
     rank  5: 4144.61
     rank  6: 4127.72
     rank  7: 4136.33
     rank  8: 4376.27
     rank  9: 4376.62
     rank 10: 4392.37
     rank 11: 4401.37
     rank 12: 4639.53
     rank 13: 4638.94
     rank 14: 4659.88
     rank 15: 4655.89
     rank 16: 4443.29
     rank 17: 4441.86
     rank 18: 4449.50
     rank 19: 4449.70
  batch-generator:
     rank  0: 248.02
     rank  1: 256.36
     rank  2: 264.88
     rank  3: 274.27
     rank  4: 112.19
     rank  5: 118.12
     rank  6: 154.84
     rank  7: 138.97
     rank  8: 112.84
     rank  9: 114.67
     rank 10: 116.43
     rank 11: 121.51
     rank 12: 107.24
     rank 13: 106.98
     rank 14: 110.63
     rank 15: 119.70
     rank 16: 96.16
     rank 17: 98.33
     rank 18: 107.95
     rank 19: 106.55
  forward-recv:
     rank  4: 109.97
     rank  5: 109.97
     rank  6: 106.32
     rank  7: 106.78
     rank  8: 234.63
     rank  9: 234.13
     rank 10: 233.08
     rank 11: 232.83
     rank 12: 339.82
     rank 13: 340.02
     rank 14: 339.84
     rank 15: 338.86
     rank 16: 461.02
     rank 17: 460.97
     rank 18: 460.67
     rank 19: 460.57
  forward-send:
     rank  0: 69.44
     rank  1: 68.52
     rank  2: 63.11
     rank  3: 61.30
     rank  4: 17.75
     rank  5: 17.80
     rank  6: 15.72
     rank  7: 13.86
     rank  8: 23.30
     rank  9: 23.20
     rank 10: 21.72
     rank 11: 20.43
     rank 12: 5.10
     rank 13: 5.13
     rank 14: 4.66
     rank 15: 4.45
  backward-recv:
     rank  0: 733.12
     rank  1: 732.91
     rank  2: 731.56
     rank  3: 729.54
     rank  4: 420.55
     rank  5: 421.35
     rank  6: 421.63
     rank  7: 424.42
     rank  8: 255.96
     rank  9: 255.38
     rank 10: 254.87
     rank 11: 254.85
     rank 12: 111.72
     rank 13: 111.61
     rank 14: 112.07
     rank 15: 112.11
  backward-send:
     rank  4: 10.79
     rank  5: 10.53
     rank  6: 11.19
     rank  7: 8.30
     rank  8: 14.96
     rank  9: 15.25
     rank 10: 15.64
     rank 11: 15.47
     rank 12: 10.20
     rank 13: 10.45
     rank 14: 10.15
     rank 15: 9.82
     rank 16: 5.10
     rank 17: 5.10
     rank 18: 5.00
     rank 19: 4.80
  forward-send-backward-recv:
     rank  0: 2679.64
     rank  1: 2679.11
     rank  2: 2646.51
     rank  3: 2669.19
     rank  4: 1232.81
     rank  5: 1241.53
     rank  6: 1250.10
     rank  7: 1250.39
     rank  8: 1126.18
     rank  9: 1116.70
     rank 10: 1103.31
     rank 11: 1100.32
     rank 12: 299.38
     rank 13: 301.32
     rank 14: 291.60
     rank 15: 293.35
  backward-send-forward-recv:
     rank  4: 266.52
     rank  5: 268.26
     rank  6: 254.95
     rank  7: 267.19
     rank  8: 331.67
     rank  9: 334.79
     rank 10: 333.31
     rank 11: 333.04
     rank 12: 281.48
     rank 13: 283.88
     rank 14: 276.74
     rank 15: 271.72
     rank 16: 816.86
     rank 17: 817.80
     rank 18: 807.49
     rank 19: 809.92
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.07
     rank  1: 0.08
     rank  2: 0.09
     rank  3: 0.11
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.05
     rank 17: 0.05
     rank 18: 0.04
     rank 19: 0.04
  all-grads-sync:
     rank  0: 1.10
     rank  1: 1.13
     rank  2: 1.18
     rank  3: 1.27
     rank  4: 2.39
     rank  5: 2.38
     rank  6: 2.36
     rank  7: 2.41
     rank  8: 2.58
     rank  9: 2.47
     rank 10: 2.54
     rank 11: 2.50
     rank 12: 2.93
     rank 13: 2.99
     rank 14: 2.90
     rank 15: 2.90
     rank 16: 2.84
     rank 17: 2.89
     rank 18: 2.85
     rank 19: 2.86
  optimizer-copy-to-main-grad:
     rank  0: 0.26
     rank  1: 0.26
     rank  2: 0.27
     rank  3: 0.27
     rank  4: 0.05
     rank  5: 0.04
     rank  6: 0.04
     rank  7: 0.05
     rank  8: 0.06
     rank  9: 0.05
     rank 10: 0.06
     rank 11: 0.05
     rank 12: 0.06
     rank 13: 0.06
     rank 14: 0.05
     rank 15: 0.04
     rank 16: 0.07
     rank 17: 0.07
     rank 18: 0.05
     rank 19: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 19.51
     rank  1: 19.68
     rank  2: 19.46
     rank  3: 19.88
     rank  4: 47.96
     rank  5: 48.66
     rank  6: 48.39
     rank  7: 48.03
     rank  8: 51.87
     rank  9: 52.03
     rank 10: 52.17
     rank 11: 52.15
     rank 12: 58.95
     rank 13: 59.02
     rank 14: 59.01
     rank 15: 58.99
     rank 16: 56.96
     rank 17: 57.11
     rank 18: 56.94
     rank 19: 57.01
  optimizer:
     rank  0: 20.74
     rank  1: 20.91
     rank  2: 20.71
     rank  3: 21.11
     rank  4: 49.18
     rank  5: 49.89
     rank  6: 49.62
     rank  7: 49.26
     rank  8: 53.10
     rank  9: 53.26
     rank 10: 53.40
     rank 11: 53.38
     rank 12: 60.18
     rank 13: 60.25
     rank 14: 60.24
     rank 15: 60.22
     rank 16: 58.19
     rank 17: 58.34
     rank 18: 58.17
     rank 19: 58.23
 [2024-12-31 14:13:27] iteration        5/      10 | consumed samples:          160 | elapsed time per iteration (ms): 10117.8 | learning rate: 3.750000E-06 | global batch size:    32 | lm loss: 2.403574E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 10002.73
     rank  1: 10002.73
     rank  2: 10002.77
     rank  3: 10002.90
     rank  4: 10005.40
     rank  5: 10005.38
     rank  6: 10005.42
     rank  7: 10005.51
     rank  8: 10005.85
     rank  9: 10005.77
     rank 10: 10005.79
     rank 11: 10005.84
     rank 12: 10006.39
     rank 13: 10006.39
     rank 14: 10006.45
     rank 15: 10006.42
     rank 16: 10006.27
     rank 17: 10006.19
     rank 18: 10006.16
     rank 19: 10006.20
  forward-compute:
     rank  0: 3547.13
     rank  1: 3544.30
     rank  2: 3546.32
     rank  3: 3549.89
     rank  4: 3728.04
     rank  5: 3724.44
     rank  6: 3734.93
     rank  7: 3734.87
     rank  8: 3432.30
     rank  9: 3434.55
     rank 10: 3442.62
     rank 11: 3440.54
     rank 12: 3929.57
     rank 13: 3927.13
     rank 14: 3934.38
     rank 15: 3937.21
     rank 16: 3745.10
     rank 17: 3745.98
     rank 18: 3756.77
     rank 19: 3754.63
  backward-compute:
     rank  0: 2896.24
     rank  1: 2900.08
     rank  2: 2937.25
     rank  3: 2921.19
     rank  4: 4187.54
     rank  5: 4179.05
     rank  6: 4164.61
     rank  7: 4172.33
     rank  8: 4435.55
     rank  9: 4432.06
     rank 10: 4443.67
     rank 11: 4446.27
     rank 12: 4647.77
     rank 13: 4648.07
     rank 14: 4667.60
     rank 15: 4665.01
     rank 16: 4448.59
     rank 17: 4447.23
     rank 18: 4455.63
     rank 19: 4453.36
  pure-backward-compute:
     rank  0: 2894.68
     rank  1: 2898.52
     rank  2: 2935.84
     rank  3: 2919.59
     rank  4: 4185.19
     rank  5: 4176.72
     rank  6: 4162.10
     rank  7: 4169.92
     rank  8: 4430.65
     rank  9: 4428.71
     rank 10: 4441.33
     rank 11: 4444.11
     rank 12: 4645.35
     rank 13: 4645.52
     rank 14: 4666.25
     rank 15: 4663.45
     rank 16: 4444.21
     rank 17: 4442.43
     rank 18: 4452.89
     rank 19: 4450.04
  batch-generator:
     rank  0: 234.71
     rank  1: 239.99
     rank  2: 244.72
     rank  3: 260.07
     rank  4: 117.92
     rank  5: 121.99
     rank  6: 155.58
     rank  7: 149.61
     rank  8: 114.79
     rank  9: 116.27
     rank 10: 118.54
     rank 11: 124.22
     rank 12: 100.61
     rank 13: 103.26
     rank 14: 107.01
     rank 15: 112.64
     rank 16: 94.88
     rank 17: 97.32
     rank 18: 106.03
     rank 19: 104.91
  forward-recv:
     rank  4: 112.93
     rank  5: 113.01
     rank  6: 110.57
     rank  7: 108.55
     rank  8: 239.66
     rank  9: 239.93
     rank 10: 238.98
     rank 11: 238.19
     rank 12: 341.84
     rank 13: 341.65
     rank 14: 341.84
     rank 15: 341.08
     rank 16: 464.24
     rank 17: 464.24
     rank 18: 463.96
     rank 19: 463.86
  forward-send:
     rank  0: 71.88
     rank  1: 71.35
     rank  2: 67.69
     rank  3: 63.30
     rank  4: 19.44
     rank  5: 19.56
     rank  6: 18.22
     rank  7: 15.77
     rank  8: 20.11
     rank  9: 19.47
     rank 10: 18.57
     rank 11: 17.69
     rank 12: 5.13
     rank 13: 5.22
     rank 14: 4.76
     rank 15: 4.61
  backward-recv:
     rank  0: 742.28
     rank  1: 741.26
     rank  2: 736.27
     rank  3: 740.69
     rank  4: 417.94
     rank  5: 417.92
     rank  6: 422.93
     rank  7: 419.05
     rank  8: 250.80
     rank  9: 251.57
     rank 10: 250.91
     rank 11: 250.24
     rank 12: 111.59
     rank 13: 111.47
     rank 14: 111.79
     rank 15: 112.17
  backward-send:
     rank  4: 10.38
     rank  5: 10.00
     rank  6: 6.41
     rank  7: 9.98
     rank  8: 15.66
     rank  9: 14.76
     rank 10: 15.53
     rank 11: 15.56
     rank 12: 10.25
     rank 13: 10.47
     rank 14: 10.13
     rank 15: 9.55
     rank 16: 5.19
     rank 17: 5.12
     rank 18: 4.80
     rank 19: 4.86
  forward-send-backward-recv:
     rank  0: 2706.22
     rank  1: 2705.08
     rank  2: 2681.08
     rank  3: 2693.44
     rank  4: 1150.03
     rank  5: 1158.99
     rank  6: 1165.19
     rank  7: 1164.85
     rank  8: 1037.36
     rank  9: 1029.45
     rank 10: 1020.25
     rank 11: 1023.16
     rank 12: 298.73
     rank 13: 300.25
     rank 14: 290.43
     rank 15: 291.22
  backward-send-forward-recv:
     rank  4: 260.15
     rank  5: 263.37
     rank  6: 255.21
     rank  7: 261.34
     rank  8: 322.02
     rank  9: 328.58
     rank 10: 324.90
     rank 11: 324.30
     rank 12: 256.13
     rank 13: 258.19
     rank 14: 250.37
     rank 15: 249.01
     rank 16: 790.63
     rank 17: 791.37
     rank 18: 780.55
     rank 19: 784.38
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.08
     rank  1: 0.08
     rank  2: 0.08
     rank  3: 0.10
     rank  4: 0.02
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.07
     rank 17: 0.05
     rank 18: 0.04
     rank 19: 0.05
  all-grads-sync:
     rank  0: 1.06
     rank  1: 1.08
     rank  2: 1.09
     rank  3: 1.10
     rank  4: 2.37
     rank  5: 2.42
     rank  6: 2.40
     rank  7: 2.43
     rank  8: 2.73
     rank  9: 2.60
     rank 10: 2.47
     rank 11: 2.49
     rank 12: 2.91
     rank 13: 2.93
     rank 14: 2.94
     rank 15: 2.94
     rank 16: 2.91
     rank 17: 2.87
     rank 18: 2.82
     rank 19: 2.87
  optimizer-copy-to-main-grad:
     rank  0: 0.27
     rank  1: 0.26
     rank  2: 0.25
     rank  3: 0.30
     rank  4: 0.06
     rank  5: 0.06
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.12
     rank  9: 0.06
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.06
     rank 13: 0.06
     rank 14: 0.05
     rank 15: 0.05
     rank 16: 0.07
     rank 17: 0.06
     rank 18: 0.05
     rank 19: 0.11
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 19.76
     rank  1: 19.69
     rank  2: 19.28
     rank  3: 19.94
     rank  4: 47.88
     rank  5: 48.65
     rank  6: 48.46
     rank  7: 48.30
     rank  8: 51.94
     rank  9: 52.28
     rank 10: 51.98
     rank 11: 52.13
     rank 12: 59.01
     rank 13: 58.98
     rank 14: 59.06
     rank 15: 59.04
     rank 16: 57.07
     rank 17: 56.92
     rank 18: 56.92
     rank 19: 56.98
  optimizer:
     rank  0: 20.82
     rank  1: 20.76
     rank  2: 20.40
     rank  3: 21.03
     rank  4: 48.94
     rank  5: 49.72
     rank  6: 49.52
     rank  7: 49.36
     rank  8: 53.01
     rank  9: 53.35
     rank 10: 53.04
     rank 11: 53.20
     rank 12: 60.08
     rank 13: 60.04
     rank 14: 60.12
     rank 15: 60.11
     rank 16: 58.14
     rank 17: 57.98
     rank 18: 57.98
     rank 19: 58.04
 [2024-12-31 14:13:37] iteration        6/      10 | consumed samples:          192 | elapsed time per iteration (ms): 10042.7 | learning rate: 4.500000E-06 | global batch size:    32 | lm loss: 1.654870E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 9939.50
     rank  1: 9939.47
     rank  2: 9939.49
     rank  3: 9939.61
     rank  4: 9942.13
     rank  5: 9942.10
     rank  6: 9942.10
     rank  7: 9942.13
     rank  8: 9942.48
     rank  9: 9942.41
     rank 10: 9942.44
     rank 11: 9942.48
     rank 12: 9943.12
     rank 13: 9943.09
     rank 14: 9943.09
     rank 15: 9943.12
     rank 16: 9942.96
     rank 17: 9942.92
     rank 18: 9942.87
     rank 19: 9942.88
  forward-compute:
     rank  0: 3285.70
     rank  1: 3285.05
     rank  2: 3287.44
     rank  3: 3290.83
     rank  4: 3745.47
     rank  5: 3742.52
     rank  6: 3755.79
     rank  7: 3753.67
     rank  8: 3463.44
     rank  9: 3468.13
     rank 10: 3470.83
     rank 11: 3468.30
     rank 12: 3933.21
     rank 13: 3932.12
     rank 14: 3936.64
     rank 15: 3945.81
     rank 16: 3773.78
     rank 17: 3775.07
     rank 18: 3785.26
     rank 19: 3786.00
  backward-compute:
     rank  0: 2898.10
     rank  1: 2901.19
     rank  2: 2942.57
     rank  3: 2928.33
     rank  4: 4190.75
     rank  5: 4184.33
     rank  6: 4163.49
     rank  7: 4166.82
     rank  8: 4470.86
     rank  9: 4472.84
     rank 10: 4482.99
     rank 11: 4491.63
     rank 12: 4646.98
     rank 13: 4647.09
     rank 14: 4667.33
     rank 15: 4665.34
     rank 16: 4426.74
     rank 17: 4427.38
     rank 18: 4436.04
     rank 19: 4433.28
  pure-backward-compute:
     rank  0: 2896.53
     rank  1: 2899.65
     rank  2: 2941.15
     rank  3: 2926.73
     rank  4: 4187.94
     rank  5: 4181.87
     rank  6: 4161.12
     rank  7: 4164.70
     rank  8: 4467.96
     rank  9: 4469.73
     rank 10: 4480.50
     rank 11: 4489.24
     rank 12: 4644.70
     rank 13: 4644.65
     rank 14: 4665.92
     rank 15: 4663.94
     rank 16: 4421.32
     rank 17: 4422.53
     rank 18: 4433.19
     rank 19: 4430.23
  batch-generator:
     rank  0: 150.98
     rank  1: 160.07
     rank  2: 165.65
     rank  3: 180.26
     rank  4: 128.80
     rank  5: 131.82
     rank  6: 165.13
     rank  7: 157.59
     rank  8: 118.25
     rank  9: 120.06
     rank 10: 119.03
     rank 11: 123.57
     rank 12: 94.93
     rank 13: 100.34
     rank 14: 101.30
     rank 15: 112.61
     rank 16: 113.06
     rank 17: 111.62
     rank 18: 119.75
     rank 19: 121.25
  forward-recv:
     rank  4: 110.59
     rank  5: 110.64
     rank  6: 107.81
     rank  7: 105.66
     rank  8: 237.05
     rank  9: 237.42
     rank 10: 236.15
     rank 11: 234.47
     rank 12: 342.73
     rank 13: 342.38
     rank 14: 342.89
     rank 15: 342.63
     rank 16: 464.70
     rank 17: 464.68
     rank 18: 464.45
     rank 19: 464.32
  forward-send:
     rank  0: 70.01
     rank  1: 69.42
     rank  2: 65.78
     rank  3: 60.89
     rank  4: 19.55
     rank  5: 19.58
     rank  6: 18.56
     rank  7: 15.69
     rank  8: 19.44
     rank  9: 18.74
     rank 10: 18.45
     rank 11: 18.01
     rank 12: 5.19
     rank 13: 5.19
     rank 14: 4.72
     rank 15: 4.59
  backward-recv:
     rank  0: 747.00
     rank  1: 747.01
     rank  2: 743.70
     rank  3: 744.17
     rank  4: 422.48
     rank  5: 422.80
     rank  6: 426.08
     rank  7: 425.73
     rank  8: 254.49
     rank  9: 254.02
     rank 10: 253.47
     rank 11: 252.85
     rank 12: 112.42
     rank 13: 112.48
     rank 14: 112.66
     rank 15: 112.88
  backward-send:
     rank  4: 10.95
     rank  5: 10.62
     rank  6: 9.01
     rank  7: 9.15
     rank  8: 15.13
     rank  9: 15.22
     rank 10: 15.72
     rank 11: 15.68
     rank 12: 10.41
     rank 13: 10.40
     rank 14: 10.05
     rank 15: 9.42
     rank 16: 5.25
     rank 17: 5.22
     rank 18: 4.68
     rank 19: 4.62
  forward-send-backward-recv:
     rank  0: 2898.52
     rank  1: 2896.21
     rank  2: 2866.84
     rank  3: 2881.14
     rank  4: 1169.65
     rank  5: 1175.49
     rank  6: 1187.98
     rank  7: 1192.73
     rank  8: 988.75
     rank  9: 979.38
     rank 10: 971.37
     rank 11: 969.13
     rank 12: 298.85
     rank 13: 299.72
     rank 14: 290.61
     rank 15: 291.07
  backward-send-forward-recv:
     rank  4: 157.44
     rank  5: 160.71
     rank  6: 150.63
     rank  7: 159.75
     rank  8: 245.44
     rank  9: 247.46
     rank 10: 246.94
     rank 11: 246.37
     rank 12: 193.80
     rank 13: 194.71
     rank 14: 188.58
     rank 15: 181.18
     rank 16: 722.21
     rank 17: 723.68
     rank 18: 713.33
     rank 19: 714.57
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.03
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.08
     rank  1: 0.08
     rank  2: 0.08
     rank  3: 0.09
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.07
     rank 17: 0.05
     rank 18: 0.04
     rank 19: 0.04
  all-grads-sync:
     rank  0: 1.13
     rank  1: 1.12
     rank  2: 1.10
     rank  3: 1.16
     rank  4: 2.54
     rank  5: 2.38
     rank  6: 2.38
     rank  7: 2.36
     rank  8: 2.57
     rank  9: 2.48
     rank 10: 2.51
     rank 11: 2.50
     rank 12: 2.94
     rank 13: 2.93
     rank 14: 2.90
     rank 15: 2.89
     rank 16: 3.00
     rank 17: 2.88
     rank 18: 2.80
     rank 19: 2.86
  optimizer-copy-to-main-grad:
     rank  0: 0.29
     rank  1: 0.26
     rank  2: 0.25
     rank  3: 0.26
     rank  4: 0.06
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.04
     rank  8: 0.06
     rank  9: 0.05
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.07
     rank 13: 0.06
     rank 14: 0.05
     rank 15: 0.04
     rank 16: 0.07
     rank 17: 0.06
     rank 18: 0.05
     rank 19: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 19.42
     rank  1: 19.57
     rank  2: 19.23
     rank  3: 19.52
     rank  4: 48.02
     rank  5: 48.57
     rank  6: 48.45
     rank  7: 47.92
     rank  8: 51.86
     rank  9: 52.06
     rank 10: 52.03
     rank 11: 52.08
     rank 12: 59.31
     rank 13: 59.02
     rank 14: 59.01
     rank 15: 59.00
     rank 16: 57.03
     rank 17: 56.91
     rank 18: 56.94
     rank 19: 56.95
  optimizer:
     rank  0: 20.47
     rank  1: 20.63
     rank  2: 20.29
     rank  3: 20.60
     rank  4: 49.08
     rank  5: 49.64
     rank  6: 49.52
     rank  7: 48.99
     rank  8: 52.93
     rank  9: 53.13
     rank 10: 53.10
     rank 11: 53.15
     rank 12: 60.43
     rank 13: 60.08
     rank 14: 60.07
     rank 15: 60.06
     rank 16: 58.09
     rank 17: 57.96
     rank 18: 58.00
     rank 19: 58.01
 [2024-12-31 14:13:48] iteration        7/      10 | consumed samples:          224 | elapsed time per iteration (ms): 10056.7 | learning rate: 5.250000E-06 | global batch size:    32 | lm loss: 2.653769E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 9952.88
     rank  1: 9952.84
     rank  2: 9952.95
     rank  3: 9952.97
     rank  4: 9955.53
     rank  5: 9955.52
     rank  6: 9955.60
     rank  7: 9955.53
     rank  8: 9955.88
     rank  9: 9955.91
     rank 10: 9955.95
     rank 11: 9955.89
     rank 12: 9956.53
     rank 13: 9956.57
     rank 14: 9956.59
     rank 15: 9956.50
     rank 16: 9956.29
     rank 17: 9956.33
     rank 18: 9956.27
     rank 19: 9955.38
  forward-compute:
     rank  0: 3294.00
     rank  1: 3293.05
     rank  2: 3296.59
     rank  3: 3297.07
     rank  4: 3746.51
     rank  5: 3742.99
     rank  6: 3750.32
     rank  7: 3756.78
     rank  8: 3466.45
     rank  9: 3466.91
     rank 10: 3474.83
     rank 11: 3470.08
     rank 12: 3931.79
     rank 13: 3928.93
     rank 14: 3937.23
     rank 15: 3945.93
     rank 16: 3751.28
     rank 17: 3751.99
     rank 18: 3761.31
     rank 19: 3762.98
  backward-compute:
     rank  0: 2908.17
     rank  1: 2910.87
     rank  2: 2939.69
     rank  3: 2939.14
     rank  4: 4204.72
     rank  5: 4193.10
     rank  6: 4176.09
     rank  7: 4181.15
     rank  8: 4478.80
     rank  9: 4479.10
     rank 10: 4497.26
     rank 11: 4505.08
     rank 12: 4650.36
     rank 13: 4650.34
     rank 14: 4668.02
     rank 15: 4667.88
     rank 16: 4444.50
     rank 17: 4442.75
     rank 18: 4452.36
     rank 19: 4450.37
  pure-backward-compute:
     rank  0: 2906.66
     rank  1: 2909.36
     rank  2: 2938.29
     rank  3: 2937.57
     rank  4: 4202.22
     rank  5: 4190.71
     rank  6: 4173.07
     rank  7: 4178.87
     rank  8: 4475.34
     rank  9: 4476.00
     rank 10: 4494.45
     rank 11: 4502.12
     rank 12: 4648.12
     rank 13: 4647.60
     rank 14: 4666.65
     rank 15: 4666.51
     rank 16: 4439.74
     rank 17: 4438.23
     rank 18: 4449.68
     rank 19: 4447.32
  batch-generator:
     rank  0: 175.51
     rank  1: 183.86
     rank  2: 190.47
     rank  3: 201.95
     rank  4: 113.92
     rank  5: 125.25
     rank  6: 161.52
     rank  7: 159.61
     rank  8: 110.98
     rank  9: 111.79
     rank 10: 114.93
     rank 11: 119.50
     rank 12: 93.79
     rank 13: 97.50
     rank 14: 102.05
     rank 15: 113.13
     rank 16: 102.64
     rank 17: 104.32
     rank 18: 110.48
     rank 19: 113.30
  forward-recv:
     rank  4: 109.97
     rank  5: 109.86
     rank  6: 105.83
     rank  7: 105.95
     rank  8: 236.86
     rank  9: 236.04
     rank 10: 234.68
     rank 11: 233.98
     rank 12: 341.31
     rank 13: 341.92
     rank 14: 341.77
     rank 15: 341.44
     rank 16: 462.44
     rank 17: 462.40
     rank 18: 462.28
     rank 19: 461.13
  forward-send:
     rank  0: 71.26
     rank  1: 70.67
     rank  2: 65.35
     rank  3: 63.62
     rank  4: 21.70
     rank  5: 21.88
     rank  6: 20.22
     rank  7: 18.02
     rank  8: 22.40
     rank  9: 22.86
     rank 10: 21.89
     rank 11: 21.05
     rank 12: 5.20
     rank 13: 5.16
     rank 14: 4.82
     rank 15: 4.63
  backward-recv:
     rank  0: 740.22
     rank  1: 740.04
     rank  2: 738.60
     rank  3: 736.00
     rank  4: 417.49
     rank  5: 418.07
     rank  6: 418.71
     rank  7: 421.59
     rank  8: 252.13
     rank  9: 252.48
     rank 10: 251.47
     rank 11: 250.77
     rank 12: 110.51
     rank 13: 110.72
     rank 14: 111.00
     rank 15: 111.03
  backward-send:
     rank  4: 10.94
     rank  5: 10.76
     rank  6: 11.02
     rank  7: 8.30
     rank  8: 15.07
     rank  9: 15.24
     rank 10: 15.64
     rank 11: 15.62
     rank 12: 10.83
     rank 13: 10.77
     rank 14: 10.42
     rank 15: 9.75
     rank 16: 5.12
     rank 17: 5.22
     rank 18: 4.89
     rank 19: 4.47
  forward-send-backward-recv:
     rank  0: 2899.51
     rank  1: 2897.46
     rank  2: 2879.02
     rank  3: 2882.07
     rank  4: 1176.26
     rank  5: 1187.27
     rank  6: 1197.75
     rank  7: 1199.45
     rank  8: 994.72
     rank  9: 988.04
     rank 10: 969.53
     rank 11: 969.28
     rank 12: 298.21
     rank 13: 299.09
     rank 14: 291.51
     rank 15: 290.46
  backward-send-forward-recv:
     rank  4: 153.59
     rank  5: 157.18
     rank  6: 152.70
     rank  7: 150.63
     rank  8: 241.02
     rank  9: 246.54
     rank 10: 242.90
     rank 11: 243.10
     rank 12: 209.51
     rank 13: 210.35
     rank 14: 202.29
     rank 15: 195.08
     rank 16: 744.09
     rank 17: 745.26
     rank 18: 736.12
     rank 19: 736.02
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.04
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.09
     rank  1: 0.08
     rank  2: 0.10
     rank  3: 0.09
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.04
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.05
     rank 17: 0.05
     rank 18: 0.04
     rank 19: 0.05
  all-grads-sync:
     rank  0: 1.09
     rank  1: 1.05
     rank  2: 1.11
     rank  3: 1.14
     rank  4: 2.44
     rank  5: 2.38
     rank  6: 2.43
     rank  7: 2.41
     rank  8: 2.68
     rank  9: 2.58
     rank 10: 2.84
     rank 11: 2.53
     rank 12: 2.94
     rank 13: 2.96
     rank 14: 2.88
     rank 15: 2.89
     rank 16: 2.88
     rank 17: 2.88
     rank 18: 2.86
     rank 19: 2.87
  optimizer-copy-to-main-grad:
     rank  0: 0.28
     rank  1: 0.26
     rank  2: 0.26
     rank  3: 0.26
     rank  4: 0.06
     rank  5: 0.05
     rank  6: 0.06
     rank  7: 0.04
     rank  8: 0.08
     rank  9: 0.05
     rank 10: 0.09
     rank 11: 0.06
     rank 12: 0.06
     rank 13: 0.07
     rank 14: 0.05
     rank 15: 0.05
     rank 16: 0.06
     rank 17: 0.07
     rank 18: 0.05
     rank 19: 0.06
  optimizer-clip-main-grad:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 19.82
     rank  1: 19.75
     rank  2: 19.92
     rank  3: 19.90
     rank  4: 47.90
     rank  5: 48.56
     rank  6: 48.48
     rank  7: 47.90
     rank  8: 51.80
     rank  9: 52.17
     rank 10: 52.11
     rank 11: 52.00
     rank 12: 58.99
     rank 13: 59.08
     rank 14: 59.05
     rank 15: 59.01
     rank 16: 56.93
     rank 17: 57.00
     rank 18: 57.00
     rank 19: 56.97
  optimizer:
     rank  0: 20.91
     rank  1: 20.84
     rank  2: 21.03
     rank  3: 20.99
     rank  4: 48.99
     rank  5: 49.65
     rank  6: 49.58
     rank  7: 48.99
     rank  8: 52.89
     rank  9: 53.25
     rank 10: 53.20
     rank 11: 53.09
     rank 12: 60.07
     rank 13: 60.16
     rank 14: 60.14
     rank 15: 60.10
     rank 16: 58.02
     rank 17: 58.09
     rank 18: 58.08
     rank 19: 58.06
 [2024-12-31 14:13:58] iteration        8/      10 | consumed samples:          256 | elapsed time per iteration (ms): 10120.4 | learning rate: 6.000000E-06 | global batch size:    32 | lm loss: 2.412596E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 10016.76
     rank  1: 10016.75
     rank  2: 10016.85
     rank  3: 10016.80
     rank  4: 10019.57
     rank  5: 10019.40
     rank  6: 10019.46
     rank  7: 10019.40
     rank  8: 10019.82
     rank  9: 10019.79
     rank 10: 10019.79
     rank 11: 10019.95
     rank 12: 10020.45
     rank 13: 10020.41
     rank 14: 10020.44
     rank 15: 10020.42
     rank 16: 10020.21
     rank 17: 10020.20
     rank 18: 10020.17
     rank 19: 10020.23
  forward-compute:
     rank  0: 3533.88
     rank  1: 3531.77
     rank  2: 3535.74
     rank  3: 3538.63
     rank  4: 3763.89
     rank  5: 3762.78
     rank  6: 3753.21
     rank  7: 3793.96
     rank  8: 3498.00
     rank  9: 3501.30
     rank 10: 3507.04
     rank 11: 3506.24
     rank 12: 3933.96
     rank 13: 3928.78
     rank 14: 3937.34
     rank 15: 3941.47
     rank 16: 3732.66
     rank 17: 3733.27
     rank 18: 3745.50
     rank 19: 3743.38
  backward-compute:
     rank  0: 2888.12
     rank  1: 2895.96
     rank  2: 2907.57
     rank  3: 2939.30
     rank  4: 4216.42
     rank  5: 4204.70
     rank  6: 4188.88
     rank  7: 4194.96
     rank  8: 4518.53
     rank  9: 4515.57
     rank 10: 4533.56
     rank 11: 4535.43
     rank 12: 4653.15
     rank 13: 4653.24
     rank 14: 4675.38
     rank 15: 4670.30
     rank 16: 4446.84
     rank 17: 4446.06
     rank 18: 4453.81
     rank 19: 4451.85
  pure-backward-compute:
     rank  0: 2886.63
     rank  1: 2894.42
     rank  2: 2906.19
     rank  3: 2937.79
     rank  4: 4213.26
     rank  5: 4202.24
     rank  6: 4184.90
     rank  7: 4193.02
     rank  8: 4515.32
     rank  9: 4512.69
     rank 10: 4530.87
     rank 11: 4533.33
     rank 12: 4649.82
     rank 13: 4650.67
     rank 14: 4674.04
     rank 15: 4668.61
     rank 16: 4442.68
     rank 17: 4441.84
     rank 18: 4451.15
     rank 19: 4448.93
  batch-generator:
     rank  0: 205.48
     rank  1: 213.88
     rank  2: 219.48
     rank  3: 232.60
     rank  4: 119.51
     rank  5: 127.36
     rank  6: 149.71
     rank  7: 175.39
     rank  8: 116.73
     rank  9: 116.28
     rank 10: 117.68
     rank 11: 125.20
     rank 12: 94.69
     rank 13: 96.11
     rank 14: 101.91
     rank 15: 108.32
     rank 16: 89.94
     rank 17: 93.48
     rank 18: 103.60
     rank 19: 102.76
  forward-recv:
     rank  4: 110.18
     rank  5: 110.22
     rank  6: 106.78
     rank  7: 105.14
     rank  8: 237.58
     rank  9: 236.70
     rank 10: 235.76
     rank 11: 234.18
     rank 12: 341.15
     rank 13: 341.78
     rank 14: 341.88
     rank 15: 341.51
     rank 16: 463.31
     rank 17: 463.40
     rank 18: 462.95
     rank 19: 462.84
  forward-send:
     rank  0: 73.16
     rank  1: 73.00
     rank  2: 68.63
     rank  3: 64.02
     rank  4: 18.43
     rank  5: 18.62
     rank  6: 17.35
     rank  7: 14.31
     rank  8: 19.07
     rank  9: 19.48
     rank 10: 18.39
     rank 11: 17.87
     rank 12: 5.15
     rank 13: 5.18
     rank 14: 4.62
     rank 15: 4.49
  backward-recv:
     rank  0: 740.29
     rank  1: 740.23
     rank  2: 739.68
     rank  3: 736.81
     rank  4: 414.94
     rank  5: 415.43
     rank  6: 415.24
     rank  7: 418.62
     rank  8: 249.98
     rank  9: 248.84
     rank 10: 248.38
     rank 11: 248.92
     rank 12: 112.79
     rank 13: 112.84
     rank 14: 113.22
     rank 15: 112.94
  backward-send:
     rank  4: 10.67
     rank  5: 10.32
     rank  6: 11.28
     rank  7: 7.96
     rank  8: 14.97
     rank  9: 15.23
     rank 10: 15.55
     rank 11: 15.54
     rank 12: 10.41
     rank 13: 10.25
     rank 14: 9.83
     rank 15: 10.19
     rank 16: 5.11
     rank 17: 5.04
     rank 18: 4.67
     rank 19: 5.05
  forward-send-backward-recv:
     rank  0: 2741.08
     rank  1: 2734.77
     rank  2: 2730.85
     rank  3: 2703.96
     rank  4: 1112.85
     rank  5: 1122.03
     rank  6: 1133.51
     rank  7: 1132.16
     rank  8: 901.36
     rank  9: 900.34
     rank 10: 882.46
     rank 11: 883.47
     rank 12: 297.95
     rank 13: 298.88
     rank 14: 287.66
     rank 15: 289.90
  backward-send-forward-recv:
     rank  4: 255.63
     rank  5: 260.00
     rank  6: 268.23
     rank  7: 239.79
     rank  8: 330.59
     rank  9: 333.32
     rank 10: 330.22
     rank 11: 329.83
     rank 12: 264.62
     rank 13: 268.45
     rank 14: 258.79
     rank 15: 256.21
     rank 16: 823.28
     rank 17: 823.32
     rank 18: 811.98
     rank 19: 815.59
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.08
     rank  1: 0.08
     rank  2: 0.10
     rank  3: 0.08
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.05
     rank 17: 0.05
     rank 18: 0.04
     rank 19: 0.05
  all-grads-sync:
     rank  0: 1.06
     rank  1: 1.04
     rank  2: 1.12
     rank  3: 1.06
     rank  4: 2.64
     rank  5: 2.37
     rank  6: 2.44
     rank  7: 2.36
     rank  8: 2.54
     rank  9: 2.59
     rank 10: 2.46
     rank 11: 2.70
     rank 12: 2.91
     rank 13: 2.94
     rank 14: 2.89
     rank 15: 2.95
     rank 16: 2.88
     rank 17: 2.85
     rank 18: 2.82
     rank 19: 2.95
  optimizer-copy-to-main-grad:
     rank  0: 0.28
     rank  1: 0.29
     rank  2: 0.26
     rank  3: 0.25
     rank  4: 0.07
     rank  5: 0.05
     rank  6: 0.06
     rank  7: 0.05
     rank  8: 0.06
     rank  9: 0.06
     rank 10: 0.04
     rank 11: 0.09
     rank 12: 0.06
     rank 13: 0.06
     rank 14: 0.04
     rank 15: 0.05
     rank 16: 0.06
     rank 17: 0.07
     rank 18: 0.05
     rank 19: 0.06
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 19.38
     rank  1: 19.47
     rank  2: 19.42
     rank  3: 19.54
     rank  4: 48.04
     rank  5: 48.72
     rank  6: 48.45
     rank  7: 47.92
     rank  8: 51.69
     rank  9: 52.20
     rank 10: 51.90
     rank 11: 52.19
     rank 12: 58.99
     rank 13: 59.00
     rank 14: 59.03
     rank 15: 59.04
     rank 16: 56.95
     rank 17: 56.98
     rank 18: 56.90
     rank 19: 56.98
  optimizer:
     rank  0: 20.58
     rank  1: 20.68
     rank  2: 20.64
     rank  3: 20.74
     rank  4: 49.24
     rank  5: 49.92
     rank  6: 49.66
     rank  7: 49.13
     rank  8: 52.90
     rank  9: 53.40
     rank 10: 53.10
     rank 11: 53.39
     rank 12: 60.19
     rank 13: 60.20
     rank 14: 60.24
     rank 15: 60.24
     rank 16: 58.14
     rank 17: 58.18
     rank 18: 58.10
     rank 19: 58.18
 [2024-12-31 14:14:08] iteration        9/      10 | consumed samples:          288 | elapsed time per iteration (ms): 10131.0 | learning rate: 6.750000E-06 | global batch size:    32 | lm loss: 1.781470E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 10026.92
     rank  1: 10026.92
     rank  2: 10026.95
     rank  3: 10027.07
     rank  4: 10029.63
     rank  5: 10029.56
     rank  6: 10029.61
     rank  7: 10029.58
     rank  8: 10030.08
     rank  9: 10029.91
     rank 10: 10030.00
     rank 11: 10029.96
     rank 12: 10030.61
     rank 13: 10030.57
     rank 14: 10030.62
     rank 15: 10030.59
     rank 16: 10030.41
     rank 17: 10030.40
     rank 18: 10030.41
     rank 19: 10030.42
  forward-compute:
     rank  0: 3524.23
     rank  1: 3519.49
     rank  2: 3521.34
     rank  3: 3526.14
     rank  4: 3755.15
     rank  5: 3752.32
     rank  6: 3750.21
     rank  7: 3767.94
     rank  8: 3531.31
     rank  9: 3530.86
     rank 10: 3535.53
     rank 11: 3536.65
     rank 12: 3935.16
     rank 13: 3932.46
     rank 14: 3939.73
     rank 15: 3943.11
     rank 16: 3726.64
     rank 17: 3727.40
     rank 18: 3736.72
     rank 19: 3739.03
  backward-compute:
     rank  0: 2917.56
     rank  1: 2924.43
     rank  2: 2943.86
     rank  3: 2948.51
     rank  4: 4232.51
     rank  5: 4217.71
     rank  6: 4202.74
     rank  7: 4214.79
     rank  8: 4569.34
     rank  9: 4573.29
     rank 10: 4582.58
     rank 11: 4584.65
     rank 12: 4651.09
     rank 13: 4651.43
     rank 14: 4669.22
     rank 15: 4671.79
     rank 16: 4437.77
     rank 17: 4435.45
     rank 18: 4444.62
     rank 19: 4441.80
  pure-backward-compute:
     rank  0: 2916.08
     rank  1: 2922.91
     rank  2: 2942.48
     rank  3: 2946.93
     rank  4: 4230.02
     rank  5: 4215.59
     rank  6: 4199.45
     rank  7: 4212.57
     rank  8: 4565.61
     rank  9: 4570.38
     rank 10: 4579.87
     rank 11: 4581.54
     rank 12: 4648.94
     rank 13: 4649.02
     rank 14: 4667.78
     rank 15: 4670.33
     rank 16: 4433.58
     rank 17: 4431.30
     rank 18: 4441.94
     rank 19: 4438.99
  batch-generator:
     rank  0: 207.89
     rank  1: 212.18
     rank  2: 217.45
     rank  3: 234.53
     rank  4: 117.26
     rank  5: 122.09
     rank  6: 150.15
     rank  7: 154.30
     rank  8: 114.20
     rank  9: 112.34
     rank 10: 114.15
     rank 11: 123.59
     rank 12: 94.17
     rank 13: 98.00
     rank 14: 100.79
     rank 15: 107.10
     rank 16: 89.62
     rank 17: 92.16
     rank 18: 100.63
     rank 19: 104.00
  forward-recv:
     rank  4: 109.90
     rank  5: 109.96
     rank  6: 107.21
     rank  7: 104.00
     rank  8: 238.92
     rank  9: 238.19
     rank 10: 237.27
     rank 11: 235.14
     rank 12: 342.53
     rank 13: 343.14
     rank 14: 343.18
     rank 15: 342.77
     rank 16: 464.06
     rank 17: 464.03
     rank 18: 463.80
     rank 19: 463.71
  forward-send:
     rank  0: 75.82
     rank  1: 75.51
     rank  2: 71.91
     rank  3: 65.64
     rank  4: 17.96
     rank  5: 18.15
     rank  6: 17.27
     rank  7: 13.62
     rank  8: 16.38
     rank  9: 16.53
     rank 10: 15.71
     rank 11: 15.15
     rank 12: 5.22
     rank 13: 5.16
     rank 14: 4.76
     rank 15: 4.63
  backward-recv:
     rank  0: 736.17
     rank  1: 735.59
     rank  2: 733.02
     rank  3: 733.64
     rank  4: 412.31
     rank  5: 414.17
     rank  6: 415.92
     rank  7: 413.08
     rank  8: 244.32
     rank  9: 242.86
     rank 10: 243.38
     rank 11: 243.52
     rank 12: 110.85
     rank 13: 110.83
     rank 14: 110.87
     rank 15: 111.24
  backward-send:
     rank  4: 10.43
     rank  5: 9.86
     rank  6: 8.36
     rank  7: 9.23
     rank  8: 15.06
     rank  9: 15.59
     rank 10: 15.47
     rank 11: 14.44
     rank 12: 10.32
     rank 13: 10.21
     rank 14: 10.28
     rank 15: 9.39
     rank 16: 5.11
     rank 17: 5.08
     rank 18: 4.97
     rank 19: 4.36
  forward-send-backward-recv:
     rank  0: 2733.54
     rank  1: 2730.57
     rank  2: 2722.49
     rank  3: 2718.02
     rank  4: 1108.15
     rank  5: 1121.41
     rank  6: 1130.95
     rank  7: 1126.86
     rank  8: 824.42
     rank  9: 822.04
     rank 10: 810.57
     rank 11: 811.43
     rank 12: 298.33
     rank 13: 298.92
     rank 14: 290.15
     rank 15: 288.92
  backward-send-forward-recv:
     rank  4: 268.99
     rank  5: 271.46
     rank  6: 273.01
     rank  7: 265.76
     rank  8: 339.00
     rank  9: 341.86
     rank 10: 340.52
     rank 11: 339.63
     rank 12: 272.86
     rank 13: 274.41
     rank 14: 267.43
     rank 15: 263.24
     rank 16: 844.67
     rank 17: 846.24
     rank 18: 836.11
     rank 19: 836.36
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.06
     rank  2: 0.06
     rank  3: 0.06
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.05
     rank 17: 0.05
     rank 18: 0.04
     rank 19: 0.05
  all-grads-sync:
     rank  0: 1.07
     rank  1: 1.08
     rank  2: 1.08
     rank  3: 1.11
     rank  4: 2.44
     rank  5: 2.38
     rank  6: 2.42
     rank  7: 2.31
     rank  8: 2.66
     rank  9: 2.46
     rank 10: 2.61
     rank 11: 2.52
     rank 12: 2.89
     rank 13: 2.90
     rank 14: 2.89
     rank 15: 2.91
     rank 16: 2.86
     rank 17: 2.84
     rank 18: 2.80
     rank 19: 2.83
  optimizer-copy-to-main-grad:
     rank  0: 0.26
     rank  1: 0.27
     rank  2: 0.24
     rank  3: 0.26
     rank  4: 0.07
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.04
     rank  8: 0.09
     rank  9: 0.05
     rank 10: 0.09
     rank 11: 0.05
     rank 12: 0.05
     rank 13: 0.06
     rank 14: 0.05
     rank 15: 0.05
     rank 16: 0.06
     rank 17: 0.06
     rank 18: 0.05
     rank 19: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 19.55
     rank  1: 19.67
     rank  2: 19.49
     rank  3: 19.76
     rank  4: 48.04
     rank  5: 48.72
     rank  6: 48.50
     rank  7: 47.80
     rank  8: 51.86
     rank  9: 52.06
     rank 10: 51.98
     rank 11: 52.03
     rank 12: 58.96
     rank 13: 58.93
     rank 14: 59.06
     rank 15: 59.01
     rank 16: 56.98
     rank 17: 56.96
     rank 18: 56.91
     rank 19: 56.93
  optimizer:
     rank  0: 20.60
     rank  1: 20.72
     rank  2: 20.54
     rank  3: 20.83
     rank  4: 49.09
     rank  5: 49.77
     rank  6: 49.54
     rank  7: 48.85
     rank  8: 52.91
     rank  9: 53.11
     rank 10: 53.03
     rank 11: 53.08
     rank 12: 60.00
     rank 13: 59.98
     rank 14: 60.10
     rank 15: 60.06
     rank 16: 58.02
     rank 17: 58.00
     rank 18: 57.96
     rank 19: 57.97
 [2024-12-31 14:14:18] iteration       10/      10 | consumed samples:          320 | elapsed time per iteration (ms): 10058.1 | learning rate: 7.500000E-06 | global batch size:    32 | lm loss: 2.074239E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 9954.49
     rank  1: 9954.47
     rank  2: 9954.49
     rank  3: 9954.52
     rank  4: 9957.12
     rank  5: 9957.08
     rank  6: 9957.14
     rank  7: 9957.08
     rank  8: 9958.37
     rank  9: 9957.50
     rank 10: 9957.44
     rank 11: 9957.46
     rank 12: 9958.31
     rank 13: 9958.13
     rank 14: 9958.07
     rank 15: 9958.07
     rank 16: 9957.91
     rank 17: 9957.91
     rank 18: 9957.88
     rank 19: 9957.91
  forward-compute:
     rank  0: 3277.41
     rank  1: 3273.20
     rank  2: 3277.66
     rank  3: 3283.41
     rank  4: 3757.27
     rank  5: 3753.63
     rank  6: 3755.77
     rank  7: 3774.23
     rank  8: 3568.34
     rank  9: 3564.88
     rank 10: 3573.55
     rank 11: 3573.86
     rank 12: 3933.36
     rank 13: 3930.88
     rank 14: 3936.90
     rank 15: 3945.75
     rank 16: 3732.43
     rank 17: 3732.83
     rank 18: 3741.73
     rank 19: 3743.74
  backward-compute:
     rank  0: 2899.08
     rank  1: 2904.30
     rank  2: 2932.97
     rank  3: 2936.68
     rank  4: 4249.98
     rank  5: 4228.76
     rank  6: 4215.79
     rank  7: 4222.16
     rank  8: 4609.77
     rank  9: 4618.01
     rank 10: 4629.80
     rank 11: 4631.12
     rank 12: 4650.53
     rank 13: 4649.74
     rank 14: 4667.76
     rank 15: 4669.12
     rank 16: 4440.82
     rank 17: 4438.38
     rank 18: 4447.86
     rank 19: 4445.19
  pure-backward-compute:
     rank  0: 2897.59
     rank  1: 2902.42
     rank  2: 2931.61
     rank  3: 2935.18
     rank  4: 4247.24
     rank  5: 4226.47
     rank  6: 4213.28
     rank  7: 4220.19
     rank  8: 4606.52
     rank  9: 4615.06
     rank 10: 4626.76
     rank 11: 4628.19
     rank 12: 4648.35
     rank 13: 4647.25
     rank 14: 4666.35
     rank 15: 4667.70
     rank 16: 4436.56
     rank 17: 4434.20
     rank 18: 4445.20
     rank 19: 4442.34
  batch-generator:
     rank  0: 133.60
     rank  1: 138.67
     rank  2: 147.21
     rank  3: 162.64
     rank  4: 112.36
     rank  5: 117.46
     rank  6: 137.44
     rank  7: 152.27
     rank  8: 120.61
     rank  9: 115.36
     rank 10: 121.58
     rank 11: 129.56
     rank 12: 94.89
     rank 13: 98.55
     rank 14: 101.36
     rank 15: 112.41
     rank 16: 90.27
     rank 17: 93.58
     rank 18: 101.00
     rank 19: 104.45
  forward-recv:
     rank  4: 110.63
     rank  5: 110.58
     rank  6: 108.25
     rank  7: 105.26
     rank  8: 238.87
     rank  9: 238.02
     rank 10: 236.34
     rank 11: 234.14
     rank 12: 345.01
     rank 13: 345.59
     rank 14: 345.65
     rank 15: 344.45
     rank 16: 466.65
     rank 17: 466.69
     rank 18: 466.45
     rank 19: 465.99
  forward-send:
     rank  0: 75.12
     rank  1: 74.59
     rank  2: 70.81
     rank  3: 63.87
     rank  4: 17.88
     rank  5: 17.95
     rank  6: 16.67
     rank  7: 12.14
     rank  8: 17.98
     rank  9: 18.21
     rank 10: 17.47
     rank 11: 15.62
     rank 12: 5.02
     rank 13: 5.10
     rank 14: 4.82
     rank 15: 4.23
  backward-recv:
     rank  0: 740.38
     rank  1: 738.94
     rank  2: 736.81
     rank  3: 737.36
     rank  4: 412.06
     rank  5: 411.87
     rank  6: 414.91
     rank  7: 415.07
     rank  8: 243.69
     rank  9: 243.64
     rank 10: 243.11
     rank 11: 242.46
     rank 12: 111.27
     rank 13: 111.23
     rank 14: 111.50
     rank 15: 111.75
  backward-send:
     rank  4: 10.62
     rank  5: 10.61
     rank  6: 8.54
     rank  7: 8.96
     rank  8: 15.35
     rank  9: 15.23
     rank 10: 15.64
     rank 11: 15.59
     rank 12: 10.35
     rank 13: 10.24
     rank 14: 9.98
     rank 15: 9.56
     rank 16: 5.19
     rank 17: 5.21
     rank 18: 4.68
     rank 19: 4.45
  forward-send-backward-recv:
     rank  0: 2922.22
     rank  1: 2920.18
     rank  2: 2901.52
     rank  3: 2897.79
     rank  4: 1126.76
     rank  5: 1147.17
     rank  6: 1153.26
     rank  7: 1153.44
     rank  8: 767.02
     rank  9: 761.57
     rank 10: 748.38
     rank 11: 747.92
     rank 12: 298.54
     rank 13: 300.11
     rank 14: 292.78
     rank 15: 290.41
  backward-send-forward-recv:
     rank  4: 154.80
     rank  5: 160.42
     rank  6: 158.57
     rank  7: 152.48
     rank  8: 243.01
     rank  9: 248.66
     rank 10: 243.18
     rank 11: 246.52
     rank 12: 200.34
     rank 13: 201.59
     rank 14: 194.37
     rank 15: 188.25
     rank 16: 760.56
     rank 17: 762.50
     rank 18: 752.76
     rank 19: 752.96
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.04
     rank  2: 0.03
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.09
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.09
     rank  1: 0.08
     rank  2: 0.08
     rank  3: 0.08
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.06
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.06
     rank 17: 0.05
     rank 18: 0.04
     rank 19: 0.06
  all-grads-sync:
     rank  0: 1.09
     rank  1: 1.14
     rank  2: 1.10
     rank  3: 1.06
     rank  4: 2.34
     rank  5: 2.37
     rank  6: 2.46
     rank  7: 2.36
     rank  8: 3.55
     rank  9: 2.57
     rank 10: 2.52
     rank 11: 2.48
     rank 12: 2.91
     rank 13: 2.91
     rank 14: 2.88
     rank 15: 2.90
     rank 16: 2.89
     rank 17: 2.85
     rank 18: 2.80
     rank 19: 2.87
  optimizer-copy-to-main-grad:
     rank  0: 0.29
     rank  1: 0.22
     rank  2: 0.25
     rank  3: 0.26
     rank  4: 0.04
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.25
     rank  9: 0.05
     rank 10: 0.06
     rank 11: 0.04
     rank 12: 0.06
     rank 13: 0.06
     rank 14: 0.05
     rank 15: 0.05
     rank 16: 0.06
     rank 17: 0.06
     rank 18: 0.05
     rank 19: 0.06
  optimizer-clip-main-grad:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.07
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 19.61
     rank  1: 19.24
     rank  2: 19.60
     rank  3: 19.28
     rank  4: 47.75
     rank  5: 48.73
     rank  6: 48.49
     rank  7: 47.87
     rank  8: 53.08
     rank  9: 52.21
     rank 10: 51.89
     rank 11: 52.11
     rank 12: 58.99
     rank 13: 58.99
     rank 14: 59.03
     rank 15: 58.97
     rank 16: 57.02
     rank 17: 56.99
     rank 18: 56.90
     rank 19: 56.97
  optimizer:
     rank  0: 21.07
     rank  1: 20.71
     rank  2: 21.07
     rank  3: 20.74
     rank  4: 49.22
     rank  5: 50.20
     rank  6: 49.96
     rank  7: 49.34
     rank  8: 54.56
     rank  9: 53.68
     rank 10: 53.36
     rank 11: 53.58
     rank 12: 60.45
     rank 13: 60.46
     rank 14: 60.49
     rank 15: 60.44
     rank 16: 58.48
     rank 17: 58.46
     rank 18: 58.37
     rank 19: 58.43
