examples/multimodal/pretrain-freeze-llm-hete-2080first.sh: line 4: activate: No such file or directory
3
[2024-12-30 23:08:25,427] torch.distributed.run: [WARNING] 
[2024-12-30 23:08:25,427] torch.distributed.run: [WARNING] *****************************************
[2024-12-30 23:08:25,427] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-12-30 23:08:25,427] torch.distributed.run: [WARNING] *****************************************
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:8------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:8------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:8------
------num_pipeline_model_parallel_groups:4------
> setting tensorboard ...
WARNING: one_logger package is required to enable e2e metrics tracking. please go to https://confluence.nvidia.com/display/MLWFO/Package+Repositories for details to install it
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:8------
------num_pipeline_model_parallel_groups:4------
---Rank 13---Tensor Parallel Group GPUs: [1, 1]
---Rank 13---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
---Rank 15---Tensor Parallel Group GPUs: [1, 1]
---Rank 12---Tensor Parallel Group GPUs: [0, 0]---Rank 15---Pipeline Parallel Group GPUs: [3, 3, 3, 3]

[rank13]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
---Rank 12---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
[rank15]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank12]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
---Rank 14---Tensor Parallel Group GPUs: [0, 0]
---Rank 14---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
[rank14]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
 > number of parameters on (tensor, pipeline) model parallel rank (1, 3): 285233152
 > number of parameters on (tensor, pipeline) model parallel rank (0, 3): 285233152
INFO:megatron.core.distributed.param_and_grad_buffer:Number of buckets for gradient all-reduce / reduce-scatter: 1
Params for bucket 1 (285233152 elements):
	language_model.output_layer.weight
	language_model.decoder.layers.1.mlp.linear_fc2.weight
	language_model.decoder.layers.1.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.1.mlp.linear_fc1.weight
	language_model.decoder.layers.1.self_attention.linear_proj.weight
	language_model.decoder.layers.0.mlp.linear_fc1.weight
	language_model.decoder.layers.0.self_attention.linear_qkv.weight
	language_model.decoder.layers.0.self_attention.linear_proj.weight
	language_model.decoder.final_layernorm.weight
	language_model.decoder.layers.1.self_attention.linear_qkv.weight
	language_model.decoder.layers.1.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.0.mlp.linear_fc2.weight
	language_model.decoder.layers.0.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.0.self_attention.linear_qkv.layer_norm_weight
rank=0, worker=0: shard_range=[pretrain-0.tar[0, 100), pretrain-0.tar[100, 200), pretrain-0.tar[200, 300), ...<1244>, pretrain-2.tar[4700, 4800), pretrain-2.tar[4800, 4900), pretrain-2.tar[4900, 5000)] sum(count)=125000
rank=0, worker=1: shard_range=[pretrain-2.tar[5000, 5100), pretrain-2.tar[5100, 5200), pretrain-2.tar[5200, 5300), ...<1244>, pretrain-30.tar[9700, 9800), pretrain-30.tar[9800, 9900), pretrain-30.tar[9900, 10000)] sum(count)=125000
rank=1, worker=0: shard_range=[pretrain-31.tar[0, 100), pretrain-31.tar[100, 200), pretrain-31.tar[200, 300), ...<1244>, pretrain-42.tar[4700, 4800), pretrain-42.tar[4800, 4900), pretrain-42.tar[4900, 5000)] sum(count)=125000
rank=1, worker=1: shard_range=[pretrain-42.tar[5000, 5100), pretrain-42.tar[5100, 5200), pretrain-42.tar[5200, 5300), ...<1244>, pretrain-53.tar[9700, 9800), pretrain-53.tar[9800, 9900), pretrain-53.tar[9900, 10000)] sum(count)=125000
rank=0, worker=0: shard_range=[pretrain-54.tar[0, 10000), pretrain-55.tar[0, 4532)] sum(count)=14532
rank=0, worker=1: shard_range=[pretrain-55.tar[4532, 8128), pretrain-6.tar[0, 10000), pretrain-7.tar[0, 936)] sum(count)=14532
rank=1, worker=0: shard_range=[pretrain-7.tar[936, 10000), pretrain-8.tar[0, 5468)] sum(count)=14532
rank=1, worker=1: shard_range=[pretrain-8.tar[5468, 10000), pretrain-9.tar[0, 10000)] sum(count)=14532
times across ranks (ms):
  model-and-optimizer-setup:
     rank  0: 134.52
     rank  1: 135.08
     rank  2: 133.11
     rank  3: 135.71
     rank  4: 33.97
     rank  5: 47.48
     rank  6: 47.40
     rank  7: 50.90
     rank  8: 23.98
     rank  9: 34.96
     rank 10: 27.63
     rank 11: 25.92
     rank 12: 52.47
     rank 13: 52.40
     rank 14: 49.35
     rank 15: 48.59
  train/valid/test-data-iterators-setup:
     rank  0: 1084.42
     rank  1: 1084.21
     rank  2: 1252.54
     rank  3: 1084.17
     rank  4: 1084.25
     rank  5: 1084.24
     rank  6: 1084.25
     rank  7: 1085.05
     rank  8: 1084.44
     rank  9: 1084.84
     rank 10: 1084.47
     rank 11: 1084.43
     rank 12: 1252.51
     rank 13: 1252.54
     rank 14: 1252.48
     rank 15: 1253.00
 [2024-12-30 23:09:03] iteration        1/      10 | consumed samples:           32 | elapsed time per iteration (ms): 15536.9 | learning rate: 7.500000E-07 | global batch size:    32 | lm loss: 7.058038E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
[Rank 13] (after 1 iterations) memory (MB) | allocated: 4405.5654296875 | max allocated: 5493.416015625 | reserved: 5934.0 | max reserved: 5934.0
stage4 GPU utialization:48.769673434170805 %
[Rank 12] (after 1 iterations) memory (MB) | allocated: 4405.5654296875 | max allocated: 5493.416015625 | reserved: 5870.0 | max reserved: 5870.0
times across ranks (ms):
  forward-backward:
     rank  0: 15446.62
     rank  1: 15446.35
     rank  2: 15446.57
     rank  3: 15446.38
     rank  4: 15445.86
     rank  5: 15445.90
     rank  6: 15445.83
     rank  7: 15445.82
     rank  8: 15444.94
     rank  9: 15445.00
     rank 10: 15444.96
     rank 11: 15444.94
     rank 12: 15444.35
     rank 13: 15444.45
     rank 14: 15444.33
     rank 15: 15444.36
  forward-compute:
     rank  0: 3539.84
     rank  1: 3547.49
     rank  2: 3588.66
     rank  3: 3579.78
     rank  4: 4428.24
     rank  5: 4441.73
     rank  6: 4428.96
     rank  7: 4424.84
     rank  8: 3392.27
     rank  9: 3396.27
     rank 10: 3467.08
     rank 11: 3468.18
     rank 12: 2575.06
     rank 13: 2586.49
     rank 14: 2440.79
     rank 15: 2451.54
  backward-compute:
     rank  0: 2110.01
     rank  1: 2112.68
     rank  2: 2133.64
     rank  3: 2134.91
     rank  4: 2908.86
     rank  5: 2914.29
     rank  6: 2941.79
     rank  7: 2940.90
     rank  8: 1468.48
     rank  9: 1471.08
     rank 10: 1470.42
     rank 11: 1475.98
     rank 12: 1612.38
     rank 13: 1606.82
     rank 14: 1637.78
     rank 15: 1632.65
  pure-backward-compute:
     rank  0: 2108.98
     rank  1: 2111.42
     rank  2: 2132.63
     rank  3: 2134.03
     rank  4: 2907.54
     rank  5: 2912.99
     rank  6: 2940.50
     rank  7: 2939.55
     rank  8: 1466.27
     rank  9: 1468.97
     rank 10: 1468.28
     rank 11: 1474.48
     rank 12: 1609.73
     rank 13: 1604.18
     rank 14: 1634.89
     rank 15: 1629.86
  batch-generator:
     rank  0: 1043.90
     rank  1: 1059.37
     rank  2: 1054.14
     rank  3: 1043.30
     rank  4: 1157.39
     rank  5: 1170.05
     rank  6: 934.95
     rank  7: 932.73
     rank  8: 1140.52
     rank  9: 1144.15
     rank 10: 1162.89
     rank 11: 1159.99
     rank 12: 1230.79
     rank 13: 1229.21
     rank 14: 1208.69
     rank 15: 1223.37
  forward-recv:
     rank  4: 2272.29
     rank  5: 2265.80
     rank  6: 2267.87
     rank  7: 2270.61
     rank  8: 5590.97
     rank  9: 5593.71
     rank 10: 5550.76
     rank 11: 5551.52
     rank 12: 8045.78
     rank 13: 8041.56
     rank 14: 8079.44
     rank 15: 8078.24
  forward-send:
     rank  0: 5744.85
     rank  1: 5737.08
     rank  2: 5777.29
     rank  3: 5780.59
     rank  4: 2402.30
     rank  5: 2400.99
     rank  6: 2480.69
     rank  7: 2480.11
     rank  8: 27.51
     rank  9: 23.36
     rank 10: 25.77
     rank 11: 24.53
  backward-recv:
     rank  0: 323.21
     rank  1: 322.55
     rank  2: 285.19
     rank  3: 286.49
     rank  4: 167.39
     rank  5: 168.45
     rank  6: 130.67
     rank  7: 131.29
     rank  8: 86.83
     rank  9: 86.56
     rank 10: 74.27
     rank 11: 74.76
  backward-send:
     rank  4: 1.57
     rank  5: 1.15
     rank  6: 1.14
     rank  7: 1.16
     rank  8: 5.23
     rank  9: 5.53
     rank 10: 5.31
     rank 11: 5.47
     rank 12: 2.72
     rank 13: 2.76
     rank 14: 2.85
     rank 15: 2.80
  forward-send-backward-recv:
     rank  0: 3114.67
     rank  1: 3114.12
     rank  2: 3056.06
     rank  3: 3059.06
     rank  4: 1701.78
     rank  5: 1700.28
     rank  6: 1645.12
     rank  7: 1644.73
     rank  8: 1688.20
     rank  9: 1686.30
     rank 10: 1561.78
     rank 11: 1559.57
  backward-send-forward-recv:
     rank  4: 875.10
     rank  5: 870.47
     rank  6: 870.75
     rank  7: 872.53
     rank  8: 2403.52
     rank  9: 2401.03
     rank 10: 2509.17
     rank 11: 2509.18
     rank 12: 2335.81
     rank 13: 2332.53
     rank 14: 2414.49
     rank 15: 2409.77
  layernorm-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.05
     rank  3: 0.05
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.07
     rank 11: 0.03
     rank 12: 0.05
     rank 13: 0.06
     rank 14: 0.03
     rank 15: 0.04
  embedding-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.04
     rank  4: 0.09
     rank  5: 0.10
     rank  6: 0.09
     rank  7: 0.10
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.03
     rank 12: 0.13
     rank 13: 0.16
     rank 14: 0.08
     rank 15: 0.08
  all-grads-sync:
     rank  0: 324.52
     rank  1: 329.14
     rank  2: 324.49
     rank  3: 329.08
     rank  4: 577.34
     rank  5: 582.10
     rank  6: 577.32
     rank  7: 582.10
     rank  8: 512.59
     rank  9: 501.92
     rank 10: 512.49
     rank 11: 502.12
     rank 12: 265.82
     rank 13: 266.38
     rank 14: 265.89
     rank 15: 266.40
  optimizer-copy-to-main-grad:
     rank  0: 0.28
     rank  1: 0.26
     rank  2: 0.28
     rank  3: 0.36
     rank  4: 0.08
     rank  5: 0.08
     rank  6: 0.08
     rank  7: 0.07
     rank  8: 0.06
     rank  9: 0.12
     rank 10: 0.09
     rank 11: 0.05
     rank 12: 0.06
     rank 13: 0.08
     rank 14: 0.04
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 46.88
     rank  1: 46.99
     rank  2: 47.95
     rank  3: 47.33
     rank  4: 84.47
     rank  5: 84.62
     rank  6: 82.91
     rank  7: 81.69
     rank  8: 69.28
     rank  9: 70.20
     rank 10: 69.93
     rank 11: 69.77
     rank 12: 64.24
     rank 13: 64.91
     rank 14: 64.33
     rank 15: 71.41
  optimizer:
     rank  0: 48.09
     rank  1: 48.20
     rank  2: 49.16
     rank  3: 48.52
     rank  4: 85.69
     rank  5: 85.84
     rank  6: 84.13
     rank  7: 82.90
     rank  8: 70.49
     rank  9: 71.41
     rank 10: 71.14
     rank 11: 70.99
     rank 12: 65.45
     rank 13: 66.12
     rank 14: 65.54
     rank 15: 72.63
 [2024-12-30 23:09:07] iteration        2/      10 | consumed samples:           64 | elapsed time per iteration (ms): 4021.1 | learning rate: 1.500000E-06 | global batch size:    32 | lm loss: 7.286368E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 3918.21
     rank  1: 3918.36
     rank  2: 3918.28
     rank  3: 3918.32
     rank  4: 3921.74
     rank  5: 3921.97
     rank  6: 3921.77
     rank  7: 3921.96
     rank  8: 3920.83
     rank  9: 3920.94
     rank 10: 3920.96
     rank 11: 3920.87
     rank 12: 3919.87
     rank 13: 3920.31
     rank 14: 3919.93
     rank 15: 3920.19
  forward-compute:
     rank  0: 1510.59
     rank  1: 1511.37
     rank  2: 1571.84
     rank  3: 1572.99
     rank  4: 1207.36
     rank  5: 1207.01
     rank  6: 1203.97
     rank  7: 1204.85
     rank  8: 1007.30
     rank  9: 1020.42
     rank 10: 1015.45
     rank 11: 1018.72
     rank 12: 1072.47
     rank 13: 1071.75
     rank 14: 1082.27
     rank 15: 1087.25
  backward-compute:
     rank  0: 1271.14
     rank  1: 1267.25
     rank  2: 1273.82
     rank  3: 1272.73
     rank  4: 1583.69
     rank  5: 1599.06
     rank  6: 1602.52
     rank  7: 1602.63
     rank  8: 1471.50
     rank  9: 1472.23
     rank 10: 1472.01
     rank 11: 1477.20
     rank 12: 1613.62
     rank 13: 1616.25
     rank 14: 1623.50
     rank 15: 1624.58
  pure-backward-compute:
     rank  0: 1270.35
     rank  1: 1266.48
     rank  2: 1272.97
     rank  3: 1272.03
     rank  4: 1582.27
     rank  5: 1597.69
     rank  6: 1601.51
     rank  7: 1601.74
     rank  8: 1469.73
     rank  9: 1470.45
     rank 10: 1469.63
     rank 11: 1475.87
     rank 12: 1610.97
     rank 13: 1613.27
     rank 14: 1620.75
     rank 15: 1621.72
  batch-generator:
     rank  0: 72.71
     rank  1: 77.36
     rank  2: 80.55
     rank  3: 81.87
     rank  4: 65.41
     rank  5: 72.48
     rank  6: 54.80
     rank  7: 57.22
     rank  8: 55.42
     rank  9: 69.03
     rank 10: 64.88
     rank 11: 66.25
     rank 12: 65.76
     rank 13: 65.09
     rank 14: 65.58
     rank 15: 69.17
  forward-recv:
     rank  4: 123.05
     rank  5: 122.61
     rank  6: 132.13
     rank  7: 132.20
     rank  8: 191.85
     rank  9: 191.89
     rank 10: 202.52
     rank 11: 202.51
     rank 12: 230.28
     rank 13: 230.76
     rank 14: 234.21
     rank 15: 234.28
  forward-send:
     rank  0: 1.54
     rank  1: 1.44
     rank  2: 1.93
     rank  3: 1.64
     rank  4: 5.64
     rank  5: 5.63
     rank  6: 5.62
     rank  7: 5.24
     rank  8: 2.81
     rank  9: 3.00
     rank 10: 2.88
     rank 11: 2.65
  backward-recv:
     rank  0: 287.25
     rank  1: 287.92
     rank  2: 283.89
     rank  3: 284.01
     rank  4: 142.18
     rank  5: 142.00
     rank  6: 146.66
     rank  7: 145.96
     rank  8: 80.17
     rank  9: 80.17
     rank 10: 83.92
     rank 11: 84.62
  backward-send:
     rank  4: 1.32
     rank  5: 1.36
     rank  6: 1.09
     rank  7: 1.13
     rank  8: 7.51
     rank  9: 7.46
     rank 10: 7.64
     rank 11: 6.73
     rank 12: 4.65
     rank 13: 4.60
     rank 14: 4.11
     rank 15: 4.46
  forward-send-backward-recv:
     rank  0: 306.81
     rank  1: 312.10
     rank  2: 247.43
     rank  3: 247.72
     rank  4: 221.83
     rank  5: 212.63
     rank  6: 199.86
     rank  7: 197.51
     rank  8: 162.66
     rank  9: 163.07
     rank 10: 153.90
     rank 11: 150.21
  backward-send-forward-recv:
     rank  4: 14.14
     rank  5: 15.69
     rank  6: 16.00
     rank  7: 15.98
     rank  8: 283.11
     rank  9: 269.51
     rank 10: 267.04
     rank 11: 265.33
     rank 12: 193.06
     rank 13: 190.78
     rank 14: 168.18
     rank 15: 161.92
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.05
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.06
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.06
     rank 14: 0.06
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.07
     rank  6: 0.05
     rank  7: 0.11
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.04
     rank 11: 0.02
     rank 12: 0.07
     rank 13: 0.11
     rank 14: 0.13
     rank 15: 0.07
  all-grads-sync:
     rank  0: 235.58
     rank  1: 225.39
     rank  2: 235.45
     rank  3: 225.34
     rank  4: 520.37
     rank  5: 520.43
     rank  6: 520.36
     rank  7: 520.43
     rank  8: 435.27
     rank  9: 435.20
     rank 10: 435.25
     rank 11: 435.23
     rank 12: 245.84
     rank 13: 241.56
     rank 14: 245.68
     rank 15: 241.48
  optimizer-copy-to-main-grad:
     rank  0: 0.23
     rank  1: 0.21
     rank  2: 0.22
     rank  3: 0.22
     rank  4: 0.05
     rank  5: 0.06
     rank  6: 0.05
     rank  7: 0.08
     rank  8: 0.04
     rank  9: 0.07
     rank 10: 0.10
     rank 11: 0.05
     rank 12: 0.03
     rank 13: 0.10
     rank 14: 0.06
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 27.23
     rank  1: 27.57
     rank  2: 27.49
     rank  3: 27.33
     rank  4: 64.95
     rank  5: 65.06
     rank  6: 65.09
     rank  7: 65.28
     rank  8: 53.63
     rank  9: 53.76
     rank 10: 53.84
     rank 11: 53.67
     rank 12: 45.06
     rank 13: 45.37
     rank 14: 45.31
     rank 15: 45.21
  optimizer:
     rank  0: 28.11
     rank  1: 28.37
     rank  2: 28.31
     rank  3: 28.14
     rank  4: 65.76
     rank  5: 65.86
     rank  6: 65.89
     rank  7: 66.10
     rank  8: 54.43
     rank  9: 54.57
     rank 10: 54.65
     rank 11: 54.48
     rank 12: 45.87
     rank 13: 46.17
     rank 14: 46.12
     rank 15: 46.03
 [2024-12-30 23:09:11] iteration        3/      10 | consumed samples:           96 | elapsed time per iteration (ms): 4229.7 | learning rate: 2.250000E-06 | global batch size:    32 | lm loss: 6.753838E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4127.64
     rank  1: 4127.76
     rank  2: 4127.72
     rank  3: 4127.76
     rank  4: 4131.17
     rank  5: 4131.31
     rank  6: 4131.19
     rank  7: 4131.31
     rank  8: 4130.17
     rank  9: 4130.29
     rank 10: 4130.16
     rank 11: 4130.26
     rank 12: 4129.33
     rank 13: 4129.42
     rank 14: 4129.34
     rank 15: 4129.36
  forward-compute:
     rank  0: 1670.68
     rank  1: 1671.69
     rank  2: 1736.45
     rank  3: 1738.09
     rank  4: 1181.13
     rank  5: 1184.16
     rank  6: 1212.02
     rank  7: 1211.33
     rank  8: 1001.54
     rank  9: 1006.46
     rank 10: 1011.12
     rank 11: 1015.47
     rank 12: 1263.08
     rank 13: 1260.44
     rank 14: 1061.06
     rank 15: 1060.30
  backward-compute:
     rank  0: 1269.43
     rank  1: 1268.22
     rank  2: 1272.78
     rank  3: 1267.52
     rank  4: 1582.67
     rank  5: 1588.06
     rank  6: 1610.05
     rank  7: 1615.93
     rank  8: 1475.14
     rank  9: 1475.39
     rank 10: 1471.90
     rank 11: 1471.50
     rank 12: 1587.66
     rank 13: 1589.88
     rank 14: 1632.91
     rank 15: 1634.19
  pure-backward-compute:
     rank  0: 1268.56
     rank  1: 1267.47
     rank  2: 1271.94
     rank  3: 1266.78
     rank  4: 1581.28
     rank  5: 1587.02
     rank  6: 1608.72
     rank  7: 1614.48
     rank  8: 1473.27
     rank  9: 1473.62
     rank 10: 1470.41
     rank 11: 1470.24
     rank 12: 1585.19
     rank 13: 1587.27
     rank 14: 1630.13
     rank 15: 1631.23
  batch-generator:
     rank  0: 75.87
     rank  1: 79.32
     rank  2: 78.62
     rank  3: 82.53
     rank  4: 56.61
     rank  5: 68.73
     rank  6: 68.31
     rank  7: 70.36
     rank  8: 54.08
     rank  9: 58.47
     rank 10: 60.73
     rank 11: 62.47
     rank 12: 57.66
     rank 13: 58.74
     rank 14: 60.30
     rank 15: 59.79
  forward-recv:
     rank  4: 121.60
     rank  5: 121.81
     rank  6: 127.33
     rank  7: 127.22
     rank  8: 195.36
     rank  9: 194.34
     rank 10: 195.57
     rank 11: 195.53
     rank 12: 232.29
     rank 13: 232.66
     rank 14: 235.22
     rank 15: 235.21
  forward-send:
     rank  0: 1.44
     rank  1: 1.20
     rank  2: 1.66
     rank  3: 1.33
     rank  4: 7.86
     rank  5: 6.90
     rank  6: 7.83
     rank  7: 7.41
     rank  8: 2.81
     rank  9: 3.03
     rank 10: 2.94
     rank 11: 2.87
  backward-recv:
     rank  0: 321.85
     rank  1: 322.22
     rank  2: 291.05
     rank  3: 292.63
     rank  4: 170.04
     rank  5: 171.16
     rank  6: 133.83
     rank  7: 133.81
     rank  8: 90.68
     rank  9: 90.79
     rank 10: 79.52
     rank 11: 79.74
  backward-send:
     rank  4: 1.37
     rank  5: 0.91
     rank  6: 1.52
     rank  7: 1.81
     rank  8: 5.10
     rank  9: 5.42
     rank 10: 5.49
     rank 11: 5.30
     rank 12: 2.52
     rank 13: 2.73
     rank 14: 2.77
     rank 15: 2.81
  forward-send-backward-recv:
     rank  0: 322.53
     rank  1: 326.63
     rank  2: 289.49
     rank  3: 291.27
     rank  4: 251.93
     rank  5: 250.29
     rank  6: 199.17
     rank  7: 196.82
     rank  8: 318.21
     rank  9: 318.70
     rank 10: 150.18
     rank 11: 151.80
  backward-send-forward-recv:
     rank  4: 196.42
     rank  5: 195.29
     rank  6: 227.71
     rank  7: 227.30
     rank  8: 330.45
     rank  9: 326.04
     rank 10: 504.97
     rank 11: 501.29
     rank 12: 240.38
     rank 13: 240.43
     rank 14: 397.63
     rank 15: 397.17
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.06
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.05
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.07
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.06
     rank 13: 0.09
     rank 14: 0.07
     rank 15: 0.06
  all-grads-sync:
     rank  0: 241.35
     rank  1: 230.75
     rank  2: 241.22
     rank  3: 230.64
     rank  4: 517.35
     rank  5: 517.43
     rank  6: 517.36
     rank  7: 517.41
     rank  8: 431.64
     rank  9: 431.65
     rank 10: 431.51
     rank 11: 431.64
     rank 12: 244.24
     rank 13: 243.52
     rank 14: 244.23
     rank 15: 243.51
  optimizer-copy-to-main-grad:
     rank  0: 0.22
     rank  1: 0.21
     rank  2: 0.31
     rank  3: 0.34
     rank  4: 0.05
     rank  5: 0.06
     rank  6: 0.05
     rank  7: 0.06
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.06
     rank 11: 0.04
     rank 12: 0.04
     rank 13: 0.07
     rank 14: 0.04
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 27.33
     rank  1: 27.37
     rank  2: 27.64
     rank  3: 27.58
     rank  4: 64.94
     rank  5: 65.04
     rank  6: 65.45
     rank  7: 65.17
     rank  8: 53.63
     rank  9: 53.57
     rank 10: 53.75
     rank 11: 53.62
     rank 12: 45.10
     rank 13: 45.22
     rank 14: 45.13
     rank 15: 45.08
  optimizer:
     rank  0: 28.21
     rank  1: 28.25
     rank  2: 28.53
     rank  3: 28.47
     rank  4: 65.82
     rank  5: 65.92
     rank  6: 66.33
     rank  7: 66.07
     rank  8: 54.51
     rank  9: 54.46
     rank 10: 54.64
     rank 11: 54.50
     rank 12: 45.98
     rank 13: 46.10
     rank 14: 46.01
     rank 15: 45.96
 [2024-12-30 23:09:15] iteration        4/      10 | consumed samples:          128 | elapsed time per iteration (ms): 4059.7 | learning rate: 3.000000E-06 | global batch size:    32 | lm loss: 3.881955E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 3956.26
     rank  1: 3956.43
     rank  2: 3956.32
     rank  3: 3956.37
     rank  4: 3959.78
     rank  5: 3960.11
     rank  6: 3959.84
     rank  7: 3960.22
     rank  8: 3958.80
     rank  9: 3959.02
     rank 10: 3958.84
     rank 11: 3959.04
     rank 12: 3957.94
     rank 13: 3958.10
     rank 14: 3957.93
     rank 15: 3958.03
  forward-compute:
     rank  0: 1462.97
     rank  1: 1466.24
     rank  2: 1534.51
     rank  3: 1537.82
     rank  4: 1181.45
     rank  5: 1188.28
     rank  6: 1265.36
     rank  7: 1263.10
     rank  8: 1018.71
     rank  9: 1022.83
     rank 10: 1038.10
     rank 11: 1041.20
     rank 12: 1257.47
     rank 13: 1253.10
     rank 14: 1061.59
     rank 15: 1067.00
  backward-compute:
     rank  0: 1267.85
     rank  1: 1267.57
     rank  2: 1274.17
     rank  3: 1266.49
     rank  4: 1591.15
     rank  5: 1594.77
     rank  6: 1602.40
     rank  7: 1606.43
     rank  8: 1482.07
     rank  9: 1478.62
     rank 10: 1468.35
     rank 11: 1474.54
     rank 12: 1592.29
     rank 13: 1593.16
     rank 14: 1645.51
     rank 15: 1646.17
  pure-backward-compute:
     rank  0: 1267.00
     rank  1: 1266.81
     rank  2: 1273.27
     rank  3: 1265.76
     rank  4: 1589.83
     rank  5: 1593.99
     rank  6: 1600.80
     rank  7: 1604.64
     rank  8: 1479.95
     rank  9: 1476.46
     rank 10: 1466.27
     rank 11: 1473.50
     rank 12: 1589.71
     rank 13: 1590.14
     rank 14: 1642.52
     rank 15: 1643.20
  batch-generator:
     rank  0: 74.85
     rank  1: 80.83
     rank  2: 80.40
     rank  3: 84.84
     rank  4: 58.47
     rank  5: 64.55
     rank  6: 78.08
     rank  7: 82.46
     rank  8: 65.31
     rank  9: 66.12
     rank 10: 85.57
     rank 11: 80.01
     rank 12: 60.51
     rank 13: 60.10
     rank 14: 60.86
     rank 15: 65.85
  forward-recv:
     rank  4: 121.33
     rank  5: 122.41
     rank  6: 127.73
     rank  7: 126.76
     rank  8: 181.22
     rank  9: 180.18
     rank 10: 199.50
     rank 11: 199.92
     rank 12: 231.23
     rank 13: 231.06
     rank 14: 234.87
     rank 15: 234.78
  forward-send:
     rank  0: 1.57
     rank  1: 1.36
     rank  2: 1.87
     rank  3: 1.52
     rank  4: 5.18
     rank  5: 3.92
     rank  6: 5.24
     rank  7: 5.44
     rank  8: 2.92
     rank  9: 2.75
     rank 10: 2.87
     rank 11: 2.68
  backward-recv:
     rank  0: 313.12
     rank  1: 314.00
     rank  2: 284.81
     rank  3: 285.95
     rank  4: 158.13
     rank  5: 159.60
     rank  6: 133.93
     rank  7: 134.01
     rank  8: 84.88
     rank  9: 85.25
     rank 10: 79.48
     rank 11: 79.40
  backward-send:
     rank  4: 1.36
     rank  5: 1.06
     rank  6: 1.32
     rank  7: 1.16
     rank  8: 6.06
     rank  9: 5.56
     rank 10: 5.29
     rank 11: 5.26
     rank 12: 2.85
     rank 13: 2.89
     rank 14: 2.72
     rank 15: 2.83
  forward-send-backward-recv:
     rank  0: 362.19
     rank  1: 363.50
     rank  2: 320.48
     rank  3: 324.00
     rank  4: 256.71
     rank  5: 258.35
     rank  6: 197.97
     rank  7: 195.70
     rank  8: 372.10
     rank  9: 377.60
     rank 10: 139.84
     rank 11: 136.03
  backward-send-forward-recv:
     rank  4: 21.03
     rank  5: 16.33
     rank  6: 11.07
     rank  7: 13.06
     rank  8: 94.58
     rank  9: 91.31
     rank 10: 311.50
     rank 11: 310.04
     rank 12: 66.35
     rank 13: 68.68
     rank 14: 209.21
     rank 15: 203.28
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.07
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.05
     rank 14: 0.02
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.07
     rank  7: 0.17
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.06
     rank 13: 0.09
     rank 14: 0.07
     rank 15: 0.06
  all-grads-sync:
     rank  0: 233.71
     rank  1: 223.80
     rank  2: 233.60
     rank  3: 223.77
     rank  4: 521.50
     rank  5: 520.91
     rank  6: 521.51
     rank  7: 520.82
     rank  8: 435.73
     rank  9: 435.76
     rank 10: 435.73
     rank 11: 435.77
     rank 12: 248.11
     rank 13: 241.30
     rank 14: 248.11
     rank 15: 241.33
  optimizer-copy-to-main-grad:
     rank  0: 0.23
     rank  1: 0.21
     rank  2: 0.23
     rank  3: 0.21
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.06
     rank  7: 0.12
     rank  8: 0.05
     rank  9: 0.05
     rank 10: 0.05
     rank 11: 0.04
     rank 12: 0.03
     rank 13: 0.08
     rank 14: 0.04
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 27.44
     rank  1: 27.62
     rank  2: 27.37
     rank  3: 27.70
     rank  4: 64.96
     rank  5: 64.99
     rank  6: 65.16
     rank  7: 65.48
     rank  8: 53.63
     rank  9: 53.66
     rank 10: 53.62
     rank 11: 53.60
     rank 12: 45.07
     rank 13: 45.29
     rank 14: 45.09
     rank 15: 45.05
  optimizer:
     rank  0: 28.28
     rank  1: 28.47
     rank  2: 28.23
     rank  3: 28.56
     rank  4: 65.80
     rank  5: 65.84
     rank  6: 66.01
     rank  7: 66.33
     rank  8: 54.48
     rank  9: 54.51
     rank 10: 54.47
     rank 11: 54.45
     rank 12: 45.92
     rank 13: 46.13
     rank 14: 45.93
     rank 15: 45.90
 [2024-12-30 23:09:19] iteration        5/      10 | consumed samples:          160 | elapsed time per iteration (ms): 4088.6 | learning rate: 3.750000E-06 | global batch size:    32 | lm loss: 1.950841E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 3986.88
     rank  1: 3987.09
     rank  2: 3986.94
     rank  3: 3987.03
     rank  4: 3990.55
     rank  5: 3990.59
     rank  6: 3990.51
     rank  7: 3990.55
     rank  8: 3989.53
     rank  9: 3989.56
     rank 10: 3989.54
     rank 11: 3989.52
     rank 12: 3988.53
     rank 13: 3988.82
     rank 14: 3988.55
     rank 15: 3988.74
  forward-compute:
     rank  0: 1465.95
     rank  1: 1471.23
     rank  2: 1526.76
     rank  3: 1528.72
     rank  4: 1150.93
     rank  5: 1157.36
     rank  6: 1233.05
     rank  7: 1236.31
     rank  8: 1012.28
     rank  9: 1014.58
     rank 10: 1025.65
     rank 11: 1026.53
     rank 12: 1263.05
     rank 13: 1257.15
     rank 14: 1072.70
     rank 15: 1075.07
  backward-compute:
     rank  0: 1388.99
     rank  1: 1383.53
     rank  2: 1387.28
     rank  3: 1384.89
     rank  4: 1594.07
     rank  5: 1596.86
     rank  6: 1602.48
     rank  7: 1604.04
     rank  8: 1486.32
     rank  9: 1481.32
     rank 10: 1467.76
     rank 11: 1471.61
     rank 12: 1594.79
     rank 13: 1598.62
     rank 14: 1651.84
     rank 15: 1652.49
  pure-backward-compute:
     rank  0: 1388.20
     rank  1: 1382.77
     rank  2: 1386.37
     rank  3: 1384.15
     rank  4: 1592.90
     rank  5: 1596.08
     rank  6: 1601.10
     rank  7: 1602.91
     rank  8: 1483.88
     rank  9: 1478.84
     rank 10: 1465.73
     rank 11: 1470.62
     rank 12: 1592.43
     rank 13: 1595.16
     rank 14: 1649.05
     rank 15: 1649.55
  batch-generator:
     rank  0: 72.12
     rank  1: 80.59
     rank  2: 80.82
     rank  3: 84.68
     rank  4: 53.45
     rank  5: 58.11
     rank  6: 74.25
     rank  7: 75.87
     rank  8: 62.43
     rank  9: 62.75
     rank 10: 76.93
     rank 11: 71.20
     rank 12: 59.42
     rank 13: 56.66
     rank 14: 68.36
     rank 15: 69.22
  forward-recv:
     rank  4: 121.93
     rank  5: 122.46
     rank  6: 123.78
     rank  7: 123.23
     rank  8: 187.96
     rank  9: 187.71
     rank 10: 200.55
     rank 11: 200.59
     rank 12: 226.33
     rank 13: 226.35
     rank 14: 233.52
     rank 15: 233.45
  forward-send:
     rank  0: 1.43
     rank  1: 1.21
     rank  2: 1.89
     rank  3: 1.45
     rank  4: 5.35
     rank  5: 4.75
     rank  6: 5.52
     rank  7: 5.19
     rank  8: 2.93
     rank  9: 2.76
     rank 10: 2.87
     rank 11: 2.70
  backward-recv:
     rank  0: 276.03
     rank  1: 278.41
     rank  2: 241.21
     rank  3: 242.36
     rank  4: 176.95
     rank  5: 178.82
     rank  6: 136.62
     rank  7: 136.95
     rank  8: 98.99
     rank  9: 99.15
     rank 10: 78.09
     rank 11: 78.80
  backward-send:
     rank  4: 1.81
     rank  5: 1.01
     rank  6: 1.34
     rank  7: 1.08
     rank  8: 5.35
     rank  9: 5.41
     rank 10: 5.30
     rank 11: 4.84
     rank 12: 2.53
     rank 13: 2.73
     rank 14: 2.78
     rank 15: 2.86
  forward-send-backward-recv:
     rank  0: 306.08
     rank  1: 310.32
     rank  2: 292.45
     rank  3: 292.67
     rank  4: 238.92
     rank  5: 238.73
     rank  6: 194.21
     rank  7: 192.00
     rank  8: 299.88
     rank  9: 308.85
     rank 10: 146.48
     rank 11: 144.02
  backward-send-forward-recv:
     rank  4: 55.41
     rank  5: 50.72
     rank  6: 56.36
     rank  7: 54.57
     rank  8: 152.39
     rank  9: 150.06
     rank 10: 327.43
     rank 11: 328.05
     rank 12: 70.20
     rank 13: 72.12
     rank 14: 201.55
     rank 15: 198.43
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.04
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.05
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.07
     rank  7: 0.06
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.06
     rank 13: 0.10
     rank 14: 0.09
     rank 15: 0.08
  all-grads-sync:
     rank  0: 241.77
     rank  1: 230.98
     rank  2: 241.70
     rank  3: 230.86
     rank  4: 516.90
     rank  5: 516.62
     rank  6: 516.89
     rank  7: 516.65
     rank  8: 434.88
     rank  9: 434.90
     rank 10: 434.95
     rank 11: 434.90
     rank 12: 246.58
     rank 13: 244.48
     rank 14: 246.60
     rank 15: 244.78
  optimizer-copy-to-main-grad:
     rank  0: 0.22
     rank  1: 0.21
     rank  2: 0.23
     rank  3: 0.21
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.06
     rank  7: 0.05
     rank  8: 0.05
     rank  9: 0.04
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.04
     rank 13: 0.09
     rank 14: 0.03
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 27.27
     rank  1: 27.91
     rank  2: 27.60
     rank  3: 27.45
     rank  4: 65.04
     rank  5: 64.98
     rank  6: 65.17
     rank  7: 65.09
     rank  8: 53.63
     rank  9: 53.63
     rank 10: 53.80
     rank 11: 53.55
     rank 12: 45.01
     rank 13: 45.28
     rank 14: 45.11
     rank 15: 45.03
  optimizer:
     rank  0: 28.05
     rank  1: 28.69
     rank  2: 28.46
     rank  3: 28.23
     rank  4: 65.82
     rank  5: 65.76
     rank  6: 65.96
     rank  7: 65.89
     rank  8: 54.42
     rank  9: 54.41
     rank 10: 54.59
     rank 11: 54.33
     rank 12: 45.80
     rank 13: 46.06
     rank 14: 45.90
     rank 15: 45.82
 [2024-12-30 23:09:23] iteration        6/      10 | consumed samples:          192 | elapsed time per iteration (ms): 4080.9 | learning rate: 4.500000E-06 | global batch size:    32 | lm loss: 2.984827E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 3979.55
     rank  1: 3979.56
     rank  2: 3979.61
     rank  3: 3979.52
     rank  4: 3983.14
     rank  5: 3983.11
     rank  6: 3983.09
     rank  7: 3983.10
     rank  8: 3982.10
     rank  9: 3982.08
     rank 10: 3982.10
     rank 11: 3982.04
     rank 12: 3981.20
     rank 13: 3981.23
     rank 14: 3981.23
     rank 15: 3981.20
  forward-compute:
     rank  0: 1490.39
     rank  1: 1490.27
     rank  2: 1522.92
     rank  3: 1530.48
     rank  4: 1185.39
     rank  5: 1191.33
     rank  6: 1236.58
     rank  7: 1242.97
     rank  8: 1009.11
     rank  9: 1010.29
     rank 10: 1014.79
     rank 11: 1019.67
     rank 12: 1273.05
     rank 13: 1270.89
     rank 14: 1070.29
     rank 15: 1075.71
  backward-compute:
     rank  0: 1270.55
     rank  1: 1269.08
     rank  2: 1412.20
     rank  3: 1405.17
     rank  4: 1593.41
     rank  5: 1596.91
     rank  6: 1609.20
     rank  7: 1613.21
     rank  8: 1483.05
     rank  9: 1481.43
     rank 10: 1462.31
     rank 11: 1468.35
     rank 12: 1600.83
     rank 13: 1602.92
     rank 14: 1655.07
     rank 15: 1655.60
  pure-backward-compute:
     rank  0: 1269.59
     rank  1: 1268.32
     rank  2: 1411.33
     rank  3: 1404.43
     rank  4: 1592.21
     rank  5: 1596.14
     rank  6: 1608.01
     rank  7: 1612.14
     rank  8: 1481.31
     rank  9: 1479.94
     rank 10: 1460.67
     rank 11: 1467.36
     rank 12: 1598.23
     rank 13: 1600.10
     rank 14: 1652.48
     rank 15: 1652.70
  batch-generator:
     rank  0: 81.99
     rank  1: 85.94
     rank  2: 67.25
     rank  3: 79.51
     rank  4: 56.15
     rank  5: 64.05
     rank  6: 72.02
     rank  7: 77.59
     rank  8: 62.99
     rank  9: 63.23
     rank 10: 69.33
     rank 11: 68.27
     rank 12: 60.98
     rank 13: 57.63
     rank 14: 60.12
     rank 15: 65.46
  forward-recv:
     rank  4: 119.81
     rank  5: 119.87
     rank  6: 123.44
     rank  7: 122.63
     rank  8: 186.77
     rank  9: 187.18
     rank 10: 197.69
     rank 11: 198.34
     rank 12: 226.17
     rank 13: 226.08
     rank 14: 233.91
     rank 15: 233.61
  forward-send:
     rank  0: 1.64
     rank  1: 1.46
     rank  2: 1.73
     rank  3: 1.45
     rank  4: 5.96
     rank  5: 5.68
     rank  6: 5.36
     rank  7: 5.50
     rank  8: 3.24
     rank  9: 2.97
     rank 10: 2.94
     rank 11: 2.66
  backward-recv:
     rank  0: 316.54
     rank  1: 317.55
     rank  2: 258.95
     rank  3: 261.03
     rank  4: 171.48
     rank  5: 172.71
     rank  6: 135.84
     rank  7: 135.59
     rank  8: 97.01
     rank  9: 97.77
     rank 10: 82.92
     rank 11: 83.31
  backward-send:
     rank  4: 1.46
     rank  5: 0.90
     rank  6: 1.07
     rank  7: 1.25
     rank  8: 5.48
     rank  9: 5.10
     rank 10: 5.50
     rank 11: 5.07
     rank 12: 2.29
     rank 13: 2.60
     rank 14: 2.69
     rank 15: 2.85
  forward-send-backward-recv:
     rank  0: 350.91
     rank  1: 357.26
     rank  2: 250.10
     rank  3: 247.69
     rank  4: 264.53
     rank  5: 265.52
     rank  6: 197.72
     rank  7: 193.38
     rank  8: 340.50
     rank  9: 345.24
     rank 10: 145.88
     rank 11: 141.84
  backward-send-forward-recv:
     rank  4: 16.64
     rank  5: 12.71
     rank  6: 56.93
     rank  7: 53.02
     rank  8: 136.63
     rank  9: 135.13
     rank 10: 354.33
     rank 11: 350.30
     rank 12: 68.43
     rank 13: 68.31
     rank 14: 212.89
     rank 15: 207.35
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.07
     rank  5: 0.05
     rank  6: 0.06
     rank  7: 0.05
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.07
     rank 13: 0.07
     rank 14: 0.07
     rank 15: 0.06
  all-grads-sync:
     rank  0: 235.77
     rank  1: 225.75
     rank  2: 235.67
     rank  3: 225.57
     rank  4: 514.37
     rank  5: 514.39
     rank  6: 514.37
     rank  7: 514.37
     rank  8: 432.66
     rank  9: 432.72
     rank 10: 432.65
     rank 11: 432.72
     rank 12: 244.93
     rank 13: 241.97
     rank 14: 244.91
     rank 15: 241.97
  optimizer-copy-to-main-grad:
     rank  0: 0.23
     rank  1: 0.21
     rank  2: 0.23
     rank  3: 0.21
     rank  4: 0.06
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.05
     rank  9: 0.04
     rank 10: 0.05
     rank 11: 0.04
     rank 12: 0.03
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 27.40
     rank  1: 27.42
     rank  2: 27.51
     rank  3: 27.38
     rank  4: 65.07
     rank  5: 65.02
     rank  6: 65.17
     rank  7: 65.04
     rank  8: 53.67
     rank  9: 53.67
     rank 10: 53.62
     rank 11: 53.54
     rank 12: 45.03
     rank 13: 45.33
     rank 14: 45.13
     rank 15: 45.03
  optimizer:
     rank  0: 28.19
     rank  1: 28.22
     rank  2: 28.38
     rank  3: 28.17
     rank  4: 65.86
     rank  5: 65.81
     rank  6: 65.96
     rank  7: 65.83
     rank  8: 54.46
     rank  9: 54.46
     rank 10: 54.42
     rank 11: 54.33
     rank 12: 45.83
     rank 13: 46.13
     rank 14: 45.92
     rank 15: 45.83
 [2024-12-30 23:09:27] iteration        7/      10 | consumed samples:          224 | elapsed time per iteration (ms): 4080.0 | learning rate: 5.250000E-06 | global batch size:    32 | lm loss: 2.375864E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 3978.23
     rank  1: 3978.26
     rank  2: 3978.30
     rank  3: 3978.31
     rank  4: 3981.88
     rank  5: 3981.84
     rank  6: 3981.82
     rank  7: 3981.86
     rank  8: 3980.82
     rank  9: 3980.78
     rank 10: 3980.76
     rank 11: 3980.82
     rank 12: 3979.87
     rank 13: 3979.99
     rank 14: 3979.89
     rank 15: 3980.08
  forward-compute:
     rank  0: 1466.66
     rank  1: 1467.94
     rank  2: 1558.88
     rank  3: 1566.22
     rank  4: 1205.06
     rank  5: 1214.55
     rank  6: 1184.20
     rank  7: 1188.20
     rank  8: 1021.32
     rank  9: 1026.46
     rank 10: 1010.93
     rank 11: 1013.53
     rank 12: 1222.86
     rank 13: 1221.55
     rank 14: 1083.39
     rank 15: 1087.07
  backward-compute:
     rank  0: 1291.35
     rank  1: 1296.25
     rank  2: 1410.83
     rank  3: 1404.63
     rank  4: 1604.07
     rank  5: 1605.57
     rank  6: 1606.56
     rank  7: 1606.79
     rank  8: 1485.39
     rank  9: 1484.42
     rank 10: 1464.64
     rank 11: 1468.24
     rank 12: 1604.03
     rank 13: 1607.06
     rank 14: 1670.60
     rank 15: 1672.07
  pure-backward-compute:
     rank  0: 1290.50
     rank  1: 1295.51
     rank  2: 1409.98
     rank  3: 1403.89
     rank  4: 1602.70
     rank  5: 1604.76
     rank  6: 1605.41
     rank  7: 1605.89
     rank  8: 1483.28
     rank  9: 1482.80
     rank 10: 1462.83
     rank 11: 1467.20
     rank 12: 1601.63
     rank 13: 1604.30
     rank 14: 1667.90
     rank 15: 1669.32
  batch-generator:
     rank  0: 75.39
     rank  1: 79.34
     rank  2: 67.88
     rank  3: 84.97
     rank  4: 67.65
     rank  5: 74.86
     rank  6: 53.40
     rank  7: 60.91
     rank  8: 67.60
     rank  9: 70.33
     rank 10: 67.50
     rank 11: 65.69
     rank 12: 64.75
     rank 13: 63.94
     rank 14: 66.64
     rank 15: 69.50
  forward-recv:
     rank  4: 113.25
     rank  5: 113.07
     rank  6: 126.57
     rank  7: 125.17
     rank  8: 188.20
     rank  9: 188.28
     rank 10: 196.10
     rank 11: 197.47
     rank 12: 233.97
     rank 13: 233.85
     rank 14: 233.57
     rank 15: 232.58
  forward-send:
     rank  0: 1.65
     rank  1: 1.38
     rank  2: 2.02
     rank  3: 1.51
     rank  4: 7.97
     rank  5: 7.73
     rank  6: 7.66
     rank  7: 8.02
     rank  8: 4.92
     rank  9: 4.86
     rank 10: 4.97
     rank 11: 3.95
  backward-recv:
     rank  0: 323.56
     rank  1: 323.39
     rank  2: 254.89
     rank  3: 256.64
     rank  4: 174.38
     rank  5: 175.27
     rank  6: 134.03
     rank  7: 134.94
     rank  8: 92.31
     rank  9: 92.27
     rank 10: 79.97
     rank 11: 80.36
  backward-send:
     rank  4: 1.44
     rank  5: 0.97
     rank  6: 1.38
     rank  7: 1.00
     rank  8: 5.41
     rank  9: 5.34
     rank 10: 5.43
     rank 11: 5.15
     rank 12: 2.68
     rank 13: 2.90
     rank 14: 2.67
     rank 15: 2.86
  forward-send-backward-recv:
     rank  0: 345.70
     rank  1: 343.24
     rank  2: 216.74
     rank  3: 215.80
     rank  4: 228.99
     rank  5: 226.21
     rank  6: 203.45
     rank  7: 201.56
     rank  8: 242.96
     rank  9: 247.23
     rank 10: 171.04
     rank 11: 168.72
  backward-send-forward-recv:
     rank  4: 18.99
     rank  5: 16.09
     rank  6: 100.53
     rank  7: 99.31
     rank  8: 215.55
     rank  9: 210.82
     rank 10: 330.71
     rank 11: 329.10
     rank 12: 102.61
     rank 13: 101.25
     rank 14: 181.35
     rank 15: 177.58
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.04
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.06
  embedding-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.08
     rank  5: 0.06
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.06
     rank 13: 0.07
     rank 14: 0.07
     rank 15: 0.13
  all-grads-sync:
     rank  0: 242.83
     rank  1: 232.15
     rank  2: 242.74
     rank  3: 232.04
     rank  4: 515.31
     rank  5: 515.25
     rank  6: 515.30
     rank  7: 515.37
     rank  8: 436.26
     rank  9: 436.32
     rank 10: 436.36
     rank 11: 436.39
     rank 12: 245.87
     rank 13: 244.03
     rank 14: 245.86
     rank 15: 244.09
  optimizer-copy-to-main-grad:
     rank  0: 0.23
     rank  1: 0.21
     rank  2: 0.29
     rank  3: 0.21
     rank  4: 0.07
     rank  5: 0.06
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.10
     rank  9: 0.04
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.04
     rank 13: 0.08
     rank 14: 0.03
     rank 15: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 27.68
     rank  1: 27.62
     rank  2: 27.80
     rank  3: 27.70
     rank  4: 65.19
     rank  5: 65.05
     rank  6: 65.09
     rank  7: 65.06
     rank  8: 53.74
     rank  9: 53.63
     rank 10: 53.63
     rank 11: 53.63
     rank 12: 45.00
     rank 13: 45.16
     rank 14: 45.08
     rank 15: 45.27
  optimizer:
     rank  0: 28.55
     rank  1: 28.49
     rank  2: 28.68
     rank  3: 28.57
     rank  4: 66.06
     rank  5: 65.91
     rank  6: 65.95
     rank  7: 65.93
     rank  8: 54.61
     rank  9: 54.50
     rank 10: 54.51
     rank 11: 54.50
     rank 12: 45.88
     rank 13: 46.03
     rank 14: 45.95
     rank 15: 46.14
 [2024-12-30 23:09:31] iteration        8/      10 | consumed samples:          256 | elapsed time per iteration (ms): 4081.2 | learning rate: 6.000000E-06 | global batch size:    32 | lm loss: 3.121576E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 3980.00
     rank  1: 3979.98
     rank  2: 3979.97
     rank  3: 3979.93
     rank  4: 3983.49
     rank  5: 3983.51
     rank  6: 3983.48
     rank  7: 3983.50
     rank  8: 3982.57
     rank  9: 3982.48
     rank 10: 3982.50
     rank 11: 3982.45
     rank 12: 3981.65
     rank 13: 3981.72
     rank 14: 3981.59
     rank 15: 3981.66
  forward-compute:
     rank  0: 1462.37
     rank  1: 1462.91
     rank  2: 1522.55
     rank  3: 1530.09
     rank  4: 1165.81
     rank  5: 1170.53
     rank  6: 1194.41
     rank  7: 1196.13
     rank  8: 1018.40
     rank  9: 1022.61
     rank 10: 1017.75
     rank 11: 1017.93
     rank 12: 1243.68
     rank 13: 1244.73
     rank 14: 1079.59
     rank 15: 1082.14
  backward-compute:
     rank  0: 1267.25
     rank  1: 1269.42
     rank  2: 1414.65
     rank  3: 1406.55
     rank  4: 1589.48
     rank  5: 1592.56
     rank  6: 1603.59
     rank  7: 1602.19
     rank  8: 1485.40
     rank  9: 1483.13
     rank 10: 1465.85
     rank 11: 1469.17
     rank 12: 1612.96
     rank 13: 1615.00
     rank 14: 1674.63
     rank 15: 1675.65
  pure-backward-compute:
     rank  0: 1266.45
     rank  1: 1268.68
     rank  2: 1413.78
     rank  3: 1405.74
     rank  4: 1588.26
     rank  5: 1591.79
     rank  6: 1602.46
     rank  7: 1601.40
     rank  8: 1483.32
     rank  9: 1481.57
     rank 10: 1464.10
     rank 11: 1468.19
     rank 12: 1610.06
     rank 13: 1612.39
     rank 14: 1671.95
     rank 15: 1672.82
  batch-generator:
     rank  0: 72.38
     rank  1: 75.01
     rank  2: 68.85
     rank  3: 82.63
     rank  4: 53.79
     rank  5: 55.25
     rank  6: 63.46
     rank  7: 65.62
     rank  8: 65.50
     rank  9: 67.14
     rank 10: 70.85
     rank 11: 65.75
     rank 12: 65.33
     rank 13: 65.27
     rank 14: 60.20
     rank 15: 63.05
  forward-recv:
     rank  4: 113.77
     rank  5: 116.27
     rank  6: 129.05
     rank  7: 128.14
     rank  8: 189.51
     rank  9: 187.58
     rank 10: 195.88
     rank 11: 196.89
     rank 12: 234.79
     rank 13: 234.36
     rank 14: 234.25
     rank 15: 233.74
  forward-send:
     rank  0: 1.56
     rank  1: 1.40
     rank  2: 1.90
     rank  3: 1.55
     rank  4: 7.33
     rank  5: 5.25
     rank  6: 6.89
     rank  7: 7.05
     rank  8: 5.27
     rank  9: 5.09
     rank 10: 5.17
     rank 11: 4.56
  backward-recv:
     rank  0: 322.29
     rank  1: 322.78
     rank  2: 254.60
     rank  3: 257.37
     rank  4: 166.95
     rank  5: 167.48
     rank  6: 136.98
     rank  7: 136.77
     rank  8: 91.27
     rank  9: 91.61
     rank 10: 81.25
     rank 11: 81.53
  backward-send:
     rank  4: 1.09
     rank  5: 0.96
     rank  6: 0.96
     rank  7: 1.04
     rank  8: 5.45
     rank  9: 5.33
     rank 10: 5.45
     rank 11: 4.93
     rank 12: 2.59
     rank 13: 2.74
     rank 14: 2.80
     rank 15: 2.86
  forward-send-backward-recv:
     rank  0: 367.94
     rank  1: 371.89
     rank  2: 247.54
     rank  3: 246.29
     rank  4: 292.57
     rank  5: 292.42
     rank  6: 199.78
     rank  7: 199.72
     rank  8: 374.11
     rank  9: 379.05
     rank 10: 164.86
     rank 11: 162.58
  backward-send-forward-recv:
     rank  4: 17.96
     rank  5: 14.68
     rank  6: 91.22
     rank  7: 90.29
     rank  8: 87.50
     rank  9: 85.77
     rank 10: 326.68
     rank 11: 327.44
     rank 12: 71.39
     rank 13: 68.90
     rank 14: 178.90
     rank 15: 176.03
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.05
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.06
     rank  8: 0.05
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.07
     rank 13: 0.08
     rank 14: 0.06
     rank 15: 0.06
  all-grads-sync:
     rank  0: 234.59
     rank  1: 224.94
     rank  2: 234.45
     rank  3: 224.74
     rank  4: 519.70
     rank  5: 519.59
     rank  6: 519.68
     rank  7: 519.47
     rank  8: 433.25
     rank  9: 433.27
     rank 10: 433.19
     rank 11: 433.26
     rank 12: 243.60
     rank 13: 240.61
     rank 14: 243.59
     rank 15: 240.90
  optimizer-copy-to-main-grad:
     rank  0: 0.24
     rank  1: 0.22
     rank  2: 0.24
     rank  3: 0.21
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.05
     rank  9: 0.05
     rank 10: 0.05
     rank 11: 0.04
     rank 12: 0.06
     rank 13: 0.05
     rank 14: 0.03
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 27.61
     rank  1: 27.63
     rank  2: 27.49
     rank  3: 27.51
     rank  4: 64.91
     rank  5: 64.93
     rank  6: 65.07
     rank  7: 65.12
     rank  8: 53.86
     rank  9: 53.71
     rank 10: 53.64
     rank 11: 53.52
     rank 12: 45.13
     rank 13: 45.27
     rank 14: 45.09
     rank 15: 45.10
  optimizer:
     rank  0: 28.44
     rank  1: 28.46
     rank  2: 28.33
     rank  3: 28.34
     rank  4: 65.74
     rank  5: 65.75
     rank  6: 65.91
     rank  7: 65.95
     rank  8: 54.70
     rank  9: 54.53
     rank 10: 54.47
     rank 11: 54.35
     rank 12: 45.96
     rank 13: 46.10
     rank 14: 45.93
     rank 15: 45.93
 [2024-12-30 23:09:35] iteration        9/      10 | consumed samples:          288 | elapsed time per iteration (ms): 4082.0 | learning rate: 6.750000E-06 | global batch size:    32 | lm loss: 2.639227E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 3980.52
     rank  1: 3980.50
     rank  2: 3980.60
     rank  3: 3980.51
     rank  4: 3984.07
     rank  5: 3984.05
     rank  6: 3984.15
     rank  7: 3984.05
     rank  8: 3983.03
     rank  9: 3983.00
     rank 10: 3983.08
     rank 11: 3983.01
     rank 12: 3982.19
     rank 13: 3982.17
     rank 14: 3982.19
     rank 15: 3982.18
  forward-compute:
     rank  0: 1467.93
     rank  1: 1468.47
     rank  2: 1524.24
     rank  3: 1531.49
     rank  4: 1150.90
     rank  5: 1156.69
     rank  6: 1212.69
     rank  7: 1215.29
     rank  8: 1015.97
     rank  9: 1019.06
     rank 10: 1015.47
     rank 11: 1017.39
     rank 12: 1253.31
     rank 13: 1249.67
     rank 14: 1101.59
     rank 15: 1103.63
  backward-compute:
     rank  0: 1272.43
     rank  1: 1274.08
     rank  2: 1407.98
     rank  3: 1401.01
     rank  4: 1590.27
     rank  5: 1592.39
     rank  6: 1604.06
     rank  7: 1603.36
     rank  8: 1484.85
     rank  9: 1480.40
     rank 10: 1465.87
     rank 11: 1468.89
     rank 12: 1610.97
     rank 13: 1614.53
     rank 14: 1679.66
     rank 15: 1681.21
  pure-backward-compute:
     rank  0: 1271.67
     rank  1: 1273.35
     rank  2: 1407.12
     rank  3: 1400.24
     rank  4: 1589.16
     rank  5: 1591.59
     rank  6: 1602.82
     rank  7: 1602.46
     rank  8: 1482.86
     rank  9: 1478.84
     rank 10: 1464.29
     rank 11: 1467.88
     rank 12: 1608.35
     rank 13: 1611.93
     rank 14: 1676.68
     rank 15: 1678.41
  batch-generator:
     rank  0: 74.44
     rank  1: 77.48
     rank  2: 67.26
     rank  3: 80.82
     rank  4: 55.63
     rank  5: 57.64
     rank  6: 72.37
     rank  7: 71.75
     rank  8: 64.28
     rank  9: 65.28
     rank 10: 66.59
     rank 11: 62.86
     rank 12: 59.12
     rank 13: 56.49
     rank 14: 69.78
     rank 15: 69.37
  forward-recv:
     rank  4: 123.98
     rank  5: 124.87
     rank  6: 129.15
     rank  7: 129.17
     rank  8: 187.17
     rank  9: 186.68
     rank 10: 197.10
     rank 11: 196.89
     rank 12: 227.56
     rank 13: 227.35
     rank 14: 231.37
     rank 15: 231.27
  forward-send:
     rank  0: 1.75
     rank  1: 1.50
     rank  2: 1.98
     rank  3: 1.55
     rank  4: 5.33
     rank  5: 4.34
     rank  6: 5.45
     rank  7: 4.94
     rank  8: 3.01
     rank  9: 2.82
     rank 10: 2.88
     rank 11: 2.69
  backward-recv:
     rank  0: 324.29
     rank  1: 325.12
     rank  2: 262.17
     rank  3: 263.13
     rank  4: 169.08
     rank  5: 169.64
     rank  6: 135.10
     rank  7: 136.77
     rank  8: 90.91
     rank  9: 91.26
     rank 10: 80.83
     rank 11: 80.92
  backward-send:
     rank  4: 1.33
     rank  5: 1.01
     rank  6: 1.56
     rank  7: 0.85
     rank  8: 5.45
     rank  9: 5.17
     rank 10: 5.44
     rank 11: 5.35
     rank 12: 2.70
     rank 13: 2.82
     rank 14: 2.65
     rank 15: 2.83
  forward-send-backward-recv:
     rank  0: 358.26
     rank  1: 359.43
     rank  2: 243.60
     rank  3: 241.77
     rank  4: 293.31
     rank  5: 294.27
     rank  6: 198.21
     rank  7: 197.23
     rank  8: 372.52
     rank  9: 379.56
     rank 10: 167.06
     rank 11: 165.15
  backward-send-forward-recv:
     rank  4: 17.15
     rank  5: 15.30
     rank  6: 75.04
     rank  7: 72.78
     rank  8: 95.23
     rank  9: 93.35
     rank 10: 327.27
     rank 11: 326.67
     rank 12: 69.09
     rank 13: 70.22
     rank 14: 152.94
     rank 15: 150.38
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.07
     rank  7: 0.05
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.06
     rank 13: 0.06
     rank 14: 0.07
     rank 15: 0.06
  all-grads-sync:
     rank  0: 244.22
     rank  1: 234.05
     rank  2: 244.14
     rank  3: 233.91
     rank  4: 521.59
     rank  5: 521.95
     rank  6: 521.56
     rank  7: 521.96
     rank  8: 429.37
     rank  9: 429.02
     rank 10: 429.38
     rank 11: 429.02
     rank 12: 245.20
     rank 13: 244.11
     rank 14: 245.18
     rank 15: 244.10
  optimizer-copy-to-main-grad:
     rank  0: 0.22
     rank  1: 0.21
     rank  2: 0.23
     rank  3: 0.20
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.13
     rank  7: 0.04
     rank  8: 0.05
     rank  9: 0.04
     rank 10: 0.05
     rank 11: 0.04
     rank 12: 0.04
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 27.30
     rank  1: 27.53
     rank  2: 27.46
     rank  3: 27.36
     rank  4: 64.92
     rank  5: 64.96
     rank  6: 65.19
     rank  7: 65.07
     rank  8: 53.70
     rank  9: 53.56
     rank 10: 53.63
     rank 11: 53.53
     rank 12: 44.92
     rank 13: 45.14
     rank 14: 45.08
     rank 15: 45.08
  optimizer:
     rank  0: 28.06
     rank  1: 28.29
     rank  2: 28.23
     rank  3: 28.12
     rank  4: 65.68
     rank  5: 65.73
     rank  6: 65.95
     rank  7: 65.83
     rank  8: 54.46
     rank  9: 54.32
     rank 10: 54.40
     rank 11: 54.28
     rank 12: 45.69
     rank 13: 45.91
     rank 14: 45.85
     rank 15: 45.84
 [2024-12-30 23:09:39] iteration       10/      10 | consumed samples:          320 | elapsed time per iteration (ms): 4089.0 | learning rate: 7.500000E-06 | global batch size:    32 | lm loss: 1.606772E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 3987.57
     rank  1: 3987.69
     rank  2: 3987.62
     rank  3: 3987.65
     rank  4: 3991.20
     rank  5: 3991.23
     rank  6: 3991.14
     rank  7: 3991.21
     rank  8: 3990.15
     rank  9: 3990.19
     rank 10: 3990.22
     rank 11: 3990.15
     rank 12: 3989.23
     rank 13: 3989.43
     rank 14: 3989.29
     rank 15: 3989.37
  forward-compute:
     rank  0: 1461.98
     rank  1: 1463.13
     rank  2: 1525.02
     rank  3: 1532.68
     rank  4: 1190.72
     rank  5: 1196.75
     rank  6: 1234.70
     rank  7: 1238.09
     rank  8: 1008.99
     rank  9: 1011.47
     rank 10: 1019.62
     rank 11: 1025.44
     rank 12: 1259.35
     rank 13: 1255.40
     rank 14: 1089.67
     rank 15: 1091.71
  backward-compute:
     rank  0: 1267.97
     rank  1: 1269.65
     rank  2: 1414.68
     rank  3: 1408.44
     rank  4: 1592.00
     rank  5: 1595.19
     rank  6: 1607.61
     rank  7: 1611.58
     rank  8: 1481.69
     rank  9: 1477.31
     rank 10: 1467.50
     rank 11: 1471.28
     rank 12: 1611.97
     rank 13: 1615.36
     rank 14: 1692.19
     rank 15: 1693.59
  pure-backward-compute:
     rank  0: 1267.13
     rank  1: 1268.91
     rank  2: 1413.82
     rank  3: 1407.68
     rank  4: 1590.19
     rank  5: 1594.29
     rank  6: 1606.30
     rank  7: 1610.63
     rank  8: 1479.85
     rank  9: 1475.84
     rank 10: 1466.04
     rank 11: 1470.25
     rank 12: 1609.40
     rank 13: 1612.74
     rank 14: 1689.62
     rank 15: 1690.83
  batch-generator:
     rank  0: 71.41
     rank  1: 74.78
     rank  2: 69.38
     rank  3: 80.76
     rank  4: 72.18
     rank  5: 75.50
     rank  6: 78.03
     rank  7: 77.10
     rank  8: 59.44
     rank  9: 61.14
     rank 10: 69.30
     rank 11: 68.37
     rank 12: 61.25
     rank 13: 57.73
     rank 14: 59.25
     rank 15: 60.29
  forward-recv:
     rank  4: 124.59
     rank  5: 125.03
     rank  6: 126.37
     rank  7: 126.46
     rank  8: 189.13
     rank  9: 189.05
     rank 10: 200.06
     rank 11: 199.56
     rank 12: 225.49
     rank 13: 225.29
     rank 14: 231.94
     rank 15: 231.86
  forward-send:
     rank  0: 1.38
     rank  1: 1.17
     rank  2: 1.75
     rank  3: 1.27
     rank  4: 5.50
     rank  5: 4.82
     rank  6: 5.33
     rank  7: 4.62
     rank  8: 2.97
     rank  9: 2.76
     rank 10: 2.87
     rank 11: 2.70
  backward-recv:
     rank  0: 319.26
     rank  1: 318.70
     rank  2: 260.17
     rank  3: 261.13
     rank  4: 167.38
     rank  5: 169.15
     rank  6: 137.05
     rank  7: 138.05
     rank  8: 87.69
     rank  9: 88.42
     rank 10: 81.70
     rank 11: 81.95
  backward-send:
     rank  4: 1.95
     rank  5: 0.97
     rank  6: 1.54
     rank  7: 0.79
     rank  8: 5.37
     rank  9: 5.08
     rank 10: 5.41
     rank 11: 5.13
     rank 12: 2.59
     rank 13: 2.78
     rank 14: 2.70
     rank 15: 2.82
  forward-send-backward-recv:
     rank  0: 374.37
     rank  1: 375.26
     rank  2: 243.96
     rank  3: 241.18
     rank  4: 254.93
     rank  5: 254.91
     rank  6: 193.87
     rank  7: 189.53
     rank  8: 389.89
     rank  9: 396.67
     rank 10: 161.31
     rank 11: 159.49
  backward-send-forward-recv:
     rank  4: 16.46
     rank  5: 12.86
     rank  6: 56.35
     rank  7: 55.51
     rank  8: 91.04
     rank  9: 88.67
     rank 10: 324.78
     rank 11: 320.47
     rank 12: 66.15
     rank 13: 67.31
     rank 14: 154.60
     rank 15: 151.47
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.04
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.07
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.07
     rank  5: 0.05
     rank  6: 0.07
     rank  7: 0.05
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.06
     rank 13: 0.15
     rank 14: 0.07
     rank 15: 0.07
  all-grads-sync:
     rank  0: 237.24
     rank  1: 227.32
     rank  2: 237.11
     rank  3: 227.14
     rank  4: 523.50
     rank  5: 523.49
     rank  6: 523.53
     rank  7: 523.47
     rank  8: 431.92
     rank  9: 432.29
     rank 10: 431.97
     rank 11: 432.30
     rank 12: 242.33
     rank 13: 240.17
     rank 14: 242.30
     rank 15: 240.10
  optimizer-copy-to-main-grad:
     rank  0: 0.23
     rank  1: 0.21
     rank  2: 0.29
     rank  3: 0.21
     rank  4: 0.06
     rank  5: 0.04
     rank  6: 0.06
     rank  7: 0.04
     rank  8: 0.05
     rank  9: 0.04
     rank 10: 0.05
     rank 11: 0.04
     rank 12: 0.03
     rank 13: 0.05
     rank 14: 0.03
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 27.51
     rank  1: 27.57
     rank  2: 27.60
     rank  3: 27.37
     rank  4: 65.02
     rank  5: 64.94
     rank  6: 65.19
     rank  7: 65.03
     rank  8: 53.68
     rank  9: 53.60
     rank 10: 53.72
     rank 11: 53.53
     rank 12: 44.94
     rank 13: 45.36
     rank 14: 45.07
     rank 15: 45.11
  optimizer:
     rank  0: 28.38
     rank  1: 28.44
     rank  2: 28.49
     rank  3: 28.25
     rank  4: 65.90
     rank  5: 65.80
     rank  6: 66.06
     rank  7: 65.91
     rank  8: 54.56
     rank  9: 54.47
     rank 10: 54.59
     rank 11: 54.40
     rank 12: 45.81
     rank 13: 46.23
     rank 14: 45.94
     rank 15: 45.98
