examples/multimodal/pretrain-freeze-llm-hete-2080first.sh: line 4: activate: No such file or directory
4
[2024-12-31 13:52:22,737] torch.distributed.run: [WARNING] 
[2024-12-31 13:52:22,737] torch.distributed.run: [WARNING] *****************************************
[2024-12-31 13:52:22,737] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-12-31 13:52:22,737] torch.distributed.run: [WARNING] *****************************************
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:20------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:20------
------num_pipeline_model_parallel_groups:4------
> setting tensorboard ...
WARNING: one_logger package is required to enable e2e metrics tracking. please go to https://confluence.nvidia.com/display/MLWFO/Package+Repositories for details to install it
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:20------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:20------
------num_pipeline_model_parallel_groups:4------
---Rank 19---Tensor Parallel Group GPUs: [3, 3, 3, 3]---Rank 17---Tensor Parallel Group GPUs: [1, 1, 1, 1]

---Rank 19---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]---Rank 18---Tensor Parallel Group GPUs: [2, 2, 2, 2]
---Rank 17---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]

---Rank 18---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]
[rank17]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank19]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank18]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
---Rank 16---Tensor Parallel Group GPUs: [0, 0, 0, 0]
---Rank 16---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]
[rank16]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
 > number of parameters on (tensor, pipeline) model parallel rank (3, 4): 306229248
 > number of parameters on (tensor, pipeline) model parallel rank (0, 4): 306229248
 > number of parameters on (tensor, pipeline) model parallel rank (1, 4): 306229248
INFO:megatron.core.distributed.param_and_grad_buffer:Number of buckets for gradient all-reduce / reduce-scatter: 1
Params for bucket 1 (306229248 elements):
	language_model.decoder.layers.4.mlp.linear_fc1.weight
	language_model.decoder.layers.4.mlp.linear_fc2.weight
	language_model.decoder.layers.4.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.2.mlp.linear_fc1.weight
	language_model.decoder.layers.1.mlp.linear_fc1.weight
	language_model.decoder.layers.1.self_attention.linear_proj.weight
	language_model.decoder.final_layernorm.weight
	language_model.decoder.layers.1.self_attention.linear_qkv.weight
	language_model.decoder.layers.3.mlp.linear_fc2.weight
	language_model.decoder.layers.2.self_attention.linear_proj.weight
	language_model.decoder.layers.0.mlp.linear_fc1.weight
	language_model.decoder.layers.0.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.4.self_attention.linear_qkv.weight
	language_model.decoder.layers.3.self_attention.linear_qkv.weight
	language_model.decoder.layers.0.mlp.linear_fc2.weight
	language_model.output_layer.weight
	language_model.decoder.layers.2.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.0.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.4.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.4.self_attention.linear_proj.weight
	language_model.decoder.layers.2.self_attention.linear_qkv.weight
	language_model.decoder.layers.1.mlp.linear_fc2.weight
	language_model.decoder.layers.0.self_attention.linear_proj.weight
	language_model.decoder.layers.3.mlp.linear_fc1.weight
	language_model.decoder.layers.3.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.3.self_attention.linear_proj.weight
	language_model.decoder.layers.2.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.0.self_attention.linear_qkv.weight
	language_model.decoder.layers.3.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.2.mlp.linear_fc2.weight
	language_model.decoder.layers.1.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.1.self_attention.linear_qkv.layer_norm_weight
 > number of parameters on (tensor, pipeline) model parallel rank (2, 4): 306229248
rank=0, worker=0: shard_range=[pretrain-0.tar[0, 100), pretrain-0.tar[100, 200), pretrain-0.tar[200, 300), ...<2494>, pretrain-30.tar[9700, 9800), pretrain-30.tar[9800, 9900), pretrain-30.tar[9900, 10000)] sum(count)=250000
rank=0, worker=1: shard_range=[pretrain-31.tar[0, 100), pretrain-31.tar[100, 200), pretrain-31.tar[200, 300), ...<2494>, pretrain-53.tar[9700, 9800), pretrain-53.tar[9800, 9900), pretrain-53.tar[9900, 10000)] sum(count)=250000
rank=0, worker=0: shard_range=[pretrain-54.tar[0, 10000), pretrain-55.tar[0, 8128), pretrain-6.tar[0, 10000), pretrain-7.tar[0, 936)] sum(count)=29064
rank=0, worker=1: shard_range=[pretrain-7.tar[936, 10000), pretrain-8.tar[0, 10000), pretrain-9.tar[0, 10000)] sum(count)=29064
times across ranks (ms):
  model-and-optimizer-setup:
     rank  0: 99.12
     rank  1: 98.95
     rank  2: 98.71
     rank  3: 98.64
     rank  4: 64.23
     rank  5: 41.22
     rank  6: 39.10
     rank  7: 63.85
     rank  8: 84.22
     rank  9: 80.19
     rank 10: 72.71
     rank 11: 72.82
     rank 12: 68.07
     rank 13: 67.62
     rank 14: 68.32
     rank 15: 69.80
     rank 16: 59.69
     rank 17: 60.16
     rank 18: 62.53
     rank 19: 59.35
  train/valid/test-data-iterators-setup:
     rank  0: 1042.44
     rank  1: 1042.63
     rank  2: 1248.67
     rank  3: 1042.44
     rank  4: 1042.40
     rank  5: 1042.40
     rank  6: 1042.40
     rank  7: 1042.46
     rank  8: 1042.49
     rank  9: 1043.12
     rank 10: 1042.53
     rank 11: 1042.49
     rank 12: 1248.45
     rank 13: 1248.79
     rank 14: 1042.16
     rank 15: 1249.22
     rank 16: 1248.48
     rank 17: 1248.74
     rank 18: 1248.85
     rank 19: 1249.01
 [2024-12-31 13:53:04] iteration        1/      10 | consumed samples:           32 | elapsed time per iteration (ms): 20214.9 | learning rate: 7.500000E-07 | global batch size:    32 | lm loss: 7.078586E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
[Rank 17] (after 1 iterations) memory (MB) | allocated: 4725.9404296875 | max allocated: 5893.611328125 | reserved: 6328.0 | max reserved: 6328.0
[Rank 18] (after 1 iterations) memory (MB) | allocated: 4725.9404296875 | max allocated: 5893.611328125 | reserved: 6326.0 | max reserved: 6326.0
[Rank 19] (after 1 iterations) memory (MB) | allocated: 4725.9404296875 | max allocated: 5893.611328125 | reserved: 6328.0 | max reserved: 6328.0
stage5 GPU utialization:71.94349765777588 %
[Rank 16] (after 1 iterations) memory (MB) | allocated: 4725.9404296875 | max allocated: 5893.611328125 | reserved: 6326.0 | max reserved: 6326.0
times across ranks (ms):
  forward-backward:
     rank  0: 20124.29
     rank  1: 20126.36
     rank  2: 20123.82
     rank  3: 20124.27
     rank  4: 20123.55
     rank  5: 20123.49
     rank  6: 20123.50
     rank  7: 20123.56
     rank  8: 20123.48
     rank  9: 20123.44
     rank 10: 20123.40
     rank 11: 20123.44
     rank 12: 20123.14
     rank 13: 20123.04
     rank 14: 20123.09
     rank 15: 20123.08
     rank 16: 20122.73
     rank 17: 20122.66
     rank 18: 20122.63
     rank 19: 20122.67
  forward-compute:
     rank  0: 5503.66
     rank  1: 5491.98
     rank  2: 5488.47
     rank  3: 5491.39
     rank  4: 6054.43
     rank  5: 6047.54
     rank  6: 6069.65
     rank  7: 6046.17
     rank  8: 6231.25
     rank  9: 6222.82
     rank 10: 6235.93
     rank 11: 6218.15
     rank 12: 5023.51
     rank 13: 5008.34
     rank 14: 5033.45
     rank 15: 5039.88
     rank 16: 4399.79
     rank 17: 4407.94
     rank 18: 4422.38
     rank 19: 4451.06
  backward-compute:
     rank  0: 4008.64
     rank  1: 4021.02
     rank  2: 4044.45
     rank  3: 4013.62
     rank  4: 4705.30
     rank  5: 4702.68
     rank  6: 4716.35
     rank  7: 4701.00
     rank  8: 4686.95
     rank  9: 4682.06
     rank 10: 4712.72
     rank 11: 4711.88
     rank 12: 4174.51
     rank 13: 4174.80
     rank 14: 4176.14
     rank 15: 4239.89
     rank 16: 3964.95
     rank 17: 3968.47
     rank 18: 3969.77
     rank 19: 3963.45
  pure-backward-compute:
     rank  0: 4006.97
     rank  1: 4019.47
     rank  2: 4042.94
     rank  3: 4012.00
     rank  4: 4702.33
     rank  5: 4700.71
     rank  6: 4714.84
     rank  7: 4698.90
     rank  8: 4684.01
     rank  9: 4678.98
     rank 10: 4710.84
     rank 11: 4710.25
     rank 12: 4171.16
     rank 13: 4171.83
     rank 14: 4170.87
     rank 15: 4237.03
     rank 16: 3959.32
     rank 17: 3964.15
     rank 18: 3965.60
     rank 19: 3957.37
  batch-generator:
     rank  0: 1094.37
     rank  1: 1098.26
     rank  2: 1102.47
     rank  3: 1109.84
     rank  4: 976.29
     rank  5: 980.71
     rank  6: 999.10
     rank  7: 991.73
     rank  8: 1036.84
     rank  9: 1036.55
     rank 10: 1049.45
     rank 11: 1035.72
     rank 12: 1349.23
     rank 13: 1336.94
     rank 14: 1380.69
     rank 15: 1368.55
     rank 16: 1274.62
     rank 17: 1287.31
     rank 18: 1305.99
     rank 19: 1334.81
  forward-recv:
     rank  4: 2274.05
     rank  5: 2267.76
     rank  6: 2263.27
     rank  7: 2271.86
     rank  8: 4361.08
     rank  9: 4367.34
     rank 10: 4364.95
     rank 11: 4362.13
     rank 12: 6751.12
     rank 13: 6757.68
     rank 14: 6755.48
     rank 15: 6756.13
     rank 16: 8199.19
     rank 17: 8200.02
     rank 18: 8197.53
     rank 19: 8202.46
  forward-send:
     rank  0: 5769.32
     rank  1: 5777.67
     rank  2: 5766.12
     rank  3: 5777.79
     rank  4: 3596.39
     rank  5: 3611.25
     rank  6: 3603.66
     rank  7: 3606.16
     rank  8: 1341.53
     rank  9: 1349.34
     rank 10: 1344.88
     rank 11: 1350.77
     rank 12: 22.52
     rank 13: 23.41
     rank 14: 21.32
     rank 15: 26.40
  backward-recv:
     rank  0: 646.49
     rank  1: 645.89
     rank  2: 644.44
     rank  3: 645.28
     rank  4: 319.83
     rank  5: 320.60
     rank  6: 321.35
     rank  7: 320.00
     rank  8: 181.30
     rank  9: 181.10
     rank 10: 180.77
     rank 11: 181.65
     rank 12: 89.65
     rank 13: 89.63
     rank 14: 89.99
     rank 15: 91.09
  backward-send:
     rank  4: 10.64
     rank  5: 10.19
     rank  6: 9.99
     rank  7: 9.91
     rank  8: 14.99
     rank  9: 14.97
     rank 10: 14.90
     rank 11: 13.69
     rank 12: 10.14
     rank 13: 10.08
     rank 14: 9.49
     rank 15: 9.21
     rank 16: 5.25
     rank 17: 4.72
     rank 18: 5.01
     rank 19: 5.22
  forward-send-backward-recv:
     rank  0: 4088.20
     rank  1: 4084.81
     rank  2: 4077.45
     rank  3: 4086.98
     rank  4: 1948.46
     rank  5: 1950.03
     rank  6: 1938.95
     rank  7: 1951.14
     rank  8: 1873.49
     rank  9: 1873.69
     rank 10: 1857.36
     rank 11: 1856.37
     rank 12: 1746.78
     rank 13: 1748.07
     rank 14: 1738.64
     rank 15: 1685.66
  backward-send-forward-recv:
     rank  4: 1018.75
     rank  5: 1023.82
     rank  6: 1013.46
     rank  7: 1021.42
     rank  8: 1088.75
     rank  9: 1084.55
     rank 10: 1076.31
     rank 11: 1091.77
     rank 12: 1816.24
     rank 13: 1824.04
     rank 14: 1798.27
     rank 15: 1790.21
     rank 16: 2930.48
     rank 17: 2921.75
     rank 18: 2908.76
     rank 19: 2877.26
  layernorm-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.05
     rank  2: 0.05
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.07
     rank 13: 0.06
     rank 14: 0.06
     rank 15: 0.06
     rank 16: 0.03
     rank 17: 0.03
     rank 18: 0.03
     rank 19: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.11
     rank  1: 0.11
     rank  2: 0.12
     rank  3: 0.10
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.06
     rank 13: 0.06
     rank 14: 0.06
     rank 15: 0.06
     rank 16: 0.10
     rank 17: 0.07
     rank 18: 0.07
     rank 19: 0.07
  all-grads-sync:
     rank  0: 57.99
     rank  1: 58.50
     rank  2: 58.60
     rank  3: 58.20
     rank  4: 39.80
     rank  5: 46.83
     rank  6: 43.61
     rank  7: 46.10
     rank  8: 44.80
     rank  9: 45.99
     rank 10: 46.53
     rank 11: 46.05
     rank 12: 58.97
     rank 13: 62.00
     rank 14: 61.78
     rank 15: 65.57
     rank 16: 24.84
     rank 17: 25.14
     rank 18: 25.15
     rank 19: 25.04
  optimizer-copy-to-main-grad:
     rank  0: 0.30
     rank  1: 0.40
     rank  2: 0.29
     rank  3: 0.29
     rank  4: 0.08
     rank  5: 0.07
     rank  6: 0.07
     rank  7: 0.07
     rank  8: 0.08
     rank  9: 0.07
     rank 10: 0.07
     rank 11: 0.07
     rank 12: 0.11
     rank 13: 0.09
     rank 14: 0.08
     rank 15: 0.09
     rank 16: 0.13
     rank 17: 0.06
     rank 18: 0.07
     rank 19: 0.07
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
     rank 16: 0.05
     rank 17: 0.02
     rank 18: 0.01
     rank 19: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 42.33
     rank  1: 42.18
     rank  2: 41.98
     rank  3: 42.35
     rank  4: 82.61
     rank  5: 82.52
     rank  6: 82.62
     rank  7: 82.62
     rank  8: 78.19
     rank  9: 77.58
     rank 10: 77.81
     rank 11: 78.35
     rank 12: 67.11
     rank 13: 67.00
     rank 14: 71.95
     rank 15: 66.44
     rank 16: 72.44
     rank 17: 73.15
     rank 18: 73.59
     rank 19: 72.44
  optimizer:
     rank  0: 43.66
     rank  1: 43.47
     rank  2: 43.29
     rank  3: 43.67
     rank  4: 83.92
     rank  5: 83.84
     rank  6: 83.94
     rank  7: 83.94
     rank  8: 79.51
     rank  9: 78.99
     rank 10: 79.12
     rank 11: 79.67
     rank 12: 68.43
     rank 13: 68.32
     rank 14: 73.27
     rank 15: 67.75
     rank 16: 73.76
     rank 17: 74.47
     rank 18: 74.91
     rank 19: 73.76
 [2024-12-31 13:53:14] iteration        2/      10 | consumed samples:           64 | elapsed time per iteration (ms): 10168.2 | learning rate: 1.500000E-06 | global batch size:    32 | lm loss: 7.160784E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 10061.40
     rank  1: 10061.44
     rank  2: 10061.43
     rank  3: 10061.38
     rank  4: 10065.33
     rank  5: 10065.37
     rank  6: 10065.33
     rank  7: 10065.38
     rank  8: 10065.11
     rank  9: 10065.16
     rank 10: 10065.11
     rank 11: 10065.14
     rank 12: 10063.68
     rank 13: 10063.64
     rank 14: 10063.62
     rank 15: 10063.62
     rank 16: 10064.09
     rank 17: 10064.07
     rank 18: 10064.04
     rank 19: 10064.10
  forward-compute:
     rank  0: 3304.51
     rank  1: 3302.28
     rank  2: 3290.77
     rank  3: 3298.72
     rank  4: 4122.72
     rank  5: 4131.75
     rank  6: 4137.70
     rank  7: 4122.17
     rank  8: 3956.59
     rank  9: 3966.50
     rank 10: 3966.99
     rank 11: 3955.20
     rank 12: 3728.96
     rank 13: 3726.87
     rank 14: 3747.58
     rank 15: 3756.58
     rank 16: 3042.48
     rank 17: 3048.26
     rank 18: 3051.08
     rank 19: 3077.87
  backward-compute:
     rank  0: 3141.02
     rank  1: 3168.18
     rank  2: 3183.35
     rank  3: 3150.37
     rank  4: 4678.66
     rank  5: 4685.97
     rank  6: 4689.52
     rank  7: 4677.77
     rank  8: 4672.92
     rank  9: 4671.85
     rank 10: 4702.60
     rank 11: 4699.77
     rank 12: 4182.37
     rank 13: 4186.77
     rank 14: 4184.38
     rank 15: 4232.93
     rank 16: 3998.49
     rank 17: 4002.86
     rank 18: 4005.95
     rank 19: 4002.32
  pure-backward-compute:
     rank  0: 3139.58
     rank  1: 3166.70
     rank  2: 3181.94
     rank  3: 3148.86
     rank  4: 4675.43
     rank  5: 4684.48
     rank  6: 4688.04
     rank  7: 4675.92
     rank  8: 4669.93
     rank  9: 4668.97
     rank 10: 4701.05
     rank 11: 4698.17
     rank 12: 4179.28
     rank 13: 4184.19
     rank 14: 4178.74
     rank 15: 4230.66
     rank 16: 3992.97
     rank 17: 3998.65
     rank 18: 4002.10
     rank 19: 3997.01
  batch-generator:
     rank  0: 137.46
     rank  1: 144.71
     rank  2: 141.48
     rank  3: 151.33
     rank  4: 167.59
     rank  5: 169.28
     rank  6: 174.29
     rank  7: 165.05
     rank  8: 103.17
     rank  9: 118.86
     rank 10: 116.56
     rank 11: 107.96
     rank 12: 123.32
     rank 13: 126.64
     rank 14: 165.02
     rank 15: 170.36
     rank 16: 112.02
     rank 17: 119.71
     rank 18: 125.07
     rank 19: 157.83
  forward-recv:
     rank  4: 113.67
     rank  5: 113.53
     rank  6: 110.58
     rank  7: 113.88
     rank  8: 248.57
     rank  9: 248.03
     rank 10: 249.58
     rank 11: 249.37
     rank 12: 379.83
     rank 13: 380.14
     rank 14: 378.34
     rank 15: 379.74
     rank 16: 485.06
     rank 17: 484.75
     rank 18: 484.51
     rank 19: 484.26
  forward-send:
     rank  0: 91.72
     rank  1: 90.07
     rank  2: 86.82
     rank  3: 91.84
     rank  4: 15.58
     rank  5: 14.89
     rank  6: 14.05
     rank  7: 15.41
     rank  8: 10.40
     rank  9: 10.53
     rank 10: 8.68
     rank 11: 9.77
     rank 12: 5.17
     rank 13: 5.12
     rank 14: 4.97
     rank 15: 4.61
  backward-recv:
     rank  0: 661.93
     rank  1: 660.18
     rank  2: 659.92
     rank  3: 661.34
     rank  4: 319.43
     rank  5: 321.13
     rank  6: 320.60
     rank  7: 319.81
     rank  8: 184.03
     rank  9: 184.29
     rank 10: 183.58
     rank 11: 183.84
     rank 12: 90.50
     rank 13: 91.13
     rank 14: 91.44
     rank 15: 92.02
  backward-send:
     rank  4: 11.30
     rank  5: 9.41
     rank  6: 10.53
     rank  7: 10.70
     rank  8: 15.08
     rank  9: 14.54
     rank 10: 14.83
     rank 11: 14.54
     rank 12: 10.11
     rank 13: 10.14
     rank 14: 9.57
     rank 15: 9.10
     rank 16: 4.93
     rank 17: 5.22
     rank 18: 5.20
     rank 19: 5.31
  forward-send-backward-recv:
     rank  0: 2822.82
     rank  1: 2807.04
     rank  2: 2806.57
     rank  3: 2817.61
     rank  4: 520.98
     rank  5: 519.38
     rank  6: 516.14
     rank  7: 525.37
     rank  8: 462.64
     rank  9: 464.08
     rank 10: 444.45
     rank 11: 445.68
     rank 12: 347.15
     rank 13: 345.01
     rank 14: 344.11
     rank 15: 299.83
  backward-send-forward-recv:
     rank  4: 151.75
     rank  5: 146.91
     rank  6: 144.43
     rank  7: 152.01
     rank  8: 235.41
     rank  9: 225.70
     rank 10: 223.98
     rank 11: 236.00
     rank 12: 898.08
     rank 13: 900.38
     rank 14: 871.02
     rank 15: 871.20
     rank 16: 1977.47
     rank 17: 1972.49
     rank 18: 1966.01
     rank 19: 1938.49
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.04
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.08
     rank  1: 0.08
     rank  2: 0.08
     rank  3: 0.07
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.07
     rank 17: 0.06
     rank 18: 0.06
     rank 19: 0.07
  all-grads-sync:
     rank  0: 1.10
     rank  1: 1.17
     rank  2: 1.17
     rank  3: 1.10
     rank  4: 3.05
     rank  5: 3.08
     rank  6: 3.08
     rank  7: 3.05
     rank  8: 2.94
     rank  9: 2.95
     rank 10: 2.95
     rank 11: 2.90
     rank 12: 2.32
     rank 13: 2.18
     rank 14: 2.28
     rank 15: 2.26
     rank 16: 2.59
     rank 17: 2.37
     rank 18: 2.37
     rank 19: 2.61
  optimizer-copy-to-main-grad:
     rank  0: 0.27
     rank  1: 0.26
     rank  2: 0.25
     rank  3: 0.25
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.06
     rank  9: 0.06
     rank 10: 0.06
     rank 11: 0.05
     rank 12: 0.10
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.04
     rank 16: 0.09
     rank 17: 0.05
     rank 18: 0.05
     rank 19: 0.06
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.02
     rank 19: 0.02
  optimizer-count-zeros:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 19.52
     rank  1: 19.61
     rank  2: 19.65
     rank  3: 19.51
     rank  4: 62.32
     rank  5: 62.36
     rank  6: 62.47
     rank  7: 62.41
     rank  8: 59.08
     rank  9: 59.04
     rank 10: 59.12
     rank 11: 59.05
     rank 12: 42.88
     rank 13: 43.57
     rank 14: 43.39
     rank 15: 42.86
     rank 16: 48.80
     rank 17: 48.46
     rank 18: 48.54
     rank 19: 48.79
  optimizer:
     rank  0: 20.49
     rank  1: 20.58
     rank  2: 20.63
     rank  3: 20.46
     rank  4: 63.28
     rank  5: 63.32
     rank  6: 63.43
     rank  7: 63.36
     rank  8: 60.04
     rank  9: 60.00
     rank 10: 60.07
     rank 11: 60.01
     rank 12: 43.84
     rank 13: 44.53
     rank 14: 44.35
     rank 15: 43.82
     rank 16: 49.76
     rank 17: 49.42
     rank 18: 49.50
     rank 19: 49.75
 [2024-12-31 13:53:24] iteration        3/      10 | consumed samples:           96 | elapsed time per iteration (ms): 10153.8 | learning rate: 2.250000E-06 | global batch size:    32 | lm loss: 3.699111E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 10042.89
     rank  1: 10042.91
     rank  2: 10042.95
     rank  3: 10042.86
     rank  4: 10046.82
     rank  5: 10046.82
     rank  6: 10046.82
     rank  7: 10046.83
     rank  8: 10046.62
     rank  9: 10046.62
     rank 10: 10046.64
     rank 11: 10046.61
     rank 12: 10045.06
     rank 13: 10045.08
     rank 14: 10045.08
     rank 15: 10045.06
     rank 16: 10045.58
     rank 17: 10045.54
     rank 18: 10045.52
     rank 19: 10045.57
  forward-compute:
     rank  0: 3277.18
     rank  1: 3275.71
     rank  2: 3265.13
     rank  3: 3271.18
     rank  4: 4104.54
     rank  5: 4115.81
     rank  6: 4118.34
     rank  7: 4103.71
     rank  8: 3950.55
     rank  9: 3961.52
     rank 10: 3960.30
     rank 11: 3950.04
     rank 12: 3724.09
     rank 13: 3719.05
     rank 14: 3732.68
     rank 15: 3749.52
     rank 16: 3058.96
     rank 17: 3059.91
     rank 18: 3064.09
     rank 19: 3099.74
  backward-compute:
     rank  0: 3125.30
     rank  1: 3152.69
     rank  2: 3161.74
     rank  3: 3131.28
     rank  4: 4681.80
     rank  5: 4688.03
     rank  6: 4691.45
     rank  7: 4682.78
     rank  8: 4664.83
     rank  9: 4662.09
     rank 10: 4687.73
     rank 11: 4693.83
     rank 12: 4194.43
     rank 13: 4196.46
     rank 14: 4188.10
     rank 15: 4245.90
     rank 16: 4042.49
     rank 17: 4042.60
     rank 18: 4048.42
     rank 19: 4045.90
  pure-backward-compute:
     rank  0: 3123.82
     rank  1: 3151.25
     rank  2: 3160.30
     rank  3: 3129.82
     rank  4: 4678.89
     rank  5: 4686.66
     rank  6: 4690.09
     rank  7: 4680.95
     rank  8: 4661.63
     rank  9: 4659.54
     rank 10: 4686.06
     rank 11: 4692.28
     rank 12: 4191.61
     rank 13: 4193.83
     rank 14: 4182.91
     rank 15: 4243.68
     rank 16: 4036.90
     rank 17: 4038.67
     rank 18: 4044.88
     rank 19: 4040.51
  batch-generator:
     rank  0: 131.81
     rank  1: 138.08
     rank  2: 136.14
     rank  3: 143.09
     rank  4: 148.53
     rank  5: 154.47
     rank  6: 159.86
     rank  7: 150.26
     rank  8: 104.60
     rank  9: 116.41
     rank 10: 116.96
     rank 11: 107.38
     rank 12: 118.78
     rank 13: 119.14
     rank 14: 151.03
     rank 15: 164.40
     rank 16: 114.30
     rank 17: 116.84
     rank 18: 123.24
     rank 19: 165.57
  forward-recv:
     rank  4: 113.26
     rank  5: 112.59
     rank  6: 108.69
     rank  7: 113.14
     rank  8: 247.90
     rank  9: 247.40
     rank 10: 247.43
     rank 11: 249.63
     rank 12: 377.99
     rank 13: 378.87
     rank 14: 378.42
     rank 15: 378.70
     rank 16: 481.74
     rank 17: 481.66
     rank 18: 480.98
     rank 19: 480.40
  forward-send:
     rank  0: 102.18
     rank  1: 100.22
     rank  2: 95.39
     rank  3: 102.49
     rank  4: 15.14
     rank  5: 14.62
     rank  6: 13.22
     rank  7: 15.24
     rank  8: 10.90
     rank  9: 11.00
     rank 10: 9.96
     rank 11: 9.44
     rank 12: 5.66
     rank 13: 4.84
     rank 14: 4.64
     rank 15: 3.91
  backward-recv:
     rank  0: 660.95
     rank  1: 659.79
     rank  2: 658.16
     rank  3: 659.62
     rank  4: 319.09
     rank  5: 321.59
     rank  6: 321.27
     rank  7: 320.87
     rank  8: 186.39
     rank  9: 185.57
     rank 10: 185.99
     rank 11: 186.26
     rank 12: 92.35
     rank 13: 92.26
     rank 14: 93.02
     rank 15: 93.49
  backward-send:
     rank  4: 11.46
     rank  5: 9.91
     rank  6: 10.29
     rank  7: 10.07
     rank  8: 15.06
     rank  9: 15.14
     rank 10: 14.88
     rank 11: 14.49
     rank 12: 10.23
     rank 13: 10.35
     rank 14: 9.72
     rank 15: 9.39
     rank 16: 5.22
     rank 17: 4.85
     rank 18: 5.14
     rank 19: 5.30
  forward-send-backward-recv:
     rank  0: 2837.37
     rank  1: 2821.14
     rank  2: 2827.83
     rank  3: 2836.87
     rank  4: 521.57
     rank  5: 519.59
     rank  6: 518.07
     rank  7: 525.58
     rank  8: 454.21
     rank  9: 457.01
     rank 10: 443.50
     rank 11: 434.13
     rank 12: 340.56
     rank 13: 342.97
     rank 14: 339.66
     rank 15: 293.98
  backward-send-forward-recv:
     rank  4: 146.79
     rank  5: 142.81
     rank  6: 144.27
     rank  7: 147.17
     rank  8: 238.28
     rank  9: 229.13
     rank 10: 227.14
     rank 11: 238.95
     rank 12: 879.29
     rank 13: 883.75
     rank 14: 865.63
     rank 15: 854.72
     rank 16: 1901.95
     rank 17: 1905.79
     rank 18: 1897.29
     rank 19: 1858.80
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.04
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.09
     rank  1: 0.08
     rank  2: 0.08
     rank  3: 0.08
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.07
     rank 17: 0.06
     rank 18: 0.06
     rank 19: 0.07
  all-grads-sync:
     rank  0: 1.07
     rank  1: 1.07
     rank  2: 1.11
     rank  3: 1.11
     rank  4: 3.09
     rank  5: 3.04
     rank  6: 3.03
     rank  7: 3.05
     rank  8: 2.90
     rank  9: 2.91
     rank 10: 2.97
     rank 11: 2.89
     rank 12: 2.14
     rank 13: 2.21
     rank 14: 2.22
     rank 15: 2.14
     rank 16: 2.42
     rank 17: 2.41
     rank 18: 2.40
     rank 19: 2.45
  optimizer-copy-to-main-grad:
     rank  0: 0.28
     rank  1: 0.24
     rank  2: 0.26
     rank  3: 0.27
     rank  4: 0.06
     rank  5: 0.04
     rank  6: 0.05
     rank  7: 0.06
     rank  8: 0.06
     rank  9: 0.05
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.05
     rank 13: 0.05
     rank 14: 0.06
     rank 15: 0.05
     rank 16: 0.07
     rank 17: 0.06
     rank 18: 0.06
     rank 19: 0.06
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  optimizer-count-zeros:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.02
  optimizer-inner-step:
     rank  0: 19.58
     rank  1: 19.69
     rank  2: 19.63
     rank  3: 19.60
     rank  4: 62.37
     rank  5: 62.26
     rank  6: 62.37
     rank  7: 62.34
     rank  8: 59.03
     rank  9: 59.00
     rank 10: 59.10
     rank 11: 59.01
     rank 12: 42.68
     rank 13: 43.58
     rank 14: 43.27
     rank 15: 42.86
     rank 16: 48.53
     rank 17: 48.56
     rank 18: 48.46
     rank 19: 48.49
  optimizer:
     rank  0: 20.57
     rank  1: 20.69
     rank  2: 20.66
     rank  3: 20.60
     rank  4: 63.37
     rank  5: 63.26
     rank  6: 63.37
     rank  7: 63.34
     rank  8: 60.02
     rank  9: 59.99
     rank 10: 60.09
     rank 11: 60.01
     rank 12: 43.68
     rank 13: 44.58
     rank 14: 44.27
     rank 15: 43.86
     rank 16: 49.53
     rank 17: 49.56
     rank 18: 49.46
     rank 19: 49.49
 [2024-12-31 13:53:34] iteration        4/      10 | consumed samples:          128 | elapsed time per iteration (ms): 10273.0 | learning rate: 3.000000E-06 | global batch size:    32 | lm loss: 3.992173E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 10174.99
     rank  1: 10175.11
     rank  2: 10175.14
     rank  3: 10175.11
     rank  4: 10179.10
     rank  5: 10179.03
     rank  6: 10179.03
     rank  7: 10179.04
     rank  8: 10178.84
     rank  9: 10178.82
     rank 10: 10178.82
     rank 11: 10178.82
     rank 12: 10177.35
     rank 13: 10177.27
     rank 14: 10177.31
     rank 15: 10177.27
     rank 16: 10177.86
     rank 17: 10177.78
     rank 18: 10177.75
     rank 19: 10177.79
  forward-compute:
     rank  0: 3462.53
     rank  1: 3460.97
     rank  2: 3448.73
     rank  3: 3457.44
     rank  4: 4113.46
     rank  5: 4124.76
     rank  6: 4121.87
     rank  7: 4110.92
     rank  8: 3952.40
     rank  9: 3964.34
     rank 10: 3964.88
     rank 11: 3948.84
     rank 12: 3724.21
     rank 13: 3724.77
     rank 14: 3737.13
     rank 15: 3752.66
     rank 16: 3072.28
     rank 17: 3074.32
     rank 18: 3077.48
     rank 19: 3111.27
  backward-compute:
     rank  0: 3125.19
     rank  1: 3147.99
     rank  2: 3156.54
     rank  3: 3126.93
     rank  4: 4687.25
     rank  5: 4695.48
     rank  6: 4700.84
     rank  7: 4686.04
     rank  8: 4669.99
     rank  9: 4671.81
     rank 10: 4692.79
     rank 11: 4701.12
     rank 12: 4214.06
     rank 13: 4216.20
     rank 14: 4204.40
     rank 15: 4268.44
     rank 16: 4136.12
     rank 17: 4138.33
     rank 18: 4144.06
     rank 19: 4141.41
  pure-backward-compute:
     rank  0: 3123.69
     rank  1: 3146.32
     rank  2: 3155.12
     rank  3: 3125.39
     rank  4: 4684.88
     rank  5: 4694.12
     rank  6: 4699.44
     rank  7: 4683.64
     rank  8: 4667.32
     rank  9: 4669.44
     rank 10: 4691.36
     rank 11: 4699.33
     rank 12: 4211.08
     rank 13: 4213.79
     rank 14: 4199.46
     rank 15: 4266.00
     rank 16: 4130.60
     rank 17: 4134.46
     rank 18: 4140.57
     rank 19: 4135.94
  batch-generator:
     rank  0: 118.52
     rank  1: 131.01
     rank  2: 126.29
     rank  3: 137.28
     rank  4: 138.98
     rank  5: 145.98
     rank  6: 153.10
     rank  7: 151.97
     rank  8: 99.79
     rank  9: 113.04
     rank 10: 114.94
     rank 11: 101.57
     rank 12: 117.68
     rank 13: 124.14
     rank 14: 154.50
     rank 15: 166.02
     rank 16: 107.89
     rank 17: 112.43
     rank 18: 117.98
     rank 19: 157.76
  forward-recv:
     rank  4: 109.41
     rank  5: 109.04
     rank  6: 106.86
     rank  7: 109.36
     rank  8: 244.90
     rank  9: 244.44
     rank 10: 244.62
     rank 11: 246.65
     rank 12: 378.41
     rank 13: 378.52
     rank 14: 377.56
     rank 15: 377.60
     rank 16: 480.61
     rank 17: 480.53
     rank 18: 480.27
     rank 19: 479.89
  forward-send:
     rank  0: 101.14
     rank  1: 98.97
     rank  2: 96.15
     rank  3: 100.78
     rank  4: 15.44
     rank  5: 14.51
     rank  6: 13.09
     rank  7: 15.03
     rank  8: 10.45
     rank  9: 10.54
     rank 10: 9.48
     rank 11: 9.04
     rank 12: 5.09
     rank 13: 5.08
     rank 14: 4.94
     rank 15: 4.45
  backward-recv:
     rank  0: 666.69
     rank  1: 666.33
     rank  2: 663.89
     rank  3: 665.37
     rank  4: 325.92
     rank  5: 326.83
     rank  6: 328.40
     rank  7: 326.81
     rank  8: 190.98
     rank  9: 191.05
     rank 10: 190.46
     rank 11: 190.91
     rank 12: 96.38
     rank 13: 96.36
     rank 14: 96.85
     rank 15: 97.58
  backward-send:
     rank  4: 11.04
     rank  5: 10.46
     rank  6: 9.59
     rank  7: 10.15
     rank  8: 15.12
     rank  9: 14.71
     rank 10: 14.90
     rank 11: 14.47
     rank 12: 10.15
     rank 13: 10.12
     rank 14: 9.47
     rank 15: 9.34
     rank 16: 5.22
     rank 17: 4.88
     rank 18: 5.12
     rank 19: 5.26
  forward-send-backward-recv:
     rank  0: 2780.13
     rank  1: 2766.51
     rank  2: 2775.51
     rank  3: 2783.07
     rank  4: 517.04
     rank  5: 514.01
     rank  6: 511.67
     rank  7: 520.28
     rank  8: 463.07
     rank  9: 462.19
     rank 10: 452.50
     rank 11: 443.39
     rank 12: 343.54
     rank 13: 344.51
     rank 14: 346.16
     rank 15: 293.30
  backward-send-forward-recv:
     rank  4: 266.76
     rank  5: 261.08
     rank  6: 263.83
     rank  7: 268.47
     rank  8: 351.20
     rank  9: 341.23
     rank 10: 338.74
     rank 11: 353.49
     rank 12: 982.65
     rank 13: 984.20
     rank 14: 967.23
     rank 15: 956.88
     rank 16: 1926.05
     rank 17: 1926.84
     rank 18: 1918.88
     rank 19: 1882.30
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.04
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.03
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.08
     rank  2: 0.08
     rank  3: 0.08
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.08
     rank 17: 0.06
     rank 18: 0.06
     rank 19: 0.06
  all-grads-sync:
     rank  0: 1.04
     rank  1: 1.08
     rank  2: 1.12
     rank  3: 1.10
     rank  4: 3.11
     rank  5: 3.05
     rank  6: 3.03
     rank  7: 3.07
     rank  8: 2.95
     rank  9: 2.94
     rank 10: 2.90
     rank 11: 2.91
     rank 12: 2.25
     rank 13: 2.16
     rank 14: 2.22
     rank 15: 2.15
     rank 16: 2.51
     rank 17: 2.38
     rank 18: 2.39
     rank 19: 2.38
  optimizer-copy-to-main-grad:
     rank  0: 0.21
     rank  1: 0.26
     rank  2: 0.26
     rank  3: 0.27
     rank  4: 0.06
     rank  5: 0.04
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.06
     rank  9: 0.06
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.06
     rank 13: 0.04
     rank 14: 0.05
     rank 15: 0.05
     rank 16: 0.11
     rank 17: 0.05
     rank 18: 0.05
     rank 19: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.01
     rank 17: 0.02
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 19.11
     rank  1: 19.41
     rank  2: 19.91
     rank  3: 19.28
     rank  4: 62.41
     rank  5: 62.28
     rank  6: 62.37
     rank  7: 62.35
     rank  8: 59.05
     rank  9: 59.09
     rank 10: 59.02
     rank 11: 59.07
     rank 12: 42.88
     rank 13: 43.47
     rank 14: 43.26
     rank 15: 42.92
     rank 16: 48.50
     rank 17: 48.61
     rank 18: 48.38
     rank 19: 48.54
  optimizer:
     rank  0: 20.09
     rank  1: 20.38
     rank  2: 20.89
     rank  3: 20.40
     rank  4: 63.39
     rank  5: 63.25
     rank  6: 63.34
     rank  7: 63.33
     rank  8: 60.02
     rank  9: 60.06
     rank 10: 59.99
     rank 11: 60.04
     rank 12: 43.85
     rank 13: 44.45
     rank 14: 44.22
     rank 15: 43.89
     rank 16: 49.47
     rank 17: 49.58
     rank 18: 49.35
     rank 19: 49.51
 [2024-12-31 13:53:45] iteration        5/      10 | consumed samples:          160 | elapsed time per iteration (ms): 10275.4 | learning rate: 3.750000E-06 | global batch size:    32 | lm loss: 3.182995E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 10176.20
     rank  1: 10176.37
     rank  2: 10176.39
     rank  3: 10176.35
     rank  4: 10180.20
     rank  5: 10180.31
     rank  6: 10180.38
     rank  7: 10180.31
     rank  8: 10180.01
     rank  9: 10180.10
     rank 10: 10180.20
     rank 11: 10180.11
     rank 12: 10178.49
     rank 13: 10178.59
     rank 14: 10178.63
     rank 15: 10178.54
     rank 16: 10179.03
     rank 17: 10179.01
     rank 18: 10179.05
     rank 19: 10179.06
  forward-compute:
     rank  0: 3470.35
     rank  1: 3468.77
     rank  2: 3459.30
     rank  3: 3465.10
     rank  4: 4099.64
     rank  5: 4108.20
     rank  6: 4118.51
     rank  7: 4099.50
     rank  8: 3945.67
     rank  9: 3955.02
     rank 10: 3956.29
     rank 11: 3943.53
     rank 12: 3730.14
     rank 13: 3724.75
     rank 14: 3736.59
     rank 15: 3752.53
     rank 16: 3079.06
     rank 17: 3083.91
     rank 18: 3083.95
     rank 19: 3116.29
  backward-compute:
     rank  0: 3157.49
     rank  1: 3175.30
     rank  2: 3195.87
     rank  3: 3162.80
     rank  4: 4685.53
     rank  5: 4693.67
     rank  6: 4695.48
     rank  7: 4685.78
     rank  8: 4673.48
     rank  9: 4670.66
     rank 10: 4696.20
     rank 11: 4707.36
     rank 12: 4223.99
     rank 13: 4231.59
     rank 14: 4218.47
     rank 15: 4279.87
     rank 16: 4113.53
     rank 17: 4116.50
     rank 18: 4122.57
     rank 19: 4119.47
  pure-backward-compute:
     rank  0: 3155.99
     rank  1: 3173.70
     rank  2: 3194.41
     rank  3: 3161.20
     rank  4: 4683.07
     rank  5: 4692.21
     rank  6: 4693.90
     rank  7: 4684.02
     rank  8: 4670.89
     rank  9: 4668.30
     rank 10: 4694.67
     rank 11: 4705.53
     rank 12: 4221.18
     rank 13: 4229.15
     rank 14: 4212.98
     rank 15: 4277.65
     rank 16: 4108.14
     rank 17: 4112.86
     rank 18: 4119.09
     rank 19: 4113.86
  batch-generator:
     rank  0: 111.74
     rank  1: 127.47
     rank  2: 125.70
     rank  3: 132.35
     rank  4: 139.90
     rank  5: 144.20
     rank  6: 156.01
     rank  7: 141.52
     rank  8: 93.00
     rank  9: 105.16
     rank 10: 107.32
     rank 11: 97.58
     rank 12: 115.48
     rank 13: 115.55
     rank 14: 145.60
     rank 15: 157.81
     rank 16: 108.50
     rank 17: 115.01
     rank 18: 118.00
     rank 19: 156.61
  forward-recv:
     rank  4: 112.73
     rank  5: 112.71
     rank  6: 108.91
     rank  7: 112.92
     rank  8: 252.89
     rank  9: 252.98
     rank 10: 252.64
     rank 11: 254.19
     rank 12: 381.78
     rank 13: 382.12
     rank 14: 381.53
     rank 15: 382.01
     rank 16: 485.37
     rank 17: 485.13
     rank 18: 484.91
     rank 19: 484.44
  forward-send:
     rank  0: 108.50
     rank  1: 106.88
     rank  2: 101.62
     rank  3: 108.11
     rank  4: 15.27
     rank  5: 14.79
     rank  6: 13.42
     rank  7: 15.42
     rank  8: 10.64
     rank  9: 10.59
     rank 10: 9.98
     rank 11: 9.79
     rank 12: 5.11
     rank 13: 5.05
     rank 14: 4.99
     rank 15: 4.36
  backward-recv:
     rank  0: 626.61
     rank  1: 626.57
     rank  2: 624.58
     rank  3: 626.63
     rank  4: 326.50
     rank  5: 327.07
     rank  6: 325.98
     rank  7: 326.26
     rank  8: 190.49
     rank  9: 190.18
     rank 10: 189.81
     rank 11: 189.80
     rank 12: 92.16
     rank 13: 92.08
     rank 14: 92.41
     rank 15: 93.56
  backward-send:
     rank  4: 10.73
     rank  5: 10.41
     rank  6: 10.62
     rank  7: 10.74
     rank  8: 14.99
     rank  9: 14.91
     rank 10: 14.79
     rank 11: 14.66
     rank 12: 10.12
     rank 13: 10.04
     rank 14: 9.41
     rank 15: 9.20
     rank 16: 5.19
     rank 17: 4.78
     rank 18: 5.11
     rank 19: 5.25
  forward-send-backward-recv:
     rank  0: 2773.41
     rank  1: 2764.72
     rank  2: 2760.54
     rank  3: 2771.56
     rank  4: 522.33
     rank  5: 520.44
     rank  6: 516.73
     rank  7: 524.71
     rank  8: 460.03
     rank  9: 461.07
     rank 10: 448.11
     rank 11: 435.91
     rank 12: 350.34
     rank 13: 348.41
     rank 14: 352.25
     rank 15: 300.57
  backward-send-forward-recv:
     rank  4: 273.60
     rank  5: 268.08
     rank  6: 265.33
     rank  7: 273.81
     rank  8: 350.69
     rank  9: 343.88
     rank 10: 339.22
     rank 11: 351.36
     rank 12: 959.33
     rank 13: 964.69
     rank 14: 947.48
     rank 15: 937.34
     rank 16: 1935.54
     rank 17: 1933.33
     rank 18: 1927.99
     rank 19: 1893.37
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.04
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.08
     rank  2: 0.08
     rank  3: 0.07
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.02
     rank 16: 0.06
     rank 17: 0.06
     rank 18: 0.07
     rank 19: 0.06
  all-grads-sync:
     rank  0: 1.05
     rank  1: 1.05
     rank  2: 1.07
     rank  3: 1.06
     rank  4: 3.05
     rank  5: 3.08
     rank  6: 3.09
     rank  7: 3.08
     rank  8: 2.90
     rank  9: 2.89
     rank 10: 2.95
     rank 11: 2.95
     rank 12: 2.16
     rank 13: 2.29
     rank 14: 2.15
     rank 15: 2.14
     rank 16: 2.40
     rank 17: 2.36
     rank 18: 2.45
     rank 19: 2.38
  optimizer-copy-to-main-grad:
     rank  0: 0.21
     rank  1: 0.25
     rank  2: 0.25
     rank  3: 0.25
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.06
     rank  7: 0.06
     rank  8: 0.06
     rank  9: 0.05
     rank 10: 0.06
     rank 11: 0.05
     rank 12: 0.05
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.04
     rank 16: 0.06
     rank 17: 0.05
     rank 18: 0.08
     rank 19: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 18.81
     rank  1: 19.37
     rank  2: 19.69
     rank  3: 19.37
     rank  4: 62.35
     rank  5: 62.40
     rank  6: 62.44
     rank  7: 62.41
     rank  8: 59.03
     rank  9: 59.07
     rank 10: 59.08
     rank 11: 59.09
     rank 12: 42.65
     rank 13: 43.63
     rank 14: 43.18
     rank 15: 42.76
     rank 16: 48.56
     rank 17: 48.49
     rank 18: 48.39
     rank 19: 48.36
  optimizer:
     rank  0: 19.72
     rank  1: 20.28
     rank  2: 20.61
     rank  3: 20.29
     rank  4: 63.26
     rank  5: 63.30
     rank  6: 63.35
     rank  7: 63.31
     rank  8: 59.94
     rank  9: 59.98
     rank 10: 59.98
     rank 11: 60.00
     rank 12: 43.56
     rank 13: 44.54
     rank 14: 44.09
     rank 15: 43.67
     rank 16: 49.48
     rank 17: 49.40
     rank 18: 49.29
     rank 19: 49.29
 [2024-12-31 13:53:55] iteration        6/      10 | consumed samples:          192 | elapsed time per iteration (ms): 10158.8 | learning rate: 4.500000E-06 | global batch size:    32 | lm loss: 1.699415E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 10056.43
     rank  1: 10056.57
     rank  2: 10056.62
     rank  3: 10056.60
     rank  4: 10060.52
     rank  5: 10060.52
     rank  6: 10060.52
     rank  7: 10060.52
     rank  8: 10060.31
     rank  9: 10060.32
     rank 10: 10060.33
     rank 11: 10060.31
     rank 12: 10058.81
     rank 13: 10058.74
     rank 14: 10058.78
     rank 15: 10058.73
     rank 16: 10059.23
     rank 17: 10059.24
     rank 18: 10059.21
     rank 19: 10059.24
  forward-compute:
     rank  0: 3268.94
     rank  1: 3267.42
     rank  2: 3256.22
     rank  3: 3262.19
     rank  4: 4101.97
     rank  5: 4108.63
     rank  6: 4116.55
     rank  7: 4097.37
     rank  8: 3944.78
     rank  9: 3955.86
     rank 10: 3958.32
     rank 11: 3943.25
     rank 12: 3734.81
     rank 13: 3730.82
     rank 14: 3742.63
     rank 15: 3762.12
     rank 16: 3090.18
     rank 17: 3094.95
     rank 18: 3092.70
     rank 19: 3125.87
  backward-compute:
     rank  0: 3099.47
     rank  1: 3115.51
     rank  2: 3137.50
     rank  3: 3098.94
     rank  4: 4686.70
     rank  5: 4694.64
     rank  6: 4697.77
     rank  7: 4687.79
     rank  8: 4673.76
     rank  9: 4673.37
     rank 10: 4693.63
     rank 11: 4705.31
     rank 12: 4234.95
     rank 13: 4241.95
     rank 14: 4226.12
     rank 15: 4290.43
     rank 16: 4112.52
     rank 17: 4118.22
     rank 18: 4123.16
     rank 19: 4116.90
  pure-backward-compute:
     rank  0: 3097.98
     rank  1: 3114.09
     rank  2: 3136.12
     rank  3: 3097.43
     rank  4: 4684.83
     rank  5: 4693.29
     rank  6: 4696.25
     rank  7: 4685.21
     rank  8: 4671.26
     rank  9: 4671.06
     rank 10: 4692.08
     rank 11: 4703.63
     rank 12: 4231.80
     rank 13: 4239.49
     rank 14: 4220.69
     rank 15: 4288.17
     rank 16: 4106.88
     rank 17: 4114.59
     rank 18: 4119.67
     rank 19: 4111.56
  batch-generator:
     rank  0: 113.64
     rank  1: 128.74
     rank  2: 122.63
     rank  3: 133.29
     rank  4: 103.98
     rank  5: 115.88
     rank  6: 134.10
     rank  7: 133.96
     rank  8: 92.35
     rank  9: 105.59
     rank 10: 108.96
     rank 11: 97.53
     rank 12: 115.58
     rank 13: 117.50
     rank 14: 147.16
     rank 15: 163.16
     rank 16: 107.21
     rank 17: 114.06
     rank 18: 115.14
     rank 19: 154.43
  forward-recv:
     rank  4: 109.25
     rank  5: 109.11
     rank  6: 105.52
     rank  7: 109.29
     rank  8: 244.46
     rank  9: 243.93
     rank 10: 243.91
     rank 11: 246.38
     rank 12: 376.14
     rank 13: 376.75
     rank 14: 376.10
     rank 15: 373.41
     rank 16: 480.91
     rank 17: 480.93
     rank 18: 480.45
     rank 19: 481.38
  forward-send:
     rank  0: 100.85
     rank  1: 98.79
     rank  2: 94.73
     rank  3: 101.25
     rank  4: 14.96
     rank  5: 14.46
     rank  6: 12.83
     rank  7: 15.12
     rank  8: 10.58
     rank  9: 10.67
     rank 10: 9.55
     rank 11: 9.00
     rank 12: 4.60
     rank 13: 4.22
     rank 14: 4.12
     rank 15: 5.92
  backward-recv:
     rank  0: 667.87
     rank  1: 667.87
     rank  2: 665.87
     rank  3: 668.59
     rank  4: 329.97
     rank  5: 330.73
     rank  6: 331.09
     rank  7: 328.78
     rank  8: 193.45
     rank  9: 192.07
     rank 10: 192.08
     rank 11: 192.24
     rank 12: 95.29
     rank 13: 95.83
     rank 14: 96.45
     rank 15: 96.72
  backward-send:
     rank  4: 10.36
     rank  5: 10.14
     rank  6: 9.68
     rank  7: 10.68
     rank  8: 15.09
     rank  9: 14.99
     rank 10: 14.65
     rank 11: 14.69
     rank 12: 11.62
     rank 13: 10.05
     rank 14: 9.34
     rank 15: 9.45
     rank 16: 5.00
     rank 17: 5.19
     rank 18: 5.27
     rank 19: 5.35
  forward-send-backward-recv:
     rank  0: 2879.33
     rank  1: 2873.04
     rank  2: 2868.29
     rank  3: 2883.66
     rank  4: 524.19
     rank  5: 522.06
     rank  6: 518.55
     rank  7: 527.40
     rank  8: 465.09
     rank  9: 465.45
     rank 10: 455.65
     rank 11: 443.89
     rank 12: 350.30
     rank 13: 347.03
     rank 14: 353.84
     rank 15: 299.02
  backward-send-forward-recv:
     rank  4: 150.19
     rank  5: 147.84
     rank  6: 145.46
     rank  7: 152.60
     rank  8: 234.16
     rank  9: 225.12
     rank 10: 221.12
     rank 11: 234.27
     rank 12: 828.99
     rank 13: 833.51
     rank 14: 816.57
     rank 15: 803.64
     rank 16: 1810.89
     rank 17: 1805.90
     rank 18: 1804.29
     rank 19: 1770.14
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.08
     rank  2: 0.08
     rank  3: 0.08
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.06
     rank 17: 0.06
     rank 18: 0.05
     rank 19: 0.06
  all-grads-sync:
     rank  0: 1.05
     rank  1: 1.08
     rank  2: 1.10
     rank  3: 1.08
     rank  4: 3.08
     rank  5: 3.04
     rank  6: 3.05
     rank  7: 3.07
     rank  8: 2.90
     rank  9: 3.02
     rank 10: 3.03
     rank 11: 2.91
     rank 12: 2.27
     rank 13: 2.09
     rank 14: 2.20
     rank 15: 2.13
     rank 16: 2.37
     rank 17: 2.37
     rank 18: 2.38
     rank 19: 2.35
  optimizer-copy-to-main-grad:
     rank  0: 0.21
     rank  1: 0.25
     rank  2: 0.26
     rank  3: 0.27
     rank  4: 0.06
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.06
     rank  9: 0.06
     rank 10: 0.06
     rank 11: 0.05
     rank 12: 0.27
     rank 13: 0.04
     rank 14: 0.05
     rank 15: 0.05
     rank 16: 0.06
     rank 17: 0.04
     rank 18: 0.05
     rank 19: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.06
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.02
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.03
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 19.12
     rank  1: 19.13
     rank  2: 19.17
     rank  3: 19.18
     rank  4: 62.33
     rank  5: 62.32
     rank  6: 62.38
     rank  7: 62.31
     rank  8: 59.03
     rank  9: 59.08
     rank 10: 59.11
     rank 11: 59.03
     rank 12: 43.33
     rank 13: 43.53
     rank 14: 43.29
     rank 15: 42.78
     rank 16: 48.39
     rank 17: 48.40
     rank 18: 48.42
     rank 19: 48.53
  optimizer:
     rank  0: 24.09
     rank  1: 24.08
     rank  2: 24.12
     rank  3: 24.13
     rank  4: 67.30
     rank  5: 67.29
     rank  6: 67.34
     rank  7: 67.28
     rank  8: 63.99
     rank  9: 64.04
     rank 10: 64.07
     rank 11: 63.99
     rank 12: 45.17
     rank 13: 48.50
     rank 14: 48.25
     rank 15: 47.74
     rank 16: 53.36
     rank 17: 53.36
     rank 18: 53.38
     rank 19: 53.49
 [2024-12-31 13:54:05] iteration        7/      10 | consumed samples:          224 | elapsed time per iteration (ms): 10182.4 | learning rate: 5.250000E-06 | global batch size:    32 | lm loss: 1.351438E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 10079.49
     rank  1: 10079.63
     rank  2: 10079.65
     rank  3: 10079.68
     rank  4: 10083.50
     rank  5: 10083.57
     rank  6: 10083.57
     rank  7: 10083.59
     rank  8: 10083.32
     rank  9: 10083.36
     rank 10: 10083.36
     rank 11: 10083.38
     rank 12: 10081.79
     rank 13: 10081.79
     rank 14: 10081.80
     rank 15: 10081.82
     rank 16: 10082.27
     rank 17: 10082.27
     rank 18: 10082.27
     rank 19: 10082.30
  forward-compute:
     rank  0: 3264.18
     rank  1: 3263.00
     rank  2: 3250.22
     rank  3: 3257.75
     rank  4: 4119.73
     rank  5: 4127.87
     rank  6: 4133.82
     rank  7: 4115.06
     rank  8: 3949.11
     rank  9: 3959.83
     rank 10: 3962.72
     rank 11: 3947.00
     rank 12: 3742.55
     rank 13: 3738.06
     rank 14: 3754.29
     rank 15: 3765.75
     rank 16: 3128.43
     rank 17: 3135.56
     rank 18: 3135.79
     rank 19: 3167.31
  backward-compute:
     rank  0: 3096.03
     rank  1: 3114.57
     rank  2: 3134.31
     rank  3: 3095.77
     rank  4: 4688.20
     rank  5: 4697.12
     rank  6: 4703.04
     rank  7: 4693.62
     rank  8: 4673.38
     rank  9: 4671.32
     rank 10: 4698.78
     rank 11: 4701.24
     rank 12: 4256.29
     rank 13: 4266.13
     rank 14: 4253.55
     rank 15: 4311.22
     rank 16: 4145.21
     rank 17: 4154.62
     rank 18: 4158.93
     rank 19: 4150.02
  pure-backward-compute:
     rank  0: 3094.52
     rank  1: 3113.17
     rank  2: 3132.93
     rank  3: 3094.22
     rank  4: 4685.92
     rank  5: 4695.80
     rank  6: 4701.57
     rank  7: 4691.41
     rank  8: 4671.02
     rank  9: 4669.17
     rank 10: 4697.38
     rank 11: 4699.58
     rank 12: 4253.21
     rank 13: 4263.71
     rank 14: 4247.83
     rank 15: 4308.97
     rank 16: 4139.83
     rank 17: 4150.98
     rank 18: 4155.44
     rank 19: 4144.79
  batch-generator:
     rank  0: 112.38
     rank  1: 127.82
     rank  2: 120.23
     rank  3: 130.80
     rank  4: 114.55
     rank  5: 117.61
     rank  6: 139.63
     rank  7: 142.21
     rank  8: 94.39
     rank  9: 107.48
     rank 10: 111.98
     rank 11: 99.04
     rank 12: 112.67
     rank 13: 114.17
     rank 14: 147.93
     rank 15: 156.82
     rank 16: 106.66
     rank 17: 115.26
     rank 18: 118.25
     rank 19: 156.18
  forward-recv:
     rank  4: 109.45
     rank  5: 109.45
     rank  6: 106.97
     rank  7: 109.54
     rank  8: 244.22
     rank  9: 244.03
     rank 10: 244.44
     rank 11: 245.98
     rank 12: 375.74
     rank 13: 376.03
     rank 14: 374.69
     rank 15: 375.30
     rank 16: 482.48
     rank 17: 482.36
     rank 18: 482.14
     rank 19: 481.53
  forward-send:
     rank  0: 102.45
     rank  1: 100.92
     rank  2: 97.42
     rank  3: 102.42
     rank  4: 15.16
     rank  5: 14.76
     rank  6: 13.37
     rank  7: 15.23
     rank  8: 10.49
     rank  9: 10.53
     rank 10: 9.31
     rank 11: 9.15
     rank 12: 5.06
     rank 13: 5.02
     rank 14: 4.96
     rank 15: 4.22
  backward-recv:
     rank  0: 673.09
     rank  1: 671.22
     rank  2: 669.76
     rank  3: 672.38
     rank  4: 328.20
     rank  5: 330.30
     rank  6: 330.06
     rank  7: 328.49
     rank  8: 192.70
     rank  9: 192.91
     rank 10: 192.31
     rank 11: 192.62
     rank 12: 95.23
     rank 13: 95.72
     rank 14: 95.64
     rank 15: 96.54
  backward-send:
     rank  4: 11.15
     rank  5: 9.83
     rank  6: 9.89
     rank  7: 10.54
     rank  8: 15.13
     rank  9: 14.77
     rank 10: 14.91
     rank 11: 14.46
     rank 12: 10.14
     rank 13: 10.14
     rank 14: 9.48
     rank 15: 9.23
     rank 16: 5.16
     rank 17: 5.20
     rank 18: 5.15
     rank 19: 5.20
  forward-send-backward-recv:
     rank  0: 2904.62
     rank  1: 2895.81
     rank  2: 2890.19
     rank  3: 2909.95
     rank  4: 524.13
     rank  5: 522.21
     rank  6: 517.35
     rank  7: 528.18
     rank  8: 466.46
     rank  9: 466.67
     rank 10: 451.80
     rank 11: 448.68
     rank 12: 352.60
     rank 13: 347.53
     rank 14: 350.63
     rank 15: 302.18
  backward-send-forward-recv:
     rank  4: 155.44
     rank  5: 150.56
     rank  6: 147.23
     rank  7: 153.55
     rank  8: 253.92
     rank  9: 245.42
     rank 10: 239.80
     rank 11: 254.17
     rank 12: 821.93
     rank 13: 826.78
     rank 14: 806.29
     rank 15: 800.92
     rank 16: 1763.76
     rank 17: 1753.08
     rank 18: 1749.07
     rank 19: 1720.45
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.08
     rank  2: 0.08
     rank  3: 0.09
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.03
     rank 16: 0.06
     rank 17: 0.06
     rank 18: 0.05
     rank 19: 0.06
  all-grads-sync:
     rank  0: 1.08
     rank  1: 1.15
     rank  2: 1.18
     rank  3: 1.14
     rank  4: 3.06
     rank  5: 3.04
     rank  6: 3.03
     rank  7: 3.05
     rank  8: 2.93
     rank  9: 2.91
     rank 10: 2.90
     rank 11: 2.89
     rank 12: 2.16
     rank 13: 2.11
     rank 14: 2.18
     rank 15: 2.19
     rank 16: 2.37
     rank 17: 2.35
     rank 18: 2.34
     rank 19: 2.41
  optimizer-copy-to-main-grad:
     rank  0: 0.22
     rank  1: 0.24
     rank  2: 0.25
     rank  3: 0.27
     rank  4: 0.05
     rank  5: 0.04
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.06
     rank  9: 0.05
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.06
     rank 13: 0.04
     rank 14: 0.05
     rank 15: 0.05
     rank 16: 0.05
     rank 17: 0.05
     rank 18: 0.05
     rank 19: 0.06
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.01
     rank 17: 0.02
     rank 18: 0.01
     rank 19: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 19.24
     rank  1: 19.24
     rank  2: 19.60
     rank  3: 19.59
     rank  4: 62.28
     rank  5: 62.31
     rank  6: 62.32
     rank  7: 62.34
     rank  8: 59.07
     rank  9: 59.01
     rank 10: 59.01
     rank 11: 59.02
     rank 12: 42.71
     rank 13: 43.46
     rank 14: 43.22
     rank 15: 42.87
     rank 16: 48.44
     rank 17: 48.50
     rank 18: 48.40
     rank 19: 48.50
  optimizer:
     rank  0: 20.30
     rank  1: 20.31
     rank  2: 20.66
     rank  3: 20.65
     rank  4: 63.33
     rank  5: 63.36
     rank  6: 63.37
     rank  7: 63.39
     rank  8: 60.12
     rank  9: 60.06
     rank 10: 60.06
     rank 11: 60.07
     rank 12: 43.76
     rank 13: 44.51
     rank 14: 44.28
     rank 15: 43.92
     rank 16: 49.49
     rank 17: 49.56
     rank 18: 49.45
     rank 19: 49.55
 [2024-12-31 13:54:15] iteration        8/      10 | consumed samples:          256 | elapsed time per iteration (ms): 10272.1 | learning rate: 6.000000E-06 | global batch size:    32 | lm loss: 3.005370E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 10170.23
     rank  1: 10170.24
     rank  2: 10170.28
     rank  3: 10170.25
     rank  4: 10174.29
     rank  5: 10174.17
     rank  6: 10174.22
     rank  7: 10174.20
     rank  8: 10174.08
     rank  9: 10173.96
     rank 10: 10174.03
     rank 11: 10173.98
     rank 12: 10172.60
     rank 13: 10172.41
     rank 14: 10172.49
     rank 15: 10172.41
     rank 16: 10173.03
     rank 17: 10172.92
     rank 18: 10172.89
     rank 19: 10172.95
  forward-compute:
     rank  0: 3410.48
     rank  1: 3409.07
     rank  2: 3398.32
     rank  3: 3404.22
     rank  4: 4128.19
     rank  5: 4141.12
     rank  6: 4139.02
     rank  7: 4126.49
     rank  8: 3953.51
     rank  9: 3965.57
     rank 10: 3965.78
     rank 11: 3952.58
     rank 12: 3745.17
     rank 13: 3741.69
     rank 14: 3755.63
     rank 15: 3770.34
     rank 16: 3152.47
     rank 17: 3157.72
     rank 18: 3159.31
     rank 19: 3194.69
  backward-compute:
     rank  0: 3110.38
     rank  1: 3131.85
     rank  2: 3139.78
     rank  3: 3114.15
     rank  4: 4686.26
     rank  5: 4694.04
     rank  6: 4698.88
     rank  7: 4690.51
     rank  8: 4673.51
     rank  9: 4672.27
     rank 10: 4698.89
     rank 11: 4704.88
     rank 12: 4279.65
     rank 13: 4288.36
     rank 14: 4275.88
     rank 15: 4337.12
     rank 16: 4208.77
     rank 17: 4219.64
     rank 18: 4223.46
     rank 19: 4214.41
  pure-backward-compute:
     rank  0: 3108.89
     rank  1: 3130.40
     rank  2: 3138.43
     rank  3: 3112.56
     rank  4: 4683.72
     rank  5: 4692.68
     rank  6: 4697.20
     rank  7: 4688.44
     rank  8: 4671.04
     rank  9: 4670.08
     rank 10: 4697.11
     rank 11: 4703.19
     rank 12: 4276.73
     rank 13: 4285.99
     rank 14: 4270.05
     rank 15: 4335.01
     rank 16: 4203.30
     rank 17: 4215.93
     rank 18: 4219.93
     rank 19: 4209.07
  batch-generator:
     rank  0: 112.91
     rank  1: 128.69
     rank  2: 125.86
     rank  3: 135.04
     rank  4: 148.34
     rank  5: 148.54
     rank  6: 151.94
     rank  7: 153.99
     rank  8: 99.27
     rank  9: 113.28
     rank 10: 113.88
     rank 11: 103.17
     rank 12: 114.12
     rank 13: 115.95
     rank 14: 147.24
     rank 15: 158.97
     rank 16: 108.47
     rank 17: 116.62
     rank 18: 120.50
     rank 19: 162.42
  forward-recv:
     rank  4: 109.92
     rank  5: 109.80
     rank  6: 107.33
     rank  7: 110.15
     rank  8: 246.33
     rank  9: 245.67
     rank 10: 246.05
     rank 11: 248.12
     rank 12: 376.27
     rank 13: 373.78
     rank 14: 375.28
     rank 15: 375.19
     rank 16: 481.63
     rank 17: 483.59
     rank 18: 481.39
     rank 19: 480.98
  forward-send:
     rank  0: 100.80
     rank  1: 98.77
     rank  2: 95.68
     rank  3: 100.92
     rank  4: 15.34
     rank  5: 14.36
     rank  6: 13.58
     rank  7: 15.47
     rank  8: 10.37
     rank  9: 10.58
     rank 10: 9.69
     rank 11: 8.95
     rank 12: 4.45
     rank 13: 6.72
     rank 14: 4.52
     rank 15: 3.99
  backward-recv:
     rank  0: 678.53
     rank  1: 677.34
     rank  2: 675.94
     rank  3: 677.85
     rank  4: 333.68
     rank  5: 335.54
     rank  6: 335.87
     rank  7: 333.44
     rank  8: 197.66
     rank  9: 197.48
     rank 10: 196.77
     rank 11: 197.44
     rank 12: 94.90
     rank 13: 95.64
     rank 14: 95.73
     rank 15: 96.93
  backward-send:
     rank  4: 11.16
     rank  5: 9.99
     rank  6: 9.81
     rank  7: 10.84
     rank  8: 15.04
     rank  9: 14.76
     rank 10: 14.99
     rank 11: 14.15
     rank 12: 10.00
     rank 13: 10.00
     rank 14: 9.42
     rank 15: 8.93
     rank 16: 4.89
     rank 17: 5.21
     rank 18: 5.18
     rank 19: 5.32
  forward-send-backward-recv:
     rank  0: 2830.55
     rank  1: 2819.25
     rank  2: 2825.93
     rank  3: 2831.51
     rank  4: 521.22
     rank  5: 520.62
     rank  6: 517.27
     rank  7: 527.31
     rank  8: 465.42
     rank  9: 466.74
     rank 10: 452.10
     rank 11: 445.39
     rank 12: 352.88
     rank 13: 348.48
     rank 14: 351.42
     rank 15: 298.94
  backward-send-forward-recv:
     rank  4: 232.13
     rank  5: 226.46
     rank  6: 228.46
     rank  7: 230.88
     rank  8: 332.71
     rank  9: 322.58
     rank 10: 319.52
     rank 11: 331.82
     rank 12: 887.40
     rank 13: 891.39
     rank 14: 872.42
     rank 15: 864.93
     rank 16: 1765.80
     rank 17: 1753.32
     rank 18: 1750.61
     rank 19: 1718.66
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.04
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.05
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.08
     rank  2: 0.08
     rank  3: 0.08
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
     rank 16: 0.13
     rank 17: 0.06
     rank 18: 0.06
     rank 19: 0.06
  all-grads-sync:
     rank  0: 1.08
     rank  1: 1.12
     rank  2: 1.16
     rank  3: 1.12
     rank  4: 3.12
     rank  5: 3.03
     rank  6: 3.03
     rank  7: 3.08
     rank  8: 2.89
     rank  9: 2.90
     rank 10: 2.94
     rank 11: 2.89
     rank 12: 3.01
     rank 13: 2.18
     rank 14: 2.23
     rank 15: 2.12
     rank 16: 2.71
     rank 17: 2.40
     rank 18: 2.37
     rank 19: 2.39
  optimizer-copy-to-main-grad:
     rank  0: 0.22
     rank  1: 0.25
     rank  2: 0.25
     rank  3: 0.27
     rank  4: 0.06
     rank  5: 0.04
     rank  6: 0.04
     rank  7: 0.11
     rank  8: 0.05
     rank  9: 0.05
     rank 10: 0.06
     rank 11: 0.05
     rank 12: 0.07
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.05
     rank 16: 0.07
     rank 17: 0.06
     rank 18: 0.05
     rank 19: 0.06
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 19.46
     rank  1: 19.43
     rank  2: 19.42
     rank  3: 19.51
     rank  4: 62.45
     rank  5: 62.30
     rank  6: 62.38
     rank  7: 62.38
     rank  8: 59.07
     rank  9: 59.03
     rank 10: 59.12
     rank 11: 59.06
     rank 12: 42.77
     rank 13: 43.54
     rank 14: 43.36
     rank 15: 42.76
     rank 16: 48.53
     rank 17: 48.54
     rank 18: 48.47
     rank 19: 48.52
  optimizer:
     rank  0: 20.42
     rank  1: 20.39
     rank  2: 20.40
     rank  3: 20.47
     rank  4: 63.41
     rank  5: 63.26
     rank  6: 63.33
     rank  7: 63.34
     rank  8: 60.03
     rank  9: 59.99
     rank 10: 60.09
     rank 11: 60.03
     rank 12: 43.73
     rank 13: 44.50
     rank 14: 44.33
     rank 15: 43.72
     rank 16: 49.49
     rank 17: 49.49
     rank 18: 49.43
     rank 19: 49.48
 [2024-12-31 13:54:26] iteration        9/      10 | consumed samples:          288 | elapsed time per iteration (ms): 10255.5 | learning rate: 6.750000E-06 | global batch size:    32 | lm loss: 2.822523E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 10152.47
     rank  1: 10152.61
     rank  2: 10152.66
     rank  3: 10152.67
     rank  4: 10156.56
     rank  5: 10156.53
     rank  6: 10156.54
     rank  7: 10156.55
     rank  8: 10156.34
     rank  9: 10156.33
     rank 10: 10156.35
     rank 11: 10156.34
     rank 12: 10154.78
     rank 13: 10154.78
     rank 14: 10154.81
     rank 15: 10154.78
     rank 16: 10155.25
     rank 17: 10155.25
     rank 18: 10155.23
     rank 19: 10155.29
  forward-compute:
     rank  0: 3452.86
     rank  1: 3452.12
     rank  2: 3441.15
     rank  3: 3448.07
     rank  4: 4088.31
     rank  5: 4097.59
     rank  6: 4096.58
     rank  7: 4083.99
     rank  8: 3947.40
     rank  9: 3957.61
     rank 10: 3961.08
     rank 11: 3944.75
     rank 12: 3752.75
     rank 13: 3747.28
     rank 14: 3763.10
     rank 15: 3772.59
     rank 16: 3154.81
     rank 17: 3161.11
     rank 18: 3158.56
     rank 19: 3195.97
  backward-compute:
     rank  0: 3113.60
     rank  1: 3132.01
     rank  2: 3139.35
     rank  3: 3110.93
     rank  4: 4686.73
     rank  5: 4691.40
     rank  6: 4703.88
     rank  7: 4687.53
     rank  8: 4671.63
     rank  9: 4669.34
     rank 10: 4692.91
     rank 11: 4698.81
     rank 12: 4297.93
     rank 13: 4306.76
     rank 14: 4291.32
     rank 15: 4353.65
     rank 16: 4250.87
     rank 17: 4261.68
     rank 18: 4265.52
     rank 19: 4256.55
  pure-backward-compute:
     rank  0: 3112.13
     rank  1: 3130.49
     rank  2: 3137.99
     rank  3: 3109.40
     rank  4: 4684.84
     rank  5: 4690.01
     rank  6: 4702.43
     rank  7: 4684.95
     rank  8: 4669.31
     rank  9: 4667.03
     rank 10: 4691.51
     rank 11: 4697.04
     rank 12: 4294.79
     rank 13: 4304.49
     rank 14: 4284.68
     rank 15: 4351.38
     rank 16: 4245.37
     rank 17: 4258.08
     rank 18: 4261.99
     rank 19: 4251.33
  batch-generator:
     rank  0: 115.18
     rank  1: 130.39
     rank  2: 125.94
     rank  3: 136.39
     rank  4: 99.90
     rank  5: 110.29
     rank  6: 120.41
     rank  7: 120.16
     rank  8: 92.42
     rank  9: 105.52
     rank 10: 110.11
     rank 11: 96.16
     rank 12: 110.60
     rank 13: 111.58
     rank 14: 141.21
     rank 15: 151.45
     rank 16: 108.45
     rank 17: 116.38
     rank 18: 116.26
     rank 19: 160.57
  forward-recv:
     rank  4: 108.46
     rank  5: 108.41
     rank  6: 105.99
     rank  7: 108.77
     rank  8: 245.35
     rank  9: 244.79
     rank 10: 244.78
     rank 11: 247.11
     rank 12: 375.23
     rank 13: 375.62
     rank 14: 374.97
     rank 15: 374.81
     rank 16: 481.07
     rank 17: 480.98
     rank 18: 480.75
     rank 19: 480.28
  forward-send:
     rank  0: 104.38
     rank  1: 102.39
     rank  2: 98.96
     rank  3: 104.17
     rank  4: 15.38
     rank  5: 14.56
     rank  6: 13.42
     rank  7: 15.30
     rank  8: 10.35
     rank  9: 10.48
     rank 10: 9.74
     rank 11: 8.95
     rank 12: 5.09
     rank 13: 5.03
     rank 14: 4.98
     rank 15: 4.36
  backward-recv:
     rank  0: 665.55
     rank  1: 665.61
     rank  2: 664.31
     rank  3: 666.65
     rank  4: 330.19
     rank  5: 330.69
     rank  6: 329.69
     rank  7: 328.88
     rank  8: 193.42
     rank  9: 193.21
     rank 10: 192.90
     rank 11: 192.40
     rank 12: 91.42
     rank 13: 91.49
     rank 14: 91.87
     rank 15: 93.09
  backward-send:
     rank  4: 10.91
     rank  5: 11.08
     rank  6: 10.87
     rank  7: 12.35
     rank  8: 14.74
     rank  9: 15.07
     rank 10: 14.58
     rank 11: 14.70
     rank 12: 10.08
     rank 13: 9.92
     rank 14: 9.42
     rank 15: 8.96
     rank 16: 5.26
     rank 17: 4.76
     rank 18: 5.13
     rank 19: 5.28
  forward-send-backward-recv:
     rank  0: 2776.59
     rank  1: 2766.16
     rank  2: 2774.31
     rank  3: 2782.25
     rank  4: 527.76
     rank  5: 525.28
     rank  6: 518.60
     rank  7: 530.55
     rank  8: 465.83
     rank  9: 467.57
     rank 10: 456.31
     rank 11: 448.34
     rank 12: 351.41
     rank 13: 347.25
     rank 14: 347.48
     rank 15: 299.28
  backward-send-forward-recv:
     rank  4: 257.52
     rank  5: 255.41
     rank  6: 255.48
     rank  7: 258.23
     rank  8: 328.53
     rank  9: 320.04
     rank 10: 313.95
     rank 11: 329.24
     rank 12: 848.27
     rank 13: 854.39
     rank 14: 836.17
     rank 15: 831.21
     rank 16: 1703.82
     rank 17: 1692.50
     rank 18: 1691.40
     rank 19: 1657.76
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.07
     rank  1: 0.07
     rank  2: 0.09
     rank  3: 0.08
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.06
     rank 17: 0.06
     rank 18: 0.06
     rank 19: 0.06
  all-grads-sync:
     rank  0: 1.09
     rank  1: 1.12
     rank  2: 1.14
     rank  3: 1.13
     rank  4: 3.13
     rank  5: 3.04
     rank  6: 3.04
     rank  7: 3.05
     rank  8: 2.89
     rank  9: 2.90
     rank 10: 2.91
     rank 11: 2.90
     rank 12: 2.15
     rank 13: 2.13
     rank 14: 2.23
     rank 15: 2.10
     rank 16: 2.37
     rank 17: 2.37
     rank 18: 2.36
     rank 19: 2.41
  optimizer-copy-to-main-grad:
     rank  0: 0.22
     rank  1: 0.24
     rank  2: 0.26
     rank  3: 0.27
     rank  4: 0.07
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.06
     rank  8: 0.05
     rank  9: 0.05
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.05
     rank 13: 0.04
     rank 14: 0.05
     rank 15: 0.04
     rank 16: 0.05
     rank 17: 0.06
     rank 18: 0.06
     rank 19: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 19.23
     rank  1: 19.53
     rank  2: 19.34
     rank  3: 19.15
     rank  4: 62.40
     rank  5: 62.34
     rank  6: 62.42
     rank  7: 62.39
     rank  8: 59.03
     rank  9: 58.99
     rank 10: 59.01
     rank 11: 59.01
     rank 12: 42.85
     rank 13: 43.49
     rank 14: 43.29
     rank 15: 42.72
     rank 16: 48.33
     rank 17: 48.42
     rank 18: 48.14
     rank 19: 48.51
  optimizer:
     rank  0: 20.20
     rank  1: 20.49
     rank  2: 20.32
     rank  3: 20.23
     rank  4: 63.38
     rank  5: 63.30
     rank  6: 63.39
     rank  7: 63.35
     rank  8: 60.00
     rank  9: 59.96
     rank 10: 59.97
     rank 11: 59.98
     rank 12: 43.81
     rank 13: 44.44
     rank 14: 44.25
     rank 15: 43.67
     rank 16: 49.30
     rank 17: 49.39
     rank 18: 49.11
     rank 19: 49.48
 [2024-12-31 13:54:36] iteration       10/      10 | consumed samples:          320 | elapsed time per iteration (ms): 10204.9 | learning rate: 7.500000E-06 | global batch size:    32 | lm loss: 2.533070E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 10105.93
     rank  1: 10106.09
     rank  2: 10106.25
     rank  3: 10106.08
     rank  4: 10110.02
     rank  5: 10110.07
     rank  6: 10110.08
     rank  7: 10110.14
     rank  8: 10109.85
     rank  9: 10109.87
     rank 10: 10109.88
     rank 11: 10109.82
     rank 12: 10108.25
     rank 13: 10108.29
     rank 14: 10108.32
     rank 15: 10108.30
     rank 16: 10108.85
     rank 17: 10108.73
     rank 18: 10108.77
     rank 19: 10108.76
  forward-compute:
     rank  0: 3254.87
     rank  1: 3253.84
     rank  2: 3244.16
     rank  3: 3249.49
     rank  4: 4144.04
     rank  5: 4159.11
     rank  6: 4162.34
     rank  7: 4141.54
     rank  8: 3943.20
     rank  9: 3954.28
     rank 10: 3961.61
     rank 11: 3938.86
     rank 12: 3743.76
     rank 13: 3738.88
     rank 14: 3747.46
     rank 15: 3765.37
     rank 16: 3177.06
     rank 17: 3183.35
     rank 18: 3181.48
     rank 19: 3219.26
  backward-compute:
     rank  0: 3098.83
     rank  1: 3127.18
     rank  2: 3136.31
     rank  3: 3098.94
     rank  4: 4692.87
     rank  5: 4696.66
     rank  6: 4710.84
     rank  7: 4689.08
     rank  8: 4674.95
     rank  9: 4672.67
     rank 10: 4689.77
     rank 11: 4701.79
     rank 12: 4311.45
     rank 13: 4321.04
     rank 14: 4306.59
     rank 15: 4370.51
     rank 16: 4266.98
     rank 17: 4278.02
     rank 18: 4282.40
     rank 19: 4272.97
  pure-backward-compute:
     rank  0: 3097.30
     rank  1: 3125.71
     rank  2: 3134.91
     rank  3: 3097.42
     rank  4: 4689.76
     rank  5: 4695.22
     rank  6: 4709.52
     rank  7: 4685.49
     rank  8: 4672.56
     rank  9: 4670.43
     rank 10: 4688.35
     rank 11: 4700.05
     rank 12: 4308.49
     rank 13: 4318.84
     rank 14: 4299.81
     rank 15: 4368.32
     rank 16: 4261.54
     rank 17: 4274.39
     rank 18: 4278.88
     rank 19: 4267.60
  batch-generator:
     rank  0: 112.24
     rank  1: 127.89
     rank  2: 124.17
     rank  3: 133.96
     rank  4: 133.32
     rank  5: 151.67
     rank  6: 153.52
     rank  7: 159.62
     rank  8: 89.05
     rank  9: 103.56
     rank 10: 111.81
     rank 11: 91.68
     rank 12: 110.65
     rank 13: 112.12
     rank 14: 139.27
     rank 15: 153.73
     rank 16: 107.51
     rank 17: 115.37
     rank 18: 116.13
     rank 19: 160.28
  forward-recv:
     rank  4: 111.86
     rank  5: 111.86
     rank  6: 108.57
     rank  7: 112.13
     rank  8: 246.84
     rank  9: 246.57
     rank 10: 247.12
     rank 11: 248.53
     rank 12: 378.44
     rank 13: 378.60
     rank 14: 377.48
     rank 15: 377.98
     rank 16: 482.62
     rank 17: 482.50
     rank 18: 482.29
     rank 19: 481.88
  forward-send:
     rank  0: 104.89
     rank  1: 102.78
     rank  2: 98.37
     rank  3: 104.33
     rank  4: 15.28
     rank  5: 14.56
     rank  6: 13.38
     rank  7: 15.27
     rank  8: 11.69
     rank  9: 11.67
     rank 10: 10.39
     rank 11: 10.32
     rank 12: 5.11
     rank 13: 5.04
     rank 14: 4.99
     rank 15: 4.45
  backward-recv:
     rank  0: 679.69
     rank  1: 677.53
     rank  2: 677.36
     rank  3: 678.60
     rank  4: 330.20
     rank  5: 333.64
     rank  6: 333.44
     rank  7: 331.56
     rank  8: 195.20
     rank  9: 195.71
     rank 10: 195.09
     rank 11: 195.10
     rank 12: 94.49
     rank 13: 94.47
     rank 14: 94.71
     rank 15: 96.12
  backward-send:
     rank  4: 11.32
     rank  5: 8.98
     rank  6: 9.94
     rank  7: 10.47
     rank  8: 15.22
     rank  9: 14.54
     rank 10: 14.94
     rank 11: 14.42
     rank 12: 10.12
     rank 13: 9.96
     rank 14: 9.52
     rank 15: 9.00
     rank 16: 5.27
     rank 17: 4.77
     rank 18: 5.14
     rank 19: 5.27
  forward-send-backward-recv:
     rank  0: 2927.74
     rank  1: 2911.09
     rank  2: 2916.02
     rank  3: 2932.56
     rank  4: 519.73
     rank  5: 515.97
     rank  6: 506.85
     rank  7: 523.10
     rank  8: 465.93
     rank  9: 466.98
     rank 10: 460.89
     rank 11: 449.38
     rank 12: 349.93
     rank 13: 345.82
     rank 14: 350.67
     rank 15: 295.48
  backward-send-forward-recv:
     rank  4: 148.78
     rank  5: 145.46
     rank  6: 142.66
     rank  7: 151.71
     rank  8: 277.14
     rank  9: 267.74
     rank 10: 257.79
     rank 11: 279.59
     rank 12: 790.93
     rank 13: 796.51
     rank 14: 781.88
     rank 15: 771.56
     rank 16: 1617.22
     rank 17: 1605.75
     rank 18: 1603.82
     rank 19: 1569.71
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.04
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.03
     rank 16: 0.03
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.07
     rank  2: 0.10
     rank  3: 0.07
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.08
     rank 17: 0.05
     rank 18: 0.07
     rank 19: 0.06
  all-grads-sync:
     rank  0: 1.06
     rank  1: 1.14
     rank  2: 1.23
     rank  3: 1.11
     rank  4: 3.05
     rank  5: 3.09
     rank  6: 3.05
     rank  7: 3.15
     rank  8: 2.95
     rank  9: 2.91
     rank 10: 3.05
     rank 11: 2.90
     rank 12: 2.14
     rank 13: 2.12
     rank 14: 2.15
     rank 15: 2.13
     rank 16: 2.53
     rank 17: 2.34
     rank 18: 2.50
     rank 19: 2.40
  optimizer-copy-to-main-grad:
     rank  0: 0.21
     rank  1: 0.25
     rank  2: 0.28
     rank  3: 0.25
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.07
     rank  8: 0.07
     rank  9: 0.06
     rank 10: 0.09
     rank 11: 0.05
     rank 12: 0.05
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.04
     rank 16: 0.08
     rank 17: 0.05
     rank 18: 0.05
     rank 19: 0.06
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.02
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 18.90
     rank  1: 19.23
     rank  2: 19.17
     rank  3: 19.41
     rank  4: 62.30
     rank  5: 62.36
     rank  6: 62.35
     rank  7: 62.53
     rank  8: 59.15
     rank  9: 59.07
     rank 10: 59.16
     rank 11: 59.04
     rank 12: 42.71
     rank 13: 43.24
     rank 14: 43.21
     rank 15: 42.79
     rank 16: 48.42
     rank 17: 48.38
     rank 18: 48.27
     rank 19: 48.53
  optimizer:
     rank  0: 20.00
     rank  1: 20.33
     rank  2: 20.29
     rank  3: 20.51
     rank  4: 63.40
     rank  5: 63.45
     rank  6: 63.45
     rank  7: 63.71
     rank  8: 60.26
     rank  9: 60.17
     rank 10: 60.26
     rank 11: 60.13
     rank 12: 43.81
     rank 13: 44.34
     rank 14: 44.31
     rank 15: 43.89
     rank 16: 49.52
     rank 17: 49.48
     rank 18: 49.37
     rank 19: 49.63
