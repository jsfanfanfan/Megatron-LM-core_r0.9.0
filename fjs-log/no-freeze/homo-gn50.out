examples/multimodal/pretrain-freeze-llm-homo.sh: line 4: activate: No such file or directory
[2024-12-24 23:05:58,141] torch.distributed.run: [WARNING] 
[2024-12-24 23:05:58,141] torch.distributed.run: [WARNING] *****************************************
[2024-12-24 23:05:58,141] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-12-24 23:05:58,141] torch.distributed.run: [WARNING] *****************************************
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:8------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:8------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:8------
------num_pipeline_model_parallel_groups:4------
> setting tensorboard ...
WARNING: one_logger package is required to enable e2e metrics tracking. please go to https://confluence.nvidia.com/display/MLWFO/Package+Repositories for details to install it
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:8------
------num_pipeline_model_parallel_groups:4------
---Rank 12---Tensor Parallel Group GPUs: [0, 0]---Rank 14---Tensor Parallel Group GPUs: [0, 0]

---Rank 12---Pipeline Parallel Group GPUs: [3, 3, 3, 3]---Rank 14---Pipeline Parallel Group GPUs: [3, 3, 3, 3]

---Rank 15---Tensor Parallel Group GPUs: [1, 1]
---Rank 15---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
[rank12]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
---Rank 13---Tensor Parallel Group GPUs: [1, 1]
[rank14]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
---Rank 13---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
[rank15]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank13]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
 > number of parameters on (tensor, pipeline) model parallel rank (1, 3): 503353344
 > number of parameters on (tensor, pipeline) model parallel rank (0, 3): 503353344
INFO:megatron.core.distributed.param_and_grad_buffer:Number of buckets for gradient all-reduce / reduce-scatter: 1
Params for bucket 1 (503353344 elements):
	language_model.decoder.layers.1.mlp.linear_fc1.weight
	language_model.decoder.layers.1.self_attention.linear_proj.weight
	language_model.decoder.layers.1.input_layernorm.weight
	language_model.decoder.layers.0.input_layernorm.weight
	language_model.decoder.layers.3.mlp.linear_fc2.weight
	language_model.decoder.layers.2.pre_mlp_layernorm.weight
	language_model.decoder.layers.1.mlp.linear_fc2.weight
	language_model.decoder.final_layernorm.weight
	language_model.decoder.layers.2.mlp.linear_fc2.weight
	language_model.decoder.layers.1.pre_mlp_layernorm.weight
	language_model.decoder.layers.1.self_attention.linear_qkv.weight
	language_model.decoder.layers.3.self_attention.linear_qkv.weight
	language_model.decoder.layers.3.self_attention.linear_proj.weight
	language_model.decoder.layers.3.input_layernorm.weight
	language_model.decoder.layers.2.mlp.linear_fc1.weight
	language_model.decoder.layers.2.self_attention.linear_proj.weight
	language_model.decoder.layers.0.mlp.linear_fc2.weight
	language_model.decoder.layers.0.mlp.linear_fc1.weight
	language_model.decoder.layers.0.pre_mlp_layernorm.weight
	language_model.decoder.layers.0.self_attention.linear_qkv.weight
	language_model.output_layer.weight
	language_model.decoder.layers.2.input_layernorm.weight
	language_model.decoder.layers.3.pre_mlp_layernorm.weight
	language_model.decoder.layers.3.mlp.linear_fc1.weight
	language_model.decoder.layers.0.self_attention.linear_proj.weight
	language_model.decoder.layers.2.self_attention.linear_qkv.weight
rank=0, worker=0: shard_range=[pretrain-0.tar[0, 100), pretrain-0.tar[100, 200), pretrain-0.tar[200, 300), ...<1244>, pretrain-2.tar[4700, 4800), pretrain-2.tar[4800, 4900), pretrain-2.tar[4900, 5000)] sum(count)=125000
rank=0, worker=1: shard_range=[pretrain-2.tar[5000, 5100), pretrain-2.tar[5100, 5200), pretrain-2.tar[5200, 5300), ...<1244>, pretrain-30.tar[9700, 9800), pretrain-30.tar[9800, 9900), pretrain-30.tar[9900, 10000)] sum(count)=125000
rank=1, worker=0: shard_range=[pretrain-31.tar[0, 100), pretrain-31.tar[100, 200), pretrain-31.tar[200, 300), ...<1244>, pretrain-42.tar[4700, 4800), pretrain-42.tar[4800, 4900), pretrain-42.tar[4900, 5000)] sum(count)=125000
rank=1, worker=1: shard_range=[pretrain-42.tar[5000, 5100), pretrain-42.tar[5100, 5200), pretrain-42.tar[5200, 5300), ...<1244>, pretrain-53.tar[9700, 9800), pretrain-53.tar[9800, 9900), pretrain-53.tar[9900, 10000)] sum(count)=125000
rank=0, worker=0: shard_range=[pretrain-54.tar[0, 10000), pretrain-55.tar[0, 4532)] sum(count)=14532
rank=0, worker=1: shard_range=[pretrain-55.tar[4532, 8128), pretrain-6.tar[0, 10000), pretrain-7.tar[0, 936)] sum(count)=14532
rank=1, worker=0: shard_range=[pretrain-7.tar[936, 10000), pretrain-8.tar[0, 5468)] sum(count)=14532
rank=1, worker=1: shard_range=[pretrain-8.tar[5468, 10000), pretrain-9.tar[0, 10000)] sum(count)=14532
times across ranks (ms):
  model-and-optimizer-setup:
     rank  0: 78.55
     rank  1: 81.02
     rank  2: 53.89
     rank  3: 76.08
     rank  4: 38.44
     rank  5: 27.43
     rank  6: 27.49
     rank  7: 19.98
     rank  8: 30.07
     rank  9: 42.27
     rank 10: 43.55
     rank 11: 40.95
     rank 12: 31.18
     rank 13: 31.18
     rank 14: 37.81
     rank 15: 37.82
  train/valid/test-data-iterators-setup:
     rank  0: 1146.96
     rank  1: 1146.56
     rank  2: 1146.36
     rank  3: 1146.35
     rank  4: 1146.30
     rank  5: 1146.35
     rank  6: 1146.36
     rank  7: 1146.41
     rank  8: 1146.43
     rank  9: 1147.22
     rank 10: 1146.64
     rank 11: 1146.67
     rank 12: 1146.47
     rank 13: 1146.58
     rank 14: 1146.48
     rank 15: 1146.40
 [2024-12-24 23:06:32] iteration        1/      10 | consumed samples:           16 | elapsed time per iteration (ms): 13160.5 | learning rate: 7.500000E-07 | global batch size:    16 | lm loss: 7.019982E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
[Rank 13] (after 1 iterations) memory (MB) | allocated: 7792.8154296875 | max allocated: 9712.818359375 | reserved: 10386.0 | max reserved: 10386.0
stage4 GPU utialization:86.22885617342862 %
[Rank 12] (after 1 iterations) memory (MB) | allocated: 7792.8154296875 | max allocated: 9712.818359375 | reserved: 10406.0 | max reserved: 10406.0
times across ranks (ms):
  forward-backward:
     rank  0: 13068.45
     rank  1: 13068.46
     rank  2: 13068.66
     rank  3: 13068.48
     rank  4: 13072.86
     rank  5: 13072.78
     rank  6: 13072.92
     rank  7: 13072.88
     rank  8: 13072.31
     rank  9: 13072.12
     rank 10: 13072.38
     rank 11: 13072.18
     rank 12: 13073.07
     rank 13: 13072.95
     rank 14: 13073.15
     rank 15: 13073.10
  forward-compute:
     rank  0: 4192.07
     rank  1: 4193.23
     rank  2: 3760.24
     rank  3: 3775.33
     rank  4: 2590.09
     rank  5: 2590.29
     rank  6: 2678.74
     rank  7: 2692.86
     rank  8: 2677.18
     rank  9: 2676.31
     rank 10: 2550.01
     rank 11: 2548.99
     rank 12: 2851.18
     rank 13: 2852.01
     rank 14: 3390.35
     rank 15: 3389.39
  backward-compute:
     rank  0: 36.21
     rank  1: 35.56
     rank  2: 36.02
     rank  3: 34.93
     rank  4: 761.95
     rank  5: 759.80
     rank  6: 779.74
     rank  7: 779.07
     rank  8: 707.37
     rank  9: 711.63
     rank 10: 729.75
     rank 11: 729.52
     rank 12: 803.94
     rank 13: 808.16
     rank 14: 813.20
     rank 15: 816.02
  pure-backward-compute:
     rank  0: 35.83
     rank  1: 35.04
     rank  2: 35.51
     rank  3: 34.41
     rank  4: 761.17
     rank  5: 758.92
     rank  6: 778.80
     rank  7: 778.18
     rank  8: 706.51
     rank  9: 710.95
     rank 10: 728.78
     rank 11: 728.80
     rank 12: 801.82
     rank 13: 805.63
     rank 14: 811.40
     rank 15: 814.31
  batch-generator:
     rank  0: 977.27
     rank  1: 979.03
     rank  2: 832.68
     rank  3: 847.05
     rank  4: 967.60
     rank  5: 970.96
     rank  6: 1025.86
     rank  7: 1043.35
     rank  8: 1077.88
     rank  9: 1076.41
     rank 10: 876.08
     rank 11: 875.01
     rank 12: 1000.78
     rank 13: 1003.88
     rank 14: 1074.11
     rank 15: 1074.65
  forward-recv:
     rank  4: 3956.65
     rank  5: 3954.34
     rank  6: 3485.24
     rank  7: 3471.21
     rank  8: 6061.61
     rank  9: 6063.27
     rank 10: 5658.67
     rank 11: 5659.61
     rank 12: 8303.68
     rank 13: 8302.97
     rank 14: 7752.42
     rank 15: 7751.61
  forward-send:
     rank  0: 4399.02
     rank  1: 4397.43
     rank  2: 4298.73
     rank  3: 4284.19
     rank  4: 2203.50
     rank  5: 2204.20
     rank  6: 2050.79
     rank  7: 2050.54
     rank  8: 31.49
     rank  9: 30.28
     rank 10: 28.57
     rank 11: 27.75
  backward-recv:
     rank  0: 534.20
     rank  1: 533.52
     rank  2: 516.83
     rank  3: 517.26
     rank  4: 175.21
     rank  5: 174.84
     rank  6: 157.21
     rank  7: 156.40
     rank  8: 92.58
     rank  9: 92.80
     rank 10: 89.21
     rank 11: 89.54
  backward-send:
     rank  4: 4.37
     rank  5: 4.35
     rank  6: 4.17
     rank  7: 4.50
     rank  8: 5.13
     rank  9: 5.62
     rank 10: 5.89
     rank 11: 5.65
     rank 12: 5.06
     rank 13: 5.14
     rank 14: 4.78
     rank 15: 4.81
  forward-send-backward-recv:
     rank  0: 3048.73
     rank  1: 3050.00
     rank  2: 3601.95
     rank  3: 3602.05
     rank  4: 2488.74
     rank  5: 2489.27
     rank  6: 3026.18
     rank  7: 3026.68
     rank  8: 2468.69
     rank  9: 2466.08
     rank 10: 2934.73
     rank 11: 2935.56
  backward-send-forward-recv:
     rank  4: 22.64
     rank  5: 25.17
     rank  6: 23.33
     rank  7: 24.19
     rank  8: 62.73
     rank  9: 62.67
     rank 10: 113.82
     rank 11: 115.03
     rank 12: 53.50
     rank 13: 49.10
     rank 14: 57.20
     rank 15: 56.40
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.03
     rank  5: 0.05
     rank  6: 0.12
     rank  7: 0.13
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.07
     rank 11: 0.04
     rank 12: 0.03
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.04
  embedding-grads-all-reduce:
     rank  0: 0.07
     rank  1: 0.09
     rank  2: 0.09
     rank  3: 0.08
     rank  4: 0.04
     rank  5: 0.03
     rank  6: 0.05
     rank  7: 0.06
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.04
     rank 11: 0.03
     rank 12: 0.10
     rank 13: 0.10
     rank 14: 0.13
     rank 15: 0.10
  all-grads-sync:
     rank  0: 89.18
     rank  1: 76.36
     rank  2: 89.16
     rank  3: 76.44
     rank  4: 475.36
     rank  5: 487.09
     rank  6: 475.36
     rank  7: 487.09
     rank  8: 433.88
     rank  9: 433.14
     rank 10: 433.86
     rank 11: 433.14
     rank 12: 849.38
     rank 13: 849.43
     rank 14: 849.42
     rank 15: 849.44
  optimizer-copy-to-main-grad:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.04
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.09
     rank  7: 0.06
     rank  8: 0.06
     rank  9: 0.04
     rank 10: 0.06
     rank 11: 0.05
     rank 12: 0.06
     rank 13: 0.06
     rank 14: 0.07
     rank 15: 0.13
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 5.16
     rank  1: 5.14
     rank  2: 5.13
     rank  3: 5.04
     rank  4: 64.00
     rank  5: 63.32
     rank  6: 63.34
     rank  7: 66.84
     rank  8: 58.02
     rank  9: 54.45
     rank 10: 57.23
     rank 11: 55.36
     rank 12: 68.09
     rank 13: 67.32
     rank 14: 68.05
     rank 15: 81.18
  optimizer:
     rank  0: 6.23
     rank  1: 6.22
     rank  2: 6.20
     rank  3: 6.11
     rank  4: 65.08
     rank  5: 64.40
     rank  6: 64.41
     rank  7: 67.92
     rank  8: 59.10
     rank  9: 55.52
     rank 10: 58.30
     rank 11: 56.44
     rank 12: 69.16
     rank 13: 68.39
     rank 14: 69.15
     rank 15: 82.25
 [2024-12-24 23:06:35] iteration        2/      10 | consumed samples:           32 | elapsed time per iteration (ms): 2843.8 | learning rate: 1.500000E-06 | global batch size:    16 | lm loss: 7.128254E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2753.91
     rank  1: 2753.96
     rank  2: 2753.93
     rank  3: 2753.99
     rank  4: 2758.18
     rank  5: 2758.30
     rank  6: 2758.24
     rank  7: 2758.41
     rank  8: 2757.63
     rank  9: 2757.73
     rank 10: 2757.67
     rank 11: 2757.72
     rank 12: 2758.29
     rank 13: 2758.51
     rank 14: 2758.43
     rank 15: 2758.68
  forward-compute:
     rank  0: 394.17
     rank  1: 394.97
     rank  2: 469.22
     rank  3: 469.11
     rank  4: 584.80
     rank  5: 586.34
     rank  6: 612.45
     rank  7: 614.47
     rank  8: 544.96
     rank  9: 548.65
     rank 10: 549.87
     rank 11: 549.74
     rank 12: 622.09
     rank 13: 622.68
     rank 14: 624.17
     rank 15: 625.29
  backward-compute:
     rank  0: 32.85
     rank  1: 32.92
     rank  2: 33.60
     rank  3: 34.46
     rank  4: 754.84
     rank  5: 755.80
     rank  6: 780.05
     rank  7: 780.22
     rank  8: 706.85
     rank  9: 707.99
     rank 10: 727.25
     rank 11: 725.75
     rank 12: 811.17
     rank 13: 811.06
     rank 14: 810.24
     rank 15: 810.74
  pure-backward-compute:
     rank  0: 32.50
     rank  1: 32.59
     rank  2: 33.12
     rank  3: 34.07
     rank  4: 753.99
     rank  5: 755.03
     rank  6: 778.87
     rank  7: 779.35
     rank  8: 705.91
     rank  9: 707.14
     rank 10: 725.44
     rank 11: 725.01
     rank 12: 809.74
     rank 13: 809.67
     rank 14: 807.99
     rank 15: 809.18
  batch-generator:
     rank  0: 21.85
     rank  1: 22.80
     rank  2: 26.44
     rank  3: 26.21
     rank  4: 30.29
     rank  5: 32.11
     rank  6: 46.11
     rank  7: 47.43
     rank  8: 35.74
     rank  9: 37.53
     rank 10: 29.39
     rank 11: 29.27
     rank 12: 38.52
     rank 13: 38.22
     rank 14: 32.26
     rank 15: 32.51
  forward-recv:
     rank  4: 66.19
     rank  5: 65.70
     rank  6: 64.85
     rank  7: 64.67
     rank  8: 144.29
     rank  9: 142.40
     rank 10: 147.39
     rank 11: 149.98
     rank 12: 212.57
     rank 13: 212.54
     rank 14: 211.20
     rank 15: 209.97
  forward-send:
     rank  0: 61.66
     rank  1: 60.75
     rank  2: 44.69
     rank  3: 45.33
     rank  4: 7.76
     rank  5: 7.32
     rank  6: 7.80
     rank  7: 7.82
     rank  8: 3.71
     rank  9: 3.65
     rank 10: 4.55
     rank 11: 2.55
  backward-recv:
     rank  0: 537.34
     rank  1: 537.32
     rank  2: 536.16
     rank  3: 535.87
     rank  4: 175.74
     rank  5: 176.21
     rank  6: 171.06
     rank  7: 171.68
     rank  8: 93.79
     rank  9: 93.60
     rank 10: 90.57
     rank 11: 91.26
  backward-send:
     rank  4: 4.80
     rank  5: 4.41
     rank  6: 4.93
     rank  7: 3.85
     rank  8: 7.20
     rank  9: 6.39
     rank 10: 7.32
     rank 11: 7.21
     rank 12: 5.02
     rank 13: 4.97
     rank 14: 5.44
     rank 15: 5.09
  forward-send-backward-recv:
     rank  0: 862.10
     rank  1: 861.96
     rank  2: 806.77
     rank  3: 805.67
     rank  4: 270.80
     rank  5: 270.26
     rank  6: 228.92
     rank  7: 228.29
     rank  8: 249.57
     rank  9: 249.22
     rank 10: 229.68
     rank 11: 230.74
  backward-send-forward-recv:
     rank  4: 14.56
     rank  5: 14.26
     rank  6: 12.08
     rank  7: 11.03
     rank  8: 35.64
     rank  9: 34.46
     rank 10: 30.33
     rank 11: 31.29
     rank 12: 42.27
     rank 13: 41.92
     rank 14: 42.03
     rank 15: 42.09
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.04
     rank  7: 0.03
     rank  8: 0.09
     rank  9: 0.05
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.04
     rank 15: 0.08
  embedding-grads-all-reduce:
     rank  0: 0.08
     rank  1: 0.04
     rank  2: 0.06
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.04
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.08
     rank 13: 0.08
     rank 14: 0.11
     rank 15: 0.19
  all-grads-sync:
     rank  0: 31.77
     rank  1: 31.79
     rank  2: 31.72
     rank  3: 31.74
     rank  4: 422.88
     rank  5: 423.03
     rank  6: 422.85
     rank  7: 423.03
     rank  8: 358.62
     rank  9: 358.60
     rank 10: 358.60
     rank 11: 358.58
     rank 12: 858.72
     rank 13: 858.80
     rank 14: 858.66
     rank 15: 858.96
  optimizer-copy-to-main-grad:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.04
     rank  7: 0.10
     rank  8: 0.06
     rank  9: 0.07
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.06
     rank 13: 0.06
     rank 14: 0.07
     rank 15: 0.13
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 3.90
     rank  1: 3.78
     rank  2: 3.78
     rank  3: 3.79
     rank  4: 49.43
     rank  5: 49.46
     rank  6: 49.58
     rank  7: 49.56
     rank  8: 43.44
     rank  9: 43.38
     rank 10: 43.53
     rank 11: 43.42
     rank 12: 50.14
     rank 13: 50.07
     rank 14: 50.42
     rank 15: 50.46
  optimizer:
     rank  0: 4.94
     rank  1: 4.82
     rank  2: 4.82
     rank  3: 4.83
     rank  4: 50.46
     rank  5: 50.50
     rank  6: 50.61
     rank  7: 50.60
     rank  8: 44.50
     rank  9: 44.41
     rank 10: 44.58
     rank 11: 44.47
     rank 12: 51.18
     rank 13: 51.11
     rank 14: 51.45
     rank 15: 51.48
 [2024-12-24 23:06:38] iteration        3/      10 | consumed samples:           48 | elapsed time per iteration (ms): 2819.6 | learning rate: 2.250000E-06 | global batch size:    16 | lm loss: 6.875628E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2731.38
     rank  1: 2731.29
     rank  2: 2731.45
     rank  3: 2731.28
     rank  4: 2735.70
     rank  5: 2735.64
     rank  6: 2735.75
     rank  7: 2735.73
     rank  8: 2735.29
     rank  9: 2735.09
     rank 10: 2735.29
     rank 11: 2735.12
     rank 12: 2735.88
     rank 13: 2735.79
     rank 14: 2736.02
     rank 15: 2735.89
  forward-compute:
     rank  0: 386.57
     rank  1: 386.76
     rank  2: 385.39
     rank  3: 385.81
     rank  4: 585.28
     rank  5: 585.53
     rank  6: 604.19
     rank  7: 607.07
     rank  8: 542.06
     rank  9: 546.07
     rank 10: 548.22
     rank 11: 548.49
     rank 12: 618.12
     rank 13: 618.47
     rank 14: 616.72
     rank 15: 616.81
  backward-compute:
     rank  0: 32.55
     rank  1: 32.83
     rank  2: 33.88
     rank  3: 35.67
     rank  4: 754.25
     rank  5: 757.44
     rank  6: 773.99
     rank  7: 773.84
     rank  8: 707.95
     rank  9: 708.44
     rank 10: 726.79
     rank 11: 725.41
     rank 12: 811.46
     rank 13: 811.80
     rank 14: 812.79
     rank 15: 813.75
  pure-backward-compute:
     rank  0: 32.22
     rank  1: 32.46
     rank  2: 33.52
     rank  3: 35.31
     rank  4: 753.66
     rank  5: 756.78
     rank  6: 772.90
     rank  7: 773.19
     rank  8: 706.53
     rank  9: 707.62
     rank 10: 725.33
     rank 11: 724.46
     rank 12: 809.94
     rank 13: 810.07
     rank 14: 811.03
     rank 15: 811.78
  batch-generator:
     rank  0: 23.01
     rank  1: 23.10
     rank  2: 22.78
     rank  3: 23.35
     rank  4: 29.46
     rank  5: 30.09
     rank  6: 39.85
     rank  7: 41.75
     rank  8: 33.78
     rank  9: 36.98
     rank 10: 29.46
     rank 11: 29.72
     rank 12: 31.27
     rank 13: 31.65
     rank 14: 33.55
     rank 15: 32.42
  forward-recv:
     rank  4: 56.84
     rank  5: 56.84
     rank  6: 55.63
     rank  7: 55.23
     rank  8: 136.14
     rank  9: 136.30
     rank 10: 136.96
     rank 11: 137.28
     rank 12: 200.68
     rank 13: 200.48
     rank 14: 200.96
     rank 15: 200.84
  forward-send:
     rank  0: 61.48
     rank  1: 61.13
     rank  2: 62.53
     rank  3: 62.63
     rank  4: 9.24
     rank  5: 8.97
     rank  6: 9.38
     rank  7: 9.50
     rank  8: 5.20
     rank  9: 4.92
     rank 10: 5.06
     rank 11: 5.00
  backward-recv:
     rank  0: 536.10
     rank  1: 536.25
     rank  2: 535.58
     rank  3: 534.70
     rank  4: 174.12
     rank  5: 173.81
     rank  6: 172.54
     rank  7: 174.39
     rank  8: 90.77
     rank  9: 91.63
     rank 10: 89.96
     rank 11: 90.04
  backward-send:
     rank  4: 4.38
     rank  5: 4.18
     rank  6: 4.50
     rank  7: 3.39
     rank  8: 7.53
     rank  9: 6.68
     rank 10: 7.41
     rank 11: 7.34
     rank 12: 4.94
     rank 13: 4.84
     rank 14: 5.12
     rank 15: 5.26
  forward-send-backward-recv:
     rank  0: 854.12
     rank  1: 853.95
     rank  2: 856.85
     rank  3: 855.42
     rank  4: 265.63
     rank  5: 262.94
     rank  6: 234.36
     rank  7: 233.06
     rank  8: 240.52
     rank  9: 241.54
     rank 10: 226.54
     rank 11: 227.83
  backward-send-forward-recv:
     rank  4: 14.64
     rank  5: 14.93
     rank  6: 11.38
     rank  7: 9.61
     rank  8: 36.27
     rank  9: 33.32
     rank 10: 30.41
     rank 11: 31.00
     rank 12: 42.35
     rank 13: 41.88
     rank 14: 41.90
     rank 15: 41.32
  layernorm-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.08
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.06
     rank  8: 0.07
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.07
     rank 15: 0.04
  embedding-grads-all-reduce:
     rank  0: 0.08
     rank  1: 0.11
     rank  2: 0.05
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.04
     rank  8: 0.05
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.08
     rank 13: 0.08
     rank 14: 0.19
     rank 15: 0.10
  all-grads-sync:
     rank  0: 31.30
     rank  1: 31.41
     rank  2: 31.36
     rank  3: 31.42
     rank  4: 429.33
     rank  5: 428.76
     rank  6: 429.28
     rank  7: 428.76
     rank  8: 712.69
     rank  9: 712.82
     rank 10: 712.60
     rank 11: 712.83
     rank 12: 851.40
     rank 13: 853.03
     rank 14: 851.45
     rank 15: 852.93
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.07
     rank  8: 0.13
     rank  9: 0.06
     rank 10: 0.06
     rank 11: 0.06
     rank 12: 0.06
     rank 13: 0.06
     rank 14: 0.12
     rank 15: 0.16
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-inner-step:
     rank  0: 3.82
     rank  1: 3.93
     rank  2: 3.82
     rank  3: 3.77
     rank  4: 49.46
     rank  5: 49.43
     rank  6: 49.46
     rank  7: 49.81
     rank  8: 43.80
     rank  9: 43.55
     rank 10: 43.65
     rank 11: 43.62
     rank 12: 50.06
     rank 13: 50.12
     rank 14: 50.42
     rank 15: 50.36
  optimizer:
     rank  0: 4.86
     rank  1: 4.97
     rank  2: 4.86
     rank  3: 4.81
     rank  4: 50.52
     rank  5: 50.47
     rank  6: 50.50
     rank  7: 50.86
     rank  8: 44.85
     rank  9: 44.59
     rank 10: 44.69
     rank 11: 44.66
     rank 12: 51.10
     rank 13: 51.16
     rank 14: 51.46
     rank 15: 51.40
 [2024-12-24 23:06:41] iteration        4/      10 | consumed samples:           64 | elapsed time per iteration (ms): 2851.1 | learning rate: 3.000000E-06 | global batch size:    16 | lm loss: 2.540079E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2762.92
     rank  1: 2762.92
     rank  2: 2762.94
     rank  3: 2762.91
     rank  4: 2767.21
     rank  5: 2767.21
     rank  6: 2767.25
     rank  7: 2767.25
     rank  8: 2766.74
     rank  9: 2766.76
     rank 10: 2766.78
     rank 11: 2766.78
     rank 12: 2767.37
     rank 13: 2767.45
     rank 14: 2767.44
     rank 15: 2767.57
  forward-compute:
     rank  0: 422.28
     rank  1: 422.88
     rank  2: 385.60
     rank  3: 386.08
     rank  4: 580.93
     rank  5: 581.44
     rank  6: 607.37
     rank  7: 609.11
     rank  8: 544.70
     rank  9: 546.64
     rank 10: 555.65
     rank 11: 557.98
     rank 12: 626.20
     rank 13: 625.84
     rank 14: 654.53
     rank 15: 653.06
  backward-compute:
     rank  0: 34.85
     rank  1: 33.54
     rank  2: 34.19
     rank  3: 35.45
     rank  4: 752.77
     rank  5: 755.23
     rank  6: 778.70
     rank  7: 780.53
     rank  8: 709.17
     rank  9: 709.54
     rank 10: 725.47
     rank 11: 723.07
     rank 12: 816.20
     rank 13: 816.21
     rank 14: 811.47
     rank 15: 811.98
  pure-backward-compute:
     rank  0: 34.44
     rank  1: 33.22
     rank  2: 33.83
     rank  3: 35.09
     rank  4: 752.28
     rank  5: 754.73
     rank  6: 777.65
     rank  7: 779.83
     rank  8: 707.96
     rank  9: 708.64
     rank 10: 724.45
     rank 11: 722.35
     rank 12: 814.53
     rank 13: 814.63
     rank 14: 809.87
     rank 15: 810.25
  batch-generator:
     rank  0: 29.59
     rank  1: 28.81
     rank  2: 22.43
     rank  3: 22.88
     rank  4: 26.36
     rank  5: 26.29
     rank  6: 44.94
     rank  7: 43.84
     rank  8: 32.88
     rank  9: 34.46
     rank 10: 34.56
     rank 11: 36.29
     rank 12: 36.89
     rank 13: 33.91
     rank 14: 37.74
     rank 15: 34.92
  forward-recv:
     rank  4: 70.94
     rank  5: 70.78
     rank  6: 51.53
     rank  7: 51.43
     rank  8: 150.31
     rank  9: 149.70
     rank 10: 129.99
     rank 11: 130.64
     rank 12: 214.07
     rank 13: 214.59
     rank 14: 193.19
     rank 15: 192.86
  forward-send:
     rank  0: 45.87
     rank  1: 45.95
     rank  2: 58.49
     rank  3: 58.65
     rank  4: 5.40
     rank  5: 5.49
     rank  6: 5.63
     rank  7: 5.68
     rank  8: 2.30
     rank  9: 2.53
     rank 10: 2.80
     rank 11: 2.56
  backward-recv:
     rank  0: 539.87
     rank  1: 540.49
     rank  2: 538.62
     rank  3: 537.78
     rank  4: 177.31
     rank  5: 176.38
     rank  6: 172.76
     rank  7: 174.53
     rank  8: 93.11
     rank  9: 93.16
     rank 10: 90.46
     rank 11: 90.62
  backward-send:
     rank  4: 4.39
     rank  5: 4.43
     rank  6: 4.43
     rank  7: 3.09
     rank  8: 7.50
     rank  9: 6.48
     rank 10: 7.40
     rank 11: 7.37
     rank 12: 5.18
     rank 13: 5.15
     rank 14: 5.17
     rank 15: 5.24
  forward-send-backward-recv:
     rank  0: 856.04
     rank  1: 856.11
     rank  2: 885.01
     rank  3: 883.97
     rank  4: 286.46
     rank  5: 285.20
     rank  6: 260.49
     rank  7: 258.16
     rank  8: 252.17
     rank  9: 253.62
     rank 10: 254.09
     rank 11: 256.38
  backward-send-forward-recv:
     rank  4: 13.89
     rank  5: 13.81
     rank  6: 12.71
     rank  7: 11.82
     rank  8: 35.00
     rank  9: 33.35
     rank 10: 32.44
     rank 11: 30.47
     rank 12: 42.10
     rank 13: 41.71
     rank 14: 39.22
     rank 15: 40.52
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.04
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.05
     rank  2: 0.05
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.08
     rank 13: 0.08
     rank 14: 0.08
     rank 15: 0.09
  all-grads-sync:
     rank  0: 31.85
     rank  1: 31.84
     rank  2: 31.83
     rank  3: 31.85
     rank  4: 430.42
     rank  5: 430.66
     rank  6: 430.40
     rank  7: 430.67
     rank  8: 690.02
     rank  9: 690.23
     rank 10: 690.02
     rank 11: 690.27
     rank 12: 857.33
     rank 13: 857.32
     rank 14: 857.29
     rank 15: 857.34
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.06
     rank  9: 0.07
     rank 10: 0.07
     rank 11: 0.06
     rank 12: 0.07
     rank 13: 0.06
     rank 14: 0.07
     rank 15: 0.07
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 3.82
     rank  1: 3.79
     rank  2: 3.83
     rank  3: 3.77
     rank  4: 49.42
     rank  5: 49.45
     rank  6: 49.44
     rank  7: 49.48
     rank  8: 43.55
     rank  9: 43.68
     rank 10: 43.74
     rank 11: 43.58
     rank 12: 50.14
     rank 13: 50.25
     rank 14: 50.19
     rank 15: 50.32
  optimizer:
     rank  0: 4.79
     rank  1: 4.77
     rank  2: 4.80
     rank  3: 4.75
     rank  4: 50.39
     rank  5: 50.43
     rank  6: 50.42
     rank  7: 50.46
     rank  8: 44.52
     rank  9: 44.65
     rank 10: 44.71
     rank 11: 44.55
     rank 12: 51.11
     rank 13: 51.33
     rank 14: 51.16
     rank 15: 51.28
 [2024-12-24 23:06:44] iteration        5/      10 | consumed samples:           80 | elapsed time per iteration (ms): 2830.0 | learning rate: 3.750000E-06 | global batch size:    16 | lm loss: 2.158345E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2742.63
     rank  1: 2742.57
     rank  2: 2742.59
     rank  3: 2742.58
     rank  4: 2746.86
     rank  5: 2746.87
     rank  6: 2746.88
     rank  7: 2746.89
     rank  8: 2746.50
     rank  9: 2746.39
     rank 10: 2746.38
     rank 11: 2746.41
     rank 12: 2746.98
     rank 13: 2747.02
     rank 14: 2747.07
     rank 15: 2747.10
  forward-compute:
     rank  0: 374.46
     rank  1: 375.45
     rank  2: 379.35
     rank  3: 379.70
     rank  4: 581.38
     rank  5: 582.73
     rank  6: 611.67
     rank  7: 614.78
     rank  8: 540.84
     rank  9: 542.27
     rank 10: 556.29
     rank 11: 556.26
     rank 12: 636.68
     rank 13: 636.70
     rank 14: 628.22
     rank 15: 629.21
  backward-compute:
     rank  0: 34.66
     rank  1: 34.25
     rank  2: 34.39
     rank  3: 36.63
     rank  4: 753.18
     rank  5: 754.32
     rank  6: 778.49
     rank  7: 778.22
     rank  8: 711.90
     rank  9: 712.53
     rank 10: 726.83
     rank 11: 725.83
     rank 12: 810.76
     rank 13: 810.99
     rank 14: 814.18
     rank 15: 814.47
  pure-backward-compute:
     rank  0: 34.31
     rank  1: 33.93
     rank  2: 34.01
     rank  3: 36.28
     rank  4: 752.44
     rank  5: 753.60
     rank  6: 777.58
     rank  7: 777.64
     rank  8: 710.22
     rank  9: 711.15
     rank 10: 725.42
     rank 11: 725.14
     rank 12: 808.84
     rank 13: 809.17
     rank 14: 812.19
     rank 15: 812.47
  batch-generator:
     rank  0: 20.94
     rank  1: 21.88
     rank  2: 21.85
     rank  3: 22.18
     rank  4: 29.68
     rank  5: 30.06
     rank  6: 47.93
     rank  7: 46.88
     rank  8: 32.24
     rank  9: 33.31
     rank 10: 28.59
     rank 11: 28.57
     rank 12: 35.86
     rank 13: 33.33
     rank 14: 39.14
     rank 15: 38.62
  forward-recv:
     rank  4: 50.39
     rank  5: 50.42
     rank  6: 51.47
     rank  7: 51.48
     rank  8: 128.48
     rank  9: 128.15
     rank 10: 130.20
     rank 11: 130.55
     rank 12: 189.58
     rank 13: 189.59
     rank 14: 194.80
     rank 15: 194.71
  forward-send:
     rank  0: 58.61
     rank  1: 58.18
     rank  2: 60.09
     rank  3: 60.48
     rank  4: 5.61
     rank  5: 5.32
     rank  6: 5.51
     rank  7: 5.80
     rank  8: 2.89
     rank  9: 2.85
     rank 10: 2.86
     rank 11: 2.86
  backward-recv:
     rank  0: 541.16
     rank  1: 541.43
     rank  2: 538.50
     rank  3: 537.67
     rank  4: 179.60
     rank  5: 178.34
     rank  6: 175.73
     rank  7: 177.09
     rank  8: 92.98
     rank  9: 93.36
     rank 10: 91.29
     rank 11: 91.47
  backward-send:
     rank  4: 4.83
     rank  5: 4.52
     rank  6: 4.17
     rank  7: 3.22
     rank  8: 7.56
     rank  9: 6.13
     rank 10: 7.63
     rank 11: 7.56
     rank 12: 5.27
     rank 13: 5.12
     rank 14: 5.16
     rank 15: 5.12
  forward-send-backward-recv:
     rank  0: 872.17
     rank  1: 871.49
     rank  2: 870.39
     rank  3: 868.24
     rank  4: 284.89
     rank  5: 284.61
     rank  6: 235.90
     rank  7: 235.62
     rank  8: 256.20
     rank  9: 256.62
     rank 10: 232.11
     rank 11: 232.28
  backward-send-forward-recv:
     rank  4: 13.37
     rank  5: 13.05
     rank  6: 11.51
     rank  7: 9.35
     rank  8: 35.51
     rank  9: 34.75
     rank 10: 32.90
     rank 11: 33.59
     rank 12: 43.13
     rank 13: 42.91
     rank 14: 42.58
     rank 15: 41.45
  layernorm-grads-all-reduce:
     rank  0: 0.07
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.06
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.04
     rank 15: 0.04
  embedding-grads-all-reduce:
     rank  0: 0.10
     rank  1: 0.04
     rank  2: 0.07
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.04
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.08
     rank 13: 0.09
     rank 14: 0.08
     rank 15: 0.09
  all-grads-sync:
     rank  0: 31.45
     rank  1: 31.47
     rank  2: 31.42
     rank  3: 31.44
     rank  4: 409.94
     rank  5: 410.19
     rank  6: 409.94
     rank  7: 410.18
     rank  8: 408.30
     rank  9: 408.17
     rank 10: 408.20
     rank 11: 408.21
     rank 12: 855.91
     rank 13: 855.87
     rank 14: 855.91
     rank 15: 855.73
  optimizer-copy-to-main-grad:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.08
     rank  7: 0.04
     rank  8: 0.12
     rank  9: 0.06
     rank 10: 0.06
     rank 11: 0.06
     rank 12: 0.06
     rank 13: 0.07
     rank 14: 0.06
     rank 15: 0.13
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 3.97
     rank  1: 3.80
     rank  2: 3.89
     rank  3: 3.77
     rank  4: 49.44
     rank  5: 49.47
     rank  6: 49.57
     rank  7: 49.49
     rank  8: 43.91
     rank  9: 43.63
     rank 10: 43.70
     rank 11: 43.73
     rank 12: 50.15
     rank 13: 50.15
     rank 14: 50.23
     rank 15: 50.25
  optimizer:
     rank  0: 5.27
     rank  1: 5.10
     rank  2: 5.19
     rank  3: 5.07
     rank  4: 50.74
     rank  5: 50.77
     rank  6: 50.87
     rank  7: 50.79
     rank  8: 45.24
     rank  9: 44.94
     rank 10: 44.99
     rank 11: 45.03
     rank 12: 51.45
     rank 13: 51.45
     rank 14: 51.52
     rank 15: 51.55
 [2024-12-24 23:06:46] iteration        6/      10 | consumed samples:           96 | elapsed time per iteration (ms): 2831.1 | learning rate: 4.500000E-06 | global batch size:    16 | lm loss: 2.100175E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2742.24
     rank  1: 2742.25
     rank  2: 2742.27
     rank  3: 2742.28
     rank  4: 2746.56
     rank  5: 2746.57
     rank  6: 2746.61
     rank  7: 2746.60
     rank  8: 2746.07
     rank  9: 2746.05
     rank 10: 2746.11
     rank 11: 2746.10
     rank 12: 2746.72
     rank 13: 2746.77
     rank 14: 2746.83
     rank 15: 2746.89
  forward-compute:
     rank  0: 379.29
     rank  1: 381.21
     rank  2: 382.43
     rank  3: 382.51
     rank  4: 577.56
     rank  5: 579.84
     rank  6: 588.11
     rank  7: 589.61
     rank  8: 545.78
     rank  9: 542.56
     rank 10: 552.61
     rank 11: 553.77
     rank 12: 638.62
     rank 13: 641.78
     rank 14: 634.86
     rank 15: 635.39
  backward-compute:
     rank  0: 34.79
     rank  1: 34.90
     rank  2: 34.22
     rank  3: 34.51
     rank  4: 755.66
     rank  5: 750.45
     rank  6: 770.24
     rank  7: 771.39
     rank  8: 708.53
     rank  9: 709.84
     rank 10: 727.45
     rank 11: 726.85
     rank 12: 811.23
     rank 13: 811.65
     rank 14: 816.95
     rank 15: 817.40
  pure-backward-compute:
     rank  0: 34.45
     rank  1: 34.59
     rank  2: 33.87
     rank  3: 34.15
     rank  4: 755.08
     rank  5: 749.87
     rank  6: 769.68
     rank  7: 770.85
     rank  8: 707.36
     rank  9: 708.62
     rank 10: 726.06
     rank 11: 726.14
     rank 12: 809.35
     rank 13: 809.90
     rank 14: 815.07
     rank 15: 815.28
  batch-generator:
     rank  0: 22.33
     rank  1: 24.30
     rank  2: 22.11
     rank  3: 22.57
     rank  4: 25.59
     rank  5: 27.71
     rank  6: 26.24
     rank  7: 27.43
     rank  8: 34.52
     rank  9: 32.38
     rank 10: 27.67
     rank 11: 28.72
     rank 12: 35.46
     rank 13: 38.63
     rank 14: 48.11
     rank 15: 43.33
  forward-recv:
     rank  4: 53.90
     rank  5: 53.49
     rank  6: 54.56
     rank  7: 54.53
     rank  8: 133.04
     rank  9: 136.09
     rank 10: 134.69
     rank 11: 134.81
     rank 12: 199.05
     rank 13: 195.58
     rank 14: 199.32
     rank 15: 199.33
  forward-send:
     rank  0: 62.35
     rank  1: 61.04
     rank  2: 63.05
     rank  3: 63.06
     rank  4: 9.19
     rank  5: 8.60
     rank  6: 8.86
     rank  7: 8.83
     rank  8: 4.41
     rank  9: 1.57
     rank 10: 4.06
     rank 11: 4.07
  backward-recv:
     rank  0: 541.44
     rank  1: 541.86
     rank  2: 542.45
     rank  3: 542.48
     rank  4: 178.14
     rank  5: 178.17
     rank  6: 177.73
     rank  7: 177.44
     rank  8: 96.69
     rank  9: 96.72
     rank 10: 94.72
     rank 11: 94.87
  backward-send:
     rank  4: 4.59
     rank  5: 4.32
     rank  6: 3.93
     rank  7: 3.99
     rank  8: 5.60
     rank  9: 5.53
     rank 10: 5.77
     rank 11: 5.62
     rank 12: 5.03
     rank 13: 5.00
     rank 14: 4.76
     rank 15: 4.78
  forward-send-backward-recv:
     rank  0: 873.64
     rank  1: 872.17
     rank  2: 873.77
     rank  3: 873.36
     rank  4: 291.89
     rank  5: 296.07
     rank  6: 274.32
     rank  7: 273.05
     rank  8: 260.12
     rank  9: 260.47
     rank 10: 243.78
     rank 11: 244.10
  backward-send-forward-recv:
     rank  4: 13.13
     rank  5: 13.07
     rank  6: 11.02
     rank  7: 10.44
     rank  8: 31.39
     rank  9: 35.06
     rank 10: 28.66
     rank 11: 28.62
     rank 12: 43.55
     rank 13: 43.64
     rank 14: 42.18
     rank 15: 41.13
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.04
     rank  9: 0.03
     rank 10: 0.04
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.04
     rank 15: 0.04
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.05
     rank  2: 0.05
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.08
     rank 13: 0.08
     rank 14: 0.10
     rank 15: 0.11
  all-grads-sync:
     rank  0: 30.32
     rank  1: 30.36
     rank  2: 30.34
     rank  3: 30.39
     rank  4: 417.54
     rank  5: 417.12
     rank  6: 417.55
     rank  7: 417.13
     rank  8: 446.93
     rank  9: 447.11
     rank 10: 446.94
     rank 11: 447.12
     rank 12: 840.98
     rank 13: 842.59
     rank 14: 841.04
     rank 15: 842.49
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.04
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.04
     rank  7: 0.03
     rank  8: 0.06
     rank  9: 0.06
     rank 10: 0.11
     rank 11: 0.06
     rank 12: 0.06
     rank 13: 0.06
     rank 14: 0.07
     rank 15: 0.07
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.02
  optimizer-inner-step:
     rank  0: 3.77
     rank  1: 3.79
     rank  2: 3.78
     rank  3: 3.77
     rank  4: 49.42
     rank  5: 49.47
     rank  6: 49.50
     rank  7: 49.50
     rank  8: 43.56
     rank  9: 43.63
     rank 10: 43.69
     rank 11: 43.84
     rank 12: 50.09
     rank 13: 50.12
     rank 14: 50.33
     rank 15: 50.39
  optimizer:
     rank  0: 4.80
     rank  1: 4.82
     rank  2: 4.81
     rank  3: 4.80
     rank  4: 50.45
     rank  5: 50.50
     rank  6: 50.53
     rank  7: 50.53
     rank  8: 44.59
     rank  9: 44.66
     rank 10: 44.75
     rank 11: 44.87
     rank 12: 51.12
     rank 13: 51.15
     rank 14: 51.35
     rank 15: 51.42
 [2024-12-24 23:06:49] iteration        7/      10 | consumed samples:          112 | elapsed time per iteration (ms): 2840.5 | learning rate: 5.250000E-06 | global batch size:    16 | lm loss: 3.791330E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2753.31
     rank  1: 2753.22
     rank  2: 2753.26
     rank  3: 2753.23
     rank  4: 2757.56
     rank  5: 2757.55
     rank  6: 2757.56
     rank  7: 2757.57
     rank  8: 2757.10
     rank  9: 2757.07
     rank 10: 2757.06
     rank 11: 2757.07
     rank 12: 2757.69
     rank 13: 2757.70
     rank 14: 2757.73
     rank 15: 2757.74
  forward-compute:
     rank  0: 377.84
     rank  1: 378.79
     rank  2: 380.43
     rank  3: 380.81
     rank  4: 578.81
     rank  5: 579.24
     rank  6: 593.27
     rank  7: 594.78
     rank  8: 550.20
     rank  9: 554.25
     rank 10: 555.27
     rank 11: 555.45
     rank 12: 625.14
     rank 13: 626.27
     rank 14: 624.05
     rank 15: 624.91
  backward-compute:
     rank  0: 34.57
     rank  1: 32.99
     rank  2: 33.88
     rank  3: 34.85
     rank  4: 752.23
     rank  5: 756.65
     rank  6: 779.08
     rank  7: 779.61
     rank  8: 713.15
     rank  9: 712.55
     rank 10: 727.15
     rank 11: 727.18
     rank 12: 815.25
     rank 13: 815.63
     rank 14: 815.87
     rank 15: 816.20
  pure-backward-compute:
     rank  0: 34.22
     rank  1: 32.67
     rank  2: 33.51
     rank  3: 34.51
     rank  4: 751.59
     rank  5: 756.00
     rank  6: 778.54
     rank  7: 779.16
     rank  8: 711.24
     rank  9: 711.52
     rank 10: 726.00
     rank 11: 726.36
     rank 12: 813.46
     rank 13: 813.92
     rank 14: 813.93
     rank 15: 814.39
  batch-generator:
     rank  0: 21.83
     rank  1: 22.84
     rank  2: 22.06
     rank  3: 22.40
     rank  4: 23.86
     rank  5: 25.25
     rank  6: 29.90
     rank  7: 30.15
     rank  8: 38.65
     rank  9: 40.76
     rank 10: 32.94
     rank 11: 32.31
     rank 12: 35.57
     rank 13: 35.16
     rank 14: 36.48
     rank 15: 35.45
  forward-recv:
     rank  4: 54.52
     rank  5: 54.28
     rank  6: 54.17
     rank  7: 53.79
     rank  8: 133.72
     rank  9: 134.36
     rank 10: 133.58
     rank 11: 133.81
     rank 12: 198.07
     rank 13: 197.32
     rank 14: 198.98
     rank 15: 198.86
  forward-send:
     rank  0: 62.73
     rank  1: 62.38
     rank  2: 61.59
     rank  3: 61.44
     rank  4: 9.71
     rank  5: 9.43
     rank  6: 9.83
     rank  7: 9.65
     rank  8: 4.75
     rank  9: 3.94
     rank 10: 4.34
     rank 11: 4.33
  backward-recv:
     rank  0: 538.69
     rank  1: 539.46
     rank  2: 536.15
     rank  3: 536.14
     rank  4: 175.44
     rank  5: 172.97
     rank  6: 173.00
     rank  7: 172.65
     rank  8: 91.47
     rank  9: 93.30
     rank 10: 90.85
     rank 11: 90.96
  backward-send:
     rank  4: 4.37
     rank  5: 4.83
     rank  6: 3.91
     rank  7: 4.43
     rank  8: 7.95
     rank  9: 5.95
     rank 10: 7.61
     rank 11: 7.46
     rank 12: 4.47
     rank 13: 4.92
     rank 14: 5.13
     rank 15: 5.17
  forward-send-backward-recv:
     rank  0: 867.78
     rank  1: 867.69
     rank  2: 872.08
     rank  3: 871.14
     rank  4: 284.16
     rank  5: 282.16
     rank  6: 253.33
     rank  7: 252.71
     rank  8: 236.49
     rank  9: 238.71
     rank 10: 229.87
     rank 11: 230.93
  backward-send-forward-recv:
     rank  4: 14.25
     rank  5: 14.30
     rank  6: 10.82
     rank  7: 10.34
     rank  8: 36.84
     rank  9: 33.69
     rank 10: 31.76
     rank 11: 31.42
     rank 12: 43.18
     rank 13: 42.71
     rank 14: 42.89
     rank 15: 42.05
  layernorm-grads-all-reduce:
     rank  0: 0.10
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.04
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.04
  embedding-grads-all-reduce:
     rank  0: 0.12
     rank  1: 0.04
     rank  2: 0.05
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.08
     rank 13: 0.08
     rank 14: 0.09
     rank 15: 0.08
  all-grads-sync:
     rank  0: 32.12
     rank  1: 32.20
     rank  2: 32.11
     rank  3: 32.17
     rank  4: 403.56
     rank  5: 403.59
     rank  6: 403.57
     rank  7: 403.59
     rank  8: 711.78
     rank  9: 711.63
     rank 10: 711.77
     rank 11: 711.83
     rank 12: 865.23
     rank 13: 865.34
     rank 14: 865.19
     rank 15: 865.32
  optimizer-copy-to-main-grad:
     rank  0: 0.03
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.04
     rank  8: 0.08
     rank  9: 0.07
     rank 10: 0.06
     rank 11: 0.06
     rank 12: 0.06
     rank 13: 0.06
     rank 14: 0.06
     rank 15: 0.07
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 3.94
     rank  1: 3.78
     rank  2: 3.82
     rank  3: 3.77
     rank  4: 49.45
     rank  5: 49.47
     rank  6: 49.52
     rank  7: 49.53
     rank  8: 43.70
     rank  9: 43.69
     rank 10: 43.68
     rank 11: 43.64
     rank 12: 50.13
     rank 13: 50.14
     rank 14: 50.24
     rank 15: 50.16
  optimizer:
     rank  0: 4.86
     rank  1: 4.69
     rank  2: 4.73
     rank  3: 4.69
     rank  4: 50.37
     rank  5: 50.39
     rank  6: 50.44
     rank  7: 50.45
     rank  8: 44.61
     rank  9: 44.61
     rank 10: 44.59
     rank 11: 44.56
     rank 12: 51.05
     rank 13: 51.05
     rank 14: 51.16
     rank 15: 51.08
 [2024-12-24 23:06:52] iteration        8/      10 | consumed samples:          128 | elapsed time per iteration (ms): 2836.0 | learning rate: 6.000000E-06 | global batch size:    16 | lm loss: 2.395798E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2747.79
     rank  1: 2747.72
     rank  2: 2747.81
     rank  3: 2747.77
     rank  4: 2752.11
     rank  5: 2752.06
     rank  6: 2752.13
     rank  7: 2752.08
     rank  8: 2751.85
     rank  9: 2751.61
     rank 10: 2751.76
     rank 11: 2751.59
     rank 12: 2752.49
     rank 13: 2752.21
     rank 14: 2752.27
     rank 15: 2752.27
  forward-compute:
     rank  0: 438.52
     rank  1: 437.36
     rank  2: 376.01
     rank  3: 375.99
     rank  4: 576.55
     rank  5: 576.61
     rank  6: 591.64
     rank  7: 592.35
     rank  8: 545.38
     rank  9: 548.89
     rank 10: 553.23
     rank 11: 554.44
     rank 12: 626.18
     rank 13: 626.44
     rank 14: 636.32
     rank 15: 637.07
  backward-compute:
     rank  0: 36.11
     rank  1: 34.77
     rank  2: 33.84
     rank  3: 34.30
     rank  4: 751.75
     rank  5: 753.05
     rank  6: 776.03
     rank  7: 777.13
     rank  8: 711.55
     rank  9: 712.01
     rank 10: 723.46
     rank 11: 722.96
     rank 12: 815.19
     rank 13: 815.54
     rank 14: 815.44
     rank 15: 815.87
  pure-backward-compute:
     rank  0: 35.78
     rank  1: 34.39
     rank  2: 33.50
     rank  3: 33.94
     rank  4: 750.93
     rank  5: 752.40
     rank  6: 775.47
     rank  7: 776.66
     rank  8: 710.44
     rank  9: 711.10
     rank 10: 721.98
     rank 11: 722.28
     rank 12: 813.40
     rank 13: 813.77
     rank 14: 813.77
     rank 15: 814.23
  batch-generator:
     rank  0: 22.93
     rank  1: 23.76
     rank  2: 21.28
     rank  3: 21.22
     rank  4: 26.39
     rank  5: 26.39
     rank  6: 25.12
     rank  7: 25.07
     rank  8: 35.20
     rank  9: 37.78
     rank 10: 33.35
     rank 11: 33.64
     rank 12: 36.18
     rank 13: 35.84
     rank 14: 36.34
     rank 15: 34.99
  forward-recv:
     rank  4: 62.97
     rank  5: 62.95
     rank  6: 50.98
     rank  7: 51.00
     rank  8: 140.35
     rank  9: 140.08
     rank 10: 129.80
     rank 11: 130.13
     rank 12: 202.56
     rank 13: 202.64
     rank 14: 192.10
     rank 15: 191.96
  forward-send:
     rank  0: 36.81
     rank  1: 37.66
     rank  2: 60.25
     rank  3: 60.38
     rank  4: 5.75
     rank  5: 5.57
     rank  6: 5.70
     rank  7: 5.75
     rank  8: 2.78
     rank  9: 2.85
     rank 10: 2.91
     rank 11: 2.67
  backward-recv:
     rank  0: 539.51
     rank  1: 540.92
     rank  2: 540.87
     rank  3: 540.87
     rank  4: 180.32
     rank  5: 179.55
     rank  6: 176.79
     rank  7: 176.87
     rank  8: 95.65
     rank  9: 94.59
     rank 10: 92.71
     rank 11: 92.97
  backward-send:
     rank  4: 3.65
     rank  5: 5.43
     rank  6: 4.27
     rank  7: 4.19
     rank  8: 7.01
     rank  9: 8.02
     rank 10: 8.19
     rank 11: 8.12
     rank 12: 5.03
     rank 13: 4.95
     rank 14: 5.37
     rank 15: 5.30
  forward-send-backward-recv:
     rank  0: 837.07
     rank  1: 837.16
     rank  2: 879.25
     rank  3: 878.90
     rank  4: 285.69
     rank  5: 284.18
     rank  6: 266.66
     rank  7: 266.21
     rank  8: 244.36
     rank  9: 246.03
     rank 10: 244.10
     rank 11: 245.01
  backward-send-forward-recv:
     rank  4: 14.35
     rank  5: 14.41
     rank  6: 11.25
     rank  7: 10.92
     rank  8: 35.97
     rank  9: 32.78
     rank 10: 31.99
     rank 11: 31.28
     rank 12: 43.07
     rank 13: 42.53
     rank 14: 43.26
     rank 15: 42.37
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.07
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.10
     rank  9: 0.03
     rank 10: 0.04
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.04
     rank  2: 0.05
     rank  3: 0.09
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.06
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.10
     rank 13: 0.08
     rank 14: 0.08
     rank 15: 0.08
  all-grads-sync:
     rank  0: 32.26
     rank  1: 32.26
     rank  2: 32.22
     rank  3: 32.22
     rank  4: 420.24
     rank  5: 420.22
     rank  6: 420.25
     rank  7: 420.22
     rank  8: 735.00
     rank  9: 735.04
     rank 10: 735.13
     rank 11: 735.04
     rank 12: 853.64
     rank 13: 853.69
     rank 14: 853.64
     rank 15: 853.68
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.13
     rank  9: 0.06
     rank 10: 0.07
     rank 11: 0.06
     rank 12: 0.06
     rank 13: 0.06
     rank 14: 0.06
     rank 15: 0.07
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 3.79
     rank  1: 3.79
     rank  2: 3.86
     rank  3: 3.88
     rank  4: 49.52
     rank  5: 49.49
     rank  6: 49.51
     rank  7: 49.49
     rank  8: 43.89
     rank  9: 43.77
     rank 10: 43.86
     rank 11: 43.56
     rank 12: 50.19
     rank 13: 50.08
     rank 14: 50.19
     rank 15: 50.17
  optimizer:
     rank  0: 6.11
     rank  1: 6.11
     rank  2: 6.23
     rank  3: 6.20
     rank  4: 51.84
     rank  5: 51.82
     rank  6: 51.83
     rank  7: 51.82
     rank  8: 46.21
     rank  9: 46.09
     rank 10: 46.18
     rank 11: 45.88
     rank 12: 52.48
     rank 13: 52.41
     rank 14: 52.52
     rank 15: 52.50
 [2024-12-24 23:06:55] iteration        9/      10 | consumed samples:          144 | elapsed time per iteration (ms): 2810.3 | learning rate: 6.750000E-06 | global batch size:    16 | lm loss: 2.050182E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2723.05
     rank  1: 2723.08
     rank  2: 2723.06
     rank  3: 2723.06
     rank  4: 2727.36
     rank  5: 2727.39
     rank  6: 2727.39
     rank  7: 2727.46
     rank  8: 2726.89
     rank  9: 2726.90
     rank 10: 2726.89
     rank 11: 2726.89
     rank 12: 2727.53
     rank 13: 2727.51
     rank 14: 2727.50
     rank 15: 2727.49
  forward-compute:
     rank  0: 377.12
     rank  1: 376.77
     rank  2: 381.08
     rank  3: 381.40
     rank  4: 578.17
     rank  5: 578.30
     rank  6: 593.19
     rank  7: 593.88
     rank  8: 547.32
     rank  9: 549.43
     rank 10: 551.26
     rank 11: 553.37
     rank 12: 631.29
     rank 13: 633.29
     rank 14: 629.53
     rank 15: 629.72
  backward-compute:
     rank  0: 35.75
     rank  1: 35.46
     rank  2: 34.31
     rank  3: 34.56
     rank  4: 751.45
     rank  5: 755.13
     rank  6: 771.60
     rank  7: 774.14
     rank  8: 713.18
     rank  9: 713.37
     rank 10: 721.34
     rank 11: 720.63
     rank 12: 816.38
     rank 13: 816.32
     rank 14: 816.26
     rank 15: 816.80
  pure-backward-compute:
     rank  0: 35.40
     rank  1: 35.07
     rank  2: 33.97
     rank  3: 34.21
     rank  4: 750.83
     rank  5: 754.55
     rank  6: 770.98
     rank  7: 773.55
     rank  8: 711.43
     rank  9: 712.43
     rank 10: 719.94
     rank 11: 719.86
     rank 12: 814.47
     rank 13: 814.56
     rank 14: 814.73
     rank 15: 815.20
  batch-generator:
     rank  0: 21.66
     rank  1: 21.34
     rank  2: 22.63
     rank  3: 22.95
     rank  4: 26.62
     rank  5: 25.97
     rank  6: 30.55
     rank  7: 29.84
     rank  8: 34.66
     rank  9: 35.24
     rank 10: 30.07
     rank 11: 31.53
     rank 12: 40.69
     rank 13: 39.86
     rank 14: 34.54
     rank 15: 33.89
  forward-recv:
     rank  4: 52.59
     rank  5: 52.66
     rank  6: 53.64
     rank  7: 53.61
     rank  8: 129.37
     rank  9: 129.70
     rank 10: 131.91
     rank 11: 132.22
     rank 12: 194.71
     rank 13: 194.47
     rank 14: 197.31
     rank 15: 197.25
  forward-send:
     rank  0: 60.20
     rank  1: 60.25
     rank  2: 60.81
     rank  3: 60.89
     rank  4: 6.56
     rank  5: 6.44
     rank  6: 6.36
     rank  7: 6.52
     rank  8: 2.98
     rank  9: 2.77
     rank 10: 2.87
     rank 11: 2.79
  backward-recv:
     rank  0: 538.29
     rank  1: 538.83
     rank  2: 540.81
     rank  3: 541.05
     rank  4: 178.26
     rank  5: 175.59
     rank  6: 175.98
     rank  7: 175.05
     rank  8: 90.45
     rank  9: 92.24
     rank 10: 89.68
     rank 11: 89.88
  backward-send:
     rank  4: 3.87
     rank  5: 4.78
     rank  6: 4.33
     rank  7: 4.83
     rank  8: 9.06
     rank  9: 7.50
     rank 10: 8.96
     rank 11: 8.88
     rank 12: 4.74
     rank 13: 4.74
     rank 14: 5.18
     rank 15: 5.13
  forward-send-backward-recv:
     rank  0: 875.10
     rank  1: 875.35
     rank  2: 871.93
     rank  3: 871.35
     rank  4: 293.48
     rank  5: 291.92
     rank  6: 265.57
     rank  7: 263.55
     rank  8: 254.12
     rank  9: 254.44
     rank 10: 246.12
     rank 11: 246.55
  backward-send-forward-recv:
     rank  4: 15.04
     rank  5: 15.19
     rank  6: 11.35
     rank  7: 10.97
     rank  8: 35.06
     rank  9: 33.53
     rank 10: 32.76
     rank 11: 31.31
     rank 12: 42.40
     rank 13: 40.96
     rank 14: 42.10
     rank 15: 41.64
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.07
     rank  2: 0.05
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.08
     rank 13: 0.08
     rank 14: 0.07
     rank 15: 0.08
  all-grads-sync:
     rank  0: 31.10
     rank  1: 31.13
     rank  2: 31.13
     rank  3: 31.17
     rank  4: 410.21
     rank  5: 410.53
     rank  6: 410.22
     rank  7: 410.53
     rank  8: 454.12
     rank  9: 454.12
     rank 10: 454.12
     rank 11: 454.11
     rank 12: 825.72
     rank 13: 830.52
     rank 14: 825.73
     rank 15: 830.26
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.04
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.04
     rank  8: 0.06
     rank  9: 0.06
     rank 10: 0.06
     rank 11: 0.06
     rank 12: 0.05
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.11
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 3.77
     rank  1: 3.90
     rank  2: 3.80
     rank  3: 3.78
     rank  4: 49.44
     rank  5: 49.47
     rank  6: 49.49
     rank  7: 49.54
     rank  8: 43.58
     rank  9: 43.67
     rank 10: 43.59
     rank 11: 43.62
     rank 12: 49.94
     rank 13: 49.92
     rank 14: 50.00
     rank 15: 49.95
  optimizer:
     rank  0: 4.67
     rank  1: 4.79
     rank  2: 4.70
     rank  3: 4.67
     rank  4: 50.35
     rank  5: 50.37
     rank  6: 50.38
     rank  7: 50.44
     rank  8: 44.47
     rank  9: 44.56
     rank 10: 44.49
     rank 11: 44.52
     rank 12: 50.85
     rank 13: 50.83
     rank 14: 50.90
     rank 15: 50.85
 [2024-12-24 23:06:58] iteration       10/      10 | consumed samples:          160 | elapsed time per iteration (ms): 2804.7 | learning rate: 7.500000E-06 | global batch size:    16 | lm loss: 2.456998E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2718.26
     rank  1: 2718.27
     rank  2: 2718.23
     rank  3: 2718.23
     rank  4: 2722.57
     rank  5: 2722.56
     rank  6: 2722.57
     rank  7: 2722.55
     rank  8: 2722.29
     rank  9: 2722.12
     rank 10: 2722.19
     rank 11: 2722.09
     rank 12: 2722.77
     rank 13: 2722.79
     rank 14: 2722.85
     rank 15: 2722.82
  forward-compute:
     rank  0: 377.79
     rank  1: 378.07
     rank  2: 389.28
     rank  3: 389.12
     rank  4: 575.34
     rank  5: 575.20
     rank  6: 598.94
     rank  7: 598.83
     rank  8: 544.81
     rank  9: 546.13
     rank 10: 547.94
     rank 11: 549.22
     rank 12: 625.23
     rank 13: 625.91
     rank 14: 625.06
     rank 15: 624.57
  backward-compute:
     rank  0: 35.26
     rank  1: 34.97
     rank  2: 33.89
     rank  3: 34.46
     rank  4: 750.79
     rank  5: 753.83
     rank  6: 779.99
     rank  7: 781.97
     rank  8: 713.94
     rank  9: 714.53
     rank 10: 721.79
     rank 11: 721.04
     rank 12: 816.77
     rank 13: 816.75
     rank 14: 817.31
     rank 15: 818.39
  pure-backward-compute:
     rank  0: 34.87
     rank  1: 34.61
     rank  2: 33.55
     rank  3: 34.12
     rank  4: 750.29
     rank  5: 753.27
     rank  6: 779.48
     rank  7: 781.51
     rank  8: 712.45
     rank  9: 713.35
     rank 10: 720.83
     rank 11: 720.32
     rank 12: 814.83
     rank 13: 814.96
     rank 14: 815.52
     rank 15: 816.16
  batch-generator:
     rank  0: 22.78
     rank  1: 23.15
     rank  2: 26.22
     rank  3: 25.02
     rank  4: 23.82
     rank  5: 23.47
     rank  6: 28.96
     rank  7: 28.45
     rank  8: 32.64
     rank  9: 33.19
     rank 10: 28.73
     rank 11: 29.86
     rank 12: 36.02
     rank 13: 34.05
     rank 14: 35.87
     rank 15: 34.20
  forward-recv:
     rank  4: 53.36
     rank  5: 53.46
     rank  6: 52.68
     rank  7: 52.69
     rank  8: 129.73
     rank  9: 130.30
     rank 10: 134.07
     rank 11: 134.14
     rank 12: 197.48
     rank 13: 196.92
     rank 14: 198.07
     rank 15: 198.03
  forward-send:
     rank  0: 62.66
     rank  1: 62.49
     rank  2: 55.41
     rank  3: 55.49
     rank  4: 7.31
     rank  5: 7.00
     rank  6: 7.06
     rank  7: 7.34
     rank  8: 5.22
     rank  9: 4.52
     rank 10: 4.78
     rank 11: 4.73
  backward-recv:
     rank  0: 539.47
     rank  1: 539.81
     rank  2: 538.30
     rank  3: 538.38
     rank  4: 179.82
     rank  5: 178.00
     rank  6: 176.83
     rank  7: 176.20
     rank  8: 94.78
     rank  9: 95.77
     rank 10: 94.39
     rank 11: 94.23
  backward-send:
     rank  4: 3.99
     rank  5: 4.49
     rank  6: 3.81
     rank  7: 4.45
     rank  8: 8.34
     rank  9: 7.08
     rank 10: 8.16
     rank 11: 8.16
     rank 12: 4.53
     rank 13: 4.29
     rank 14: 5.24
     rank 15: 4.85
  forward-send-backward-recv:
     rank  0: 865.81
     rank  1: 865.73
     rank  2: 866.89
     rank  3: 866.70
     rank  4: 290.04
     rank  5: 289.32
     rank  6: 246.34
     rank  7: 245.78
     rank  8: 244.04
     rank  9: 245.32
     rank 10: 234.82
     rank 11: 236.35
  backward-send-forward-recv:
     rank  4: 13.57
     rank  5: 13.65
     rank  6: 10.92
     rank  7: 10.68
     rank  8: 35.32
     rank  9: 34.41
     rank 10: 34.35
     rank 11: 33.69
     rank 12: 42.31
     rank 13: 42.35
     rank 14: 41.54
     rank 15: 41.12
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.10
     rank  9: 0.04
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.04
     rank 13: 0.03
     rank 14: 0.04
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.05
     rank  2: 0.04
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.05
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.09
     rank 13: 0.09
     rank 14: 0.09
     rank 15: 0.08
  all-grads-sync:
     rank  0: 31.86
     rank  1: 31.76
     rank  2: 31.90
     rank  3: 31.78
     rank  4: 428.08
     rank  5: 428.68
     rank  6: 428.08
     rank  7: 428.67
     rank  8: 559.01
     rank  9: 558.98
     rank 10: 559.01
     rank 11: 558.80
     rank 12: 828.30
     rank 13: 830.63
     rank 14: 828.27
     rank 15: 830.64
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.04
     rank  7: 0.03
     rank  8: 0.12
     rank  9: 0.06
     rank 10: 0.06
     rank 11: 0.12
     rank 12: 0.06
     rank 13: 0.12
     rank 14: 0.06
     rank 15: 0.07
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 3.82
     rank  1: 3.81
     rank  2: 3.77
     rank  3: 3.78
     rank  4: 49.44
     rank  5: 49.51
     rank  6: 49.52
     rank  7: 49.45
     rank  8: 43.79
     rank  9: 43.64
     rank 10: 43.66
     rank 11: 43.70
     rank 12: 50.12
     rank 13: 50.24
     rank 14: 50.30
     rank 15: 50.20
  optimizer:
     rank  0: 4.79
     rank  1: 4.77
     rank  2: 4.74
     rank  3: 4.75
     rank  4: 50.42
     rank  5: 50.48
     rank  6: 50.49
     rank  7: 50.42
     rank  8: 44.75
     rank  9: 44.60
     rank 10: 44.62
     rank 11: 44.67
     rank 12: 51.08
     rank 13: 51.21
     rank 14: 51.26
     rank 15: 51.16
