examples/multimodal/pretrain-freeze-llm-homo.sh: line 4: activate: No such file or directory
[2024-12-31 11:44:26,194] torch.distributed.run: [WARNING] 
[2024-12-31 11:44:26,194] torch.distributed.run: [WARNING] *****************************************
[2024-12-31 11:44:26,194] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-12-31 11:44:26,194] torch.distributed.run: [WARNING] *****************************************
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:20------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:20------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:20------
------num_pipeline_model_parallel_groups:4------
> setting tensorboard ...
WARNING: one_logger package is required to enable e2e metrics tracking. please go to https://confluence.nvidia.com/display/MLWFO/Package+Repositories for details to install it
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:20------
------num_pipeline_model_parallel_groups:4------
---Rank 17---Tensor Parallel Group GPUs: [1, 1, 1, 1]---Rank 16---Tensor Parallel Group GPUs: [0, 0, 0, 0]---Rank 19---Tensor Parallel Group GPUs: [3, 3, 3, 3]


---Rank 17---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]
---Rank 16---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]---Rank 19---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]

---Rank 18---Tensor Parallel Group GPUs: [2, 2, 2, 2]
[rank17]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank16]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank19]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
---Rank 18---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]
[rank18]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
 > number of parameters on (tensor, pipeline) model parallel rank (1, 4): 469831680
 > number of parameters on (tensor, pipeline) model parallel rank (3, 4): 469831680
 > number of parameters on (tensor, pipeline) model parallel rank (2, 4): 469831680
 > number of parameters on (tensor, pipeline) model parallel rank (0, 4): 469831680
INFO:megatron.core.distributed.param_and_grad_buffer:Number of buckets for gradient all-reduce / reduce-scatter: 1
Params for bucket 1 (469831680 elements):
	language_model.decoder.layers.4.mlp.linear_fc2.weight
	language_model.decoder.layers.3.self_attention.linear_qkv.weight
	language_model.decoder.layers.1.mlp.linear_fc1.weight
	language_model.decoder.layers.0.self_attention.linear_proj.weight
	language_model.decoder.layers.7.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.6.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.5.self_attention.linear_qkv.weight
	language_model.decoder.layers.5.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.5.self_attention.linear_proj.weight
	language_model.decoder.layers.3.self_attention.linear_proj.weight
	language_model.decoder.layers.2.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.2.self_attention.linear_proj.weight
	language_model.decoder.layers.7.self_attention.linear_qkv.weight
	language_model.decoder.layers.6.self_attention.linear_qkv.weight
	language_model.decoder.layers.3.mlp.linear_fc2.weight
	language_model.decoder.layers.2.self_attention.linear_qkv.weight
	language_model.decoder.layers.0.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.final_layernorm.weight
	language_model.decoder.layers.4.mlp.linear_fc1.weight
	language_model.decoder.layers.4.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.3.mlp.linear_fc1.weight
	language_model.decoder.layers.0.mlp.linear_fc2.weight
	language_model.decoder.layers.0.self_attention.linear_qkv.layer_norm_weight
	language_model.output_layer.weight
	language_model.decoder.layers.6.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.6.self_attention.linear_proj.weight
	language_model.decoder.layers.5.mlp.linear_fc2.weight
	language_model.decoder.layers.5.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.3.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.2.mlp.linear_fc1.weight
	language_model.decoder.layers.2.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.7.mlp.linear_fc2.weight
	language_model.decoder.layers.7.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.5.mlp.linear_fc1.weight
	language_model.decoder.layers.1.mlp.linear_fc2.weight
	language_model.decoder.layers.1.self_attention.linear_qkv.weight
	language_model.decoder.layers.0.mlp.linear_fc1.weight
	language_model.decoder.layers.7.mlp.linear_fc1.weight
	language_model.decoder.layers.6.mlp.linear_fc1.weight
	language_model.decoder.layers.4.self_attention.linear_qkv.weight
	language_model.decoder.layers.1.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.1.self_attention.linear_proj.weight
	language_model.decoder.layers.0.self_attention.linear_qkv.weight
	language_model.decoder.layers.7.self_attention.linear_proj.weight
	language_model.decoder.layers.6.mlp.linear_fc2.weight
	language_model.decoder.layers.4.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.4.self_attention.linear_proj.weight
	language_model.decoder.layers.3.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.2.mlp.linear_fc2.weight
	language_model.decoder.layers.1.self_attention.linear_qkv.layer_norm_weight
rank=0, worker=0: shard_range=[pretrain-0.tar[0, 100), pretrain-0.tar[100, 200), pretrain-0.tar[200, 300), ...<2494>, pretrain-30.tar[9700, 9800), pretrain-30.tar[9800, 9900), pretrain-30.tar[9900, 10000)] sum(count)=250000
rank=0, worker=1: shard_range=[pretrain-31.tar[0, 100), pretrain-31.tar[100, 200), pretrain-31.tar[200, 300), ...<2494>, pretrain-53.tar[9700, 9800), pretrain-53.tar[9800, 9900), pretrain-53.tar[9900, 10000)] sum(count)=250000
rank=0, worker=0: shard_range=[pretrain-54.tar[0, 10000), pretrain-55.tar[0, 8128), pretrain-6.tar[0, 10000), pretrain-7.tar[0, 936)] sum(count)=29064
rank=0, worker=1: shard_range=[pretrain-7.tar[936, 10000), pretrain-8.tar[0, 10000), pretrain-9.tar[0, 10000)] sum(count)=29064
times across ranks (ms):
  model-and-optimizer-setup:
     rank  0: 110.75
     rank  1: 75.07
     rank  2: 113.37
     rank  3: 114.84
     rank  4: 32.04
     rank  5: 32.13
     rank  6: 43.82
     rank  7: 46.26
     rank  8: 31.58
     rank  9: 47.53
     rank 10: 47.78
     rank 11: 47.69
     rank 12: 43.03
     rank 13: 31.29
     rank 14: 29.91
     rank 15: 42.72
     rank 16: 52.11
     rank 17: 33.89
     rank 18: 51.67
     rank 19: 51.47
  train/valid/test-data-iterators-setup:
     rank  0: 911.05
     rank  1: 911.07
     rank  2: 910.95
     rank  3: 910.94
     rank  4: 911.08
     rank  5: 911.48
     rank  6: 911.16
     rank  7: 911.12
     rank  8: 911.20
     rank  9: 911.29
     rank 10: 911.30
     rank 11: 912.46
     rank 12: 1129.49
     rank 13: 1129.46
     rank 14: 1129.48
     rank 15: 1129.57
     rank 16: 1129.53
     rank 17: 1129.55
     rank 18: 1129.49
     rank 19: 1129.52
 [2024-12-31 11:45:09] iteration        1/      10 | consumed samples:           32 | elapsed time per iteration (ms): 23323.5 | learning rate: 7.500000E-07 | global batch size:    32 | lm loss: 7.124510E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
[Rank 18] (after 1 iterations) memory (MB) | allocated: 7222.3154296875 | max allocated: 9013.798828125 | reserved: 9762.0 | max reserved: 9762.0
[Rank 17] (after 1 iterations) memory (MB) | allocated: 7222.3154296875 | max allocated: 9013.798828125 | reserved: 9656.0 | max reserved: 9656.0
stage5 GPU utialization:110.03172397613525 %
[Rank 16] (after 1 iterations) memory (MB) | allocated: 7222.3154296875 | max allocated: 9013.798828125 | reserved: 9762.0 | max reserved: 9762.0
[Rank 19] (after 1 iterations) memory (MB) | allocated: 7222.3154296875 | max allocated: 9013.798828125 | reserved: 9650.0 | max reserved: 9650.0
times across ranks (ms):
  forward-backward:
     rank  0: 23251.54
     rank  1: 23251.43
     rank  2: 23251.50
     rank  3: 23251.52
     rank  4: 23254.89
     rank  5: 23254.80
     rank  6: 23254.60
     rank  7: 23254.66
     rank  8: 23254.70
     rank  9: 23254.58
     rank 10: 23254.51
     rank 11: 23254.45
     rank 12: 23254.68
     rank 13: 23254.59
     rank 14: 23254.53
     rank 15: 23254.38
     rank 16: 23254.34
     rank 17: 23254.46
     rank 18: 23254.27
     rank 19: 23254.40
  forward-compute:
     rank  0: 6896.18
     rank  1: 6884.78
     rank  2: 6904.20
     rank  3: 6897.08
     rank  4: 5376.12
     rank  5: 5384.83
     rank  6: 5376.31
     rank  7: 5376.08
     rank  8: 5282.66
     rank  9: 5289.98
     rank 10: 5281.10
     rank 11: 5280.44
     rank 12: 5412.90
     rank 13: 5420.66
     rank 14: 5417.19
     rank 15: 5417.80
     rank 16: 5423.48
     rank 17: 5435.31
     rank 18: 5438.80
     rank 19: 5434.81
  backward-compute:
     rank  0: 3615.25
     rank  1: 3640.65
     rank  2: 3609.34
     rank  3: 3616.22
     rank  4: 3477.12
     rank  5: 3475.67
     rank  6: 3478.99
     rank  7: 3476.62
     rank  8: 3431.76
     rank  9: 3436.04
     rank 10: 3433.15
     rank 11: 3432.19
     rank 12: 3428.51
     rank 13: 3432.33
     rank 14: 3441.61
     rank 15: 3432.21
     rank 16: 3632.57
     rank 17: 3629.91
     rank 18: 3644.05
     rank 19: 3637.10
  pure-backward-compute:
     rank  0: 3613.61
     rank  1: 3638.76
     rank  2: 3607.83
     rank  3: 3614.51
     rank  4: 3475.31
     rank  5: 3473.28
     rank  6: 3476.95
     rank  7: 3474.04
     rank  8: 3428.21
     rank  9: 3433.09
     rank 10: 3431.13
     rank 11: 3429.53
     rank 12: 3425.48
     rank 13: 3428.47
     rank 14: 3439.73
     rank 15: 3429.69
     rank 16: 3626.36
     rank 17: 3624.46
     rank 18: 3641.08
     rank 19: 3632.04
  batch-generator:
     rank  0: 1287.09
     rank  1: 1287.71
     rank  2: 1304.88
     rank  3: 1303.73
     rank  4: 1252.87
     rank  5: 1281.56
     rank  6: 1266.07
     rank  7: 1276.45
     rank  8: 1109.09
     rank  9: 1118.79
     rank 10: 1115.24
     rank 11: 1116.94
     rank 12: 1241.04
     rank 13: 1253.94
     rank 14: 1241.84
     rank 15: 1250.08
     rank 16: 1139.59
     rank 17: 1148.27
     rank 18: 1154.11
     rank 19: 1151.05
  forward-recv:
     rank  4: 4490.50
     rank  5: 4490.73
     rank  6: 4490.75
     rank  7: 4483.40
     rank  8: 6883.48
     rank  9: 6879.75
     rank 10: 6884.58
     rank 11: 6885.06
     rank 12: 9327.07
     rank 13: 9327.24
     rank 14: 9329.42
     rank 15: 9327.08
     rank 16: 11912.87
     rank 17: 11909.42
     rank 18: 11913.50
     rank 19: 11911.88
  forward-send:
     rank  0: 7371.74
     rank  1: 7366.18
     rank  2: 7377.00
     rank  3: 7366.44
     rank  4: 4861.24
     rank  5: 4855.37
     rank  6: 4865.94
     rank  7: 4862.77
     rank  8: 2518.56
     rank  9: 2515.77
     rank 10: 2522.17
     rank 11: 2517.96
     rank 12: 30.77
     rank 13: 27.27
     rank 14: 31.38
     rank 15: 29.82
  backward-recv:
     rank  0: 602.43
     rank  1: 600.41
     rank  2: 601.09
     rank  3: 602.50
     rank  4: 313.29
     rank  5: 312.93
     rank  6: 314.81
     rank  7: 310.80
     rank  8: 205.61
     rank  9: 205.48
     rank 10: 206.24
     rank 11: 206.89
     rank 12: 102.51
     rank 13: 103.12
     rank 14: 102.28
     rank 15: 102.56
  backward-send:
     rank  4: 10.17
     rank  5: 10.21
     rank  6: 8.54
     rank  7: 10.56
     rank  8: 15.28
     rank  9: 14.97
     rank 10: 14.77
     rank 11: 14.21
     rank 12: 10.08
     rank 13: 9.59
     rank 14: 9.84
     rank 15: 10.07
     rank 16: 5.03
     rank 17: 5.08
     rank 18: 4.25
     rank 19: 5.05
  forward-send-backward-recv:
     rank  0: 4685.92
     rank  1: 4676.49
     rank  2: 4682.31
     rank  3: 4689.77
     rank  4: 2911.72
     rank  5: 2910.34
     rank  6: 2906.65
     rank  7: 2910.14
     rank  8: 2855.40
     rank  9: 2852.76
     rank 10: 2859.58
     rank 11: 2861.33
     rank 12: 2774.11
     rank 13: 2776.88
     rank 14: 2768.43
     rank 15: 2771.65
  backward-send-forward-recv:
     rank  4: 1671.22
     rank  5: 1668.32
     rank  6: 1669.19
     rank  7: 1675.44
     rank  8: 1804.51
     rank  9: 1804.48
     rank 10: 1802.00
     rank 11: 1804.69
     rank 12: 1799.99
     rank 13: 1794.05
     rank 14: 1794.62
     rank 15: 1798.04
     rank 16: 1798.93
     rank 17: 1793.06
     rank 18: 1781.73
     rank 19: 1791.03
  layernorm-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.05
     rank  2: 0.06
     rank  3: 0.06
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.03
     rank  7: 0.04
     rank  8: 0.05
     rank  9: 0.04
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.06
     rank 13: 0.06
     rank 14: 0.06
     rank 15: 0.04
     rank 16: 0.02
     rank 17: 0.04
     rank 18: 0.02
     rank 19: 0.04
  embedding-grads-all-reduce:
     rank  0: 0.14
     rank  1: 0.12
     rank  2: 0.14
     rank  3: 0.12
     rank  4: 0.05
     rank  5: 0.06
     rank  6: 0.03
     rank  7: 0.04
     rank  8: 0.04
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.05
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.03
     rank 16: 0.06
     rank 17: 0.10
     rank 18: 0.05
     rank 19: 0.07
  all-grads-sync:
     rank  0: 47.04
     rank  1: 46.89
     rank  2: 46.64
     rank  3: 47.26
     rank  4: 45.51
     rank  5: 45.85
     rank  6: 39.61
     rank  7: 44.35
     rank  8: 43.52
     rank  9: 42.76
     rank 10: 42.26
     rank 11: 42.59
     rank 12: 47.12
     rank 13: 41.92
     rank 14: 51.47
     rank 15: 47.32
     rank 16: 2.78
     rank 17: 2.95
     rank 18: 2.54
     rank 19: 2.64
  optimizer-copy-to-main-grad:
     rank  0: 0.26
     rank  1: 0.26
     rank  2: 0.27
     rank  3: 0.25
     rank  4: 0.07
     rank  5: 0.06
     rank  6: 0.08
     rank  7: 0.08
     rank  8: 0.09
     rank  9: 0.08
     rank 10: 0.07
     rank 11: 0.06
     rank 12: 0.08
     rank 13: 0.07
     rank 14: 0.12
     rank 15: 0.07
     rank 16: 0.07
     rank 17: 0.09
     rank 18: 0.04
     rank 19: 0.06
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.04
     rank 15: 0.02
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.02
  optimizer-count-zeros:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.02
  optimizer-inner-step:
     rank  0: 13.86
     rank  1: 13.81
     rank  2: 13.95
     rank  3: 14.00
     rank  4: 62.38
     rank  5: 62.15
     rank  6: 61.76
     rank  7: 62.62
     rank  8: 59.84
     rank  9: 59.64
     rank 10: 59.21
     rank 11: 59.12
     rank 12: 58.97
     rank 13: 59.24
     rank 14: 59.25
     rank 15: 58.99
     rank 16: 61.69
     rank 17: 61.67
     rank 18: 61.59
     rank 19: 62.23
  optimizer:
     rank  0: 15.17
     rank  1: 15.12
     rank  2: 15.27
     rank  3: 15.31
     rank  4: 63.70
     rank  5: 63.48
     rank  6: 63.08
     rank  7: 63.96
     rank  8: 61.17
     rank  9: 60.97
     rank 10: 60.55
     rank 11: 60.45
     rank 12: 60.30
     rank 13: 60.57
     rank 14: 60.55
     rank 15: 60.31
     rank 16: 63.02
     rank 17: 63.00
     rank 18: 62.92
     rank 19: 63.56
 [2024-12-31 11:45:17] iteration        2/      10 | consumed samples:           64 | elapsed time per iteration (ms): 7729.2 | learning rate: 1.500000E-06 | global batch size:    32 | lm loss: 7.075938E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 7638.79
     rank  1: 7638.87
     rank  2: 7638.78
     rank  3: 7638.80
     rank  4: 7642.32
     rank  5: 7642.28
     rank  6: 7642.22
     rank  7: 7642.27
     rank  8: 7642.04
     rank  9: 7642.16
     rank 10: 7641.97
     rank 11: 7642.03
     rank 12: 7641.99
     rank 13: 7642.07
     rank 14: 7641.96
     rank 15: 7641.97
     rank 16: 7642.27
     rank 17: 7642.25
     rank 18: 7642.18
     rank 19: 7642.22
  forward-compute:
     rank  0: 2417.44
     rank  1: 2414.27
     rank  2: 2433.09
     rank  3: 2428.68
     rank  4: 3082.86
     rank  5: 3083.27
     rank  6: 3094.01
     rank  7: 3077.37
     rank  8: 2938.49
     rank  9: 2936.11
     rank 10: 2944.28
     rank 11: 2943.32
     rank 12: 2909.13
     rank 13: 2918.37
     rank 14: 2920.88
     rank 15: 2913.02
     rank 16: 3075.26
     rank 17: 3078.26
     rank 18: 3087.41
     rank 19: 3086.46
  backward-compute:
     rank  0: 2095.00
     rank  1: 2100.41
     rank  2: 2091.02
     rank  3: 2080.32
     rank  4: 3470.97
     rank  5: 3468.51
     rank  6: 3477.98
     rank  7: 3477.11
     rank  8: 3415.13
     rank  9: 3424.05
     rank 10: 3417.42
     rank 11: 3411.24
     rank 12: 3409.90
     rank 13: 3409.25
     rank 14: 3416.83
     rank 15: 3415.67
     rank 16: 3618.88
     rank 17: 3617.93
     rank 18: 3624.84
     rank 19: 3622.70
  pure-backward-compute:
     rank  0: 2093.61
     rank  1: 2098.05
     rank  2: 2089.67
     rank  3: 2079.02
     rank  4: 3469.15
     rank  5: 3466.26
     rank  6: 3476.43
     rank  7: 3474.87
     rank  8: 3411.87
     rank  9: 3420.82
     rank 10: 3415.90
     rank 11: 3409.78
     rank 12: 3407.41
     rank 13: 3407.14
     rank 14: 3415.18
     rank 15: 3413.16
     rank 16: 3613.20
     rank 17: 3612.93
     rank 18: 3622.27
     rank 19: 3619.66
  batch-generator:
     rank  0: 90.85
     rank  1: 114.85
     rank  2: 125.03
     rank  3: 127.48
     rank  4: 94.31
     rank  5: 102.75
     rank  6: 110.11
     rank  7: 111.05
     rank  8: 110.12
     rank  9: 111.03
     rank 10: 119.63
     rank 11: 117.69
     rank 12: 87.35
     rank 13: 101.19
     rank 14: 95.60
     rank 15: 93.88
     rank 16: 105.57
     rank 17: 110.50
     rank 18: 115.00
     rank 19: 116.22
  forward-recv:
     rank  4: 69.48
     rank  5: 68.39
     rank  6: 67.88
     rank  7: 69.83
     rank  8: 172.73
     rank  9: 172.40
     rank 10: 173.63
     rank 11: 173.72
     rank 12: 266.62
     rank 13: 267.08
     rank 14: 265.64
     rank 15: 265.97
     rank 16: 356.39
     rank 17: 355.94
     rank 18: 356.31
     rank 19: 356.35
  forward-send:
     rank  0: 113.13
     rank  1: 110.99
     rank  2: 109.41
     rank  3: 112.37
     rank  4: 15.92
     rank  5: 14.89
     rank  6: 13.99
     rank  7: 14.96
     rank  8: 10.12
     rank  9: 10.20
     rank 10: 8.95
     rank 11: 9.43
     rank 12: 5.13
     rank 13: 4.59
     rank 14: 4.97
     rank 15: 5.05
  backward-recv:
     rank  0: 612.23
     rank  1: 610.34
     rank  2: 611.99
     rank  3: 612.42
     rank  4: 305.10
     rank  5: 305.97
     rank  6: 306.70
     rank  7: 304.56
     rank  8: 203.54
     rank  9: 203.08
     rank 10: 204.05
     rank 11: 205.04
     rank 12: 102.12
     rank 13: 102.61
     rank 14: 102.48
     rank 15: 101.75
  backward-send:
     rank  4: 10.67
     rank  5: 10.35
     rank  6: 9.47
     rank  7: 10.47
     rank  8: 15.16
     rank  9: 15.21
     rank 10: 14.65
     rank 11: 13.63
     rank 12: 10.11
     rank 13: 9.83
     rank 14: 9.73
     rank 15: 10.00
     rank 16: 5.21
     rank 17: 5.11
     rank 18: 4.78
     rank 19: 4.60
  forward-send-backward-recv:
     rank  0: 2370.18
     rank  1: 2366.08
     rank  2: 2367.38
     rank  3: 2376.77
     rank  4: 528.44
     rank  5: 527.41
     rank  6: 520.42
     rank  7: 519.47
     rank  8: 515.28
     rank  9: 510.98
     rank 10: 521.35
     rank 11: 527.17
     rank 12: 469.33
     rank 13: 470.05
     rank 14: 464.54
     rank 15: 463.92
  backward-send-forward-recv:
     rank  4: 85.03
     rank  5: 86.46
     rank  6: 80.38
     rank  7: 89.68
     rank  8: 184.42
     rank  9: 183.83
     rank 10: 178.42
     rank 11: 180.45
     rank 12: 173.00
     rank 13: 166.67
     rank 14: 167.50
     rank 15: 171.78
     rank 16: 176.50
     rank 17: 176.92
     rank 18: 168.84
     rank 19: 170.50
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.07
     rank  2: 0.05
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.05
     rank 17: 0.05
     rank 18: 0.04
     rank 19: 0.05
  all-grads-sync:
     rank  0: 0.62
     rank  1: 0.72
     rank  2: 0.68
     rank  3: 0.63
     rank  4: 2.37
     rank  5: 2.34
     rank  6: 2.29
     rank  7: 2.28
     rank  8: 2.20
     rank  9: 2.29
     rank 10: 2.16
     rank 11: 2.15
     rank 12: 2.17
     rank 13: 2.29
     rank 14: 2.22
     rank 15: 2.17
     rank 16: 2.44
     rank 17: 2.43
     rank 18: 2.29
     rank 19: 2.35
  optimizer-copy-to-main-grad:
     rank  0: 0.17
     rank  1: 0.22
     rank  2: 0.18
     rank  3: 0.16
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.04
     rank  7: 0.04
     rank  8: 0.05
     rank  9: 0.06
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.04
     rank 13: 0.06
     rank 14: 0.05
     rank 15: 0.04
     rank 16: 0.07
     rank 17: 0.06
     rank 18: 0.04
     rank 19: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 10.34
     rank  1: 10.79
     rank  2: 10.47
     rank  3: 10.34
     rank  4: 46.37
     rank  5: 46.33
     rank  6: 46.26
     rank  7: 46.35
     rank  8: 43.13
     rank  9: 43.18
     rank 10: 42.97
     rank 11: 42.95
     rank 12: 43.00
     rank 13: 43.17
     rank 14: 43.12
     rank 15: 42.96
     rank 16: 46.38
     rank 17: 46.31
     rank 18: 46.28
     rank 19: 46.36
  optimizer:
     rank  0: 11.12
     rank  1: 11.58
     rank  2: 11.27
     rank  3: 11.12
     rank  4: 47.18
     rank  5: 47.11
     rank  6: 47.04
     rank  7: 47.13
     rank  8: 43.91
     rank  9: 43.97
     rank 10: 43.75
     rank 11: 43.73
     rank 12: 43.78
     rank 13: 43.95
     rank 14: 43.90
     rank 15: 43.74
     rank 16: 47.16
     rank 17: 47.09
     rank 18: 47.06
     rank 19: 47.14
 [2024-12-31 11:45:25] iteration        3/      10 | consumed samples:           96 | elapsed time per iteration (ms): 7747.1 | learning rate: 2.250000E-06 | global batch size:    32 | lm loss: 3.281996E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 7663.25
     rank  1: 7663.30
     rank  2: 7663.33
     rank  3: 7663.38
     rank  4: 7666.79
     rank  5: 7666.79
     rank  6: 7666.72
     rank  7: 7666.83
     rank  8: 7666.59
     rank  9: 7666.63
     rank 10: 7666.45
     rank 11: 7666.62
     rank 12: 7666.46
     rank 13: 7666.54
     rank 14: 7666.45
     rank 15: 7666.53
     rank 16: 7666.71
     rank 17: 7666.86
     rank 18: 7666.67
     rank 19: 7666.90
  forward-compute:
     rank  0: 2050.07
     rank  1: 2053.05
     rank  2: 2053.51
     rank  3: 2054.16
     rank  4: 3073.76
     rank  5: 3076.68
     rank  6: 3078.02
     rank  7: 3076.56
     rank  8: 2944.26
     rank  9: 2944.99
     rank 10: 2949.13
     rank 11: 2948.04
     rank 12: 2915.66
     rank 13: 2919.15
     rank 14: 2924.71
     rank 15: 2920.87
     rank 16: 3086.21
     rank 17: 3085.03
     rank 18: 3100.25
     rank 19: 3093.97
  backward-compute:
     rank  0: 1741.44
     rank  1: 1747.10
     rank  2: 1743.40
     rank  3: 1740.81
     rank  4: 3461.89
     rank  5: 3464.29
     rank  6: 3471.59
     rank  7: 3467.46
     rank  8: 3412.10
     rank  9: 3418.15
     rank 10: 3415.65
     rank 11: 3410.36
     rank 12: 3401.98
     rank 13: 3399.31
     rank 14: 3409.58
     rank 15: 3402.82
     rank 16: 3605.32
     rank 17: 3602.95
     rank 18: 3611.39
     rank 19: 3609.96
  pure-backward-compute:
     rank  0: 1740.01
     rank  1: 1745.52
     rank  2: 1742.14
     rank  3: 1739.54
     rank  4: 3459.52
     rank  5: 3462.48
     rank  6: 3469.88
     rank  7: 3465.70
     rank  8: 3408.89
     rank  9: 3415.08
     rank 10: 3414.28
     rank 11: 3408.87
     rank 12: 3399.60
     rank 13: 3397.04
     rank 14: 3408.10
     rank 15: 3400.24
     rank 16: 3600.55
     rank 17: 3597.48
     rank 18: 3608.85
     rank 19: 3606.46
  batch-generator:
     rank  0: 88.36
     rank  1: 97.35
     rank  2: 97.56
     rank  3: 104.12
     rank  4: 135.13
     rank  5: 134.44
     rank  6: 134.16
     rank  7: 133.20
     rank  8: 110.46
     rank  9: 115.66
     rank 10: 114.95
     rank 11: 116.35
     rank 12: 86.63
     rank 13: 100.42
     rank 14: 96.23
     rank 15: 97.68
     rank 16: 99.96
     rank 17: 105.81
     rank 18: 114.44
     rank 19: 112.13
  forward-recv:
     rank  4: 85.97
     rank  5: 84.84
     rank  6: 86.10
     rank  7: 85.76
     rank  8: 191.90
     rank  9: 191.10
     rank 10: 193.34
     rank 11: 193.40
     rank 12: 282.24
     rank 13: 282.86
     rank 14: 281.37
     rank 15: 281.19
     rank 16: 370.37
     rank 17: 369.84
     rank 18: 370.37
     rank 19: 370.40
  forward-send:
     rank  0: 84.09
     rank  1: 80.63
     rank  2: 83.60
     rank  3: 82.58
     rank  4: 15.72
     rank  5: 14.49
     rank  6: 15.39
     rank  7: 15.16
     rank  8: 10.21
     rank  9: 10.20
     rank 10: 9.14
     rank 11: 8.92
     rank 12: 5.07
     rank 13: 4.48
     rank 14: 5.02
     rank 15: 5.00
  backward-recv:
     rank  0: 597.23
     rank  1: 594.80
     rank  2: 596.56
     rank  3: 597.40
     rank  4: 310.77
     rank  5: 311.66
     rank  6: 312.24
     rank  7: 310.89
     rank  8: 206.22
     rank  9: 205.62
     rank 10: 206.85
     rank 11: 207.37
     rank 12: 102.46
     rank 13: 103.80
     rank 14: 103.01
     rank 15: 102.70
  backward-send:
     rank  4: 10.77
     rank  5: 9.87
     rank  6: 9.29
     rank  7: 10.07
     rank  8: 15.30
     rank  9: 15.24
     rank 10: 14.50
     rank 11: 14.02
     rank 12: 9.52
     rank 13: 9.03
     rank 14: 9.60
     rank 15: 9.91
     rank 16: 5.21
     rank 17: 5.26
     rank 18: 4.62
     rank 19: 4.86
  forward-send-backward-recv:
     rank  0: 3158.93
     rank  1: 3156.85
     rank  2: 3159.48
     rank  3: 3161.98
     rank  4: 531.66
     rank  5: 531.71
     rank  6: 523.83
     rank  7: 526.28
     rank  8: 491.62
     rank  9: 490.01
     rank 10: 500.53
     rank 11: 504.62
     rank 12: 465.70
     rank 13: 472.27
     rank 14: 461.54
     rank 15: 461.81
  backward-send-forward-recv:
     rank  4: 87.01
     rank  5: 86.57
     rank  6: 84.89
     rank  7: 88.42
     rank  8: 192.62
     rank  9: 189.58
     rank 10: 185.97
     rank 11: 187.87
     rank 12: 173.76
     rank 13: 169.78
     rank 14: 169.27
     rank 15: 173.36
     rank 16: 177.37
     rank 17: 179.95
     rank 18: 165.70
     rank 19: 171.11
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.06
     rank  3: 0.05
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.05
     rank 17: 0.07
     rank 18: 0.04
     rank 19: 0.08
  all-grads-sync:
     rank  0: 0.62
     rank  1: 0.62
     rank  2: 0.67
     rank  3: 0.66
     rank  4: 2.39
     rank  5: 2.29
     rank  6: 2.30
     rank  7: 2.29
     rank  8: 2.24
     rank  9: 2.22
     rank 10: 2.18
     rank 11: 2.19
     rank 12: 2.17
     rank 13: 2.24
     rank 14: 2.18
     rank 15: 2.17
     rank 16: 2.39
     rank 17: 2.48
     rank 18: 2.30
     rank 19: 2.59
  optimizer-copy-to-main-grad:
     rank  0: 0.16
     rank  1: 0.17
     rank  2: 0.18
     rank  3: 0.18
     rank  4: 0.06
     rank  5: 0.04
     rank  6: 0.03
     rank  7: 0.04
     rank  8: 0.13
     rank  9: 0.06
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.04
     rank 13: 0.05
     rank 14: 0.04
     rank 15: 0.05
     rank 16: 0.05
     rank 17: 0.08
     rank 18: 0.04
     rank 19: 0.07
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.02
     rank 18: 0.01
     rank 19: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.02
     rank 18: 0.01
     rank 19: 0.02
  optimizer-inner-step:
     rank  0: 10.25
     rank  1: 10.29
     rank  2: 10.39
     rank  3: 10.17
     rank  4: 46.42
     rank  5: 46.25
     rank  6: 46.26
     rank  7: 46.35
     rank  8: 43.18
     rank  9: 43.03
     rank 10: 43.03
     rank 11: 43.08
     rank 12: 43.02
     rank 13: 43.07
     rank 14: 43.02
     rank 15: 42.98
     rank 16: 46.30
     rank 17: 46.45
     rank 18: 46.25
     rank 19: 46.51
  optimizer:
     rank  0: 10.98
     rank  1: 11.02
     rank  2: 11.12
     rank  3: 10.90
     rank  4: 47.15
     rank  5: 46.99
     rank  6: 46.99
     rank  7: 47.08
     rank  8: 43.92
     rank  9: 43.77
     rank 10: 43.76
     rank 11: 43.82
     rank 12: 43.74
     rank 13: 43.80
     rank 14: 43.75
     rank 15: 43.70
     rank 16: 47.03
     rank 17: 47.15
     rank 18: 46.98
     rank 19: 47.22
 [2024-12-31 11:45:33] iteration        4/      10 | consumed samples:          128 | elapsed time per iteration (ms): 7807.3 | learning rate: 3.000000E-06 | global batch size:    32 | lm loss: 4.034747E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 7723.56
     rank  1: 7723.54
     rank  2: 7723.50
     rank  3: 7723.58
     rank  4: 7727.04
     rank  5: 7727.01
     rank  6: 7726.94
     rank  7: 7727.05
     rank  8: 7726.92
     rank  9: 7726.76
     rank 10: 7726.70
     rank 11: 7726.81
     rank 12: 7726.83
     rank 13: 7726.77
     rank 14: 7726.67
     rank 15: 7726.77
     rank 16: 7727.10
     rank 17: 7727.09
     rank 18: 7726.91
     rank 19: 7727.08
  forward-compute:
     rank  0: 2250.72
     rank  1: 2240.17
     rank  2: 2253.05
     rank  3: 2251.92
     rank  4: 3049.02
     rank  5: 3056.08
     rank  6: 3055.30
     rank  7: 3048.06
     rank  8: 2941.01
     rank  9: 2940.91
     rank 10: 2944.20
     rank 11: 2945.68
     rank 12: 2923.80
     rank 13: 2928.06
     rank 14: 2936.17
     rank 15: 2930.66
     rank 16: 3097.80
     rank 17: 3100.48
     rank 18: 3114.65
     rank 19: 3104.78
  backward-compute:
     rank  0: 2026.85
     rank  1: 2047.14
     rank  2: 2032.58
     rank  3: 2025.98
     rank  4: 3450.91
     rank  5: 3450.15
     rank  6: 3455.37
     rank  7: 3456.19
     rank  8: 3409.49
     rank  9: 3415.46
     rank 10: 3415.03
     rank 11: 3409.08
     rank 12: 3400.81
     rank 13: 3400.24
     rank 14: 3410.61
     rank 15: 3402.45
     rank 16: 3607.95
     rank 17: 3606.72
     rank 18: 3615.55
     rank 19: 3610.84
  pure-backward-compute:
     rank  0: 2025.36
     rank  1: 2045.36
     rank  2: 2031.25
     rank  3: 2024.69
     rank  4: 3448.83
     rank  5: 3448.34
     rank  6: 3453.72
     rank  7: 3454.53
     rank  8: 3406.39
     rank  9: 3412.67
     rank 10: 3413.65
     rank 11: 3407.61
     rank 12: 3397.91
     rank 13: 3398.11
     rank 14: 3409.12
     rank 15: 3399.76
     rank 16: 3602.15
     rank 17: 3601.42
     rank 18: 3612.99
     rank 19: 3606.96
  batch-generator:
     rank  0: 100.54
     rank  1: 103.79
     rank  2: 111.66
     rank  3: 113.10
     rank  4: 109.95
     rank  5: 126.24
     rank  6: 119.35
     rank  7: 118.03
     rank  8: 105.44
     rank  9: 110.66
     rank 10: 109.88
     rank 11: 112.78
     rank 12: 102.81
     rank 13: 109.01
     rank 14: 109.59
     rank 15: 109.59
     rank 16: 115.73
     rank 17: 120.04
     rank 18: 127.67
     rank 19: 125.60
  forward-recv:
     rank  4: 70.65
     rank  5: 69.50
     rank  6: 70.78
     rank  7: 71.72
     rank  8: 174.57
     rank  9: 173.74
     rank 10: 176.23
     rank 11: 176.18
     rank 12: 267.12
     rank 13: 267.77
     rank 14: 266.36
     rank 15: 266.15
     rank 16: 355.47
     rank 17: 354.91
     rank 18: 355.38
     rank 19: 355.46
  forward-send:
     rank  0: 127.56
     rank  1: 124.33
     rank  2: 126.77
     rank  3: 128.17
     rank  4: 15.60
     rank  5: 14.40
     rank  6: 15.07
     rank  7: 15.22
     rank  8: 10.23
     rank  9: 10.25
     rank 10: 9.05
     rank 11: 9.05
     rank 12: 5.07
     rank 13: 4.47
     rank 14: 4.90
     rank 15: 5.05
  backward-recv:
     rank  0: 613.39
     rank  1: 611.06
     rank  2: 612.41
     rank  3: 613.83
     rank  4: 315.40
     rank  5: 314.37
     rank  6: 315.76
     rank  7: 313.58
     rank  8: 208.45
     rank  9: 208.45
     rank 10: 209.26
     rank 11: 209.72
     rank 12: 104.61
     rank 13: 105.24
     rank 14: 104.86
     rank 15: 104.49
  backward-send:
     rank  4: 10.20
     rank  5: 10.23
     rank  6: 9.23
     rank  7: 10.56
     rank  8: 15.26
     rank  9: 14.88
     rank 10: 14.58
     rank 11: 13.99
     rank 12: 10.24
     rank 13: 9.67
     rank 14: 9.83
     rank 15: 9.87
     rank 16: 5.19
     rank 17: 5.28
     rank 18: 4.80
     rank 19: 4.74
  forward-send-backward-recv:
     rank  0: 2674.64
     rank  1: 2668.89
     rank  2: 2672.16
     rank  3: 2677.59
     rank  4: 568.34
     rank  5: 569.25
     rank  6: 562.58
     rank  7: 563.94
     rank  8: 514.54
     rank  9: 510.46
     rank 10: 520.28
     rank 11: 525.12
     rank 12: 457.45
     rank 13: 462.69
     rank 14: 452.60
     rank 15: 454.32
  backward-send-forward-recv:
     rank  4: 160.93
     rank  5: 157.44
     rank  6: 158.81
     rank  7: 162.52
     rank  8: 253.53
     rank  9: 252.76
     rank 10: 249.09
     rank 11: 248.64
     rank 12: 248.43
     rank 13: 244.28
     rank 14: 241.45
     rank 15: 247.18
     rank 16: 239.13
     rank 17: 239.42
     rank 18: 225.72
     rank 19: 235.46
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.03
     rank 18: 0.01
     rank 19: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.05
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.07
     rank 17: 0.07
     rank 18: 0.04
     rank 19: 0.08
  all-grads-sync:
     rank  0: 0.62
     rank  1: 0.62
     rank  2: 0.64
     rank  3: 0.62
     rank  4: 2.31
     rank  5: 2.29
     rank  6: 2.30
     rank  7: 2.31
     rank  8: 2.27
     rank  9: 2.20
     rank 10: 2.15
     rank 11: 2.16
     rank 12: 2.15
     rank 13: 2.28
     rank 14: 2.19
     rank 15: 2.15
     rank 16: 2.49
     rank 17: 2.49
     rank 18: 2.30
     rank 19: 2.52
  optimizer-copy-to-main-grad:
     rank  0: 0.17
     rank  1: 0.17
     rank  2: 0.16
     rank  3: 0.15
     rank  4: 0.04
     rank  5: 0.04
     rank  6: 0.04
     rank  7: 0.04
     rank  8: 0.06
     rank  9: 0.05
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.05
     rank 13: 0.06
     rank 14: 0.05
     rank 15: 0.05
     rank 16: 0.08
     rank 17: 0.07
     rank 18: 0.04
     rank 19: 0.06
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 10.16
     rank  1: 10.07
     rank  2: 10.24
     rank  3: 10.28
     rank  4: 46.27
     rank  5: 46.22
     rank  6: 46.29
     rank  7: 46.29
     rank  8: 43.18
     rank  9: 43.02
     rank 10: 43.00
     rank 11: 43.02
     rank 12: 43.04
     rank 13: 43.17
     rank 14: 43.08
     rank 15: 43.00
     rank 16: 46.53
     rank 17: 46.37
     rank 18: 46.26
     rank 19: 46.51
  optimizer:
     rank  0: 10.87
     rank  1: 10.78
     rank  2: 10.95
     rank  3: 10.99
     rank  4: 46.98
     rank  5: 46.93
     rank  6: 47.00
     rank  7: 47.00
     rank  8: 43.90
     rank  9: 43.73
     rank 10: 43.71
     rank 11: 43.74
     rank 12: 43.75
     rank 13: 43.88
     rank 14: 43.79
     rank 15: 43.71
     rank 16: 47.25
     rank 17: 47.08
     rank 18: 46.97
     rank 19: 47.23
 [2024-12-31 11:45:40] iteration        5/      10 | consumed samples:          160 | elapsed time per iteration (ms): 7717.6 | learning rate: 3.750000E-06 | global batch size:    32 | lm loss: 3.090088E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 7634.48
     rank  1: 7633.87
     rank  2: 7633.81
     rank  3: 7633.81
     rank  4: 7637.66
     rank  5: 7637.35
     rank  6: 7637.24
     rank  7: 7637.30
     rank  8: 7637.40
     rank  9: 7637.12
     rank 10: 7637.02
     rank 11: 7637.08
     rank 12: 7637.30
     rank 13: 7637.10
     rank 14: 7636.95
     rank 15: 7637.02
     rank 16: 7637.26
     rank 17: 7637.43
     rank 18: 7637.20
     rank 19: 7637.23
  forward-compute:
     rank  0: 2199.22
     rank  1: 2189.10
     rank  2: 2206.40
     rank  3: 2205.23
     rank  4: 3052.08
     rank  5: 3063.11
     rank  6: 3064.99
     rank  7: 3055.65
     rank  8: 2915.49
     rank  9: 2917.10
     rank 10: 2922.24
     rank 11: 2925.42
     rank 12: 2916.64
     rank 13: 2922.80
     rank 14: 2928.09
     rank 15: 2921.62
     rank 16: 3075.39
     rank 17: 3075.88
     rank 18: 3088.19
     rank 19: 3083.39
  backward-compute:
     rank  0: 1983.09
     rank  1: 2004.07
     rank  2: 1991.12
     rank  3: 1982.46
     rank  4: 3446.08
     rank  5: 3447.84
     rank  6: 3452.99
     rank  7: 3457.97
     rank  8: 3409.05
     rank  9: 3415.47
     rank 10: 3412.79
     rank 11: 3406.33
     rank 12: 3404.75
     rank 13: 3401.97
     rank 14: 3411.35
     rank 15: 3406.38
     rank 16: 3610.83
     rank 17: 3609.77
     rank 18: 3617.64
     rank 19: 3615.00
  pure-backward-compute:
     rank  0: 1981.45
     rank  1: 2002.72
     rank  2: 1989.78
     rank  3: 1981.08
     rank  4: 3443.83
     rank  5: 3446.17
     rank  6: 3451.26
     rank  7: 3456.35
     rank  8: 3406.12
     rank  9: 3413.06
     rank 10: 3411.31
     rank 11: 3404.87
     rank 12: 3402.22
     rank 13: 3400.02
     rank 14: 3409.90
     rank 15: 3403.90
     rank 16: 3605.98
     rank 17: 3604.81
     rank 18: 3615.09
     rank 19: 3611.63
  batch-generator:
     rank  0: 99.94
     rank  1: 88.33
     rank  2: 107.97
     rank  3: 107.46
     rank  4: 115.30
     rank  5: 130.40
     rank  6: 128.10
     rank  7: 122.43
     rank  8: 100.66
     rank  9: 103.71
     rank 10: 109.32
     rank 11: 114.40
     rank 12: 96.21
     rank 13: 105.88
     rank 14: 102.41
     rank 15: 102.05
     rank 16: 98.55
     rank 17: 102.21
     rank 18: 109.50
     rank 19: 110.62
  forward-recv:
     rank  4: 66.90
     rank  5: 65.90
     rank  6: 65.89
     rank  7: 65.79
     rank  8: 168.86
     rank  9: 168.20
     rank 10: 168.38
     rank 11: 167.86
     rank 12: 262.99
     rank 13: 263.64
     rank 14: 262.31
     rank 15: 262.03
     rank 16: 352.88
     rank 17: 352.37
     rank 18: 352.83
     rank 19: 352.89
  forward-send:
     rank  0: 127.02
     rank  1: 124.57
     rank  2: 123.21
     rank  3: 122.44
     rank  4: 17.80
     rank  5: 16.86
     rank  6: 15.00
     rank  7: 14.31
     rank  8: 10.24
     rank  9: 10.26
     rank 10: 9.13
     rank 11: 9.01
     rank 12: 5.15
     rank 13: 4.51
     rank 14: 4.97
     rank 15: 5.05
  backward-recv:
     rank  0: 605.26
     rank  1: 603.67
     rank  2: 603.88
     rank  3: 605.50
     rank  4: 308.88
     rank  5: 309.42
     rank  6: 312.11
     rank  7: 308.11
     rank  8: 206.16
     rank  9: 206.29
     rank 10: 206.37
     rank 11: 207.55
     rank 12: 103.66
     rank 13: 104.06
     rank 14: 103.97
     rank 15: 103.56
  backward-send:
     rank  4: 10.77
     rank  5: 10.29
     rank  6: 8.29
     rank  7: 10.49
     rank  8: 15.12
     rank  9: 14.89
     rank 10: 14.84
     rank 11: 13.69
     rank 12: 10.20
     rank 13: 9.83
     rank 14: 9.88
     rank 15: 9.77
     rank 16: 5.18
     rank 17: 5.13
     rank 18: 4.85
     rank 19: 4.71
  forward-send-backward-recv:
     rank  0: 2687.84
     rank  1: 2681.72
     rank  2: 2682.46
     rank  3: 2690.88
     rank  4: 561.79
     rank  5: 561.61
     rank  6: 556.06
     rank  7: 556.12
     rank  8: 533.52
     rank  9: 531.16
     rank 10: 540.05
     rank 11: 545.59
     rank 12: 457.93
     rank 13: 464.68
     rank 14: 455.82
     rank 15: 454.12
  backward-send-forward-recv:
     rank  4: 89.58
     rank  5: 81.90
     rank  6: 82.82
     rank  7: 88.93
     rank  8: 185.49
     rank  9: 183.21
     rank 10: 179.43
     rank 11: 177.82
     rank 12: 172.78
     rank 13: 168.24
     rank 14: 166.94
     rank 15: 173.57
     rank 16: 178.36
     rank 17: 179.80
     rank 18: 168.08
     rank 19: 173.15
  layernorm-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.16
     rank  1: 0.04
     rank  2: 0.05
     rank  3: 0.04
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.03
     rank 16: 0.05
     rank 17: 0.07
     rank 18: 0.04
     rank 19: 0.04
  all-grads-sync:
     rank  0: 1.02
     rank  1: 0.62
     rank  2: 0.67
     rank  3: 0.63
     rank  4: 2.39
     rank  5: 2.34
     rank  6: 2.28
     rank  7: 2.34
     rank  8: 2.22
     rank  9: 2.16
     rank 10: 2.14
     rank 11: 2.15
     rank 12: 2.21
     rank 13: 2.21
     rank 14: 2.14
     rank 15: 2.20
     rank 16: 2.38
     rank 17: 2.47
     rank 18: 2.29
     rank 19: 2.33
  optimizer-copy-to-main-grad:
     rank  0: 0.37
     rank  1: 0.17
     rank  2: 0.17
     rank  3: 0.16
     rank  4: 0.06
     rank  5: 0.05
     rank  6: 0.04
     rank  7: 0.05
     rank  8: 0.06
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.05
     rank 13: 0.05
     rank 14: 0.03
     rank 15: 0.05
     rank 16: 0.06
     rank 17: 0.08
     rank 18: 0.04
     rank 19: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.04
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.02
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.03
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.02
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 11.95
     rank  1: 10.26
     rank  2: 10.26
     rank  3: 10.27
     rank  4: 46.45
     rank  5: 46.31
     rank  6: 46.27
     rank  7: 46.37
     rank  8: 43.10
     rank  9: 42.98
     rank 10: 42.94
     rank 11: 42.96
     rank 12: 43.09
     rank 13: 43.08
     rank 14: 43.01
     rank 15: 43.06
     rank 16: 46.27
     rank 17: 46.48
     rank 18: 46.27
     rank 19: 46.27
  optimizer:
     rank  0: 13.59
     rank  1: 11.83
     rank  2: 11.83
     rank  3: 11.84
     rank  4: 48.03
     rank  5: 47.89
     rank  6: 47.85
     rank  7: 47.96
     rank  8: 44.68
     rank  9: 44.55
     rank 10: 44.52
     rank 11: 44.54
     rank 12: 44.66
     rank 13: 44.67
     rank 14: 44.59
     rank 15: 44.63
     rank 16: 47.85
     rank 17: 48.06
     rank 18: 47.85
     rank 19: 47.85
 [2024-12-31 11:45:48] iteration        6/      10 | consumed samples:          192 | elapsed time per iteration (ms): 7728.2 | learning rate: 4.500000E-06 | global batch size:    32 | lm loss: 1.963167E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 7646.07
     rank  1: 7645.97
     rank  2: 7646.69
     rank  3: 7645.96
     rank  4: 7649.51
     rank  5: 7649.44
     rank  6: 7649.62
     rank  7: 7649.42
     rank  8: 7649.28
     rank  9: 7649.26
     rank 10: 7649.39
     rank 11: 7649.17
     rank 12: 7649.17
     rank 13: 7649.15
     rank 14: 7649.33
     rank 15: 7649.16
     rank 16: 7649.48
     rank 17: 7649.47
     rank 18: 7649.44
     rank 19: 7649.46
  forward-compute:
     rank  0: 2118.78
     rank  1: 2126.53
     rank  2: 2126.73
     rank  3: 2126.88
     rank  4: 3095.03
     rank  5: 3104.30
     rank  6: 3110.00
     rank  7: 3099.56
     rank  8: 2930.89
     rank  9: 2933.99
     rank 10: 2937.97
     rank 11: 2937.37
     rank 12: 2909.82
     rank 13: 2916.26
     rank 14: 2922.28
     rank 15: 2917.37
     rank 16: 3077.13
     rank 17: 3078.43
     rank 18: 3085.43
     rank 19: 3090.11
  backward-compute:
     rank  0: 1718.70
     rank  1: 1718.84
     rank  2: 1724.34
     rank  3: 1715.73
     rank  4: 3444.91
     rank  5: 3447.77
     rank  6: 3454.84
     rank  7: 3453.78
     rank  8: 3410.72
     rank  9: 3418.12
     rank 10: 3417.22
     rank 11: 3411.92
     rank 12: 3406.58
     rank 13: 3404.23
     rank 14: 3412.28
     rank 15: 3410.52
     rank 16: 3609.00
     rank 17: 3607.51
     rank 18: 3615.57
     rank 19: 3613.64
  pure-backward-compute:
     rank  0: 1716.90
     rank  1: 1717.51
     rank  2: 1722.49
     rank  3: 1714.49
     rank  4: 3442.32
     rank  5: 3446.04
     rank  6: 3453.24
     rank  7: 3452.13
     rank  8: 3407.45
     rank  9: 3415.63
     rank 10: 3415.86
     rank 11: 3410.54
     rank 12: 3404.22
     rank 13: 3402.39
     rank 14: 3410.76
     rank 15: 3408.07
     rank 16: 3604.17
     rank 17: 3602.66
     rank 18: 3612.99
     rank 19: 3610.85
  batch-generator:
     rank  0: 93.77
     rank  1: 102.96
     rank  2: 116.64
     rank  3: 111.59
     rank  4: 146.58
     rank  5: 153.24
     rank  6: 153.69
     rank  7: 145.86
     rank  8: 112.07
     rank  9: 113.83
     rank 10: 117.74
     rank 11: 119.16
     rank 12: 90.30
     rank 13: 101.93
     rank 14: 99.73
     rank 15: 101.00
     rank 16: 105.40
     rank 17: 108.06
     rank 18: 110.09
     rank 19: 116.11
  forward-recv:
     rank  4: 70.13
     rank  5: 69.62
     rank  6: 70.09
     rank  7: 69.90
     rank  8: 174.94
     rank  9: 174.46
     rank 10: 176.41
     rank 11: 176.18
     rank 12: 266.29
     rank 13: 266.97
     rank 14: 265.41
     rank 15: 265.31
     rank 16: 354.50
     rank 17: 353.90
     rank 18: 354.51
     rank 19: 354.65
  forward-send:
     rank  0: 131.37
     rank  1: 128.92
     rank  2: 130.05
     rank  3: 129.45
     rank  4: 15.57
     rank  5: 14.66
     rank  6: 15.08
     rank  7: 14.81
     rank  8: 10.15
     rank  9: 10.25
     rank 10: 9.08
     rank 11: 9.01
     rank 12: 5.02
     rank 13: 4.38
     rank 14: 5.00
     rank 15: 5.04
  backward-recv:
     rank  0: 612.95
     rank  1: 614.03
     rank  2: 613.10
     rank  3: 614.76
     rank  4: 304.24
     rank  5: 304.35
     rank  6: 303.98
     rank  7: 303.19
     rank  8: 202.04
     rank  9: 201.96
     rank 10: 203.06
     rank 11: 203.34
     rank 12: 101.83
     rank 13: 102.62
     rank 14: 101.89
     rank 15: 101.59
  backward-send:
     rank  4: 10.55
     rank  5: 9.83
     rank  6: 9.82
     rank  7: 10.57
     rank  8: 15.31
     rank  9: 14.69
     rank 10: 14.58
     rank 11: 14.23
     rank 12: 10.15
     rank 13: 9.40
     rank 14: 9.95
     rank 15: 9.91
     rank 16: 5.20
     rank 17: 5.22
     rank 18: 4.74
     rank 19: 4.58
  forward-send-backward-recv:
     rank  0: 3032.77
     rank  1: 3026.01
     rank  2: 3022.03
     rank  3: 3032.74
     rank  4: 524.23
     rank  5: 525.54
     rank  6: 516.87
     rank  7: 521.52
     rank  8: 498.87
     rank  9: 496.20
     rank 10: 503.30
     rank 11: 507.48
     rank 12: 455.21
     rank 13: 461.00
     rank 14: 454.94
     rank 15: 449.22
  backward-send-forward-recv:
     rank  4: 87.69
     rank  5: 83.23
     rank  6: 78.79
     rank  7: 86.02
     rank  8: 200.02
     rank  9: 197.50
     rank 10: 192.95
     rank 11: 194.90
     rank 12: 181.67
     rank 13: 176.49
     rank 14: 173.01
     rank 15: 178.88
     rank 16: 178.69
     rank 17: 179.81
     rank 18: 172.87
     rank 19: 169.28
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.06
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.14
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.06
     rank 17: 0.06
     rank 18: 0.06
     rank 19: 0.06
  all-grads-sync:
     rank  0: 0.62
     rank  1: 0.61
     rank  2: 0.96
     rank  3: 0.62
     rank  4: 2.35
     rank  5: 2.30
     rank  6: 2.31
     rank  7: 2.33
     rank  8: 2.21
     rank  9: 2.17
     rank 10: 2.14
     rank 11: 2.15
     rank 12: 2.14
     rank 13: 2.15
     rank 14: 2.17
     rank 15: 2.16
     rank 16: 2.38
     rank 17: 2.38
     rank 18: 2.31
     rank 19: 2.37
  optimizer-copy-to-main-grad:
     rank  0: 0.16
     rank  1: 0.16
     rank  2: 0.37
     rank  3: 0.16
     rank  4: 0.05
     rank  5: 0.04
     rank  6: 0.04
     rank  7: 0.04
     rank  8: 0.05
     rank  9: 0.08
     rank 10: 0.04
     rank 11: 0.03
     rank 12: 0.05
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.05
     rank 16: 0.12
     rank 17: 0.06
     rank 18: 0.04
     rank 19: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.04
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.04
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 10.01
     rank  1: 10.21
     rank  2: 10.51
     rank  3: 10.31
     rank  4: 46.34
     rank  5: 46.26
     rank  6: 46.30
     rank  7: 46.33
     rank  8: 43.13
     rank  9: 42.99
     rank 10: 42.95
     rank 11: 42.93
     rank 12: 43.03
     rank 13: 43.03
     rank 14: 42.99
     rank 15: 43.00
     rank 16: 46.30
     rank 17: 46.32
     rank 18: 46.31
     rank 19: 46.37
  optimizer:
     rank  0: 11.57
     rank  1: 11.77
     rank  2: 12.09
     rank  3: 11.88
     rank  4: 47.91
     rank  5: 47.81
     rank  6: 47.86
     rank  7: 47.89
     rank  8: 44.70
     rank  9: 44.55
     rank 10: 44.51
     rank 11: 44.49
     rank 12: 44.59
     rank 13: 44.59
     rank 14: 44.55
     rank 15: 44.57
     rank 16: 47.85
     rank 17: 47.88
     rank 18: 47.86
     rank 19: 47.93
 [2024-12-31 11:45:56] iteration        7/      10 | consumed samples:          224 | elapsed time per iteration (ms): 7725.8 | learning rate: 5.250000E-06 | global batch size:    32 | lm loss: 2.353679E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 7644.49
     rank  1: 7644.49
     rank  2: 7644.58
     rank  3: 7644.60
     rank  4: 7647.94
     rank  5: 7648.01
     rank  6: 7647.92
     rank  7: 7648.05
     rank  8: 7647.74
     rank  9: 7647.75
     rank 10: 7647.70
     rank 11: 7647.76
     rank 12: 7647.68
     rank 13: 7647.69
     rank 14: 7647.63
     rank 15: 7647.70
     rank 16: 7648.01
     rank 17: 7648.04
     rank 18: 7647.83
     rank 19: 7647.85
  forward-compute:
     rank  0: 2450.51
     rank  1: 2463.37
     rank  2: 2463.55
     rank  3: 2461.89
     rank  4: 3061.30
     rank  5: 3069.54
     rank  6: 3068.62
     rank  7: 3060.09
     rank  8: 2926.30
     rank  9: 2928.08
     rank 10: 2930.24
     rank 11: 2932.85
     rank 12: 2930.19
     rank 13: 2944.40
     rank 14: 2940.24
     rank 15: 2936.24
     rank 16: 3073.87
     rank 17: 3076.03
     rank 18: 3082.76
     rank 19: 3089.23
  backward-compute:
     rank  0: 2120.88
     rank  1: 2113.78
     rank  2: 2111.64
     rank  3: 2105.62
     rank  4: 3446.28
     rank  5: 3446.33
     rank  6: 3450.82
     rank  7: 3455.17
     rank  8: 3413.09
     rank  9: 3424.00
     rank 10: 3416.74
     rank 11: 3411.05
     rank 12: 3409.09
     rank 13: 3408.03
     rank 14: 3414.40
     rank 15: 3415.22
     rank 16: 3615.34
     rank 17: 3614.74
     rank 18: 3622.70
     rank 19: 3620.96
  pure-backward-compute:
     rank  0: 2119.24
     rank  1: 2112.38
     rank  2: 2109.60
     rank  3: 2102.63
     rank  4: 3444.25
     rank  5: 3444.55
     rank  6: 3449.14
     rank  7: 3453.15
     rank  8: 3410.14
     rank  9: 3421.63
     rank 10: 3415.26
     rank 11: 3409.67
     rank 12: 3406.43
     rank 13: 3406.54
     rank 14: 3413.02
     rank 15: 3412.79
     rank 16: 3610.26
     rank 17: 3609.94
     rank 18: 3620.19
     rank 19: 3618.15
  batch-generator:
     rank  0: 109.46
     rank  1: 125.04
     rank  2: 143.34
     rank  3: 172.65
     rank  4: 112.92
     rank  5: 125.10
     rank  6: 122.27
     rank  7: 124.82
     rank  8: 104.21
     rank  9: 105.71
     rank 10: 108.54
     rank 11: 113.61
     rank 12: 104.59
     rank 13: 115.65
     rank 14: 107.00
     rank 15: 109.06
     rank 16: 103.15
     rank 17: 107.09
     rank 18: 108.88
     rank 19: 116.63
  forward-recv:
     rank  4: 69.84
     rank  5: 68.76
     rank  6: 70.01
     rank  7: 69.90
     rank  8: 173.61
     rank  9: 172.94
     rank 10: 175.33
     rank 11: 175.17
     rank 12: 266.00
     rank 13: 267.00
     rank 14: 265.23
     rank 15: 265.00
     rank 16: 353.45
     rank 17: 352.63
     rank 18: 353.33
     rank 19: 353.43
  forward-send:
     rank  0: 128.53
     rank  1: 125.40
     rank  2: 128.21
     rank  3: 127.82
     rank  4: 15.56
     rank  5: 14.47
     rank  6: 15.32
     rank  7: 15.19
     rank  8: 10.19
     rank  9: 10.18
     rank 10: 9.03
     rank 11: 8.98
     rank 12: 5.00
     rank 13: 4.16
     rank 14: 4.87
     rank 15: 5.01
  backward-recv:
     rank  0: 579.58
     rank  1: 581.50
     rank  2: 582.26
     rank  3: 582.88
     rank  4: 317.25
     rank  5: 316.86
     rank  6: 317.63
     rank  7: 314.25
     rank  8: 208.06
     rank  9: 207.42
     rank 10: 208.63
     rank 11: 209.31
     rank 12: 103.94
     rank 13: 104.92
     rank 14: 103.87
     rank 15: 103.50
  backward-send:
     rank  4: 9.75
     rank  5: 10.19
     rank  6: 9.41
     rank  7: 11.05
     rank  8: 15.11
     rank  9: 15.09
     rank 10: 14.73
     rank 11: 13.72
     rank 12: 10.23
     rank 13: 9.23
     rank 14: 9.93
     rank 15: 9.90
     rank 16: 5.24
     rank 17: 5.22
     rank 18: 4.60
     rank 19: 4.44
  forward-send-backward-recv:
     rank  0: 2333.46
     rank  1: 2329.35
     rank  2: 2330.23
     rank  3: 2333.16
     rank  4: 553.95
     rank  5: 553.94
     rank  6: 549.06
     rank  7: 547.82
     rank  8: 523.43
     rank  9: 517.11
     rank 10: 529.56
     rank 11: 534.52
     rank 12: 442.00
     rank 13: 450.52
     rank 14: 442.55
     rank 15: 434.78
  backward-send-forward-recv:
     rank  4: 87.05
     rank  5: 82.43
     rank  6: 82.69
     rank  7: 87.43
     rank  8: 178.21
     rank  9: 175.96
     rank 10: 172.98
     rank 11: 171.53
     rank 12: 170.62
     rank 13: 158.84
     rank 14: 166.21
     rank 15: 170.48
     rank 16: 178.18
     rank 17: 178.77
     rank 18: 171.99
     rank 19: 166.59
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.03
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.05
     rank  2: 0.07
     rank  3: 0.07
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.07
     rank 17: 0.07
     rank 18: 0.04
     rank 19: 0.04
  all-grads-sync:
     rank  0: 0.62
     rank  1: 0.67
     rank  2: 0.75
     rank  3: 0.75
     rank  4: 2.29
     rank  5: 2.30
     rank  6: 2.33
     rank  7: 2.34
     rank  8: 2.15
     rank  9: 2.16
     rank 10: 2.19
     rank 11: 2.18
     rank 12: 2.18
     rank 13: 2.15
     rank 14: 2.15
     rank 15: 2.17
     rank 16: 2.45
     rank 17: 2.45
     rank 18: 2.31
     rank 19: 2.34
  optimizer-copy-to-main-grad:
     rank  0: 0.17
     rank  1: 0.21
     rank  2: 0.21
     rank  3: 0.21
     rank  4: 0.04
     rank  5: 0.04
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.05
     rank 13: 0.03
     rank 14: 0.04
     rank 15: 0.05
     rank 16: 0.07
     rank 17: 0.07
     rank 18: 0.05
     rank 19: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 10.23
     rank  1: 10.64
     rank  2: 10.87
     rank  3: 10.74
     rank  4: 46.28
     rank  5: 46.24
     rank  6: 46.33
     rank  7: 46.39
     rank  8: 43.01
     rank  9: 42.98
     rank 10: 43.03
     rank 11: 43.05
     rank 12: 43.02
     rank 13: 43.00
     rank 14: 42.95
     rank 15: 42.99
     rank 16: 46.39
     rank 17: 46.38
     rank 18: 46.33
     rank 19: 46.40
  optimizer:
     rank  0: 11.00
     rank  1: 11.41
     rank  2: 11.65
     rank  3: 11.62
     rank  4: 47.06
     rank  5: 47.02
     rank  6: 47.10
     rank  7: 47.17
     rank  8: 43.78
     rank  9: 43.75
     rank 10: 43.81
     rank 11: 43.83
     rank 12: 43.79
     rank 13: 43.78
     rank 14: 43.72
     rank 15: 43.76
     rank 16: 47.16
     rank 17: 47.12
     rank 18: 47.10
     rank 19: 47.18
 [2024-12-31 11:46:04] iteration        8/      10 | consumed samples:          256 | elapsed time per iteration (ms): 7838.1 | learning rate: 6.000000E-06 | global batch size:    32 | lm loss: 1.931260E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 7754.48
     rank  1: 7754.51
     rank  2: 7754.52
     rank  3: 7754.48
     rank  4: 7757.97
     rank  5: 7757.99
     rank  6: 7757.99
     rank  7: 7758.04
     rank  8: 7757.77
     rank  9: 7757.76
     rank 10: 7757.76
     rank 11: 7757.73
     rank 12: 7757.69
     rank 13: 7757.69
     rank 14: 7757.71
     rank 15: 7757.69
     rank 16: 7757.95
     rank 17: 7758.05
     rank 18: 7758.03
     rank 19: 7757.94
  forward-compute:
     rank  0: 2413.24
     rank  1: 2413.37
     rank  2: 2422.91
     rank  3: 2422.75
     rank  4: 3117.31
     rank  5: 3126.33
     rank  6: 3133.18
     rank  7: 3112.55
     rank  8: 2926.23
     rank  9: 2926.50
     rank 10: 2925.21
     rank 11: 2920.82
     rank 12: 2924.40
     rank 13: 2931.59
     rank 14: 2936.33
     rank 15: 2934.65
     rank 16: 3077.91
     rank 17: 3082.09
     rank 18: 3086.96
     rank 19: 3089.75
  backward-compute:
     rank  0: 2097.34
     rank  1: 2102.60
     rank  2: 2101.01
     rank  3: 2084.01
     rank  4: 3453.99
     rank  5: 3456.01
     rank  6: 3454.77
     rank  7: 3453.70
     rank  8: 3414.97
     rank  9: 3424.28
     rank 10: 3422.90
     rank 11: 3420.75
     rank 12: 3414.57
     rank 13: 3417.25
     rank 14: 3420.31
     rank 15: 3419.44
     rank 16: 3614.63
     rank 17: 3614.28
     rank 18: 3621.65
     rank 19: 3620.52
  pure-backward-compute:
     rank  0: 2095.65
     rank  1: 2101.27
     rank  2: 2099.47
     rank  3: 2082.67
     rank  4: 3451.59
     rank  5: 3454.25
     rank  6: 3453.14
     rank  7: 3450.50
     rank  8: 3412.32
     rank  9: 3419.23
     rank 10: 3421.44
     rank 11: 3419.33
     rank 12: 3412.07
     rank 13: 3415.75
     rank 14: 3418.86
     rank 15: 3416.95
     rank 16: 3609.57
     rank 17: 3609.60
     rank 18: 3618.78
     rank 19: 3617.54
  batch-generator:
     rank  0: 110.64
     rank  1: 113.71
     rank  2: 122.49
     rank  3: 124.65
     rank  4: 120.98
     rank  5: 128.51
     rank  6: 133.69
     rank  7: 146.12
     rank  8: 106.85
     rank  9: 106.62
     rank 10: 106.18
     rank 11: 103.42
     rank 12: 97.37
     rank 13: 101.90
     rank 14: 103.02
     rank 15: 107.55
     rank 16: 102.96
     rank 17: 108.60
     rank 18: 111.10
     rank 19: 114.60
  forward-recv:
     rank  4: 85.53
     rank  5: 84.28
     rank  6: 85.56
     rank  7: 85.52
     rank  8: 189.76
     rank  9: 189.30
     rank 10: 191.35
     rank 11: 191.58
     rank 12: 280.28
     rank 13: 281.01
     rank 14: 279.46
     rank 15: 279.30
     rank 16: 368.17
     rank 17: 367.68
     rank 18: 368.23
     rank 19: 368.24
  forward-send:
     rank  0: 81.53
     rank  1: 79.81
     rank  2: 81.33
     rank  3: 81.58
     rank  4: 15.21
     rank  5: 14.77
     rank  6: 15.19
     rank  7: 15.38
     rank  8: 10.19
     rank  9: 10.27
     rank 10: 9.16
     rank 11: 8.96
     rank 12: 5.06
     rank 13: 4.46
     rank 14: 5.04
     rank 15: 5.04
  backward-recv:
     rank  0: 592.54
     rank  1: 594.46
     rank  2: 593.68
     rank  3: 595.33
     rank  4: 311.40
     rank  5: 311.29
     rank  6: 312.60
     rank  7: 309.30
     rank  8: 208.81
     rank  9: 208.39
     rank 10: 209.61
     rank 11: 210.12
     rank 12: 104.06
     rank 13: 104.61
     rank 14: 104.08
     rank 15: 103.36
  backward-send:
     rank  4: 10.21
     rank  5: 10.22
     rank  6: 8.79
     rank  7: 11.14
     rank  8: 15.18
     rank  9: 14.62
     rank 10: 14.62
     rank 11: 14.13
     rank 12: 10.02
     rank 13: 9.33
     rank 14: 10.01
     rank 15: 10.03
     rank 16: 5.11
     rank 17: 5.14
     rank 18: 4.97
     rank 19: 4.38
  forward-send-backward-recv:
     rank  0: 2538.20
     rank  1: 2533.57
     rank  2: 2529.10
     rank  3: 2544.72
     rank  4: 496.00
     rank  5: 494.08
     rank  6: 492.41
     rank  7: 496.98
     rank  8: 451.50
     rank  9: 449.28
     rank 10: 454.45
     rank 11: 455.55
     rank 12: 404.83
     rank 13: 408.78
     rank 14: 403.85
     rank 15: 398.61
  backward-send-forward-recv:
     rank  4: 175.50
     rank  5: 170.94
     rank  6: 165.57
     rank  7: 177.87
     rank  8: 336.31
     rank  9: 332.84
     rank 10: 335.87
     rank 11: 341.16
     rank 12: 300.16
     rank 13: 294.95
     rank 14: 293.51
     rank 15: 295.67
     rank 16: 265.47
     rank 17: 263.72
     rank 18: 258.52
     rank 19: 257.00
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.05
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.05
     rank 17: 0.06
     rank 18: 0.06
     rank 19: 0.05
  all-grads-sync:
     rank  0: 0.62
     rank  1: 0.63
     rank  2: 0.68
     rank  3: 0.63
     rank  4: 2.30
     rank  5: 2.30
     rank  6: 2.29
     rank  7: 2.35
     rank  8: 2.26
     rank  9: 2.19
     rank 10: 2.17
     rank 11: 2.17
     rank 12: 2.14
     rank 13: 2.19
     rank 14: 2.19
     rank 15: 2.15
     rank 16: 2.42
     rank 17: 2.43
     rank 18: 2.40
     rank 19: 2.39
  optimizer-copy-to-main-grad:
     rank  0: 0.17
     rank  1: 0.18
     rank  2: 0.16
     rank  3: 0.18
     rank  4: 0.04
     rank  5: 0.04
     rank  6: 0.04
     rank  7: 0.05
     rank  8: 0.07
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.05
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.05
     rank 16: 0.06
     rank 17: 0.07
     rank 18: 0.06
     rank 19: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 10.24
     rank  1: 10.01
     rank  2: 10.33
     rank  3: 10.32
     rank  4: 46.26
     rank  5: 46.25
     rank  6: 46.31
     rank  7: 46.39
     rank  8: 43.08
     rank  9: 43.05
     rank 10: 42.96
     rank 11: 42.97
     rank 12: 43.04
     rank 13: 43.05
     rank 14: 43.04
     rank 15: 43.01
     rank 16: 46.36
     rank 17: 46.36
     rank 18: 46.46
     rank 19: 46.40
  optimizer:
     rank  0: 10.91
     rank  1: 10.68
     rank  2: 10.99
     rank  3: 10.99
     rank  4: 46.93
     rank  5: 46.92
     rank  6: 46.98
     rank  7: 47.07
     rank  8: 43.75
     rank  9: 43.72
     rank 10: 43.63
     rank 11: 43.64
     rank 12: 43.70
     rank 13: 43.72
     rank 14: 43.71
     rank 15: 43.68
     rank 16: 47.03
     rank 17: 47.01
     rank 18: 47.14
     rank 19: 47.07
 [2024-12-31 11:46:11] iteration        9/      10 | consumed samples:          288 | elapsed time per iteration (ms): 7814.1 | learning rate: 6.750000E-06 | global batch size:    32 | lm loss: 1.639841E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 7732.53
     rank  1: 7732.58
     rank  2: 7732.52
     rank  3: 7732.50
     rank  4: 7736.01
     rank  5: 7736.06
     rank  6: 7735.99
     rank  7: 7735.95
     rank  8: 7735.85
     rank  9: 7735.83
     rank 10: 7735.73
     rank 11: 7735.72
     rank 12: 7735.76
     rank 13: 7735.76
     rank 14: 7735.69
     rank 15: 7735.67
     rank 16: 7736.07
     rank 17: 7736.03
     rank 18: 7736.00
     rank 19: 7735.92
  forward-compute:
     rank  0: 2178.44
     rank  1: 2194.86
     rank  2: 2194.94
     rank  3: 2185.73
     rank  4: 3086.45
     rank  5: 3096.56
     rank  6: 3097.27
     rank  7: 3086.94
     rank  8: 2935.23
     rank  9: 2938.02
     rank 10: 2939.04
     rank 11: 2938.25
     rank 12: 2933.23
     rank 13: 2943.26
     rank 14: 2944.01
     rank 15: 2941.69
     rank 16: 3086.61
     rank 17: 3089.78
     rank 18: 3092.78
     rank 19: 3107.04
  backward-compute:
     rank  0: 2128.96
     rank  1: 2124.38
     rank  2: 2121.83
     rank  3: 2127.08
     rank  4: 3454.41
     rank  5: 3451.45
     rank  6: 3456.34
     rank  7: 3453.20
     rank  8: 3413.98
     rank  9: 3422.92
     rank 10: 3419.48
     rank 11: 3416.27
     rank 12: 3404.87
     rank 13: 3404.73
     rank 14: 3408.51
     rank 15: 3414.91
     rank 16: 3612.72
     rank 17: 3612.40
     rank 18: 3617.18
     rank 19: 3618.04
  pure-backward-compute:
     rank  0: 2127.54
     rank  1: 2122.63
     rank  2: 2120.60
     rank  3: 2125.71
     rank  4: 3452.36
     rank  5: 3449.83
     rank  6: 3454.59
     rank  7: 3450.69
     rank  8: 3410.72
     rank  9: 3420.25
     rank 10: 3418.15
     rank 11: 3414.85
     rank 12: 3402.05
     rank 13: 3403.40
     rank 14: 3407.15
     rank 15: 3412.45
     rank 16: 3606.81
     rank 17: 3607.56
     rank 18: 3613.54
     rank 19: 3615.29
  batch-generator:
     rank  0: 98.99
     rank  1: 127.15
     rank  2: 122.93
     rank  3: 114.47
     rank  4: 98.51
     rank  5: 115.73
     rank  6: 111.05
     rank  7: 124.47
     rank  8: 106.91
     rank  9: 111.97
     rank 10: 110.61
     rank 11: 111.99
     rank 12: 105.54
     rank 13: 111.64
     rank 14: 108.51
     rank 15: 112.42
     rank 16: 113.92
     rank 17: 115.03
     rank 18: 120.30
     rank 19: 129.67
  forward-recv:
     rank  4: 70.90
     rank  5: 69.29
     rank  6: 70.97
     rank  7: 70.75
     rank  8: 175.66
     rank  9: 174.88
     rank 10: 177.14
     rank 11: 177.48
     rank 12: 265.25
     rank 13: 266.06
     rank 14: 264.60
     rank 15: 264.19
     rank 16: 353.27
     rank 17: 352.70
     rank 18: 353.21
     rank 19: 353.36
  forward-send:
     rank  0: 126.85
     rank  1: 124.19
     rank  2: 126.67
     rank  3: 126.49
     rank  4: 15.26
     rank  5: 14.42
     rank  6: 15.21
     rank  7: 15.28
     rank  8: 10.22
     rank  9: 10.13
     rank 10: 9.22
     rank 11: 8.87
     rank 12: 5.10
     rank 13: 4.45
     rank 14: 4.98
     rank 15: 5.03
  backward-recv:
     rank  0: 605.49
     rank  1: 604.82
     rank  2: 607.62
     rank  3: 605.46
     rank  4: 312.12
     rank  5: 312.56
     rank  6: 310.46
     rank  7: 311.46
     rank  8: 205.81
     rank  9: 205.26
     rank 10: 206.76
     rank 11: 207.16
     rank 12: 103.39
     rank 13: 104.27
     rank 14: 103.43
     rank 15: 103.48
  backward-send:
     rank  4: 10.40
     rank  5: 9.85
     rank  6: 10.82
     rank  7: 10.18
     rank  8: 15.32
     rank  9: 15.00
     rank 10: 14.58
     rank 11: 13.91
     rank 12: 10.17
     rank 13: 9.06
     rank 14: 10.02
     rank 15: 9.94
     rank 16: 5.20
     rank 17: 5.07
     rank 18: 4.78
     rank 19: 4.92
  forward-send-backward-recv:
     rank  0: 2662.34
     rank  1: 2653.52
     rank  2: 2655.04
     rank  3: 2661.68
     rank  4: 521.45
     rank  5: 519.52
     rank  6: 515.00
     rank  7: 517.31
     rank  8: 474.94
     rank  9: 469.43
     rank 10: 479.83
     rank 11: 482.58
     rank 12: 433.19
     rank 13: 441.29
     rank 14: 435.72
     rank 15: 422.30
  backward-send-forward-recv:
     rank  4: 172.19
     rank  5: 171.10
     rank  6: 168.37
     rank  7: 176.34
     rank  8: 297.88
     rank  9: 295.04
     rank 10: 293.76
     rank 11: 295.08
     rank 12: 263.78
     rank 13: 255.69
     rank 14: 258.15
     rank 15: 260.99
     rank 16: 250.03
     rank 17: 250.28
     rank 18: 246.42
     rank 19: 234.34
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.03
     rank 17: 0.04
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.07
     rank 17: 0.09
     rank 18: 0.06
     rank 19: 0.05
  all-grads-sync:
     rank  0: 0.62
     rank  1: 0.62
     rank  2: 0.63
     rank  3: 0.62
     rank  4: 2.32
     rank  5: 2.30
     rank  6: 2.29
     rank  7: 2.31
     rank  8: 2.26
     rank  9: 2.16
     rank 10: 2.14
     rank 11: 2.14
     rank 12: 2.22
     rank 13: 2.15
     rank 14: 2.14
     rank 15: 2.15
     rank 16: 2.44
     rank 17: 2.55
     rank 18: 2.36
     rank 19: 2.34
  optimizer-copy-to-main-grad:
     rank  0: 0.17
     rank  1: 0.17
     rank  2: 0.16
     rank  3: 0.16
     rank  4: 0.05
     rank  5: 0.04
     rank  6: 0.04
     rank  7: 0.04
     rank  8: 0.06
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.06
     rank 13: 0.04
     rank 14: 0.03
     rank 15: 0.04
     rank 16: 0.07
     rank 17: 0.09
     rank 18: 0.05
     rank 19: 0.09
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 10.26
     rank  1: 10.18
     rank  2: 10.10
     rank  3: 10.34
     rank  4: 46.31
     rank  5: 46.25
     rank  6: 46.26
     rank  7: 46.29
     rank  8: 43.15
     rank  9: 43.00
     rank 10: 42.98
     rank 11: 42.98
     rank 12: 43.07
     rank 13: 43.00
     rank 14: 42.98
     rank 15: 42.98
     rank 16: 46.35
     rank 17: 46.41
     rank 18: 46.39
     rank 19: 46.33
  optimizer:
     rank  0: 10.92
     rank  1: 10.84
     rank  2: 10.78
     rank  3: 11.01
     rank  4: 46.98
     rank  5: 46.91
     rank  6: 46.93
     rank  7: 46.95
     rank  8: 43.82
     rank  9: 43.66
     rank 10: 43.64
     rank 11: 43.64
     rank 12: 43.74
     rank 13: 43.66
     rank 14: 43.65
     rank 15: 43.64
     rank 16: 47.01
     rank 17: 47.07
     rank 18: 47.08
     rank 19: 46.99
 [2024-12-31 11:46:19] iteration       10/      10 | consumed samples:          320 | elapsed time per iteration (ms): 7730.4 | learning rate: 7.500000E-06 | global batch size:    32 | lm loss: 2.456248E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 7648.49
     rank  1: 7648.48
     rank  2: 7648.51
     rank  3: 7648.51
     rank  4: 7652.05
     rank  5: 7652.02
     rank  6: 7651.97
     rank  7: 7652.01
     rank  8: 7651.83
     rank  9: 7651.79
     rank 10: 7651.75
     rank 11: 7651.75
     rank 12: 7651.69
     rank 13: 7651.66
     rank 14: 7651.68
     rank 15: 7651.68
     rank 16: 7652.04
     rank 17: 7651.97
     rank 18: 7652.00
     rank 19: 7651.91
  forward-compute:
     rank  0: 1938.67
     rank  1: 1938.18
     rank  2: 1951.93
     rank  3: 1937.62
     rank  4: 3102.98
     rank  5: 3107.72
     rank  6: 3112.61
     rank  7: 3103.85
     rank  8: 2942.29
     rank  9: 2947.58
     rank 10: 2948.10
     rank 11: 2944.60
     rank 12: 2937.15
     rank 13: 2950.30
     rank 14: 2948.61
     rank 15: 2945.67
     rank 16: 3073.37
     rank 17: 3075.42
     rank 18: 3079.24
     rank 19: 3093.36
  backward-compute:
     rank  0: 2128.96
     rank  1: 2135.91
     rank  2: 2124.61
     rank  3: 2134.16
     rank  4: 3445.64
     rank  5: 3452.79
     rank  6: 3455.30
     rank  7: 3449.41
     rank  8: 3415.44
     rank  9: 3425.63
     rank 10: 3420.70
     rank 11: 3415.83
     rank 12: 3403.01
     rank 13: 3401.14
     rank 14: 3405.88
     rank 15: 3412.93
     rank 16: 3614.23
     rank 17: 3614.34
     rank 18: 3619.12
     rank 19: 3619.80
  pure-backward-compute:
     rank  0: 2127.36
     rank  1: 2134.10
     rank  2: 2123.29
     rank  3: 2132.80
     rank  4: 3443.42
     rank  5: 3450.90
     rank  6: 3453.65
     rank  7: 3447.23
     rank  8: 3412.20
     rank  9: 3422.95
     rank 10: 3419.38
     rank 11: 3414.47
     rank 12: 3400.20
     rank 13: 3399.80
     rank 14: 3404.51
     rank 15: 3410.45
     rank 16: 3609.08
     rank 17: 3609.46
     rank 18: 3615.53
     rank 19: 3617.03
  batch-generator:
     rank  0: 91.20
     rank  1: 90.97
     rank  2: 107.48
     rank  3: 94.62
     rank  4: 120.73
     rank  5: 126.73
     rank  6: 127.73
     rank  7: 135.38
     rank  8: 112.70
     rank  9: 118.69
     rank 10: 117.25
     rank 11: 115.68
     rank 12: 108.35
     rank 13: 116.76
     rank 14: 110.86
     rank 15: 112.59
     rank 16: 104.49
     rank 17: 106.66
     rank 18: 113.21
     rank 19: 122.56
  forward-recv:
     rank  4: 68.93
     rank  5: 67.72
     rank  6: 68.84
     rank  7: 69.07
     rank  8: 170.76
     rank  9: 170.13
     rank 10: 172.04
     rank 11: 171.73
     rank 12: 262.25
     rank 13: 263.19
     rank 14: 261.58
     rank 15: 261.43
     rank 16: 353.06
     rank 17: 352.39
     rank 18: 352.94
     rank 19: 353.10
  forward-send:
     rank  0: 130.22
     rank  1: 127.07
     rank  2: 128.64
     rank  3: 128.49
     rank  4: 15.86
     rank  5: 14.89
     rank  6: 14.88
     rank  7: 14.74
     rank  8: 10.23
     rank  9: 10.24
     rank 10: 9.05
     rank 11: 9.16
     rank 12: 5.10
     rank 13: 4.29
     rank 14: 4.87
     rank 15: 5.03
  backward-recv:
     rank  0: 591.40
     rank  1: 591.57
     rank  2: 592.31
     rank  3: 592.62
     rank  4: 313.41
     rank  5: 313.69
     rank  6: 316.01
     rank  7: 312.83
     rank  8: 207.22
     rank  9: 206.88
     rank 10: 208.00
     rank 11: 208.68
     rank 12: 104.28
     rank 13: 105.00
     rank 14: 104.54
     rank 15: 103.82
  backward-send:
     rank  4: 10.67
     rank  5: 10.45
     rank  6: 8.47
     rank  7: 10.66
     rank  8: 15.24
     rank  9: 15.19
     rank 10: 14.67
     rank 11: 13.82
     rank 12: 10.11
     rank 13: 9.41
     rank 14: 9.73
     rank 15: 10.04
     rank 16: 5.19
     rank 17: 5.07
     rank 18: 4.96
     rank 19: 4.51
  forward-send-backward-recv:
     rank  0: 2828.70
     rank  1: 2825.43
     rank  2: 2824.91
     rank  3: 2830.18
     rank  4: 508.58
     rank  5: 504.62
     rank  6: 500.50
     rank  7: 505.51
     rank  8: 477.12
     rank  9: 469.60
     rank 10: 482.77
     rank 11: 486.69
     rank 12: 434.54
     rank 13: 444.13
     rank 14: 437.81
     rank 15: 422.92
  backward-send-forward-recv:
     rank  4: 89.41
     rank  5: 86.49
     rank  6: 82.80
     rank  7: 89.98
     rank  8: 204.55
     rank  9: 199.90
     rank 10: 198.79
     rank 11: 202.99
     rank 12: 176.45
     rank 13: 165.94
     rank 14: 170.59
     rank 15: 174.78
     rank 16: 176.84
     rank 17: 177.34
     rank 18: 172.79
     rank 19: 160.66
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.05
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.07
     rank 17: 0.05
     rank 18: 0.06
     rank 19: 0.05
  all-grads-sync:
     rank  0: 0.62
     rank  1: 0.62
     rank  2: 0.67
     rank  3: 0.63
     rank  4: 2.36
     rank  5: 2.35
     rank  6: 2.29
     rank  7: 2.36
     rank  8: 2.20
     rank  9: 2.20
     rank 10: 2.15
     rank 11: 2.15
     rank 12: 2.15
     rank 13: 2.15
     rank 14: 2.13
     rank 15: 2.15
     rank 16: 2.42
     rank 17: 2.41
     rank 18: 2.36
     rank 19: 2.35
  optimizer-copy-to-main-grad:
     rank  0: 0.17
     rank  1: 0.17
     rank  2: 0.17
     rank  3: 0.16
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.04
     rank  7: 0.05
     rank  8: 0.05
     rank  9: 0.05
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.04
     rank 13: 0.03
     rank 14: 0.04
     rank 15: 0.04
     rank 16: 0.07
     rank 17: 0.06
     rank 18: 0.05
     rank 19: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 10.04
     rank  1: 10.29
     rank  2: 10.48
     rank  3: 10.11
     rank  4: 46.37
     rank  5: 46.34
     rank  6: 46.26
     rank  7: 46.40
     rank  8: 43.08
     rank  9: 43.06
     rank 10: 43.00
     rank 11: 43.01
     rank 12: 43.02
     rank 13: 42.99
     rank 14: 42.97
     rank 15: 42.98
     rank 16: 46.41
     rank 17: 46.32
     rank 18: 46.37
     rank 19: 46.35
  optimizer:
     rank  0: 10.71
     rank  1: 10.95
     rank  2: 11.15
     rank  3: 10.77
     rank  4: 47.04
     rank  5: 47.02
     rank  6: 46.93
     rank  7: 47.08
     rank  8: 43.75
     rank  9: 43.73
     rank 10: 43.67
     rank 11: 43.69
     rank 12: 43.69
     rank 13: 43.66
     rank 14: 43.64
     rank 15: 43.64
     rank 16: 47.08
     rank 17: 46.99
     rank 18: 47.04
     rank 19: 47.02
