examples/multimodal/pretrain-freeze-llm-hete-2080tifirst.sh: line 4: activate: No such file or directory
3
[2024-12-30 23:17:41,011] torch.distributed.run: [WARNING] 
[2024-12-30 23:17:41,011] torch.distributed.run: [WARNING] *****************************************
[2024-12-30 23:17:41,011] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-12-30 23:17:41,011] torch.distributed.run: [WARNING] *****************************************
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:8------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:8------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:8------
------num_pipeline_model_parallel_groups:4------
> setting tensorboard ...
WARNING: one_logger package is required to enable e2e metrics tracking. please go to https://confluence.nvidia.com/display/MLWFO/Package+Repositories for details to install it
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:8------
------num_pipeline_model_parallel_groups:4------
---Rank 12---Tensor Parallel Group GPUs: [0, 0]---Rank 15---Tensor Parallel Group GPUs: [1, 1]---Rank 13---Tensor Parallel Group GPUs: [1, 1]


---Rank 15---Pipeline Parallel Group GPUs: [3, 3, 3, 3]---Rank 12---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
---Rank 13---Pipeline Parallel Group GPUs: [3, 3, 3, 3]

---Rank 14---Tensor Parallel Group GPUs: [0, 0]
[rank15]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank13]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank12]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
---Rank 14---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
[rank14]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
 > number of parameters on (tensor, pipeline) model parallel rank (0, 3): 176173056
 > number of parameters on (tensor, pipeline) model parallel rank (1, 3): 176173056
INFO:megatron.core.distributed.param_and_grad_buffer:Number of buckets for gradient all-reduce / reduce-scatter: 1
Params for bucket 1 (176173056 elements):
	language_model.output_layer.weight
	language_model.decoder.layers.0.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.0.mlp.linear_fc2.weight
	language_model.decoder.layers.0.self_attention.linear_qkv.weight
	language_model.decoder.layers.0.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.final_layernorm.weight
	language_model.decoder.layers.0.mlp.linear_fc1.weight
	language_model.decoder.layers.0.self_attention.linear_proj.weight
rank=0, worker=0: shard_range=[pretrain-0.tar[0, 100), pretrain-0.tar[100, 200), pretrain-0.tar[200, 300), ...<1244>, pretrain-2.tar[4700, 4800), pretrain-2.tar[4800, 4900), pretrain-2.tar[4900, 5000)] sum(count)=125000
rank=0, worker=1: shard_range=[pretrain-2.tar[5000, 5100), pretrain-2.tar[5100, 5200), pretrain-2.tar[5200, 5300), ...<1244>, pretrain-30.tar[9700, 9800), pretrain-30.tar[9800, 9900), pretrain-30.tar[9900, 10000)] sum(count)=125000
rank=1, worker=0: shard_range=[pretrain-31.tar[0, 100), pretrain-31.tar[100, 200), pretrain-31.tar[200, 300), ...<1244>, pretrain-42.tar[4700, 4800), pretrain-42.tar[4800, 4900), pretrain-42.tar[4900, 5000)] sum(count)=125000
rank=1, worker=1: shard_range=[pretrain-42.tar[5000, 5100), pretrain-42.tar[5100, 5200), pretrain-42.tar[5200, 5300), ...<1244>, pretrain-53.tar[9700, 9800), pretrain-53.tar[9800, 9900), pretrain-53.tar[9900, 10000)] sum(count)=125000
rank=0, worker=0: shard_range=[pretrain-54.tar[0, 10000), pretrain-55.tar[0, 4532)] sum(count)=14532
rank=0, worker=1: shard_range=[pretrain-55.tar[4532, 8128), pretrain-6.tar[0, 10000), pretrain-7.tar[0, 936)] sum(count)=14532
rank=1, worker=0: shard_range=[pretrain-7.tar[936, 10000), pretrain-8.tar[0, 5468)] sum(count)=14532
rank=1, worker=1: shard_range=[pretrain-8.tar[5468, 10000), pretrain-9.tar[0, 10000)] sum(count)=14532
times across ranks (ms):
  model-and-optimizer-setup:
     rank  0: 94.27
     rank  1: 96.15
     rank  2: 98.30
     rank  3: 95.32
     rank  4: 36.91
     rank  5: 36.86
     rank  6: 36.85
     rank  7: 41.38
     rank  8: 24.78
     rank  9: 24.83
     rank 10: 43.84
     rank 11: 28.85
     rank 12: 42.91
     rank 13: 43.36
     rank 14: 43.44
     rank 15: 43.19
  train/valid/test-data-iterators-setup:
     rank  0: 1233.51
     rank  1: 1234.03
     rank  2: 1453.65
     rank  3: 1234.05
     rank  4: 1233.52
     rank  5: 1233.52
     rank  6: 1233.59
     rank  7: 1233.56
     rank  8: 1233.67
     rank  9: 1233.85
     rank 10: 1268.15
     rank 11: 1268.00
     rank 12: 1267.87
     rank 13: 1267.84
     rank 14: 1267.86
     rank 15: 1267.85
 [2024-12-30 23:18:29] iteration        1/      10 | consumed samples:           32 | elapsed time per iteration (ms): 13486.8 | learning rate: 7.500000E-07 | global batch size:    32 | lm loss: 7.093583E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |[Rank 13] (after 1 iterations) memory (MB) | allocated: 2741.4404296875 | max allocated: 3413.353515625 | reserved: 3668.0 | max reserved: 3668.0

stage4 GPU utialization:30.303209478204902 %
[Rank 12] (after 1 iterations) memory (MB) | allocated: 2741.4404296875 | max allocated: 3413.353515625 | reserved: 3668.0 | max reserved: 3668.0
times across ranks (ms):
  forward-backward:
     rank  0: 13384.00
     rank  1: 13384.07
     rank  2: 13383.95
     rank  3: 13383.92
     rank  4: 13385.15
     rank  5: 13385.09
     rank  6: 13385.16
     rank  7: 13385.10
     rank  8: 13383.51
     rank  9: 13383.27
     rank 10: 13383.57
     rank 11: 13383.28
     rank 12: 13381.45
     rank 13: 13381.53
     rank 14: 13381.69
     rank 15: 13381.52
  forward-compute:
     rank  0: 3959.68
     rank  1: 3970.57
     rank  2: 4030.89
     rank  3: 3993.34
     rank  4: 3110.39
     rank  5: 3124.80
     rank  6: 3253.29
     rank  7: 3225.68
     rank  8: 3267.24
     rank  9: 3271.20
     rank 10: 3204.28
     rank 11: 3204.28
     rank 12: 2282.11
     rank 13: 2299.66
     rank 14: 2270.18
     rank 15: 2288.67
  backward-compute:
     rank  0: 2271.61
     rank  1: 2270.24
     rank  2: 2316.89
     rank  3: 2314.60
     rank  4: 1826.57
     rank  5: 1827.05
     rank  6: 1854.52
     rank  7: 1850.00
     rank  8: 1467.36
     rank  9: 1469.14
     rank 10: 1461.20
     rank 11: 1467.34
     rank 12: 1225.17
     rank 13: 1212.62
     rank 14: 1218.19
     rank 15: 1205.77
  pure-backward-compute:
     rank  0: 2270.34
     rank  1: 2268.98
     rank  2: 2315.68
     rank  3: 2313.69
     rank  4: 1824.04
     rank  5: 1825.69
     rank  6: 1852.71
     rank  7: 1848.40
     rank  8: 1465.82
     rank  9: 1467.32
     rank 10: 1459.50
     rank 11: 1465.82
     rank 12: 1222.04
     rank 13: 1210.23
     rank 14: 1215.57
     rank 15: 1203.63
  batch-generator:
     rank  0: 1146.50
     rank  1: 1167.78
     rank  2: 1321.48
     rank  3: 1276.31
     rank  4: 1086.64
     rank  5: 1097.07
     rank  6: 906.05
     rank  7: 878.43
     rank  8: 1128.53
     rank  9: 1136.23
     rank 10: 1203.96
     rank 11: 1200.24
     rank 12: 1057.59
     rank 13: 1063.93
     rank 14: 1151.99
     rank 15: 1163.90
  forward-recv:
     rank  4: 2591.79
     rank  5: 2589.92
     rank  6: 2698.21
     rank  7: 2723.75
     rank  8: 4492.78
     rank  9: 4495.47
     rank 10: 4738.89
     rank 11: 4741.50
     rank 12: 6819.06
     rank 13: 6812.66
     rank 14: 7021.39
     rank 15: 7019.04
  forward-send:
     rank  0: 4183.56
     rank  1: 4177.48
     rank  2: 4258.78
     rank  3: 4295.57
     rank  4: 2267.48
     rank  5: 2263.67
     rank  6: 2221.65
     rank  7: 2222.67
     rank  8: 27.60
     rank  9: 21.43
     rank 10: 26.30
     rank 11: 24.23
  backward-recv:
     rank  0: 269.71
     rank  1: 271.00
     rank  2: 292.85
     rank  3: 296.02
     rank  4: 69.88
     rank  5: 71.29
     rank  6: 83.57
     rank  7: 84.65
     rank  8: 36.79
     rank  9: 36.35
     rank 10: 53.97
     rank 11: 52.92
  backward-send:
     rank  4: 1.70
     rank  5: 1.00
     rank  6: 1.38
     rank  7: 1.32
     rank  8: 7.77
     rank  9: 7.52
     rank 10: 7.95
     rank 11: 7.67
     rank 12: 5.04
     rank 13: 4.69
     rank 14: 5.18
     rank 15: 4.19
  forward-send-backward-recv:
     rank  0: 2005.04
     rank  1: 2004.94
     rank  2: 1789.21
     rank  3: 1793.73
     rank  4: 1720.44
     rank  5: 1719.57
     rank  6: 1504.79
     rank  7: 1505.61
     rank  8: 1679.03
     rank  9: 1678.56
     rank 10: 1457.82
     rank 11: 1458.37
  backward-send-forward-recv:
     rank  4: 1035.18
     rank  5: 1029.32
     rank  6: 1007.85
     rank  7: 1010.35
     rank  8: 1533.69
     rank  9: 1532.21
     rank 10: 1557.44
     rank 11: 1557.41
     rank 12: 2086.05
     rank 13: 2088.36
     rank 14: 1902.49
     rank 15: 1899.16
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.10
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.04
     rank  9: 0.02
     rank 10: 0.06
     rank 11: 0.05
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.04
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.08
     rank  2: 0.04
     rank  3: 0.03
     rank  4: 0.09
     rank  5: 0.06
     rank  6: 0.09
     rank  7: 0.07
     rank  8: 0.05
     rank  9: 0.03
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.08
     rank 13: 0.08
     rank 14: 0.09
     rank 15: 0.08
  all-grads-sync:
     rank  0: 213.97
     rank  1: 218.96
     rank  2: 213.88
     rank  3: 218.79
     rank  4: 664.89
     rank  5: 660.69
     rank  6: 664.88
     rank  7: 660.67
     rank  8: 502.86
     rank  9: 498.85
     rank 10: 502.87
     rank 11: 498.03
     rank 12: 304.36
     rank 13: 293.81
     rank 14: 304.35
     rank 15: 293.85
  optimizer-copy-to-main-grad:
     rank  0: 0.42
     rank  1: 0.30
     rank  2: 0.30
     rank  3: 0.30
     rank  4: 0.07
     rank  5: 0.05
     rank  6: 0.09
     rank  7: 0.09
     rank  8: 0.08
     rank  9: 0.05
     rank 10: 0.09
     rank 11: 0.06
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.05
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.04
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 46.99
     rank  1: 47.38
     rank  2: 46.84
     rank  3: 46.68
     rank  4: 95.34
     rank  5: 94.69
     rank  6: 95.68
     rank  7: 95.38
     rank  8: 69.95
     rank  9: 69.16
     rank 10: 69.27
     rank 11: 69.57
     rank 12: 51.52
     rank 13: 52.18
     rank 14: 51.56
     rank 15: 52.10
  optimizer:
     rank  0: 48.35
     rank  1: 48.74
     rank  2: 48.21
     rank  3: 48.04
     rank  4: 96.71
     rank  5: 96.06
     rank  6: 97.05
     rank  7: 96.76
     rank  8: 71.32
     rank  9: 70.52
     rank 10: 70.64
     rank 11: 70.93
     rank 12: 52.89
     rank 13: 53.55
     rank 14: 52.93
     rank 15: 53.47
 [2024-12-30 23:18:33] iteration        2/      10 | consumed samples:           64 | elapsed time per iteration (ms): 4543.0 | learning rate: 1.500000E-06 | global batch size:    32 | lm loss: 7.094902E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4430.93
     rank  1: 4430.99
     rank  2: 4430.89
     rank  3: 4430.92
     rank  4: 4435.73
     rank  5: 4435.73
     rank  6: 4435.78
     rank  7: 4435.75
     rank  8: 4434.13
     rank  9: 4433.74
     rank 10: 4434.02
     rank 11: 4433.82
     rank 12: 4431.94
     rank 13: 4431.98
     rank 14: 4431.93
     rank 15: 4431.92
  forward-compute:
     rank  0: 1783.97
     rank  1: 1790.73
     rank  2: 1665.42
     rank  3: 1663.09
     rank  4: 1286.81
     rank  5: 1290.87
     rank  6: 1282.84
     rank  7: 1283.52
     rank  8: 1022.01
     rank  9: 1022.99
     rank 10: 1017.83
     rank 11: 1019.98
     rank 12: 803.27
     rank 13: 804.38
     rank 14: 1160.83
     rank 15: 1181.74
  backward-compute:
     rank  0: 1303.87
     rank  1: 1297.74
     rank  2: 1267.49
     rank  3: 1270.24
     rank  4: 1826.94
     rank  5: 1827.92
     rank  6: 1848.37
     rank  7: 1849.51
     rank  8: 1466.15
     rank  9: 1468.37
     rank 10: 1461.27
     rank 11: 1480.05
     rank 12: 1193.68
     rank 13: 1190.16
     rank 14: 1194.21
     rank 15: 1192.81
  pure-backward-compute:
     rank  0: 1302.80
     rank  1: 1296.86
     rank  2: 1266.56
     rank  3: 1269.40
     rank  4: 1825.76
     rank  5: 1826.96
     rank  6: 1847.33
     rank  7: 1848.52
     rank  8: 1464.75
     rank  9: 1466.64
     rank 10: 1458.01
     rank 11: 1478.57
     rank 12: 1190.62
     rank 13: 1188.17
     rank 14: 1191.53
     rank 15: 1190.94
  batch-generator:
     rank  0: 77.90
     rank  1: 86.54
     rank  2: 66.63
     rank  3: 66.31
     rank  4: 69.22
     rank  5: 70.90
     rank  6: 61.20
     rank  7: 62.31
     rank  8: 62.18
     rank  9: 63.89
     rank 10: 71.14
     rank 11: 70.34
     rank 12: 64.90
     rank 13: 64.20
     rank 14: 65.79
     rank 15: 87.57
  forward-recv:
     rank  4: 125.40
     rank  5: 125.76
     rank  6: 99.28
     rank  7: 99.70
     rank  8: 214.61
     rank  9: 213.34
     rank 10: 182.61
     rank 11: 182.59
     rank 12: 261.75
     rank 13: 262.30
     rank 14: 238.75
     rank 15: 238.69
  forward-send:
     rank  0: 1.45
     rank  1: 1.44
     rank  2: 1.47
     rank  3: 1.49
     rank  4: 5.88
     rank  5: 5.53
     rank  6: 5.71
     rank  7: 5.63
     rank  8: 4.13
     rank  9: 5.05
     rank 10: 2.93
     rank 11: 2.78
  backward-recv:
     rank  0: 275.27
     rank  1: 277.45
     rank  2: 290.72
     rank  3: 291.53
     rank  4: 69.98
     rank  5: 69.22
     rank  6: 103.15
     rank  7: 102.60
     rank  8: 36.50
     rank  9: 35.76
     rank 10: 73.92
     rank 11: 74.65
  backward-send:
     rank  4: 1.19
     rank  5: 1.11
     rank  6: 1.02
     rank  7: 1.01
     rank  8: 7.84
     rank  9: 7.21
     rank 10: 7.44
     rank 11: 7.11
     rank 12: 4.93
     rank 13: 3.89
     rank 14: 5.03
     rank 15: 4.80
  forward-send-backward-recv:
     rank  0: 433.69
     rank  1: 435.88
     rank  2: 581.69
     rank  3: 580.34
     rank  4: 180.94
     rank  5: 180.14
     rank  6: 195.52
     rank  7: 194.60
     rank  8: 161.67
     rank  9: 161.09
     rank 10: 177.62
     rank 11: 165.60
  backward-send-forward-recv:
     rank  4: 238.36
     rank  5: 236.06
     rank  6: 199.62
     rank  7: 198.73
     rank  8: 708.92
     rank  9: 707.03
     rank 10: 691.11
     rank 11: 690.26
     rank 12: 1262.77
     rank 13: 1266.05
     rank 14: 927.95
     rank 15: 910.19
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.04
     rank  7: 0.02
     rank  8: 0.08
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.07
     rank  5: 0.05
     rank  6: 0.10
     rank  7: 0.06
     rank  8: 0.08
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.07
     rank 13: 0.08
     rank 14: 0.07
     rank 15: 0.06
  all-grads-sync:
     rank  0: 129.00
     rank  1: 124.29
     rank  2: 128.98
     rank  3: 124.23
     rank  4: 605.08
     rank  5: 605.26
     rank  6: 605.01
     rank  7: 605.23
     rank  8: 432.81
     rank  9: 432.88
     rank 10: 432.81
     rank 11: 432.85
     rank 12: 293.17
     rank 13: 281.17
     rank 14: 293.16
     rank 15: 281.19
  optimizer-copy-to-main-grad:
     rank  0: 0.39
     rank  1: 0.25
     rank  2: 0.24
     rank  3: 0.24
     rank  4: 0.05
     rank  5: 0.04
     rank  6: 0.06
     rank  7: 0.05
     rank  8: 0.17
     rank  9: 0.04
     rank 10: 0.17
     rank 11: 0.04
     rank 12: 0.03
     rank 13: 0.05
     rank 14: 0.03
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.04
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 25.12
     rank  1: 25.20
     rank  2: 25.09
     rank  3: 24.89
     rank  4: 74.45
     rank  5: 74.43
     rank  6: 74.65
     rank  7: 74.65
     rank  8: 54.46
     rank  9: 53.67
     rank 10: 53.86
     rank 11: 53.67
     rank 12: 33.68
     rank 13: 33.70
     rank 14: 33.67
     rank 15: 33.69
  optimizer:
     rank  0: 26.16
     rank  1: 26.24
     rank  2: 26.13
     rank  3: 25.93
     rank  4: 75.51
     rank  5: 75.47
     rank  6: 75.70
     rank  7: 75.69
     rank  8: 55.50
     rank  9: 54.71
     rank 10: 54.93
     rank 11: 54.72
     rank 12: 34.72
     rank 13: 34.74
     rank 14: 34.72
     rank 15: 34.73
 [2024-12-30 23:18:38] iteration        3/      10 | consumed samples:           96 | elapsed time per iteration (ms): 4298.3 | learning rate: 2.250000E-06 | global batch size:    32 | lm loss: 6.725246E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4190.76
     rank  1: 4190.90
     rank  2: 4190.79
     rank  3: 4190.82
     rank  4: 4195.52
     rank  5: 4195.51
     rank  6: 4195.57
     rank  7: 4195.48
     rank  8: 4193.59
     rank  9: 4193.64
     rank 10: 4193.64
     rank 11: 4193.59
     rank 12: 4191.92
     rank 13: 4191.74
     rank 14: 4192.10
     rank 15: 4191.73
  forward-compute:
     rank  0: 1528.90
     rank  1: 1533.82
     rank  2: 1428.03
     rank  3: 1429.70
     rank  4: 1289.25
     rank  5: 1292.79
     rank  6: 1264.36
     rank  7: 1264.27
     rank  8: 1019.40
     rank  9: 1019.79
     rank 10: 993.70
     rank 11: 995.83
     rank 12: 810.68
     rank 13: 809.73
     rank 14: 998.54
     rank 15: 1019.07
  backward-compute:
     rank  0: 1228.12
     rank  1: 1223.21
     rank  2: 1309.81
     rank  3: 1306.22
     rank  4: 1831.53
     rank  5: 1833.78
     rank  6: 1857.87
     rank  7: 1856.62
     rank  8: 1470.41
     rank  9: 1470.49
     rank 10: 1468.51
     rank 11: 1487.46
     rank 12: 1195.38
     rank 13: 1192.54
     rank 14: 1200.36
     rank 15: 1199.17
  pure-backward-compute:
     rank  0: 1227.04
     rank  1: 1222.37
     rank  2: 1308.83
     rank  3: 1305.35
     rank  4: 1829.99
     rank  5: 1832.66
     rank  6: 1856.77
     rank  7: 1855.62
     rank  8: 1469.29
     rank  9: 1468.92
     rank 10: 1465.97
     rank 11: 1486.28
     rank 12: 1191.35
     rank 13: 1190.32
     rank 14: 1197.62
     rank 15: 1197.38
  batch-generator:
     rank  0: 72.91
     rank  1: 79.52
     rank  2: 62.17
     rank  3: 66.05
     rank  4: 71.32
     rank  5: 71.14
     rank  6: 48.62
     rank  7: 50.16
     rank  8: 57.79
     rank  9: 61.40
     rank 10: 55.11
     rank 11: 53.84
     rank 12: 62.24
     rank 13: 61.91
     rank 14: 64.78
     rank 15: 85.51
  forward-recv:
     rank  4: 114.38
     rank  5: 114.34
     rank  6: 97.10
     rank  7: 97.08
     rank  8: 198.30
     rank  9: 199.81
     rank 10: 189.98
     rank 11: 190.66
     rank 12: 241.07
     rank 13: 241.18
     rank 14: 231.25
     rank 15: 231.03
  forward-send:
     rank  0: 1.44
     rank  1: 1.37
     rank  2: 1.34
     rank  3: 1.43
     rank  4: 5.64
     rank  5: 5.50
     rank  6: 5.82
     rank  7: 5.89
     rank  8: 4.72
     rank  9: 5.02
     rank 10: 2.65
     rank 11: 2.28
  backward-recv:
     rank  0: 282.47
     rank  1: 285.24
     rank  2: 281.75
     rank  3: 283.11
     rank  4: 68.78
     rank  5: 68.56
     rank  6: 84.55
     rank  7: 85.31
     rank  8: 36.67
     rank  9: 34.67
     rank 10: 59.51
     rank 11: 60.08
  backward-send:
     rank  4: 1.23
     rank  5: 1.09
     rank  6: 1.27
     rank  7: 0.98
     rank  8: 7.00
     rank  9: 6.72
     rank 10: 7.37
     rank 11: 6.91
     rank 12: 4.65
     rank 13: 4.84
     rank 14: 4.73
     rank 15: 4.64
  forward-send-backward-recv:
     rank  0: 522.78
     rank  1: 525.38
     rank  2: 555.54
     rank  3: 555.43
     rank  4: 179.15
     rank  5: 177.80
     rank  6: 184.61
     rank  7: 184.92
     rank  8: 156.00
     rank  9: 157.94
     rank 10: 152.24
     rank 11: 143.20
  backward-send-forward-recv:
     rank  4: 12.67
     rank  5: 10.71
     rank  6: 10.09
     rank  7: 10.40
     rank  8: 498.22
     rank  9: 494.82
     rank 10: 507.89
     rank 11: 506.88
     rank 12: 1042.58
     rank 13: 1047.92
     rank 14: 860.36
     rank 15: 843.30
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.11
     rank  2: 0.03
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.04
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.04
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.07
     rank 15: 0.04
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.05
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.06
     rank  7: 0.06
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.07
     rank 13: 0.08
     rank 14: 0.16
     rank 15: 0.09
  all-grads-sync:
     rank  0: 128.63
     rank  1: 126.46
     rank  2: 128.64
     rank  3: 126.35
     rank  4: 595.02
     rank  5: 595.13
     rank  6: 595.04
     rank  7: 595.11
     rank  8: 427.67
     rank  9: 427.93
     rank 10: 427.57
     rank 11: 427.99
     rank 12: 282.77
     rank 13: 270.80
     rank 14: 282.53
     rank 15: 270.74
  optimizer-copy-to-main-grad:
     rank  0: 0.38
     rank  1: 0.25
     rank  2: 0.24
     rank  3: 0.25
     rank  4: 0.04
     rank  5: 0.04
     rank  6: 0.04
     rank  7: 0.04
     rank  8: 0.08
     rank  9: 0.05
     rank 10: 0.05
     rank 11: 0.08
     rank 12: 0.03
     rank 13: 0.04
     rank 14: 0.09
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.06
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 25.07
     rank  1: 25.35
     rank  2: 25.05
     rank  3: 25.38
     rank  4: 74.69
     rank  5: 74.40
     rank  6: 74.49
     rank  7: 74.48
     rank  8: 53.75
     rank  9: 53.63
     rank 10: 53.68
     rank 11: 54.11
     rank 12: 33.68
     rank 13: 33.84
     rank 14: 34.38
     rank 15: 33.80
  optimizer:
     rank  0: 26.23
     rank  1: 26.51
     rank  2: 26.21
     rank  3: 26.54
     rank  4: 75.86
     rank  5: 75.56
     rank  6: 75.65
     rank  7: 75.64
     rank  8: 54.90
     rank  9: 54.80
     rank 10: 54.85
     rank 11: 55.27
     rank 12: 34.84
     rank 13: 35.00
     rank 14: 35.55
     rank 15: 34.96
 [2024-12-30 23:18:42] iteration        4/      10 | consumed samples:          128 | elapsed time per iteration (ms): 4317.9 | learning rate: 3.000000E-06 | global batch size:    32 | lm loss: 3.586453E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4211.01
     rank  1: 4211.12
     rank  2: 4210.96
     rank  3: 4211.01
     rank  4: 4215.73
     rank  5: 4215.75
     rank  6: 4215.72
     rank  7: 4215.72
     rank  8: 4213.97
     rank  9: 4213.89
     rank 10: 4213.89
     rank 11: 4213.83
     rank 12: 4212.15
     rank 13: 4211.89
     rank 14: 4212.14
     rank 15: 4211.86
  forward-compute:
     rank  0: 1555.51
     rank  1: 1557.97
     rank  2: 1510.58
     rank  3: 1518.16
     rank  4: 1274.55
     rank  5: 1275.62
     rank  6: 1276.21
     rank  7: 1276.26
     rank  8: 1016.23
     rank  9: 1016.49
     rank 10: 1015.41
     rank 11: 1017.80
     rank 12: 888.43
     rank 13: 878.39
     rank 14: 833.64
     rank 15: 845.38
  backward-compute:
     rank  0: 1261.01
     rank  1: 1256.44
     rank  2: 1300.45
     rank  3: 1292.03
     rank  4: 1839.95
     rank  5: 1839.86
     rank  6: 1854.54
     rank  7: 1854.17
     rank  8: 1481.23
     rank  9: 1472.52
     rank 10: 1469.81
     rank 11: 1478.76
     rank 12: 1197.72
     rank 13: 1192.85
     rank 14: 1209.28
     rank 15: 1207.50
  pure-backward-compute:
     rank  0: 1259.83
     rank  1: 1255.54
     rank  2: 1299.14
     rank  3: 1291.08
     rank  4: 1838.45
     rank  5: 1838.65
     rank  6: 1853.33
     rank  7: 1852.97
     rank  8: 1479.73
     rank  9: 1470.61
     rank 10: 1467.89
     rank 11: 1477.81
     rank 12: 1192.02
     rank 13: 1190.51
     rank 14: 1206.67
     rank 15: 1205.77
  batch-generator:
     rank  0: 89.52
     rank  1: 91.71
     rank  2: 76.10
     rank  3: 86.87
     rank  4: 62.24
     rank  5: 62.45
     rank  6: 54.83
     rank  7: 57.18
     rank  8: 50.70
     rank  9: 54.10
     rank 10: 70.72
     rank 11: 65.74
     rank 12: 86.55
     rank 13: 74.15
     rank 14: 62.25
     rank 15: 73.90
  forward-recv:
     rank  4: 114.23
     rank  5: 114.00
     rank  6: 108.75
     rank  7: 108.60
     rank  8: 196.13
     rank  9: 195.06
     rank 10: 194.12
     rank 11: 194.48
     rank 12: 238.34
     rank 13: 238.66
     rank 14: 228.72
     rank 15: 228.57
  forward-send:
     rank  0: 1.41
     rank  1: 1.34
     rank  2: 1.46
     rank  3: 1.43
     rank  4: 5.58
     rank  5: 5.54
     rank  6: 5.54
     rank  7: 5.56
     rank  8: 4.21
     rank  9: 5.13
     rank 10: 2.83
     rank 11: 2.50
  backward-recv:
     rank  0: 269.15
     rank  1: 271.11
     rank  2: 269.32
     rank  3: 270.73
     rank  4: 73.40
     rank  5: 74.04
     rank  6: 72.43
     rank  7: 72.16
     rank  8: 35.56
     rank  9: 33.64
     rank 10: 39.36
     rank 11: 40.25
  backward-send:
     rank  4: 1.13
     rank  5: 1.00
     rank  6: 1.32
     rank  7: 1.13
     rank  8: 6.94
     rank  9: 7.54
     rank 10: 7.83
     rank 11: 7.25
     rank 12: 4.83
     rank 13: 3.63
     rank 14: 4.85
     rank 15: 4.72
  forward-send-backward-recv:
     rank  0: 487.90
     rank  1: 493.97
     rank  2: 505.34
     rank  3: 506.62
     rank  4: 186.33
     rank  5: 186.18
     rank  6: 180.77
     rank  7: 182.25
     rank  8: 163.28
     rank  9: 172.88
     rank 10: 180.71
     rank 11: 176.34
  backward-send-forward-recv:
     rank  4: 11.43
     rank  5: 11.37
     rank  6: 10.68
     rank  7: 10.44
     rank  8: 494.81
     rank  9: 493.47
     rank 10: 485.45
     rank 11: 484.42
     rank 12: 972.34
     rank 13: 989.36
     rank 14: 1026.81
     rank 15: 1018.61
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.07
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.06
     rank 13: 0.03
     rank 14: 0.05
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.06
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.03
     rank  9: 0.04
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.14
     rank 13: 0.06
     rank 14: 0.08
     rank 15: 0.07
  all-grads-sync:
     rank  0: 127.21
     rank  1: 124.59
     rank  2: 127.16
     rank  3: 124.43
     rank  4: 603.77
     rank  5: 603.79
     rank  6: 603.77
     rank  7: 603.77
     rank  8: 430.72
     rank  9: 430.77
     rank 10: 430.71
     rank 11: 430.79
     rank 12: 292.08
     rank 13: 280.56
     rank 14: 292.17
     rank 15: 280.48
  optimizer-copy-to-main-grad:
     rank  0: 0.41
     rank  1: 0.29
     rank  2: 0.25
     rank  3: 0.27
     rank  4: 0.04
     rank  5: 0.04
     rank  6: 0.04
     rank  7: 0.04
     rank  8: 0.17
     rank  9: 0.07
     rank 10: 0.06
     rank 11: 0.04
     rank 12: 0.07
     rank 13: 0.03
     rank 14: 0.07
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 25.37
     rank  1: 25.60
     rank  2: 25.43
     rank  3: 25.21
     rank  4: 74.44
     rank  5: 74.42
     rank  6: 74.49
     rank  7: 74.59
     rank  8: 53.72
     rank  9: 53.78
     rank 10: 53.69
     rank 11: 53.56
     rank 12: 33.86
     rank 13: 33.71
     rank 14: 33.87
     rank 15: 33.68
  optimizer:
     rank  0: 26.39
     rank  1: 26.61
     rank  2: 26.45
     rank  3: 26.22
     rank  4: 75.45
     rank  5: 75.43
     rank  6: 75.51
     rank  7: 75.62
     rank  8: 54.73
     rank  9: 54.79
     rank 10: 54.69
     rank 11: 54.56
     rank 12: 34.88
     rank 13: 34.73
     rank 14: 34.93
     rank 15: 34.70
 [2024-12-30 23:18:46] iteration        5/      10 | consumed samples:          160 | elapsed time per iteration (ms): 4328.8 | learning rate: 3.750000E-06 | global batch size:    32 | lm loss: 2.921817E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4222.30
     rank  1: 4222.21
     rank  2: 4222.25
     rank  3: 4222.21
     rank  4: 4227.03
     rank  5: 4226.99
     rank  6: 4227.03
     rank  7: 4227.05
     rank  8: 4225.17
     rank  9: 4225.03
     rank 10: 4225.12
     rank 11: 4225.10
     rank 12: 4223.44
     rank 13: 4223.22
     rank 14: 4223.35
     rank 15: 4223.27
  forward-compute:
     rank  0: 1538.90
     rank  1: 1544.95
     rank  2: 1426.43
     rank  3: 1436.84
     rank  4: 1293.60
     rank  5: 1295.59
     rank  6: 1278.05
     rank  7: 1277.76
     rank  8: 1034.70
     rank  9: 1031.51
     rank 10: 1008.39
     rank 11: 1011.72
     rank 12: 815.29
     rank 13: 816.26
     rank 14: 1051.18
     rank 15: 1062.75
  backward-compute:
     rank  0: 1254.73
     rank  1: 1245.62
     rank  2: 1392.69
     rank  3: 1381.23
     rank  4: 1845.42
     rank  5: 1844.39
     rank  6: 1858.05
     rank  7: 1860.63
     rank  8: 1471.58
     rank  9: 1474.28
     rank 10: 1475.03
     rank 11: 1482.71
     rank 12: 1198.49
     rank 13: 1199.57
     rank 14: 1204.78
     rank 15: 1204.45
  pure-backward-compute:
     rank  0: 1253.55
     rank  1: 1244.73
     rank  2: 1391.50
     rank  3: 1380.39
     rank  4: 1843.97
     rank  5: 1843.20
     rank  6: 1856.91
     rank  7: 1859.42
     rank  8: 1470.19
     rank  9: 1472.63
     rank 10: 1473.25
     rank 11: 1481.60
     rank 12: 1194.20
     rank 13: 1197.32
     rank 14: 1202.06
     rank 15: 1202.23
  batch-generator:
     rank  0: 71.53
     rank  1: 79.55
     rank  2: 72.12
     rank  3: 81.70
     rank  4: 73.75
     rank  5: 76.02
     rank  6: 52.63
     rank  7: 57.00
     rank  8: 72.83
     rank  9: 69.79
     rank 10: 64.68
     rank 11: 61.90
     rank 12: 66.66
     rank 13: 69.60
     rank 14: 60.47
     rank 15: 72.85
  forward-recv:
     rank  4: 113.45
     rank  5: 113.09
     rank  6: 95.26
     rank  7: 95.22
     rank  8: 196.33
     rank  9: 196.67
     rank 10: 190.51
     rank 11: 190.80
     rank 12: 238.58
     rank 13: 238.46
     rank 14: 230.05
     rank 15: 230.11
  forward-send:
     rank  0: 1.41
     rank  1: 1.36
     rank  2: 1.44
     rank  3: 1.42
     rank  4: 5.46
     rank  5: 5.50
     rank  6: 5.71
     rank  7: 5.66
     rank  8: 4.86
     rank  9: 4.79
     rank 10: 3.14
     rank 11: 2.75
  backward-recv:
     rank  0: 276.98
     rank  1: 283.34
     rank  2: 277.96
     rank  3: 281.16
     rank  4: 70.00
     rank  5: 69.77
     rank  6: 90.36
     rank  7: 90.46
     rank  8: 36.43
     rank  9: 36.24
     rank 10: 61.45
     rank 11: 61.81
  backward-send:
     rank  4: 0.98
     rank  5: 0.97
     rank  6: 1.36
     rank  7: 1.18
     rank  8: 7.66
     rank  9: 7.63
     rank 10: 7.42
     rank 11: 6.83
     rank 12: 4.73
     rank 13: 4.72
     rank 14: 4.44
     rank 15: 4.49
  forward-send-backward-recv:
     rank  0: 516.70
     rank  1: 525.57
     rank  2: 493.57
     rank  3: 494.72
     rank  4: 181.19
     rank  5: 182.65
     rank  6: 183.77
     rank  7: 181.39
     rank  8: 160.96
     rank  9: 161.35
     rank 10: 159.25
     rank 11: 157.34
  backward-send-forward-recv:
     rank  4: 11.69
     rank  5: 11.06
     rank  6: 9.92
     rank  7: 10.02
     rank  8: 496.05
     rank  9: 497.81
     rank 10: 501.77
     rank 11: 499.12
     rank 12: 1056.46
     rank 13: 1058.24
     rank 14: 823.54
     rank 15: 814.72
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.06
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.13
     rank 13: 0.06
     rank 14: 0.07
     rank 15: 0.06
  all-grads-sync:
     rank  0: 128.81
     rank  1: 126.79
     rank  2: 128.89
     rank  3: 126.70
     rank  4: 602.31
     rank  5: 601.80
     rank  6: 602.33
     rank  7: 601.80
     rank  8: 431.68
     rank  9: 431.71
     rank 10: 431.61
     rank 11: 431.72
     rank 12: 287.09
     rank 13: 275.20
     rank 14: 287.24
     rank 15: 275.19
  optimizer-copy-to-main-grad:
     rank  0: 0.38
     rank  1: 0.24
     rank  2: 0.25
     rank  3: 0.25
     rank  4: 0.04
     rank  5: 0.04
     rank  6: 0.05
     rank  7: 0.07
     rank  8: 0.06
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.05
     rank 12: 0.05
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 25.09
     rank  1: 24.94
     rank  2: 24.81
     rank  3: 24.97
     rank  4: 74.40
     rank  5: 74.45
     rank  6: 74.46
     rank  7: 74.55
     rank  8: 53.86
     rank  9: 53.57
     rank 10: 53.67
     rank 11: 53.66
     rank 12: 33.86
     rank 13: 33.77
     rank 14: 33.66
     rank 15: 33.77
  optimizer:
     rank  0: 26.00
     rank  1: 25.85
     rank  2: 25.72
     rank  3: 25.88
     rank  4: 75.32
     rank  5: 75.36
     rank  6: 75.37
     rank  7: 75.47
     rank  8: 54.78
     rank  9: 54.48
     rank 10: 54.58
     rank 11: 54.57
     rank 12: 34.78
     rank 13: 34.69
     rank 14: 34.58
     rank 15: 34.68
 [2024-12-30 23:18:51] iteration        6/      10 | consumed samples:          192 | elapsed time per iteration (ms): 4325.0 | learning rate: 4.500000E-06 | global batch size:    32 | lm loss: 2.106789E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4203.89
     rank  1: 4203.73
     rank  2: 4203.77
     rank  3: 4203.75
     rank  4: 4208.51
     rank  5: 4208.58
     rank  6: 4208.50
     rank  7: 4208.51
     rank  8: 4206.68
     rank  9: 4206.65
     rank 10: 4206.69
     rank 11: 4206.60
     rank 12: 4204.86
     rank 13: 4204.73
     rank 14: 4204.79
     rank 15: 4204.78
  forward-compute:
     rank  0: 1499.67
     rank  1: 1509.21
     rank  2: 1513.27
     rank  3: 1513.89
     rank  4: 1292.48
     rank  5: 1293.00
     rank  6: 1299.79
     rank  7: 1298.43
     rank  8: 1019.70
     rank  9: 1019.36
     rank 10: 1020.07
     rank 11: 1022.70
     rank 12: 858.36
     rank 13: 868.43
     rank 14: 835.88
     rank 15: 842.99
  backward-compute:
     rank  0: 1284.11
     rank  1: 1271.11
     rank  2: 1268.60
     rank  3: 1266.61
     rank  4: 1842.15
     rank  5: 1843.35
     rank  6: 1845.92
     rank  7: 1847.37
     rank  8: 1474.02
     rank  9: 1481.85
     rank 10: 1473.40
     rank 11: 1479.05
     rank 12: 1199.31
     rank 13: 1196.49
     rank 14: 1205.97
     rank 15: 1203.62
  pure-backward-compute:
     rank  0: 1282.92
     rank  1: 1270.09
     rank  2: 1267.50
     rank  3: 1265.74
     rank  4: 1841.09
     rank  5: 1842.08
     rank  6: 1844.88
     rank  7: 1846.00
     rank  8: 1472.50
     rank  9: 1479.80
     rank 10: 1471.49
     rank 11: 1478.23
     rank 12: 1194.28
     rank 13: 1194.18
     rank 14: 1203.28
     rank 15: 1201.86
  batch-generator:
     rank  0: 68.76
     rank  1: 79.20
     rank  2: 91.79
     rank  3: 89.65
     rank  4: 58.05
     rank  5: 69.03
     rank  6: 59.92
     rank  7: 67.12
     rank  8: 65.42
     rank  9: 63.95
     rank 10: 71.22
     rank 11: 66.79
     rank 12: 82.78
     rank 13: 88.62
     rank 14: 63.90
     rank 15: 68.94
  forward-recv:
     rank  4: 114.86
     rank  5: 114.40
     rank  6: 99.94
     rank  7: 99.96
     rank  8: 198.08
     rank  9: 198.41
     rank 10: 190.48
     rank 11: 190.85
     rank 12: 238.26
     rank 13: 237.98
     rank 14: 229.30
     rank 15: 229.08
  forward-send:
     rank  0: 1.45
     rank  1: 1.33
     rank  2: 1.44
     rank  3: 1.45
     rank  4: 5.59
     rank  5: 5.54
     rank  6: 5.58
     rank  7: 5.67
     rank  8: 4.91
     rank  9: 4.66
     rank 10: 2.84
     rank 11: 2.49
  backward-recv:
     rank  0: 271.81
     rank  1: 279.38
     rank  2: 282.40
     rank  3: 282.32
     rank  4: 75.13
     rank  5: 73.84
     rank  6: 70.09
     rank  7: 69.50
     rank  8: 40.24
     rank  9: 39.80
     rank 10: 36.41
     rank 11: 35.61
  backward-send:
     rank  4: 0.93
     rank  5: 1.45
     rank  6: 0.95
     rank  7: 1.13
     rank  8: 7.40
     rank  9: 7.05
     rank 10: 7.63
     rank 11: 7.54
     rank 12: 4.98
     rank 13: 4.50
     rank 14: 5.08
     rank 15: 3.89
  forward-send-backward-recv:
     rank  0: 519.59
     rank  1: 525.18
     rank  2: 516.47
     rank  3: 520.24
     rank  4: 180.27
     rank  5: 180.26
     rank  6: 188.19
     rank  7: 187.40
     rank  8: 175.01
     rank  9: 169.47
     rank 10: 180.47
     rank 11: 178.46
  backward-send-forward-recv:
     rank  4: 9.66
     rank  5: 9.84
     rank  6: 9.55
     rank  7: 11.06
     rank  8: 485.99
     rank  9: 485.98
     rank 10: 494.64
     rank 11: 493.88
     rank 12: 1009.71
     rank 13: 1005.40
     rank 14: 1035.68
     rank 15: 1032.24
  layernorm-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.09
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.07
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.13
     rank 13: 0.06
     rank 14: 0.07
     rank 15: 0.08
  all-grads-sync:
     rank  0: 126.57
     rank  1: 123.80
     rank  2: 126.61
     rank  3: 123.72
     rank  4: 598.41
     rank  5: 598.62
     rank  6: 598.39
     rank  7: 598.64
     rank  8: 433.50
     rank  9: 433.85
     rank 10: 432.55
     rank 11: 433.89
     rank 12: 292.93
     rank 13: 280.88
     rank 14: 292.93
     rank 15: 280.92
  optimizer-copy-to-main-grad:
     rank  0: 0.43
     rank  1: 0.25
     rank  2: 0.26
     rank  3: 0.25
     rank  4: 0.04
     rank  5: 0.05
     rank  6: 0.04
     rank  7: 0.04
     rank  8: 0.06
     rank  9: 0.06
     rank 10: 0.08
     rank 11: 0.07
     rank 12: 0.04
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 25.76
     rank  1: 25.20
     rank  2: 25.34
     rank  3: 25.24
     rank  4: 74.44
     rank  5: 74.51
     rank  6: 74.41
     rank  7: 74.49
     rank  8: 53.64
     rank  9: 53.65
     rank 10: 53.91
     rank 11: 53.67
     rank 12: 33.83
     rank 13: 33.71
     rank 14: 33.68
     rank 15: 33.73
  optimizer:
     rank  0: 27.04
     rank  1: 26.48
     rank  2: 26.62
     rank  3: 26.52
     rank  4: 75.72
     rank  5: 75.80
     rank  6: 75.69
     rank  7: 75.76
     rank  8: 54.93
     rank  9: 54.93
     rank 10: 55.23
     rank 11: 54.95
     rank 12: 35.11
     rank 13: 34.99
     rank 14: 34.96
     rank 15: 35.02
 [2024-12-30 23:18:55] iteration        7/      10 | consumed samples:          224 | elapsed time per iteration (ms): 4329.5 | learning rate: 5.250000E-06 | global batch size:    32 | lm loss: 2.375690E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4212.75
     rank  1: 4212.67
     rank  2: 4212.75
     rank  3: 4212.69
     rank  4: 4217.50
     rank  5: 4217.49
     rank  6: 4217.66
     rank  7: 4217.60
     rank  8: 4215.66
     rank  9: 4215.57
     rank 10: 4215.67
     rank 11: 4215.56
     rank 12: 4213.70
     rank 13: 4213.72
     rank 14: 4213.71
     rank 15: 4213.70
  forward-compute:
     rank  0: 1491.37
     rank  1: 1497.13
     rank  2: 1428.05
     rank  3: 1430.18
     rank  4: 1294.75
     rank  5: 1297.93
     rank  6: 1291.83
     rank  7: 1288.78
     rank  8: 1012.55
     rank  9: 1011.16
     rank 10: 988.85
     rank 11: 990.97
     rank 12: 826.57
     rank 13: 829.47
     rank 14: 970.99
     rank 15: 973.78
  backward-compute:
     rank  0: 1334.31
     rank  1: 1329.43
     rank  2: 1297.99
     rank  3: 1291.53
     rank  4: 1843.85
     rank  5: 1843.67
     rank  6: 1852.56
     rank  7: 1854.30
     rank  8: 1471.88
     rank  9: 1474.99
     rank 10: 1475.40
     rank 11: 1476.69
     rank 12: 1204.40
     rank 13: 1202.05
     rank 14: 1205.17
     rank 15: 1203.50
  pure-backward-compute:
     rank  0: 1333.21
     rank  1: 1328.50
     rank  2: 1297.08
     rank  3: 1290.65
     rank  4: 1842.60
     rank  5: 1842.68
     rank  6: 1851.51
     rank  7: 1852.68
     rank  8: 1470.66
     rank  9: 1473.59
     rank 10: 1474.22
     rank 11: 1475.94
     rank 12: 1201.08
     rank 13: 1199.89
     rank 14: 1202.55
     rank 15: 1201.47
  batch-generator:
     rank  0: 74.76
     rank  1: 80.34
     rank  2: 68.69
     rank  3: 71.53
     rank  4: 72.78
     rank  5: 73.39
     rank  6: 49.44
     rank  7: 62.05
     rank  8: 59.36
     rank  9: 58.27
     rank 10: 54.20
     rank 11: 50.87
     rank 12: 77.35
     rank 13: 78.29
     rank 14: 67.37
     rank 15: 71.99
  forward-recv:
     rank  4: 110.13
     rank  5: 109.31
     rank  6: 94.14
     rank  7: 94.31
     rank  8: 199.90
     rank  9: 199.85
     rank 10: 186.85
     rank 11: 186.72
     rank 12: 251.15
     rank 13: 251.30
     rank 14: 230.83
     rank 15: 230.84
  forward-send:
     rank  0: 1.42
     rank  1: 1.34
     rank  2: 1.48
     rank  3: 1.46
     rank  4: 5.32
     rank  5: 5.56
     rank  6: 5.71
     rank  7: 5.47
     rank  8: 4.62
     rank  9: 4.85
     rank 10: 2.75
     rank 11: 2.78
  backward-recv:
     rank  0: 266.55
     rank  1: 269.00
     rank  2: 278.07
     rank  3: 280.37
     rank  4: 71.17
     rank  5: 71.78
     rank  6: 70.74
     rank  7: 69.86
     rank  8: 36.34
     rank  9: 36.11
     rank 10: 37.26
     rank 11: 37.41
  backward-send:
     rank  4: 1.29
     rank  5: 1.02
     rank  6: 1.00
     rank  7: 1.15
     rank  8: 9.40
     rank  9: 9.25
     rank 10: 8.97
     rank 11: 8.35
     rank 12: 5.20
     rank 13: 5.01
     rank 14: 5.12
     rank 15: 4.42
  forward-send-backward-recv:
     rank  0: 494.34
     rank  1: 498.57
     rank  2: 587.09
     rank  3: 590.68
     rank  4: 191.56
     rank  5: 191.39
     rank  6: 202.19
     rank  7: 202.29
     rank  8: 175.40
     rank  9: 173.50
     rank 10: 180.17
     rank 11: 179.72
  backward-send-forward-recv:
     rank  4: 12.27
     rank  5: 10.98
     rank  6: 9.32
     rank  7: 11.20
     rank  8: 506.39
     rank  9: 506.96
     rank 10: 536.89
     rank 11: 536.33
     rank 12: 1033.26
     rank 13: 1034.03
     rank 14: 908.10
     rank 15: 908.04
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.04
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.08
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.07
     rank 13: 0.06
     rank 14: 0.07
     rank 15: 0.07
  all-grads-sync:
     rank  0: 129.99
     rank  1: 127.46
     rank  2: 129.89
     rank  3: 127.34
     rank  4: 598.64
     rank  5: 598.26
     rank  6: 598.63
     rank  7: 598.15
     rank  8: 436.58
     rank  9: 436.62
     rank 10: 436.51
     rank 11: 436.59
     rank 12: 286.73
     rank 13: 275.45
     rank 14: 286.72
     rank 15: 275.45
  optimizer-copy-to-main-grad:
     rank  0: 0.39
     rank  1: 0.24
     rank  2: 0.24
     rank  3: 0.24
     rank  4: 0.04
     rank  5: 0.04
     rank  6: 0.04
     rank  7: 0.06
     rank  8: 0.06
     rank  9: 0.05
     rank 10: 0.08
     rank 11: 0.04
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.07
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 25.06
     rank  1: 24.84
     rank  2: 25.17
     rank  3: 25.09
     rank  4: 74.46
     rank  5: 74.49
     rank  6: 74.50
     rank  7: 74.70
     rank  8: 53.67
     rank  9: 53.67
     rank 10: 53.65
     rank 11: 53.66
     rank 12: 33.65
     rank 13: 33.69
     rank 14: 33.94
     rank 15: 33.74
  optimizer:
     rank  0: 26.01
     rank  1: 25.79
     rank  2: 26.13
     rank  3: 26.04
     rank  4: 75.41
     rank  5: 75.44
     rank  6: 75.45
     rank  7: 75.66
     rank  8: 54.64
     rank  9: 54.61
     rank 10: 54.60
     rank 11: 54.61
     rank 12: 34.60
     rank 13: 34.65
     rank 14: 34.89
     rank 15: 34.69
 [2024-12-30 23:18:59] iteration        8/      10 | consumed samples:          256 | elapsed time per iteration (ms): 4322.8 | learning rate: 6.000000E-06 | global batch size:    32 | lm loss: 2.863549E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4210.71
     rank  1: 4210.60
     rank  2: 4210.80
     rank  3: 4210.61
     rank  4: 4215.48
     rank  5: 4215.35
     rank  6: 4215.52
     rank  7: 4215.35
     rank  8: 4213.74
     rank  9: 4213.59
     rank 10: 4213.59
     rank 11: 4213.51
     rank 12: 4211.71
     rank 13: 4211.68
     rank 14: 4211.76
     rank 15: 4211.64
  forward-compute:
     rank  0: 1510.46
     rank  1: 1519.64
     rank  2: 1516.32
     rank  3: 1519.29
     rank  4: 1296.86
     rank  5: 1302.47
     rank  6: 1289.92
     rank  7: 1287.84
     rank  8: 1024.23
     rank  9: 1023.65
     rank 10: 1011.30
     rank 11: 1014.79
     rank 12: 825.31
     rank 13: 823.11
     rank 14: 993.64
     rank 15: 1000.39
  backward-compute:
     rank  0: 1276.35
     rank  1: 1269.04
     rank  2: 1268.90
     rank  3: 1265.60
     rank  4: 1839.92
     rank  5: 1840.20
     rank  6: 1852.19
     rank  7: 1853.73
     rank  8: 1477.40
     rank  9: 1472.95
     rank 10: 1473.54
     rank 11: 1477.62
     rank 12: 1204.47
     rank 13: 1202.86
     rank 14: 1204.64
     rank 15: 1203.43
  pure-backward-compute:
     rank  0: 1275.20
     rank  1: 1268.07
     rank  2: 1267.81
     rank  3: 1264.67
     rank  4: 1838.29
     rank  5: 1839.23
     rank  6: 1851.14
     rank  7: 1852.39
     rank  8: 1476.27
     rank  9: 1471.02
     rank 10: 1471.88
     rank 11: 1476.74
     rank 12: 1201.20
     rank 13: 1201.05
     rank 14: 1201.95
     rank 15: 1201.61
  batch-generator:
     rank  0: 76.66
     rank  1: 85.65
     rank  2: 84.45
     rank  3: 84.45
     rank  4: 73.37
     rank  5: 75.77
     rank  6: 53.78
     rank  7: 58.54
     rank  8: 63.73
     rank  9: 65.02
     rank 10: 75.77
     rank 11: 71.67
     rank 12: 69.16
     rank 13: 66.75
     rank 14: 59.32
     rank 15: 65.79
  forward-recv:
     rank  4: 103.75
     rank  5: 103.24
     rank  6: 105.01
     rank  7: 104.21
     rank  8: 191.33
     rank  9: 191.14
     rank 10: 197.76
     rank 11: 198.11
     rank 12: 237.19
     rank 13: 237.35
     rank 14: 239.62
     rank 15: 239.51
  forward-send:
     rank  0: 1.42
     rank  1: 1.31
     rank  2: 1.46
     rank  3: 1.39
     rank  4: 5.49
     rank  5: 5.51
     rank  6: 5.43
     rank  7: 5.67
     rank  8: 4.60
     rank  9: 4.92
     rank 10: 3.49
     rank 11: 3.37
  backward-recv:
     rank  0: 277.20
     rank  1: 279.50
     rank  2: 297.74
     rank  3: 297.41
     rank  4: 69.80
     rank  5: 70.09
     rank  6: 86.29
     rank  7: 86.27
     rank  8: 35.85
     rank  9: 35.66
     rank 10: 54.84
     rank 11: 55.26
  backward-send:
     rank  4: 1.32
     rank  5: 1.13
     rank  6: 1.31
     rank  7: 1.08
     rank  8: 6.95
     rank  9: 7.00
     rank 10: 6.97
     rank 11: 6.07
     rank 12: 4.67
     rank 13: 4.51
     rank 14: 3.89
     rank 15: 4.39
  forward-send-backward-recv:
     rank  0: 516.26
     rank  1: 518.43
     rank  2: 498.57
     rank  3: 501.25
     rank  4: 190.82
     rank  5: 190.88
     rank  6: 172.20
     rank  7: 171.03
     rank  8: 163.97
     rank  9: 168.76
     rank 10: 152.93
     rank 11: 151.03
  backward-send-forward-recv:
     rank  4: 13.29
     rank  5: 10.05
     rank  6: 9.22
     rank  7: 10.81
     rank  8: 505.39
     rank  9: 504.32
     rank 10: 506.20
     rank 11: 503.93
     rank 12: 1041.57
     rank 13: 1048.29
     rank 14: 870.43
     rank 15: 866.95
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.04
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.04
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.07
     rank  5: 0.05
     rank  6: 0.08
     rank  7: 0.05
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.07
     rank 13: 0.09
     rank 14: 0.12
     rank 15: 0.06
  all-grads-sync:
     rank  0: 127.99
     rank  1: 123.13
     rank  2: 128.17
     rank  3: 123.13
     rank  4: 603.43
     rank  5: 603.40
     rank  6: 603.47
     rank  7: 603.40
     rank  8: 428.44
     rank  9: 428.35
     rank 10: 428.37
     rank 11: 428.35
     rank 12: 294.61
     rank 13: 282.84
     rank 14: 294.63
     rank 15: 282.84
  optimizer-copy-to-main-grad:
     rank  0: 0.39
     rank  1: 0.24
     rank  2: 0.38
     rank  3: 0.25
     rank  4: 0.06
     rank  5: 0.03
     rank  6: 0.05
     rank  7: 0.04
     rank  8: 0.05
     rank  9: 0.11
     rank 10: 0.06
     rank 11: 0.07
     rank 12: 0.03
     rank 13: 0.04
     rank 14: 0.03
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 25.01
     rank  1: 24.96
     rank  2: 25.26
     rank  3: 24.89
     rank  4: 74.56
     rank  5: 74.41
     rank  6: 74.54
     rank  7: 74.47
     rank  8: 53.67
     rank  9: 54.66
     rank 10: 53.69
     rank 11: 53.71
     rank 12: 33.65
     rank 13: 33.77
     rank 14: 33.74
     rank 15: 33.70
  optimizer:
     rank  0: 25.97
     rank  1: 25.93
     rank  2: 26.24
     rank  3: 25.85
     rank  4: 75.53
     rank  5: 75.37
     rank  6: 75.50
     rank  7: 75.45
     rank  8: 54.62
     rank  9: 55.62
     rank 10: 54.64
     rank 11: 54.67
     rank 12: 34.61
     rank 13: 34.73
     rank 14: 34.70
     rank 15: 34.66
 [2024-12-30 23:19:04] iteration        9/      10 | consumed samples:          288 | elapsed time per iteration (ms): 4597.8 | learning rate: 6.750000E-06 | global batch size:    32 | lm loss: 2.726721E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4483.15
     rank  1: 4483.05
     rank  2: 4483.03
     rank  3: 4482.99
     rank  4: 4487.87
     rank  5: 4487.77
     rank  6: 4487.81
     rank  7: 4487.75
     rank  8: 4485.90
     rank  9: 4485.94
     rank 10: 4485.92
     rank 11: 4485.87
     rank 12: 4484.04
     rank 13: 4484.03
     rank 14: 4484.01
     rank 15: 4484.11
  forward-compute:
     rank  0: 1774.84
     rank  1: 1781.83
     rank  2: 1716.72
     rank  3: 1714.76
     rank  4: 1305.97
     rank  5: 1311.40
     rank  6: 1270.52
     rank  7: 1270.88
     rank  8: 1019.20
     rank  9: 1018.79
     rank 10: 993.97
     rank 11: 997.40
     rank 12: 819.85
     rank 13: 821.92
     rank 14: 1194.58
     rank 15: 1206.06
  backward-compute:
     rank  0: 1277.09
     rank  1: 1271.76
     rank  2: 1254.94
     rank  3: 1258.97
     rank  4: 1839.26
     rank  5: 1841.02
     rank  6: 1853.63
     rank  7: 1854.22
     rank  8: 1483.29
     rank  9: 1484.43
     rank 10: 1469.83
     rank 11: 1478.46
     rank 12: 1205.73
     rank 13: 1203.50
     rank 14: 1204.87
     rank 15: 1204.38
  pure-backward-compute:
     rank  0: 1275.93
     rank  1: 1270.65
     rank  2: 1254.07
     rank  3: 1258.14
     rank  4: 1837.78
     rank  5: 1840.06
     rank  6: 1852.61
     rank  7: 1853.12
     rank  8: 1482.23
     rank  9: 1482.75
     rank 10: 1467.77
     rank 11: 1477.64
     rank 12: 1202.31
     rank 13: 1201.69
     rank 14: 1202.22
     rank 15: 1202.26
  batch-generator:
     rank  0: 68.67
     rank  1: 77.31
     rank  2: 70.71
     rank  3: 69.66
     rank  4: 75.62
     rank  5: 79.94
     rank  6: 53.01
     rank  7: 55.86
     rank  8: 52.43
     rank  9: 60.67
     rank 10: 60.17
     rank 11: 58.13
     rank 12: 67.25
     rank 13: 68.43
     rank 14: 64.87
     rank 15: 73.76
  forward-recv:
     rank  4: 101.34
     rank  5: 101.07
     rank  6: 113.99
     rank  7: 113.43
     rank  8: 190.95
     rank  9: 190.28
     rank 10: 206.96
     rank 11: 206.76
     rank 12: 238.79
     rank 13: 239.19
     rank 14: 242.07
     rank 15: 242.20
  forward-send:
     rank  0: 1.43
     rank  1: 1.35
     rank  2: 1.56
     rank  3: 1.38
     rank  4: 5.54
     rank  5: 5.54
     rank  6: 5.65
     rank  7: 5.49
     rank  8: 4.18
     rank  9: 4.81
     rank 10: 3.01
     rank 11: 2.97
  backward-recv:
     rank  0: 277.18
     rank  1: 280.34
     rank  2: 349.26
     rank  3: 348.72
     rank  4: 70.02
     rank  5: 70.22
     rank  6: 145.63
     rank  7: 144.98
     rank  8: 35.83
     rank  9: 35.16
     rank 10: 118.29
     rank 11: 117.88
  backward-send:
     rank  4: 1.17
     rank  5: 1.05
     rank  6: 1.04
     rank  7: 1.05
     rank  8: 7.25
     rank  9: 7.62
     rank 10: 7.39
     rank 11: 6.35
     rank 12: 5.03
     rank 13: 4.74
     rank 14: 5.09
     rank 15: 4.01
  forward-send-backward-recv:
     rank  0: 529.76
     rank  1: 530.24
     rank  2: 539.39
     rank  3: 539.23
     rank  4: 191.67
     rank  5: 191.05
     rank  6: 164.58
     rank  7: 164.29
     rank  8: 163.55
     rank  9: 166.15
     rank 10: 142.24
     rank 11: 138.11
  backward-send-forward-recv:
     rank  4: 275.01
     rank  5: 270.40
     rank  6: 236.98
     rank  7: 236.99
     rank  8: 773.81
     rank  9: 770.36
     rank 10: 732.96
     rank 11: 732.27
     rank 12: 1313.35
     rank 13: 1315.18
     rank 14: 935.61
     rank 15: 926.77
  layernorm-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.07
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.07
     rank 13: 0.06
     rank 14: 0.07
     rank 15: 0.07
  all-grads-sync:
     rank  0: 127.85
     rank  1: 126.08
     rank  2: 127.85
     rank  3: 125.96
     rank  4: 597.61
     rank  5: 597.29
     rank  6: 597.61
     rank  7: 597.24
     rank  8: 433.47
     rank  9: 433.74
     rank 10: 433.43
     rank 11: 433.75
     rank 12: 287.03
     rank 13: 276.41
     rank 14: 287.07
     rank 15: 276.43
  optimizer-copy-to-main-grad:
     rank  0: 0.39
     rank  1: 0.26
     rank  2: 0.23
     rank  3: 0.24
     rank  4: 0.05
     rank  5: 0.04
     rank  6: 0.04
     rank  7: 0.04
     rank  8: 0.05
     rank  9: 0.06
     rank 10: 0.07
     rank 11: 0.04
     rank 12: 0.04
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 25.50
     rank  1: 25.35
     rank  2: 24.83
     rank  3: 25.03
     rank  4: 74.54
     rank  5: 74.40
     rank  6: 74.49
     rank  7: 74.49
     rank  8: 53.68
     rank  9: 53.75
     rank 10: 53.67
     rank 11: 53.59
     rank 12: 33.80
     rank 13: 33.67
     rank 14: 33.63
     rank 15: 33.70
  optimizer:
     rank  0: 27.99
     rank  1: 27.85
     rank  2: 27.32
     rank  3: 27.52
     rank  4: 77.04
     rank  5: 76.90
     rank  6: 76.98
     rank  7: 76.97
     rank  8: 56.17
     rank  9: 56.25
     rank 10: 56.19
     rank 11: 56.09
     rank 12: 36.29
     rank 13: 36.16
     rank 14: 36.12
     rank 15: 36.20
 [2024-12-30 23:19:08] iteration       10/      10 | consumed samples:          320 | elapsed time per iteration (ms): 4306.0 | learning rate: 7.500000E-06 | global batch size:    32 | lm loss: 1.952002E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4197.97
     rank  1: 4197.84
     rank  2: 4197.87
     rank  3: 4197.92
     rank  4: 4202.56
     rank  5: 4202.58
     rank  6: 4202.62
     rank  7: 4202.63
     rank  8: 4200.73
     rank  9: 4200.79
     rank 10: 4200.76
     rank 11: 4200.71
     rank 12: 4198.88
     rank 13: 4198.88
     rank 14: 4198.94
     rank 15: 4198.89
  forward-compute:
     rank  0: 1491.74
     rank  1: 1502.32
     rank  2: 1415.70
     rank  3: 1414.25
     rank  4: 1275.53
     rank  5: 1278.07
     rank  6: 1261.22
     rank  7: 1260.56
     rank  8: 1014.61
     rank  9: 1013.82
     rank 10: 1001.43
     rank 11: 1005.13
     rank 12: 832.55
     rank 13: 832.60
     rank 14: 899.00
     rank 15: 924.81
  backward-compute:
     rank  0: 1327.22
     rank  1: 1316.19
     rank  2: 1297.51
     rank  3: 1300.51
     rank  4: 1842.14
     rank  5: 1843.63
     rank  6: 1852.74
     rank  7: 1854.99
     rank  8: 1483.55
     rank  9: 1478.95
     rank 10: 1464.98
     rank 11: 1486.38
     rank 12: 1204.20
     rank 13: 1201.04
     rank 14: 1205.96
     rank 15: 1204.16
  pure-backward-compute:
     rank  0: 1325.89
     rank  1: 1315.13
     rank  2: 1296.47
     rank  3: 1299.60
     rank  4: 1840.88
     rank  5: 1842.62
     rank  6: 1851.51
     rank  7: 1853.68
     rank  8: 1482.46
     rank  9: 1477.05
     rank 10: 1462.34
     rank 11: 1485.43
     rank 12: 1199.99
     rank 13: 1198.84
     rank 14: 1203.41
     rank 15: 1202.12
  batch-generator:
     rank  0: 75.81
     rank  1: 88.49
     rank  2: 67.72
     rank  3: 67.52
     rank  4: 60.92
     rank  5: 60.79
     rank  6: 49.88
     rank  7: 50.42
     rank  8: 50.65
     rank  9: 55.41
     rank 10: 62.89
     rank 11: 63.57
     rank 12: 73.34
     rank 13: 71.67
     rank 14: 67.28
     rank 15: 92.72
  forward-recv:
     rank  4: 105.25
     rank  5: 105.12
     rank  6: 93.48
     rank  7: 93.62
     rank  8: 199.25
     rank  9: 198.71
     rank 10: 190.24
     rank 11: 191.28
     rank 12: 243.73
     rank 13: 243.78
     rank 14: 229.03
     rank 15: 228.09
  forward-send:
     rank  0: 1.49
     rank  1: 1.34
     rank  2: 1.43
     rank  3: 1.46
     rank  4: 5.95
     rank  5: 5.78
     rank  6: 5.60
     rank  7: 5.72
     rank  8: 4.43
     rank  9: 4.77
     rank 10: 2.41
     rank 11: 2.02
  backward-recv:
     rank  0: 254.97
     rank  1: 258.39
     rank  2: 280.80
     rank  3: 280.37
     rank  4: 72.72
     rank  5: 72.68
     rank  6: 84.10
     rank  7: 82.74
     rank  8: 39.20
     rank  9: 38.61
     rank 10: 55.67
     rank 11: 55.11
  backward-send:
     rank  4: 1.25
     rank  5: 1.00
     rank  6: 1.11
     rank  7: 1.08
     rank  8: 7.11
     rank  9: 7.38
     rank 10: 7.17
     rank 11: 5.59
     rank 12: 5.06
     rank 13: 4.68
     rank 14: 5.14
     rank 15: 3.98
  forward-send-backward-recv:
     rank  0: 491.84
     rank  1: 496.76
     rank  2: 583.43
     rank  3: 582.79
     rank  4: 195.31
     rank  5: 194.28
     rank  6: 201.88
     rank  7: 200.27
     rank  8: 167.18
     rank  9: 172.18
     rank 10: 179.45
     rank 11: 166.71
  backward-send-forward-recv:
     rank  4: 11.65
     rank  5: 10.00
     rank  6: 10.52
     rank  7: 10.83
     rank  8: 481.96
     rank  9: 481.62
     rank 10: 487.38
     rank 11: 485.72
     rank 12: 1016.06
     rank 13: 1021.08
     rank 14: 962.87
     rank 15: 940.71
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.07
     rank 13: 0.07
     rank 14: 0.07
     rank 15: 0.07
  all-grads-sync:
     rank  0: 127.38
     rank  1: 124.32
     rank  2: 127.38
     rank  3: 124.26
     rank  4: 599.01
     rank  5: 598.94
     rank  6: 599.04
     rank  7: 598.97
     rank  8: 435.18
     rank  9: 435.18
     rank 10: 435.18
     rank 11: 435.19
     rank 12: 286.49
     rank 13: 274.79
     rank 14: 286.49
     rank 15: 274.80
  optimizer-copy-to-main-grad:
     rank  0: 0.39
     rank  1: 0.25
     rank  2: 0.24
     rank  3: 0.26
     rank  4: 0.04
     rank  5: 0.04
     rank  6: 0.04
     rank  7: 0.04
     rank  8: 0.05
     rank  9: 0.07
     rank 10: 0.07
     rank 11: 0.04
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.04
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 25.11
     rank  1: 24.95
     rank  2: 24.84
     rank  3: 25.42
     rank  4: 74.41
     rank  5: 74.40
     rank  6: 74.48
     rank  7: 74.52
     rank  8: 53.72
     rank  9: 53.78
     rank 10: 53.72
     rank 11: 53.55
     rank 12: 33.67
     rank 13: 33.64
     rank 14: 33.66
     rank 15: 33.70
  optimizer:
     rank  0: 26.15
     rank  1: 25.96
     rank  2: 25.84
     rank  3: 26.43
     rank  4: 75.42
     rank  5: 75.41
     rank  6: 75.48
     rank  7: 75.53
     rank  8: 54.73
     rank  9: 54.79
     rank 10: 54.73
     rank 11: 54.56
     rank 12: 34.68
     rank 13: 34.65
     rank 14: 34.67
     rank 15: 34.71
