examples/multimodal/pretrain-freeze-llm-hete-2080tifirst.sh: line 4: activate: No such file or directory
3
[2024-12-24 22:44:07,688] torch.distributed.run: [WARNING] 
[2024-12-24 22:44:07,688] torch.distributed.run: [WARNING] *****************************************
[2024-12-24 22:44:07,688] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-12-24 22:44:07,688] torch.distributed.run: [WARNING] *****************************************
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:8------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:8------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:8------
------num_pipeline_model_parallel_groups:4------
> setting tensorboard ...
WARNING: one_logger package is required to enable e2e metrics tracking. please go to https://confluence.nvidia.com/display/MLWFO/Package+Repositories for details to install it
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:8------
------num_pipeline_model_parallel_groups:4------
---Rank 15---Tensor Parallel Group GPUs: [1, 1]---Rank 13---Tensor Parallel Group GPUs: [1, 1]
---Rank 14---Tensor Parallel Group GPUs: [0, 0]

---Rank 15---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
---Rank 13---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
---Rank 14---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
[rank13]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank15]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank14]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
---Rank 12---Tensor Parallel Group GPUs: [0, 0]
---Rank 12---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
[rank12]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
 > number of parameters on (tensor, pipeline) model parallel rank (1, 3): 176173056
 > number of parameters on (tensor, pipeline) model parallel rank (0, 3): 176173056
INFO:megatron.core.distributed.param_and_grad_buffer:Number of buckets for gradient all-reduce / reduce-scatter: 1
Params for bucket 1 (176173056 elements):
	language_model.output_layer.weight
	language_model.decoder.layers.0.mlp.linear_fc1.weight
	language_model.decoder.layers.0.mlp.linear_fc2.weight
	language_model.decoder.layers.0.self_attention.linear_qkv.weight
	language_model.decoder.layers.0.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.0.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.final_layernorm.weight
	language_model.decoder.layers.0.self_attention.linear_proj.weight
rank=0, worker=0: shard_range=[pretrain-0.tar[0, 100), pretrain-0.tar[100, 200), pretrain-0.tar[200, 300), ...<1244>, pretrain-2.tar[4700, 4800), pretrain-2.tar[4800, 4900), pretrain-2.tar[4900, 5000)] sum(count)=125000
rank=1, worker=0: shard_range=[pretrain-31.tar[0, 100), pretrain-31.tar[100, 200), pretrain-31.tar[200, 300), ...<1244>, pretrain-42.tar[4700, 4800), pretrain-42.tar[4800, 4900), pretrain-42.tar[4900, 5000)] sum(count)=125000
rank=0, worker=1: shard_range=[pretrain-2.tar[5000, 5100), pretrain-2.tar[5100, 5200), pretrain-2.tar[5200, 5300), ...<1244>, pretrain-30.tar[9700, 9800), pretrain-30.tar[9800, 9900), pretrain-30.tar[9900, 10000)] sum(count)=125000
rank=1, worker=1: shard_range=[pretrain-42.tar[5000, 5100), pretrain-42.tar[5100, 5200), pretrain-42.tar[5200, 5300), ...<1244>, pretrain-53.tar[9700, 9800), pretrain-53.tar[9800, 9900), pretrain-53.tar[9900, 10000)] sum(count)=125000
rank=0, worker=0: shard_range=[pretrain-54.tar[0, 10000), pretrain-55.tar[0, 4532)] sum(count)=14532
rank=0, worker=1: shard_range=[pretrain-55.tar[4532, 8128), pretrain-6.tar[0, 10000), pretrain-7.tar[0, 936)] sum(count)=14532
rank=1, worker=0: shard_range=[pretrain-7.tar[936, 10000), pretrain-8.tar[0, 5468)] sum(count)=14532
rank=1, worker=1: shard_range=[pretrain-8.tar[5468, 10000), pretrain-9.tar[0, 10000)] sum(count)=14532
times across ranks (ms):
  model-and-optimizer-setup:
     rank  0: 112.38
     rank  1: 126.76
     rank  2: 112.17
     rank  3: 125.41
     rank  4: 54.16
     rank  5: 54.23
     rank  6: 54.48
     rank  7: 54.53
     rank  8: 30.98
     rank  9: 30.66
     rank 10: 38.82
     rank 11: 43.57
     rank 12: 43.16
     rank 13: 43.68
     rank 14: 44.60
     rank 15: 43.66
  train/valid/test-data-iterators-setup:
     rank  0: 1205.24
     rank  1: 1205.04
     rank  2: 1243.92
     rank  3: 1205.01
     rank  4: 1205.00
     rank  5: 1205.76
     rank  6: 1205.08
     rank  7: 1205.79
     rank  8: 1205.19
     rank  9: 1205.19
     rank 10: 1205.17
     rank 11: 1205.22
     rank 12: 1205.23
     rank 13: 1205.20
     rank 14: 1205.22
     rank 15: 1205.39
 [2024-12-24 22:44:43] iteration        1/      10 | consumed samples:           16 | elapsed time per iteration (ms): 12088.1 | learning rate: 7.500000E-07 | global batch size:    16 | lm loss: 7.282188E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
[Rank 13] (after 1 iterations) memory (MB) | allocated: 2741.4404296875 | max allocated: 3413.349609375 | reserved: 3668.0 | max reserved: 3668.0
stage4 GPU utialization:30.303174799138848 %
[Rank 12] (after 1 iterations) memory (MB) | allocated: 2741.4404296875 | max allocated: 3413.349609375 | reserved: 3668.0 | max reserved: 3668.0
times across ranks (ms):
  forward-backward:
     rank  0: 11993.36
     rank  1: 11993.50
     rank  2: 11993.36
     rank  3: 11995.75
     rank  4: 11993.19
     rank  5: 11993.49
     rank  6: 11993.16
     rank  7: 11993.40
     rank  8: 11993.29
     rank  9: 11993.57
     rank 10: 11993.27
     rank 11: 11993.50
     rank 12: 11990.35
     rank 13: 11990.69
     rank 14: 11990.34
     rank 15: 11990.54
  forward-compute:
     rank  0: 3213.00
     rank  1: 3215.02
     rank  2: 3359.31
     rank  3: 3358.05
     rank  4: 2609.45
     rank  5: 2610.41
     rank  6: 2690.81
     rank  7: 2687.58
     rank  8: 2897.36
     rank  9: 2889.00
     rank 10: 2944.01
     rank 11: 2940.33
     rank 12: 1929.48
     rank 13: 1934.80
     rank 14: 1550.92
     rank 15: 1551.68
  backward-compute:
     rank  0: 1711.67
     rank  1: 1706.22
     rank  2: 1762.11
     rank  3: 1760.89
     rank  4: 774.53
     rank  5: 772.72
     rank  6: 779.32
     rank  7: 778.73
     rank  8: 870.83
     rank  9: 872.65
     rank 10: 874.20
     rank 11: 870.13
     rank 12: 634.56
     rank 13: 622.61
     rank 14: 636.96
     rank 15: 625.86
  pure-backward-compute:
     rank  0: 1711.01
     rank  1: 1705.38
     rank  2: 1761.19
     rank  3: 1759.95
     rank  4: 773.76
     rank  5: 772.19
     rank  6: 778.41
     rank  7: 778.07
     rank  8: 870.04
     rank  9: 871.81
     rank 10: 873.47
     rank 11: 869.34
     rank 12: 631.70
     rank 13: 621.29
     rank 14: 635.74
     rank 15: 624.40
  batch-generator:
     rank  0: 1147.89
     rank  1: 1160.29
     rank  2: 1247.93
     rank  3: 1231.83
     rank  4: 1012.80
     rank  5: 1018.73
     rank  6: 1062.59
     rank  7: 1061.04
     rank  8: 1039.43
     rank  9: 1031.22
     rank 10: 1035.44
     rank 11: 1034.93
     rank 12: 992.42
     rank 13: 980.87
     rank 14: 1007.63
     rank 15: 999.94
  forward-recv:
     rank  4: 2663.34
     rank  5: 2651.16
     rank  6: 2726.56
     rank  7: 2727.79
     rank  8: 4808.80
     rank  9: 4810.99
     rank 10: 4957.94
     rank 11: 4956.80
     rank 12: 7202.05
     rank 13: 7206.72
     rank 14: 7389.95
     rank 15: 7393.46
  forward-send:
     rank  0: 4503.04
     rank  1: 4498.17
     rank  2: 4596.36
     rank  3: 4600.64
     rank  4: 2345.72
     rank  5: 2352.95
     rank  6: 2385.68
     rank  7: 2388.65
     rank  8: 23.46
     rank  9: 28.02
     rank 10: 19.91
     rank 11: 23.47
  backward-recv:
     rank  0: 332.81
     rank  1: 331.12
     rank  2: 234.06
     rank  3: 233.93
     rank  4: 203.06
     rank  5: 204.44
     rank  6: 133.77
     rank  7: 134.23
     rank  8: 91.68
     rank  9: 90.27
     rank 10: 19.91
     rank 11: 20.54
  backward-send:
     rank  4: 1.73
     rank  5: 0.96
     rank  6: 1.28
     rank  7: 1.04
     rank  8: 7.35
     rank  9: 7.07
     rank 10: 7.37
     rank 11: 7.05
     rank 12: 4.67
     rank 13: 3.88
     rank 14: 4.77
     rank 15: 4.91
  forward-send-backward-recv:
     rank  0: 1609.63
     rank  1: 1617.18
     rank  2: 1422.74
     rank  3: 1421.73
     rank  4: 1595.45
     rank  5: 1599.02
     rank  6: 1377.30
     rank  7: 1378.53
     rank  8: 1450.89
     rank  9: 1451.97
     rank 10: 1261.04
     rank 11: 1263.00
  backward-send-forward-recv:
     rank  4: 1104.51
     rank  5: 1108.81
     rank  6: 1206.55
     rank  7: 1205.52
     rank  8: 1051.89
     rank  9: 1053.31
     rank 10: 1120.10
     rank 11: 1120.83
     rank 12: 1319.67
     rank 13: 1321.86
     rank 14: 1509.36
     rank 15: 1515.51
  layernorm-grads-all-reduce:
     rank  0: 0.11
     rank  1: 0.07
     rank  2: 0.05
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.04
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.02
     rank  9: 0.04
     rank 10: 0.03
     rank 11: 0.04
     rank 12: 0.03
     rank 13: 0.06
     rank 14: 0.04
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.07
     rank  5: 0.11
     rank  6: 0.07
     rank  7: 0.07
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.04
     rank 11: 0.03
     rank 12: 0.11
     rank 13: 0.14
     rank 14: 0.08
     rank 15: 0.08
  all-grads-sync:
     rank  0: 267.45
     rank  1: 272.07
     rank  2: 267.55
     rank  3: 272.05
     rank  4: 569.90
     rank  5: 579.18
     rank  6: 569.93
     rank  7: 579.18
     rank  8: 598.53
     rank  9: 595.20
     rank 10: 598.54
     rank 11: 595.24
     rank 12: 320.15
     rank 13: 308.58
     rank 14: 320.30
     rank 15: 308.66
  optimizer-copy-to-main-grad:
     rank  0: 0.53
     rank  1: 0.61
     rank  2: 0.37
     rank  3: 0.56
     rank  4: 0.05
     rank  5: 0.06
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.05
     rank  9: 0.07
     rank 10: 0.06
     rank 11: 0.06
     rank 12: 0.04
     rank 13: 0.05
     rank 14: 0.04
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 53.49
     rank  1: 53.94
     rank  2: 53.84
     rank  3: 47.36
     rank  4: 78.79
     rank  5: 79.71
     rank  6: 79.19
     rank  7: 79.64
     rank  8: 82.07
     rank  9: 82.68
     rank 10: 81.95
     rank 11: 86.00
     rank 12: 51.36
     rank 13: 52.12
     rank 14: 51.36
     rank 15: 52.11
  optimizer:
     rank  0: 54.89
     rank  1: 55.34
     rank  2: 55.24
     rank  3: 48.74
     rank  4: 80.18
     rank  5: 81.12
     rank  6: 80.59
     rank  7: 81.03
     rank  8: 83.47
     rank  9: 84.09
     rank 10: 83.37
     rank 11: 87.41
     rank 12: 52.77
     rank 13: 53.52
     rank 14: 52.77
     rank 15: 53.52
 [2024-12-24 22:44:46] iteration        2/      10 | consumed samples:           32 | elapsed time per iteration (ms): 2617.1 | learning rate: 1.500000E-06 | global batch size:    16 | lm loss: 7.105175E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2518.98
     rank  1: 2519.15
     rank  2: 2519.17
     rank  3: 2519.05
     rank  4: 2522.59
     rank  5: 2522.83
     rank  6: 2522.56
     rank  7: 2522.78
     rank  8: 2522.68
     rank  9: 2523.03
     rank 10: 2522.64
     rank 11: 2522.98
     rank 12: 2519.94
     rank 13: 2519.90
     rank 14: 2519.85
     rank 15: 2519.96
  forward-compute:
     rank  0: 752.67
     rank  1: 752.06
     rank  2: 769.17
     rank  3: 769.16
     rank  4: 542.19
     rank  5: 542.70
     rank  6: 553.08
     rank  7: 552.40
     rank  8: 593.19
     rank  9: 594.02
     rank 10: 603.43
     rank 11: 603.63
     rank 12: 510.78
     rank 13: 515.99
     rank 14: 413.96
     rank 15: 425.98
  backward-compute:
     rank  0: 628.62
     rank  1: 633.47
     rank  2: 722.58
     rank  3: 718.45
     rank  4: 772.59
     rank  5: 773.86
     rank  6: 777.68
     rank  7: 777.05
     rank  8: 871.54
     rank  9: 880.64
     rank 10: 871.08
     rank 11: 882.82
     rank 12: 595.95
     rank 13: 594.00
     rank 14: 604.05
     rank 15: 603.22
  pure-backward-compute:
     rank  0: 628.20
     rank  1: 633.05
     rank  2: 722.07
     rank  3: 718.01
     rank  4: 771.92
     rank  5: 773.36
     rank  6: 777.11
     rank  7: 776.40
     rank  8: 870.42
     rank  9: 879.66
     rank 10: 870.25
     rank 11: 881.65
     rank 12: 593.52
     rank 13: 592.92
     rank 14: 602.75
     rank 15: 602.41
  batch-generator:
     rank  0: 34.74
     rank  1: 33.45
     rank  2: 39.45
     rank  3: 39.39
     rank  4: 25.71
     rank  5: 26.47
     rank  6: 27.21
     rank  7: 29.49
     rank  8: 28.50
     rank  9: 29.88
     rank 10: 31.32
     rank 11: 32.24
     rank 12: 36.38
     rank 13: 40.75
     rank 14: 30.93
     rank 15: 42.86
  forward-recv:
     rank  4: 134.36
     rank  5: 134.62
     rank  6: 133.53
     rank  7: 134.11
     rank  8: 168.29
     rank  9: 168.65
     rank 10: 171.67
     rank 11: 171.66
     rank 12: 235.31
     rank 13: 234.93
     rank 14: 237.93
     rank 15: 237.83
  forward-send:
     rank  0: 2.00
     rank  1: 1.94
     rank  2: 1.46
     rank  3: 1.59
     rank  4: 5.53
     rank  5: 5.35
     rank  6: 5.56
     rank  7: 5.26
     rank  8: 5.10
     rank  9: 4.66
     rank 10: 3.89
     rank 11: 3.77
  backward-recv:
     rank  0: 304.25
     rank  1: 299.48
     rank  2: 254.50
     rank  3: 257.19
     rank  4: 155.61
     rank  5: 156.30
     rank  6: 139.08
     rank  7: 139.82
     rank  8: 36.83
     rank  9: 34.44
     rank 10: 19.35
     rank 11: 19.21
  backward-send:
     rank  4: 1.60
     rank  5: 0.94
     rank  6: 1.26
     rank  7: 0.99
     rank  8: 7.62
     rank  9: 6.77
     rank 10: 7.88
     rank 11: 7.80
     rank 12: 4.31
     rank 13: 1.60
     rank 14: 4.26
     rank 15: 3.99
  forward-send-backward-recv:
     rank  0: 284.74
     rank  1: 284.24
     rank  2: 240.65
     rank  3: 242.62
     rank  4: 291.05
     rank  5: 291.81
     rank  6: 286.88
     rank  7: 287.46
     rank  8: 100.13
     rank  9: 95.55
     rank 10: 110.65
     rank 11: 99.57
  backward-send-forward-recv:
     rank  4: 4.77
     rank  5: 4.82
     rank  6: 13.89
     rank  7: 14.48
     rank  8: 29.27
     rank  9: 28.11
     rank 10: 24.62
     rank 11: 24.52
     rank 12: 353.59
     rank 13: 351.01
     rank 14: 440.34
     rank 15: 430.03
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.06
     rank  2: 0.04
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.05
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.06
     rank 10: 0.03
     rank 11: 0.06
     rank 12: 0.06
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.05
  embedding-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.04
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.05
     rank  5: 0.11
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.02
     rank  9: 0.05
     rank 10: 0.03
     rank 11: 0.05
     rank 12: 0.15
     rank 13: 0.08
     rank 14: 0.06
     rank 15: 0.12
  all-grads-sync:
     rank  0: 151.88
     rank  1: 146.36
     rank  2: 151.87
     rank  3: 146.48
     rank  4: 512.23
     rank  5: 512.19
     rank  6: 512.24
     rank  7: 512.23
     rank  8: 517.99
     rank  9: 517.74
     rank 10: 517.87
     rank 11: 517.82
     rank 12: 296.86
     rank 13: 283.69
     rank 14: 297.07
     rank 15: 283.86
  optimizer-copy-to-main-grad:
     rank  0: 0.27
     rank  1: 0.40
     rank  2: 0.51
     rank  3: 0.24
     rank  4: 0.04
     rank  5: 0.07
     rank  6: 0.04
     rank  7: 0.03
     rank  8: 0.07
     rank  9: 0.11
     rank 10: 0.10
     rank 11: 0.11
     rank 12: 0.07
     rank 13: 0.04
     rank 14: 0.03
     rank 15: 0.10
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.05
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 25.46
     rank  1: 25.73
     rank  2: 25.74
     rank  3: 24.84
     rank  4: 63.76
     rank  5: 63.94
     rank  6: 63.72
     rank  7: 63.79
     rank  8: 64.25
     rank  9: 64.62
     rank 10: 64.32
     rank 11: 64.58
     rank 12: 33.87
     rank 13: 33.78
     rank 14: 33.67
     rank 15: 33.93
  optimizer:
     rank  0: 26.68
     rank  1: 26.94
     rank  2: 26.96
     rank  3: 26.05
     rank  4: 64.98
     rank  5: 65.16
     rank  6: 64.94
     rank  7: 65.00
     rank  8: 65.46
     rank  9: 65.84
     rank 10: 65.54
     rank 11: 65.80
     rank 12: 35.11
     rank 13: 35.00
     rank 14: 34.89
     rank 15: 35.15
 [2024-12-24 22:44:48] iteration        3/      10 | consumed samples:           48 | elapsed time per iteration (ms): 2616.6 | learning rate: 2.250000E-06 | global batch size:    16 | lm loss: 7.108253E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2514.46
     rank  1: 2514.22
     rank  2: 2514.50
     rank  3: 2514.25
     rank  4: 2518.19
     rank  5: 2517.82
     rank  6: 2518.17
     rank  7: 2517.86
     rank  8: 2518.27
     rank  9: 2517.90
     rank 10: 2518.25
     rank 11: 2517.92
     rank 12: 2515.09
     rank 13: 2515.13
     rank 14: 2515.09
     rank 15: 2515.13
  forward-compute:
     rank  0: 725.23
     rank  1: 724.51
     rank  2: 731.84
     rank  3: 735.68
     rank  4: 536.08
     rank  5: 537.66
     rank  6: 548.59
     rank  7: 551.17
     rank  8: 591.85
     rank  9: 596.60
     rank 10: 596.80
     rank 11: 597.68
     rank 12: 422.35
     rank 13: 431.18
     rank 14: 418.15
     rank 15: 421.48
  backward-compute:
     rank  0: 611.50
     rank  1: 613.34
     rank  2: 661.51
     rank  3: 658.65
     rank  4: 771.36
     rank  5: 777.08
     rank  6: 772.10
     rank  7: 772.39
     rank  8: 871.28
     rank  9: 877.98
     rank 10: 874.07
     rank 11: 876.35
     rank 12: 597.01
     rank 13: 594.90
     rank 14: 605.50
     rank 15: 605.10
  pure-backward-compute:
     rank  0: 611.05
     rank  1: 612.92
     rank  2: 660.97
     rank  3: 658.23
     rank  4: 770.76
     rank  5: 776.64
     rank  6: 771.59
     rank  7: 771.99
     rank  8: 869.70
     rank  9: 877.45
     rank 10: 873.38
     rank 11: 875.74
     rank 12: 594.19
     rank 13: 593.49
     rank 14: 604.28
     rank 15: 603.97
  batch-generator:
     rank  0: 30.71
     rank  1: 30.55
     rank  2: 37.16
     rank  3: 41.22
     rank  4: 24.64
     rank  5: 24.93
     rank  6: 30.53
     rank  7: 30.72
     rank  8: 25.19
     rank  9: 29.59
     rank 10: 29.78
     rank 11: 29.64
     rank 12: 34.00
     rank 13: 42.82
     rank 14: 31.04
     rank 15: 34.13
  forward-recv:
     rank  4: 140.88
     rank  5: 140.83
     rank  6: 133.12
     rank  7: 131.51
     rank  8: 185.70
     rank  9: 185.53
     rank 10: 175.18
     rank 11: 175.33
     rank 12: 237.12
     rank 13: 237.32
     rank 14: 242.84
     rank 15: 242.71
  forward-send:
     rank  0: 1.92
     rank  1: 2.15
     rank  2: 1.64
     rank  3: 1.33
     rank  4: 5.33
     rank  5: 5.61
     rank  6: 5.38
     rank  7: 5.67
     rank  8: 4.75
     rank  9: 4.91
     rank 10: 3.31
     rank 11: 3.14
  backward-recv:
     rank  0: 289.21
     rank  1: 288.87
     rank  2: 298.22
     rank  3: 300.36
     rank  4: 136.36
     rank  5: 134.94
     rank  6: 136.99
     rank  7: 136.93
     rank  8: 19.07
     rank  9: 21.02
     rank 10: 19.01
     rank 11: 19.17
  backward-send:
     rank  4: 1.35
     rank  5: 0.95
     rank  6: 1.01
     rank  7: 1.09
     rank  8: 9.20
     rank  9: 7.01
     rank 10: 9.29
     rank 11: 9.25
     rank 12: 4.76
     rank 13: 4.95
     rank 14: 5.18
     rank 15: 5.30
  forward-send-backward-recv:
     rank  0: 345.46
     rank  1: 343.49
     rank  2: 284.39
     rank  3: 284.21
     rank  4: 312.94
     rank  5: 311.65
     rank  6: 310.86
     rank  7: 310.45
     rank  8: 96.86
     rank  9: 91.29
     rank 10: 104.67
     rank 11: 101.88
  backward-send-forward-recv:
     rank  4: 4.33
     rank  5: 3.32
     rank  6: 4.69
     rank  7: 4.20
     rank  8: 33.79
     rank  9: 29.50
     rank 10: 32.52
     rank 11: 31.61
     rank 12: 439.30
     rank 13: 433.87
     rank 14: 430.68
     rank 15: 428.48
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.07
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.04
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.07
     rank 13: 0.09
     rank 14: 0.09
     rank 15: 0.07
  all-grads-sync:
     rank  0: 152.04
     rank  1: 145.42
     rank  2: 151.92
     rank  3: 145.49
     rank  4: 514.01
     rank  5: 513.68
     rank  6: 514.03
     rank  7: 513.65
     rank  8: 523.16
     rank  9: 523.00
     rank 10: 523.23
     rank 11: 523.00
     rank 12: 289.53
     rank 13: 277.06
     rank 14: 289.49
     rank 15: 277.07
  optimizer-copy-to-main-grad:
     rank  0: 0.28
     rank  1: 0.30
     rank  2: 0.69
     rank  3: 0.37
     rank  4: 0.04
     rank  5: 0.04
     rank  6: 0.04
     rank  7: 0.04
     rank  8: 0.05
     rank  9: 0.04
     rank 10: 0.06
     rank 11: 0.04
     rank 12: 0.03
     rank 13: 0.04
     rank 14: 0.05
     rank 15: 0.10
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 25.40
     rank  1: 25.52
     rank  2: 25.74
     rank  3: 25.57
     rank  4: 63.80
     rank  5: 63.80
     rank  6: 63.74
     rank  7: 63.76
     rank  8: 64.34
     rank  9: 64.29
     rank 10: 64.44
     rank 11: 64.23
     rank 12: 33.72
     rank 13: 33.82
     rank 14: 33.74
     rank 15: 33.76
  optimizer:
     rank  0: 26.86
     rank  1: 26.98
     rank  2: 27.19
     rank  3: 27.02
     rank  4: 65.25
     rank  5: 65.25
     rank  6: 65.20
     rank  7: 65.22
     rank  8: 65.80
     rank  9: 65.74
     rank 10: 65.89
     rank 11: 65.69
     rank 12: 35.18
     rank 13: 35.28
     rank 14: 35.19
     rank 15: 35.22
 [2024-12-24 22:44:51] iteration        4/      10 | consumed samples:           64 | elapsed time per iteration (ms): 2842.6 | learning rate: 3.000000E-06 | global batch size:    16 | lm loss: 3.352523E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2746.33
     rank  1: 2745.99
     rank  2: 2746.30
     rank  3: 2746.00
     rank  4: 2750.03
     rank  5: 2749.91
     rank  6: 2750.00
     rank  7: 2750.01
     rank  8: 2750.16
     rank  9: 2749.91
     rank 10: 2750.09
     rank 11: 2749.95
     rank 12: 2747.83
     rank 13: 2747.02
     rank 14: 2747.71
     rank 15: 2746.97
  forward-compute:
     rank  0: 921.79
     rank  1: 921.22
     rank  2: 1001.86
     rank  3: 1003.25
     rank  4: 538.93
     rank  5: 540.81
     rank  6: 550.56
     rank  7: 549.62
     rank  8: 601.14
     rank  9: 602.23
     rank 10: 594.82
     rank 11: 595.07
     rank 12: 811.46
     rank 13: 817.23
     rank 14: 411.44
     rank 15: 411.34
  backward-compute:
     rank  0: 630.80
     rank  1: 633.26
     rank  2: 615.41
     rank  3: 610.52
     rank  4: 775.80
     rank  5: 777.10
     rank  6: 777.60
     rank  7: 778.84
     rank  8: 872.05
     rank  9: 880.33
     rank 10: 875.48
     rank 11: 874.89
     rank 12: 595.04
     rank 13: 593.12
     rank 14: 604.01
     rank 15: 603.07
  pure-backward-compute:
     rank  0: 630.34
     rank  1: 632.84
     rank  2: 614.88
     rank  3: 610.01
     rank  4: 775.16
     rank  5: 776.63
     rank  6: 777.11
     rank  7: 778.02
     rank  8: 871.22
     rank  9: 879.65
     rank 10: 874.88
     rank 11: 874.18
     rank 12: 592.85
     rank 13: 592.18
     rank 14: 602.41
     rank 15: 602.29
  batch-generator:
     rank  0: 31.43
     rank  1: 31.78
     rank  2: 35.21
     rank  3: 38.55
     rank  4: 26.33
     rank  5: 27.73
     rank  6: 28.00
     rank  7: 29.16
     rank  8: 42.70
     rank  9: 40.04
     rank 10: 26.43
     rank 11: 26.22
     rank 12: 27.67
     rank 13: 33.43
     rank 14: 29.22
     rank 15: 29.33
  forward-recv:
     rank  4: 347.17
     rank  5: 347.40
     rank  6: 405.19
     rank  7: 405.07
     rank  8: 392.15
     rank  9: 392.16
     rank 10: 452.11
     rank 11: 452.46
     rank 12: 235.10
     rank 13: 235.00
     rank 14: 240.58
     rank 15: 240.41
  forward-send:
     rank  0: 1.85
     rank  1: 1.87
     rank  2: 1.59
     rank  3: 1.36
     rank  4: 5.55
     rank  5: 5.34
     rank  6: 5.56
     rank  7: 5.13
     rank  8: 5.21
     rank  9: 5.12
     rank 10: 2.90
     rank 11: 2.60
  backward-recv:
     rank  0: 327.39
     rank  1: 326.49
     rank  2: 308.86
     rank  3: 311.34
     rank  4: 179.98
     rank  5: 180.71
     rank  6: 130.60
     rank  7: 130.24
     rank  8: 67.22
     rank  9: 66.54
     rank 10: 19.02
     rank 11: 19.29
  backward-send:
     rank  4: 1.33
     rank  5: 0.87
     rank  6: 0.97
     rank  7: 1.15
     rank  8: 5.95
     rank  9: 5.37
     rank 10: 6.01
     rank 11: 5.76
     rank 12: 3.07
     rank 13: 2.32
     rank 14: 3.29
     rank 15: 3.21
  forward-send-backward-recv:
     rank  0: 319.68
     rank  1: 317.70
     rank  2: 260.71
     rank  3: 263.45
     rank  4: 269.63
     rank  5: 268.52
     rank  6: 252.72
     rank  7: 251.76
     rank  8: 54.55
     rank  9: 48.74
     rank 10: 55.67
     rank 11: 55.63
  backward-send-forward-recv:
     rank  4: 4.15
     rank  5: 3.30
     rank  6: 3.32
     rank  7: 4.39
     rank  8: 27.46
     rank  9: 26.39
     rank 10: 22.72
     rank 11: 22.28
     rank 12: 270.22
     rank 13: 267.24
     rank 14: 658.02
     rank 15: 660.22
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.26
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.08
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.24
     rank 13: 0.06
     rank 14: 0.06
     rank 15: 0.06
  all-grads-sync:
     rank  0: 152.08
     rank  1: 145.60
     rank  2: 151.99
     rank  3: 145.67
     rank  4: 517.44
     rank  5: 517.52
     rank  6: 517.44
     rank  7: 517.56
     rank  8: 532.76
     rank  9: 532.88
     rank 10: 532.78
     rank 11: 532.85
     rank 12: 297.38
     rank 13: 283.79
     rank 14: 297.40
     rank 15: 283.78
  optimizer-copy-to-main-grad:
     rank  0: 0.27
     rank  1: 0.30
     rank  2: 0.41
     rank  3: 0.24
     rank  4: 0.04
     rank  5: 0.04
     rank  6: 0.03
     rank  7: 0.08
     rank  8: 0.05
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.11
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 25.22
     rank  1: 25.20
     rank  2: 25.65
     rank  3: 24.92
     rank  4: 63.75
     rank  5: 63.79
     rank  6: 63.75
     rank  7: 63.88
     rank  8: 64.28
     rank  9: 64.24
     rank 10: 64.25
     rank 11: 64.29
     rank 12: 34.08
     rank 13: 33.67
     rank 14: 33.75
     rank 15: 33.71
  optimizer:
     rank  0: 26.36
     rank  1: 26.34
     rank  2: 26.79
     rank  3: 26.06
     rank  4: 64.90
     rank  5: 64.93
     rank  6: 64.90
     rank  7: 65.04
     rank  8: 65.44
     rank  9: 65.37
     rank 10: 65.39
     rank 11: 65.43
     rank 12: 35.21
     rank 13: 34.80
     rank 14: 34.89
     rank 15: 34.85
 [2024-12-24 22:44:54] iteration        5/      10 | consumed samples:           80 | elapsed time per iteration (ms): 2594.8 | learning rate: 3.750000E-06 | global batch size:    16 | lm loss: 3.275463E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2499.06
     rank  1: 2499.10
     rank  2: 2499.05
     rank  3: 2499.03
     rank  4: 2502.78
     rank  5: 2502.84
     rank  6: 2502.75
     rank  7: 2502.80
     rank  8: 2502.88
     rank  9: 2502.98
     rank 10: 2502.84
     rank 11: 2502.90
     rank 12: 2500.14
     rank 13: 2499.82
     rank 14: 2500.29
     rank 15: 2499.82
  forward-compute:
     rank  0: 737.33
     rank  1: 735.16
     rank  2: 717.80
     rank  3: 719.84
     rank  4: 545.13
     rank  5: 545.72
     rank  6: 546.53
     rank  7: 547.17
     rank  8: 599.66
     rank  9: 602.22
     rank 10: 592.59
     rank 11: 593.46
     rank 12: 417.13
     rank 13: 419.54
     rank 14: 442.36
     rank 15: 442.92
  backward-compute:
     rank  0: 666.29
     rank  1: 668.83
     rank  2: 588.62
     rank  3: 585.27
     rank  4: 774.72
     rank  5: 775.89
     rank  6: 777.69
     rank  7: 780.05
     rank  8: 872.37
     rank  9: 874.76
     rank 10: 875.94
     rank 11: 877.02
     rank 12: 596.92
     rank 13: 596.00
     rank 14: 609.47
     rank 15: 608.69
  pure-backward-compute:
     rank  0: 665.70
     rank  1: 668.29
     rank  2: 588.10
     rank  3: 584.82
     rank  4: 774.09
     rank  5: 775.42
     rank  6: 777.23
     rank  7: 779.61
     rank  8: 871.21
     rank  9: 874.18
     rank 10: 875.29
     rank 11: 876.53
     rank 12: 594.39
     rank 13: 595.04
     rank 14: 607.75
     rank 15: 607.92
  batch-generator:
     rank  0: 29.95
     rank  1: 33.64
     rank  2: 30.64
     rank  3: 33.28
     rank  4: 26.30
     rank  5: 27.36
     rank  6: 23.60
     rank  7: 23.81
     rank  8: 35.13
     rank  9: 32.73
     rank 10: 24.61
     rank 11: 26.17
     rank 12: 38.74
     rank 13: 38.52
     rank 14: 37.88
     rank 15: 36.62
  forward-recv:
     rank  4: 116.18
     rank  5: 117.71
     rank  6: 112.95
     rank  7: 112.50
     rank  8: 163.17
     rank  9: 162.62
     rank 10: 168.23
     rank 11: 167.47
     rank 12: 237.55
     rank 13: 237.46
     rank 14: 236.22
     rank 15: 237.20
  forward-send:
     rank  0: 2.00
     rank  1: 2.03
     rank  2: 1.64
     rank  3: 1.38
     rank  4: 7.89
     rank  5: 6.81
     rank  6: 7.82
     rank  7: 7.65
     rank  8: 5.13
     rank  9: 5.05
     rank 10: 4.34
     rank 11: 4.99
  backward-recv:
     rank  0: 264.29
     rank  1: 262.12
     rank  2: 306.27
     rank  3: 311.41
     rank  4: 134.42
     rank  5: 134.02
     rank  6: 139.63
     rank  7: 138.28
     rank  8: 19.00
     rank  9: 18.03
     rank 10: 21.79
     rank 11: 22.87
  backward-send:
     rank  4: 1.13
     rank  5: 0.88
     rank  6: 0.97
     rank  7: 0.91
     rank  8: 7.60
     rank  9: 6.66
     rank 10: 7.53
     rank 11: 6.72
     rank 12: 4.37
     rank 13: 3.47
     rank 14: 4.51
     rank 15: 4.53
  forward-send-backward-recv:
     rank  0: 302.01
     rank  1: 302.33
     rank  2: 352.85
     rank  3: 354.22
     rank  4: 322.77
     rank  5: 323.41
     rank  6: 319.45
     rank  7: 317.97
     rank  8: 111.16
     rank  9: 111.15
     rank 10: 112.40
     rank 11: 110.73
  backward-send-forward-recv:
     rank  4: 3.74
     rank  5: 3.64
     rank  6: 3.59
     rank  7: 3.62
     rank  8: 30.76
     rank  9: 29.47
     rank 10: 28.29
     rank 11: 27.72
     rank 12: 440.11
     rank 13: 440.74
     rank 14: 405.23
     rank 15: 405.74
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.10
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.06
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.07
     rank 13: 0.06
     rank 14: 0.16
     rank 15: 0.06
  all-grads-sync:
     rank  0: 152.22
     rank  1: 145.01
     rank  2: 152.14
     rank  3: 145.13
     rank  4: 512.02
     rank  5: 511.90
     rank  6: 512.00
     rank  7: 511.95
     rank  8: 515.58
     rank  9: 515.51
     rank 10: 515.59
     rank 11: 515.62
     rank 12: 291.42
     rank 13: 277.21
     rank 14: 291.33
     rank 15: 277.22
  optimizer-copy-to-main-grad:
     rank  0: 0.27
     rank  1: 0.28
     rank  2: 0.39
     rank  3: 0.26
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.04
     rank  8: 0.05
     rank  9: 0.05
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.04
     rank 13: 0.03
     rank 14: 0.07
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 25.06
     rank  1: 25.48
     rank  2: 24.85
     rank  3: 25.10
     rank  4: 63.85
     rank  5: 63.78
     rank  6: 63.73
     rank  7: 63.88
     rank  8: 64.32
     rank  9: 64.43
     rank 10: 64.29
     rank 11: 64.28
     rank 12: 33.76
     rank 13: 33.63
     rank 14: 33.94
     rank 15: 33.69
  optimizer:
     rank  0: 26.07
     rank  1: 26.49
     rank  2: 25.93
     rank  3: 26.10
     rank  4: 64.86
     rank  5: 64.78
     rank  6: 64.73
     rank  7: 64.89
     rank  8: 65.32
     rank  9: 65.44
     rank 10: 65.30
     rank 11: 65.28
     rank 12: 34.78
     rank 13: 34.64
     rank 14: 34.95
     rank 15: 34.70
 [2024-12-24 22:44:56] iteration        6/      10 | consumed samples:           96 | elapsed time per iteration (ms): 2618.5 | learning rate: 4.500000E-06 | global batch size:    16 | lm loss: 2.629133E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2516.63
     rank  1: 2516.54
     rank  2: 2516.75
     rank  3: 2516.56
     rank  4: 2520.58
     rank  5: 2520.36
     rank  6: 2520.69
     rank  7: 2520.32
     rank  8: 2520.54
     rank  9: 2520.36
     rank 10: 2520.57
     rank 11: 2520.40
     rank 12: 2517.67
     rank 13: 2517.54
     rank 14: 2517.76
     rank 15: 2517.52
  forward-compute:
     rank  0: 718.86
     rank  1: 719.53
     rank  2: 714.20
     rank  3: 716.47
     rank  4: 551.34
     rank  5: 553.80
     rank  6: 573.12
     rank  7: 573.93
     rank  8: 600.25
     rank  9: 602.83
     rank 10: 592.38
     rank 11: 592.95
     rank 12: 408.71
     rank 13: 411.63
     rank 14: 438.60
     rank 15: 431.28
  backward-compute:
     rank  0: 626.60
     rank  1: 629.77
     rank  2: 618.90
     rank  3: 617.93
     rank  4: 774.20
     rank  5: 775.80
     rank  6: 777.27
     rank  7: 776.91
     rank  8: 873.01
     rank  9: 875.16
     rank 10: 882.18
     rank 11: 874.54
     rank 12: 596.41
     rank 13: 595.44
     rank 14: 605.70
     rank 15: 605.32
  pure-backward-compute:
     rank  0: 626.23
     rank  1: 629.35
     rank  2: 618.40
     rank  3: 617.40
     rank  4: 773.52
     rank  5: 775.34
     rank  6: 776.24
     rank  7: 776.22
     rank  8: 872.04
     rank  9: 874.65
     rank 10: 881.60
     rank 11: 874.03
     rank 12: 595.20
     rank 13: 594.42
     rank 14: 603.91
     rank 15: 604.58
  batch-generator:
     rank  0: 31.59
     rank  1: 31.33
     rank  2: 31.14
     rank  3: 33.73
     rank  4: 37.82
     rank  5: 38.46
     rank  6: 40.34
     rank  7: 41.75
     rank  8: 31.00
     rank  9: 31.11
     rank 10: 23.83
     rank 11: 24.27
     rank 12: 28.48
     rank 13: 31.74
     rank 14: 44.11
     rank 15: 33.65
  forward-recv:
     rank  4: 137.72
     rank  5: 138.47
     rank  6: 125.50
     rank  7: 126.02
     rank  8: 180.05
     rank  9: 179.34
     rank 10: 173.20
     rank 11: 172.42
     rank 12: 243.23
     rank 13: 243.48
     rank 14: 233.48
     rank 15: 233.73
  forward-send:
     rank  0: 2.04
     rank  1: 2.09
     rank  2: 1.42
     rank  3: 1.33
     rank  4: 5.38
     rank  5: 4.80
     rank  6: 5.57
     rank  7: 4.95
     rank  8: 4.68
     rank  9: 4.96
     rank 10: 2.76
     rank 11: 3.00
  backward-recv:
     rank  0: 283.43
     rank  1: 281.75
     rank  2: 303.33
     rank  3: 306.59
     rank  4: 132.25
     rank  5: 131.83
     rank  6: 131.69
     rank  7: 133.05
     rank  8: 14.32
     rank  9: 13.48
     rank 10: 17.88
     rank 11: 17.40
  backward-send:
     rank  4: 1.24
     rank  5: 1.12
     rank  6: 1.75
     rank  7: 1.11
     rank  8: 8.33
     rank  9: 7.20
     rank 10: 7.79
     rank 11: 8.11
     rank 12: 3.54
     rank 13: 2.46
     rank 14: 3.63
     rank 15: 3.64
  forward-send-backward-recv:
     rank  0: 343.90
     rank  1: 340.55
     rank  2: 337.23
     rank  3: 336.74
     rank  4: 301.50
     rank  5: 301.48
     rank  6: 289.09
     rank  7: 290.62
     rank  8: 94.35
     rank  9: 97.84
     rank 10: 105.51
     rank 11: 111.37
  backward-send-forward-recv:
     rank  4: 4.71
     rank  5: 2.91
     rank  6: 5.31
     rank  7: 4.06
     rank  8: 32.69
     rank  9: 31.48
     rank 10: 31.76
     rank 11: 32.12
     rank 12: 448.17
     rank 13: 446.44
     rank 14: 419.07
     rank 15: 428.40
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.04
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.07
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.04
     rank 13: 0.02
     rank 14: 0.04
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.07
     rank  6: 0.18
     rank  7: 0.05
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.09
     rank 13: 0.06
     rank 14: 0.09
     rank 15: 0.06
  all-grads-sync:
     rank  0: 152.41
     rank  1: 146.19
     rank  2: 152.29
     rank  3: 146.30
     rank  4: 517.61
     rank  5: 516.46
     rank  6: 517.61
     rank  7: 516.46
     rank  8: 526.61
     rank  9: 526.98
     rank 10: 526.63
     rank 11: 526.91
     rank 12: 292.51
     rank 13: 280.68
     rank 14: 292.41
     rank 15: 280.69
  optimizer-copy-to-main-grad:
     rank  0: 0.26
     rank  1: 0.27
     rank  2: 0.51
     rank  3: 0.23
     rank  4: 0.04
     rank  5: 0.04
     rank  6: 0.11
     rank  7: 0.03
     rank  8: 0.07
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.05
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 24.75
     rank  1: 24.82
     rank  2: 25.72
     rank  3: 24.87
     rank  4: 63.78
     rank  5: 63.84
     rank  6: 64.10
     rank  7: 63.83
     rank  8: 64.40
     rank  9: 64.24
     rank 10: 64.28
     rank 11: 64.36
     rank 12: 33.72
     rank 13: 33.73
     rank 14: 33.82
     rank 15: 33.77
  optimizer:
     rank  0: 25.98
     rank  1: 26.05
     rank  2: 26.95
     rank  3: 26.10
     rank  4: 65.01
     rank  5: 65.07
     rank  6: 65.34
     rank  7: 65.06
     rank  8: 65.64
     rank  9: 65.47
     rank 10: 65.51
     rank 11: 65.59
     rank 12: 34.95
     rank 13: 34.96
     rank 14: 35.05
     rank 15: 35.01
 [2024-12-24 22:44:59] iteration        7/      10 | consumed samples:          112 | elapsed time per iteration (ms): 2634.8 | learning rate: 5.250000E-06 | global batch size:    16 | lm loss: 2.205462E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2534.47
     rank  1: 2534.50
     rank  2: 2534.55
     rank  3: 2534.61
     rank  4: 2538.26
     rank  5: 2538.18
     rank  6: 2538.26
     rank  7: 2538.23
     rank  8: 2538.33
     rank  9: 2538.26
     rank 10: 2538.33
     rank 11: 2538.29
     rank 12: 2535.51
     rank 13: 2535.38
     rank 14: 2535.61
     rank 15: 2535.35
  forward-compute:
     rank  0: 724.59
     rank  1: 724.29
     rank  2: 755.68
     rank  3: 757.53
     rank  4: 550.63
     rank  5: 551.32
     rank  6: 572.37
     rank  7: 575.21
     rank  8: 597.64
     rank  9: 600.23
     rank 10: 598.67
     rank 11: 600.13
     rank 12: 434.57
     rank 13: 443.33
     rank 14: 430.50
     rank 15: 430.52
  backward-compute:
     rank  0: 595.11
     rank  1: 598.22
     rank  2: 639.62
     rank  3: 639.35
     rank  4: 774.63
     rank  5: 777.38
     rank  6: 774.78
     rank  7: 776.86
     rank  8: 876.11
     rank  9: 884.42
     rank 10: 878.35
     rank 11: 879.48
     rank 12: 599.17
     rank 13: 597.20
     rank 14: 604.43
     rank 15: 603.81
  pure-backward-compute:
     rank  0: 594.67
     rank  1: 597.80
     rank  2: 639.03
     rank  3: 638.91
     rank  4: 773.92
     rank  5: 776.89
     rank  6: 773.83
     rank  7: 776.46
     rank  8: 875.11
     rank  9: 884.00
     rank 10: 877.60
     rank 11: 879.06
     rank 12: 596.49
     rank 13: 596.32
     rank 14: 602.92
     rank 15: 603.06
  batch-generator:
     rank  0: 30.20
     rank  1: 30.08
     rank  2: 36.24
     rank  3: 38.12
     rank  4: 25.07
     rank  5: 29.71
     rank  6: 44.28
     rank  7: 43.04
     rank  8: 32.83
     rank  9: 33.75
     rank 10: 29.09
     rank 11: 29.67
     rank 12: 34.54
     rank 13: 41.78
     rank 14: 38.53
     rank 15: 36.76
  forward-recv:
     rank  4: 127.43
     rank  5: 127.63
     rank  6: 130.00
     rank  7: 130.16
     rank  8: 170.12
     rank  9: 170.47
     rank 10: 179.00
     rank 11: 178.87
     rank 12: 234.30
     rank 13: 234.10
     rank 14: 244.12
     rank 15: 244.27
  forward-send:
     rank  0: 2.02
     rank  1: 2.07
     rank  2: 1.45
     rank  3: 1.42
     rank  4: 5.57
     rank  5: 5.46
     rank  6: 5.43
     rank  7: 5.47
     rank  8: 5.28
     rank  9: 5.13
     rank 10: 2.81
     rank 11: 2.95
  backward-recv:
     rank  0: 304.85
     rank  1: 302.44
     rank  2: 287.48
     rank  3: 288.39
     rank  4: 138.68
     rank  5: 138.19
     rank  6: 138.54
     rank  7: 139.83
     rank  8: 18.33
     rank  9: 16.87
     rank 10: 18.40
     rank 11: 18.57
  backward-send:
     rank  4: 1.37
     rank  5: 0.83
     rank  6: 1.73
     rank  7: 0.96
     rank  8: 9.55
     rank  9: 7.89
     rank 10: 9.62
     rank 11: 9.60
     rank 12: 4.24
     rank 13: 1.91
     rank 14: 4.22
     rank 15: 4.14
  forward-send-backward-recv:
     rank  0: 360.32
     rank  1: 359.16
     rank  2: 312.11
     rank  3: 310.63
     rank  4: 320.63
     rank  5: 319.85
     rank  6: 295.74
     rank  7: 293.39
     rank  8: 112.08
     rank  9: 109.20
     rank 10: 105.79
     rank 11: 104.41
  backward-send-forward-recv:
     rank  4: 4.08
     rank  5: 3.92
     rank  6: 5.16
     rank  7: 3.41
     rank  8: 34.62
     rank  9: 32.24
     rank 10: 33.79
     rank 11: 32.73
     rank 12: 439.70
     rank 13: 434.28
     rank 14: 429.76
     rank 15: 431.55
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.04
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.06
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.07
     rank  5: 0.05
     rank  6: 0.07
     rank  7: 0.05
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.06
     rank 13: 0.05
     rank 14: 0.12
     rank 15: 0.05
  all-grads-sync:
     rank  0: 151.84
     rank  1: 145.10
     rank  2: 151.77
     rank  3: 145.24
     rank  4: 525.41
     rank  5: 524.92
     rank  6: 525.41
     rank  7: 524.84
     rank  8: 519.78
     rank  9: 519.65
     rank 10: 519.74
     rank 11: 519.67
     rank 12: 295.92
     rank 13: 282.60
     rank 14: 295.81
     rank 15: 282.59
  optimizer-copy-to-main-grad:
     rank  0: 0.27
     rank  1: 0.27
     rank  2: 0.41
     rank  3: 0.35
     rank  4: 0.05
     rank  5: 0.03
     rank  6: 0.05
     rank  7: 0.03
     rank  8: 0.06
     rank  9: 0.04
     rank 10: 0.05
     rank 11: 0.04
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.04
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 25.03
     rank  1: 25.43
     rank  2: 25.16
     rank  3: 25.38
     rank  4: 63.90
     rank  5: 63.82
     rank  6: 63.84
     rank  7: 63.81
     rank  8: 64.46
     rank  9: 64.25
     rank 10: 64.36
     rank 11: 64.22
     rank 12: 33.67
     rank 13: 33.67
     rank 14: 33.86
     rank 15: 33.63
  optimizer:
     rank  0: 26.15
     rank  1: 26.56
     rank  2: 26.29
     rank  3: 26.49
     rank  4: 65.02
     rank  5: 64.92
     rank  6: 64.96
     rank  7: 64.93
     rank  8: 65.58
     rank  9: 65.36
     rank 10: 65.48
     rank 11: 65.33
     rank 12: 34.79
     rank 13: 34.78
     rank 14: 34.98
     rank 15: 34.75
 [2024-12-24 22:45:02] iteration        8/      10 | consumed samples:          128 | elapsed time per iteration (ms): 2626.3 | learning rate: 6.000000E-06 | global batch size:    16 | lm loss: 2.050363E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2526.22
     rank  1: 2526.12
     rank  2: 2526.28
     rank  3: 2526.15
     rank  4: 2529.97
     rank  5: 2530.00
     rank  6: 2530.05
     rank  7: 2529.96
     rank  8: 2530.02
     rank  9: 2530.03
     rank 10: 2530.08
     rank 11: 2530.01
     rank 12: 2527.36
     rank 13: 2527.17
     rank 14: 2527.29
     rank 15: 2527.17
  forward-compute:
     rank  0: 727.59
     rank  1: 727.52
     rank  2: 715.72
     rank  3: 716.82
     rank  4: 545.94
     rank  5: 547.66
     rank  6: 559.26
     rank  7: 561.93
     rank  8: 594.40
     rank  9: 601.99
     rank 10: 598.60
     rank 11: 599.87
     rank 12: 419.89
     rank 13: 436.92
     rank 14: 424.69
     rank 15: 425.98
  backward-compute:
     rank  0: 622.19
     rank  1: 623.11
     rank  2: 670.12
     rank  3: 666.50
     rank  4: 776.63
     rank  5: 781.42
     rank  6: 774.87
     rank  7: 776.05
     rank  8: 875.20
     rank  9: 887.69
     rank 10: 876.55
     rank 11: 876.34
     rank 12: 600.05
     rank 13: 597.87
     rank 14: 604.85
     rank 15: 604.18
  pure-backward-compute:
     rank  0: 621.68
     rank  1: 622.67
     rank  2: 669.48
     rank  3: 666.07
     rank  4: 776.10
     rank  5: 780.97
     rank  6: 774.14
     rank  7: 775.56
     rank  8: 874.01
     rank  9: 887.17
     rank 10: 875.72
     rank 11: 875.81
     rank 12: 596.81
     rank 13: 596.82
     rank 14: 603.49
     rank 15: 603.36
  batch-generator:
     rank  0: 36.73
     rank  1: 35.82
     rank  2: 31.92
     rank  3: 33.54
     rank  4: 28.16
     rank  5: 27.98
     rank  6: 36.25
     rank  7: 36.49
     rank  8: 27.38
     rank  9: 33.54
     rank 10: 30.57
     rank 11: 30.74
     rank 12: 32.81
     rank 13: 49.49
     rank 14: 34.89
     rank 15: 34.59
  forward-recv:
     rank  4: 113.96
     rank  5: 116.42
     rank  6: 115.63
     rank  7: 115.08
     rank  8: 164.67
     rank  9: 163.06
     rank 10: 171.51
     rank 11: 172.06
     rank 12: 243.58
     rank 13: 243.06
     rank 14: 237.31
     rank 15: 237.00
  forward-send:
     rank  0: 2.07
     rank  1: 1.99
     rank  2: 1.95
     rank  3: 1.68
     rank  4: 10.43
     rank  5: 7.76
     rank  6: 9.06
     rank  7: 9.33
     rank  8: 4.90
     rank  9: 4.15
     rank 10: 2.79
     rank 11: 2.42
  backward-recv:
     rank  0: 294.47
     rank  1: 295.26
     rank  2: 251.85
     rank  3: 257.11
     rank  4: 136.56
     rank  5: 135.01
     rank  6: 137.00
     rank  7: 136.51
     rank  8: 18.36
     rank  9: 19.33
     rank 10: 18.37
     rank 11: 18.69
  backward-send:
     rank  4: 0.95
     rank  5: 1.07
     rank  6: 1.05
     rank  7: 1.22
     rank  8: 9.23
     rank  9: 7.47
     rank 10: 9.58
     rank 11: 9.37
     rank 12: 4.94
     rank 13: 4.42
     rank 14: 5.08
     rank 15: 5.13
  forward-send-backward-recv:
     rank  0: 330.35
     rank  1: 329.24
     rank  2: 349.70
     rank  3: 348.77
     rank  4: 324.05
     rank  5: 320.55
     rank  6: 311.07
     rank  7: 309.64
     rank  8: 110.52
     rank  9: 102.18
     rank 10: 105.84
     rank 11: 106.68
  backward-send-forward-recv:
     rank  4: 4.23
     rank  5: 3.92
     rank  6: 4.86
     rank  7: 3.43
     rank  8: 33.78
     rank  9: 29.70
     rank 10: 33.03
     rank 11: 32.00
     rank 12: 432.90
     rank 13: 420.50
     rank 14: 430.67
     rank 15: 431.53
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.04
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.05
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.09
     rank  6: 0.07
     rank  7: 0.05
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.10
     rank 13: 0.06
     rank 14: 0.07
     rank 15: 0.06
  all-grads-sync:
     rank  0: 152.53
     rank  1: 146.46
     rank  2: 152.41
     rank  3: 146.59
     rank  4: 512.59
     rank  5: 512.56
     rank  6: 512.54
     rank  7: 512.60
     rank  8: 523.23
     rank  9: 523.27
     rank 10: 523.19
     rank 11: 523.28
     rank 12: 280.30
     rank 13: 268.06
     rank 14: 280.46
     rank 15: 268.06
  optimizer-copy-to-main-grad:
     rank  0: 0.25
     rank  1: 0.26
     rank  2: 0.39
     rank  3: 0.24
     rank  4: 0.04
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.03
     rank  8: 0.04
     rank  9: 0.03
     rank 10: 0.05
     rank 11: 0.04
     rank 12: 0.05
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 25.05
     rank  1: 25.15
     rank  2: 25.59
     rank  3: 24.98
     rank  4: 63.81
     rank  5: 63.92
     rank  6: 63.84
     rank  7: 63.78
     rank  8: 64.28
     rank  9: 64.32
     rank 10: 64.38
     rank 11: 64.23
     rank 12: 33.78
     rank 13: 33.73
     rank 14: 33.72
     rank 15: 33.68
  optimizer:
     rank  0: 26.03
     rank  1: 26.13
     rank  2: 26.58
     rank  3: 25.96
     rank  4: 64.80
     rank  5: 64.90
     rank  6: 64.84
     rank  7: 64.77
     rank  8: 65.26
     rank  9: 65.39
     rank 10: 65.37
     rank 11: 65.21
     rank 12: 34.76
     rank 13: 34.72
     rank 14: 34.70
     rank 15: 34.67
 [2024-12-24 22:45:04] iteration        9/      10 | consumed samples:          144 | elapsed time per iteration (ms): 2624.0 | learning rate: 6.750000E-06 | global batch size:    16 | lm loss: 2.689013E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2523.63
     rank  1: 2523.78
     rank  2: 2523.60
     rank  3: 2523.65
     rank  4: 2527.42
     rank  5: 2527.38
     rank  6: 2527.38
     rank  7: 2527.36
     rank  8: 2527.55
     rank  9: 2527.47
     rank 10: 2527.48
     rank 11: 2527.43
     rank 12: 2524.65
     rank 13: 2524.51
     rank 14: 2524.64
     rank 15: 2524.48
  forward-compute:
     rank  0: 741.74
     rank  1: 741.15
     rank  2: 760.10
     rank  3: 761.51
     rank  4: 535.04
     rank  5: 535.64
     rank  6: 551.31
     rank  7: 551.96
     rank  8: 594.35
     rank  9: 597.45
     rank 10: 597.77
     rank 11: 599.51
     rank 12: 428.58
     rank 13: 439.03
     rank 14: 428.26
     rank 15: 430.97
  backward-compute:
     rank  0: 611.92
     rank  1: 614.68
     rank  2: 624.96
     rank  3: 620.61
     rank  4: 776.80
     rank  5: 780.23
     rank  6: 776.20
     rank  7: 777.94
     rank  8: 876.63
     rank  9: 886.69
     rank 10: 878.31
     rank 11: 881.53
     rank 12: 600.87
     rank 13: 598.27
     rank 14: 608.72
     rank 15: 610.22
  pure-backward-compute:
     rank  0: 611.45
     rank  1: 614.22
     rank  2: 624.42
     rank  3: 620.09
     rank  4: 776.32
     rank  5: 779.83
     rank  6: 775.73
     rank  7: 777.51
     rank  8: 875.20
     rank  9: 886.04
     rank 10: 877.61
     rank 11: 880.98
     rank 12: 597.58
     rank 13: 597.29
     rank 14: 607.15
     rank 15: 609.25
  batch-generator:
     rank  0: 32.67
     rank  1: 34.65
     rank  2: 35.23
     rank  3: 38.08
     rank  4: 22.63
     rank  5: 22.80
     rank  6: 30.43
     rank  7: 30.22
     rank  8: 27.26
     rank  9: 31.44
     rank 10: 28.65
     rank 11: 28.92
     rank 12: 33.74
     rank 13: 44.00
     rank 14: 39.22
     rank 15: 39.23
  forward-recv:
     rank  4: 129.04
     rank  5: 130.45
     rank  6: 132.32
     rank  7: 133.13
     rank  8: 168.80
     rank  9: 167.44
     rank 10: 178.34
     rank 11: 178.33
     rank 12: 233.72
     rank 13: 233.84
     rank 14: 237.79
     rank 15: 237.41
  forward-send:
     rank  0: 2.01
     rank  1: 2.06
     rank  2: 1.42
     rank  3: 1.32
     rank  4: 5.30
     rank  5: 4.35
     rank  6: 5.48
     rank  7: 4.63
     rank  8: 4.59
     rank  9: 5.10
     rank 10: 3.32
     rank 11: 2.87
  backward-recv:
     rank  0: 302.83
     rank  1: 300.41
     rank  2: 300.20
     rank  3: 302.32
     rank  4: 138.88
     rank  5: 137.99
     rank  6: 139.78
     rank  7: 139.61
     rank  8: 19.04
     rank  9: 18.46
     rank 10: 19.69
     rank 11: 20.05
  backward-send:
     rank  4: 1.18
     rank  5: 0.93
     rank  6: 1.00
     rank  7: 1.08
     rank  8: 9.46
     rank  9: 8.14
     rank 10: 9.87
     rank 11: 9.63
     rank 12: 4.24
     rank 13: 2.16
     rank 14: 4.24
     rank 15: 4.24
  forward-send-backward-recv:
     rank  0: 324.72
     rank  1: 324.76
     rank  2: 306.23
     rank  3: 306.92
     rank  4: 323.39
     rank  5: 322.39
     rank  6: 304.17
     rank  7: 304.91
     rank  8: 108.05
     rank  9: 104.90
     rank 10: 98.23
     rank 11: 95.58
  backward-send-forward-recv:
     rank  4: 4.59
     rank  5: 4.47
     rank  6: 4.70
     rank  7: 4.56
     rank  8: 34.19
     rank  9: 30.86
     rank 10: 33.39
     rank 11: 32.71
     rank 12: 436.49
     rank 13: 429.97
     rank 14: 426.29
     rank 15: 423.81
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.09
     rank 13: 0.04
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.06
     rank  6: 0.06
     rank  7: 0.05
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.12
     rank 13: 0.07
     rank 14: 0.08
     rank 15: 0.05
  all-grads-sync:
     rank  0: 151.97
     rank  1: 145.07
     rank  2: 151.88
     rank  3: 145.21
     rank  4: 511.63
     rank  5: 511.63
     rank  6: 511.62
     rank  7: 511.59
     rank  8: 519.74
     rank  9: 519.78
     rank 10: 519.75
     rank 11: 519.79
     rank 12: 297.34
     rank 13: 283.55
     rank 14: 297.41
     rank 15: 283.55
  optimizer-copy-to-main-grad:
     rank  0: 0.27
     rank  1: 0.27
     rank  2: 0.29
     rank  3: 0.23
     rank  4: 0.04
     rank  5: 0.04
     rank  6: 0.04
     rank  7: 0.03
     rank  8: 0.06
     rank  9: 0.05
     rank 10: 0.05
     rank 11: 0.04
     rank 12: 0.05
     rank 13: 0.04
     rank 14: 0.05
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 24.79
     rank  1: 25.53
     rank  2: 24.74
     rank  3: 24.75
     rank  4: 63.81
     rank  5: 63.81
     rank  6: 63.84
     rank  7: 63.80
     rank  8: 64.38
     rank  9: 64.37
     rank 10: 64.35
     rank 11: 64.25
     rank 12: 33.82
     rank 13: 33.68
     rank 14: 33.73
     rank 15: 33.70
  optimizer:
     rank  0: 25.78
     rank  1: 26.53
     rank  2: 25.74
     rank  3: 25.74
     rank  4: 64.79
     rank  5: 64.79
     rank  6: 64.82
     rank  7: 64.79
     rank  8: 65.37
     rank  9: 65.38
     rank 10: 65.34
     rank 11: 65.24
     rank 12: 34.81
     rank 13: 34.67
     rank 14: 34.71
     rank 15: 34.69
 [2024-12-24 22:45:07] iteration       10/      10 | consumed samples:          160 | elapsed time per iteration (ms): 2631.4 | learning rate: 7.500000E-06 | global batch size:    16 | lm loss: 1.050446E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2531.31
     rank  1: 2531.30
     rank  2: 2531.32
     rank  3: 2531.34
     rank  4: 2535.05
     rank  5: 2535.04
     rank  6: 2535.04
     rank  7: 2535.04
     rank  8: 2535.13
     rank  9: 2535.30
     rank 10: 2535.17
     rank 11: 2535.23
     rank 12: 2532.39
     rank 13: 2532.27
     rank 14: 2532.39
     rank 15: 2532.25
  forward-compute:
     rank  0: 737.76
     rank  1: 737.06
     rank  2: 730.72
     rank  3: 732.01
     rank  4: 535.26
     rank  5: 535.79
     rank  6: 545.53
     rank  7: 545.31
     rank  8: 594.14
     rank  9: 598.74
     rank 10: 600.77
     rank 11: 601.75
     rank 12: 425.89
     rank 13: 437.07
     rank 14: 423.58
     rank 15: 426.83
  backward-compute:
     rank  0: 665.70
     rank  1: 666.09
     rank  2: 646.14
     rank  3: 640.25
     rank  4: 777.60
     rank  5: 781.38
     rank  6: 776.03
     rank  7: 777.84
     rank  8: 878.69
     rank  9: 886.62
     rank 10: 878.63
     rank 11: 879.06
     rank 12: 601.74
     rank 13: 599.34
     rank 14: 607.33
     rank 15: 606.80
  pure-backward-compute:
     rank  0: 665.16
     rank  1: 665.53
     rank  2: 645.58
     rank  3: 639.70
     rank  4: 777.15
     rank  5: 780.97
     rank  6: 775.62
     rank  7: 777.45
     rank  8: 876.69
     rank  9: 885.95
     rank 10: 877.96
     rank 11: 878.31
     rank 12: 598.33
     rank 13: 598.44
     rank 14: 605.84
     rank 15: 605.96
  batch-generator:
     rank  0: 30.15
     rank  1: 33.44
     rank  2: 36.72
     rank  3: 37.65
     rank  4: 23.87
     rank  5: 24.27
     rank  6: 22.41
     rank  7: 22.36
     rank  8: 28.62
     rank  9: 33.00
     rank 10: 28.63
     rank 11: 28.29
     rank 12: 32.84
     rank 13: 42.77
     rank 14: 35.31
     rank 15: 36.63
  forward-recv:
     rank  4: 126.85
     rank  5: 127.77
     rank  6: 122.39
     rank  7: 121.77
     rank  8: 168.88
     rank  9: 168.89
     rank 10: 169.48
     rank 11: 170.56
     rank 12: 238.67
     rank 13: 238.38
     rank 14: 238.73
     rank 15: 238.38
  forward-send:
     rank  0: 2.00
     rank  1: 2.07
     rank  2: 1.65
     rank  3: 1.61
     rank  4: 9.93
     rank  5: 9.29
     rank  6: 9.66
     rank  7: 9.81
     rank  8: 5.92
     rank  9: 5.29
     rank 10: 5.95
     rank 11: 5.27
  backward-recv:
     rank  0: 278.42
     rank  1: 278.22
     rank  2: 286.96
     rank  3: 292.54
     rank  4: 137.55
     rank  5: 136.72
     rank  6: 137.78
     rank  7: 137.23
     rank  8: 19.48
     rank  9: 19.82
     rank 10: 19.41
     rank 11: 19.51
  backward-send:
     rank  4: 1.03
     rank  5: 0.90
     rank  6: 0.93
     rank  7: 1.02
     rank  8: 9.93
     rank  9: 8.73
     rank 10: 9.61
     rank 11: 9.49
     rank 12: 4.89
     rank 13: 3.55
     rank 14: 4.81
     rank 15: 4.76
  forward-send-backward-recv:
     rank  0: 297.56
     rank  1: 298.89
     rank  2: 327.49
     rank  3: 328.85
     rank  4: 325.42
     rank  5: 324.44
     rank  6: 324.51
     rank  7: 323.92
     rank  8: 106.23
     rank  9: 102.48
     rank 10: 103.85
     rank 11: 103.53
  backward-send-forward-recv:
     rank  4: 4.21
     rank  5: 3.89
     rank  6: 3.57
     rank  7: 4.21
     rank  8: 33.89
     rank  9: 31.79
     rank 10: 34.07
     rank 11: 33.28
     rank 12: 435.54
     rank 13: 429.39
     rank 14: 433.71
     rank 15: 432.56
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.05
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.02
     rank  9: 0.05
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.06
     rank 13: 0.05
     rank 14: 0.06
     rank 15: 0.05
  all-grads-sync:
     rank  0: 152.15
     rank  1: 145.97
     rank  2: 152.03
     rank  3: 146.04
     rank  4: 512.14
     rank  5: 511.09
     rank  6: 512.15
     rank  7: 511.08
     rank  8: 524.77
     rank  9: 524.82
     rank 10: 524.79
     rank 11: 524.80
     rank 12: 287.68
     rank 13: 275.14
     rank 14: 287.68
     rank 15: 275.14
  optimizer-copy-to-main-grad:
     rank  0: 0.26
     rank  1: 0.26
     rank  2: 0.36
     rank  3: 0.24
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.04
     rank  7: 0.03
     rank  8: 0.05
     rank  9: 0.06
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 25.17
     rank  1: 25.20
     rank  2: 25.07
     rank  3: 24.84
     rank  4: 63.78
     rank  5: 63.83
     rank  6: 63.80
     rank  7: 63.84
     rank  8: 64.31
     rank  9: 64.50
     rank 10: 64.34
     rank 11: 64.33
     rank 12: 33.68
     rank 13: 33.66
     rank 14: 33.70
     rank 15: 33.65
  optimizer:
     rank  0: 26.09
     rank  1: 26.12
     rank  2: 26.00
     rank  3: 25.76
     rank  4: 64.70
     rank  5: 64.75
     rank  6: 64.72
     rank  7: 64.78
     rank  8: 65.22
     rank  9: 65.43
     rank 10: 65.26
     rank 11: 65.25
     rank 12: 34.60
     rank 13: 34.58
     rank 14: 34.63
     rank 15: 34.57
