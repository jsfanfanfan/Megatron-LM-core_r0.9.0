examples/multimodal/pretrain-freeze-llm-hete-2080first.sh: line 4: activate: No such file or directory
3
[2024-12-24 22:34:57,403] torch.distributed.run: [WARNING] 
[2024-12-24 22:34:57,403] torch.distributed.run: [WARNING] *****************************************
[2024-12-24 22:34:57,403] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-12-24 22:34:57,403] torch.distributed.run: [WARNING] *****************************************
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:8------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:8------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:8------
------num_pipeline_model_parallel_groups:4------
> setting tensorboard ...
WARNING: one_logger package is required to enable e2e metrics tracking. please go to https://confluence.nvidia.com/display/MLWFO/Package+Repositories for details to install it
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:8------
------num_pipeline_model_parallel_groups:4------
---Rank 15---Tensor Parallel Group GPUs: [1, 1]
---Rank 15---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
---Rank 13---Tensor Parallel Group GPUs: [1, 1]
---Rank 13---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
[rank15]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
---Rank 14---Tensor Parallel Group GPUs: [0, 0]
---Rank 14---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
---Rank 12---Tensor Parallel Group GPUs: [0, 0]
---Rank 12---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
[rank13]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank14]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank12]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
 > number of parameters on (tensor, pipeline) model parallel rank (0, 3): 285233152
 > number of parameters on (tensor, pipeline) model parallel rank (1, 3): 285233152
INFO:megatron.core.distributed.param_and_grad_buffer:Number of buckets for gradient all-reduce / reduce-scatter: 1
Params for bucket 1 (285233152 elements):
	language_model.decoder.layers.1.mlp.linear_fc2.weight
	language_model.decoder.final_layernorm.weight
	language_model.decoder.layers.1.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.1.self_attention.linear_qkv.weight
	language_model.decoder.layers.1.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.1.self_attention.linear_proj.weight
	language_model.decoder.layers.0.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.0.self_attention.linear_qkv.weight
	language_model.decoder.layers.0.self_attention.linear_qkv.layer_norm_weight
	language_model.output_layer.weight
	language_model.decoder.layers.1.mlp.linear_fc1.weight
	language_model.decoder.layers.0.mlp.linear_fc2.weight
	language_model.decoder.layers.0.mlp.linear_fc1.weight
	language_model.decoder.layers.0.self_attention.linear_proj.weight
rank=1, worker=0: shard_range=[pretrain-31.tar[0, 100), pretrain-31.tar[100, 200), pretrain-31.tar[200, 300), ...<1244>, pretrain-42.tar[4700, 4800), pretrain-42.tar[4800, 4900), pretrain-42.tar[4900, 5000)] sum(count)=125000
rank=1, worker=1: shard_range=[pretrain-42.tar[5000, 5100), pretrain-42.tar[5100, 5200), pretrain-42.tar[5200, 5300), ...<1244>, pretrain-53.tar[9700, 9800), pretrain-53.tar[9800, 9900), pretrain-53.tar[9900, 10000)] sum(count)=125000
rank=0, worker=0: shard_range=[pretrain-0.tar[0, 100), pretrain-0.tar[100, 200), pretrain-0.tar[200, 300), ...<1244>, pretrain-2.tar[4700, 4800), pretrain-2.tar[4800, 4900), pretrain-2.tar[4900, 5000)] sum(count)=125000
rank=0, worker=1: shard_range=[pretrain-2.tar[5000, 5100), pretrain-2.tar[5100, 5200), pretrain-2.tar[5200, 5300), ...<1244>, pretrain-30.tar[9700, 9800), pretrain-30.tar[9800, 9900), pretrain-30.tar[9900, 10000)] sum(count)=125000
rank=1, worker=0: shard_range=[pretrain-7.tar[936, 10000), pretrain-8.tar[0, 5468)] sum(count)=14532
rank=1, worker=1: shard_range=[pretrain-8.tar[5468, 10000), pretrain-9.tar[0, 10000)] sum(count)=14532
rank=0, worker=0: shard_range=[pretrain-54.tar[0, 10000), pretrain-55.tar[0, 4532)] sum(count)=14532
rank=0, worker=1: shard_range=[pretrain-55.tar[4532, 8128), pretrain-6.tar[0, 10000), pretrain-7.tar[0, 936)] sum(count)=14532
times across ranks (ms):
  model-and-optimizer-setup:
     rank  0: 97.65
     rank  1: 96.50
     rank  2: 96.84
     rank  3: 97.46
     rank  4: 43.84
     rank  5: 31.43
     rank  6: 43.99
     rank  7: 43.83
     rank  8: 36.50
     rank  9: 29.42
     rank 10: 36.69
     rank 11: 25.89
     rank 12: 49.74
     rank 13: 49.98
     rank 14: 51.29
     rank 15: 50.42
  train/valid/test-data-iterators-setup:
     rank  0: 1032.40
     rank  1: 1032.36
     rank  2: 1437.46
     rank  3: 1032.33
     rank  4: 1032.32
     rank  5: 1032.34
     rank  6: 1032.33
     rank  7: 1032.31
     rank  8: 1158.54
     rank  9: 1158.45
     rank 10: 1158.47
     rank 11: 1158.45
     rank 12: 1437.50
     rank 13: 1438.40
     rank 14: 1233.51
     rank 15: 1437.29
 [2024-12-24 22:35:30] iteration        1/      10 | consumed samples:           16 | elapsed time per iteration (ms): 11627.7 | learning rate: 7.500000E-07 | global batch size:    16 | lm loss: 7.007244E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
[Rank 13] (after 1 iterations) memory (MB) | allocated: 4405.5654296875 | max allocated: 5493.412109375 | reserved: 5902.0 | max reserved: 5902.0
stage4 GPU utialization:48.76963875510476 %
[Rank 12] (after 1 iterations) memory (MB) | allocated: 4405.5654296875 | max allocated: 5493.412109375 | reserved: 5902.0 | max reserved: 5902.0
times across ranks (ms):
  forward-backward:
     rank  0: 11539.66
     rank  1: 11539.52
     rank  2: 11540.03
     rank  3: 11539.95
     rank  4: 11538.95
     rank  5: 11539.02
     rank  6: 11539.03
     rank  7: 11538.87
     rank  8: 11538.12
     rank  9: 11537.91
     rank 10: 11538.19
     rank 11: 11537.87
     rank 12: 11537.74
     rank 13: 11537.30
     rank 14: 11537.84
     rank 15: 11537.17
  forward-compute:
     rank  0: 2727.81
     rank  1: 2720.44
     rank  2: 2753.08
     rank  3: 2745.64
     rank  4: 2681.41
     rank  5: 2677.22
     rank  6: 2690.18
     rank  7: 2686.60
     rank  8: 2588.94
     rank  9: 2585.63
     rank 10: 2576.08
     rank 11: 2579.60
     rank 12: 2371.64
     rank 13: 2370.96
     rank 14: 2415.88
     rank 15: 2415.00
  backward-compute:
     rank  0: 1477.15
     rank  1: 1479.46
     rank  2: 1470.46
     rank  3: 1474.57
     rank  4: 790.24
     rank  5: 789.25
     rank  6: 784.11
     rank  7: 786.46
     rank  8: 738.23
     rank  9: 741.36
     rank 10: 741.24
     rank 11: 744.49
     rank 12: 836.49
     rank 13: 840.21
     rank 14: 819.20
     rank 15: 822.76
  pure-backward-compute:
     rank  0: 1476.64
     rank  1: 1478.96
     rank  2: 1469.88
     rank  3: 1474.03
     rank  4: 789.56
     rank  5: 788.58
     rank  6: 783.32
     rank  7: 785.80
     rank  8: 737.44
     rank  9: 740.79
     rank 10: 740.11
     rank 11: 743.68
     rank 12: 835.09
     rank 13: 838.81
     rank 14: 817.59
     rank 15: 821.11
  batch-generator:
     rank  0: 989.25
     rank  1: 979.85
     rank  2: 1004.55
     rank  3: 1000.29
     rank  4: 1060.09
     rank  5: 1054.55
     rank  6: 1091.88
     rank  7: 1087.62
     rank  8: 1034.73
     rank  9: 1031.14
     rank 10: 1020.08
     rank 11: 1018.99
     rank 12: 1633.17
     rank 13: 1634.56
     rank 14: 1184.55
     rank 15: 1199.37
  forward-recv:
     rank  4: 2165.43
     rank  5: 2169.78
     rank  6: 2179.55
     rank  7: 2189.26
     rank  8: 4377.29
     rank  9: 4379.32
     rank 10: 4405.82
     rank 11: 4402.15
     rank 12: 6537.54
     rank 13: 6537.24
     rank 14: 6551.74
     rank 15: 6552.28
  forward-send:
     rank  0: 4315.60
     rank  1: 4323.12
     rank  2: 4305.11
     rank  3: 4312.38
     rank  4: 2111.78
     rank  5: 2114.28
     rank  6: 2097.68
     rank  7: 2095.48
     rank  8: 27.34
     rank  9: 27.65
     rank 10: 23.65
     rank 11: 24.90
  backward-recv:
     rank  0: 245.69
     rank  1: 244.50
     rank  2: 259.10
     rank  3: 258.59
     rank  4: 137.19
     rank  5: 137.20
     rank  6: 148.79
     rank  7: 148.65
     rank  8: 75.82
     rank  9: 76.45
     rank 10: 88.27
     rank 11: 89.15
  backward-send:
     rank  4: 1.17
     rank  5: 1.04
     rank  6: 1.28
     rank  7: 0.91
     rank  8: 5.39
     rank  9: 5.23
     rank 10: 5.15
     rank 11: 4.82
     rank 12: 3.76
     rank 13: 3.69
     rank 14: 3.53
     rank 15: 3.60
  forward-send-backward-recv:
     rank  0: 2174.39
     rank  1: 2172.51
     rank  2: 2150.53
     rank  3: 2147.22
     rank  4: 2108.76
     rank  5: 2109.24
     rank  6: 2083.30
     rank  7: 2082.45
     rank  8: 2000.77
     rank  9: 1998.78
     rank 10: 1969.94
     rank 11: 1968.11
  backward-send-forward-recv:
     rank  4: 860.86
     rank  5: 858.89
     rank  6: 874.26
     rank  7: 870.23
     rank  8: 945.66
     rank  9: 946.25
     rank 10: 951.34
     rank 11: 950.56
     rank 12: 917.27
     rank 13: 914.62
     rank 14: 877.86
     rank 15: 874.63
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.04
     rank  2: 0.08
     rank  3: 0.05
     rank  4: 0.03
     rank  5: 0.08
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.03
     rank 12: 0.04
     rank 13: 0.03
     rank 14: 0.13
     rank 15: 0.04
  embedding-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.05
     rank  3: 0.03
     rank  4: 0.06
     rank  5: 0.23
     rank  6: 0.09
     rank  7: 0.08
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.10
     rank 13: 0.08
     rank 14: 0.25
     rank 15: 0.08
  all-grads-sync:
     rank  0: 352.97
     rank  1: 338.30
     rank  2: 353.05
     rank  3: 338.32
     rank  4: 579.48
     rank  5: 582.04
     rank  6: 579.49
     rank  7: 582.01
     rank  8: 504.30
     rank  9: 498.97
     rank 10: 504.21
     rank 11: 498.95
     rank 12: 313.25
     rank 13: 300.03
     rank 14: 313.62
     rank 15: 300.00
  optimizer-copy-to-main-grad:
     rank  0: 0.29
     rank  1: 0.29
     rank  2: 0.40
     rank  3: 0.45
     rank  4: 0.05
     rank  5: 0.11
     rank  6: 0.06
     rank  7: 0.04
     rank  8: 0.12
     rank  9: 0.05
     rank 10: 0.07
     rank 11: 0.09
     rank 12: 0.10
     rank 13: 0.06
     rank 14: 0.11
     rank 15: 0.06
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.05
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 49.18
     rank  1: 49.02
     rank  2: 49.95
     rank  3: 49.81
     rank  4: 80.83
     rank  5: 81.17
     rank  6: 81.40
     rank  7: 81.64
     rank  8: 72.14
     rank  9: 75.19
     rank 10: 73.49
     rank 11: 72.48
     rank 12: 65.19
     rank 13: 65.01
     rank 14: 72.73
     rank 15: 70.67
  optimizer:
     rank  0: 50.44
     rank  1: 50.29
     rank  2: 51.20
     rank  3: 51.06
     rank  4: 82.09
     rank  5: 82.43
     rank  6: 82.68
     rank  7: 82.90
     rank  8: 73.40
     rank  9: 76.46
     rank 10: 74.75
     rank 11: 73.78
     rank 12: 66.46
     rank 13: 66.28
     rank 14: 73.99
     rank 15: 71.94
 [2024-12-24 22:35:33] iteration        2/      10 | consumed samples:           32 | elapsed time per iteration (ms): 2594.0 | learning rate: 1.500000E-06 | global batch size:    16 | lm loss: 7.057015E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2497.01
     rank  1: 2497.10
     rank  2: 2496.98
     rank  3: 2497.05
     rank  4: 2500.18
     rank  5: 2500.28
     rank  6: 2500.13
     rank  7: 2500.28
     rank  8: 2499.33
     rank  9: 2499.38
     rank 10: 2499.28
     rank 11: 2499.37
     rank 12: 2498.46
     rank 13: 2498.66
     rank 14: 2498.21
     rank 15: 2498.51
  forward-compute:
     rank  0: 797.34
     rank  1: 797.53
     rank  2: 813.50
     rank  3: 813.77
     rank  4: 543.84
     rank  5: 544.10
     rank  6: 547.82
     rank  7: 550.34
     rank  8: 511.42
     rank  9: 513.59
     rank 10: 501.16
     rank 11: 501.27
     rank 12: 564.41
     rank 13: 565.96
     rank 14: 603.55
     rank 15: 604.52
  backward-compute:
     rank  0: 699.37
     rank  1: 700.21
     rank  2: 688.53
     rank  3: 689.28
     rank  4: 772.54
     rank  5: 774.22
     rank  6: 777.16
     rank  7: 778.62
     rank  8: 729.92
     rank  9: 732.15
     rank 10: 729.28
     rank 11: 730.09
     rank 12: 822.08
     rank 13: 822.74
     rank 14: 797.28
     rank 15: 797.11
  pure-backward-compute:
     rank  0: 699.02
     rank  1: 699.83
     rank  2: 688.10
     rank  3: 688.87
     rank  4: 771.85
     rank  5: 773.73
     rank  6: 776.54
     rank  7: 778.11
     rank  8: 728.73
     rank  9: 731.34
     rank 10: 727.89
     rank 11: 729.20
     rank 12: 820.37
     rank 13: 821.07
     rank 14: 795.82
     rank 15: 795.50
  batch-generator:
     rank  0: 35.53
     rank  1: 36.73
     rank  2: 38.35
     rank  3: 39.30
     rank  4: 26.64
     rank  5: 27.30
     rank  6: 28.61
     rank  7: 30.11
     rank  8: 30.03
     rank  9: 34.52
     rank 10: 35.18
     rank 11: 33.26
     rank 12: 35.26
     rank 13: 41.55
     rank 14: 39.04
     rank 15: 39.55
  forward-recv:
     rank  4: 150.75
     rank  5: 150.95
     rank  6: 157.21
     rank  7: 156.87
     rank  8: 193.54
     rank  9: 193.77
     rank 10: 202.90
     rank 11: 203.50
     rank 12: 233.42
     rank 13: 233.38
     rank 14: 239.70
     rank 15: 239.81
  forward-send:
     rank  0: 1.96
     rank  1: 1.84
     rank  2: 1.82
     rank  3: 1.63
     rank  4: 6.12
     rank  5: 5.80
     rank  6: 5.39
     rank  7: 5.51
     rank  8: 3.13
     rank  9: 2.74
     rank 10: 2.81
     rank 11: 2.58
  backward-recv:
     rank  0: 255.21
     rank  1: 254.37
     rank  2: 260.89
     rank  3: 261.24
     rank  4: 143.88
     rank  5: 143.79
     rank  6: 147.58
     rank  7: 146.99
     rank  8: 79.82
     rank  9: 80.60
     rank 10: 85.76
     rank 11: 86.22
  backward-send:
     rank  4: 1.36
     rank  5: 0.88
     rank  6: 1.02
     rank  7: 1.03
     rank  8: 5.15
     rank  9: 4.54
     rank 10: 5.34
     rank 11: 4.93
     rank 12: 3.16
     rank 13: 3.15
     rank 14: 3.20
     rank 15: 3.01
  forward-send-backward-recv:
     rank  0: 215.81
     rank  1: 215.70
     rank  2: 201.25
     rank  3: 200.58
     rank  4: 185.61
     rank  5: 185.20
     rank  6: 165.15
     rank  7: 164.03
     rank  8: 158.06
     rank  9: 157.63
     rank 10: 155.11
     rank 11: 155.55
  backward-send-forward-recv:
     rank  4: 83.43
     rank  5: 83.89
     rank  6: 84.11
     rank  7: 82.22
     rank  8: 108.49
     rank  9: 106.68
     rank 10: 105.21
     rank 11: 105.08
     rank 12: 75.16
     rank 13: 72.96
     rank 14: 50.84
     rank 15: 50.30
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.04
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.07
     rank 13: 0.05
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.06
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.15
     rank 13: 0.09
     rank 14: 0.06
     rank 15: 0.06
  all-grads-sync:
     rank  0: 245.44
     rank  1: 233.67
     rank  2: 245.54
     rank  3: 233.78
     rank  4: 516.03
     rank  5: 516.41
     rank  6: 516.02
     rank  7: 516.38
     rank  8: 439.28
     rank  9: 440.03
     rank 10: 439.26
     rank 11: 440.01
     rank 12: 285.59
     rank 13: 273.58
     rank 14: 285.61
     rank 15: 273.58
  optimizer-copy-to-main-grad:
     rank  0: 0.24
     rank  1: 0.23
     rank  2: 0.26
     rank  3: 0.24
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.04
     rank  7: 0.03
     rank  8: 0.07
     rank  9: 0.06
     rank 10: 0.06
     rank 11: 0.13
     rank 12: 0.09
     rank 13: 0.08
     rank 14: 0.04
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 30.12
     rank  1: 29.95
     rank  2: 30.36
     rank  3: 29.96
     rank  4: 63.78
     rank  5: 63.81
     rank  6: 63.76
     rank  7: 64.01
     rank  8: 53.82
     rank  9: 53.70
     rank 10: 53.68
     rank 11: 53.74
     rank 12: 45.12
     rank 13: 45.25
     rank 14: 45.06
     rank 15: 45.11
  optimizer:
     rank  0: 30.99
     rank  1: 30.82
     rank  2: 31.31
     rank  3: 30.82
     rank  4: 64.65
     rank  5: 64.68
     rank  6: 64.63
     rank  7: 64.87
     rank  8: 54.70
     rank  9: 54.58
     rank 10: 54.56
     rank 11: 54.63
     rank 12: 45.99
     rank 13: 46.12
     rank 14: 45.93
     rank 15: 45.99
 [2024-12-24 22:35:35] iteration        3/      10 | consumed samples:           48 | elapsed time per iteration (ms): 2582.5 | learning rate: 2.250000E-06 | global batch size:    16 | lm loss: 7.073423E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2482.45
     rank  1: 2482.65
     rank  2: 2482.54
     rank  3: 2482.69
     rank  4: 2485.60
     rank  5: 2485.88
     rank  6: 2485.60
     rank  7: 2485.88
     rank  8: 2484.89
     rank  9: 2484.93
     rank 10: 2484.82
     rank 11: 2485.00
     rank 12: 2483.89
     rank 13: 2484.22
     rank 14: 2483.92
     rank 15: 2484.44
  forward-compute:
     rank  0: 770.70
     rank  1: 771.04
     rank  2: 784.69
     rank  3: 784.72
     rank  4: 541.97
     rank  5: 542.59
     rank  6: 543.76
     rank  7: 543.86
     rank  8: 509.00
     rank  9: 513.55
     rank 10: 499.19
     rank 11: 499.80
     rank 12: 575.59
     rank 13: 575.14
     rank 14: 564.13
     rank 15: 565.11
  backward-compute:
     rank  0: 698.95
     rank  1: 698.31
     rank  2: 694.12
     rank  3: 693.83
     rank  4: 776.56
     rank  5: 778.73
     rank  6: 774.90
     rank  7: 776.72
     rank  8: 732.30
     rank  9: 730.19
     rank 10: 727.65
     rank 11: 727.53
     rank 12: 822.94
     rank 13: 823.35
     rank 14: 828.69
     rank 15: 828.21
  pure-backward-compute:
     rank  0: 698.56
     rank  1: 697.92
     rank  2: 693.76
     rank  3: 693.49
     rank  4: 776.04
     rank  5: 778.29
     rank  6: 774.42
     rank  7: 776.34
     rank  8: 731.51
     rank  9: 729.49
     rank 10: 726.69
     rank 11: 726.74
     rank 12: 821.00
     rank 13: 821.29
     rank 14: 826.97
     rank 15: 826.29
  batch-generator:
     rank  0: 32.30
     rank  1: 32.84
     rank  2: 32.23
     rank  3: 32.80
     rank  4: 24.68
     rank  5: 24.42
     rank  6: 23.18
     rank  7: 22.99
     rank  8: 29.98
     rank  9: 34.48
     rank 10: 30.74
     rank 11: 31.35
     rank 12: 31.16
     rank 13: 31.76
     rank 14: 32.95
     rank 15: 33.97
  forward-recv:
     rank  4: 145.00
     rank  5: 146.66
     rank  6: 147.44
     rank  7: 147.24
     rank  8: 194.46
     rank  9: 193.34
     rank 10: 196.26
     rank 11: 196.36
     rank 12: 236.94
     rank 13: 236.67
     rank 14: 237.70
     rank 15: 237.49
  forward-send:
     rank  0: 1.77
     rank  1: 1.61
     rank  2: 1.77
     rank  3: 1.59
     rank  4: 8.14
     rank  5: 5.93
     rank  6: 8.18
     rank  7: 8.05
     rank  8: 5.22
     rank  9: 4.46
     rank 10: 5.20
     rank 11: 5.09
  backward-recv:
     rank  0: 253.82
     rank  1: 254.37
     rank  2: 248.53
     rank  3: 249.50
     rank  4: 151.34
     rank  5: 152.71
     rank  6: 143.36
     rank  7: 143.39
     rank  8: 84.95
     rank  9: 86.46
     rank 10: 81.14
     rank 11: 81.98
  backward-send:
     rank  4: 1.40
     rank  5: 0.88
     rank  6: 1.06
     rank  7: 1.00
     rank  8: 7.40
     rank  9: 7.81
     rank 10: 7.72
     rank 11: 7.42
     rank 12: 3.88
     rank 13: 5.45
     rank 14: 4.75
     rank 15: 4.96
  forward-send-backward-recv:
     rank  0: 234.35
     rank  1: 234.39
     rank  2: 229.90
     rank  3: 229.60
     rank  4: 195.76
     rank  5: 195.96
     rank  6: 191.68
     rank  7: 191.42
     rank  8: 180.37
     rank  9: 180.76
     rank 10: 182.64
     rank 11: 185.14
  backward-send-forward-recv:
     rank  4: 56.83
     rank  5: 56.24
     rank  6: 69.72
     rank  7: 69.06
     rank  8: 67.88
     rank  9: 65.22
     rank 10: 79.77
     rank 11: 79.36
     rank 12: 45.43
     rank 13: 45.99
     rank 14: 50.92
     rank 15: 51.05
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.08
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.09
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.04
     rank 14: 0.03
     rank 15: 0.05
  embedding-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.04
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.05
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.07
     rank 13: 0.08
     rank 14: 0.07
     rank 15: 0.13
  all-grads-sync:
     rank  0: 254.13
     rank  1: 242.96
     rank  2: 254.27
     rank  3: 242.87
     rank  4: 510.97
     rank  5: 511.30
     rank  6: 510.97
     rank  7: 511.29
     rank  8: 435.25
     rank  9: 435.34
     rank 10: 435.37
     rank 11: 435.37
     rank 12: 286.15
     rank 13: 274.69
     rank 14: 286.15
     rank 15: 274.70
  optimizer-copy-to-main-grad:
     rank  0: 0.24
     rank  1: 0.24
     rank  2: 0.26
     rank  3: 0.24
     rank  4: 0.04
     rank  5: 0.07
     rank  6: 0.04
     rank  7: 0.04
     rank  8: 0.16
     rank  9: 0.05
     rank 10: 0.05
     rank 11: 0.06
     rank 12: 0.04
     rank 13: 0.07
     rank 14: 0.05
     rank 15: 0.09
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 30.14
     rank  1: 30.17
     rank  2: 30.43
     rank  3: 30.04
     rank  4: 63.80
     rank  5: 63.72
     rank  6: 63.76
     rank  7: 63.82
     rank  8: 53.73
     rank  9: 53.67
     rank 10: 53.78
     rank 11: 53.73
     rank 12: 45.23
     rank 13: 45.38
     rank 14: 45.31
     rank 15: 45.34
  optimizer:
     rank  0: 31.07
     rank  1: 31.09
     rank  2: 31.36
     rank  3: 30.97
     rank  4: 64.72
     rank  5: 64.64
     rank  6: 64.69
     rank  7: 64.74
     rank  8: 54.66
     rank  9: 54.60
     rank 10: 54.72
     rank 11: 54.66
     rank 12: 46.16
     rank 13: 46.33
     rank 14: 46.24
     rank 15: 46.26
 [2024-12-24 22:35:38] iteration        4/      10 | consumed samples:           64 | elapsed time per iteration (ms): 2684.5 | learning rate: 3.000000E-06 | global batch size:    16 | lm loss: 3.493297E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2588.34
     rank  1: 2588.19
     rank  2: 2588.41
     rank  3: 2588.22
     rank  4: 2591.36
     rank  5: 2591.48
     rank  6: 2591.38
     rank  7: 2591.42
     rank  8: 2590.41
     rank  9: 2590.57
     rank 10: 2590.41
     rank 11: 2590.59
     rank 12: 2589.67
     rank 13: 2589.62
     rank 14: 2589.60
     rank 15: 2589.63
  forward-compute:
     rank  0: 958.54
     rank  1: 958.80
     rank  2: 972.94
     rank  3: 973.42
     rank  4: 539.93
     rank  5: 539.98
     rank  6: 550.22
     rank  7: 551.25
     rank  8: 508.24
     rank  9: 511.62
     rank 10: 498.07
     rank 11: 499.40
     rank 12: 565.49
     rank 13: 565.25
     rank 14: 562.09
     rank 15: 563.70
  backward-compute:
     rank  0: 697.07
     rank  1: 698.33
     rank  2: 687.79
     rank  3: 687.08
     rank  4: 776.92
     rank  5: 777.88
     rank  6: 776.10
     rank  7: 778.63
     rank  8: 730.97
     rank  9: 730.98
     rank 10: 727.87
     rank 11: 728.73
     rank 12: 821.05
     rank 13: 821.56
     rank 14: 820.64
     rank 15: 819.81
  pure-backward-compute:
     rank  0: 696.72
     rank  1: 697.92
     rank  2: 687.37
     rank  3: 686.67
     rank  4: 776.49
     rank  5: 777.49
     rank  6: 775.27
     rank  7: 778.25
     rank  8: 730.21
     rank  9: 730.14
     rank 10: 726.83
     rank 11: 727.99
     rank 12: 819.59
     rank 13: 820.09
     rank 14: 819.23
     rank 15: 818.22
  batch-generator:
     rank  0: 31.79
     rank  1: 33.29
     rank  2: 34.80
     rank  3: 36.51
     rank  4: 25.64
     rank  5: 24.58
     rank  6: 28.09
     rank  7: 27.19
     rank  8: 29.11
     rank  9: 32.04
     rank 10: 31.16
     rank 11: 31.55
     rank 12: 31.92
     rank 13: 31.76
     rank 14: 29.58
     rank 15: 31.93
  forward-recv:
     rank  4: 337.32
     rank  5: 338.79
     rank  6: 343.13
     rank  7: 342.71
     rank  8: 383.44
     rank  9: 382.68
     rank 10: 394.69
     rank 11: 395.30
     rank 12: 237.02
     rank 13: 236.74
     rank 14: 232.80
     rank 15: 232.64
  forward-send:
     rank  0: 1.73
     rank  1: 1.58
     rank  2: 1.77
     rank  3: 1.54
     rank  4: 7.80
     rank  5: 6.40
     rank  6: 7.13
     rank  7: 7.17
     rank  8: 3.56
     rank  9: 3.18
     rank 10: 2.98
     rank 11: 2.65
  backward-recv:
     rank  0: 255.15
     rank  1: 253.97
     rank  2: 255.81
     rank  3: 256.25
     rank  4: 148.09
     rank  5: 149.42
     rank  6: 148.17
     rank  7: 148.67
     rank  8: 85.42
     rank  9: 85.25
     rank 10: 84.30
     rank 11: 84.41
  backward-send:
     rank  4: 1.21
     rank  5: 0.91
     rank  6: 1.36
     rank  7: 1.02
     rank  8: 7.55
     rank  9: 8.39
     rank 10: 8.63
     rank 11: 8.68
     rank 12: 4.60
     rank 13: 4.52
     rank 14: 5.12
     rank 15: 5.21
  forward-send-backward-recv:
     rank  0: 149.10
     rank  1: 148.60
     rank  2: 139.79
     rank  3: 139.76
     rank  4: 107.46
     rank  5: 107.81
     rank  6: 98.27
     rank  7: 95.43
     rank  8: 66.11
     rank  9: 67.45
     rank 10: 68.50
     rank 11: 67.46
  backward-send-forward-recv:
     rank  4: 58.98
     rank  5: 58.66
     rank  6: 55.45
     rank  7: 55.43
     rank  8: 95.30
     rank  9: 93.29
     rank 10: 97.01
     rank 11: 95.97
     rank 12: 158.41
     rank 13: 158.38
     rank 14: 166.97
     rank 15: 166.20
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.11
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.05
     rank  5: 0.09
     rank  6: 0.07
     rank  7: 0.05
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.05
     rank 12: 0.07
     rank 13: 0.07
     rank 14: 0.06
     rank 15: 0.07
  all-grads-sync:
     rank  0: 246.67
     rank  1: 235.67
     rank  2: 246.56
     rank  3: 235.51
     rank  4: 515.31
     rank  5: 515.38
     rank  6: 515.18
     rank  7: 515.33
     rank  8: 439.18
     rank  9: 439.14
     rank 10: 439.14
     rank 11: 439.14
     rank 12: 285.26
     rank 13: 273.52
     rank 14: 285.27
     rank 15: 273.31
  optimizer-copy-to-main-grad:
     rank  0: 0.23
     rank  1: 0.23
     rank  2: 0.25
     rank  3: 0.24
     rank  4: 0.03
     rank  5: 0.04
     rank  6: 0.04
     rank  7: 0.03
     rank  8: 0.05
     rank  9: 0.09
     rank 10: 0.04
     rank 11: 0.10
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.03
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 29.77
     rank  1: 29.87
     rank  2: 29.89
     rank  3: 30.54
     rank  4: 63.81
     rank  5: 63.94
     rank  6: 63.79
     rank  7: 63.80
     rank  8: 53.69
     rank  9: 53.70
     rank 10: 53.56
     rank 11: 53.80
     rank 12: 45.19
     rank 13: 45.13
     rank 14: 45.05
     rank 15: 45.27
  optimizer:
     rank  0: 30.67
     rank  1: 30.77
     rank  2: 30.79
     rank  3: 31.44
     rank  4: 64.71
     rank  5: 64.84
     rank  6: 64.70
     rank  7: 64.70
     rank  8: 54.59
     rank  9: 54.61
     rank 10: 54.45
     rank 11: 54.70
     rank 12: 46.09
     rank 13: 46.03
     rank 14: 45.95
     rank 15: 46.16
 [2024-12-24 22:35:41] iteration        5/      10 | consumed samples:           80 | elapsed time per iteration (ms): 2589.7 | learning rate: 3.750000E-06 | global batch size:    16 | lm loss: 2.310513E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2493.57
     rank  1: 2493.32
     rank  2: 2493.54
     rank  3: 2493.26
     rank  4: 2496.77
     rank  5: 2496.46
     rank  6: 2496.75
     rank  7: 2496.50
     rank  8: 2496.02
     rank  9: 2495.91
     rank 10: 2495.95
     rank 11: 2495.56
     rank 12: 2494.95
     rank 13: 2494.85
     rank 14: 2494.82
     rank 15: 2494.77
  forward-compute:
     rank  0: 763.80
     rank  1: 763.85
     rank  2: 778.75
     rank  3: 778.83
     rank  4: 539.93
     rank  5: 539.97
     rank  6: 554.10
     rank  7: 554.84
     rank  8: 513.04
     rank  9: 516.27
     rank 10: 488.88
     rank 11: 491.23
     rank 12: 579.26
     rank 13: 580.82
     rank 14: 577.08
     rank 15: 577.19
  backward-compute:
     rank  0: 702.34
     rank  1: 703.12
     rank  2: 678.32
     rank  3: 678.84
     rank  4: 775.43
     rank  5: 779.18
     rank  6: 776.16
     rank  7: 779.10
     rank  8: 730.51
     rank  9: 733.44
     rank 10: 729.24
     rank 11: 727.78
     rank 12: 823.13
     rank 13: 824.44
     rank 14: 828.93
     rank 15: 827.53
  pure-backward-compute:
     rank  0: 701.97
     rank  1: 702.72
     rank  2: 677.97
     rank  3: 678.47
     rank  4: 774.95
     rank  5: 778.75
     rank  6: 775.48
     rank  7: 778.71
     rank  8: 729.36
     rank  9: 732.59
     rank 10: 727.79
     rank 11: 727.30
     rank 12: 821.23
     rank 13: 823.02
     rank 14: 827.21
     rank 15: 825.81
  batch-generator:
     rank  0: 31.74
     rank  1: 32.96
     rank  2: 30.43
     rank  3: 31.11
     rank  4: 26.10
     rank  5: 26.22
     rank  6: 30.36
     rank  7: 29.78
     rank  8: 31.10
     rank  9: 32.54
     rank 10: 25.23
     rank 11: 27.53
     rank 12: 36.18
     rank 13: 36.15
     rank 14: 31.36
     rank 15: 32.02
  forward-recv:
     rank  4: 145.96
     rank  5: 146.08
     rank  6: 151.97
     rank  7: 151.58
     rank  8: 192.35
     rank  9: 193.11
     rank 10: 199.47
     rank 11: 199.86
     rank 12: 232.88
     rank 13: 232.25
     rank 14: 233.44
     rank 15: 233.36
  forward-send:
     rank  0: 1.93
     rank  1: 1.78
     rank  2: 1.78
     rank  3: 1.73
     rank  4: 5.59
     rank  5: 5.53
     rank  6: 5.15
     rank  7: 5.31
     rank  8: 5.18
     rank  9: 4.40
     rank 10: 5.22
     rank 11: 5.12
  backward-recv:
     rank  0: 260.74
     rank  1: 259.52
     rank  2: 282.78
     rank  3: 281.84
     rank  4: 159.45
     rank  5: 159.62
     rank  6: 164.71
     rank  7: 164.77
     rank  8: 85.12
     rank  9: 85.89
     rank 10: 86.41
     rank 11: 86.65
  backward-send:
     rank  4: 1.48
     rank  5: 1.08
     rank  6: 1.17
     rank  7: 1.07
     rank  8: 9.34
     rank  9: 9.05
     rank 10: 9.51
     rank 11: 9.34
     rank 12: 4.31
     rank 13: 4.32
     rank 14: 5.23
     rank 15: 5.17
  forward-send-backward-recv:
     rank  0: 231.59
     rank  1: 231.71
     rank  2: 218.92
     rank  3: 218.84
     rank  4: 203.63
     rank  5: 201.57
     rank  6: 181.44
     rank  7: 178.64
     rank  8: 194.31
     rank  9: 193.36
     rank 10: 215.77
     rank 11: 218.40
  backward-send-forward-recv:
     rank  4: 46.32
     rank  5: 46.48
     rank  6: 45.18
     rank  7: 44.98
     rank  8: 51.03
     rank  9: 46.97
     rank 10: 47.25
     rank 11: 45.66
     rank 12: 45.71
     rank 13: 44.40
     rank 14: 42.84
     rank 15: 43.72
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.11
     rank  9: 0.03
     rank 10: 0.05
     rank 11: 0.02
     rank 12: 0.06
     rank 13: 0.04
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.07
     rank  7: 0.10
     rank  8: 0.05
     rank  9: 0.03
     rank 10: 0.04
     rank 11: 0.02
     rank 12: 0.18
     rank 13: 0.09
     rank 14: 0.07
     rank 15: 0.07
  all-grads-sync:
     rank  0: 257.43
     rank  1: 245.69
     rank  2: 257.52
     rank  3: 245.57
     rank  4: 520.84
     rank  5: 520.82
     rank  6: 520.79
     rank  7: 520.80
     rank  8: 438.60
     rank  9: 438.61
     rank 10: 439.98
     rank 11: 438.64
     rank 12: 285.93
     rank 13: 273.16
     rank 14: 286.24
     rank 15: 273.10
  optimizer-copy-to-main-grad:
     rank  0: 0.24
     rank  1: 0.37
     rank  2: 0.24
     rank  3: 0.25
     rank  4: 0.04
     rank  5: 0.03
     rank  6: 0.04
     rank  7: 0.06
     rank  8: 0.18
     rank  9: 0.05
     rank 10: 0.17
     rank 11: 0.05
     rank 12: 0.08
     rank 13: 0.07
     rank 14: 0.04
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 30.09
     rank  1: 29.77
     rank  2: 29.73
     rank  3: 29.95
     rank  4: 63.80
     rank  5: 63.80
     rank  6: 63.81
     rank  7: 63.92
     rank  8: 53.77
     rank  9: 53.72
     rank 10: 53.84
     rank 11: 53.59
     rank 12: 45.35
     rank 13: 45.15
     rank 14: 45.10
     rank 15: 45.12
  optimizer:
     rank  0: 31.14
     rank  1: 30.83
     rank  2: 30.81
     rank  3: 31.00
     rank  4: 64.85
     rank  5: 64.85
     rank  6: 64.86
     rank  7: 65.05
     rank  8: 54.83
     rank  9: 54.77
     rank 10: 55.03
     rank 11: 54.66
     rank 12: 46.40
     rank 13: 46.20
     rank 14: 46.16
     rank 15: 46.17
 [2024-12-24 22:35:43] iteration        6/      10 | consumed samples:           96 | elapsed time per iteration (ms): 2588.8 | learning rate: 4.500000E-06 | global batch size:    16 | lm loss: 2.187007E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2488.29
     rank  1: 2488.35
     rank  2: 2488.34
     rank  3: 2488.41
     rank  4: 2491.50
     rank  5: 2491.57
     rank  6: 2491.52
     rank  7: 2491.59
     rank  8: 2490.56
     rank  9: 2490.63
     rank 10: 2490.62
     rank 11: 2490.68
     rank 12: 2489.92
     rank 13: 2489.82
     rank 14: 2490.06
     rank 15: 2489.91
  forward-compute:
     rank  0: 758.35
     rank  1: 758.02
     rank  2: 762.49
     rank  3: 762.87
     rank  4: 545.37
     rank  5: 546.26
     rank  6: 550.39
     rank  7: 550.85
     rank  8: 509.58
     rank  9: 512.34
     rank 10: 500.44
     rank 11: 502.91
     rank 12: 562.01
     rank 13: 563.86
     rank 14: 567.75
     rank 15: 572.42
  backward-compute:
     rank  0: 694.43
     rank  1: 696.05
     rank  2: 684.77
     rank  3: 684.59
     rank  4: 776.02
     rank  5: 776.80
     rank  6: 778.98
     rank  7: 786.59
     rank  8: 730.05
     rank  9: 731.40
     rank 10: 729.21
     rank 11: 732.61
     rank 12: 827.83
     rank 13: 828.33
     rank 14: 824.62
     rank 15: 823.70
  pure-backward-compute:
     rank  0: 694.08
     rank  1: 695.71
     rank  2: 684.41
     rank  3: 684.20
     rank  4: 775.48
     rank  5: 776.44
     rank  6: 778.44
     rank  7: 786.22
     rank  8: 728.96
     rank  9: 730.70
     rank 10: 728.03
     rank 11: 732.20
     rank 12: 826.15
     rank 13: 826.82
     rank 14: 823.08
     rank 15: 822.12
  batch-generator:
     rank  0: 31.18
     rank  1: 31.71
     rank  2: 33.78
     rank  3: 35.49
     rank  4: 27.18
     rank  5: 25.61
     rank  6: 27.08
     rank  7: 25.78
     rank  8: 30.84
     rank  9: 33.74
     rank 10: 32.31
     rank 11: 33.27
     rank 12: 33.65
     rank 13: 35.09
     rank 14: 35.86
     rank 15: 38.99
  forward-recv:
     rank  4: 131.78
     rank  5: 133.22
     rank  6: 129.65
     rank  7: 129.41
     rank  8: 185.29
     rank  9: 185.09
     rank 10: 186.79
     rank 11: 187.33
     rank 12: 233.78
     rank 13: 233.07
     rank 14: 234.03
     rank 15: 233.87
  forward-send:
     rank  0: 1.78
     rank  1: 1.63
     rank  2: 1.77
     rank  3: 1.56
     rank  4: 9.39
     rank  5: 7.94
     rank  6: 8.55
     rank  7: 8.66
     rank  8: 5.44
     rank  9: 4.63
     rank 10: 5.42
     rank 11: 5.14
  backward-recv:
     rank  0: 259.22
     rank  1: 258.29
     rank  2: 264.57
     rank  3: 263.98
     rank  4: 150.29
     rank  5: 151.83
     rank  6: 151.12
     rank  7: 147.88
     rank  8: 86.10
     rank  9: 86.22
     rank 10: 85.44
     rank 11: 88.11
  backward-send:
     rank  4: 1.49
     rank  5: 0.88
     rank  6: 1.44
     rank  7: 1.02
     rank  8: 8.22
     rank  9: 8.17
     rank 10: 8.47
     rank 11: 4.75
     rank 12: 4.63
     rank 13: 4.61
     rank 14: 4.17
     rank 15: 4.16
  forward-send-backward-recv:
     rank  0: 239.83
     rank  1: 239.87
     rank  2: 237.53
     rank  3: 237.62
     rank  4: 197.34
     rank  5: 196.81
     rank  6: 200.32
     rank  7: 197.75
     rank  8: 174.13
     rank  9: 173.83
     rank 10: 197.14
     rank 11: 199.54
  backward-send-forward-recv:
     rank  4: 58.59
     rank  5: 58.49
     rank  6: 50.00
     rank  7: 49.96
     rank  8: 74.57
     rank  9: 73.29
     rank 10: 54.50
     rank 11: 52.61
     rank 12: 50.60
     rank 13: 49.11
     rank 14: 46.62
     rank 15: 42.94
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.04
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.06
     rank 15: 0.06
  embedding-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.07
     rank  7: 0.05
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.07
     rank 13: 0.07
     rank 14: 0.09
     rank 15: 0.15
  all-grads-sync:
     rank  0: 244.50
     rank  1: 233.44
     rank  2: 244.38
     rank  3: 233.31
     rank  4: 521.82
     rank  5: 522.48
     rank  6: 521.82
     rank  7: 522.49
     rank  8: 442.83
     rank  9: 442.81
     rank 10: 442.81
     rank 11: 442.85
     rank 12: 285.23
     rank 13: 272.20
     rank 14: 285.25
     rank 15: 272.27
  optimizer-copy-to-main-grad:
     rank  0: 0.24
     rank  1: 0.24
     rank  2: 0.25
     rank  3: 0.24
     rank  4: 0.04
     rank  5: 0.03
     rank  6: 0.04
     rank  7: 0.03
     rank  8: 0.06
     rank  9: 0.05
     rank 10: 0.06
     rank 11: 0.08
     rank 12: 0.04
     rank 13: 0.05
     rank 14: 0.07
     rank 15: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 29.84
     rank  1: 29.99
     rank  2: 30.05
     rank  3: 30.02
     rank  4: 63.84
     rank  5: 63.78
     rank  6: 63.85
     rank  7: 63.86
     rank  8: 53.69
     rank  9: 53.63
     rank 10: 53.79
     rank 11: 53.69
     rank 12: 45.08
     rank 13: 45.27
     rank 14: 45.15
     rank 15: 45.27
  optimizer:
     rank  0: 30.72
     rank  1: 30.86
     rank  2: 30.93
     rank  3: 30.89
     rank  4: 64.71
     rank  5: 64.65
     rank  6: 64.74
     rank  7: 64.74
     rank  8: 54.57
     rank  9: 54.51
     rank 10: 54.67
     rank 11: 54.56
     rank 12: 45.94
     rank 13: 46.30
     rank 14: 46.03
     rank 15: 46.14
 [2024-12-24 22:35:46] iteration        7/      10 | consumed samples:          112 | elapsed time per iteration (ms): 2592.9 | learning rate: 5.250000E-06 | global batch size:    16 | lm loss: 2.173214E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2493.54
     rank  1: 2493.48
     rank  2: 2493.60
     rank  3: 2493.51
     rank  4: 2496.72
     rank  5: 2496.70
     rank  6: 2496.72
     rank  7: 2496.68
     rank  8: 2495.83
     rank  9: 2495.77
     rank 10: 2495.85
     rank 11: 2495.78
     rank 12: 2495.24
     rank 13: 2494.95
     rank 14: 2495.12
     rank 15: 2495.02
  forward-compute:
     rank  0: 768.76
     rank  1: 768.46
     rank  2: 777.55
     rank  3: 777.01
     rank  4: 540.38
     rank  5: 541.04
     rank  6: 549.39
     rank  7: 549.93
     rank  8: 505.04
     rank  9: 506.77
     rank 10: 498.43
     rank 11: 495.27
     rank 12: 568.41
     rank 13: 568.53
     rank 14: 569.54
     rank 15: 572.92
  backward-compute:
     rank  0: 690.82
     rank  1: 691.63
     rank  2: 686.13
     rank  3: 686.77
     rank  4: 777.89
     rank  5: 779.97
     rank  6: 782.91
     rank  7: 780.98
     rank  8: 733.01
     rank  9: 731.76
     rank 10: 728.70
     rank 11: 729.03
     rank 12: 827.30
     rank 13: 827.86
     rank 14: 836.60
     rank 15: 835.74
  pure-backward-compute:
     rank  0: 690.44
     rank  1: 691.25
     rank  2: 685.75
     rank  3: 686.37
     rank  4: 777.34
     rank  5: 779.55
     rank  6: 782.33
     rank  7: 780.56
     rank  8: 732.18
     rank  9: 730.93
     rank 10: 727.66
     rank 11: 728.45
     rank 12: 825.57
     rank 13: 826.34
     rank 14: 834.59
     rank 15: 833.96
  batch-generator:
     rank  0: 30.61
     rank  1: 31.09
     rank  2: 32.63
     rank  3: 32.86
     rank  4: 24.70
     rank  5: 24.38
     rank  6: 27.08
     rank  7: 25.71
     rank  8: 25.48
     rank  9: 27.25
     rank 10: 32.37
     rank 11: 26.48
     rank 12: 32.88
     rank 13: 32.50
     rank 14: 36.40
     rank 15: 39.44
  forward-recv:
     rank  4: 134.81
     rank  5: 135.87
     rank  6: 137.62
     rank  7: 137.48
     rank  8: 184.96
     rank  9: 184.09
     rank 10: 188.25
     rank 11: 191.33
     rank 12: 232.56
     rank 13: 232.35
     rank 14: 232.03
     rank 15: 229.51
  forward-send:
     rank  0: 1.94
     rank  1: 1.82
     rank  2: 1.94
     rank  3: 1.71
     rank  4: 8.48
     rank  5: 7.19
     rank  6: 7.95
     rank  7: 7.98
     rank  8: 5.84
     rank  9: 5.85
     rank 10: 6.25
     rank 11: 3.65
  backward-recv:
     rank  0: 261.04
     rank  1: 260.71
     rank  2: 265.88
     rank  3: 265.55
     rank  4: 147.89
     rank  5: 146.57
     rank  6: 148.75
     rank  7: 148.48
     rank  8: 84.08
     rank  9: 83.94
     rank 10: 89.05
     rank 11: 89.97
  backward-send:
     rank  4: 1.15
     rank  5: 1.13
     rank  6: 1.30
     rank  7: 1.04
     rank  8: 7.05
     rank  9: 5.99
     rank 10: 7.23
     rank 11: 6.71
     rank 12: 4.62
     rank 13: 4.59
     rank 14: 5.23
     rank 15: 5.08
  forward-send-backward-recv:
     rank  0: 240.26
     rank  1: 239.81
     rank  2: 232.93
     rank  3: 233.22
     rank  4: 200.17
     rank  5: 201.86
     rank  6: 189.30
     rank  7: 191.20
     rank  8: 177.13
     rank  9: 177.73
     rank 10: 188.36
     rank 11: 191.54
  backward-send-forward-recv:
     rank  4: 72.36
     rank  5: 72.40
     rank  6: 67.56
     rank  7: 67.60
     rank  8: 90.41
     rank  9: 89.95
     rank 10: 77.74
     rank 11: 81.11
     rank 12: 57.61
     rank 13: 57.34
     rank 14: 48.19
     rank 15: 47.81
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.04
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.09
     rank 13: 0.07
     rank 14: 0.08
     rank 15: 0.06
  all-grads-sync:
     rank  0: 253.34
     rank  1: 241.59
     rank  2: 253.45
     rank  3: 241.51
     rank  4: 517.54
     rank  5: 517.48
     rank  6: 517.51
     rank  7: 517.51
     rank  8: 445.58
     rank  9: 445.65
     rank 10: 445.56
     rank 11: 445.48
     rank 12: 285.88
     rank 13: 273.79
     rank 14: 285.67
     rank 15: 273.80
  optimizer-copy-to-main-grad:
     rank  0: 0.24
     rank  1: 0.24
     rank  2: 0.33
     rank  3: 0.25
     rank  4: 0.04
     rank  5: 0.07
     rank  6: 0.04
     rank  7: 0.03
     rank  8: 0.10
     rank  9: 0.05
     rank 10: 0.05
     rank 11: 0.06
     rank 12: 0.06
     rank 13: 0.03
     rank 14: 0.04
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 29.96
     rank  1: 30.13
     rank  2: 30.04
     rank  3: 29.86
     rank  4: 63.79
     rank  5: 63.80
     rank  6: 63.79
     rank  7: 63.78
     rank  8: 53.68
     rank  9: 53.88
     rank 10: 53.70
     rank 11: 53.62
     rank 12: 45.17
     rank 13: 45.11
     rank 14: 45.14
     rank 15: 45.11
  optimizer:
     rank  0: 30.90
     rank  1: 31.06
     rank  2: 30.98
     rank  3: 30.80
     rank  4: 64.73
     rank  5: 64.73
     rank  6: 64.72
     rank  7: 64.73
     rank  8: 54.61
     rank  9: 54.81
     rank 10: 54.77
     rank 11: 54.56
     rank 12: 46.11
     rank 13: 46.04
     rank 14: 46.08
     rank 15: 46.04
 [2024-12-24 22:35:48] iteration        8/      10 | consumed samples:          128 | elapsed time per iteration (ms): 2578.2 | learning rate: 6.000000E-06 | global batch size:    16 | lm loss: 3.048261E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2478.01
     rank  1: 2477.92
     rank  2: 2477.95
     rank  3: 2477.98
     rank  4: 2481.14
     rank  5: 2481.20
     rank  6: 2481.13
     rank  7: 2481.17
     rank  8: 2480.21
     rank  9: 2480.29
     rank 10: 2480.15
     rank 11: 2480.24
     rank 12: 2479.48
     rank 13: 2479.38
     rank 14: 2479.37
     rank 15: 2479.36
  forward-compute:
     rank  0: 763.49
     rank  1: 763.27
     rank  2: 784.14
     rank  3: 784.47
     rank  4: 544.41
     rank  5: 544.94
     rank  6: 543.50
     rank  7: 543.63
     rank  8: 506.88
     rank  9: 510.78
     rank 10: 505.61
     rank 11: 508.22
     rank 12: 569.77
     rank 13: 570.62
     rank 14: 569.32
     rank 15: 568.65
  backward-compute:
     rank  0: 691.25
     rank  1: 692.48
     rank  2: 685.26
     rank  3: 684.22
     rank  4: 779.19
     rank  5: 780.82
     rank  6: 778.41
     rank  7: 780.22
     rank  8: 730.62
     rank  9: 732.71
     rank 10: 731.58
     rank 11: 731.22
     rank 12: 828.83
     rank 13: 829.57
     rank 14: 826.68
     rank 15: 827.53
  pure-backward-compute:
     rank  0: 690.91
     rank  1: 692.13
     rank  2: 684.87
     rank  3: 683.82
     rank  4: 778.75
     rank  5: 780.43
     rank  6: 777.69
     rank  7: 779.86
     rank  8: 729.84
     rank  9: 731.98
     rank 10: 730.76
     rank 11: 730.52
     rank 12: 826.96
     rank 13: 828.03
     rank 14: 825.15
     rank 15: 825.93
  batch-generator:
     rank  0: 31.13
     rank  1: 31.71
     rank  2: 32.28
     rank  3: 33.58
     rank  4: 27.29
     rank  5: 27.92
     rank  6: 21.72
     rank  7: 22.92
     rank  8: 26.14
     rank  9: 30.50
     rank 10: 38.17
     rank 11: 37.21
     rank 12: 36.53
     rank 13: 36.68
     rank 14: 32.41
     rank 15: 30.54
  forward-recv:
     rank  4: 143.14
     rank  5: 144.00
     rank  6: 147.15
     rank  7: 146.64
     rank  8: 196.26
     rank  9: 194.84
     rank 10: 199.40
     rank 11: 199.25
     rank 12: 234.98
     rank 13: 235.36
     rank 14: 236.17
     rank 15: 236.54
  forward-send:
     rank  0: 1.78
     rank  1: 1.66
     rank  2: 2.03
     rank  3: 1.80
     rank  4: 6.99
     rank  5: 6.16
     rank  6: 6.40
     rank  7: 6.55
     rank  8: 4.12
     rank  9: 4.66
     rank 10: 4.78
     rank 11: 4.07
  backward-recv:
     rank  0: 258.28
     rank  1: 257.55
     rank  2: 251.10
     rank  3: 252.02
     rank  4: 148.93
     rank  5: 149.77
     rank  6: 141.92
     rank  7: 142.63
     rank  8: 85.42
     rank  9: 85.41
     rank 10: 81.63
     rank 11: 82.15
  backward-send:
     rank  4: 1.26
     rank  5: 0.90
     rank  6: 1.41
     rank  7: 0.92
     rank  8: 5.87
     rank  9: 6.20
     rank 10: 6.30
     rank 11: 6.02
     rank 12: 4.28
     rank 13: 4.04
     rank 14: 4.55
     rank 15: 4.45
  forward-send-backward-recv:
     rank  0: 239.90
     rank  1: 239.62
     rank  2: 233.69
     rank  3: 233.91
     rank  4: 193.34
     rank  5: 193.04
     rank  6: 182.96
     rank  7: 181.83
     rank  8: 168.37
     rank  9: 167.05
     rank 10: 167.61
     rank 11: 171.19
  backward-send-forward-recv:
     rank  4: 57.17
     rank  5: 57.19
     rank  6: 75.51
     rank  7: 76.12
     rank  8: 80.00
     rank  9: 76.85
     rank 10: 79.81
     rank 11: 78.70
     rank 12: 45.07
     rank 13: 43.68
     rank 14: 47.94
     rank 15: 47.83
  layernorm-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.06
     rank  6: 0.07
     rank  7: 0.05
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.08
     rank 13: 0.07
     rank 14: 0.06
     rank 15: 0.06
  all-grads-sync:
     rank  0: 247.03
     rank  1: 236.25
     rank  2: 247.12
     rank  3: 236.09
     rank  4: 509.41
     rank  5: 509.72
     rank  6: 509.42
     rank  7: 509.68
     rank  8: 440.97
     rank  9: 440.90
     rank 10: 440.96
     rank 11: 440.88
     rank 12: 284.70
     rank 13: 271.86
     rank 14: 284.73
     rank 15: 271.87
  optimizer-copy-to-main-grad:
     rank  0: 0.24
     rank  1: 0.24
     rank  2: 0.25
     rank  3: 0.24
     rank  4: 0.04
     rank  5: 0.06
     rank  6: 0.04
     rank  7: 0.03
     rank  8: 0.04
     rank  9: 0.05
     rank 10: 0.05
     rank 11: 0.04
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.03
  optimizer-count-zeros:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 30.18
     rank  1: 29.73
     rank  2: 30.19
     rank  3: 29.92
     rank  4: 63.80
     rank  5: 63.85
     rank  6: 63.86
     rank  7: 63.74
     rank  8: 53.64
     rank  9: 53.77
     rank 10: 53.77
     rank 11: 53.66
     rank 12: 45.20
     rank 13: 45.08
     rank 14: 45.06
     rank 15: 45.13
  optimizer:
     rank  0: 31.12
     rank  1: 30.67
     rank  2: 31.13
     rank  3: 30.86
     rank  4: 64.73
     rank  5: 64.78
     rank  6: 64.80
     rank  7: 64.68
     rank  8: 54.57
     rank  9: 54.71
     rank 10: 54.70
     rank 11: 54.60
     rank 12: 46.13
     rank 13: 46.01
     rank 14: 46.01
     rank 15: 46.07
 [2024-12-24 22:35:51] iteration        9/      10 | consumed samples:          144 | elapsed time per iteration (ms): 2577.6 | learning rate: 6.750000E-06 | global batch size:    16 | lm loss: 2.358960E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2477.89
     rank  1: 2477.89
     rank  2: 2477.93
     rank  3: 2477.91
     rank  4: 2481.11
     rank  5: 2481.14
     rank  6: 2481.19
     rank  7: 2481.11
     rank  8: 2480.15
     rank  9: 2480.17
     rank 10: 2480.17
     rank 11: 2480.21
     rank 12: 2479.35
     rank 13: 2479.36
     rank 14: 2479.32
     rank 15: 2479.30
  forward-compute:
     rank  0: 765.85
     rank  1: 766.00
     rank  2: 768.77
     rank  3: 768.19
     rank  4: 549.66
     rank  5: 550.60
     rank  6: 548.26
     rank  7: 548.91
     rank  8: 515.97
     rank  9: 519.14
     rank 10: 494.95
     rank 11: 497.07
     rank 12: 561.73
     rank 13: 562.30
     rank 14: 575.28
     rank 15: 576.01
  backward-compute:
     rank  0: 691.57
     rank  1: 693.04
     rank  2: 687.91
     rank  3: 688.82
     rank  4: 778.68
     rank  5: 779.77
     rank  6: 778.47
     rank  7: 780.96
     rank  8: 730.85
     rank  9: 731.31
     rank 10: 731.75
     rank 11: 731.15
     rank 12: 835.54
     rank 13: 835.67
     rank 14: 832.06
     rank 15: 831.35
  pure-backward-compute:
     rank  0: 691.19
     rank  1: 692.69
     rank  2: 687.49
     rank  3: 688.42
     rank  4: 778.16
     rank  5: 779.40
     rank  6: 777.77
     rank  7: 780.58
     rank  8: 730.09
     rank  9: 730.72
     rank 10: 730.86
     rank 11: 730.59
     rank 12: 833.77
     rank 13: 834.09
     rank 14: 830.57
     rank 15: 829.64
  batch-generator:
     rank  0: 30.63
     rank  1: 31.76
     rank  2: 34.04
     rank  3: 34.47
     rank  4: 31.35
     rank  5: 31.60
     rank  6: 25.58
     rank  7: 24.66
     rank  8: 33.88
     rank  9: 34.38
     rank 10: 31.14
     rank 11: 32.61
     rank 12: 32.63
     rank 13: 32.63
     rank 14: 33.07
     rank 15: 33.89
  forward-recv:
     rank  4: 136.06
     rank  5: 137.25
     rank  6: 132.07
     rank  7: 131.75
     rank  8: 183.04
     rank  9: 182.15
     rank 10: 193.24
     rank 11: 194.37
     rank 12: 236.84
     rank 13: 236.66
     rank 14: 228.34
     rank 15: 227.56
  forward-send:
     rank  0: 1.75
     rank  1: 1.69
     rank  2: 1.91
     rank  3: 1.70
     rank  4: 9.28
     rank  5: 8.00
     rank  6: 8.65
     rank  7: 8.66
     rank  8: 3.36
     rank  9: 3.16
     rank 10: 2.81
     rank 11: 2.19
  backward-recv:
     rank  0: 261.75
     rank  1: 260.58
     rank  2: 267.19
     rank  3: 266.70
     rank  4: 150.44
     rank  5: 150.37
     rank  6: 155.16
     rank  7: 155.72
     rank  8: 82.95
     rank  9: 83.55
     rank 10: 84.01
     rank 11: 84.24
  backward-send:
     rank  4: 1.23
     rank  5: 0.86
     rank  6: 1.36
     rank  7: 0.94
     rank  8: 9.05
     rank  9: 8.70
     rank 10: 9.37
     rank 11: 9.17
     rank 12: 4.28
     rank 13: 4.25
     rank 14: 4.67
     rank 15: 4.59
  forward-send-backward-recv:
     rank  0: 237.12
     rank  1: 236.49
     rank  2: 231.52
     rank  3: 231.69
     rank  4: 194.23
     rank  5: 194.01
     rank  6: 204.11
     rank  7: 201.67
     rank  8: 190.06
     rank  9: 190.23
     rank 10: 218.56
     rank 11: 221.53
  backward-send-forward-recv:
     rank  4: 57.56
     rank  5: 57.42
     rank  6: 49.60
     rank  7: 49.57
     rank  8: 64.17
     rank  9: 62.39
     rank 10: 44.78
     rank 11: 42.97
     rank 12: 45.55
     rank 13: 45.28
     rank 14: 45.15
     rank 15: 46.02
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.04
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.07
     rank  6: 0.07
     rank  7: 0.05
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.07
     rank 13: 0.06
     rank 14: 0.07
     rank 15: 0.06
  all-grads-sync:
     rank  0: 258.54
     rank  1: 246.31
     rank  2: 258.55
     rank  3: 246.15
     rank  4: 508.76
     rank  5: 508.75
     rank  6: 508.76
     rank  7: 508.70
     rank  8: 438.39
     rank  9: 438.41
     rank 10: 438.43
     rank 11: 438.38
     rank 12: 285.97
     rank 13: 273.91
     rank 14: 285.98
     rank 15: 273.92
  optimizer-copy-to-main-grad:
     rank  0: 0.23
     rank  1: 0.24
     rank  2: 0.24
     rank  3: 0.24
     rank  4: 0.04
     rank  5: 0.04
     rank  6: 0.05
     rank  7: 0.04
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.06
     rank 12: 0.08
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.04
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.04
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 29.76
     rank  1: 30.08
     rank  2: 30.02
     rank  3: 29.91
     rank  4: 63.80
     rank  5: 63.91
     rank  6: 63.88
     rank  7: 63.84
     rank  8: 53.58
     rank  9: 53.67
     rank 10: 53.57
     rank 11: 53.74
     rank 12: 45.43
     rank 13: 45.06
     rank 14: 45.07
     rank 15: 45.08
  optimizer:
     rank  0: 31.17
     rank  1: 31.49
     rank  2: 31.44
     rank  3: 31.32
     rank  4: 65.21
     rank  5: 65.32
     rank  6: 65.29
     rank  7: 65.26
     rank  8: 55.00
     rank  9: 55.08
     rank 10: 54.98
     rank 11: 55.15
     rank 12: 46.81
     rank 13: 46.47
     rank 14: 46.48
     rank 15: 46.49
 [2024-12-24 22:35:53] iteration       10/      10 | consumed samples:          160 | elapsed time per iteration (ms): 2575.6 | learning rate: 7.500000E-06 | global batch size:    16 | lm loss: 9.994118E-01 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2476.66
     rank  1: 2476.85
     rank  2: 2476.68
     rank  3: 2476.68
     rank  4: 2479.82
     rank  5: 2479.88
     rank  6: 2479.83
     rank  7: 2479.88
     rank  8: 2478.99
     rank  9: 2478.98
     rank 10: 2478.93
     rank 11: 2478.94
     rank 12: 2478.10
     rank 13: 2478.22
     rank 14: 2478.09
     rank 15: 2478.14
  forward-compute:
     rank  0: 758.46
     rank  1: 757.97
     rank  2: 766.13
     rank  3: 766.09
     rank  4: 539.67
     rank  5: 540.01
     rank  6: 552.52
     rank  7: 552.95
     rank  8: 501.86
     rank  9: 506.73
     rank 10: 497.25
     rank 11: 498.17
     rank 12: 576.14
     rank 13: 574.52
     rank 14: 571.49
     rank 15: 573.03
  backward-compute:
     rank  0: 692.79
     rank  1: 693.69
     rank  2: 692.71
     rank  3: 691.26
     rank  4: 781.34
     rank  5: 782.25
     rank  6: 777.14
     rank  7: 778.32
     rank  8: 732.54
     rank  9: 730.96
     rank 10: 729.37
     rank 11: 728.43
     rank 12: 828.65
     rank 13: 829.35
     rank 14: 838.84
     rank 15: 839.10
  pure-backward-compute:
     rank  0: 692.40
     rank  1: 693.30
     rank  2: 692.34
     rank  3: 690.90
     rank  4: 780.76
     rank  5: 781.79
     rank  6: 776.61
     rank  7: 777.89
     rank  8: 731.66
     rank  9: 730.21
     rank 10: 728.40
     rank 11: 728.02
     rank 12: 827.21
     rank 13: 827.84
     rank 14: 837.33
     rank 15: 837.43
  batch-generator:
     rank  0: 30.36
     rank  1: 30.49
     rank  2: 30.22
     rank  3: 30.76
     rank  4: 24.37
     rank  5: 25.27
     rank  6: 26.86
     rank  7: 26.01
     rank  8: 23.52
     rank  9: 29.04
     rank 10: 30.95
     rank 11: 31.19
     rank 12: 34.24
     rank 13: 32.00
     rank 14: 34.74
     rank 15: 35.54
  forward-recv:
     rank  4: 128.75
     rank  5: 131.09
     rank  6: 127.69
     rank  7: 127.80
     rank  8: 188.75
     rank  9: 186.52
     rank 10: 191.25
     rank 11: 192.83
     rank 12: 231.43
     rank 13: 231.48
     rank 14: 230.14
     rank 15: 228.70
  forward-send:
     rank  0: 1.85
     rank  1: 1.73
     rank  2: 1.84
     rank  3: 1.57
     rank  4: 9.27
     rank  5: 7.08
     rank  6: 8.95
     rank  7: 8.84
     rank  8: 4.73
     rank  9: 4.71
     rank 10: 4.80
     rank 11: 3.16
  backward-recv:
     rank  0: 263.24
     rank  1: 263.04
     rank  2: 257.56
     rank  3: 259.29
     rank  4: 152.73
     rank  5: 152.97
     rank  6: 150.89
     rank  7: 150.84
     rank  8: 82.10
     rank  9: 82.11
     rank 10: 83.87
     rank 11: 84.11
  backward-send:
     rank  4: 1.10
     rank  5: 1.14
     rank  6: 1.09
     rank  7: 1.07
     rank  8: 6.98
     rank  9: 7.43
     rank 10: 7.52
     rank 11: 7.42
     rank 12: 3.70
     rank 13: 3.68
     rank 14: 3.10
     rank 15: 3.18
  forward-send-backward-recv:
     rank  0: 240.69
     rank  1: 240.34
     rank  2: 241.93
     rank  3: 242.24
     rank  4: 205.74
     rank  5: 204.72
     rank  6: 199.53
     rank  7: 198.93
     rank  8: 210.37
     rank  9: 212.57
     rank 10: 197.09
     rank 11: 202.12
  backward-send-forward-recv:
     rank  4: 58.28
     rank  5: 58.37
     rank  6: 61.84
     rank  7: 61.77
     rank  8: 51.98
     rank  9: 49.22
     rank 10: 67.43
     rank 11: 67.60
     rank 12: 45.85
     rank 13: 47.06
     rank 14: 44.93
     rank 15: 44.44
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.05
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.04
     rank 14: 0.02
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.04
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.06
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.07
     rank 13: 0.07
     rank 14: 0.06
     rank 15: 0.06
  all-grads-sync:
     rank  0: 245.28
     rank  1: 234.25
     rank  2: 245.17
     rank  3: 234.00
     rank  4: 505.18
     rank  5: 505.23
     rank  6: 505.19
     rank  7: 505.25
     rank  8: 443.00
     rank  9: 442.94
     rank 10: 442.98
     rank 11: 442.93
     rank 12: 285.03
     rank 13: 273.55
     rank 14: 285.04
     rank 15: 273.88
  optimizer-copy-to-main-grad:
     rank  0: 0.25
     rank  1: 0.26
     rank  2: 0.25
     rank  3: 0.25
     rank  4: 0.04
     rank  5: 0.03
     rank  6: 0.04
     rank  7: 0.05
     rank  8: 0.08
     rank  9: 0.04
     rank 10: 0.05
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.05
     rank 14: 0.03
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 30.01
     rank  1: 29.94
     rank  2: 30.06
     rank  3: 29.99
     rank  4: 63.80
     rank  5: 63.74
     rank  6: 63.78
     rank  7: 63.76
     rank  8: 53.69
     rank  9: 53.64
     rank 10: 53.63
     rank 11: 53.56
     rank 12: 45.02
     rank 13: 45.16
     rank 14: 45.05
     rank 15: 45.06
  optimizer:
     rank  0: 30.79
     rank  1: 30.72
     rank  2: 30.84
     rank  3: 30.77
     rank  4: 64.58
     rank  5: 64.52
     rank  6: 64.56
     rank  7: 64.54
     rank  8: 54.47
     rank  9: 54.42
     rank 10: 54.41
     rank 11: 54.34
     rank 12: 45.80
     rank 13: 45.95
     rank 14: 45.83
     rank 15: 45.84
