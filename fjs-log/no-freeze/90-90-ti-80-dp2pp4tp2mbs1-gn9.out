examples/multimodal/pretrain-freeze-llm-hete-3090first.sh: line 4: activate: No such file or directory
3
[2024-12-30 23:27:34,374] torch.distributed.run: [WARNING] 
[2024-12-30 23:27:34,374] torch.distributed.run: [WARNING] *****************************************
[2024-12-30 23:27:34,374] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-12-30 23:27:34,374] torch.distributed.run: [WARNING] *****************************************
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
------pipeline_parallel_model_size:4------------pipeline_parallel_model_size:4------

------pipeline_parallel_model_size:4------------world_size:16------------world_size:16------

------total_model_size:8------

------total_model_size:8------------num_pipeline_model_parallel_groups:4------------world_size:16------


------num_pipeline_model_parallel_groups:4------------total_model_size:8------

------num_pipeline_model_parallel_groups:4------
> setting tensorboard ...
WARNING: one_logger package is required to enable e2e metrics tracking. please go to https://confluence.nvidia.com/display/MLWFO/Package+Repositories for details to install it
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:8------
------num_pipeline_model_parallel_groups:4------
---Rank 14---Tensor Parallel Group GPUs: [0, 0]
---Rank 12---Tensor Parallel Group GPUs: [0, 0]
---Rank 14---Pipeline Parallel Group GPUs: [3, 3, 3, 3]---Rank 15---Tensor Parallel Group GPUs: [1, 1]

---Rank 13---Tensor Parallel Group GPUs: [1, 1]---Rank 12---Pipeline Parallel Group GPUs: [3, 3, 3, 3]

---Rank 15---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
---Rank 13---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
[rank14]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank12]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank15]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank13]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
 > number of parameters on (tensor, pipeline) model parallel rank (0, 3): 285233152
 > number of parameters on (tensor, pipeline) model parallel rank (1, 3): 285233152
INFO:megatron.core.distributed.param_and_grad_buffer:Number of buckets for gradient all-reduce / reduce-scatter: 1
Params for bucket 1 (285233152 elements):
	language_model.decoder.layers.1.mlp.linear_fc1.weight
	language_model.decoder.layers.1.self_attention.linear_qkv.weight
	language_model.decoder.layers.0.mlp.linear_fc2.weight
	language_model.decoder.layers.0.mlp.linear_fc1.weight
	language_model.output_layer.weight
	language_model.decoder.layers.1.pre_mlp_layernorm.weight
	language_model.decoder.final_layernorm.weight
	language_model.decoder.layers.1.mlp.linear_fc2.weight
	language_model.decoder.layers.1.self_attention.linear_proj.weight
	language_model.decoder.layers.1.input_layernorm.weight
	language_model.decoder.layers.0.pre_mlp_layernorm.weight
	language_model.decoder.layers.0.self_attention.linear_qkv.weight
	language_model.decoder.layers.0.self_attention.linear_proj.weight
	language_model.decoder.layers.0.input_layernorm.weight
rank=0, worker=0: shard_range=[pretrain-0.tar[0, 100), pretrain-0.tar[100, 200), pretrain-0.tar[200, 300), ...<1244>, pretrain-2.tar[4700, 4800), pretrain-2.tar[4800, 4900), pretrain-2.tar[4900, 5000)] sum(count)=125000
rank=0, worker=1: shard_range=[pretrain-2.tar[5000, 5100), pretrain-2.tar[5100, 5200), pretrain-2.tar[5200, 5300), ...<1244>, pretrain-30.tar[9700, 9800), pretrain-30.tar[9800, 9900), pretrain-30.tar[9900, 10000)] sum(count)=125000
rank=1, worker=0: shard_range=[pretrain-31.tar[0, 100), pretrain-31.tar[100, 200), pretrain-31.tar[200, 300), ...<1244>, pretrain-42.tar[4700, 4800), pretrain-42.tar[4800, 4900), pretrain-42.tar[4900, 5000)] sum(count)=125000
rank=1, worker=1: shard_range=[pretrain-42.tar[5000, 5100), pretrain-42.tar[5100, 5200), pretrain-42.tar[5200, 5300), ...<1244>, pretrain-53.tar[9700, 9800), pretrain-53.tar[9800, 9900), pretrain-53.tar[9900, 10000)] sum(count)=125000
rank=1, worker=0: shard_range=[pretrain-7.tar[936, 10000), pretrain-8.tar[0, 5468)] sum(count)=14532
rank=1, worker=1: shard_range=[pretrain-8.tar[5468, 10000), pretrain-9.tar[0, 10000)] sum(count)=14532
rank=0, worker=0: shard_range=[pretrain-54.tar[0, 10000), pretrain-55.tar[0, 4532)] sum(count)=14532
rank=0, worker=1: shard_range=[pretrain-55.tar[4532, 8128), pretrain-6.tar[0, 10000), pretrain-7.tar[0, 936)] sum(count)=14532
times across ranks (ms):
  model-and-optimizer-setup:
     rank  0: 67.16
     rank  1: 66.81
     rank  2: 67.02
     rank  3: 63.18
     rank  4: 38.51
     rank  5: 38.93
     rank  6: 31.77
     rank  7: 44.19
     rank  8: 49.78
     rank  9: 50.75
     rank 10: 50.33
     rank 11: 51.10
     rank 12: 45.25
     rank 13: 45.91
     rank 14: 45.22
     rank 15: 44.86
  train/valid/test-data-iterators-setup:
     rank  0: 861.10
     rank  1: 860.93
     rank  2: 861.15
     rank  3: 860.96
     rank  4: 1090.86
     rank  5: 1090.89
     rank  6: 1090.80
     rank  7: 1091.77
     rank  8: 1289.11
     rank  9: 1289.50
     rank 10: 1289.38
     rank 11: 1289.19
     rank 12: 1289.23
     rank 13: 1289.39
     rank 14: 1289.23
     rank 15: 1289.44
 [2024-12-30 23:28:10] iteration        1/      10 | consumed samples:           32 | elapsed time per iteration (ms): 14251.0 | learning rate: 7.500000E-07 | global batch size:    32 | lm loss: 7.231089E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
[Rank 13] (after 1 iterations) memory (MB) | allocated: 4464.5654296875 | max allocated: 5552.572265625 | reserved: 5934.0 | max reserved: 5934.0
stage4 GPU utialization:49.29485321044922 %
[Rank 12] (after 1 iterations) memory (MB) | allocated: 4464.5654296875 | max allocated: 5552.572265625 | reserved: 5934.0 | max reserved: 5934.0
times across ranks (ms):
  forward-backward:
     rank  0: 14156.55
     rank  1: 14156.57
     rank  2: 14156.59
     rank  3: 14156.54
     rank  4: 14157.30
     rank  5: 14157.33
     rank  6: 14157.41
     rank  7: 14157.34
     rank  8: 14157.63
     rank  9: 14157.65
     rank 10: 14157.71
     rank 11: 14157.53
     rank 12: 14157.58
     rank 13: 14157.64
     rank 14: 14157.69
     rank 15: 14157.54
  forward-compute:
     rank  0: 5425.46
     rank  1: 5396.46
     rank  2: 5366.61
     rank  3: 5369.54
     rank  4: 3382.60
     rank  5: 3354.28
     rank  6: 3183.23
     rank  7: 3182.37
     rank  8: 2499.47
     rank  9: 2476.21
     rank 10: 2600.36
     rank 11: 2601.96
     rank 12: 2570.41
     rank 13: 2555.79
     rank 14: 2681.01
     rank 15: 2689.25
  backward-compute:
     rank  0: 2711.32
     rank  1: 2712.58
     rank  2: 2690.71
     rank  3: 2681.41
     rank  4: 1783.24
     rank  5: 1781.17
     rank  6: 1770.67
     rank  7: 1776.56
     rank  8: 1876.18
     rank  9: 1883.90
     rank 10: 1895.65
     rank 11: 1902.72
     rank 12: 1925.23
     rank 13: 1922.72
     rank 14: 1928.82
     rank 15: 1924.65
  pure-backward-compute:
     rank  0: 2710.03
     rank  1: 2710.74
     rank  2: 2689.40
     rank  3: 2680.20
     rank  4: 1781.59
     rank  5: 1779.37
     rank  6: 1768.86
     rank  7: 1775.12
     rank  8: 1873.68
     rank  9: 1881.25
     rank 10: 1893.37
     rank 11: 1900.38
     rank 12: 1922.49
     rank 13: 1918.93
     rank 14: 1924.68
     rank 15: 1922.28
  batch-generator:
     rank  0: 1140.36
     rank  1: 1125.40
     rank  2: 1119.63
     rank  3: 1126.68
     rank  4: 1036.27
     rank  5: 1013.28
     rank  6: 863.60
     rank  7: 862.50
     rank  8: 1242.77
     rank  9: 1218.26
     rank 10: 1311.59
     rank 11: 1303.31
     rank 12: 1105.03
     rank 13: 1095.53
     rank 14: 1108.93
     rank 15: 1094.23
  forward-recv:
     rank  4: 3981.39
     rank  5: 3986.73
     rank  6: 4047.11
     rank  7: 4048.17
     rank  8: 6136.75
     rank  9: 6141.77
     rank 10: 6015.03
     rank 11: 6015.40
     rank 12: 7489.54
     rank 13: 7506.54
     rank 14: 7455.45
     rank 15: 7455.57
  forward-send:
     rank  0: 3458.07
     rank  1: 3485.40
     rank  2: 3386.82
     rank  3: 3390.02
     rank  4: 1289.08
     rank  5: 1310.60
     rank  6: 1383.61
     rank  7: 1385.54
     rank  8: 22.15
     rank  9: 38.77
     rank 10: 19.25
     rank 11: 20.48
  backward-recv:
     rank  0: 346.47
     rank  1: 343.54
     rank  2: 328.22
     rank  3: 329.59
     rank  4: 181.15
     rank  5: 180.64
     rank  6: 181.39
     rank  7: 181.00
     rank  8: 81.69
     rank  9: 82.47
     rank 10: 80.15
     rank 11: 78.05
  backward-send:
     rank  4: 14.48
     rank  5: 14.40
     rank  6: 14.41
     rank  7: 13.53
     rank  8: 10.07
     rank  9: 9.38
     rank 10: 10.04
     rank 11: 9.46
     rank 12: 4.28
     rank 13: 4.23
     rank 14: 4.03
     rank 15: 2.15
  forward-send-backward-recv:
     rank  0: 1690.28
     rank  1: 1692.24
     rank  2: 1864.10
     rank  3: 1867.29
     rank  4: 1604.65
     rank  5: 1607.35
     rank  6: 1796.47
     rank  7: 1791.10
     rank  8: 1527.28
     rank  9: 1521.59
     rank 10: 1640.96
     rank 11: 1635.13
  backward-send-forward-recv:
     rank  4: 1313.86
     rank  5: 1314.32
     rank  6: 1171.71
     rank  7: 1169.77
     rank  8: 1281.97
     rank  9: 1282.04
     rank 10: 1173.25
     rank 11: 1170.78
     rank 12: 1325.40
     rank 13: 1324.34
     rank 14: 1243.42
     rank 15: 1239.85
  layernorm-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.05
     rank  2: 0.04
     rank  3: 0.06
     rank  4: 0.03
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.03
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.09
     rank 12: 0.03
     rank 13: 0.04
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.09
     rank  1: 0.09
     rank  2: 0.10
     rank  3: 0.13
     rank  4: 0.03
     rank  5: 0.04
     rank  6: 0.04
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.05
     rank 12: 0.08
     rank 13: 0.12
     rank 14: 0.08
     rank 15: 0.09
  all-grads-sync:
     rank  0: 463.07
     rank  1: 462.94
     rank  2: 463.08
     rank  3: 463.13
     rank  4: 490.36
     rank  5: 496.02
     rank  6: 490.35
     rank  7: 495.98
     rank  8: 360.19
     rank  9: 364.79
     rank 10: 360.19
     rank 11: 364.75
     rank 12: 486.16
     rank 13: 465.84
     rank 14: 486.13
     rank 15: 465.92
  optimizer-copy-to-main-grad:
     rank  0: 0.45
     rank  1: 0.29
     rank  2: 0.30
     rank  3: 0.30
     rank  4: 0.09
     rank  5: 0.06
     rank  6: 0.06
     rank  7: 0.07
     rank  8: 0.06
     rank  9: 0.07
     rank 10: 0.06
     rank 11: 0.09
     rank 12: 0.05
     rank 13: 0.06
     rank 14: 0.04
     rank 15: 0.06
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 60.56
     rank  1: 60.18
     rank  2: 59.97
     rank  3: 59.81
     rank  4: 69.33
     rank  5: 71.31
     rank  6: 69.42
     rank  7: 70.75
     rank  8: 83.07
     rank  9: 81.62
     rank 10: 82.37
     rank 11: 81.54
     rank 12: 83.96
     rank 13: 86.23
     rank 14: 83.76
     rank 15: 83.86
  optimizer:
     rank  0: 61.90
     rank  1: 61.49
     rank  2: 61.30
     rank  3: 61.17
     rank  4: 70.68
     rank  5: 72.65
     rank  6: 70.76
     rank  7: 72.09
     rank  8: 84.41
     rank  9: 82.95
     rank 10: 83.71
     rank 11: 82.87
     rank 12: 85.30
     rank 13: 87.57
     rank 14: 85.10
     rank 15: 85.20
 [2024-12-30 23:28:15] iteration        2/      10 | consumed samples:           64 | elapsed time per iteration (ms): 5213.0 | learning rate: 1.500000E-06 | global batch size:    32 | lm loss: 7.232357E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 5121.87
     rank  1: 5121.84
     rank  2: 5121.93
     rank  3: 5121.77
     rank  4: 5122.66
     rank  5: 5124.79
     rank  6: 5122.65
     rank  7: 5122.70
     rank  8: 5122.37
     rank  9: 5122.54
     rank 10: 5122.38
     rank 11: 5122.44
     rank 12: 5122.57
     rank 13: 5122.63
     rank 14: 5122.61
     rank 15: 5122.60
  forward-compute:
     rank  0: 1943.36
     rank  1: 1948.63
     rank  2: 1886.50
     rank  3: 1886.61
     rank  4: 1315.71
     rank  5: 1313.92
     rank  6: 1322.47
     rank  7: 1329.75
     rank  8: 1209.45
     rank  9: 1209.61
     rank 10: 1236.34
     rank 11: 1238.20
     rank 12: 1290.03
     rank 13: 1292.06
     rank 14: 1360.79
     rank 15: 1368.21
  backward-compute:
     rank  0: 1577.48
     rank  1: 1566.80
     rank  2: 1577.53
     rank  3: 1583.03
     rank  4: 1793.20
     rank  5: 1790.01
     rank  6: 1782.14
     rank  7: 1785.78
     rank  8: 1880.03
     rank  9: 1884.49
     rank 10: 1894.36
     rank 11: 1897.96
     rank 12: 1912.15
     rank 13: 1909.83
     rank 14: 1907.96
     rank 15: 1905.43
  pure-backward-compute:
     rank  0: 1576.08
     rank  1: 1564.95
     rank  2: 1576.47
     rank  3: 1582.25
     rank  4: 1791.63
     rank  5: 1787.45
     rank  6: 1780.44
     rank  7: 1783.95
     rank  8: 1877.89
     rank  9: 1882.32
     rank 10: 1892.02
     rank 11: 1895.86
     rank 12: 1909.46
     rank 13: 1906.76
     rank 14: 1905.12
     rank 15: 1902.73
  batch-generator:
     rank  0: 88.32
     rank  1: 98.71
     rank  2: 81.23
     rank  3: 79.20
     rank  4: 55.38
     rank  5: 55.78
     rank  6: 61.79
     rank  7: 67.55
     rank  8: 64.74
     rank  9: 63.54
     rank 10: 67.88
     rank 11: 69.32
     rank 12: 62.40
     rank 13: 66.68
     rank 14: 68.56
     rank 15: 75.41
  forward-recv:
     rank  4: 172.77
     rank  5: 173.77
     rank  6: 173.16
     rank  7: 169.97
     rank  8: 250.09
     rank  9: 249.70
     rank 10: 249.14
     rank 11: 249.02
     rank 12: 295.42
     rank 13: 295.55
     rank 14: 296.77
     rank 15: 296.80
  forward-send:
     rank  0: 12.41
     rank  1: 13.26
     rank  2: 12.98
     rank  3: 10.20
     rank  4: 10.64
     rank  5: 10.52
     rank  6: 10.64
     rank  7: 10.49
     rank  8: 4.86
     rank  9: 5.08
     rank 10: 4.43
     rank 11: 4.31
  backward-recv:
     rank  0: 323.75
     rank  1: 326.41
     rank  2: 363.14
     rank  3: 363.69
     rank  4: 184.33
     rank  5: 184.49
     rank  6: 207.10
     rank  7: 206.71
     rank  8: 83.99
     rank  9: 83.37
     rank 10: 91.39
     rank 11: 92.06
  backward-send:
     rank  4: 10.15
     rank  5: 10.42
     rank  6: 9.78
     rank  7: 10.04
     rank  8: 6.56
     rank  9: 7.30
     rank 10: 7.50
     rank 11: 7.35
     rank 12: 5.35
     rank 13: 5.00
     rank 14: 4.97
     rank 15: 5.35
  forward-send-backward-recv:
     rank  0: 361.87
     rank  1: 364.88
     rank  2: 379.81
     rank  3: 386.93
     rank  4: 279.53
     rank  5: 280.22
     rank  6: 344.17
     rank  7: 342.01
     rank  8: 233.77
     rank  9: 229.30
     rank 10: 256.93
     rank 11: 252.70
  backward-send-forward-recv:
     rank  4: 371.12
     rank  5: 370.64
     rank  6: 286.95
     rank  7: 282.57
     rank  8: 353.29
     rank  9: 352.72
     rank 10: 281.56
     rank 11: 281.52
     rank 12: 398.06
     rank 13: 397.84
     rank 14: 329.76
     rank 15: 325.36
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.03
     rank  4: 0.03
     rank  5: 0.07
     rank  6: 0.03
     rank  7: 0.04
     rank  8: 0.03
     rank  9: 0.04
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.08
     rank  1: 0.07
     rank  2: 0.09
     rank  3: 0.05
     rank  4: 0.03
     rank  5: 0.06
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.06
     rank 13: 0.07
     rank 14: 0.07
     rank 15: 0.06
  all-grads-sync:
     rank  0: 391.35
     rank  1: 392.42
     rank  2: 391.41
     rank  3: 392.51
     rank  4: 863.89
     rank  5: 872.18
     rank  6: 863.89
     rank  7: 872.18
     rank  8: 271.65
     rank  9: 267.97
     rank 10: 271.59
     rank 11: 267.91
     rank 12: 458.61
     rank 13: 437.67
     rank 14: 458.60
     rank 15: 437.71
  optimizer-copy-to-main-grad:
     rank  0: 0.28
     rank  1: 0.26
     rank  2: 0.28
     rank  3: 0.22
     rank  4: 0.11
     rank  5: 0.15
     rank  6: 0.08
     rank  7: 0.11
     rank  8: 0.05
     rank  9: 0.07
     rank 10: 0.09
     rank 11: 0.04
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 47.61
     rank  1: 48.04
     rank  2: 48.20
     rank  3: 47.51
     rank  4: 54.33
     rank  5: 54.74
     rank  6: 54.22
     rank  7: 54.32
     rank  8: 52.34
     rank  9: 52.63
     rank 10: 52.35
     rank 11: 52.39
     rank 12: 54.54
     rank 13: 54.71
     rank 14: 54.54
     rank 15: 54.66
  optimizer:
     rank  0: 48.70
     rank  1: 49.14
     rank  2: 49.29
     rank  3: 48.60
     rank  4: 55.43
     rank  5: 55.79
     rank  6: 55.35
     rank  7: 55.44
     rank  8: 53.43
     rank  9: 53.76
     rank 10: 53.45
     rank 11: 53.49
     rank 12: 55.64
     rank 13: 55.81
     rank 14: 55.63
     rank 15: 55.76
 [2024-12-30 23:28:20] iteration        3/      10 | consumed samples:           96 | elapsed time per iteration (ms): 4989.6 | learning rate: 2.250000E-06 | global batch size:    32 | lm loss: 6.699347E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4893.31
     rank  1: 4893.48
     rank  2: 4893.27
     rank  3: 4893.43
     rank  4: 4894.36
     rank  5: 4894.28
     rank  6: 4894.32
     rank  7: 4894.19
     rank  8: 4893.96
     rank  9: 4894.19
     rank 10: 4893.98
     rank 11: 4894.06
     rank 12: 4894.21
     rank 13: 4894.29
     rank 14: 4894.26
     rank 15: 4894.27
  forward-compute:
     rank  0: 1656.19
     rank  1: 1659.37
     rank  2: 1502.73
     rank  3: 1503.50
     rank  4: 1330.97
     rank  5: 1329.82
     rank  6: 1328.03
     rank  7: 1332.78
     rank  8: 1223.34
     rank  9: 1221.39
     rank 10: 1238.36
     rank 11: 1239.32
     rank 12: 1293.03
     rank 13: 1294.63
     rank 14: 1324.69
     rank 15: 1329.21
  backward-compute:
     rank  0: 1556.47
     rank  1: 1552.75
     rank  2: 1607.98
     rank  3: 1609.94
     rank  4: 1800.79
     rank  5: 1798.90
     rank  6: 1789.92
     rank  7: 1792.19
     rank  8: 1892.57
     rank  9: 1898.06
     rank 10: 1907.28
     rank 11: 1908.49
     rank 12: 1914.77
     rank 13: 1912.55
     rank 14: 1913.43
     rank 15: 1910.35
  pure-backward-compute:
     rank  0: 1555.44
     rank  1: 1550.97
     rank  2: 1606.94
     rank  3: 1609.11
     rank  4: 1798.76
     rank  5: 1796.54
     rank  6: 1788.27
     rank  7: 1790.92
     rank  8: 1890.38
     rank  9: 1896.12
     rank 10: 1905.19
     rank 11: 1906.74
     rank 12: 1912.24
     rank 13: 1909.79
     rank 14: 1910.64
     rank 15: 1908.06
  batch-generator:
     rank  0: 77.67
     rank  1: 94.25
     rank  2: 68.43
     rank  3: 70.73
     rank  4: 60.79
     rank  5: 59.10
     rank  6: 60.82
     rank  7: 63.62
     rank  8: 62.75
     rank  9: 59.57
     rank 10: 61.55
     rank 11: 62.82
     rank 12: 60.60
     rank 13: 64.68
     rank 14: 58.82
     rank 15: 63.45
  forward-recv:
     rank  4: 139.00
     rank  5: 138.62
     rank  6: 99.15
     rank  7: 98.00
     rank  8: 219.88
     rank  9: 219.45
     rank 10: 188.15
     rank 11: 188.47
     rank 12: 269.27
     rank 13: 269.56
     rank 14: 253.35
     rank 15: 253.21
  forward-send:
     rank  0: 8.21
     rank  1: 8.10
     rank  2: 7.83
     rank  3: 6.81
     rank  4: 5.62
     rank  5: 6.00
     rank  6: 5.74
     rank  7: 5.72
     rank  8: 4.68
     rank  9: 5.00
     rank 10: 2.85
     rank 11: 2.73
  backward-recv:
     rank  0: 345.39
     rank  1: 336.70
     rank  2: 339.49
     rank  3: 339.35
     rank  4: 181.10
     rank  5: 181.31
     rank  6: 181.44
     rank  7: 181.89
     rank  8: 80.41
     rank  9: 80.48
     rank 10: 80.35
     rank 11: 79.36
  backward-send:
     rank  4: 13.56
     rank  5: 13.68
     rank  6: 13.27
     rank  7: 12.82
     rank  8: 10.87
     rank  9: 10.46
     rank 10: 10.10
     rank 11: 9.59
     rank 12: 5.04
     rank 13: 4.94
     rank 14: 4.85
     rank 15: 4.06
  forward-send-backward-recv:
     rank  0: 401.39
     rank  1: 401.60
     rank  2: 509.52
     rank  3: 514.56
     rank  4: 302.21
     rank  5: 306.36
     rank  6: 390.33
     rank  7: 388.81
     rank  8: 237.00
     rank  9: 232.09
     rank 10: 273.22
     rank 11: 272.33
  backward-send-forward-recv:
     rank  4: 108.03
     rank  5: 107.26
     rank  6: 72.74
     rank  7: 69.44
     rank  8: 100.08
     rank  9: 101.63
     rank 10: 67.59
     rank 11: 67.92
     rank 12: 163.64
     rank 13: 163.85
     rank 14: 149.01
     rank 15: 147.75
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.04
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.07
     rank  5: 0.03
     rank  6: 0.07
     rank  7: 0.03
     rank  8: 0.02
     rank  9: 0.14
     rank 10: 0.03
     rank 11: 0.05
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.08
     rank  2: 0.05
     rank  3: 0.06
     rank  4: 0.06
     rank  5: 0.03
     rank  6: 0.06
     rank  7: 0.03
     rank  8: 0.02
     rank  9: 0.05
     rank 10: 0.02
     rank 11: 0.04
     rank 12: 0.06
     rank 13: 0.08
     rank 14: 0.07
     rank 15: 0.08
  all-grads-sync:
     rank  0: 382.89
     rank  1: 384.22
     rank  2: 382.80
     rank  3: 384.29
     rank  4: 898.59
     rank  5: 900.17
     rank  6: 898.59
     rank  7: 900.20
     rank  8: 271.85
     rank  9: 271.41
     rank 10: 271.85
     rank 11: 271.17
     rank 12: 460.54
     rank 13: 437.82
     rank 14: 460.40
     rank 15: 437.95
  optimizer-copy-to-main-grad:
     rank  0: 0.24
     rank  1: 0.25
     rank  2: 0.21
     rank  3: 0.31
     rank  4: 0.15
     rank  5: 0.07
     rank  6: 0.15
     rank  7: 0.07
     rank  8: 0.05
     rank  9: 0.09
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.04
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 47.67
     rank  1: 48.14
     rank  2: 47.21
     rank  3: 47.73
     rank  4: 54.61
     rank  5: 54.47
     rank  6: 54.59
     rank  7: 54.36
     rank  8: 52.25
     rank  9: 52.72
     rank 10: 52.45
     rank 11: 52.45
     rank 12: 54.61
     rank 13: 54.70
     rank 14: 54.64
     rank 15: 54.62
  optimizer:
     rank  0: 48.82
     rank  1: 49.29
     rank  2: 48.35
     rank  3: 48.88
     rank  4: 55.74
     rank  5: 55.61
     rank  6: 55.73
     rank  7: 55.51
     rank  8: 53.39
     rank  9: 53.87
     rank 10: 53.60
     rank 11: 53.59
     rank 12: 55.76
     rank 13: 55.85
     rank 14: 55.79
     rank 15: 55.77
 [2024-12-30 23:28:25] iteration        4/      10 | consumed samples:          128 | elapsed time per iteration (ms): 4986.5 | learning rate: 3.000000E-06 | global batch size:    32 | lm loss: 1.725449E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4898.95
     rank  1: 4898.84
     rank  2: 4899.04
     rank  3: 4898.86
     rank  4: 4899.71
     rank  5: 4899.76
     rank  6: 4899.78
     rank  7: 4899.74
     rank  8: 4899.45
     rank  9: 4899.41
     rank 10: 4899.49
     rank 11: 4899.37
     rank 12: 4899.72
     rank 13: 4899.78
     rank 14: 4899.75
     rank 15: 4899.84
  forward-compute:
     rank  0: 1532.68
     rank  1: 1537.66
     rank  2: 1592.69
     rank  3: 1594.61
     rank  4: 1332.79
     rank  5: 1332.98
     rank  6: 1331.13
     rank  7: 1337.61
     rank  8: 1228.94
     rank  9: 1226.28
     rank 10: 1237.96
     rank 11: 1239.39
     rank 12: 1325.16
     rank 13: 1329.82
     rank 14: 1301.17
     rank 15: 1302.19
  backward-compute:
     rank  0: 1562.52
     rank  1: 1557.07
     rank  2: 1574.33
     rank  3: 1580.29
     rank  4: 1800.50
     rank  5: 1796.39
     rank  6: 1797.61
     rank  7: 1798.35
     rank  8: 1892.36
     rank  9: 1901.18
     rank 10: 1915.42
     rank 11: 1917.58
     rank 12: 1920.38
     rank 13: 1917.48
     rank 14: 1914.66
     rank 15: 1910.75
  pure-backward-compute:
     rank  0: 1561.38
     rank  1: 1556.38
     rank  2: 1573.00
     rank  3: 1578.12
     rank  4: 1798.71
     rank  5: 1794.35
     rank  6: 1795.87
     rank  7: 1796.86
     rank  8: 1890.62
     rank  9: 1899.46
     rank 10: 1913.51
     rank 11: 1915.65
     rank 12: 1917.92
     rank 13: 1915.03
     rank 14: 1911.48
     rank 15: 1908.42
  batch-generator:
     rank  0: 79.82
     rank  1: 82.15
     rank  2: 84.88
     rank  3: 84.04
     rank  4: 62.53
     rank  5: 61.99
     rank  6: 61.28
     rank  7: 66.70
     rank  8: 61.83
     rank  9: 56.83
     rank 10: 59.79
     rank 11: 61.08
     rank 12: 67.61
     rank 13: 74.52
     rank 14: 55.56
     rank 15: 57.54
  forward-recv:
     rank  4: 128.74
     rank  5: 128.66
     rank  6: 96.70
     rank  7: 95.78
     rank  8: 217.95
     rank  9: 217.65
     rank 10: 186.49
     rank 11: 186.41
     rank 12: 269.12
     rank 13: 269.34
     rank 14: 252.18
     rank 15: 252.06
  forward-send:
     rank  0: 8.35
     rank  1: 8.20
     rank  2: 7.52
     rank  3: 6.57
     rank  4: 5.83
     rank  5: 5.92
     rank  6: 5.83
     rank  7: 5.47
     rank  8: 4.89
     rank  9: 5.24
     rank 10: 2.82
     rank 11: 2.71
  backward-recv:
     rank  0: 331.58
     rank  1: 333.40
     rank  2: 335.56
     rank  3: 337.16
     rank  4: 178.11
     rank  5: 179.64
     rank  6: 181.59
     rank  7: 181.47
     rank  8: 82.87
     rank  9: 82.17
     rank 10: 81.14
     rank 11: 80.40
  backward-send:
     rank  4: 12.68
     rank  5: 12.52
     rank  6: 13.23
     rank  7: 13.10
     rank  8: 6.56
     rank  9: 7.54
     rank 10: 7.69
     rank 11: 7.82
     rank 12: 5.11
     rank 13: 5.08
     rank 14: 5.11
     rank 15: 4.32
  forward-send-backward-recv:
     rank  0: 534.60
     rank  1: 537.11
     rank  2: 458.63
     rank  3: 462.19
     rank  4: 348.37
     rank  5: 348.67
     rank  6: 354.59
     rank  7: 354.79
     rank  8: 269.33
     rank  9: 262.02
     rank 10: 252.58
     rank 11: 252.23
  backward-send-forward-recv:
     rank  4: 78.11
     rank  5: 77.06
     rank  6: 108.50
     rank  7: 103.71
     rank  8: 71.24
     rank  9: 73.32
     rank 10: 91.98
     rank 11: 90.72
     rank 12: 135.17
     rank 13: 132.98
     rank 14: 181.45
     rank 15: 184.24
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.12
     rank  3: 0.03
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.04
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.04
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.06
     rank  2: 0.10
     rank  3: 0.06
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.06
     rank 13: 0.06
     rank 14: 0.06
     rank 15: 0.08
  all-grads-sync:
     rank  0: 381.31
     rank  1: 381.64
     rank  2: 381.31
     rank  3: 381.70
     rank  4: 895.46
     rank  5: 898.01
     rank  6: 895.47
     rank  7: 898.06
     rank  8: 271.22
     rank  9: 268.23
     rank 10: 271.22
     rank 11: 268.22
     rank 12: 455.89
     rank 13: 435.18
     rank 14: 455.88
     rank 15: 435.29
  optimizer-copy-to-main-grad:
     rank  0: 0.38
     rank  1: 0.33
     rank  2: 0.28
     rank  3: 0.33
     rank  4: 0.07
     rank  5: 0.14
     rank  6: 0.07
     rank  7: 0.12
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 47.68
     rank  1: 47.79
     rank  2: 47.72
     rank  3: 48.21
     rank  4: 54.28
     rank  5: 54.51
     rank  6: 54.26
     rank  7: 54.31
     rank  8: 52.21
     rank  9: 52.18
     rank 10: 52.41
     rank 11: 52.29
     rank 12: 54.57
     rank 13: 54.62
     rank 14: 54.62
     rank 15: 54.69
  optimizer:
     rank  0: 48.85
     rank  1: 48.96
     rank  2: 48.98
     rank  3: 49.38
     rank  4: 55.43
     rank  5: 55.66
     rank  6: 55.41
     rank  7: 55.45
     rank  8: 53.37
     rank  9: 53.34
     rank 10: 53.58
     rank 11: 53.46
     rank 12: 55.74
     rank 13: 55.79
     rank 14: 55.79
     rank 15: 55.86
 [2024-12-30 23:28:30] iteration        5/      10 | consumed samples:          160 | elapsed time per iteration (ms): 4987.6 | learning rate: 3.750000E-06 | global batch size:    32 | lm loss: 1.715505E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4899.83
     rank  1: 4899.53
     rank  2: 4899.92
     rank  3: 4899.48
     rank  4: 4900.62
     rank  5: 4900.50
     rank  6: 4900.73
     rank  7: 4900.57
     rank  8: 4900.32
     rank  9: 4900.23
     rank 10: 4900.56
     rank 11: 4900.22
     rank 12: 4900.35
     rank 13: 4900.35
     rank 14: 4900.35
     rank 15: 4900.36
  forward-compute:
     rank  0: 1520.78
     rank  1: 1523.85
     rank  2: 1473.09
     rank  3: 1471.02
     rank  4: 1338.24
     rank  5: 1337.55
     rank  6: 1331.03
     rank  7: 1333.66
     rank  8: 1237.07
     rank  9: 1233.36
     rank 10: 1249.30
     rank 11: 1252.76
     rank 12: 1325.69
     rank 13: 1324.80
     rank 14: 1283.80
     rank 15: 1285.19
  backward-compute:
     rank  0: 1504.63
     rank  1: 1499.79
     rank  2: 1561.52
     rank  3: 1563.87
     rank  4: 1810.47
     rank  5: 1806.00
     rank  6: 1799.98
     rank  7: 1802.78
     rank  8: 1913.50
     rank  9: 1910.79
     rank 10: 1927.75
     rank 11: 1930.82
     rank 12: 1923.48
     rank 13: 1920.93
     rank 14: 1918.09
     rank 15: 1914.76
  pure-backward-compute:
     rank  0: 1503.51
     rank  1: 1498.94
     rank  2: 1560.45
     rank  3: 1563.04
     rank  4: 1808.62
     rank  5: 1803.80
     rank  6: 1798.10
     rank  7: 1801.51
     rank  8: 1911.67
     rank  9: 1908.31
     rank 10: 1925.79
     rank 11: 1929.12
     rank 12: 1920.99
     rank 13: 1918.42
     rank 14: 1915.29
     rank 15: 1912.46
  batch-generator:
     rank  0: 75.90
     rank  1: 76.18
     rank  2: 68.69
     rank  3: 70.35
     rank  4: 61.72
     rank  5: 61.29
     rank  6: 59.97
     rank  7: 61.73
     rank  8: 60.87
     rank  9: 62.02
     rank 10: 59.98
     rank 11: 63.67
     rank 12: 69.74
     rank 13: 71.48
     rank 14: 53.84
     rank 15: 56.75
  forward-recv:
     rank  4: 96.96
     rank  5: 95.78
     rank  6: 149.16
     rank  7: 148.27
     rank  8: 188.04
     rank  9: 187.79
     rank 10: 223.08
     rank 11: 222.81
     rank 12: 254.49
     rank 13: 254.55
     rank 14: 268.40
     rank 15: 268.45
  forward-send:
     rank  0: 7.83
     rank  1: 6.72
     rank  2: 7.71
     rank  3: 6.88
     rank  4: 6.27
     rank  5: 6.04
     rank  6: 5.80
     rank  7: 5.61
     rank  8: 4.73
     rank  9: 4.79
     rank 10: 2.89
     rank 11: 2.92
  backward-recv:
     rank  0: 352.26
     rank  1: 352.41
     rank  2: 329.20
     rank  3: 331.15
     rank  4: 184.32
     rank  5: 184.74
     rank  6: 185.19
     rank  7: 185.32
     rank  8: 81.82
     rank  9: 82.49
     rank 10: 80.50
     rank 11: 79.59
  backward-send:
     rank  4: 10.28
     rank  5: 11.15
     rank  6: 11.55
     rank  7: 11.38
     rank  8: 6.47
     rank  9: 6.54
     rank 10: 7.32
     rank 11: 7.32
     rank 12: 5.11
     rank 13: 5.05
     rank 14: 5.09
     rank 15: 4.28
  forward-send-backward-recv:
     rank  0: 586.83
     rank  1: 591.07
     rank  2: 604.68
     rank  3: 610.60
     rank  4: 362.04
     rank  5: 366.22
     rank  6: 340.44
     rank  7: 337.88
     rank  8: 271.01
     rank  9: 270.14
     rank 10: 213.82
     rank 11: 213.68
  backward-send-forward-recv:
     rank  4: 77.49
     rank  5: 78.40
     rank  6: 66.74
     rank  7: 65.63
     rank  8: 68.55
     rank  9: 72.35
     rank 10: 69.90
     rank 11: 66.33
     rank 12: 143.61
     rank 13: 147.07
     rank 14: 176.82
     rank 15: 178.71
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.08
     rank  2: 0.14
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.05
     rank  7: 0.07
     rank  8: 0.03
     rank  9: 0.06
     rank 10: 0.14
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.07
     rank  1: 0.10
     rank  2: 0.18
     rank  3: 0.06
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.05
     rank  7: 0.06
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.05
     rank 11: 0.02
     rank 12: 0.06
     rank 13: 0.06
     rank 14: 0.06
     rank 15: 0.06
  all-grads-sync:
     rank  0: 382.08
     rank  1: 382.36
     rank  2: 382.07
     rank  3: 382.37
     rank  4: 892.99
     rank  5: 894.67
     rank  6: 893.06
     rank  7: 894.57
     rank  8: 267.87
     rank  9: 268.91
     rank 10: 267.58
     rank 11: 268.90
     rank 12: 448.34
     rank 13: 426.67
     rank 14: 448.33
     rank 15: 426.68
  optimizer-copy-to-main-grad:
     rank  0: 0.23
     rank  1: 0.22
     rank  2: 0.38
     rank  3: 0.22
     rank  4: 0.06
     rank  5: 0.14
     rank  6: 0.15
     rank  7: 0.12
     rank  8: 0.04
     rank  9: 0.07
     rank 10: 0.18
     rank 11: 0.04
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 47.22
     rank  1: 47.64
     rank  2: 48.82
     rank  3: 47.78
     rank  4: 54.33
     rank  5: 54.53
     rank  6: 54.46
     rank  7: 54.49
     rank  8: 52.13
     rank  9: 52.64
     rank 10: 52.84
     rank 11: 52.26
     rank 12: 54.56
     rank 13: 54.63
     rank 14: 54.54
     rank 15: 54.58
  optimizer:
     rank  0: 48.44
     rank  1: 48.87
     rank  2: 50.11
     rank  3: 49.00
     rank  4: 55.55
     rank  5: 55.74
     rank  6: 55.69
     rank  7: 55.71
     rank  8: 53.35
     rank  9: 53.86
     rank 10: 54.06
     rank 11: 53.48
     rank 12: 55.79
     rank 13: 55.86
     rank 14: 55.77
     rank 15: 55.80
 [2024-12-30 23:28:35] iteration        6/      10 | consumed samples:          192 | elapsed time per iteration (ms): 4690.7 | learning rate: 4.500000E-06 | global batch size:    32 | lm loss: 3.705137E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4604.45
     rank  1: 4604.36
     rank  2: 4604.50
     rank  3: 4604.34
     rank  4: 4605.18
     rank  5: 4605.14
     rank  6: 4605.14
     rank  7: 4605.07
     rank  8: 4605.18
     rank  9: 4604.99
     rank 10: 4605.06
     rank 11: 4604.90
     rank 12: 4605.27
     rank 13: 4605.30
     rank 14: 4605.30
     rank 15: 4605.27
  forward-compute:
     rank  0: 1588.99
     rank  1: 1594.44
     rank  2: 1484.75
     rank  3: 1492.52
     rank  4: 1339.59
     rank  5: 1336.09
     rank  6: 1338.86
     rank  7: 1337.37
     rank  8: 1238.38
     rank  9: 1237.19
     rank 10: 1252.29
     rank 11: 1252.99
     rank 12: 1335.92
     rank 13: 1342.63
     rank 14: 1295.61
     rank 15: 1298.09
  backward-compute:
     rank  0: 1573.07
     rank  1: 1561.88
     rank  2: 1631.70
     rank  3: 1620.99
     rank  4: 1808.68
     rank  5: 1804.47
     rank  6: 1804.17
     rank  7: 1804.56
     rank  8: 1905.19
     rank  9: 1915.63
     rank 10: 1938.36
     rank 11: 1942.03
     rank 12: 1925.40
     rank 13: 1922.75
     rank 14: 1923.49
     rank 15: 1918.97
  pure-backward-compute:
     rank  0: 1571.68
     rank  1: 1561.11
     rank  2: 1630.18
     rank  3: 1620.22
     rank  4: 1806.60
     rank  5: 1802.53
     rank  6: 1802.29
     rank  7: 1803.02
     rank  8: 1902.78
     rank  9: 1913.63
     rank 10: 1936.22
     rank 11: 1940.29
     rank 12: 1923.00
     rank 13: 1920.26
     rank 14: 1920.74
     rank 15: 1916.64
  batch-generator:
     rank  0: 87.26
     rank  1: 84.42
     rank  2: 105.34
     rank  3: 107.44
     rank  4: 65.39
     rank  5: 60.85
     rank  6: 62.10
     rank  7: 60.83
     rank  8: 65.61
     rank  9: 63.52
     rank 10: 60.33
     rank 11: 60.42
     rank 12: 70.47
     rank 13: 79.32
     rank 14: 58.53
     rank 15: 63.49
  forward-recv:
     rank  4: 99.41
     rank  5: 99.39
     rank  6: 152.80
     rank  7: 150.50
     rank  8: 190.56
     rank  9: 189.99
     rank 10: 226.36
     rank 11: 226.27
     rank 12: 255.89
     rank 13: 256.17
     rank 14: 273.35
     rank 15: 273.49
  forward-send:
     rank  0: 8.08
     rank  1: 8.10
     rank  2: 6.87
     rank  3: 5.87
     rank  4: 6.13
     rank  5: 6.12
     rank  6: 5.72
     rank  7: 5.85
     rank  8: 4.53
     rank  9: 4.97
     rank 10: 2.76
     rank 11: 2.84
  backward-recv:
     rank  0: 326.98
     rank  1: 330.96
     rank  2: 334.03
     rank  3: 336.72
     rank  4: 185.65
     rank  5: 185.83
     rank  6: 196.41
     rank  7: 196.68
     rank  8: 83.41
     rank  9: 83.53
     rank 10: 92.48
     rank 11: 91.61
  backward-send:
     rank  4: 9.53
     rank  5: 10.01
     rank  6: 10.28
     rank  7: 10.10
     rank  8: 7.59
     rank  9: 7.85
     rank 10: 7.68
     rank 11: 7.87
     rank 12: 5.26
     rank 13: 5.18
     rank 14: 5.25
     rank 15: 4.73
  forward-send-backward-recv:
     rank  0: 498.75
     rank  1: 504.78
     rank  2: 541.43
     rank  3: 551.59
     rank  4: 366.93
     rank  5: 371.72
     rank  6: 345.92
     rank  7: 346.23
     rank  8: 277.31
     rank  9: 269.37
     rank 10: 213.36
     rank 11: 210.49
  backward-send-forward-recv:
     rank  4: 92.36
     rank  5: 95.26
     rank  6: 56.73
     rank  7: 60.67
     rank  8: 87.36
     rank  9: 87.60
     rank 10: 61.68
     rank 11: 61.99
     rank 12: 149.45
     rank 13: 145.12
     rank 14: 174.19
     rank 15: 176.09
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.03
     rank  6: 0.04
     rank  7: 0.03
     rank  8: 0.08
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.05
     rank  2: 0.08
     rank  3: 0.05
     rank  4: 0.04
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.04
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.06
     rank 13: 0.06
     rank 14: 0.07
     rank 15: 0.06
  all-grads-sync:
     rank  0: 384.02
     rank  1: 384.36
     rank  2: 384.03
     rank  3: 384.36
     rank  4: 577.55
     rank  5: 576.74
     rank  6: 577.54
     rank  7: 576.74
     rank  8: 266.63
     rank  9: 263.91
     rank 10: 266.86
     rank 11: 263.90
     rank 12: 460.30
     rank 13: 440.10
     rank 14: 460.21
     rank 15: 440.11
  optimizer-copy-to-main-grad:
     rank  0: 0.26
     rank  1: 0.23
     rank  2: 0.28
     rank  3: 0.33
     rank  4: 0.06
     rank  5: 0.05
     rank  6: 0.06
     rank  7: 0.05
     rank  8: 0.08
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.03
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 47.45
     rank  1: 47.64
     rank  2: 48.17
     rank  3: 47.37
     rank  4: 54.25
     rank  5: 54.18
     rank  6: 54.13
     rank  7: 54.10
     rank  8: 52.43
     rank  9: 52.49
     rank 10: 52.45
     rank 11: 52.25
     rank 12: 54.51
     rank 13: 54.59
     rank 14: 54.58
     rank 15: 54.65
  optimizer:
     rank  0: 48.51
     rank  1: 48.70
     rank  2: 49.22
     rank  3: 48.40
     rank  4: 55.33
     rank  5: 55.26
     rank  6: 55.21
     rank  7: 55.18
     rank  8: 53.49
     rank  9: 53.56
     rank 10: 53.51
     rank 11: 53.32
     rank 12: 55.58
     rank 13: 55.65
     rank 14: 55.64
     rank 15: 55.72
 [2024-12-30 23:28:40] iteration        7/      10 | consumed samples:          224 | elapsed time per iteration (ms): 5041.5 | learning rate: 5.250000E-06 | global batch size:    32 | lm loss: 3.372250E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4957.50
     rank  1: 4957.24
     rank  2: 4957.61
     rank  3: 4957.25
     rank  4: 4958.14
     rank  5: 4958.16
     rank  6: 4958.21
     rank  7: 4958.08
     rank  8: 4957.86
     rank  9: 4957.81
     rank 10: 4957.88
     rank 11: 4957.76
     rank 12: 4958.12
     rank 13: 4958.10
     rank 14: 4958.10
     rank 15: 4958.12
  forward-compute:
     rank  0: 1677.82
     rank  1: 1682.06
     rank  2: 1480.51
     rank  3: 1482.94
     rank  4: 1333.31
     rank  5: 1336.84
     rank  6: 1340.43
     rank  7: 1342.53
     rank  8: 1235.84
     rank  9: 1231.96
     rank 10: 1257.19
     rank 11: 1257.55
     rank 12: 1320.34
     rank 13: 1330.71
     rank 14: 1315.88
     rank 15: 1318.71
  backward-compute:
     rank  0: 1590.19
     rank  1: 1586.31
     rank  2: 1634.66
     rank  3: 1632.09
     rank  4: 1815.47
     rank  5: 1810.95
     rank  6: 1811.50
     rank  7: 1811.99
     rank  8: 1905.80
     rank  9: 1921.58
     rank 10: 1940.57
     rank 11: 1945.11
     rank 12: 1931.46
     rank 13: 1928.95
     rank 14: 1924.96
     rank 15: 1921.90
  pure-backward-compute:
     rank  0: 1588.71
     rank  1: 1585.45
     rank  2: 1633.23
     rank  3: 1631.23
     rank  4: 1813.86
     rank  5: 1808.82
     rank  6: 1809.66
     rank  7: 1810.60
     rank  8: 1904.09
     rank  9: 1919.57
     rank 10: 1938.64
     rank 11: 1943.52
     rank 12: 1928.98
     rank 13: 1926.57
     rank 14: 1921.91
     rank 15: 1919.42
  batch-generator:
     rank  0: 92.94
     rank  1: 91.20
     rank  2: 94.23
     rank  3: 90.03
     rank  4: 60.67
     rank  5: 64.37
     rank  6: 62.04
     rank  7: 63.46
     rank  8: 63.43
     rank  9: 58.32
     rank 10: 57.14
     rank 11: 58.00
     rank 12: 72.56
     rank 13: 85.12
     rank 14: 56.37
     rank 15: 60.63
  forward-recv:
     rank  4: 141.61
     rank  5: 140.86
     rank  6: 127.93
     rank  7: 126.32
     rank  8: 214.95
     rank  9: 214.44
     rank 10: 218.83
     rank 11: 218.89
     rank 12: 271.14
     rank 13: 271.49
     rank 14: 272.25
     rank 15: 272.28
  forward-send:
     rank  0: 8.26
     rank  1: 7.46
     rank  2: 7.39
     rank  3: 6.64
     rank  4: 5.98
     rank  5: 5.95
     rank  6: 6.10
     rank  7: 6.14
     rank  8: 4.74
     rank  9: 5.11
     rank 10: 4.80
     rank 11: 4.71
  backward-recv:
     rank  0: 343.11
     rank  1: 347.05
     rank  2: 330.93
     rank  3: 336.14
     rank  4: 192.83
     rank  5: 192.21
     rank  6: 190.44
     rank  7: 190.43
     rank  8: 91.64
     rank  9: 91.13
     rank 10: 81.03
     rank 11: 79.64
  backward-send:
     rank  4: 9.72
     rank  5: 10.51
     rank  6: 10.12
     rank  7: 10.35
     rank  8: 7.52
     rank  9: 8.01
     rank 10: 7.79
     rank 11: 7.93
     rank 12: 4.64
     rank 13: 4.68
     rank 14: 4.48
     rank 15: 3.62
  forward-send-backward-recv:
     rank  0: 392.14
     rank  1: 394.12
     rank  2: 556.93
     rank  3: 563.18
     rank  4: 306.94
     rank  5: 312.37
     rank  6: 380.31
     rank  7: 380.75
     rank  8: 251.60
     rank  9: 239.61
     rank 10: 238.53
     rank 11: 236.07
  backward-send-forward-recv:
     rank  4: 119.63
     rank  5: 116.16
     rank  6: 59.19
     rank  7: 58.81
     rank  8: 98.22
     rank  9: 100.13
     rank 10: 62.04
     rank 11: 60.95
     rank 12: 158.90
     rank 13: 151.01
     rank 14: 168.26
     rank 15: 168.45
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.07
     rank  3: 0.03
     rank  4: 0.03
     rank  5: 0.04
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.04
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.07
     rank  1: 0.05
     rank  2: 0.10
     rank  3: 0.06
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.06
     rank 13: 0.06
     rank 14: 0.06
     rank 15: 0.06
  all-grads-sync:
     rank  0: 379.80
     rank  1: 380.02
     rank  2: 379.88
     rank  3: 380.03
     rank  4: 916.19
     rank  5: 916.20
     rank  6: 916.18
     rank  7: 916.21
     rank  8: 266.16
     rank  9: 265.84
     rank 10: 266.23
     rank 11: 265.84
     rank 12: 466.94
     rank 13: 445.78
     rank 14: 466.94
     rank 15: 445.77
  optimizer-copy-to-main-grad:
     rank  0: 0.26
     rank  1: 0.22
     rank  2: 0.29
     rank  3: 0.24
     rank  4: 0.06
     rank  5: 0.08
     rank  6: 0.07
     rank  7: 0.06
     rank  8: 0.05
     rank  9: 0.05
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.05
     rank 13: 0.03
     rank 14: 0.04
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 47.50
     rank  1: 47.34
     rank  2: 48.50
     rank  3: 47.89
     rank  4: 54.26
     rank  5: 54.55
     rank  6: 54.33
     rank  7: 54.26
     rank  8: 52.20
     rank  9: 52.32
     rank 10: 52.34
     rank 11: 52.28
     rank 12: 54.54
     rank 13: 54.51
     rank 14: 54.51
     rank 15: 54.58
  optimizer:
     rank  0: 48.61
     rank  1: 48.43
     rank  2: 49.57
     rank  3: 49.09
     rank  4: 55.35
     rank  5: 55.64
     rank  6: 55.42
     rank  7: 55.35
     rank  8: 53.30
     rank  9: 53.42
     rank 10: 53.43
     rank 11: 53.37
     rank 12: 55.64
     rank 13: 55.60
     rank 14: 55.60
     rank 15: 55.67
 [2024-12-30 23:28:45] iteration        8/      10 | consumed samples:          256 | elapsed time per iteration (ms): 4988.2 | learning rate: 6.000000E-06 | global batch size:    32 | lm loss: 1.951243E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4901.40
     rank  1: 4900.90
     rank  2: 4901.26
     rank  3: 4900.92
     rank  4: 4901.97
     rank  5: 4901.62
     rank  6: 4901.91
     rank  7: 4901.67
     rank  8: 4901.94
     rank  9: 4901.45
     rank 10: 4901.88
     rank 11: 4901.55
     rank 12: 4901.89
     rank 13: 4901.84
     rank 14: 4901.85
     rank 15: 4901.87
  forward-compute:
     rank  0: 1470.23
     rank  1: 1481.96
     rank  2: 1564.90
     rank  3: 1570.48
     rank  4: 1337.30
     rank  5: 1337.12
     rank  6: 1337.13
     rank  7: 1337.93
     rank  8: 1244.55
     rank  9: 1242.21
     rank 10: 1264.18
     rank 11: 1263.54
     rank 12: 1346.83
     rank 13: 1361.39
     rank 14: 1290.58
     rank 15: 1292.79
  backward-compute:
     rank  0: 1565.01
     rank  1: 1552.13
     rank  2: 1616.08
     rank  3: 1609.39
     rank  4: 1803.15
     rank  5: 1798.28
     rank  6: 1811.32
     rank  7: 1810.31
     rank  8: 1909.35
     rank  9: 1930.11
     rank 10: 1956.10
     rank 11: 1961.18
     rank 12: 1934.25
     rank 13: 1931.38
     rank 14: 1927.33
     rank 15: 1923.99
  pure-backward-compute:
     rank  0: 1563.99
     rank  1: 1551.19
     rank  2: 1614.46
     rank  3: 1608.59
     rank  4: 1801.66
     rank  5: 1796.69
     rank  6: 1809.39
     rank  7: 1808.97
     rank  8: 1907.37
     rank  9: 1928.39
     rank 10: 1954.05
     rank 11: 1959.61
     rank 12: 1931.75
     rank 13: 1928.96
     rank 14: 1924.53
     rank 15: 1921.69
  batch-generator:
     rank  0: 66.88
     rank  1: 81.87
     rank  2: 103.51
     rank  3: 100.94
     rank  4: 62.39
     rank  5: 62.29
     rank  6: 57.52
     rank  7: 59.20
     rank  8: 62.26
     rank  9: 58.46
     rank 10: 57.98
     rank 11: 57.01
     rank 12: 83.03
     rank 13: 99.29
     rank 14: 54.14
     rank 15: 57.55
  forward-recv:
     rank  4: 138.94
     rank  5: 138.40
     rank  6: 148.34
     rank  7: 147.03
     rank  8: 212.82
     rank  9: 212.71
     rank 10: 221.80
     rank 11: 221.73
     rank 12: 269.12
     rank 13: 269.32
     rank 14: 272.37
     rank 15: 272.49
  forward-send:
     rank  0: 8.13
     rank  1: 7.57
     rank  2: 7.70
     rank  3: 6.83
     rank  4: 6.04
     rank  5: 6.10
     rank  6: 6.02
     rank  7: 6.12
     rank  8: 4.77
     rank  9: 5.02
     rank 10: 2.92
     rank 11: 3.04
  backward-recv:
     rank  0: 344.83
     rank  1: 348.15
     rank  2: 336.64
     rank  3: 338.94
     rank  4: 195.30
     rank  5: 195.49
     rank  6: 188.56
     rank  7: 188.88
     rank  8: 89.21
     rank  9: 88.67
     rank 10: 81.46
     rank 11: 79.91
  backward-send:
     rank  4: 8.17
     rank  5: 7.94
     rank  6: 8.24
     rank  7: 8.41
     rank  8: 7.16
     rank  9: 6.92
     rank 10: 7.32
     rank 11: 7.40
     rank 12: 5.05
     rank 13: 4.97
     rank 14: 4.95
     rank 15: 4.11
  forward-send-backward-recv:
     rank  0: 615.19
     rank  1: 621.19
     rank  2: 484.19
     rank  3: 491.18
     rank  4: 362.72
     rank  5: 367.73
     rank  6: 369.98
     rank  7: 373.75
     rank  8: 273.34
     rank  9: 255.56
     rank 10: 217.29
     rank 11: 215.48
  backward-send-forward-recv:
     rank  4: 68.07
     rank  5: 68.42
     rank  6: 51.83
     rank  7: 51.11
     rank  8: 65.68
     rank  9: 66.40
     rank 10: 56.50
     rank 11: 56.48
     rank 12: 127.91
     rank 13: 116.10
     rank 14: 187.49
     rank 15: 188.39
  layernorm-grads-all-reduce:
     rank  0: 0.16
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.12
     rank  9: 0.03
     rank 10: 0.14
     rank 11: 0.03
     rank 12: 0.05
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.05
  embedding-grads-all-reduce:
     rank  0: 0.19
     rank  1: 0.06
     rank  2: 0.06
     rank  3: 0.06
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.05
     rank  9: 0.02
     rank 10: 0.05
     rank 11: 0.02
     rank 12: 0.13
     rank 13: 0.06
     rank 14: 0.07
     rank 15: 0.08
  all-grads-sync:
     rank  0: 381.45
     rank  1: 381.54
     rank  2: 381.41
     rank  3: 381.52
     rank  4: 861.73
     rank  5: 862.62
     rank  6: 861.72
     rank  7: 862.62
     rank  8: 268.06
     rank  9: 265.17
     rank 10: 268.06
     rank 11: 265.24
     rank 12: 461.10
     rank 13: 439.74
     rank 14: 461.01
     rank 15: 439.73
  optimizer-copy-to-main-grad:
     rank  0: 0.36
     rank  1: 0.22
     rank  2: 0.25
     rank  3: 0.23
     rank  4: 0.05
     rank  5: 0.04
     rank  6: 0.06
     rank  7: 0.05
     rank  8: 0.16
     rank  9: 0.07
     rank 10: 0.09
     rank 11: 0.07
     rank 12: 0.08
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.06
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 47.96
     rank  1: 48.87
     rank  2: 49.07
     rank  3: 47.40
     rank  4: 54.05
     rank  5: 54.10
     rank  6: 54.10
     rank  7: 54.10
     rank  8: 52.65
     rank  9: 52.37
     rank 10: 52.85
     rank 11: 52.28
     rank 12: 54.62
     rank 13: 54.54
     rank 14: 54.54
     rank 15: 54.61
  optimizer:
     rank  0: 49.04
     rank  1: 49.97
     rank  2: 50.19
     rank  3: 48.50
     rank  4: 55.16
     rank  5: 55.20
     rank  6: 55.21
     rank  7: 55.20
     rank  8: 53.75
     rank  9: 53.47
     rank 10: 53.96
     rank 11: 53.38
     rank 12: 55.73
     rank 13: 55.64
     rank 14: 55.64
     rank 15: 55.71
 [2024-12-30 23:28:50] iteration        9/      10 | consumed samples:          288 | elapsed time per iteration (ms): 5022.1 | learning rate: 6.750000E-06 | global batch size:    32 | lm loss: 2.026612E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4938.09
     rank  1: 4938.05
     rank  2: 4938.16
     rank  3: 4938.02
     rank  4: 4938.91
     rank  5: 4938.94
     rank  6: 4938.93
     rank  7: 4938.91
     rank  8: 4938.82
     rank  9: 4938.65
     rank 10: 4938.89
     rank 11: 4938.60
     rank 12: 4938.96
     rank 13: 4938.96
     rank 14: 4938.98
     rank 15: 4938.96
  forward-compute:
     rank  0: 1696.75
     rank  1: 1705.48
     rank  2: 1435.67
     rank  3: 1434.28
     rank  4: 1333.34
     rank  5: 1336.47
     rank  6: 1338.30
     rank  7: 1342.00
     rank  8: 1252.55
     rank  9: 1253.47
     rank 10: 1266.21
     rank 11: 1265.21
     rank 12: 1338.81
     rank 13: 1355.33
     rank 14: 1313.07
     rank 15: 1314.56
  backward-compute:
     rank  0: 1575.96
     rank  1: 1568.24
     rank  2: 1552.44
     rank  3: 1550.84
     rank  4: 1807.55
     rank  5: 1803.34
     rank  6: 1799.89
     rank  7: 1799.36
     rank  8: 1913.48
     rank  9: 1937.73
     rank 10: 1965.76
     rank 11: 1969.69
     rank 12: 1936.37
     rank 13: 1933.33
     rank 14: 1931.83
     rank 15: 1929.27
  pure-backward-compute:
     rank  0: 1574.70
     rank  1: 1567.42
     rank  2: 1551.33
     rank  3: 1550.04
     rank  4: 1806.03
     rank  5: 1801.79
     rank  6: 1798.40
     rank  7: 1798.13
     rank  8: 1911.74
     rank  9: 1935.69
     rank 10: 1963.96
     rank 11: 1968.10
     rank 12: 1933.86
     rank 13: 1931.05
     rank 14: 1929.42
     rank 15: 1926.84
  batch-generator:
     rank  0: 96.03
     rank  1: 96.34
     rank  2: 59.76
     rank  3: 60.95
     rank  4: 59.84
     rank  5: 63.25
     rank  6: 58.48
     rank  7: 61.48
     rank  8: 66.80
     rank  9: 65.11
     rank 10: 59.04
     rank 11: 58.21
     rank 12: 79.04
     rank 13: 97.66
     rank 14: 54.65
     rank 15: 57.41
  forward-recv:
     rank  4: 149.04
     rank  5: 148.57
     rank  6: 104.64
     rank  7: 101.96
     rank  8: 218.00
     rank  9: 217.56
     rank 10: 193.82
     rank 11: 194.05
     rank 12: 278.18
     rank 13: 278.51
     rank 14: 259.11
     rank 15: 258.98
  forward-send:
     rank  0: 7.85
     rank  1: 7.05
     rank  2: 6.66
     rank  3: 5.66
     rank  4: 5.75
     rank  5: 5.53
     rank  6: 5.93
     rank  7: 5.78
     rank  8: 5.43
     rank  9: 5.48
     rank 10: 2.86
     rank 11: 2.73
  backward-recv:
     rank  0: 331.28
     rank  1: 332.60
     rank  2: 355.71
     rank  3: 357.66
     rank  4: 192.66
     rank  5: 194.41
     rank  6: 189.79
     rank  7: 189.91
     rank  8: 87.09
     rank  9: 86.48
     rank 10: 80.55
     rank 11: 79.26
  backward-send:
     rank  4: 8.60
     rank  5: 8.69
     rank  6: 8.93
     rank  7: 9.05
     rank  8: 5.45
     rank  9: 6.39
     rank 10: 6.35
     rank 11: 6.43
     rank 12: 4.98
     rank 13: 4.95
     rank 14: 4.86
     rank 15: 4.02
  forward-send-backward-recv:
     rank  0: 409.84
     rank  1: 412.41
     rank  2: 668.10
     rank  3: 677.25
     rank  4: 337.40
     rank  5: 339.79
     rank  6: 433.06
     rank  7: 433.98
     rank  8: 261.76
     rank  9: 244.42
     rank 10: 248.55
     rank 11: 247.77
  backward-send-forward-recv:
     rank  4: 98.71
     rank  5: 96.57
     rank  6: 56.12
     rank  7: 55.22
     rank  8: 73.02
     rank  9: 69.80
     rank 10: 58.06
     rank 11: 58.15
     rank 12: 139.90
     rank 13: 126.16
     rank 14: 189.08
     rank 15: 190.04
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.04
     rank  9: 0.03
     rank 10: 0.06
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.05
     rank  2: 0.05
     rank  3: 0.05
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.06
     rank 13: 0.06
     rank 14: 0.06
     rank 15: 0.06
  all-grads-sync:
     rank  0: 388.21
     rank  1: 388.12
     rank  2: 388.16
     rank  3: 388.12
     rank  4: 890.71
     rank  5: 892.45
     rank  6: 890.71
     rank  7: 892.45
     rank  8: 267.00
     rank  9: 266.63
     rank 10: 267.06
     rank 11: 266.64
     rank 12: 453.50
     rank 13: 432.14
     rank 14: 453.50
     rank 15: 432.12
  optimizer-copy-to-main-grad:
     rank  0: 0.21
     rank  1: 0.21
     rank  2: 0.25
     rank  3: 0.23
     rank  4: 0.06
     rank  5: 0.07
     rank  6: 0.06
     rank  7: 0.06
     rank  8: 0.09
     rank  9: 0.04
     rank 10: 0.07
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 47.14
     rank  1: 47.67
     rank  2: 47.69
     rank  3: 47.73
     rank  4: 54.27
     rank  5: 54.35
     rank  6: 54.26
     rank  7: 54.26
     rank  8: 52.24
     rank  9: 52.19
     rank 10: 52.45
     rank 11: 52.19
     rank 12: 54.49
     rank 13: 54.56
     rank 14: 54.58
     rank 15: 54.59
  optimizer:
     rank  0: 48.13
     rank  1: 48.67
     rank  2: 48.68
     rank  3: 48.72
     rank  4: 55.26
     rank  5: 55.35
     rank  6: 55.25
     rank  7: 55.25
     rank  8: 53.24
     rank  9: 53.19
     rank 10: 53.45
     rank 11: 53.19
     rank 12: 55.50
     rank 13: 55.56
     rank 14: 55.57
     rank 15: 55.59
 [2024-12-30 23:28:55] iteration       10/      10 | consumed samples:          320 | elapsed time per iteration (ms): 5194.8 | learning rate: 7.500000E-06 | global batch size:    32 | lm loss: 1.145923E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 5109.19
     rank  1: 5109.22
     rank  2: 5109.22
     rank  3: 5109.18
     rank  4: 5110.03
     rank  5: 5110.15
     rank  6: 5110.11
     rank  7: 5110.06
     rank  8: 5109.79
     rank  9: 5109.85
     rank 10: 5109.89
     rank 11: 5109.79
     rank 12: 5110.06
     rank 13: 5110.17
     rank 14: 5110.05
     rank 15: 5110.10
  forward-compute:
     rank  0: 1588.47
     rank  1: 1596.84
     rank  2: 1794.08
     rank  3: 1800.09
     rank  4: 1335.31
     rank  5: 1334.69
     rank  6: 1332.24
     rank  7: 1335.58
     rank  8: 1245.45
     rank  9: 1244.58
     rank 10: 1275.32
     rank 11: 1268.51
     rank 12: 1360.50
     rank 13: 1374.98
     rank 14: 1293.70
     rank 15: 1294.68
  backward-compute:
     rank  0: 1584.47
     rank  1: 1574.27
     rank  2: 1625.71
     rank  3: 1617.94
     rank  4: 1806.04
     rank  5: 1800.45
     rank  6: 1802.98
     rank  7: 1798.26
     rank  8: 1919.65
     rank  9: 1941.32
     rank 10: 1970.89
     rank 11: 1975.83
     rank 12: 1939.64
     rank 13: 1936.86
     rank 14: 1933.29
     rank 15: 1930.07
  pure-backward-compute:
     rank  0: 1583.61
     rank  1: 1573.58
     rank  2: 1624.26
     rank  3: 1617.15
     rank  4: 1804.55
     rank  5: 1798.69
     rank  6: 1801.38
     rank  7: 1796.82
     rank  8: 1917.28
     rank  9: 1939.36
     rank 10: 1969.11
     rank 11: 1974.12
     rank 12: 1937.19
     rank 13: 1934.57
     rank 14: 1930.39
     rank 15: 1927.79
  batch-generator:
     rank  0: 54.95
     rank  1: 61.26
     rank  2: 78.16
     rank  3: 83.48
     rank  4: 58.62
     rank  5: 58.39
     rank  6: 57.08
     rank  7: 60.09
     rank  8: 59.38
     rank  9: 57.82
     rank 10: 59.88
     rank 11: 54.63
     rank 12: 87.16
     rank 13: 101.70
     rank 14: 53.91
     rank 15: 56.46
  forward-recv:
     rank  4: 279.85
     rank  5: 279.70
     rank  6: 284.92
     rank  7: 284.25
     rank  8: 366.80
     rank  9: 366.87
     rank 10: 371.94
     rank 11: 372.06
     rank 12: 437.15
     rank 13: 437.13
     rank 14: 442.08
     rank 15: 442.10
  forward-send:
     rank  0: 10.17
     rank  1: 10.31
     rank  2: 8.23
     rank  3: 8.04
     rank  4: 5.81
     rank  5: 5.90
     rank  6: 5.66
     rank  7: 5.75
     rank  8: 5.18
     rank  9: 5.00
     rank 10: 2.94
     rank 11: 2.93
  backward-recv:
     rank  0: 347.68
     rank  1: 349.39
     rank  2: 327.67
     rank  3: 330.74
     rank  4: 195.57
     rank  5: 197.73
     rank  6: 191.78
     rank  7: 191.96
     rank  8: 88.11
     rank  9: 87.58
     rank 10: 80.98
     rank 11: 80.09
  backward-send:
     rank  4: 8.19
     rank  5: 7.85
     rank  6: 7.90
     rank  7: 8.15
     rank  8: 4.63
     rank  9: 5.37
     rank 10: 5.61
     rank 11: 5.78
     rank 12: 5.27
     rank 13: 5.16
     rank 14: 5.18
     rank 15: 4.70
  forward-send-backward-recv:
     rank  0: 662.19
     rank  1: 661.12
     rank  2: 436.22
     rank  3: 444.86
     rank  4: 406.72
     rank  5: 410.59
     rank  6: 428.95
     rank  7: 434.44
     rank  8: 299.33
     rank  9: 280.93
     rank 10: 234.11
     rank 11: 233.71
  backward-send-forward-recv:
     rank  4: 68.08
     rank  5: 68.33
     rank  6: 53.89
     rank  7: 51.07
     rank  8: 61.61
     rank  9: 61.64
     rank 10: 52.87
     rank 11: 56.59
     rank 12: 127.41
     rank 13: 115.97
     rank 14: 195.75
     rank 15: 198.00
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.04
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.12
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.06
     rank  2: 0.14
     rank  3: 0.05
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.04
     rank 11: 0.02
     rank 12: 0.06
     rank 13: 0.08
     rank 14: 0.06
     rank 15: 0.06
  all-grads-sync:
     rank  0: 378.51
     rank  1: 378.48
     rank  2: 378.51
     rank  3: 378.49
     rank  4: 884.05
     rank  5: 887.60
     rank  6: 884.05
     rank  7: 887.59
     rank  8: 269.01
     rank  9: 264.78
     rank 10: 269.01
     rank 11: 264.78
     rank 12: 459.68
     rank 13: 442.27
     rank 14: 459.69
     rank 15: 438.68
  optimizer-copy-to-main-grad:
     rank  0: 0.24
     rank  1: 0.23
     rank  2: 0.24
     rank  3: 0.23
     rank  4: 0.06
     rank  5: 0.10
     rank  6: 0.07
     rank  7: 0.06
     rank  8: 0.05
     rank  9: 0.06
     rank 10: 0.06
     rank 11: 0.04
     rank 12: 0.04
     rank 13: 0.05
     rank 14: 0.03
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 47.69
     rank  1: 47.83
     rank  2: 48.00
     rank  3: 47.92
     rank  4: 54.37
     rank  5: 54.43
     rank  6: 54.36
     rank  7: 54.25
     rank  8: 52.08
     rank  9: 52.28
     rank 10: 52.54
     rank 11: 52.26
     rank 12: 54.58
     rank 13: 54.55
     rank 14: 54.51
     rank 15: 54.53
  optimizer:
     rank  0: 48.76
     rank  1: 48.90
     rank  2: 49.07
     rank  3: 48.98
     rank  4: 55.44
     rank  5: 55.50
     rank  6: 55.56
     rank  7: 55.32
     rank  8: 53.14
     rank  9: 53.34
     rank 10: 53.63
     rank 11: 53.33
     rank 12: 55.66
     rank 13: 55.62
     rank 14: 55.59
     rank 15: 55.60
