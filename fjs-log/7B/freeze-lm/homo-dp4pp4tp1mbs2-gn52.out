examples/multimodal/pretrain-freeze-llm-homo.sh: line 4: activate: No such file or directory
[2024-12-30 21:32:08,745] torch.distributed.run: [WARNING] 
[2024-12-30 21:32:08,745] torch.distributed.run: [WARNING] *****************************************
[2024-12-30 21:32:08,745] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-12-30 21:32:08,745] torch.distributed.run: [WARNING] *****************************************
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
> setting tensorboard ...
WARNING: one_logger package is required to enable e2e metrics tracking. please go to https://confluence.nvidia.com/display/MLWFO/Package+Repositories for details to install it
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
---Rank 15---Tensor Parallel Group GPUs: [0]
---Rank 14---Tensor Parallel Group GPUs: [0]---Rank 15---Pipeline Parallel Group GPUs: [3, 3, 3, 3]

---Rank 14---Pipeline Parallel Group GPUs: [3, 3, 3, 3]---Rank 12---Tensor Parallel Group GPUs: [0]

---Rank 12---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
[rank14]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank15]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
---Rank 13---Tensor Parallel Group GPUs: [0]
---Rank 13---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
[rank12]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank13]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
 > number of parameters on (tensor, pipeline) model parallel rank (0, 3): 1006669824
rank=2, worker=0: shard_range=[pretrain-31.tar[0, 100), pretrain-31.tar[100, 200), pretrain-31.tar[200, 300), ...<619>, pretrain-37.tar[2200, 2300), pretrain-37.tar[2300, 2400), pretrain-37.tar[2400, 2500)] sum(count)=62500
rank=2, worker=1: shard_range=[pretrain-37.tar[2500, 2600), pretrain-37.tar[2600, 2700), pretrain-37.tar[2700, 2800), ...<619>, pretrain-42.tar[4700, 4800), pretrain-42.tar[4800, 4900), pretrain-42.tar[4900, 5000)] sum(count)=62500
rank=1, worker=0: shard_range=[pretrain-2.tar[5000, 5100), pretrain-2.tar[5100, 5200), pretrain-2.tar[5200, 5300), ...<619>, pretrain-25.tar[7200, 7300), pretrain-25.tar[7300, 7400), pretrain-25.tar[7400, 7500)] sum(count)=62500
rank=1, worker=1: shard_range=[pretrain-25.tar[7500, 7600), pretrain-25.tar[7600, 7700), pretrain-25.tar[7700, 7800), ...<619>, pretrain-30.tar[9700, 9800), pretrain-30.tar[9800, 9900), pretrain-30.tar[9900, 10000)] sum(count)=62500
rank=0, worker=0: shard_range=[pretrain-0.tar[0, 100), pretrain-0.tar[100, 200), pretrain-0.tar[200, 300), ...<619>, pretrain-14.tar[2200, 2300), pretrain-14.tar[2300, 2400), pretrain-14.tar[2400, 2500)] sum(count)=62500
rank=0, worker=1: shard_range=[pretrain-14.tar[2500, 2600), pretrain-14.tar[2600, 2700), pretrain-14.tar[2700, 2800), ...<619>, pretrain-2.tar[4700, 4800), pretrain-2.tar[4800, 4900), pretrain-2.tar[4900, 5000)] sum(count)=62500
rank=3, worker=0: shard_range=[pretrain-42.tar[5000, 5100), pretrain-42.tar[5100, 5200), pretrain-42.tar[5200, 5300), ...<619>, pretrain-48.tar[7200, 7300), pretrain-48.tar[7300, 7400), pretrain-48.tar[7400, 7500)] sum(count)=62500
rank=3, worker=1: shard_range=[pretrain-48.tar[7500, 7600), pretrain-48.tar[7600, 7700), pretrain-48.tar[7700, 7800), ...<619>, pretrain-53.tar[9700, 9800), pretrain-53.tar[9800, 9900), pretrain-53.tar[9900, 10000)] sum(count)=62500
rank=2, worker=0: shard_range=[pretrain-7.tar[936, 8202)] sum(count)=7266
rank=2, worker=1: shard_range=[pretrain-7.tar[8202, 10000), pretrain-8.tar[0, 5468)] sum(count)=7266
rank=0, worker=0: shard_range=[pretrain-54.tar[0, 7266)] sum(count)=7266
rank=0, worker=1: shard_range=[pretrain-54.tar[7266, 10000), pretrain-55.tar[0, 4532)] sum(count)=7266
rank=1, worker=0: shard_range=[pretrain-55.tar[4532, 8128), pretrain-6.tar[0, 3670)] sum(count)=7266
rank=1, worker=1: shard_range=[pretrain-6.tar[3670, 10000), pretrain-7.tar[0, 936)] sum(count)=7266
rank=3, worker=0: shard_range=[pretrain-8.tar[5468, 10000), pretrain-9.tar[0, 2734)] sum(count)=7266
rank=3, worker=1: shard_range=[pretrain-9.tar[2734, 10000)] sum(count)=7266
times across ranks (ms):
  model-and-optimizer-setup:
     rank  0: 136.49
     rank  1: 87.07
     rank  2: 130.78
     rank  3: 124.33
     rank  4: 24.06
     rank  5: 33.42
     rank  6: 33.41
     rank  7: 35.74
     rank  8: 20.85
     rank  9: 25.79
     rank 10: 19.93
     rank 11: 30.26
     rank 12: 28.73
     rank 13: 25.28
     rank 14: 25.12
     rank 15: 25.27
  train/valid/test-data-iterators-setup:
     rank  0: 979.88
     rank  1: 979.85
     rank  2: 979.85
     rank  3: 979.85
     rank  4: 1044.74
     rank  5: 1119.36
     rank  6: 1179.73
     rank  7: 1202.75
     rank  8: 1209.79
     rank  9: 1210.03
     rank 10: 1209.73
     rank 11: 1209.75
     rank 12: 1209.73
     rank 13: 1209.72
     rank 14: 1209.73
     rank 15: 1209.76
 [2024-12-30 21:32:50] iteration        1/      10 | consumed samples:           32 | elapsed time per iteration (ms): 14928.2 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 7.207644E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
stage4 GPU utialization:65.17623554576527 %
[Rank 12] (after 1 iterations) memory (MB) | allocated: 3925.3935546875 | max allocated: 7341.451171875 | reserved: 7680.0 | max reserved: 7680.0
times across ranks (ms):
  forward-backward:
     rank  0: 14728.00
     rank  1: 14727.87
     rank  2: 14727.86
     rank  3: 14728.01
     rank  4: 14850.55
     rank  5: 14850.64
     rank  6: 14850.67
     rank  7: 14850.66
     rank  8: 14880.59
     rank  9: 14881.03
     rank 10: 14880.44
     rank 11: 14880.54
     rank 12: 14724.18
     rank 13: 14724.23
     rank 14: 14724.15
     rank 15: 14724.19
  forward-compute:
     rank  0: 4489.21
     rank  1: 4797.89
     rank  2: 4732.77
     rank  3: 4577.94
     rank  4: 2764.29
     rank  5: 2748.36
     rank  6: 2763.49
     rank  7: 2837.08
     rank  8: 2458.22
     rank  9: 2649.43
     rank 10: 2558.87
     rank 11: 2619.12
     rank 12: 3498.77
     rank 13: 3011.94
     rank 14: 3172.41
     rank 15: 3181.42
  backward-compute:
     rank  0: 1390.58
     rank  1: 1405.12
     rank  2: 1662.62
     rank  3: 1656.30
     rank  4: 613.58
     rank  5: 613.52
     rank  6: 612.98
     rank  7: 614.85
     rank  8: 613.71
     rank  9: 611.85
     rank 10: 611.40
     rank 11: 612.63
     rank 12: 710.15
     rank 13: 707.05
     rank 14: 720.78
     rank 15: 704.50
  pure-backward-compute:
     rank  0: 1390.16
     rank  1: 1404.74
     rank  2: 1662.27
     rank  3: 1655.93
     rank  4: 613.18
     rank  5: 612.94
     rank  6: 612.57
     rank  7: 614.40
     rank  8: 613.21
     rank  9: 611.21
     rank 10: 610.95
     rank 11: 612.21
     rank 12: 709.27
     rank 13: 705.92
     rank 14: 720.01
     rank 15: 703.71
  batch-generator:
     rank  0: 965.52
     rank  1: 1129.61
     rank  2: 1062.08
     rank  3: 1051.86
     rank  4: 1012.59
     rank  5: 956.23
     rank  6: 988.12
     rank  7: 1037.61
     rank  8: 1096.38
     rank  9: 1038.62
     rank 10: 989.11
     rank 11: 1027.87
     rank 12: 1078.38
     rank 13: 1026.11
     rank 14: 847.15
     rank 15: 1105.94
  forward-recv:
     rank  4: 4426.83
     rank  5: 4738.07
     rank  6: 4633.96
     rank  7: 4507.88
     rank  8: 6821.26
     rank  9: 7117.44
     rank 10: 7050.51
     rank 11: 6975.87
     rank 12: 8921.86
     rank 13: 9406.42
     rank 14: 9247.95
     rank 15: 9245.85
  forward-send:
     rank  0: 4509.54
     rank  1: 4692.55
     rank  2: 4597.96
     rank  3: 4762.03
     rank  4: 1990.86
     rank  5: 2184.93
     rank  6: 2114.76
     rank  7: 2163.76
     rank  8: 27.31
     rank  9: 24.20
     rank 10: 28.89
     rank 11: 32.02
  backward-recv:
     rank  0: 130.39
     rank  1: 128.33
     rank  2: 130.67
     rank  3: 133.66
     rank  4: 8.41
     rank  5: 6.79
     rank  6: 13.44
     rank  7: 13.08
     rank  8: 3.10
     rank  9: 3.03
     rank 10: 4.89
     rank 11: 4.95
  backward-send:
     rank  4: 829.86
     rank  5: 843.32
     rank  6: 1091.21
     rank  7: 1095.12
     rank  8: 648.45
     rank  9: 663.09
     rank 10: 912.71
     rank 11: 918.68
     rank 12: 465.99
     rank 13: 483.18
     rank 14: 728.08
     rank 15: 730.73
  forward-send-backward-recv:
     rank  0: 3509.57
     rank  1: 3020.96
     rank  2: 3173.68
     rank  3: 3169.03
     rank  4: 3289.65
     rank  5: 2802.54
     rank  6: 2959.18
     rank  7: 2959.38
     rank  8: 3188.91
     rank  9: 2701.55
     rank 10: 2862.98
     rank 11: 2864.65
  backward-send-forward-recv:
     rank  4: 17.81
     rank  5: 17.06
     rank  6: 16.55
     rank  7: 16.47
     rank  8: 27.23
     rank  9: 31.48
     rank 10: 24.27
     rank 11: 26.91
     rank 12: 37.93
     rank 13: 41.26
     rank 14: 29.59
     rank 15: 35.61
  layernorm-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.05
     rank  3: 0.04
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.06
     rank  9: 0.06
     rank 10: 0.05
     rank 11: 0.21
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.10
     rank  1: 0.07
     rank  2: 0.10
     rank  3: 0.09
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.03
     rank 11: 0.07
     rank 12: 0.08
     rank 13: 0.10
     rank 14: 0.07
     rank 15: 0.08
  all-grads-sync:
     rank  0: 418.69
     rank  1: 418.63
     rank  2: 418.71
     rank  3: 418.78
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.05
     rank  9: 0.05
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.41
     rank  1: 0.25
     rank  2: 0.28
     rank  3: 0.28
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.04
     rank  9: 0.10
     rank 10: 0.04
     rank 11: 0.07
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.05
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.04
     rank  9: 0.06
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.03
     rank  9: 0.04
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 41.74
     rank  1: 41.64
     rank  2: 41.85
     rank  3: 41.77
     rank  4: 0.08
     rank  5: 0.08
     rank  6: 0.14
     rank  7: 0.13
     rank  8: 0.34
     rank  9: 0.61
     rank 10: 0.16
     rank 11: 0.30
     rank 12: 0.13
     rank 13: 0.11
     rank 14: 0.09
     rank 15: 0.10
  optimizer:
     rank  0: 43.72
     rank  1: 43.59
     rank  2: 43.80
     rank  3: 43.73
     rank  4: 2.06
     rank  5: 2.04
     rank  6: 2.10
     rank  7: 2.10
     rank  8: 2.33
     rank  9: 2.55
     rank 10: 2.14
     rank 11: 2.27
     rank 12: 2.11
     rank 13: 2.09
     rank 14: 2.07
     rank 15: 2.08
 [2024-12-30 21:32:53] iteration        2/      10 | consumed samples:           64 | elapsed time per iteration (ms): 2486.5 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 7.152184E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2409.92
     rank  1: 2409.90
     rank  2: 2409.96
     rank  3: 2409.88
     rank  4: 2406.42
     rank  5: 2406.50
     rank  6: 2406.48
     rank  7: 2406.43
     rank  8: 2407.31
     rank  9: 2407.23
     rank 10: 2407.23
     rank 11: 2407.25
     rank 12: 2406.32
     rank 13: 2406.26
     rank 14: 2406.27
     rank 15: 2406.29
  forward-compute:
     rank  0: 344.06
     rank  1: 283.33
     rank  2: 333.70
     rank  3: 302.73
     rank  4: 507.79
     rank  5: 509.01
     rank  6: 504.37
     rank  7: 510.19
     rank  8: 505.57
     rank  9: 497.09
     rank 10: 501.68
     rank 11: 506.72
     rank 12: 608.91
     rank 13: 642.69
     rank 14: 627.93
     rank 15: 613.93
  backward-compute:
     rank  0: 377.39
     rank  1: 370.71
     rank  2: 379.63
     rank  3: 372.78
     rank  4: 601.05
     rank  5: 603.15
     rank  6: 597.38
     rank  7: 601.60
     rank  8: 605.95
     rank  9: 601.56
     rank 10: 602.99
     rank 11: 603.29
     rank 12: 727.22
     rank 13: 716.03
     rank 14: 713.90
     rank 15: 721.66
  pure-backward-compute:
     rank  0: 377.12
     rank  1: 370.32
     rank  2: 379.16
     rank  3: 372.63
     rank  4: 600.72
     rank  5: 602.64
     rank  6: 597.01
     rank  7: 601.28
     rank  8: 605.57
     rank  9: 601.18
     rank 10: 602.67
     rank 11: 602.91
     rank 12: 726.53
     rank 13: 715.39
     rank 14: 713.34
     rank 15: 721.10
  batch-generator:
     rank  0: 20.13
     rank  1: 16.12
     rank  2: 18.25
     rank  3: 15.82
     rank  4: 15.48
     rank  5: 18.03
     rank  6: 15.32
     rank  7: 15.80
     rank  8: 15.14
     rank  9: 12.87
     rank 10: 15.64
     rank 11: 17.31
     rank 12: 14.47
     rank 13: 14.19
     rank 14: 13.39
     rank 15: 13.01
  forward-recv:
     rank  4: 87.57
     rank  5: 66.93
     rank  6: 81.09
     rank  7: 82.38
     rank  8: 217.53
     rank  9: 195.69
     rank 10: 210.58
     rank 11: 212.25
     rank 12: 343.71
     rank 13: 318.45
     rank 14: 335.12
     rank 15: 339.83
  forward-send:
     rank  0: 110.53
     rank  1: 129.70
     rank  2: 103.78
     rank  3: 132.67
     rank  4: 5.85
     rank  5: 5.83
     rank  6: 6.62
     rank  7: 7.45
     rank  8: 2.98
     rank  9: 3.01
     rank 10: 2.96
     rank 11: 3.22
  backward-recv:
     rank  0: 732.75
     rank  1: 749.40
     rank  2: 721.55
     rank  3: 741.79
     rank  4: 370.21
     rank  5: 364.43
     rank  6: 373.78
     rank  7: 366.72
     rank  8: 182.66
     rank  9: 181.03
     rank 10: 186.33
     rank 11: 180.25
  backward-send:
     rank  4: 9.11
     rank  5: 9.98
     rank  6: 5.28
     rank  7: 9.75
     rank  8: 10.07
     rank  9: 11.36
     rank 10: 5.76
     rank 11: 12.53
     rank 12: 2.86
     rank 13: 5.42
     rank 14: 2.90
     rank 15: 5.33
  forward-send-backward-recv:
     rank  0: 540.71
     rank  1: 569.54
     rank  2: 556.33
     rank  3: 555.30
     rank  4: 430.12
     rank  5: 448.62
     rank  6: 431.56
     rank  7: 432.28
     rank  8: 321.90
     rank  9: 355.98
     rank 10: 330.85
     rank 11: 328.50
  backward-send-forward-recv:
     rank  4: 2.71
     rank  5: 3.36
     rank  6: 2.46
     rank  7: 2.23
     rank  8: 15.54
     rank  9: 12.67
     rank 10: 9.92
     rank 11: 13.21
     rank 12: 24.28
     rank 13: 21.06
     rank 14: 17.91
     rank 15: 22.80
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.07
     rank 12: 0.06
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.05
     rank  2: 0.08
     rank  3: 0.05
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.04
     rank 12: 0.08
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.05
  all-grads-sync:
     rank  0: 296.28
     rank  1: 296.29
     rank  2: 296.18
     rank  3: 296.26
     rank  4: 0.02
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.23
     rank  1: 0.22
     rank  2: 0.46
     rank  3: 0.18
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 38.15
     rank  1: 37.89
     rank  2: 38.28
     rank  3: 37.84
     rank  4: 0.04
     rank  5: 0.23
     rank  6: 0.05
     rank  7: 0.04
     rank  8: 0.04
     rank  9: 0.07
     rank 10: 0.05
     rank 11: 0.06
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.03
     rank 15: 0.03
  optimizer:
     rank  0: 39.51
     rank  1: 39.13
     rank  2: 39.50
     rank  3: 39.09
     rank  4: 1.27
     rank  5: 1.46
     rank  6: 1.28
     rank  7: 1.28
     rank  8: 1.27
     rank  9: 1.29
     rank 10: 1.28
     rank 11: 1.29
     rank 12: 1.27
     rank 13: 1.26
     rank 14: 1.26
     rank 15: 1.26
 [2024-12-30 21:32:55] iteration        3/      10 | consumed samples:           96 | elapsed time per iteration (ms): 2481.9 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 7.175097E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2416.48
     rank  1: 2416.52
     rank  2: 2416.51
     rank  3: 2416.57
     rank  4: 2413.03
     rank  5: 2413.04
     rank  6: 2413.05
     rank  7: 2413.11
     rank  8: 2413.08
     rank  9: 2413.05
     rank 10: 2413.07
     rank 11: 2413.13
     rank 12: 2412.99
     rank 13: 2412.99
     rank 14: 2412.98
     rank 15: 2413.05
  forward-compute:
     rank  0: 286.83
     rank  1: 273.91
     rank  2: 314.85
     rank  3: 286.76
     rank  4: 506.46
     rank  5: 505.07
     rank  6: 501.32
     rank  7: 506.96
     rank  8: 507.63
     rank  9: 498.34
     rank 10: 503.89
     rank 11: 505.91
     rank 12: 611.64
     rank 13: 630.44
     rank 14: 617.25
     rank 15: 636.13
  backward-compute:
     rank  0: 369.59
     rank  1: 376.29
     rank  2: 378.26
     rank  3: 373.52
     rank  4: 601.04
     rank  5: 601.54
     rank  6: 596.74
     rank  7: 602.84
     rank  8: 605.52
     rank  9: 600.24
     rank 10: 602.54
     rank 11: 604.78
     rank 12: 719.12
     rank 13: 722.61
     rank 14: 715.58
     rank 15: 714.52
  pure-backward-compute:
     rank  0: 369.43
     rank  1: 375.85
     rank  2: 377.77
     rank  3: 373.35
     rank  4: 600.83
     rank  5: 601.28
     rank  6: 596.52
     rank  7: 602.52
     rank  8: 605.10
     rank  9: 600.02
     rank 10: 602.19
     rank 11: 604.42
     rank 12: 718.49
     rank 13: 721.98
     rank 14: 714.93
     rank 15: 713.67
  batch-generator:
     rank  0: 15.47
     rank  1: 14.51
     rank  2: 17.23
     rank  3: 17.20
     rank  4: 14.58
     rank  5: 14.12
     rank  6: 13.64
     rank  7: 14.09
     rank  8: 16.86
     rank  9: 14.25
     rank 10: 15.58
     rank 11: 17.33
     rank 12: 14.89
     rank 13: 12.97
     rank 14: 13.61
     rank 15: 14.65
  forward-recv:
     rank  4: 83.03
     rank  5: 67.48
     rank  6: 83.65
     rank  7: 66.26
     rank  8: 216.07
     rank  9: 198.16
     rank 10: 215.87
     rank 11: 195.47
     rank 12: 342.96
     rank 13: 323.05
     rank 14: 341.62
     rank 15: 322.68
  forward-send:
     rank  0: 123.81
     rank  1: 134.40
     rank  2: 111.91
     rank  3: 132.90
     rank  4: 12.20
     rank  5: 10.24
     rank  6: 12.52
     rank  7: 11.41
     rank  8: 4.51
     rank  9: 5.31
     rank 10: 4.31
     rank 11: 5.26
  backward-recv:
     rank  0: 752.41
     rank  1: 744.78
     rank  2: 734.41
     rank  3: 756.28
     rank  4: 379.03
     rank  5: 377.76
     rank  6: 390.55
     rank  7: 378.84
     rank  8: 184.80
     rank  9: 183.38
     rank 10: 182.54
     rank 11: 182.47
  backward-send:
     rank  4: 9.78
     rank  5: 9.14
     rank  6: 4.90
     rank  7: 10.33
     rank  8: 16.92
     rank  9: 16.94
     rank 10: 12.83
     rank 11: 17.09
     rank 12: 9.57
     rank 13: 9.38
     rank 14: 7.77
     rank 15: 9.57
  forward-send-backward-recv:
     rank  0: 580.86
     rank  1: 580.69
     rank  2: 564.60
     rank  3: 565.11
     rank  4: 427.64
     rank  5: 443.71
     rank  6: 419.88
     rank  7: 442.86
     rank  8: 318.91
     rank  9: 351.20
     rank 10: 329.86
     rank 11: 344.31
  backward-send-forward-recv:
     rank  4: 3.15
     rank  5: 4.42
     rank  6: 3.30
     rank  7: 1.97
     rank  8: 13.78
     rank  9: 13.52
     rank 10: 9.33
     rank 11: 12.27
     rank 12: 25.55
     rank 13: 23.80
     rank 14: 23.40
     rank 15: 24.95
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.04
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.04
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.07
     rank  2: 0.09
     rank  3: 0.08
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.05
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.10
  all-grads-sync:
     rank  0: 294.66
     rank  1: 294.63
     rank  2: 294.59
     rank  3: 294.57
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.03
  optimizer-copy-to-main-grad:
     rank  0: 0.18
     rank  1: 0.46
     rank  2: 0.25
     rank  3: 0.19
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 37.66
     rank  1: 37.91
     rank  2: 38.13
     rank  3: 37.79
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.04
     rank  7: 0.08
     rank  8: 0.09
     rank  9: 0.04
     rank 10: 0.05
     rank 11: 0.09
     rank 12: 0.06
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.08
  optimizer:
     rank  0: 38.87
     rank  1: 39.12
     rank  2: 39.34
     rank  3: 38.99
     rank  4: 1.23
     rank  5: 1.23
     rank  6: 1.24
     rank  7: 1.28
     rank  8: 1.30
     rank  9: 1.24
     rank 10: 1.25
     rank 11: 1.29
     rank 12: 1.26
     rank 13: 1.23
     rank 14: 1.23
     rank 15: 1.28
 [2024-12-30 21:32:58] iteration        4/      10 | consumed samples:          128 | elapsed time per iteration (ms): 2492.5 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 6.019598E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2426.26
     rank  1: 2426.28
     rank  2: 2426.34
     rank  3: 2426.27
     rank  4: 2422.42
     rank  5: 2422.45
     rank  6: 2422.45
     rank  7: 2422.42
     rank  8: 2422.76
     rank  9: 2422.76
     rank 10: 2423.03
     rank 11: 2422.77
     rank 12: 2422.35
     rank 13: 2422.31
     rank 14: 2422.30
     rank 15: 2422.38
  forward-compute:
     rank  0: 258.00
     rank  1: 314.45
     rank  2: 315.74
     rank  3: 260.89
     rank  4: 505.67
     rank  5: 503.81
     rank  6: 500.96
     rank  7: 506.65
     rank  8: 504.19
     rank  9: 498.40
     rank 10: 501.99
     rank 11: 505.10
     rank 12: 644.72
     rank 13: 622.38
     rank 14: 611.36
     rank 15: 641.32
  backward-compute:
     rank  0: 369.50
     rank  1: 374.27
     rank  2: 377.19
     rank  3: 371.00
     rank  4: 603.66
     rank  5: 603.06
     rank  6: 599.27
     rank  7: 604.57
     rank  8: 603.70
     rank  9: 601.04
     rank 10: 601.95
     rank 11: 605.57
     rank 12: 709.13
     rank 13: 719.07
     rank 14: 729.90
     rank 15: 711.00
  pure-backward-compute:
     rank  0: 369.34
     rank  1: 373.83
     rank  2: 376.86
     rank  3: 370.82
     rank  4: 603.39
     rank  5: 602.65
     rank  6: 599.07
     rank  7: 604.25
     rank  8: 603.49
     rank  9: 600.74
     rank 10: 601.73
     rank 11: 605.27
     rank 12: 708.53
     rank 13: 718.45
     rank 14: 729.42
     rank 15: 710.39
  batch-generator:
     rank  0: 15.12
     rank  1: 18.17
     rank  2: 17.79
     rank  3: 13.93
     rank  4: 14.13
     rank  5: 13.34
     rank  6: 13.21
     rank  7: 13.61
     rank  8: 13.96
     rank  9: 13.63
     rank 10: 13.57
     rank 11: 15.28
     rank 12: 14.39
     rank 13: 15.35
     rank 14: 12.01
     rank 15: 18.08
  forward-recv:
     rank  4: 64.59
     rank  5: 81.32
     rank  6: 85.78
     rank  7: 66.52
     rank  8: 192.19
     rank  9: 209.51
     rank 10: 213.01
     rank 11: 195.45
     rank 12: 318.21
     rank 13: 334.25
     rank 14: 338.65
     rank 15: 321.01
  forward-send:
     rank  0: 134.21
     rank  1: 105.32
     rank  2: 104.68
     rank  3: 134.58
     rank  4: 6.85
     rank  5: 5.81
     rank  6: 7.48
     rank  7: 5.89
     rank  8: 3.01
     rank  9: 2.93
     rank 10: 2.90
     rank 11: 3.00
  backward-recv:
     rank  0: 739.66
     rank  1: 740.70
     rank  2: 736.94
     rank  3: 742.94
     rank  4: 368.20
     rank  5: 381.70
     rank  6: 379.63
     rank  7: 378.21
     rank  8: 185.97
     rank  9: 185.11
     rank 10: 184.17
     rank 11: 183.48
  backward-send:
     rank  4: 5.59
     rank  5: 8.48
     rank  6: 7.97
     rank  7: 7.50
     rank  8: 5.70
     rank  9: 13.65
     rank 10: 13.61
     rank 11: 11.16
     rank 12: 2.93
     rank 13: 6.08
     rank 14: 6.50
     rank 15: 5.10
  forward-send-backward-recv:
     rank  0: 591.88
     rank  1: 570.06
     rank  2: 569.25
     rank  3: 592.07
     rank  4: 444.31
     rank  5: 425.09
     rank  6: 426.92
     rank  7: 437.16
     rank  8: 340.48
     rank  9: 334.64
     rank 10: 329.31
     rank 11: 338.12
  backward-send-forward-recv:
     rank  4: 2.37
     rank  5: 4.08
     rank  6: 4.09
     rank  7: 3.21
     rank  8: 13.49
     rank  9: 14.83
     rank 10: 13.45
     rank 11: 14.46
     rank 12: 19.86
     rank 13: 21.78
     rank 14: 16.57
     rank 15: 21.72
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.06
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.09
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.09
     rank  2: 0.09
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.07
     rank 11: 0.02
     rank 12: 0.05
     rank 13: 0.05
     rank 14: 0.04
     rank 15: 0.06
  all-grads-sync:
     rank  0: 310.87
     rank  1: 310.87
     rank  2: 310.89
     rank  3: 310.81
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.18
     rank  1: 0.41
     rank  2: 0.41
     rank  3: 0.18
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 37.63
     rank  1: 38.63
     rank  2: 38.67
     rank  3: 37.66
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.07
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.05
     rank 11: 0.06
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.04
  optimizer:
     rank  0: 38.84
     rank  1: 39.84
     rank  2: 39.89
     rank  3: 38.86
     rank  4: 1.23
     rank  5: 1.23
     rank  6: 1.27
     rank  7: 1.23
     rank  8: 1.23
     rank  9: 1.23
     rank 10: 1.25
     rank 11: 1.27
     rank 12: 1.23
     rank 13: 1.23
     rank 14: 1.23
     rank 15: 1.24
 [2024-12-30 21:33:00] iteration        5/      10 | consumed samples:          160 | elapsed time per iteration (ms): 2485.6 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 4.371792E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2420.42
     rank  1: 2420.46
     rank  2: 2420.42
     rank  3: 2420.47
     rank  4: 2416.89
     rank  5: 2416.88
     rank  6: 2416.89
     rank  7: 2416.91
     rank  8: 2416.92
     rank  9: 2416.93
     rank 10: 2416.94
     rank 11: 2416.99
     rank 12: 2417.01
     rank 13: 2417.00
     rank 14: 2417.00
     rank 15: 2417.09
  forward-compute:
     rank  0: 258.54
     rank  1: 331.18
     rank  2: 319.82
     rank  3: 257.76
     rank  4: 505.06
     rank  5: 505.36
     rank  6: 502.33
     rank  7: 506.01
     rank  8: 503.90
     rank  9: 498.58
     rank 10: 506.23
     rank 11: 502.39
     rank 12: 644.37
     rank 13: 622.72
     rank 14: 612.05
     rank 15: 652.42
  backward-compute:
     rank  0: 374.37
     rank  1: 376.17
     rank  2: 378.05
     rank  3: 370.82
     rank  4: 603.20
     rank  5: 601.71
     rank  6: 598.61
     rank  7: 603.67
     rank  8: 605.55
     rank  9: 602.51
     rank 10: 603.37
     rank 11: 604.37
     rank 12: 712.42
     rank 13: 725.75
     rank 14: 732.99
     rank 15: 711.34
  pure-backward-compute:
     rank  0: 374.22
     rank  1: 375.83
     rank  2: 377.56
     rank  3: 370.66
     rank  4: 603.02
     rank  5: 601.46
     rank  6: 598.42
     rank  7: 603.49
     rank  8: 605.30
     rank  9: 602.29
     rank 10: 602.69
     rank 11: 604.11
     rank 12: 711.87
     rank 13: 725.13
     rank 14: 732.44
     rank 15: 710.48
  batch-generator:
     rank  0: 13.65
     rank  1: 17.43
     rank  2: 22.41
     rank  3: 14.64
     rank  4: 12.76
     rank  5: 13.65
     rank  6: 12.90
     rank  7: 11.90
     rank  8: 12.49
     rank  9: 14.68
     rank 10: 17.34
     rank 11: 12.56
     rank 12: 15.12
     rank 13: 14.63
     rank 14: 12.59
     rank 15: 17.70
  forward-recv:
     rank  4: 66.98
     rank  5: 82.71
     rank  6: 86.43
     rank  7: 67.57
     rank  8: 197.22
     rank  9: 212.02
     rank 10: 214.96
     rank 11: 198.32
     rank 12: 323.19
     rank 13: 335.66
     rank 14: 341.56
     rank 15: 323.26
  forward-send:
     rank  0: 139.51
     rank  1: 99.98
     rank  2: 103.89
     rank  3: 139.88
     rank  4: 11.90
     rank  5: 5.85
     rank  6: 7.52
     rank  7: 10.99
     rank  8: 5.35
     rank  9: 3.01
     rank 10: 2.95
     rank 11: 5.47
  backward-recv:
     rank  0: 744.87
     rank  1: 748.35
     rank  2: 744.14
     rank  3: 750.79
     rank  4: 367.80
     rank  5: 376.68
     rank  6: 379.30
     rank  7: 391.22
     rank  8: 186.24
     rank  9: 188.63
     rank 10: 186.85
     rank 11: 193.43
  backward-send:
     rank  4: 6.93
     rank  5: 8.89
     rank  6: 7.79
     rank  7: 4.76
     rank  8: 5.65
     rank  9: 10.62
     rank 10: 10.98
     rank 11: 7.40
     rank 12: 3.81
     rank 13: 6.23
     rank 14: 6.75
     rank 15: 6.59
  forward-send-backward-recv:
     rank  0: 585.65
     rank  1: 558.92
     rank  2: 566.95
     rank  3: 591.10
     rank  4: 448.44
     rank  5: 437.20
     rank  6: 436.09
     rank  7: 431.37
     rank  8: 341.48
     rank  9: 338.46
     rank 10: 330.17
     rank 11: 344.46
  backward-send-forward-recv:
     rank  4: 2.01
     rank  5: 3.64
     rank  6: 3.14
     rank  7: 2.81
     rank  8: 14.25
     rank  9: 15.09
     rank 10: 13.38
     rank 11: 9.85
     rank 12: 21.03
     rank 13: 21.70
     rank 14: 17.97
     rank 15: 14.95
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.05
     rank 12: 0.06
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.08
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.07
     rank  2: 0.07
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.11
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.11
  all-grads-sync:
     rank  0: 296.91
     rank  1: 296.89
     rank  2: 296.84
     rank  3: 296.88
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.04
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.19
     rank  1: 0.27
     rank  2: 0.26
     rank  3: 0.19
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 37.67
     rank  1: 38.05
     rank  2: 38.14
     rank  3: 37.68
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.04
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.06
     rank 10: 0.08
     rank 11: 0.05
     rank 12: 0.08
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.06
  optimizer:
     rank  0: 38.70
     rank  1: 39.11
     rank  2: 39.17
     rank  3: 38.71
     rank  4: 1.07
     rank  5: 1.07
     rank  6: 1.08
     rank  7: 1.07
     rank  8: 1.07
     rank  9: 1.09
     rank 10: 1.11
     rank 11: 1.08
     rank 12: 1.11
     rank 13: 1.07
     rank 14: 1.07
     rank 15: 1.10
 [2024-12-30 21:33:03] iteration        6/      10 | consumed samples:          192 | elapsed time per iteration (ms): 2485.9 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 3.498040E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2420.24
     rank  1: 2420.22
     rank  2: 2420.30
     rank  3: 2420.25
     rank  4: 2416.70
     rank  5: 2415.76
     rank  6: 2416.75
     rank  7: 2416.74
     rank  8: 2416.75
     rank  9: 2416.75
     rank 10: 2416.75
     rank 11: 2416.75
     rank 12: 2416.67
     rank 13: 2416.68
     rank 14: 2416.67
     rank 15: 2416.71
  forward-compute:
     rank  0: 250.77
     rank  1: 294.35
     rank  2: 313.23
     rank  3: 249.54
     rank  4: 505.20
     rank  5: 504.10
     rank  6: 501.86
     rank  7: 507.05
     rank  8: 503.81
     rank  9: 497.85
     rank 10: 502.03
     rank 11: 505.05
     rank 12: 639.94
     rank 13: 613.00
     rank 14: 624.95
     rank 15: 641.23
  backward-compute:
     rank  0: 363.64
     rank  1: 376.28
     rank  2: 381.83
     rank  3: 371.38
     rank  4: 603.73
     rank  5: 601.40
     rank  6: 598.62
     rank  7: 605.42
     rank  8: 602.72
     rank  9: 600.37
     rank 10: 602.64
     rank 11: 605.28
     rank 12: 719.03
     rank 13: 731.27
     rank 14: 721.21
     rank 15: 712.49
  pure-backward-compute:
     rank  0: 363.44
     rank  1: 376.07
     rank  2: 381.41
     rank  3: 371.23
     rank  4: 603.55
     rank  5: 601.15
     rank  6: 598.42
     rank  7: 605.15
     rank  8: 602.44
     rank  9: 600.15
     rank 10: 602.39
     rank 11: 605.05
     rank 12: 718.35
     rank 13: 730.64
     rank 14: 720.69
     rank 15: 711.86
  batch-generator:
     rank  0: 13.89
     rank  1: 15.69
     rank  2: 16.14
     rank  3: 13.00
     rank  4: 12.81
     rank  5: 13.18
     rank  6: 12.23
     rank  7: 12.34
     rank  8: 14.40
     rank  9: 12.86
     rank 10: 14.00
     rank 11: 15.50
     rank 12: 14.63
     rank 13: 12.38
     rank 14: 13.53
     rank 15: 17.15
  forward-recv:
     rank  4: 65.83
     rank  5: 83.87
     rank  6: 85.81
     rank  7: 66.34
     rank  8: 196.52
     rank  9: 217.66
     rank 10: 215.60
     rank 11: 197.28
     rank 12: 322.46
     rank 13: 338.23
     rank 14: 339.97
     rank 15: 323.82
  forward-send:
     rank  0: 143.67
     rank  1: 129.53
     rank  2: 112.96
     rank  3: 144.58
     rank  4: 10.59
     rank  5: 10.78
     rank  6: 10.91
     rank  7: 10.69
     rank  8: 5.24
     rank  9: 3.71
     rank 10: 3.85
     rank 11: 4.51
  backward-recv:
     rank  0: 760.99
     rank  1: 739.45
     rank  2: 744.60
     rank  3: 751.35
     rank  4: 379.25
     rank  5: 373.18
     rank  6: 393.44
     rank  7: 372.94
     rank  8: 185.87
     rank  9: 180.66
     rank 10: 183.79
     rank 11: 174.82
  backward-send:
     rank  4: 7.42
     rank  5: 7.95
     rank  6: 7.99
     rank  7: 6.30
     rank  8: 11.66
     rank  9: 12.26
     rank 10: 13.90
     rank 11: 12.16
     rank 12: 6.47
     rank 13: 5.12
     rank 14: 5.55
     rank 15: 2.94
  forward-send-backward-recv:
     rank  0: 589.46
     rank  1: 565.70
     rank  2: 558.18
     rank  3: 585.12
     rank  4: 443.01
     rank  5: 426.62
     rank  6: 416.36
     rank  7: 438.08
     rank  8: 345.41
     rank  9: 336.01
     rank 10: 335.61
     rank 11: 347.99
  backward-send-forward-recv:
     rank  4: 3.19
     rank  5: 2.58
     rank  6: 3.30
     rank  7: 1.96
     rank  8: 12.98
     rank  9: 11.07
     rank 10: 8.02
     rank 11: 9.21
     rank 12: 21.24
     rank 13: 19.44
     rank 14: 18.57
     rank 15: 21.15
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.05
     rank  2: 0.09
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.05
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.06
  all-grads-sync:
     rank  0: 299.54
     rank  1: 299.46
     rank  2: 299.48
     rank  3: 299.60
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.19
     rank  1: 0.21
     rank  2: 0.24
     rank  3: 0.19
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 37.66
     rank  1: 37.71
     rank  2: 38.33
     rank  3: 37.75
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.07
     rank  9: 0.04
     rank 10: 0.03
     rank 11: 0.06
     rank 12: 0.04
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.06
  optimizer:
     rank  0: 38.54
     rank  1: 38.59
     rank  2: 39.17
     rank  3: 38.63
     rank  4: 0.91
     rank  5: 0.91
     rank  6: 0.91
     rank  7: 0.91
     rank  8: 0.95
     rank  9: 0.91
     rank 10: 0.91
     rank 11: 0.94
     rank 12: 0.91
     rank 13: 0.91
     rank 14: 0.91
     rank 15: 0.94
 [2024-12-30 21:33:05] iteration        7/      10 | consumed samples:          224 | elapsed time per iteration (ms): 2477.6 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 2.371156E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2413.26
     rank  1: 2413.22
     rank  2: 2413.33
     rank  3: 2413.28
     rank  4: 2409.75
     rank  5: 2409.74
     rank  6: 2409.75
     rank  7: 2409.79
     rank  8: 2409.77
     rank  9: 2409.77
     rank 10: 2409.78
     rank 11: 2409.82
     rank 12: 2409.67
     rank 13: 2409.67
     rank 14: 2409.67
     rank 15: 2409.67
  forward-compute:
     rank  0: 289.17
     rank  1: 247.08
     rank  2: 315.36
     rank  3: 254.08
     rank  4: 506.18
     rank  5: 506.02
     rank  6: 502.78
     rank  7: 507.46
     rank  8: 499.60
     rank  9: 495.03
     rank 10: 504.84
     rank 11: 503.69
     rank 12: 621.91
     rank 13: 621.02
     rank 14: 614.99
     rank 15: 632.89
  backward-compute:
     rank  0: 364.51
     rank  1: 374.26
     rank  2: 379.97
     rank  3: 369.76
     rank  4: 604.16
     rank  5: 601.53
     rank  6: 598.45
     rank  7: 603.95
     rank  8: 601.10
     rank  9: 598.85
     rank 10: 605.77
     rank 11: 605.94
     rank 12: 721.65
     rank 13: 725.01
     rank 14: 725.08
     rank 15: 713.75
  pure-backward-compute:
     rank  0: 364.32
     rank  1: 374.10
     rank  2: 379.59
     rank  3: 369.54
     rank  4: 603.97
     rank  5: 601.35
     rank  6: 598.21
     rank  7: 603.76
     rank  8: 600.90
     rank  9: 598.55
     rank 10: 605.36
     rank 11: 605.71
     rank 12: 721.07
     rank 13: 724.50
     rank 14: 724.55
     rank 15: 713.13
  batch-generator:
     rank  0: 14.85
     rank  1: 13.96
     rank  2: 18.20
     rank  3: 13.86
     rank  4: 13.84
     rank  5: 14.57
     rank  6: 13.05
     rank  7: 12.11
     rank  8: 12.98
     rank  9: 12.97
     rank 10: 14.07
     rank 11: 12.37
     rank 12: 13.20
     rank 13: 12.62
     rank 14: 12.86
     rank 15: 15.36
  forward-recv:
     rank  4: 70.68
     rank  5: 69.54
     rank  6: 83.96
     rank  7: 70.70
     rank  8: 204.85
     rank  9: 205.16
     rank 10: 211.68
     rank 11: 204.93
     rank 12: 329.62
     rank 13: 327.05
     rank 14: 336.49
     rank 15: 329.87
  forward-send:
     rank  0: 128.16
     rank  1: 153.56
     rank  2: 103.87
     rank  3: 151.85
     rank  4: 14.94
     rank  5: 13.40
     rank  6: 6.22
     rank  7: 15.04
     rank  8: 6.62
     rank  9: 5.29
     rank 10: 2.97
     rank 11: 6.62
  backward-recv:
     rank  0: 749.63
     rank  1: 737.39
     rank  2: 737.85
     rank  3: 734.26
     rank  4: 375.60
     rank  5: 373.94
     rank  6: 378.64
     rank  7: 383.50
     rank  8: 185.64
     rank  9: 186.51
     rank 10: 185.96
     rank 11: 185.56
  backward-send:
     rank  4: 9.65
     rank  5: 7.12
     rank  6: 9.43
     rank  7: 5.02
     rank  8: 11.18
     rank  9: 9.17
     rank 10: 9.33
     rank 11: 5.67
     rank 12: 6.07
     rank 13: 5.30
     rank 14: 4.72
     rank 15: 2.93
  forward-send-backward-recv:
     rank  0: 572.32
     rank  1: 590.64
     rank  2: 569.17
     rank  3: 585.79
     rank  4: 428.72
     rank  5: 433.37
     rank  6: 431.26
     rank  7: 415.09
     rank  8: 334.56
     rank  9: 339.68
     rank 10: 323.43
     rank 11: 328.20
  backward-send-forward-recv:
     rank  4: 4.41
     rank  5: 4.27
     rank  6: 3.34
     rank  7: 3.68
     rank  8: 16.34
     rank  9: 17.51
     rank 10: 17.25
     rank 11: 11.45
     rank 12: 25.39
     rank 13: 24.80
     rank 14: 24.80
     rank 15: 18.18
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.05
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.06
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.04
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.05
  all-grads-sync:
     rank  0: 297.55
     rank  1: 297.46
     rank  2: 297.54
     rank  3: 297.60
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.18
     rank  1: 0.20
     rank  2: 0.23
     rank  3: 0.18
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 37.65
     rank  1: 37.60
     rank  2: 37.97
     rank  3: 37.67
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.04
     rank  8: 0.03
     rank  9: 0.04
     rank 10: 0.07
     rank 11: 0.08
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.04
  optimizer:
     rank  0: 38.59
     rank  1: 38.55
     rank  2: 38.92
     rank  3: 38.62
     rank  4: 0.97
     rank  5: 0.97
     rank  6: 0.97
     rank  7: 0.98
     rank  8: 0.98
     rank  9: 0.98
     rank 10: 1.00
     rank 11: 0.92
     rank 12: 0.97
     rank 13: 0.97
     rank 14: 0.97
     rank 15: 0.99
 [2024-12-30 21:33:08] iteration        8/      10 | consumed samples:          256 | elapsed time per iteration (ms): 2478.5 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 1.657994E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2413.50
     rank  1: 2413.51
     rank  2: 2413.50
     rank  3: 2414.23
     rank  4: 2409.98
     rank  5: 2409.99
     rank  6: 2409.98
     rank  7: 2409.99
     rank  8: 2410.00
     rank  9: 2410.02
     rank 10: 2410.06
     rank 11: 2409.99
     rank 12: 2409.93
     rank 13: 2409.95
     rank 14: 2409.92
     rank 15: 2409.92
  forward-compute:
     rank  0: 253.32
     rank  1: 248.98
     rank  2: 308.59
     rank  3: 273.35
     rank  4: 506.90
     rank  5: 510.26
     rank  6: 502.63
     rank  7: 510.78
     rank  8: 499.16
     rank  9: 495.71
     rank 10: 504.52
     rank 11: 505.10
     rank 12: 634.82
     rank 13: 630.92
     rank 14: 614.81
     rank 15: 633.16
  backward-compute:
     rank  0: 365.81
     rank  1: 375.56
     rank  2: 381.40
     rank  3: 369.11
     rank  4: 604.26
     rank  5: 603.44
     rank  6: 598.93
     rank  7: 604.99
     rank  8: 601.50
     rank  9: 598.72
     rank 10: 605.50
     rank 11: 602.90
     rank 12: 721.58
     rank 13: 721.61
     rank 14: 735.20
     rank 15: 715.36
  pure-backward-compute:
     rank  0: 365.59
     rank  1: 375.39
     rank  2: 380.98
     rank  3: 368.88
     rank  4: 604.05
     rank  5: 603.12
     rank  6: 598.70
     rank  7: 604.66
     rank  8: 601.22
     rank  9: 598.39
     rank 10: 605.24
     rank 11: 602.70
     rank 12: 720.89
     rank 13: 721.02
     rank 14: 734.71
     rank 15: 714.67
  batch-generator:
     rank  0: 13.71
     rank  1: 13.60
     rank  2: 15.89
     rank  3: 13.72
     rank  4: 13.75
     rank  5: 16.53
     rank  6: 13.13
     rank  7: 14.32
     rank  8: 12.70
     rank  9: 14.46
     rank 10: 12.95
     rank 11: 14.25
     rank 12: 12.76
     rank 13: 13.38
     rank 14: 13.16
     rank 15: 15.08
  forward-recv:
     rank  4: 68.39
     rank  5: 67.37
     rank  6: 80.99
     rank  7: 68.36
     rank  8: 204.00
     rank  9: 202.07
     rank 10: 208.31
     rank 11: 202.85
     rank 12: 323.60
     rank 13: 321.95
     rank 14: 334.29
     rank 15: 326.79
  forward-send:
     rank  0: 145.29
     rank  1: 146.11
     rank  2: 107.94
     rank  3: 141.80
     rank  4: 12.42
     rank  5: 10.47
     rank  6: 6.55
     rank  7: 11.03
     rank  8: 4.03
     rank  9: 3.86
     rank 10: 3.07
     rank 11: 3.00
  backward-recv:
     rank  0: 748.68
     rank  1: 739.85
     rank  2: 736.98
     rank  3: 746.42
     rank  4: 386.22
     rank  5: 374.36
     rank  6: 378.21
     rank  7: 370.03
     rank  8: 185.62
     rank  9: 185.22
     rank 10: 186.80
     rank 11: 189.21
  backward-send:
     rank  4: 6.21
     rank  5: 6.62
     rank  6: 8.34
     rank  7: 6.81
     rank  8: 10.16
     rank  9: 10.40
     rank 10: 7.94
     rank 11: 6.65
     rank 12: 3.71
     rank 13: 4.80
     rank 14: 2.92
     rank 15: 4.01
  forward-send-backward-recv:
     rank  0: 591.04
     rank  1: 594.11
     rank  2: 573.13
     rank  3: 568.55
     rank  4: 423.80
     rank  5: 432.51
     rank  6: 433.74
     rank  7: 434.15
     rank  8: 343.63
     rank  9: 346.22
     rank 10: 331.47
     rank 11: 330.93
  backward-send-forward-recv:
     rank  4: 5.18
     rank  5: 5.27
     rank  6: 5.09
     rank  7: 2.09
     rank  8: 11.91
     rank  9: 15.84
     rank 10: 14.87
     rank 11: 14.68
     rank 12: 21.94
     rank 13: 24.26
     rank 14: 20.88
     rank 15: 21.76
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.05
     rank  2: 0.05
     rank  3: 0.06
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.05
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.05
  all-grads-sync:
     rank  0: 295.96
     rank  1: 295.97
     rank  2: 295.94
     rank  3: 295.97
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.20
     rank  1: 0.21
     rank  2: 0.21
     rank  3: 0.22
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 37.67
     rank  1: 37.79
     rank  2: 37.77
     rank  3: 38.21
     rank  4: 0.03
     rank  5: 0.06
     rank  6: 0.07
     rank  7: 0.05
     rank  8: 0.04
     rank  9: 0.05
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.06
     rank 15: 0.06
  optimizer:
     rank  0: 38.62
     rank  1: 38.73
     rank  2: 38.71
     rank  3: 39.16
     rank  4: 0.97
     rank  5: 1.00
     rank  6: 0.94
     rank  7: 1.00
     rank  8: 0.98
     rank  9: 0.99
     rank 10: 0.97
     rank 11: 0.98
     rank 12: 0.97
     rank 13: 0.97
     rank 14: 1.00
     rank 15: 1.00
 [2024-12-30 21:33:10] iteration        9/      10 | consumed samples:          288 | elapsed time per iteration (ms): 2489.2 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 1.900197E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2423.49
     rank  1: 2423.53
     rank  2: 2423.49
     rank  3: 2423.62
     rank  4: 2420.02
     rank  5: 2420.01
     rank  6: 2420.01
     rank  7: 2420.05
     rank  8: 2420.33
     rank  9: 2420.33
     rank 10: 2420.62
     rank 11: 2420.33
     rank 12: 2419.89
     rank 13: 2419.90
     rank 14: 2419.90
     rank 15: 2419.95
  forward-compute:
     rank  0: 259.76
     rank  1: 256.40
     rank  2: 262.47
     rank  3: 307.26
     rank  4: 510.14
     rank  5: 506.27
     rank  6: 506.84
     rank  7: 507.79
     rank  8: 499.22
     rank  9: 498.37
     rank 10: 510.24
     rank 11: 498.79
     rank 12: 625.07
     rank 13: 620.24
     rank 14: 623.28
     rank 15: 616.08
  backward-compute:
     rank  0: 367.17
     rank  1: 376.13
     rank  2: 380.86
     rank  3: 369.41
     rank  4: 605.03
     rank  5: 603.35
     rank  6: 602.61
     rank  7: 605.25
     rank  8: 601.80
     rank  9: 599.48
     rank 10: 607.02
     rank 11: 601.13
     rank 12: 725.22
     rank 13: 728.87
     rank 14: 728.97
     rank 15: 725.38
  pure-backward-compute:
     rank  0: 366.76
     rank  1: 375.89
     rank  2: 380.40
     rank  3: 369.24
     rank  4: 604.79
     rank  5: 603.15
     rank  6: 602.36
     rank  7: 605.04
     rank  8: 601.50
     rank  9: 599.07
     rank 10: 606.70
     rank 11: 600.93
     rank 12: 724.33
     rank 13: 728.34
     rank 14: 728.38
     rank 15: 724.55
  batch-generator:
     rank  0: 13.67
     rank  1: 14.59
     rank  2: 15.19
     rank  3: 16.02
     rank  4: 15.18
     rank  5: 14.65
     rank  6: 16.20
     rank  7: 12.24
     rank  8: 12.82
     rank  9: 15.71
     rank 10: 17.61
     rank 11: 12.71
     rank 12: 18.73
     rank 13: 13.18
     rank 14: 13.21
     rank 15: 13.15
  forward-recv:
     rank  4: 66.62
     rank  5: 69.65
     rank  6: 69.91
     rank  7: 80.64
     rank  8: 204.88
     rank  9: 203.58
     rank 10: 202.80
     rank 11: 212.63
     rank 12: 323.17
     rank 13: 327.63
     rank 14: 328.56
     rank 15: 333.25
  forward-send:
     rank  0: 146.25
     rank  1: 147.76
     rank  2: 146.00
     rank  3: 108.95
     rank  4: 12.95
     rank  5: 14.87
     rank  6: 16.74
     rank  7: 5.96
     rank  8: 3.32
     rank  9: 5.10
     rank 10: 4.76
     rank 11: 2.91
  backward-recv:
     rank  0: 756.35
     rank  1: 750.19
     rank  2: 742.32
     rank  3: 751.78
     rank  4: 380.44
     rank  5: 384.98
     rank  6: 395.64
     rank  7: 383.39
     rank  8: 185.31
     rank  9: 189.65
     rank 10: 187.89
     rank 11: 191.71
  backward-send:
     rank  4: 9.55
     rank  5: 8.51
     rank  6: 7.86
     rank  7: 6.58
     rank  8: 14.92
     rank  9: 15.00
     rank 10: 13.60
     rank 11: 10.95
     rank 12: 7.69
     rank 13: 7.88
     rank 14: 7.62
     rank 15: 7.32
  forward-send-backward-recv:
     rank  0: 584.01
     rank  1: 589.43
     rank  2: 586.88
     rank  3: 578.69
     rank  4: 437.35
     rank  5: 435.50
     rank  6: 422.74
     rank  7: 429.71
     rank  8: 342.88
     rank  9: 341.99
     rank 10: 335.00
     rank 11: 333.90
  backward-send-forward-recv:
     rank  4: 2.66
     rank  5: 3.73
     rank  6: 4.74
     rank  7: 4.57
     rank  8: 17.24
     rank  9: 18.83
     rank 10: 11.68
     rank 11: 17.12
     rank 12: 29.43
     rank 13: 29.79
     rank 14: 26.10
     rank 15: 28.94
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.09
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.05
  embedding-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.07
     rank  2: 0.06
     rank  3: 0.07
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.07
     rank 11: 0.02
     rank 12: 0.07
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.08
  all-grads-sync:
     rank  0: 294.25
     rank  1: 294.23
     rank  2: 294.19
     rank  3: 294.29
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.23
     rank  1: 0.20
     rank  2: 0.19
     rank  3: 0.21
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.06
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.04
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.03
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 38.10
     rank  1: 37.76
     rank  2: 37.86
     rank  3: 37.99
     rank  4: 0.06
     rank  5: 0.04
     rank  6: 0.03
     rank  7: 0.04
     rank  8: 0.03
     rank  9: 0.06
     rank 10: 0.17
     rank 11: 0.03
     rank 12: 0.04
     rank 13: 0.03
     rank 14: 0.04
     rank 15: 0.04
  optimizer:
     rank  0: 39.23
     rank  1: 38.93
     rank  2: 39.02
     rank  3: 39.14
     rank  4: 1.23
     rank  5: 1.20
     rank  6: 1.19
     rank  7: 1.20
     rank  8: 1.20
     rank  9: 1.23
     rank 10: 1.38
     rank 11: 1.20
     rank 12: 1.20
     rank 13: 1.20
     rank 14: 1.21
     rank 15: 1.20
 [2024-12-30 21:33:13] iteration       10/      10 | consumed samples:          320 | elapsed time per iteration (ms): 2488.0 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 1.812955E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2423.38
     rank  1: 2423.33
     rank  2: 2423.34
     rank  3: 2423.34
     rank  4: 2419.88
     rank  5: 2419.85
     rank  6: 2419.85
     rank  7: 2419.85
     rank  8: 2419.87
     rank  9: 2419.85
     rank 10: 2419.84
     rank 11: 2419.84
     rank 12: 2419.92
     rank 13: 2419.86
     rank 14: 2419.86
     rank 15: 2419.89
  forward-compute:
     rank  0: 309.96
     rank  1: 264.72
     rank  2: 254.53
     rank  3: 268.48
     rank  4: 505.11
     rank  5: 507.76
     rank  6: 504.88
     rank  7: 513.75
     rank  8: 498.50
     rank  9: 501.88
     rank 10: 504.94
     rank 11: 499.87
     rank 12: 619.01
     rank 13: 619.59
     rank 14: 619.27
     rank 15: 639.84
  backward-compute:
     rank  0: 364.18
     rank  1: 376.94
     rank  2: 379.73
     rank  3: 368.34
     rank  4: 604.65
     rank  5: 603.51
     rank  6: 602.56
     rank  7: 608.87
     rank  8: 601.67
     rank  9: 597.71
     rank 10: 606.02
     rank 11: 601.24
     rank 12: 727.05
     rank 13: 731.22
     rank 14: 731.46
     rank 15: 718.55
  pure-backward-compute:
     rank  0: 363.74
     rank  1: 376.76
     rank  2: 379.32
     rank  3: 368.15
     rank  4: 604.42
     rank  5: 603.26
     rank  6: 602.35
     rank  7: 608.55
     rank  8: 601.43
     rank  9: 597.46
     rank 10: 605.62
     rank 11: 600.93
     rank 12: 726.32
     rank 13: 730.65
     rank 14: 730.91
     rank 15: 717.96
  batch-generator:
     rank  0: 15.50
     rank  1: 15.45
     rank  2: 17.09
     rank  3: 17.78
     rank  4: 12.42
     rank  5: 14.90
     rank  6: 12.76
     rank  7: 15.14
     rank  8: 12.29
     rank  9: 19.33
     rank 10: 14.07
     rank 11: 13.31
     rank 12: 16.13
     rank 13: 13.38
     rank 14: 12.77
     rank 15: 19.93
  forward-recv:
     rank  4: 80.21
     rank  5: 65.70
     rank  6: 71.02
     rank  7: 70.44
     rank  8: 211.68
     rank  9: 199.48
     rank 10: 204.98
     rank 11: 205.27
     rank 12: 332.09
     rank 13: 328.16
     rank 14: 329.20
     rank 15: 328.66
  forward-send:
     rank  0: 110.26
     rank  1: 151.60
     rank  2: 151.23
     rank  3: 143.42
     rank  4: 8.95
     rank  5: 16.83
     rank  6: 16.71
     rank  7: 14.42
     rank  8: 3.04
     rank  9: 7.02
     rank 10: 6.98
     rank 11: 7.32
  backward-recv:
     rank  0: 764.32
     rank  1: 755.26
     rank  2: 751.34
     rank  3: 772.05
     rank  4: 388.25
     rank  5: 383.33
     rank  6: 385.25
     rank  7: 398.68
     rank  8: 195.54
     rank  9: 191.06
     rank 10: 190.24
     rank 11: 199.17
  backward-send:
     rank  4: 7.28
     rank  5: 7.82
     rank  6: 9.25
     rank  7: 7.13
     rank  8: 12.54
     rank  9: 13.60
     rank 10: 14.07
     rank 11: 12.46
     rank 12: 9.90
     rank 13: 10.01
     rank 14: 10.09
     rank 15: 9.82
  forward-send-backward-recv:
     rank  0: 569.06
     rank  1: 569.43
     rank  2: 582.94
     rank  3: 567.50
     rank  4: 430.88
     rank  5: 436.43
     rank  6: 435.14
     rank  7: 413.34
     rank  8: 333.69
     rank  9: 344.67
     rank 10: 331.66
     rank 11: 340.16
  backward-send-forward-recv:
     rank  4: 3.07
     rank  5: 2.42
     rank  6: 2.81
     rank  7: 1.90
     rank  8: 16.13
     rank  9: 15.43
     rank 10: 13.99
     rank 11: 6.59
     rank 12: 23.62
     rank 13: 24.10
     rank 14: 22.82
     rank 15: 14.84
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.04
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.05
     rank  2: 0.05
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.07
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.06
  all-grads-sync:
     rank  0: 293.89
     rank  1: 293.87
     rank  2: 293.90
     rank  3: 294.00
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.22
     rank  1: 0.20
     rank  2: 0.20
     rank  3: 0.18
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 37.79
     rank  1: 37.65
     rank  2: 37.83
     rank  3: 37.80
     rank  4: 0.04
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.04
     rank 10: 0.06
     rank 11: 0.06
     rank 12: 0.04
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.08
  optimizer:
     rank  0: 38.55
     rank  1: 38.49
     rank  2: 38.66
     rank  3: 38.62
     rank  4: 0.87
     rank  5: 0.86
     rank  6: 0.86
     rank  7: 0.86
     rank  8: 0.86
     rank  9: 0.88
     rank 10: 0.89
     rank 11: 0.89
     rank 12: 0.87
     rank 13: 0.85
     rank 14: 0.86
     rank 15: 0.91
