examples/multimodal/pretrain-freeze-llm-hete-2080first.sh: line 4: activate: No such file or directory
4
[2024-12-31 13:12:41,508] torch.distributed.run: [WARNING] 
[2024-12-31 13:12:41,508] torch.distributed.run: [WARNING] *****************************************
[2024-12-31 13:12:41,508] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-12-31 13:12:41,508] torch.distributed.run: [WARNING] *****************************************
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:10------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:10------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:10------
------num_pipeline_model_parallel_groups:4------
> setting tensorboard ...
WARNING: one_logger package is required to enable e2e metrics tracking. please go to https://confluence.nvidia.com/display/MLWFO/Package+Repositories for details to install it
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:10------
------num_pipeline_model_parallel_groups:4------
---Rank 17---Tensor Parallel Group GPUs: [1, 1]
---Rank 17---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]
---Rank 18---Tensor Parallel Group GPUs: [0, 0]
---Rank 18---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]
---Rank 19---Tensor Parallel Group GPUs: [1, 1]
---Rank 16---Tensor Parallel Group GPUs: [0, 0]---Rank 19---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]

---Rank 16---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4][rank17]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())

[rank18]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank19]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank16]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
 > number of parameters on (tensor, pipeline) model parallel rank (0, 4): 612413440
 > number of parameters on (tensor, pipeline) model parallel rank (1, 4): 612413440
rank=1, worker=0: shard_range=[pretrain-31.tar[0, 100), pretrain-31.tar[100, 200), pretrain-31.tar[200, 300), ...<1244>, pretrain-42.tar[4700, 4800), pretrain-42.tar[4800, 4900), pretrain-42.tar[4900, 5000)] sum(count)=125000
rank=1, worker=1: shard_range=[pretrain-42.tar[5000, 5100), pretrain-42.tar[5100, 5200), pretrain-42.tar[5200, 5300), ...<1244>, pretrain-53.tar[9700, 9800), pretrain-53.tar[9800, 9900), pretrain-53.tar[9900, 10000)] sum(count)=125000
rank=0, worker=0: shard_range=[pretrain-0.tar[0, 100), pretrain-0.tar[100, 200), pretrain-0.tar[200, 300), ...<1244>, pretrain-2.tar[4700, 4800), pretrain-2.tar[4800, 4900), pretrain-2.tar[4900, 5000)] sum(count)=125000
rank=0, worker=1: shard_range=[pretrain-2.tar[5000, 5100), pretrain-2.tar[5100, 5200), pretrain-2.tar[5200, 5300), ...<1244>, pretrain-30.tar[9700, 9800), pretrain-30.tar[9800, 9900), pretrain-30.tar[9900, 10000)] sum(count)=125000
rank=1, worker=0: shard_range=[pretrain-7.tar[936, 10000), pretrain-8.tar[0, 5468)] sum(count)=14532
rank=1, worker=1: shard_range=[pretrain-8.tar[5468, 10000), pretrain-9.tar[0, 10000)] sum(count)=14532
rank=0, worker=0: shard_range=[pretrain-54.tar[0, 10000), pretrain-55.tar[0, 4532)] sum(count)=14532
rank=0, worker=1: shard_range=[pretrain-55.tar[4532, 8128), pretrain-6.tar[0, 10000), pretrain-7.tar[0, 936)] sum(count)=14532
times across ranks (ms):
  model-and-optimizer-setup:
     rank  0: 94.43
     rank  1: 91.88
     rank  2: 90.40
     rank  3: 101.91
     rank  4: 56.74
     rank  5: 66.68
     rank  6: 71.78
     rank  7: 54.39
     rank  8: 41.58
     rank  9: 57.16
     rank 10: 41.37
     rank 11: 54.22
     rank 12: 66.47
     rank 13: 69.58
     rank 14: 77.59
     rank 15: 66.78
     rank 16: 57.33
     rank 17: 58.15
     rank 18: 59.24
     rank 19: 58.31
  train/valid/test-data-iterators-setup:
     rank  0: 1038.92
     rank  1: 1039.14
     rank  2: 1385.58
     rank  3: 1038.89
     rank  4: 1038.72
     rank  5: 1038.88
     rank  6: 1073.74
     rank  7: 1073.71
     rank  8: 1073.79
     rank  9: 1073.87
     rank 10: 1073.85
     rank 11: 1073.85
     rank 12: 1385.77
     rank 13: 1385.68
     rank 14: 1385.75
     rank 15: 1385.63
     rank 16: 1385.80
     rank 17: 1385.61
     rank 18: 1385.64
     rank 19: 1385.61
 [2024-12-31 13:13:18] iteration        1/      10 | consumed samples:           32 | elapsed time per iteration (ms): 18294.6 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 7.074634E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
[Rank 17] (after 1 iterations) memory (MB) | allocated: 2389.4248046875 | max allocated: 3517.6435546875 | reserved: 3770.0 | max reserved: 3770.0
stage5 GPU utialization:42.9399847984314 %
[Rank 16] (after 1 iterations) memory (MB) | allocated: 2389.4248046875 | max allocated: 3517.6435546875 | reserved: 3770.0 | max reserved: 3770.0
times across ranks (ms):
  forward-backward:
     rank  0: 18161.26
     rank  1: 18158.95
     rank  2: 18161.10
     rank  3: 18161.32
     rank  4: 18153.10
     rank  5: 18153.18
     rank  6: 18153.08
     rank  7: 18153.23
     rank  8: 18231.85
     rank  9: 18242.54
     rank 10: 18232.05
     rank 11: 18242.56
     rank 12: 18218.01
     rank 13: 18222.20
     rank 14: 18217.52
     rank 15: 18220.84
     rank 16: 18153.77
     rank 17: 18153.74
     rank 18: 18153.62
     rank 19: 18153.87
  forward-compute:
     rank  0: 3419.22
     rank  1: 3401.25
     rank  2: 3424.40
     rank  3: 3422.42
     rank  4: 5064.25
     rank  5: 5041.32
     rank  6: 5273.10
     rank  7: 5269.23
     rank  8: 4224.68
     rank  9: 4212.98
     rank 10: 4280.16
     rank 11: 4278.73
     rank 12: 3604.38
     rank 13: 3608.04
     rank 14: 3491.28
     rank 15: 3494.97
     rank 16: 3914.16
     rank 17: 3924.85
     rank 18: 4282.45
     rank 19: 4294.71
  backward-compute:
     rank  0: 2221.02
     rank  1: 2218.11
     rank  2: 2252.02
     rank  3: 2248.39
     rank  4: 3314.24
     rank  5: 3308.63
     rank  6: 3301.89
     rank  7: 3290.83
     rank  8: 2493.27
     rank  9: 2502.74
     rank 10: 2492.37
     rank 11: 2495.03
     rank 12: 2328.68
     rank 13: 2334.73
     rank 14: 2146.61
     rank 15: 2147.94
     rank 16: 2347.60
     rank 17: 2343.39
     rank 18: 2313.81
     rank 19: 2309.80
  pure-backward-compute:
     rank  0: 2220.10
     rank  1: 2217.27
     rank  2: 2250.99
     rank  3: 2247.52
     rank  4: 3313.33
     rank  5: 3306.87
     rank  6: 3300.81
     rank  7: 3289.18
     rank  8: 2491.31
     rank  9: 2500.28
     rank 10: 2490.46
     rank 11: 2493.81
     rank 12: 2326.26
     rank 13: 2331.46
     rank 14: 2143.93
     rank 15: 2145.56
     rank 16: 2344.17
     rank 17: 2340.48
     rank 18: 2310.25
     rank 19: 2306.18
  batch-generator:
     rank  0: 1027.59
     rank  1: 1009.84
     rank  2: 1025.95
     rank  3: 1025.85
     rank  4: 887.78
     rank  5: 880.29
     rank  6: 1105.82
     rank  7: 1123.60
     rank  8: 1091.81
     rank  9: 1087.02
     rank 10: 1104.86
     rank 11: 1100.84
     rank 12: 1331.91
     rank 13: 1336.28
     rank 14: 1393.76
     rank 15: 1390.79
     rank 16: 1293.69
     rank 17: 1295.39
     rank 18: 1264.34
     rank 19: 1268.43
  forward-recv:
     rank  4: 2219.63
     rank  5: 2231.88
     rank  6: 2226.59
     rank  7: 2231.30
     rank  8: 5127.84
     rank  9: 5131.51
     rank 10: 5340.67
     rank 11: 5336.38
     rank 12: 7411.92
     rank 13: 7406.69
     rank 14: 7682.22
     rank 15: 7682.91
     rank 16: 8935.05
     rank 17: 8939.22
     rank 18: 9259.16
     rank 19: 9255.19
  forward-send:
     rank  0: 6582.45
     rank  1: 6597.94
     rank  2: 6914.23
     rank  3: 6913.16
     rank  4: 3555.00
     rank  5: 3558.46
     rank  6: 3659.77
     rank  7: 3653.16
     rank  8: 1429.61
     rank  9: 1429.39
     rank 10: 1468.64
     rank 11: 1465.97
     rank 12: 21.21
     rank 13: 25.46
     rank 14: 23.20
     rank 15: 22.10
  backward-recv:
     rank  0: 878.40
     rank  1: 876.21
     rank  2: 916.37
     rank  3: 917.33
     rank  4: 388.89
     rank  5: 389.14
     rank  6: 435.95
     rank  7: 435.14
     rank  8: 260.03
     rank  9: 260.61
     rank 10: 313.40
     rank 11: 313.62
     rank 12: 143.67
     rank 13: 143.86
     rank 14: 178.17
     rank 15: 178.65
  backward-send:
     rank  4: 1.40
     rank  5: 1.53
     rank  6: 1.24
     rank  7: 1.82
     rank  8: 7.98
     rank  9: 7.59
     rank 10: 7.86
     rank 11: 7.91
     rank 12: 5.77
     rank 13: 5.73
     rank 14: 5.24
     rank 15: 5.59
     rank 16: 5.06
     rank 17: 5.28
     rank 18: 5.38
     rank 19: 5.38
  forward-send-backward-recv:
     rank  0: 4726.38
     rank  1: 4733.87
     rank  2: 4314.30
     rank  3: 4320.28
     rank  4: 2355.07
     rank  5: 2355.68
     rank  6: 2000.72
     rank  7: 2003.14
     rank  8: 2247.53
     rank  9: 2238.86
     rank 10: 1925.72
     rank 11: 1923.57
     rank 12: 2049.57
     rank 13: 2041.55
     rank 14: 2214.37
     rank 15: 2212.29
  backward-send-forward-recv:
     rank  4: 853.20
     rank  5: 861.17
     rank  6: 846.90
     rank  7: 851.05
     rank  8: 1800.00
     rank  9: 1807.12
     rank 10: 1754.09
     rank 11: 1763.59
     rank 12: 1870.24
     rank 13: 1865.36
     rank 14: 1682.29
     rank 15: 1680.57
     rank 16: 2089.05
     rank 17: 2077.99
     rank 18: 1429.06
     rank 19: 1426.59
  layernorm-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.05
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.05
     rank 12: 0.04
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.13
     rank 16: 0.04
     rank 17: 0.05
     rank 18: 0.03
     rank 19: 0.09
  embedding-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.07
     rank  5: 0.08
     rank  6: 0.06
     rank  7: 0.09
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.09
     rank 12: 0.03
     rank 13: 0.04
     rank 14: 0.03
     rank 15: 0.05
     rank 16: 0.08
     rank 17: 0.12
     rank 18: 0.07
     rank 19: 0.13
  all-grads-sync:
     rank  0: 308.81
     rank  1: 295.55
     rank  2: 308.84
     rank  3: 295.60
     rank  4: 95.57
     rank  5: 106.02
     rank  6: 95.55
     rank  7: 106.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.03
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.05
     rank 16: 0.02
     rank 17: 0.03
     rank 18: 0.02
     rank 19: 0.04
  optimizer-copy-to-main-grad:
     rank  0: 0.27
     rank  1: 0.27
     rank  2: 0.27
     rank  3: 0.27
     rank  4: 0.05
     rank  5: 0.04
     rank  6: 0.04
     rank  7: 0.05
     rank  8: 0.03
     rank  9: 0.05
     rank 10: 0.03
     rank 11: 0.04
     rank 12: 0.04
     rank 13: 0.07
     rank 14: 0.08
     rank 15: 0.03
     rank 16: 0.03
     rank 17: 0.03
     rank 18: 0.02
     rank 19: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.04
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.06
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.03
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.02
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 47.43
     rank  1: 46.61
     rank  2: 47.44
     rank  3: 47.37
     rank  4: 6.52
     rank  5: 6.44
     rank  6: 6.39
     rank  7: 6.61
     rank  8: 0.10
     rank  9: 0.14
     rank 10: 0.12
     rank 11: 0.08
     rank 12: 0.12
     rank 13: 0.19
     rank 14: 0.14
     rank 15: 0.19
     rank 16: 0.14
     rank 17: 0.11
     rank 18: 0.14
     rank 19: 0.16
  optimizer:
     rank  0: 48.95
     rank  1: 48.12
     rank  2: 48.95
     rank  3: 48.87
     rank  4: 8.02
     rank  5: 7.95
     rank  6: 7.90
     rank  7: 8.12
     rank  8: 1.59
     rank  9: 1.64
     rank 10: 1.62
     rank 11: 1.61
     rank 12: 1.61
     rank 13: 1.68
     rank 14: 1.63
     rank 15: 1.68
     rank 16: 1.65
     rank 17: 1.62
     rank 18: 1.64
     rank 19: 1.67
 [2024-12-31 13:13:24] iteration        2/      10 | consumed samples:           64 | elapsed time per iteration (ms): 6338.9 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 7.017641E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 6265.97
     rank  1: 6266.00
     rank  2: 6265.94
     rank  3: 6266.07
     rank  4: 6263.76
     rank  5: 6263.80
     rank  6: 6263.75
     rank  7: 6263.83
     rank  8: 6263.38
     rank  9: 6263.48
     rank 10: 6263.38
     rank 11: 6263.49
     rank 12: 6263.60
     rank 13: 6263.62
     rank 14: 6263.84
     rank 15: 6263.52
     rank 16: 6263.40
     rank 17: 6263.60
     rank 18: 6263.39
     rank 19: 6263.70
  forward-compute:
     rank  0: 1605.27
     rank  1: 1601.69
     rank  2: 1638.44
     rank  3: 1636.07
     rank  4: 2321.30
     rank  5: 2313.17
     rank  6: 2298.03
     rank  7: 2291.79
     rank  8: 2101.88
     rank  9: 2093.55
     rank 10: 2093.67
     rank 11: 2090.26
     rank 12: 2185.20
     rank 13: 2189.24
     rank 14: 2063.45
     rank 15: 2065.59
     rank 16: 2199.31
     rank 17: 2202.43
     rank 18: 2564.93
     rank 19: 2564.49
  backward-compute:
     rank  0: 1255.49
     rank  1: 1253.07
     rank  2: 1265.52
     rank  3: 1260.46
     rank  4: 2584.86
     rank  5: 2581.18
     rank  6: 2614.57
     rank  7: 2614.81
     rank  8: 2487.04
     rank  9: 2495.17
     rank 10: 2481.32
     rank 11: 2485.00
     rank 12: 2278.00
     rank 13: 2276.16
     rank 14: 2145.43
     rank 15: 2142.65
     rank 16: 2322.46
     rank 17: 2325.33
     rank 18: 2327.81
     rank 19: 2326.42
  pure-backward-compute:
     rank  0: 1254.73
     rank  1: 1252.29
     rank  2: 1264.61
     rank  3: 1259.69
     rank  4: 2584.03
     rank  5: 2579.07
     rank  6: 2613.60
     rank  7: 2613.69
     rank  8: 2485.13
     rank  9: 2493.47
     rank 10: 2479.68
     rank 11: 2483.42
     rank 12: 2275.87
     rank 13: 2273.23
     rank 14: 2142.84
     rank 15: 2140.02
     rank 16: 2318.71
     rank 17: 2322.92
     rank 18: 2324.71
     rank 19: 2323.27
  batch-generator:
     rank  0: 72.94
     rank  1: 66.98
     rank  2: 80.44
     rank  3: 79.50
     rank  4: 62.74
     rank  5: 70.56
     rank  6: 51.59
     rank  7: 52.99
     rank  8: 51.44
     rank  9: 48.69
     rank 10: 51.62
     rank 11: 48.73
     rank 12: 58.16
     rank 13: 70.09
     rank 14: 78.34
     rank 15: 85.89
     rank 16: 70.06
     rank 17: 70.72
     rank 18: 57.39
     rank 19: 58.96
  forward-recv:
     rank  4: 86.58
     rank  5: 86.77
     rank  6: 87.21
     rank  7: 87.24
     rank  8: 252.59
     rank  9: 254.70
     rank 10: 253.85
     rank 11: 253.84
     rank 12: 377.44
     rank 13: 376.44
     rank 14: 387.32
     rank 15: 386.11
     rank 16: 507.18
     rank 17: 507.72
     rank 18: 497.73
     rank 19: 498.98
  forward-send:
     rank  0: 173.63
     rank  1: 175.50
     rank  2: 176.99
     rank  3: 177.74
     rank  4: 13.97
     rank  5: 15.20
     rank  6: 15.05
     rank  7: 15.44
     rank  8: 11.30
     rank  9: 10.69
     rank 10: 11.52
     rank 11: 11.45
     rank 12: 2.50
     rank 13: 2.71
     rank 14: 1.93
     rank 15: 2.24
  backward-recv:
     rank  0: 885.21
     rank  1: 884.37
     rank  2: 891.70
     rank  3: 893.12
     rank  4: 391.95
     rank  5: 391.46
     rank  6: 397.90
     rank  7: 396.26
     rank  8: 260.66
     rank  9: 260.25
     rank 10: 279.17
     rank 11: 277.79
     rank 12: 143.03
     rank 13: 143.57
     rank 14: 169.87
     rank 15: 170.71
  backward-send:
     rank  4: 1.56
     rank  5: 1.82
     rank  6: 1.25
     rank  7: 1.57
     rank  8: 7.66
     rank  9: 7.95
     rank 10: 7.61
     rank 11: 7.66
     rank 12: 5.55
     rank 13: 5.08
     rank 14: 5.42
     rank 15: 4.75
     rank 16: 5.26
     rank 17: 5.23
     rank 18: 5.08
     rank 19: 5.32
  forward-send-backward-recv:
     rank  0: 2101.11
     rank  1: 2106.92
     rank  2: 2037.30
     rank  3: 2043.89
     rank  4: 494.37
     rank  5: 494.83
     rank  6: 464.39
     rank  7: 467.53
     rank  8: 407.10
     rank  9: 398.52
     rank 10: 328.59
     rank 11: 327.74
     rank 12: 277.45
     rank 13: 274.44
     rank 14: 499.27
     rank 15: 500.59
  backward-send-forward-recv:
     rank  4: 51.37
     rank  5: 55.27
     rank  6: 60.92
     rank  7: 60.90
     rank  8: 255.27
     rank  9: 263.07
     rank 10: 316.88
     rank 11: 320.54
     rank 12: 360.89
     rank 13: 355.55
     rank 14: 344.60
     rank 15: 343.28
     rank 16: 450.25
     rank 17: 446.20
     rank 18: 89.56
     rank 19: 89.90
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.05
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.05
     rank 15: 0.03
     rank 16: 0.03
     rank 17: 0.03
     rank 18: 0.02
     rank 19: 0.04
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.08
     rank  6: 0.06
     rank  7: 0.05
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
     rank 16: 0.07
     rank 17: 0.07
     rank 18: 0.06
     rank 19: 0.09
  all-grads-sync:
     rank  0: 227.63
     rank  1: 216.99
     rank  2: 227.49
     rank  3: 217.01
     rank  4: 38.97
     rank  5: 39.06
     rank  6: 38.97
     rank  7: 39.07
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
     rank 16: 0.03
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.04
  optimizer-copy-to-main-grad:
     rank  0: 0.20
     rank  1: 0.22
     rank  2: 0.21
     rank  3: 0.22
     rank  4: 0.03
     rank  5: 0.04
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.07
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.03
     rank 18: 0.01
     rank 19: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.04
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 27.29
     rank  1: 27.62
     rank  2: 27.32
     rank  3: 27.35
     rank  4: 5.07
     rank  5: 5.14
     rank  6: 5.13
     rank  7: 5.07
     rank  8: 0.06
     rank  9: 0.09
     rank 10: 0.08
     rank 11: 0.08
     rank 12: 0.04
     rank 13: 0.23
     rank 14: 0.35
     rank 15: 0.10
     rank 16: 0.08
     rank 17: 0.10
     rank 18: 0.04
     rank 19: 0.13
  optimizer:
     rank  0: 28.65
     rank  1: 28.65
     rank  2: 28.44
     rank  3: 28.69
     rank  4: 6.10
     rank  5: 6.18
     rank  6: 6.16
     rank  7: 6.10
     rank  8: 1.09
     rank  9: 1.12
     rank 10: 1.11
     rank 11: 1.10
     rank 12: 1.07
     rank 13: 1.26
     rank 14: 1.38
     rank 15: 1.13
     rank 16: 1.11
     rank 17: 1.13
     rank 18: 1.07
     rank 19: 1.15
 [2024-12-31 13:13:30] iteration        3/      10 | consumed samples:           96 | elapsed time per iteration (ms): 6311.7 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 7.098447E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 6246.54
     rank  1: 6246.39
     rank  2: 6246.52
     rank  3: 6246.44
     rank  4: 6244.33
     rank  5: 6244.18
     rank  6: 6244.28
     rank  7: 6244.23
     rank  8: 6243.95
     rank  9: 6243.88
     rank 10: 6243.94
     rank 11: 6243.93
     rank 12: 6244.00
     rank 13: 6244.11
     rank 14: 6243.94
     rank 15: 6244.02
     rank 16: 6244.19
     rank 17: 6243.79
     rank 18: 6244.10
     rank 19: 6243.86
  forward-compute:
     rank  0: 1390.20
     rank  1: 1387.76
     rank  2: 1429.89
     rank  3: 1426.55
     rank  4: 2334.96
     rank  5: 2340.71
     rank  6: 2279.92
     rank  7: 2271.28
     rank  8: 2098.88
     rank  9: 2091.28
     rank 10: 2106.66
     rank 11: 2101.46
     rank 12: 2197.58
     rank 13: 2207.10
     rank 14: 2081.31
     rank 15: 2078.77
     rank 16: 2202.08
     rank 17: 2214.73
     rank 18: 2550.72
     rank 19: 2551.23
  backward-compute:
     rank  0: 1248.49
     rank  1: 1258.56
     rank  2: 1268.36
     rank  3: 1263.60
     rank  4: 2587.09
     rank  5: 2580.67
     rank  6: 2625.48
     rank  7: 2625.76
     rank  8: 2491.16
     rank  9: 2506.60
     rank 10: 2488.39
     rank 11: 2487.53
     rank 12: 2288.16
     rank 13: 2293.83
     rank 14: 2154.21
     rank 15: 2152.96
     rank 16: 2333.60
     rank 17: 2336.72
     rank 18: 2334.25
     rank 19: 2337.46
  pure-backward-compute:
     rank  0: 1247.64
     rank  1: 1257.72
     rank  2: 1267.56
     rank  3: 1262.85
     rank  4: 2585.59
     rank  5: 2579.70
     rank  6: 2624.49
     rank  7: 2624.79
     rank  8: 2489.55
     rank  9: 2504.89
     rank 10: 2486.25
     rank 11: 2485.80
     rank 12: 2285.66
     rank 13: 2291.94
     rank 14: 2152.08
     rank 15: 2151.01
     rank 16: 2329.78
     rank 17: 2334.25
     rank 18: 2330.58
     rank 19: 2334.32
  batch-generator:
     rank  0: 69.11
     rank  1: 65.37
     rank  2: 70.25
     rank  3: 68.92
     rank  4: 82.99
     rank  5: 87.00
     rank  6: 51.13
     rank  7: 44.33
     rank  8: 50.87
     rank  9: 46.23
     rank 10: 57.95
     rank 11: 50.24
     rank 12: 72.56
     rank 13: 82.19
     rank 14: 81.83
     rank 15: 84.66
     rank 16: 65.81
     rank 17: 78.76
     rank 18: 59.21
     rank 19: 61.97
  forward-recv:
     rank  4: 86.29
     rank  5: 85.85
     rank  6: 86.52
     rank  7: 85.96
     rank  8: 254.84
     rank  9: 255.23
     rank 10: 251.69
     rank 11: 253.47
     rank 12: 375.84
     rank 13: 375.87
     rank 14: 386.80
     rank 15: 387.52
     rank 16: 508.93
     rank 17: 508.80
     rank 18: 498.30
     rank 19: 497.86
  forward-send:
     rank  0: 183.99
     rank  1: 184.98
     rank  2: 181.45
     rank  3: 182.98
     rank  4: 14.19
     rank  5: 14.63
     rank  6: 12.68
     rank  7: 14.16
     rank  8: 10.69
     rank  9: 10.76
     rank 10: 11.09
     rank 11: 11.02
     rank 12: 3.04
     rank 13: 2.86
     rank 14: 2.68
     rank 15: 2.31
  backward-recv:
     rank  0: 896.82
     rank  1: 893.20
     rank  2: 943.88
     rank  3: 944.18
     rank  4: 394.16
     rank  5: 396.04
     rank  6: 444.46
     rank  7: 443.39
     rank  8: 265.51
     rank  9: 264.50
     rank 10: 313.55
     rank 11: 313.15
     rank 12: 144.73
     rank 13: 145.98
     rank 14: 174.75
     rank 15: 174.01
  backward-send:
     rank  4: 1.75
     rank  5: 1.23
     rank  6: 1.56
     rank  7: 1.56
     rank  8: 8.06
     rank  9: 7.68
     rank 10: 7.75
     rank 11: 7.68
     rank 12: 5.15
     rank 13: 4.36
     rank 14: 5.67
     rank 15: 5.15
     rank 16: 5.25
     rank 17: 5.10
     rank 18: 4.89
     rank 19: 3.78
  forward-send-backward-recv:
     rank  0: 2279.89
     rank  1: 2274.31
     rank  2: 2166.77
     rank  3: 2174.46
     rank  4: 492.09
     rank  5: 491.76
     rank  6: 461.73
     rank  7: 464.60
     rank  8: 404.13
     rank  9: 392.39
     rank 10: 374.27
     rank 11: 376.25
     rank 12: 272.67
     rank 13: 264.05
     rank 14: 650.61
     rank 15: 654.84
  backward-send-forward-recv:
     rank  4: 14.89
     rank  5: 12.14
     rank  6: 7.62
     rank  7: 8.40
     rank  8: 230.11
     rank  9: 237.24
     rank 10: 201.03
     rank 11: 206.11
     rank 12: 319.26
     rank 13: 310.34
     rank 14: 142.41
     rank 15: 142.50
     rank 16: 414.26
     rank 17: 401.37
     rank 18: 73.71
     rank 19: 72.68
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.05
     rank 14: 0.03
     rank 15: 0.03
     rank 16: 0.13
     rank 17: 0.02
     rank 18: 0.03
     rank 19: 0.04
  embedding-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.06
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.03
     rank 16: 0.21
     rank 17: 0.06
     rank 18: 0.08
     rank 19: 0.10
  all-grads-sync:
     rank  0: 228.73
     rank  1: 217.85
     rank  2: 228.58
     rank  3: 217.72
     rank  4: 39.04
     rank  5: 39.13
     rank  6: 39.02
     rank  7: 39.13
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.13
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.03
     rank 16: 0.05
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.06
  optimizer-copy-to-main-grad:
     rank  0: 0.20
     rank  1: 0.22
     rank  2: 0.21
     rank  3: 0.22
     rank  4: 0.04
     rank  5: 0.04
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.03
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.02
     rank 19: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.02
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 27.56
     rank  1: 27.43
     rank  2: 27.81
     rank  3: 27.42
     rank  4: 5.12
     rank  5: 5.14
     rank  6: 5.08
     rank  7: 5.13
     rank  8: 0.03
     rank  9: 0.07
     rank 10: 0.05
     rank 11: 0.08
     rank 12: 0.08
     rank 13: 0.13
     rank 14: 0.04
     rank 15: 0.12
     rank 16: 0.12
     rank 17: 0.06
     rank 18: 0.12
     rank 19: 0.11
  optimizer:
     rank  0: 28.46
     rank  1: 28.32
     rank  2: 28.70
     rank  3: 28.30
     rank  4: 6.01
     rank  5: 6.02
     rank  6: 5.96
     rank  7: 6.02
     rank  8: 0.92
     rank  9: 0.95
     rank 10: 0.94
     rank 11: 0.97
     rank 12: 0.96
     rank 13: 1.00
     rank 14: 0.92
     rank 15: 1.00
     rank 16: 1.00
     rank 17: 0.94
     rank 18: 1.02
     rank 19: 1.00
 [2024-12-31 13:13:36] iteration        4/      10 | consumed samples:          128 | elapsed time per iteration (ms): 6291.0 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 7.040555E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 6225.87
     rank  1: 6225.67
     rank  2: 6225.82
     rank  3: 6225.72
     rank  4: 6223.61
     rank  5: 6223.44
     rank  6: 6223.59
     rank  7: 6223.49
     rank  8: 6223.28
     rank  9: 6223.13
     rank 10: 6223.27
     rank 11: 6223.16
     rank 12: 6223.34
     rank 13: 6223.29
     rank 14: 6223.31
     rank 15: 6223.24
     rank 16: 6223.65
     rank 17: 6223.18
     rank 18: 6223.55
     rank 19: 6223.13
  forward-compute:
     rank  0: 1415.84
     rank  1: 1411.90
     rank  2: 1429.90
     rank  3: 1426.98
     rank  4: 2307.64
     rank  5: 2307.62
     rank  6: 2316.91
     rank  7: 2315.03
     rank  8: 2108.50
     rank  9: 2103.82
     rank 10: 2116.12
     rank 11: 2116.31
     rank 12: 2199.27
     rank 13: 2204.95
     rank 14: 2080.68
     rank 15: 2082.03
     rank 16: 2210.43
     rank 17: 2215.70
     rank 18: 2506.56
     rank 19: 2507.89
  backward-compute:
     rank  0: 1260.81
     rank  1: 1264.21
     rank  2: 1263.69
     rank  3: 1266.20
     rank  4: 2582.42
     rank  5: 2580.01
     rank  6: 2609.13
     rank  7: 2608.77
     rank  8: 2495.07
     rank  9: 2506.80
     rank 10: 2489.92
     rank 11: 2493.80
     rank 12: 2286.57
     rank 13: 2289.84
     rank 14: 2161.35
     rank 15: 2158.87
     rank 16: 2339.56
     rank 17: 2342.23
     rank 18: 2350.98
     rank 19: 2350.91
  pure-backward-compute:
     rank  0: 1260.05
     rank  1: 1263.37
     rank  2: 1262.93
     rank  3: 1265.48
     rank  4: 2581.44
     rank  5: 2579.03
     rank  6: 2607.70
     rank  7: 2607.53
     rank  8: 2493.59
     rank  9: 2505.16
     rank 10: 2488.20
     rank 11: 2492.32
     rank 12: 2284.66
     rank 13: 2287.02
     rank 14: 2158.48
     rank 15: 2157.01
     rank 16: 2335.85
     rank 17: 2340.00
     rank 18: 2347.69
     rank 19: 2348.02
  batch-generator:
     rank  0: 70.16
     rank  1: 64.39
     rank  2: 70.06
     rank  3: 68.55
     rank  4: 70.08
     rank  5: 66.34
     rank  6: 65.05
     rank  7: 69.91
     rank  8: 51.75
     rank  9: 47.79
     rank 10: 60.59
     rank 11: 55.66
     rank 12: 57.54
     rank 13: 73.02
     rank 14: 80.50
     rank 15: 86.36
     rank 16: 63.69
     rank 17: 69.31
     rank 18: 58.14
     rank 19: 61.05
  forward-recv:
     rank  4: 87.95
     rank  5: 87.96
     rank  6: 89.83
     rank  7: 89.79
     rank  8: 247.52
     rank  9: 250.38
     rank 10: 250.63
     rank 11: 250.72
     rank 12: 373.54
     rank 13: 373.31
     rank 14: 385.82
     rank 15: 386.13
     rank 16: 509.83
     rank 17: 509.78
     rank 18: 499.83
     rank 19: 499.54
  forward-send:
     rank  0: 167.12
     rank  1: 169.82
     rank  2: 171.07
     rank  3: 171.44
     rank  4: 10.99
     rank  5: 12.99
     rank  6: 11.74
     rank  7: 11.97
     rank  8: 11.68
     rank  9: 10.83
     rank 10: 9.38
     rank 11: 9.33
     rank 12: 2.95
     rank 13: 2.77
     rank 14: 2.94
     rank 15: 2.78
  backward-recv:
     rank  0: 885.60
     rank  1: 884.40
     rank  2: 884.36
     rank  3: 884.15
     rank  4: 397.71
     rank  5: 397.32
     rank  6: 390.39
     rank  7: 389.44
     rank  8: 263.55
     rank  9: 263.27
     rank 10: 263.55
     rank 11: 264.89
     rank 12: 144.10
     rank 13: 144.09
     rank 14: 166.50
     rank 15: 166.86
  backward-send:
     rank  4: 1.31
     rank  5: 1.53
     rank  6: 1.52
     rank  7: 1.57
     rank  8: 8.01
     rank  9: 7.75
     rank 10: 8.35
     rank 11: 7.57
     rank 12: 5.53
     rank 13: 5.15
     rank 14: 5.45
     rank 15: 5.57
     rank 16: 5.40
     rank 17: 4.98
     rank 18: 5.19
     rank 19: 5.13
  forward-send-backward-recv:
     rank  0: 2256.92
     rank  1: 2254.96
     rank  2: 2227.14
     rank  3: 2228.36
     rank  4: 509.17
     rank  5: 509.92
     rank  6: 472.14
     rank  7: 472.43
     rank  8: 420.87
     rank  9: 410.31
     rank 10: 339.09
     rank 11: 336.39
     rank 12: 284.98
     rank 13: 279.86
     rank 14: 381.03
     rank 15: 382.72
  backward-send-forward-recv:
     rank  4: 12.39
     rank  5: 11.69
     rank  6: 9.88
     rank  7: 10.08
     rank  8: 192.78
     rank  9: 194.89
     rank 10: 260.68
     rank 11: 261.10
     rank 12: 294.13
     rank 13: 286.79
     rank 14: 397.20
     rank 15: 396.99
     rank 16: 380.93
     rank 17: 375.52
     rank 18: 84.61
     rank 19: 83.97
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.04
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.04
     rank 14: 0.03
     rank 15: 0.03
     rank 16: 0.13
     rank 17: 0.06
     rank 18: 0.04
     rank 19: 0.05
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.04
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.04
     rank 14: 0.03
     rank 15: 0.03
     rank 16: 0.23
     rank 17: 0.09
     rank 18: 0.09
     rank 19: 0.10
  all-grads-sync:
     rank  0: 221.44
     rank  1: 212.11
     rank  2: 221.54
     rank  3: 212.17
     rank  4: 40.35
     rank  5: 40.46
     rank  6: 40.39
     rank  7: 40.50
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.06
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.10
     rank 17: 0.02
     rank 18: 0.03
     rank 19: 0.05
  optimizer-copy-to-main-grad:
     rank  0: 0.21
     rank  1: 0.22
     rank  2: 0.21
     rank  3: 0.22
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
     rank 16: 0.03
     rank 17: 0.03
     rank 18: 0.03
     rank 19: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.02
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 27.49
     rank  1: 27.49
     rank  2: 27.31
     rank  3: 27.29
     rank  4: 5.06
     rank  5: 5.05
     rank  6: 5.07
     rank  7: 5.06
     rank  8: 0.03
     rank  9: 0.07
     rank 10: 0.06
     rank 11: 0.07
     rank 12: 0.06
     rank 13: 0.12
     rank 14: 0.10
     rank 15: 0.06
     rank 16: 0.14
     rank 17: 0.11
     rank 18: 0.11
     rank 19: 0.11
  optimizer:
     rank  0: 28.44
     rank  1: 28.44
     rank  2: 28.54
     rank  3: 28.22
     rank  4: 6.00
     rank  5: 6.00
     rank  6: 6.01
     rank  7: 6.01
     rank  8: 0.98
     rank  9: 1.01
     rank 10: 1.00
     rank 11: 1.01
     rank 12: 1.01
     rank 13: 1.07
     rank 14: 1.04
     rank 15: 1.00
     rank 16: 1.08
     rank 17: 1.05
     rank 18: 1.05
     rank 19: 1.05
 [2024-12-31 13:13:43] iteration        5/      10 | consumed samples:          160 | elapsed time per iteration (ms): 6306.0 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 6.318552E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 6241.34
     rank  1: 6241.09
     rank  2: 6241.31
     rank  3: 6241.17
     rank  4: 6239.11
     rank  5: 6238.98
     rank  6: 6239.08
     rank  7: 6239.03
     rank  8: 6238.85
     rank  9: 6238.67
     rank 10: 6238.78
     rank 11: 6238.72
     rank 12: 6238.82
     rank 13: 6238.71
     rank 14: 6238.96
     rank 15: 6238.86
     rank 16: 6239.07
     rank 17: 6238.58
     rank 18: 6238.96
     rank 19: 6238.59
  forward-compute:
     rank  0: 1414.76
     rank  1: 1412.57
     rank  2: 1422.95
     rank  3: 1421.36
     rank  4: 2308.66
     rank  5: 2308.35
     rank  6: 2285.32
     rank  7: 2283.24
     rank  8: 2118.16
     rank  9: 2114.03
     rank 10: 2111.11
     rank 11: 2107.72
     rank 12: 2213.32
     rank 13: 2218.93
     rank 14: 2073.24
     rank 15: 2071.91
     rank 16: 2219.86
     rank 17: 2233.31
     rank 18: 2511.55
     rank 19: 2514.90
  backward-compute:
     rank  0: 1252.98
     rank  1: 1256.51
     rank  2: 1266.08
     rank  3: 1267.89
     rank  4: 2578.71
     rank  5: 2577.07
     rank  6: 2606.91
     rank  7: 2599.87
     rank  8: 2501.13
     rank  9: 2512.97
     rank 10: 2493.22
     rank 11: 2494.86
     rank 12: 2301.71
     rank 13: 2310.26
     rank 14: 2167.91
     rank 15: 2170.33
     rank 16: 2349.99
     rank 17: 2353.16
     rank 18: 2362.48
     rank 19: 2364.09
  pure-backward-compute:
     rank  0: 1252.24
     rank  1: 1255.70
     rank  2: 1265.32
     rank  3: 1267.13
     rank  4: 2577.50
     rank  5: 2575.95
     rank  6: 2605.85
     rank  7: 2598.58
     rank  8: 2499.20
     rank  9: 2511.33
     rank 10: 2491.30
     rank 11: 2493.32
     rank 12: 2299.66
     rank 13: 2308.17
     rank 14: 2165.89
     rank 15: 2167.39
     rank 16: 2346.51
     rank 17: 2350.84
     rank 18: 2359.23
     rank 19: 2361.13
  batch-generator:
     rank  0: 69.59
     rank  1: 64.90
     rank  2: 68.67
     rank  3: 68.69
     rank  4: 66.23
     rank  5: 67.46
     rank  6: 54.57
     rank  7: 58.13
     rank  8: 57.90
     rank  9: 54.45
     rank 10: 54.17
     rank 11: 48.26
     rank 12: 66.52
     rank 13: 73.90
     rank 14: 68.86
     rank 15: 72.14
     rank 16: 66.08
     rank 17: 78.84
     rank 18: 58.77
     rank 19: 63.90
  forward-recv:
     rank  4: 85.00
     rank  5: 85.13
     rank  6: 85.53
     rank  7: 85.53
     rank  8: 247.54
     rank  9: 249.57
     rank 10: 246.88
     rank 11: 247.11
     rank 12: 372.90
     rank 13: 371.96
     rank 14: 383.81
     rank 15: 383.82
     rank 16: 506.72
     rank 17: 506.39
     rank 18: 497.60
     rank 19: 497.44
  forward-send:
     rank  0: 180.41
     rank  1: 181.30
     rank  2: 182.19
     rank  3: 182.21
     rank  4: 14.59
     rank  5: 15.28
     rank  6: 14.85
     rank  7: 15.19
     rank  8: 11.27
     rank  9: 10.34
     rank 10: 9.45
     rank 11: 9.49
     rank 12: 2.99
     rank 13: 2.67
     rank 14: 2.87
     rank 15: 2.87
  backward-recv:
     rank  0: 885.70
     rank  1: 884.44
     rank  2: 922.87
     rank  3: 921.67
     rank  4: 403.80
     rank  5: 403.85
     rank  6: 432.51
     rank  7: 432.71
     rank  8: 269.23
     rank  9: 269.36
     rank 10: 313.39
     rank 11: 313.40
     rank 12: 146.49
     rank 13: 146.69
     rank 14: 180.80
     rank 15: 180.15
  backward-send:
     rank  4: 1.57
     rank  5: 1.45
     rank  6: 1.39
     rank  7: 1.60
     rank  8: 7.99
     rank  9: 7.62
     rank 10: 8.19
     rank 11: 8.06
     rank 12: 5.69
     rank 13: 5.28
     rank 14: 5.55
     rank 15: 5.21
     rank 16: 5.29
     rank 17: 5.29
     rank 18: 4.74
     rank 19: 4.20
  forward-send-backward-recv:
     rank  0: 2258.73
     rank  1: 2257.52
     rank  2: 2189.11
     rank  3: 2190.63
     rank  4: 509.60
     rank  5: 509.68
     rank  6: 473.64
     rank  7: 476.56
     rank  8: 420.22
     rank  9: 408.81
     rank 10: 347.39
     rank 11: 346.63
     rank 12: 284.97
     rank 13: 276.79
     rank 14: 566.17
     rank 15: 561.27
  backward-send-forward-recv:
     rank  4: 14.35
     rank  5: 14.43
     rank  6: 9.26
     rank  7: 10.23
     rank  8: 179.43
     rank  9: 183.51
     rank 10: 216.85
     rank 11: 220.80
     rank 12: 269.91
     rank 13: 264.87
     rank 14: 208.29
     rank 15: 208.61
     rank 16: 371.78
     rank 17: 357.91
     rank 18: 76.21
     rank 19: 72.87
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.04
     rank  8: 0.05
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.04
     rank 12: 0.03
     rank 13: 0.08
     rank 14: 0.05
     rank 15: 0.06
     rank 16: 0.13
     rank 17: 0.02
     rank 18: 0.03
     rank 19: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.09
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
     rank 16: 0.20
     rank 17: 0.06
     rank 18: 0.07
     rank 19: 0.07
  all-grads-sync:
     rank  0: 230.82
     rank  1: 220.76
     rank  2: 230.68
     rank  3: 220.85
     rank  4: 40.97
     rank  5: 41.00
     rank  6: 40.93
     rank  7: 40.83
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.04
     rank 12: 0.06
     rank 13: 0.02
     rank 14: 0.04
     rank 15: 0.02
     rank 16: 0.04
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.03
  optimizer-copy-to-main-grad:
     rank  0: 0.20
     rank  1: 0.21
     rank  2: 0.20
     rank  3: 0.22
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.04
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.03
     rank 16: 0.04
     rank 17: 0.02
     rank 18: 0.03
     rank 19: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 27.44
     rank  1: 27.61
     rank  2: 27.69
     rank  3: 27.33
     rank  4: 5.06
     rank  5: 5.05
     rank  6: 5.06
     rank  7: 5.19
     rank  8: 0.05
     rank  9: 0.07
     rank 10: 0.08
     rank 11: 0.08
     rank 12: 0.04
     rank 13: 0.16
     rank 14: 0.07
     rank 15: 0.12
     rank 16: 0.12
     rank 17: 0.04
     rank 18: 0.11
     rank 19: 0.10
  optimizer:
     rank  0: 28.26
     rank  1: 28.45
     rank  2: 28.53
     rank  3: 28.18
     rank  4: 5.89
     rank  5: 5.88
     rank  6: 5.89
     rank  7: 6.02
     rank  8: 0.88
     rank  9: 0.90
     rank 10: 0.91
     rank 11: 0.91
     rank 12: 0.87
     rank 13: 0.99
     rank 14: 0.92
     rank 15: 0.94
     rank 16: 0.94
     rank 17: 0.87
     rank 18: 0.94
     rank 19: 0.93
 [2024-12-31 13:13:49] iteration        6/      10 | consumed samples:          192 | elapsed time per iteration (ms): 6295.3 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 5.493996E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 6230.94
     rank  1: 6230.79
     rank  2: 6230.90
     rank  3: 6230.84
     rank  4: 6228.77
     rank  5: 6228.56
     rank  6: 6228.72
     rank  7: 6228.59
     rank  8: 6228.40
     rank  9: 6228.25
     rank 10: 6228.35
     rank 11: 6228.26
     rank 12: 6228.48
     rank 13: 6228.23
     rank 14: 6228.46
     rank 15: 6228.32
     rank 16: 6228.74
     rank 17: 6228.19
     rank 18: 6228.64
     rank 19: 6228.24
  forward-compute:
     rank  0: 1392.73
     rank  1: 1392.65
     rank  2: 1407.92
     rank  3: 1405.99
     rank  4: 2296.82
     rank  5: 2295.61
     rank  6: 2280.73
     rank  7: 2280.41
     rank  8: 2140.05
     rank  9: 2137.25
     rank 10: 2098.80
     rank 11: 2097.20
     rank 12: 2234.77
     rank 13: 2245.79
     rank 14: 2102.78
     rank 15: 2106.35
     rank 16: 2223.19
     rank 17: 2245.31
     rank 18: 2494.74
     rank 19: 2493.59
  backward-compute:
     rank  0: 1245.02
     rank  1: 1245.44
     rank  2: 1239.75
     rank  3: 1242.46
     rank  4: 2573.88
     rank  5: 2577.46
     rank  6: 2597.11
     rank  7: 2592.41
     rank  8: 2504.60
     rank  9: 2519.85
     rank 10: 2485.06
     rank 11: 2490.06
     rank 12: 2311.02
     rank 13: 2326.45
     rank 14: 2169.39
     rank 15: 2166.40
     rank 16: 2358.04
     rank 17: 2360.53
     rank 18: 2374.44
     rank 19: 2375.85
  pure-backward-compute:
     rank  0: 1244.27
     rank  1: 1244.66
     rank  2: 1238.99
     rank  3: 1241.72
     rank  4: 2572.78
     rank  5: 2576.39
     rank  6: 2596.18
     rank  7: 2591.44
     rank  8: 2502.20
     rank  9: 2518.34
     rank 10: 2483.34
     rank 11: 2488.16
     rank 12: 2308.35
     rank 13: 2324.46
     rank 14: 2166.59
     rank 15: 2163.79
     rank 16: 2354.54
     rank 17: 2358.31
     rank 18: 2371.36
     rank 19: 2372.99
  batch-generator:
     rank  0: 68.23
     rank  1: 66.00
     rank  2: 68.76
     rank  3: 67.60
     rank  4: 66.84
     rank  5: 63.57
     rank  6: 50.38
     rank  7: 53.77
     rank  8: 69.55
     rank  9: 66.94
     rank 10: 47.33
     rank 11: 45.73
     rank 12: 74.51
     rank 13: 86.69
     rank 14: 88.51
     rank 15: 96.26
     rank 16: 62.62
     rank 17: 85.70
     rank 18: 56.74
     rank 19: 57.27
  forward-recv:
     rank  4: 85.48
     rank  5: 85.27
     rank  6: 85.94
     rank  7: 85.99
     rank  8: 236.06
     rank  9: 236.93
     rank 10: 247.78
     rank 11: 247.81
     rank 12: 373.59
     rank 13: 372.34
     rank 14: 373.10
     rank 15: 372.35
     rank 16: 516.48
     rank 17: 515.41
     rank 18: 506.05
     rank 19: 505.81
  forward-send:
     rank  0: 174.94
     rank  1: 173.63
     rank  2: 173.41
     rank  3: 173.21
     rank  4: 14.97
     rank  5: 13.35
     rank  6: 10.35
     rank  7: 10.16
     rank  8: 16.17
     rank  9: 14.73
     rank 10: 8.72
     rank 11: 8.33
     rank 12: 3.98
     rank 13: 2.82
     rank 14: 3.09
     rank 15: 2.88
  backward-recv:
     rank  0: 893.91
     rank  1: 892.54
     rank  2: 929.87
     rank  3: 929.92
     rank  4: 406.06
     rank  5: 406.25
     rank  6: 431.63
     rank  7: 431.61
     rank  8: 268.82
     rank  9: 268.70
     rank 10: 303.34
     rank 11: 302.04
     rank 12: 145.58
     rank 13: 145.71
     rank 14: 173.07
     rank 15: 173.34
  backward-send:
     rank  4: 1.45
     rank  5: 1.54
     rank  6: 1.35
     rank  7: 1.34
     rank  8: 7.97
     rank  9: 7.27
     rank 10: 7.51
     rank 11: 8.03
     rank 12: 5.17
     rank 13: 4.76
     rank 14: 5.47
     rank 15: 5.02
     rank 16: 5.30
     rank 17: 4.86
     rank 18: 5.20
     rank 19: 5.12
  forward-send-backward-recv:
     rank  0: 2277.87
     rank  1: 2280.48
     rank  2: 2226.46
     rank  3: 2226.67
     rank  4: 520.36
     rank  5: 518.83
     rank  6: 488.81
     rank  7: 490.34
     rank  8: 423.85
     rank  9: 412.36
     rank 10: 423.95
     rank 11: 423.86
     rank 12: 282.81
     rank 13: 272.64
     rank 14: 675.41
     rank 15: 680.16
  backward-send-forward-recv:
     rank  4: 12.17
     rank  5: 12.44
     rank  6: 8.90
     rank  7: 9.09
     rank  8: 150.34
     rank  9: 155.66
     rank 10: 163.78
     rank 11: 166.07
     rank 12: 230.73
     rank 13: 222.56
     rank 14: 80.65
     rank 15: 78.20
     rank 16: 347.17
     rank 17: 325.48
     rank 18: 70.58
     rank 19: 71.10
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
     rank 16: 0.14
     rank 17: 0.02
     rank 18: 0.04
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.08
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.03
     rank 16: 0.20
     rank 17: 0.06
     rank 18: 0.10
     rank 19: 0.06
  all-grads-sync:
     rank  0: 228.53
     rank  1: 218.47
     rank  2: 228.39
     rank  3: 218.62
     rank  4: 39.59
     rank  5: 39.67
     rank  6: 39.64
     rank  7: 39.71
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
     rank 16: 0.06
     rank 17: 0.02
     rank 18: 0.04
     rank 19: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.19
     rank  1: 0.22
     rank  2: 0.20
     rank  3: 0.22
     rank  4: 0.04
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.04
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.03
     rank 17: 0.02
     rank 18: 0.03
     rank 19: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.02
     rank 19: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 27.55
     rank  1: 27.68
     rank  2: 27.25
     rank  3: 27.31
     rank  4: 5.17
     rank  5: 5.07
     rank  6: 5.07
     rank  7: 5.07
     rank  8: 0.07
     rank  9: 0.07
     rank 10: 0.03
     rank 11: 0.07
     rank 12: 0.14
     rank 13: 0.04
     rank 14: 0.08
     rank 15: 0.10
     rank 16: 0.12
     rank 17: 0.05
     rank 18: 0.11
     rank 19: 0.10
  optimizer:
     rank  0: 28.41
     rank  1: 28.54
     rank  2: 28.23
     rank  3: 28.53
     rank  4: 6.03
     rank  5: 5.92
     rank  6: 5.93
     rank  7: 5.92
     rank  8: 0.91
     rank  9: 0.92
     rank 10: 0.88
     rank 11: 0.92
     rank 12: 0.99
     rank 13: 0.89
     rank 14: 0.94
     rank 15: 0.95
     rank 16: 0.98
     rank 17: 0.90
     rank 18: 0.96
     rank 19: 0.96
 [2024-12-31 13:13:55] iteration        7/      10 | consumed samples:          224 | elapsed time per iteration (ms): 6261.6 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 4.895956E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 6194.81
     rank  1: 6194.68
     rank  2: 6194.88
     rank  3: 6194.72
     rank  4: 6192.59
     rank  5: 6192.47
     rank  6: 6192.62
     rank  7: 6192.50
     rank  8: 6192.23
     rank  9: 6192.10
     rank 10: 6192.26
     rank 11: 6192.12
     rank 12: 6192.70
     rank 13: 6192.20
     rank 14: 6192.58
     rank 15: 6192.20
     rank 16: 6192.33
     rank 17: 6192.09
     rank 18: 6192.41
     rank 19: 6192.13
  forward-compute:
     rank  0: 1404.47
     rank  1: 1402.20
     rank  2: 1407.96
     rank  3: 1405.50
     rank  4: 2270.40
     rank  5: 2261.75
     rank  6: 2252.29
     rank  7: 2248.74
     rank  8: 2116.74
     rank  9: 2112.19
     rank 10: 2093.15
     rank 11: 2089.91
     rank 12: 2232.68
     rank 13: 2236.82
     rank 14: 2105.42
     rank 15: 2111.31
     rank 16: 2264.19
     rank 17: 2264.82
     rank 18: 2441.58
     rank 19: 2443.39
  backward-compute:
     rank  0: 1252.57
     rank  1: 1248.45
     rank  2: 1251.76
     rank  3: 1251.44
     rank  4: 2578.02
     rank  5: 2580.47
     rank  6: 2601.85
     rank  7: 2597.95
     rank  8: 2499.08
     rank  9: 2511.95
     rank 10: 2480.84
     rank 11: 2488.03
     rank 12: 2326.42
     rank 13: 2324.32
     rank 14: 2170.46
     rank 15: 2168.12
     rank 16: 2365.78
     rank 17: 2370.25
     rank 18: 2394.83
     rank 19: 2397.60
  pure-backward-compute:
     rank  0: 1251.81
     rank  1: 1247.68
     rank  2: 1251.01
     rank  3: 1250.72
     rank  4: 2577.25
     rank  5: 2579.52
     rank  6: 2601.07
     rank  7: 2596.94
     rank  8: 2496.68
     rank  9: 2510.41
     rank 10: 2479.41
     rank 11: 2486.94
     rank 12: 2324.37
     rank 13: 2321.83
     rank 14: 2167.60
     rank 15: 2165.66
     rank 16: 2361.88
     rank 17: 2368.03
     rank 18: 2391.70
     rank 19: 2394.94
  batch-generator:
     rank  0: 69.35
     rank  1: 64.75
     rank  2: 72.58
     rank  3: 72.01
     rank  4: 47.49
     rank  5: 45.54
     rank  6: 42.29
     rank  7: 41.92
     rank  8: 55.75
     rank  9: 50.57
     rank 10: 49.39
     rank 11: 45.98
     rank 12: 58.26
     rank 13: 70.50
     rank 14: 88.25
     rank 15: 97.31
     rank 16: 79.91
     rank 17: 76.64
     rank 18: 57.80
     rank 19: 62.47
  forward-recv:
     rank  4: 85.84
     rank  5: 85.70
     rank  6: 86.23
     rank  7: 86.28
     rank  8: 247.54
     rank  9: 248.84
     rank 10: 251.88
     rank 11: 254.11
     rank 12: 373.02
     rank 13: 373.12
     rank 14: 380.39
     rank 15: 379.04
     rank 16: 507.90
     rank 17: 507.55
     rank 18: 497.64
     rank 19: 497.45
  forward-send:
     rank  0: 172.25
     rank  1: 173.37
     rank  2: 179.35
     rank  3: 179.61
     rank  4: 14.38
     rank  5: 15.31
     rank  6: 15.11
     rank  7: 15.38
     rank  8: 10.45
     rank  9: 10.22
     rank 10: 9.36
     rank 11: 7.49
     rank 12: 2.98
     rank 13: 2.72
     rank 14: 2.90
     rank 15: 2.69
  backward-recv:
     rank  0: 885.83
     rank  1: 885.04
     rank  2: 908.40
     rank  3: 909.44
     rank  4: 406.20
     rank  5: 405.39
     rank  6: 427.36
     rank  7: 425.70
     rank  8: 271.77
     rank  9: 270.79
     rank 10: 293.49
     rank 11: 294.49
     rank 12: 144.91
     rank 13: 143.51
     rank 14: 162.34
     rank 15: 162.78
  backward-send:
     rank  4: 1.05
     rank  5: 1.73
     rank  6: 1.26
     rank  7: 1.61
     rank  8: 7.92
     rank  9: 7.65
     rank 10: 7.91
     rank 11: 7.61
     rank 12: 5.03
     rank 13: 4.47
     rank 14: 5.34
     rank 15: 5.53
     rank 16: 5.34
     rank 17: 4.73
     rank 18: 3.72
     rank 19: 3.71
  forward-send-backward-recv:
     rank  0: 2233.68
     rank  1: 2240.27
     rank  2: 2194.56
     rank  3: 2196.32
     rank  4: 511.69
     rank  5: 512.38
     rank  6: 479.72
     rank  7: 481.32
     rank  8: 423.05
     rank  9: 411.13
     rank 10: 382.98
     rank 11: 379.00
     rank 12: 284.19
     rank 13: 279.61
     rank 14: 597.62
     rank 15: 605.64
  backward-send-forward-recv:
     rank  4: 9.41
     rank  5: 11.51
     rank  6: 7.77
     rank  7: 9.90
     rank  8: 138.58
     rank  9: 144.70
     rank 10: 184.50
     rank 11: 187.95
     rank 12: 192.16
     rank 13: 187.01
     rank 14: 120.82
     rank 15: 116.77
     rank 16: 268.18
     rank 17: 267.67
     rank 18: 76.89
     rank 19: 75.02
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.09
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.03
     rank 16: 0.03
     rank 17: 0.02
     rank 18: 0.04
     rank 19: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.06
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
     rank 16: 0.08
     rank 17: 0.06
     rank 18: 0.11
     rank 19: 0.06
  all-grads-sync:
     rank  0: 227.72
     rank  1: 218.58
     rank  2: 227.78
     rank  3: 218.61
     rank  4: 39.40
     rank  5: 39.45
     rank  6: 39.42
     rank  7: 39.47
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.14
     rank 13: 0.03
     rank 14: 0.04
     rank 15: 0.03
     rank 16: 0.03
     rank 17: 0.02
     rank 18: 0.03
     rank 19: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.20
     rank  1: 0.21
     rank  2: 0.27
     rank  3: 0.22
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.03
     rank 16: 0.03
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 27.49
     rank  1: 27.78
     rank  2: 27.82
     rank  3: 27.36
     rank  4: 5.06
     rank  5: 5.05
     rank  6: 5.06
     rank  7: 5.07
     rank  8: 0.07
     rank  9: 0.07
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.15
     rank 13: 0.11
     rank 14: 0.13
     rank 15: 0.09
     rank 16: 0.09
     rank 17: 0.08
     rank 18: 0.16
     rank 19: 0.10
  optimizer:
     rank  0: 28.47
     rank  1: 28.76
     rank  2: 28.80
     rank  3: 28.51
     rank  4: 6.04
     rank  5: 6.02
     rank  6: 6.03
     rank  7: 6.06
     rank  8: 1.04
     rank  9: 1.04
     rank 10: 1.00
     rank 11: 0.99
     rank 12: 1.13
     rank 13: 1.08
     rank 14: 1.10
     rank 15: 1.07
     rank 16: 1.06
     rank 17: 1.05
     rank 18: 1.13
     rank 19: 1.07
 [2024-12-31 13:14:02] iteration        8/      10 | consumed samples:          256 | elapsed time per iteration (ms): 6292.0 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 4.298904E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 6227.91
     rank  1: 6227.99
     rank  2: 6227.91
     rank  3: 6228.03
     rank  4: 6225.73
     rank  5: 6225.76
     rank  6: 6225.68
     rank  7: 6225.81
     rank  8: 6225.35
     rank  9: 6225.45
     rank 10: 6225.35
     rank 11: 6225.51
     rank 12: 6225.40
     rank 13: 6225.47
     rank 14: 6225.38
     rank 15: 6225.56
     rank 16: 6225.42
     rank 17: 6225.52
     rank 18: 6225.42
     rank 19: 6225.60
  forward-compute:
     rank  0: 1407.97
     rank  1: 1408.31
     rank  2: 1416.25
     rank  3: 1414.14
     rank  4: 2290.40
     rank  5: 2295.13
     rank  6: 2296.94
     rank  7: 2296.48
     rank  8: 2119.06
     rank  9: 2116.77
     rank 10: 2098.11
     rank 11: 2096.33
     rank 12: 2237.22
     rank 13: 2250.40
     rank 14: 2110.87
     rank 15: 2123.68
     rank 16: 2266.21
     rank 17: 2277.83
     rank 18: 2451.48
     rank 19: 2449.96
  backward-compute:
     rank  0: 1245.13
     rank  1: 1248.82
     rank  2: 1269.71
     rank  3: 1273.67
     rank  4: 2579.45
     rank  5: 2572.19
     rank  6: 2612.03
     rank  7: 2607.50
     rank  8: 2487.64
     rank  9: 2502.36
     rank 10: 2477.45
     rank 11: 2497.13
     rank 12: 2317.50
     rank 13: 2322.53
     rank 14: 2184.70
     rank 15: 2181.38
     rank 16: 2371.70
     rank 17: 2375.32
     rank 18: 2403.69
     rank 19: 2406.08
  pure-backward-compute:
     rank  0: 1244.32
     rank  1: 1248.01
     rank  2: 1268.95
     rank  3: 1272.93
     rank  4: 2578.28
     rank  5: 2571.22
     rank  6: 2611.15
     rank  7: 2606.72
     rank  8: 2486.44
     rank  9: 2501.25
     rank 10: 2476.09
     rank 11: 2495.72
     rank 12: 2315.69
     rank 13: 2320.69
     rank 14: 2182.61
     rank 15: 2178.77
     rank 16: 2367.74
     rank 17: 2373.22
     rank 18: 2400.63
     rank 19: 2403.68
  batch-generator:
     rank  0: 65.15
     rank  1: 64.36
     rank  2: 70.12
     rank  3: 68.53
     rank  4: 54.95
     rank  5: 64.22
     rank  6: 48.28
     rank  7: 54.94
     rank  8: 65.19
     rank  9: 61.55
     rank 10: 52.20
     rank 11: 49.26
     rank 12: 60.26
     rank 13: 76.43
     rank 14: 82.40
     rank 15: 107.10
     rank 16: 76.77
     rank 17: 83.28
     rank 18: 56.38
     rank 19: 56.28
  forward-recv:
     rank  4: 89.15
     rank  5: 88.86
     rank  6: 89.32
     rank  7: 89.32
     rank  8: 240.25
     rank  9: 242.88
     rank 10: 257.65
     rank 11: 258.03
     rank 12: 374.04
     rank 13: 373.39
     rank 14: 380.55
     rank 15: 380.95
     rank 16: 514.62
     rank 17: 512.75
     rank 18: 501.22
     rank 19: 500.97
  forward-send:
     rank  0: 173.52
     rank  1: 172.89
     rank  2: 180.63
     rank  3: 180.94
     rank  4: 10.60
     rank  5: 9.51
     rank  6: 9.78
     rank  7: 10.19
     rank  8: 18.39
     rank  9: 14.89
     rank 10: 8.09
     rank 11: 7.86
     rank 12: 3.57
     rank 13: 2.15
     rank 14: 2.89
     rank 15: 2.62
  backward-recv:
     rank  0: 894.62
     rank  1: 893.06
     rank  2: 887.58
     rank  3: 887.14
     rank  4: 407.81
     rank  5: 409.68
     rank  6: 400.90
     rank  7: 401.55
     rank  8: 275.44
     rank  9: 275.44
     rank 10: 278.91
     rank 11: 278.83
     rank 12: 146.92
     rank 13: 147.38
     rank 14: 172.09
     rank 15: 172.56
  backward-send:
     rank  4: 1.51
     rank  5: 1.61
     rank  6: 1.37
     rank  7: 1.47
     rank  8: 8.04
     rank  9: 7.61
     rank 10: 7.76
     rank 11: 7.86
     rank 12: 5.54
     rank 13: 5.13
     rank 14: 5.61
     rank 15: 5.19
     rank 16: 5.31
     rank 17: 5.26
     rank 18: 4.91
     rank 19: 4.91
  forward-send-backward-recv:
     rank  0: 2261.06
     rank  1: 2259.94
     rank  2: 2226.99
     rank  3: 2222.43
     rank  4: 516.25
     rank  5: 517.33
     rank  6: 486.68
     rank  7: 488.77
     rank  8: 418.67
     rank  9: 408.92
     rank 10: 370.82
     rank 11: 355.93
     rank 12: 289.87
     rank 13: 283.41
     rank 14: 331.44
     rank 15: 335.37
  backward-send-forward-recv:
     rank  4: 13.41
     rank  5: 13.91
     rank  6: 10.16
     rank  7: 10.49
     rank  8: 179.25
     rank  9: 182.65
     rank 10: 239.05
     rank 11: 240.80
     rank 12: 220.08
     rank 13: 209.33
     rank 14: 395.80
     rank 15: 382.23
     rank 16: 289.12
     rank 17: 279.21
     rank 18: 87.69
     rank 19: 88.97
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.03
     rank 16: 0.03
     rank 17: 0.03
     rank 18: 0.03
     rank 19: 0.06
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.07
     rank  5: 0.05
     rank  6: 0.06
     rank  7: 0.05
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.03
     rank 16: 0.07
     rank 17: 0.06
     rank 18: 0.07
     rank 19: 0.09
  all-grads-sync:
     rank  0: 226.65
     rank  1: 217.09
     rank  2: 226.70
     rank  3: 217.19
     rank  4: 40.02
     rank  5: 40.09
     rank  6: 40.06
     rank  7: 40.08
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.03
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.22
     rank  1: 0.22
     rank  2: 0.22
     rank  3: 0.23
     rank  4: 0.04
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.04
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 27.58
     rank  1: 27.62
     rank  2: 27.32
     rank  3: 27.50
     rank  4: 5.13
     rank  5: 5.05
     rank  6: 5.14
     rank  7: 5.12
     rank  8: 0.06
     rank  9: 0.03
     rank 10: 0.04
     rank 11: 0.07
     rank 12: 0.09
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.11
     rank 16: 0.04
     rank 17: 0.06
     rank 18: 0.04
     rank 19: 0.11
  optimizer:
     rank  0: 28.42
     rank  1: 28.45
     rank  2: 28.25
     rank  3: 28.34
     rank  4: 5.96
     rank  5: 5.88
     rank  6: 5.97
     rank  7: 5.95
     rank  8: 0.88
     rank  9: 0.85
     rank 10: 0.86
     rank 11: 0.89
     rank 12: 0.92
     rank 13: 0.87
     rank 14: 0.86
     rank 15: 0.93
     rank 16: 0.87
     rank 17: 0.88
     rank 18: 0.86
     rank 19: 0.93
 [2024-12-31 13:14:08] iteration        9/      10 | consumed samples:          288 | elapsed time per iteration (ms): 6297.1 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 4.112834E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 6228.50
     rank  1: 6228.44
     rank  2: 6228.55
     rank  3: 6228.48
     rank  4: 6226.27
     rank  5: 6226.24
     rank  6: 6226.31
     rank  7: 6226.28
     rank  8: 6226.59
     rank  9: 6225.89
     rank 10: 6226.36
     rank 11: 6225.92
     rank 12: 6226.17
     rank 13: 6225.98
     rank 14: 6226.12
     rank 15: 6225.92
     rank 16: 6226.01
     rank 17: 6225.90
     rank 18: 6226.13
     rank 19: 6225.92
  forward-compute:
     rank  0: 1452.27
     rank  1: 1452.91
     rank  2: 1452.03
     rank  3: 1445.83
     rank  4: 2282.89
     rank  5: 2287.76
     rank  6: 2288.74
     rank  7: 2282.05
     rank  8: 2106.67
     rank  9: 2099.77
     rank 10: 2100.02
     rank 11: 2094.81
     rank 12: 2243.26
     rank 13: 2250.70
     rank 14: 2104.42
     rank 15: 2113.52
     rank 16: 2275.85
     rank 17: 2283.87
     rank 18: 2402.97
     rank 19: 2403.04
  backward-compute:
     rank  0: 1252.94
     rank  1: 1255.40
     rank  2: 1276.75
     rank  3: 1276.88
     rank  4: 2588.87
     rank  5: 2578.72
     rank  6: 2617.64
     rank  7: 2615.02
     rank  8: 2487.81
     rank  9: 2497.56
     rank 10: 2476.03
     rank 11: 2486.90
     rank 12: 2323.33
     rank 13: 2326.46
     rank 14: 2184.07
     rank 15: 2181.81
     rank 16: 2373.16
     rank 17: 2377.09
     rank 18: 2437.19
     rank 19: 2440.31
  pure-backward-compute:
     rank  0: 1252.12
     rank  1: 1254.53
     rank  2: 1275.99
     rank  3: 1276.13
     rank  4: 2587.92
     rank  5: 2577.89
     rank  6: 2616.72
     rank  7: 2614.16
     rank  8: 2486.62
     rank  9: 2496.32
     rank 10: 2474.29
     rank 11: 2485.68
     rank 12: 2321.18
     rank 13: 2324.35
     rank 14: 2181.79
     rank 15: 2179.99
     rank 16: 2369.83
     rank 17: 2375.00
     rank 18: 2434.03
     rank 19: 2437.91
  batch-generator:
     rank  0: 69.02
     rank  1: 67.83
     rank  2: 66.38
     rank  3: 62.72
     rank  4: 52.58
     rank  5: 58.95
     rank  6: 52.84
     rank  7: 49.24
     rank  8: 51.24
     rank  9: 46.21
     rank 10: 53.62
     rank 11: 47.11
     rank 12: 58.87
     rank 13: 69.55
     rank 14: 78.77
     rank 15: 98.95
     rank 16: 68.81
     rank 17: 73.47
     rank 18: 57.71
     rank 19: 59.37
  forward-recv:
     rank  4: 85.72
     rank  5: 85.67
     rank  6: 85.30
     rank  7: 85.54
     rank  8: 250.50
     rank  9: 252.84
     rank 10: 250.48
     rank 11: 255.25
     rank 12: 374.05
     rank 13: 373.61
     rank 14: 379.17
     rank 15: 378.26
     rank 16: 511.61
     rank 17: 510.95
     rank 18: 498.46
     rank 19: 498.07
  forward-send:
     rank  0: 177.08
     rank  1: 177.75
     rank  2: 173.48
     rank  3: 177.33
     rank  4: 10.47
     rank  5: 10.94
     rank  6: 8.55
     rank  7: 11.24
     rank  8: 12.30
     rank  9: 10.60
     rank 10: 8.48
     rank 11: 6.83
     rank 12: 3.14
     rank 13: 2.53
     rank 14: 2.81
     rank 15: 2.58
  backward-recv:
     rank  0: 893.88
     rank  1: 894.44
     rank  2: 880.28
     rank  3: 880.45
     rank  4: 409.87
     rank  5: 409.11
     rank  6: 395.95
     rank  7: 395.73
     rank  8: 275.34
     rank  9: 274.85
     rank 10: 269.21
     rank 11: 269.29
     rank 12: 147.99
     rank 13: 148.98
     rank 14: 167.23
     rank 15: 167.94
  backward-send:
     rank  4: 1.12
     rank  5: 1.57
     rank  6: 1.23
     rank  7: 1.34
     rank  8: 10.52
     rank  9: 10.07
     rank 10: 10.34
     rank 11: 10.07
     rank 12: 5.39
     rank 13: 4.85
     rank 14: 5.58
     rank 15: 5.12
     rank 16: 4.89
     rank 17: 5.32
     rank 18: 3.16
     rank 19: 3.13
  forward-send-backward-recv:
     rank  0: 2200.04
     rank  1: 2196.04
     rank  2: 2186.82
     rank  3: 2188.66
     rank  4: 510.65
     rank  5: 514.43
     rank  6: 490.34
     rank  7: 490.68
     rank  8: 426.88
     rank  9: 421.19
     rank 10: 398.11
     rank 11: 389.20
     rank 12: 285.89
     rank 13: 280.64
     rank 14: 370.15
     rank 15: 374.77
  backward-send-forward-recv:
     rank  4: 11.84
     rank  5: 11.68
     rank  6: 8.38
     rank  7: 9.26
     rank  8: 166.87
     rank  9: 173.25
     rank 10: 218.20
     rank 11: 221.63
     rank 12: 202.45
     rank 13: 195.75
     rank 14: 359.74
     rank 15: 352.21
     rank 16: 270.71
     rank 17: 262.47
     rank 18: 97.84
     rank 19: 97.34
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.05
     rank  9: 0.02
     rank 10: 0.04
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.08
     rank 15: 0.02
     rank 16: 0.03
     rank 17: 0.02
     rank 18: 0.04
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.07
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.02
     rank 16: 0.06
     rank 17: 0.06
     rank 18: 0.09
     rank 19: 0.06
  all-grads-sync:
     rank  0: 233.46
     rank  1: 222.23
     rank  2: 233.41
     rank  3: 222.11
     rank  4: 41.24
     rank  5: 41.29
     rank  6: 41.24
     rank  7: 41.30
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.03
     rank 19: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.21
     rank  1: 0.21
     rank  2: 0.21
     rank  3: 0.22
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.04
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.04
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.05
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.03
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 27.22
     rank  1: 27.60
     rank  2: 27.28
     rank  3: 27.53
     rank  4: 5.07
     rank  5: 5.12
     rank  6: 5.08
     rank  7: 5.08
     rank  8: 0.10
     rank  9: 0.08
     rank 10: 0.07
     rank 11: 0.07
     rank 12: 0.09
     rank 13: 0.10
     rank 14: 0.11
     rank 15: 0.04
     rank 16: 0.04
     rank 17: 0.08
     rank 18: 0.11
     rank 19: 0.10
  optimizer:
     rank  0: 30.31
     rank  1: 30.38
     rank  2: 30.03
     rank  3: 30.30
     rank  4: 7.83
     rank  5: 7.89
     rank  6: 7.85
     rank  7: 7.84
     rank  8: 2.90
     rank  9: 2.85
     rank 10: 2.83
     rank 11: 2.83
     rank 12: 2.86
     rank 13: 2.86
     rank 14: 2.88
     rank 15: 2.80
     rank 16: 2.80
     rank 17: 2.84
     rank 18: 2.87
     rank 19: 1.30
 [2024-12-31 13:14:14] iteration       10/      10 | consumed samples:          320 | elapsed time per iteration (ms): 6320.0 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 3.708066E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 6262.16
     rank  1: 6262.18
     rank  2: 6262.12
     rank  3: 6262.17
     rank  4: 6259.98
     rank  5: 6259.94
     rank  6: 6259.93
     rank  7: 6259.96
     rank  8: 6259.59
     rank  9: 6259.62
     rank 10: 6259.56
     rank 11: 6259.62
     rank 12: 6259.67
     rank 13: 6259.74
     rank 14: 6259.62
     rank 15: 6259.73
     rank 16: 6259.64
     rank 17: 6259.74
     rank 18: 6259.63
     rank 19: 6259.66
  forward-compute:
     rank  0: 1394.32
     rank  1: 1389.83
     rank  2: 1413.15
     rank  3: 1411.13
     rank  4: 2321.15
     rank  5: 2322.44
     rank  6: 2291.81
     rank  7: 2285.29
     rank  8: 2108.18
     rank  9: 2104.43
     rank 10: 2096.24
     rank 11: 2092.34
     rank 12: 2233.36
     rank 13: 2244.57
     rank 14: 2096.94
     rank 15: 2098.40
     rank 16: 2289.72
     rank 17: 2295.23
     rank 18: 2473.81
     rank 19: 2472.72
  backward-compute:
     rank  0: 1249.49
     rank  1: 1256.79
     rank  2: 1266.63
     rank  3: 1262.04
     rank  4: 2580.81
     rank  5: 2580.07
     rank  6: 2621.03
     rank  7: 2621.06
     rank  8: 2491.00
     rank  9: 2506.40
     rank 10: 2487.69
     rank 11: 2491.40
     rank 12: 2329.26
     rank 13: 2331.20
     rank 14: 2185.37
     rank 15: 2181.73
     rank 16: 2384.50
     rank 17: 2388.21
     rank 18: 2434.50
     rank 19: 2437.07
  pure-backward-compute:
     rank  0: 1248.70
     rank  1: 1255.97
     rank  2: 1265.84
     rank  3: 1261.31
     rank  4: 2579.37
     rank  5: 2579.01
     rank  6: 2620.23
     rank  7: 2620.15
     rank  8: 2489.21
     rank  9: 2505.33
     rank 10: 2486.41
     rank 11: 2490.14
     rank 12: 2327.60
     rank 13: 2329.42
     rank 14: 2183.21
     rank 15: 2179.55
     rank 16: 2380.74
     rank 17: 2386.09
     rank 18: 2431.36
     rank 19: 2434.78
  batch-generator:
     rank  0: 68.96
     rank  1: 63.39
     rank  2: 68.73
     rank  3: 68.35
     rank  4: 77.76
     rank  5: 76.56
     rank  6: 51.03
     rank  7: 49.73
     rank  8: 55.65
     rank  9: 54.08
     rank 10: 49.99
     rank 11: 46.22
     rank 12: 56.83
     rank 13: 70.56
     rank 14: 64.82
     rank 15: 76.14
     rank 16: 80.91
     rank 17: 82.22
     rank 18: 56.22
     rank 19: 56.68
  forward-recv:
     rank  4: 85.10
     rank  5: 85.05
     rank  6: 85.29
     rank  7: 85.55
     rank  8: 246.57
     rank  9: 249.67
     rank 10: 251.69
     rank 11: 251.61
     rank 12: 371.68
     rank 13: 371.71
     rank 14: 380.11
     rank 15: 380.70
     rank 16: 508.14
     rank 17: 508.00
     rank 18: 497.82
     rank 19: 497.58
  forward-send:
     rank  0: 174.67
     rank  1: 177.32
     rank  2: 178.38
     rank  3: 178.69
     rank  4: 13.44
     rank  5: 15.10
     rank  6: 14.68
     rank  7: 14.97
     rank  8: 11.74
     rank  9: 11.04
     rank 10: 9.52
     rank 11: 9.61
     rank 12: 2.93
     rank 13: 2.58
     rank 14: 2.92
     rank 15: 2.76
  backward-recv:
     rank  0: 907.35
     rank  1: 905.78
     rank  2: 932.95
     rank  3: 934.65
     rank  4: 416.15
     rank  5: 416.30
     rank  6: 443.13
     rank  7: 441.47
     rank  8: 282.93
     rank  9: 283.21
     rank 10: 304.51
     rank 11: 304.75
     rank 12: 153.25
     rank 13: 153.11
     rank 14: 176.65
     rank 15: 177.16
  backward-send:
     rank  4: 1.54
     rank  5: 1.38
     rank  6: 1.24
     rank  7: 1.41
     rank  8: 8.01
     rank  9: 7.52
     rank 10: 8.21
     rank 11: 7.40
     rank 12: 5.61
     rank 13: 5.31
     rank 14: 5.60
     rank 15: 5.21
     rank 16: 5.34
     rank 17: 4.91
     rank 18: 4.19
     rank 19: 4.11
  forward-send-backward-recv:
     rank  0: 2295.73
     rank  1: 2292.12
     rank  2: 2221.12
     rank  3: 2226.97
     rank  4: 513.25
     rank  5: 512.80
     rank  6: 478.27
     rank  7: 480.65
     rank  8: 422.59
     rank  9: 409.53
     rank 10: 455.34
     rank 11: 454.93
     rank 12: 291.65
     rank 13: 287.71
     rank 14: 713.82
     rank 15: 716.18
  backward-send-forward-recv:
     rank  4: 14.40
     rank  5: 12.20
     rank  6: 7.38
     rank  7: 8.10
     rank  8: 213.98
     rank  9: 216.82
     rank 10: 163.97
     rank 11: 167.94
     rank 12: 244.02
     rank 13: 232.49
     rank 14: 58.19
     rank 15: 56.11
     rank 16: 295.56
     rank 17: 289.79
     rank 18: 75.36
     rank 19: 76.07
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
     rank 16: 0.03
     rank 17: 0.04
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.07
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.03
     rank 16: 0.07
     rank 17: 0.10
     rank 18: 0.07
     rank 19: 0.06
  all-grads-sync:
     rank  0: 222.46
     rank  1: 212.10
     rank  2: 222.32
     rank  3: 212.25
     rank  4: 39.23
     rank  5: 39.34
     rank  6: 39.22
     rank  7: 39.32
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.03
     rank 17: 0.04
     rank 18: 0.02
     rank 19: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.20
     rank  1: 0.21
     rank  2: 0.20
     rank  3: 0.22
     rank  4: 0.04
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.04
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.03
     rank 16: 0.03
     rank 17: 0.02
     rank 18: 0.01
     rank 19: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 27.24
     rank  1: 27.60
     rank  2: 27.59
     rank  3: 27.50
     rank  4: 5.13
     rank  5: 5.05
     rank  6: 5.06
     rank  7: 5.14
     rank  8: 0.06
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.07
     rank 12: 0.04
     rank 13: 0.10
     rank 14: 0.04
     rank 15: 0.10
     rank 16: 0.09
     rank 17: 0.11
     rank 18: 0.04
     rank 19: 0.05
  optimizer:
     rank  0: 28.04
     rank  1: 28.40
     rank  2: 28.41
     rank  3: 28.31
     rank  4: 5.93
     rank  5: 5.85
     rank  6: 5.86
     rank  7: 5.94
     rank  8: 0.86
     rank  9: 0.83
     rank 10: 0.84
     rank 11: 0.87
     rank 12: 0.84
     rank 13: 0.91
     rank 14: 0.84
     rank 15: 0.90
     rank 16: 0.89
     rank 17: 0.91
     rank 18: 0.84
     rank 19: 0.85
