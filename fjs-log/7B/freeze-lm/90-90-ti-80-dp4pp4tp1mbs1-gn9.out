examples/multimodal/pretrain-freeze-llm-hete-3090first.sh: line 4: activate: No such file or directory
3
[2024-12-30 22:33:00,111] torch.distributed.run: [WARNING] 
[2024-12-30 22:33:00,111] torch.distributed.run: [WARNING] *****************************************
[2024-12-30 22:33:00,111] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-12-30 22:33:00,111] torch.distributed.run: [WARNING] *****************************************
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
> setting tensorboard ...
WARNING: one_logger package is required to enable e2e metrics tracking. please go to https://confluence.nvidia.com/display/MLWFO/Package+Repositories for details to install it
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
---Rank 15---Tensor Parallel Group GPUs: [0]
---Rank 14---Tensor Parallel Group GPUs: [0]---Rank 15---Pipeline Parallel Group GPUs: [3, 3, 3, 3]

---Rank 12---Tensor Parallel Group GPUs: [0]---Rank 13---Tensor Parallel Group GPUs: [0]

---Rank 14---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
---Rank 13---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
[rank15]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
---Rank 12---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
[rank14]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank13]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank12]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
 > number of parameters on (tensor, pipeline) model parallel rank (0, 3): 570445824
rank=1, worker=0: shard_range=[pretrain-2.tar[5000, 5100), pretrain-2.tar[5100, 5200), pretrain-2.tar[5200, 5300), ...<619>, pretrain-25.tar[7200, 7300), pretrain-25.tar[7300, 7400), pretrain-25.tar[7400, 7500)] sum(count)=62500
rank=1, worker=1: shard_range=[pretrain-25.tar[7500, 7600), pretrain-25.tar[7600, 7700), pretrain-25.tar[7700, 7800), ...<619>, pretrain-30.tar[9700, 9800), pretrain-30.tar[9800, 9900), pretrain-30.tar[9900, 10000)] sum(count)=62500
rank=2, worker=0: shard_range=[pretrain-31.tar[0, 100), pretrain-31.tar[100, 200), pretrain-31.tar[200, 300), ...<619>, pretrain-37.tar[2200, 2300), pretrain-37.tar[2300, 2400), pretrain-37.tar[2400, 2500)] sum(count)=62500
rank=2, worker=1: shard_range=[pretrain-37.tar[2500, 2600), pretrain-37.tar[2600, 2700), pretrain-37.tar[2700, 2800), ...<619>, pretrain-42.tar[4700, 4800), pretrain-42.tar[4800, 4900), pretrain-42.tar[4900, 5000)] sum(count)=62500
rank=0, worker=0: shard_range=[pretrain-0.tar[0, 100), pretrain-0.tar[100, 200), pretrain-0.tar[200, 300), ...<619>, pretrain-14.tar[2200, 2300), pretrain-14.tar[2300, 2400), pretrain-14.tar[2400, 2500)] sum(count)=62500
rank=0, worker=1: shard_range=[pretrain-14.tar[2500, 2600), pretrain-14.tar[2600, 2700), pretrain-14.tar[2700, 2800), ...<619>, pretrain-2.tar[4700, 4800), pretrain-2.tar[4800, 4900), pretrain-2.tar[4900, 5000)] sum(count)=62500
rank=3, worker=0: shard_range=[pretrain-42.tar[5000, 5100), pretrain-42.tar[5100, 5200), pretrain-42.tar[5200, 5300), ...<619>, pretrain-48.tar[7200, 7300), pretrain-48.tar[7300, 7400), pretrain-48.tar[7400, 7500)] sum(count)=62500
rank=3, worker=1: shard_range=[pretrain-48.tar[7500, 7600), pretrain-48.tar[7600, 7700), pretrain-48.tar[7700, 7800), ...<619>, pretrain-53.tar[9700, 9800), pretrain-53.tar[9800, 9900), pretrain-53.tar[9900, 10000)] sum(count)=62500
rank=3, worker=0: shard_range=[pretrain-8.tar[5468, 10000), pretrain-9.tar[0, 2734)] sum(count)=7266
rank=3, worker=1: shard_range=[pretrain-9.tar[2734, 10000)] sum(count)=7266
rank=0, worker=0: shard_range=[pretrain-54.tar[0, 7266)] sum(count)=7266
rank=0, worker=1: shard_range=[pretrain-54.tar[7266, 10000), pretrain-55.tar[0, 4532)] sum(count)=7266
rank=2, worker=0: shard_range=[pretrain-7.tar[936, 8202)] sum(count)=7266
rank=2, worker=1: shard_range=[pretrain-7.tar[8202, 10000), pretrain-8.tar[0, 5468)] sum(count)=7266
rank=1, worker=0: shard_range=[pretrain-55.tar[4532, 8128), pretrain-6.tar[0, 3670)] sum(count)=7266
rank=1, worker=1: shard_range=[pretrain-6.tar[3670, 10000), pretrain-7.tar[0, 936)] sum(count)=7266
times across ranks (ms):
  model-and-optimizer-setup:
     rank  0: 135.90
     rank  1: 137.70
     rank  2: 136.03
     rank  3: 137.96
     rank  4: 25.52
     rank  5: 27.62
     rank  6: 23.88
     rank  7: 24.96
     rank  8: 47.96
     rank  9: 48.19
     rank 10: 47.85
     rank 11: 47.37
     rank 12: 43.28
     rank 13: 43.88
     rank 14: 43.81
     rank 15: 45.74
  train/valid/test-data-iterators-setup:
     rank  0: 1201.69
     rank  1: 1201.78
     rank  2: 1201.60
     rank  3: 1241.41
     rank  4: 1248.75
     rank  5: 1248.58
     rank  6: 1248.56
     rank  7: 1248.70
     rank  8: 1254.01
     rank  9: 1344.29
     rank 10: 1248.75
     rank 11: 1344.14
     rank 12: 1343.99
     rank 13: 1344.00
     rank 14: 1344.00
     rank 15: 1344.10
 [2024-12-30 22:33:35] iteration        1/      10 | consumed samples:           32 | elapsed time per iteration (ms): 12985.2 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 7.274172E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
stage4 GPU utialization:29.370984164151277 %
[Rank 12] (after 1 iterations) memory (MB) | allocated: 2352.3310546875 | max allocated: 3308.34765625 | reserved: 3478.0 | max reserved: 3478.0
times across ranks (ms):
  forward-backward:
     rank  0: 12778.13
     rank  1: 12778.07
     rank  2: 12778.06
     rank  3: 12778.07
     rank  4: 12936.95
     rank  5: 12936.91
     rank  6: 12936.91
     rank  7: 12936.98
     rank  8: 12873.70
     rank  9: 12873.74
     rank 10: 12873.03
     rank 11: 12874.28
     rank 12: 12774.94
     rank 13: 12775.23
     rank 14: 12775.12
     rank 15: 12774.96
  forward-compute:
     rank  0: 3994.79
     rank  1: 4871.44
     rank  2: 4466.23
     rank  3: 4447.35
     rank  4: 3103.89
     rank  5: 2996.37
     rank  6: 2940.72
     rank  7: 2813.55
     rank  8: 2241.69
     rank  9: 2371.06
     rank 10: 2249.04
     rank 11: 2338.76
     rank 12: 3146.47
     rank 13: 2205.98
     rank 14: 2753.27
     rank 15: 2792.20
  backward-compute:
     rank  0: 1619.61
     rank  1: 1758.00
     rank  2: 1765.02
     rank  3: 1735.95
     rank  4: 957.21
     rank  5: 958.42
     rank  6: 948.12
     rank  7: 969.87
     rank  8: 973.58
     rank  9: 1025.00
     rank 10: 1034.59
     rank 11: 1031.07
     rank 12: 1006.34
     rank 13: 996.43
     rank 14: 997.31
     rank 15: 999.38
  pure-backward-compute:
     rank  0: 1619.04
     rank  1: 1757.43
     rank  2: 1764.58
     rank  3: 1735.60
     rank  4: 956.29
     rank  5: 957.56
     rank  6: 947.27
     rank  7: 968.82
     rank  8: 972.65
     rank  9: 1023.69
     rank 10: 1033.60
     rank 11: 1029.68
     rank 12: 1004.99
     rank 13: 995.05
     rank 14: 995.90
     rank 15: 998.04
  batch-generator:
     rank  0: 1036.29
     rank  1: 1119.28
     rank  2: 918.56
     rank  3: 1025.07
     rank  4: 1003.41
     rank  5: 950.72
     rank  6: 882.51
     rank  7: 1018.97
     rank  8: 1250.38
     rank  9: 1340.01
     rank 10: 1201.29
     rank 11: 1280.55
     rank 12: 1307.88
     rank 13: 962.37
     rank 14: 1022.59
     rank 15: 1024.98
  forward-recv:
     rank  4: 3385.65
     rank  5: 4273.29
     rank  6: 3855.70
     rank  7: 3895.55
     rank  8: 5605.96
     rank  9: 6389.75
     rank 10: 5935.06
     rank 11: 5834.70
     rank 12: 7045.87
     rank 13: 7917.59
     rank 14: 7332.82
     rank 15: 7325.08
  forward-send:
     rank  0: 3608.49
     rank  1: 3574.20
     rank  2: 3425.54
     rank  3: 3401.09
     rank  4: 1334.49
     rank  5: 1421.03
     rank  6: 1302.71
     rank  7: 1395.21
     rank  8: 25.94
     rank  9: 27.72
     rank 10: 19.11
     rank 11: 20.77
  backward-recv:
     rank  0: 443.78
     rank  1: 430.23
     rank  2: 421.69
     rank  3: 435.08
     rank  4: 278.38
     rank  5: 267.89
     rank  6: 274.05
     rank  7: 268.70
     rank  8: 144.19
     rank  9: 118.81
     rank 10: 126.32
     rank 11: 126.89
  backward-send:
     rank  4: 4.71
     rank  5: 5.97
     rank  6: 6.12
     rank  7: 6.44
     rank  8: 3.19
     rank  9: 5.61
     rank 10: 5.82
     rank 11: 6.53
     rank 12: 4.70
     rank 13: 4.35
     rank 14: 4.13
     rank 15: 4.68
  forward-send-backward-recv:
     rank  0: 2667.00
     rank  1: 1709.30
     rank  2: 2268.85
     rank  3: 2327.08
     rank  4: 2427.21
     rank  5: 1458.33
     rank  6: 2057.68
     rank  7: 2053.39
     rank  8: 2358.64
     rank  9: 1346.50
     rank 10: 1917.23
     rank 11: 1918.68
  backward-send-forward-recv:
     rank  4: 733.62
     rank  5: 853.32
     rank  6: 851.11
     rank  7: 833.93
     rank  8: 755.12
     rank  9: 832.44
     rank 10: 829.19
     rank 11: 839.26
     rank 12: 786.18
     rank 13: 863.85
     rank 14: 900.62
     rank 15: 868.19
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.06
     rank  5: 0.04
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.06
     rank  9: 0.06
     rank 10: 0.06
     rank 11: 0.08
     rank 12: 0.03
     rank 13: 0.06
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.08
     rank  1: 0.06
     rank  2: 0.06
     rank  3: 0.07
     rank  4: 0.04
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.04
     rank 12: 0.07
     rank 13: 0.10
     rank 14: 0.08
     rank 15: 0.07
  all-grads-sync:
     rank  0: 418.12
     rank  1: 418.21
     rank  2: 418.19
     rank  3: 418.00
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.27
     rank  1: 0.23
     rank  2: 0.22
     rank  3: 0.24
     rank  4: 0.05
     rank  5: 0.04
     rank  6: 0.04
     rank  7: 0.04
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.04
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.04
     rank  5: 0.04
     rank  6: 0.04
     rank  7: 0.04
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 42.33
     rank  1: 41.71
     rank  2: 41.69
     rank  3: 41.68
     rank  4: 0.23
     rank  5: 0.16
     rank  6: 0.16
     rank  7: 0.16
     rank  8: 0.14
     rank  9: 0.23
     rank 10: 0.15
     rank 11: 0.18
     rank 12: 0.10
     rank 13: 0.12
     rank 14: 0.11
     rank 15: 0.11
  optimizer:
     rank  0: 45.30
     rank  1: 44.67
     rank  2: 44.66
     rank  3: 44.64
     rank  4: 3.27
     rank  5: 3.13
     rank  6: 3.14
     rank  7: 3.10
     rank  8: 3.10
     rank  9: 3.20
     rank 10: 3.11
     rank 11: 3.13
     rank 12: 3.07
     rank 13: 3.10
     rank 14: 3.08
     rank 15: 3.07
 [2024-12-30 22:33:38] iteration        2/      10 | consumed samples:           64 | elapsed time per iteration (ms): 3147.8 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 7.156013E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 3078.42
     rank  1: 3078.47
     rank  2: 3078.45
     rank  3: 3078.44
     rank  4: 3075.06
     rank  5: 3075.05
     rank  6: 3075.02
     rank  7: 3075.06
     rank  8: 3075.17
     rank  9: 3075.23
     rank 10: 3075.16
     rank 11: 3075.22
     rank 12: 3075.02
     rank 13: 3075.08
     rank 14: 3075.08
     rank 15: 3075.02
  forward-compute:
     rank  0: 877.17
     rank  1: 819.01
     rank  2: 876.73
     rank  3: 811.05
     rank  4: 1038.13
     rank  5: 1033.81
     rank  6: 1020.30
     rank  7: 1039.78
     rank  8: 903.53
     rank  9: 974.23
     rank 10: 971.49
     rank 11: 975.32
     rank 12: 1036.14
     rank 13: 990.04
     rank 14: 1026.64
     rank 15: 995.36
  backward-compute:
     rank  0: 880.25
     rank  1: 900.65
     rank  2: 915.22
     rank  3: 892.41
     rank  4: 960.79
     rank  5: 959.35
     rank  6: 946.76
     rank  7: 969.69
     rank  8: 937.30
     rank  9: 1022.47
     rank 10: 1011.75
     rank 11: 1019.79
     rank 12: 986.22
     rank 13: 979.88
     rank 14: 981.64
     rank 15: 984.90
  pure-backward-compute:
     rank  0: 879.82
     rank  1: 900.25
     rank  2: 914.64
     rank  3: 891.97
     rank  4: 959.79
     rank  5: 958.60
     rank  6: 945.97
     rank  7: 968.91
     rank  8: 936.53
     rank  9: 1021.63
     rank 10: 1010.93
     rank 11: 1018.83
     rank 12: 984.66
     rank 13: 978.56
     rank 14: 980.21
     rank 15: 983.55
  batch-generator:
     rank  0: 27.91
     rank  1: 30.11
     rank  2: 40.54
     rank  3: 26.55
     rank  4: 28.40
     rank  5: 26.65
     rank  6: 27.58
     rank  7: 26.14
     rank  8: 26.22
     rank  9: 28.03
     rank 10: 27.22
     rank 11: 31.15
     rank 12: 36.42
     rank 13: 29.85
     rank 14: 33.06
     rank 15: 28.91
  forward-recv:
     rank  4: 112.28
     rank  5: 103.32
     rank  6: 115.60
     rank  7: 103.33
     rank  8: 261.26
     rank  9: 244.96
     rank 10: 250.08
     rank 11: 241.05
     rank 12: 356.87
     rank 13: 352.86
     rank 14: 361.01
     rank 15: 355.04
  forward-send:
     rank  0: 54.51
     rank  1: 67.63
     rank  2: 44.20
     rank  3: 66.28
     rank  4: 3.56
     rank  5: 4.59
     rank  6: 3.20
     rank  7: 4.50
     rank  8: 2.89
     rank  9: 2.61
     rank 10: 1.68
     rank 11: 2.34
  backward-recv:
     rank  0: 443.62
     rank  1: 426.60
     rank  2: 436.98
     rank  3: 422.21
     rank  4: 280.16
     rank  5: 267.56
     rank  6: 281.97
     rank  7: 258.48
     rank  8: 143.00
     rank  9: 122.78
     rank 10: 132.82
     rank 11: 120.61
  backward-send:
     rank  4: 4.55
     rank  5: 6.57
     rank  6: 5.99
     rank  7: 6.56
     rank  8: 3.20
     rank  9: 5.37
     rank 10: 5.56
     rank 11: 5.41
     rank 12: 5.18
     rank 13: 4.56
     rank 14: 4.97
     rank 15: 5.16
  forward-send-backward-recv:
     rank  0: 503.00
     rank  1: 561.56
     rank  2: 503.06
     rank  3: 581.63
     rank  4: 241.53
     rank  5: 277.00
     rank  6: 278.36
     rank  7: 270.52
     rank  8: 263.66
     rank  9: 154.48
     rank 10: 155.10
     rank 11: 153.12
  backward-send-forward-recv:
     rank  4: 10.72
     rank  5: 12.65
     rank  6: 11.56
     rank  7: 12.36
     rank  8: 19.77
     rank  9: 17.10
     rank 10: 16.17
     rank 11: 26.30
     rank 12: 31.21
     rank 13: 87.31
     rank 14: 40.96
     rank 15: 75.39
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.05
     rank  9: 0.05
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.04
     rank  2: 0.05
     rank  3: 0.05
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.04
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.06
     rank 13: 0.09
     rank 14: 0.08
     rank 15: 0.06
  all-grads-sync:
     rank  0: 291.04
     rank  1: 291.03
     rank  2: 291.03
     rank  3: 291.00
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.04
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.04
     rank 14: 0.03
     rank 15: 0.03
  optimizer-copy-to-main-grad:
     rank  0: 0.19
     rank  1: 0.19
     rank  2: 0.18
     rank  3: 0.20
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 37.86
     rank  1: 37.92
     rank  2: 37.88
     rank  3: 38.27
     rank  4: 0.09
     rank  5: 0.04
     rank  6: 0.05
     rank  7: 0.07
     rank  8: 0.05
     rank  9: 0.09
     rank 10: 0.04
     rank 11: 0.09
     rank 12: 0.04
     rank 13: 0.09
     rank 14: 0.08
     rank 15: 0.04
  optimizer:
     rank  0: 38.67
     rank  1: 38.73
     rank  2: 38.69
     rank  3: 39.07
     rank  4: 0.90
     rank  5: 0.85
     rank  6: 0.85
     rank  7: 0.87
     rank  8: 0.85
     rank  9: 0.90
     rank 10: 0.85
     rank 11: 0.89
     rank 12: 0.85
     rank 13: 0.89
     rank 14: 0.89
     rank 15: 0.85
 [2024-12-30 22:33:41] iteration        3/      10 | consumed samples:           96 | elapsed time per iteration (ms): 3153.8 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 7.169332E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 3088.97
     rank  1: 3088.97
     rank  2: 3089.03
     rank  3: 3089.01
     rank  4: 3085.54
     rank  5: 3085.51
     rank  6: 3085.52
     rank  7: 3085.48
     rank  8: 3085.67
     rank  9: 3085.66
     rank 10: 3085.69
     rank 11: 3085.74
     rank 12: 3085.55
     rank 13: 3085.61
     rank 14: 3085.59
     rank 15: 3085.56
  forward-compute:
     rank  0: 777.93
     rank  1: 798.23
     rank  2: 877.96
     rank  3: 810.91
     rank  4: 1035.32
     rank  5: 1039.04
     rank  6: 1024.15
     rank  7: 1041.86
     rank  8: 903.95
     rank  9: 980.28
     rank 10: 975.88
     rank 11: 979.36
     rank 12: 1052.30
     rank 13: 983.75
     rank 14: 1025.87
     rank 15: 988.99
  backward-compute:
     rank  0: 879.22
     rank  1: 902.76
     rank  2: 926.70
     rank  3: 906.97
     rank  4: 957.89
     rank  5: 956.39
     rank  6: 943.73
     rank  7: 965.51
     rank  8: 940.45
     rank  9: 1024.73
     rank 10: 1018.06
     rank 11: 1025.07
     rank 12: 988.00
     rank 13: 983.55
     rank 14: 982.48
     rank 15: 986.25
  pure-backward-compute:
     rank  0: 878.89
     rank  1: 902.37
     rank  2: 925.99
     rank  3: 906.34
     rank  4: 957.11
     rank  5: 955.51
     rank  6: 943.00
     rank  7: 964.89
     rank  8: 939.63
     rank  9: 1023.87
     rank 10: 1017.16
     rank 11: 1023.82
     rank 12: 986.39
     rank 13: 982.24
     rank 14: 981.24
     rank 15: 984.79
  batch-generator:
     rank  0: 22.85
     rank  1: 26.36
     rank  2: 39.32
     rank  3: 35.77
     rank  4: 27.40
     rank  5: 28.14
     rank  6: 28.62
     rank  7: 24.09
     rank  8: 26.44
     rank  9: 28.76
     rank 10: 28.23
     rank 11: 33.29
     rank 12: 30.75
     rank 13: 27.44
     rank 14: 35.18
     rank 15: 27.43
  forward-recv:
     rank  4: 99.71
     rank  5: 103.99
     rank  6: 104.02
     rank  7: 104.24
     rank  8: 246.04
     rank  9: 243.37
     rank 10: 240.24
     rank 11: 243.58
     rank 12: 341.37
     rank 13: 358.02
     rank 14: 352.49
     rank 15: 355.25
  forward-send:
     rank  0: 64.31
     rank  1: 72.05
     rank  2: 62.34
     rank  3: 70.02
     rank  4: 3.61
     rank  5: 5.01
     rank  6: 3.51
     rank  7: 4.67
     rank  8: 2.62
     rank  9: 3.02
     rank 10: 1.64
     rank 11: 1.72
  backward-recv:
     rank  0: 445.28
     rank  1: 425.17
     rank  2: 429.04
     rank  3: 423.69
     rank  4: 277.85
     rank  5: 264.00
     rank  6: 279.61
     rank  7: 263.05
     rank  8: 140.78
     rank  9: 120.61
     rank 10: 129.56
     rank 11: 120.02
  backward-send:
     rank  4: 4.58
     rank  5: 6.18
     rank  6: 6.23
     rank  7: 6.00
     rank  8: 3.12
     rank  9: 4.26
     rank 10: 4.84
     rank 11: 5.23
     rank 12: 4.63
     rank 13: 4.31
     rank 14: 4.11
     rank 15: 4.61
  forward-send-backward-recv:
     rank  0: 597.95
     rank  1: 581.97
     rank  2: 483.70
     rank  3: 566.20
     rank  4: 267.61
     rank  5: 282.05
     rank  6: 297.04
     rank  7: 273.43
     rank  8: 287.36
     rank  9: 152.85
     rank 10: 161.59
     rank 11: 153.43
  backward-send-forward-recv:
     rank  4: 10.57
     rank  5: 11.57
     rank  6: 9.83
     rank  7: 11.32
     rank  8: 14.80
     rank  9: 17.08
     rank 10: 16.38
     rank 11: 19.47
     rank 12: 33.75
     rank 13: 89.36
     rank 14: 53.37
     rank 15: 84.72
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.05
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.04
     rank  2: 0.06
     rank  3: 0.06
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.05
     rank 11: 0.03
     rank 12: 0.06
     rank 13: 0.07
     rank 14: 0.07
     rank 15: 0.07
  all-grads-sync:
     rank  0: 295.19
     rank  1: 295.21
     rank  2: 295.17
     rank  3: 295.08
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.06
     rank 11: 0.07
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.03
  optimizer-copy-to-main-grad:
     rank  0: 0.19
     rank  1: 0.19
     rank  2: 0.21
     rank  3: 0.21
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 37.91
     rank  1: 37.90
     rank  2: 38.26
     rank  3: 37.95
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.03
     rank  8: 0.08
     rank  9: 0.05
     rank 10: 0.09
     rank 11: 0.10
     rank 12: 0.04
     rank 13: 0.08
     rank 14: 0.04
     rank 15: 0.07
  optimizer:
     rank  0: 38.76
     rank  1: 38.74
     rank  2: 39.09
     rank  3: 38.80
     rank  4: 0.89
     rank  5: 0.89
     rank  6: 0.89
     rank  7: 0.85
     rank  8: 0.92
     rank  9: 0.89
     rank 10: 0.93
     rank 11: 0.94
     rank 12: 0.88
     rank 13: 0.92
     rank 14: 0.88
     rank 15: 0.91
 [2024-12-30 22:33:44] iteration        4/      10 | consumed samples:          128 | elapsed time per iteration (ms): 3167.0 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 6.947402E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 3102.25
     rank  1: 3102.26
     rank  2: 3102.22
     rank  3: 3102.23
     rank  4: 3098.86
     rank  5: 3098.83
     rank  6: 3098.79
     rank  7: 3098.80
     rank  8: 3098.90
     rank  9: 3098.96
     rank 10: 3098.89
     rank 11: 3099.02
     rank 12: 3098.85
     rank 13: 3098.88
     rank 14: 3098.82
     rank 15: 3098.80
  forward-compute:
     rank  0: 775.59
     rank  1: 824.97
     rank  2: 858.26
     rank  3: 806.20
     rank  4: 1037.27
     rank  5: 1044.66
     rank  6: 1024.74
     rank  7: 1043.92
     rank  8: 906.30
     rank  9: 980.19
     rank 10: 976.82
     rank 11: 979.12
     rank 12: 1068.06
     rank 13: 993.08
     rank 14: 989.09
     rank 15: 1003.13
  backward-compute:
     rank  0: 883.75
     rank  1: 907.67
     rank  2: 915.22
     rank  3: 902.21
     rank  4: 954.76
     rank  5: 957.41
     rank  6: 942.29
     rank  7: 966.20
     rank  8: 945.79
     rank  9: 1025.09
     rank 10: 1021.36
     rank 11: 1024.25
     rank 12: 990.22
     rank 13: 984.52
     rank 14: 984.69
     rank 15: 986.73
  pure-backward-compute:
     rank  0: 883.36
     rank  1: 906.92
     rank  2: 914.79
     rank  3: 901.57
     rank  4: 953.98
     rank  5: 956.54
     rank  6: 941.56
     rank  7: 965.47
     rank  8: 945.02
     rank  9: 1024.15
     rank 10: 1020.52
     rank 11: 1023.41
     rank 12: 988.73
     rank 13: 983.27
     rank 14: 983.24
     rank 15: 985.42
  batch-generator:
     rank  0: 23.59
     rank  1: 35.87
     rank  2: 32.81
     rank  3: 34.66
     rank  4: 28.45
     rank  5: 28.65
     rank  6: 28.25
     rank  7: 22.89
     rank  8: 25.44
     rank  9: 28.34
     rank 10: 27.69
     rank 11: 28.99
     rank 12: 31.39
     rank 13: 28.09
     rank 14: 30.10
     rank 15: 29.18
  forward-recv:
     rank  4: 99.88
     rank  5: 102.53
     rank  6: 114.52
     rank  7: 102.30
     rank  8: 245.98
     rank  9: 244.08
     rank 10: 252.91
     rank 11: 243.31
     rank 12: 341.39
     rank 13: 355.36
     rank 14: 363.16
     rank 15: 352.05
  forward-send:
     rank  0: 66.57
     rank  1: 62.07
     rank  2: 41.26
     rank  3: 70.54
     rank  4: 3.39
     rank  5: 3.57
     rank  6: 3.17
     rank  7: 3.33
     rank  8: 2.57
     rank  9: 2.55
     rank 10: 1.67
     rank 11: 1.95
  backward-recv:
     rank  0: 450.98
     rank  1: 426.73
     rank  2: 425.77
     rank  3: 429.18
     rank  4: 284.51
     rank  5: 266.12
     rank  6: 273.01
     rank  7: 265.59
     rank  8: 142.74
     rank  9: 119.52
     rank 10: 123.90
     rank 11: 120.74
  backward-send:
     rank  4: 4.50
     rank  5: 7.80
     rank  6: 4.75
     rank  7: 7.93
     rank  8: 3.12
     rank  9: 6.37
     rank 10: 5.02
     rank 11: 6.09
     rank 12: 4.96
     rank 13: 4.28
     rank 14: 4.95
     rank 15: 4.85
  forward-send-backward-recv:
     rank  0: 604.06
     rank  1: 570.98
     rank  2: 551.65
     rank  3: 584.53
     rank  4: 276.21
     rank  5: 287.87
     rank  6: 306.66
     rank  7: 282.10
     rank  8: 293.25
     rank  9: 164.27
     rank 10: 160.61
     rank 11: 167.35
  backward-send-forward-recv:
     rank  4: 10.56
     rank  5: 13.51
     rank  6: 12.20
     rank  7: 13.35
     rank  8: 14.65
     rank  9: 20.81
     rank 10: 20.54
     rank 11: 20.62
     rank 12: 29.72
     rank 13: 95.94
     rank 14: 91.78
     rank 15: 87.18
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.05
     rank  8: 0.02
     rank  9: 0.05
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.04
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.05
     rank  2: 0.05
     rank  3: 0.04
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.02
     rank  9: 0.05
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.06
     rank 13: 0.11
     rank 14: 0.07
     rank 15: 0.06
  all-grads-sync:
     rank  0: 295.99
     rank  1: 296.04
     rank  2: 296.01
     rank  3: 295.95
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.07
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.05
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.19
     rank  1: 0.19
     rank  2: 0.18
     rank  3: 0.19
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 37.65
     rank  1: 37.99
     rank  2: 37.91
     rank  3: 37.80
     rank  4: 0.09
     rank  5: 0.04
     rank  6: 0.04
     rank  7: 0.04
     rank  8: 0.05
     rank  9: 0.05
     rank 10: 0.04
     rank 11: 0.09
     rank 12: 0.04
     rank 13: 0.08
     rank 14: 0.08
     rank 15: 0.04
  optimizer:
     rank  0: 38.44
     rank  1: 38.78
     rank  2: 38.72
     rank  3: 38.62
     rank  4: 0.88
     rank  5: 0.84
     rank  6: 0.84
     rank  7: 0.83
     rank  8: 0.84
     rank  9: 0.84
     rank 10: 0.83
     rank 11: 0.88
     rank 12: 0.84
     rank 13: 0.88
     rank 14: 0.87
     rank 15: 0.84
 [2024-12-30 22:33:47] iteration        5/      10 | consumed samples:          160 | elapsed time per iteration (ms): 3185.6 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 6.927647E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 3118.90
     rank  1: 3118.85
     rank  2: 3118.87
     rank  3: 3118.88
     rank  4: 3115.47
     rank  5: 3115.46
     rank  6: 3115.43
     rank  7: 3115.43
     rank  8: 3115.46
     rank  9: 3115.46
     rank 10: 3115.46
     rank 11: 3115.53
     rank 12: 3115.43
     rank 13: 3115.42
     rank 14: 3115.44
     rank 15: 3115.47
  forward-compute:
     rank  0: 790.60
     rank  1: 826.33
     rank  2: 818.60
     rank  3: 794.56
     rank  4: 1035.65
     rank  5: 1042.93
     rank  6: 1027.68
     rank  7: 1043.23
     rank  8: 910.23
     rank  9: 981.48
     rank 10: 978.55
     rank 11: 981.95
     rank 12: 1058.12
     rank 13: 985.95
     rank 14: 1013.27
     rank 15: 990.21
  backward-compute:
     rank  0: 889.38
     rank  1: 910.32
     rank  2: 921.84
     rank  3: 903.09
     rank  4: 958.64
     rank  5: 958.69
     rank  6: 947.85
     rank  7: 966.34
     rank  8: 945.62
     rank  9: 1028.45
     rank 10: 1025.91
     rank 11: 1030.83
     rank 12: 987.58
     rank 13: 986.96
     rank 14: 986.25
     rank 15: 988.86
  pure-backward-compute:
     rank  0: 888.92
     rank  1: 909.47
     rank  2: 921.40
     rank  3: 902.74
     rank  4: 957.85
     rank  5: 957.87
     rank  6: 947.17
     rank  7: 965.56
     rank  8: 944.83
     rank  9: 1027.54
     rank 10: 1025.13
     rank 11: 1029.69
     rank 12: 986.22
     rank 13: 985.77
     rank 14: 984.95
     rank 15: 987.60
  batch-generator:
     rank  0: 22.85
     rank  1: 41.18
     rank  2: 29.81
     rank  3: 27.36
     rank  4: 26.80
     rank  5: 28.87
     rank  6: 27.24
     rank  7: 23.46
     rank  8: 25.65
     rank  9: 27.47
     rank 10: 26.36
     rank 11: 27.75
     rank 12: 29.87
     rank 13: 27.42
     rank 14: 29.15
     rank 15: 28.06
  forward-recv:
     rank  4: 106.85
     rank  5: 106.04
     rank  6: 107.61
     rank  7: 101.08
     rank  8: 255.84
     rank  9: 248.94
     rank 10: 246.00
     rank 11: 242.03
     rank 12: 350.11
     rank 13: 357.55
     rank 14: 356.31
     rank 15: 352.93
  forward-send:
     rank  0: 72.80
     rank  1: 72.49
     rank  2: 64.66
     rank  3: 69.60
     rank  4: 6.66
     rank  5: 6.79
     rank  6: 5.71
     rank  7: 3.51
     rank  8: 2.66
     rank  9: 2.80
     rank 10: 2.20
     rank 11: 1.65
  backward-recv:
     rank  0: 449.71
     rank  1: 424.72
     rank  2: 431.53
     rank  3: 426.16
     rank  4: 281.53
     rank  5: 266.55
     rank  6: 281.50
     rank  7: 266.26
     rank  8: 141.78
     rank  9: 122.22
     rank 10: 132.46
     rank 11: 120.67
  backward-send:
     rank  4: 4.57
     rank  5: 6.00
     rank  6: 5.24
     rank  7: 5.99
     rank  8: 3.19
     rank  9: 4.21
     rank 10: 5.01
     rank 11: 5.43
     rank 12: 5.26
     rank 13: 5.24
     rank 14: 5.39
     rank 15: 5.00
  forward-send-backward-recv:
     rank  0: 577.96
     rank  1: 559.42
     rank  2: 559.08
     rank  3: 601.04
     rank  4: 267.90
     rank  5: 283.67
     rank  6: 295.46
     rank  7: 286.06
     rank  8: 279.06
     rank  9: 152.36
     rank 10: 153.76
     rank 11: 159.12
  backward-send-forward-recv:
     rank  4: 10.33
     rank  5: 13.62
     rank  6: 11.54
     rank  7: 12.63
     rank  8: 14.78
     rank  9: 21.30
     rank 10: 19.58
     rank 11: 22.18
     rank 12: 32.19
     rank 13: 97.65
     rank 14: 71.82
     rank 15: 95.75
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.04
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.07
     rank 13: 0.06
     rank 14: 0.07
     rank 15: 0.08
  all-grads-sync:
     rank  0: 310.88
     rank  1: 310.88
     rank  2: 310.95
     rank  3: 310.83
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.31
     rank  1: 0.18
     rank  2: 0.19
     rank  3: 0.19
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 37.98
     rank  1: 37.57
     rank  2: 37.62
     rank  3: 37.96
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.06
     rank  8: 0.04
     rank  9: 0.07
     rank 10: 0.04
     rank 11: 0.09
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.05
     rank 15: 0.04
  optimizer:
     rank  0: 38.90
     rank  1: 38.49
     rank  2: 38.53
     rank  3: 38.88
     rank  4: 0.98
     rank  5: 0.97
     rank  6: 0.97
     rank  7: 0.98
     rank  8: 0.96
     rank  9: 0.99
     rank 10: 0.96
     rank 11: 1.01
     rank 12: 0.96
     rank 13: 0.96
     rank 14: 0.97
     rank 15: 0.96
 [2024-12-30 22:33:50] iteration        6/      10 | consumed samples:          192 | elapsed time per iteration (ms): 3152.2 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 6.105733E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 3088.83
     rank  1: 3088.85
     rank  2: 3088.82
     rank  3: 3088.85
     rank  4: 3085.44
     rank  5: 3085.34
     rank  6: 3085.35
     rank  7: 3085.43
     rank  8: 3085.44
     rank  9: 3085.52
     rank 10: 3085.44
     rank 11: 3085.49
     rank 12: 3085.41
     rank 13: 3085.43
     rank 14: 3085.43
     rank 15: 3085.41
  forward-compute:
     rank  0: 787.04
     rank  1: 815.95
     rank  2: 814.98
     rank  3: 809.07
     rank  4: 1044.60
     rank  5: 1039.17
     rank  6: 1023.26
     rank  7: 1042.23
     rank  8: 908.53
     rank  9: 983.12
     rank 10: 977.77
     rank 11: 982.83
     rank 12: 1055.35
     rank 13: 992.02
     rank 14: 1036.47
     rank 15: 986.07
  backward-compute:
     rank  0: 886.81
     rank  1: 907.02
     rank  2: 920.81
     rank  3: 904.48
     rank  4: 964.39
     rank  5: 962.59
     rank  6: 948.14
     rank  7: 972.05
     rank  8: 947.32
     rank  9: 1031.37
     rank 10: 1028.55
     rank 11: 1037.12
     rank 12: 991.11
     rank 13: 985.30
     rank 14: 987.40
     rank 15: 990.50
  pure-backward-compute:
     rank  0: 886.40
     rank  1: 906.35
     rank  2: 920.44
     rank  3: 903.91
     rank  4: 963.71
     rank  5: 962.04
     rank  6: 947.61
     rank  7: 971.29
     rank  8: 946.48
     rank  9: 1030.57
     rank 10: 1027.79
     rank 11: 1036.13
     rank 12: 989.78
     rank 13: 984.12
     rank 14: 986.18
     rank 15: 989.19
  batch-generator:
     rank  0: 23.51
     rank  1: 36.86
     rank  2: 27.00
     rank  3: 31.76
     rank  4: 30.11
     rank  5: 24.48
     rank  6: 23.70
     rank  7: 22.20
     rank  8: 25.69
     rank  9: 28.76
     rank 10: 26.39
     rank 11: 26.95
     rank 12: 32.49
     rank 13: 27.70
     rank 14: 32.02
     rank 15: 26.78
  forward-recv:
     rank  4: 106.04
     rank  5: 107.86
     rank  6: 109.31
     rank  7: 106.55
     rank  8: 255.86
     rank  9: 248.70
     rank 10: 248.12
     rank 11: 246.04
     rank 12: 345.71
     rank 13: 358.47
     rank 14: 357.06
     rank 15: 357.93
  forward-send:
     rank  0: 77.46
     rank  1: 78.44
     rank  2: 71.38
     rank  3: 75.95
     rank  4: 6.36
     rank  5: 6.46
     rank  6: 8.01
     rank  7: 6.97
     rank  8: 2.59
     rank  9: 3.63
     rank 10: 3.01
     rank 11: 3.62
  backward-recv:
     rank  0: 446.60
     rank  1: 427.54
     rank  2: 430.23
     rank  3: 421.59
     rank  4: 280.40
     rank  5: 268.46
     rank  6: 280.88
     rank  7: 265.38
     rank  8: 141.89
     rank  9: 121.83
     rank 10: 130.02
     rank 11: 120.08
  backward-send:
     rank  4: 4.58
     rank  5: 4.36
     rank  6: 4.36
     rank  7: 4.67
     rank  8: 3.13
     rank  9: 3.90
     rank 10: 3.35
     rank 11: 3.77
     rank 12: 4.35
     rank 13: 3.88
     rank 14: 4.01
     rank 15: 4.23
  forward-send-backward-recv:
     rank  0: 576.43
     rank  1: 556.49
     rank  2: 547.98
     rank  3: 574.68
     rank  4: 249.71
     rank  5: 276.51
     rank  6: 289.85
     rank  7: 268.54
     rank  8: 272.74
     rank  9: 146.93
     rank 10: 148.52
     rank 11: 146.00
  backward-send-forward-recv:
     rank  4: 10.25
     rank  5: 11.14
     rank  6: 9.45
     rank  7: 11.30
     rank  8: 15.75
     rank  9: 17.10
     rank 10: 15.73
     rank 11: 17.90
     rank 12: 31.39
     rank 13: 86.76
     rank 14: 41.42
     rank 15: 89.34
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.06
     rank 13: 0.06
     rank 14: 0.06
     rank 15: 0.07
  all-grads-sync:
     rank  0: 290.34
     rank  1: 290.28
     rank  2: 290.34
     rank  3: 290.31
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.18
     rank  1: 0.18
     rank  2: 0.18
     rank  3: 0.19
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 37.69
     rank  1: 37.86
     rank  2: 37.76
     rank  3: 37.90
     rank  4: 0.04
     rank  5: 0.04
     rank  6: 0.03
     rank  7: 0.04
     rank  8: 0.04
     rank  9: 0.05
     rank 10: 0.04
     rank 11: 0.05
     rank 12: 0.04
     rank 13: 0.05
     rank 14: 0.04
     rank 15: 0.07
  optimizer:
     rank  0: 38.37
     rank  1: 38.54
     rank  2: 38.44
     rank  3: 38.58
     rank  4: 0.73
     rank  5: 0.71
     rank  6: 0.71
     rank  7: 0.72
     rank  8: 0.72
     rank  9: 0.73
     rank 10: 0.72
     rank 11: 0.73
     rank 12: 0.72
     rank 13: 0.72
     rank 14: 0.72
     rank 15: 0.74
 [2024-12-30 22:33:54] iteration        7/      10 | consumed samples:          224 | elapsed time per iteration (ms): 3192.7 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 5.561014E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 3123.85
     rank  1: 3123.85
     rank  2: 3123.85
     rank  3: 3123.87
     rank  4: 3120.44
     rank  5: 3120.38
     rank  6: 3120.38
     rank  7: 3120.40
     rank  8: 3120.49
     rank  9: 3120.46
     rank 10: 3120.52
     rank 11: 3120.48
     rank 12: 3120.44
     rank 13: 3120.46
     rank 14: 3120.47
     rank 15: 3120.45
  forward-compute:
     rank  0: 787.01
     rank  1: 817.58
     rank  2: 802.36
     rank  3: 796.09
     rank  4: 1043.69
     rank  5: 1041.47
     rank  6: 1026.38
     rank  7: 1044.52
     rank  8: 909.66
     rank  9: 990.12
     rank 10: 986.55
     rank 11: 988.01
     rank 12: 1065.25
     rank 13: 996.58
     rank 14: 1008.42
     rank 15: 992.24
  backward-compute:
     rank  0: 888.43
     rank  1: 908.01
     rank  2: 912.79
     rank  3: 902.12
     rank  4: 960.65
     rank  5: 964.22
     rank  6: 949.54
     rank  7: 969.90
     rank  8: 950.45
     rank  9: 1031.03
     rank 10: 1032.65
     rank 11: 1037.22
     rank 12: 994.73
     rank 13: 990.88
     rank 14: 991.57
     rank 15: 993.45
  pure-backward-compute:
     rank  0: 888.03
     rank  1: 907.30
     rank  2: 912.46
     rank  3: 901.63
     rank  4: 959.85
     rank  5: 963.56
     rank  6: 949.05
     rank  7: 969.20
     rank  8: 949.71
     rank  9: 1030.16
     rank 10: 1031.81
     rank 11: 1036.31
     rank 12: 993.22
     rank 13: 989.66
     rank 14: 990.15
     rank 15: 992.20
  batch-generator:
     rank  0: 23.58
     rank  1: 36.47
     rank  2: 22.92
     rank  3: 26.24
     rank  4: 27.33
     rank  5: 23.62
     rank  6: 22.26
     rank  7: 23.01
     rank  8: 25.64
     rank  9: 29.70
     rank 10: 28.38
     rank 11: 26.46
     rank 12: 31.95
     rank 13: 28.44
     rank 14: 33.18
     rank 15: 29.33
  forward-recv:
     rank  4: 104.97
     rank  5: 107.24
     rank  6: 105.33
     rank  7: 106.70
     rank  8: 259.56
     rank  9: 247.49
     rank 10: 241.63
     rank 11: 247.90
     rank 12: 344.31
     rank 13: 359.19
     rank 14: 357.71
     rank 15: 359.70
  forward-send:
     rank  0: 72.62
     rank  1: 72.23
     rank  2: 64.17
     rank  3: 74.07
     rank  4: 6.09
     rank  5: 6.81
     rank  6: 5.09
     rank  7: 5.91
     rank  8: 2.60
     rank  9: 3.09
     rank 10: 2.20
     rank 11: 2.78
  backward-recv:
     rank  0: 449.88
     rank  1: 427.92
     rank  2: 435.18
     rank  3: 427.93
     rank  4: 282.74
     rank  5: 269.60
     rank  6: 276.83
     rank  7: 265.29
     rank  8: 142.10
     rank  9: 121.63
     rank 10: 126.99
     rank 11: 120.33
  backward-send:
     rank  4: 4.53
     rank  5: 6.12
     rank  6: 5.30
     rank  7: 6.12
     rank  8: 3.20
     rank  9: 4.83
     rank 10: 4.24
     rank 11: 4.68
     rank 12: 4.42
     rank 13: 4.21
     rank 14: 3.23
     rank 15: 4.41
  forward-send-backward-recv:
     rank  0: 590.25
     rank  1: 573.63
     rank  2: 586.78
     rank  3: 599.75
     rank  4: 265.61
     rank  5: 282.20
     rank  6: 309.78
     rank  7: 279.23
     rank  8: 277.41
     rank  9: 153.44
     rank 10: 153.29
     rank 11: 149.76
  backward-send-forward-recv:
     rank  4: 10.38
     rank  5: 14.34
     rank  6: 11.79
     rank  7: 13.75
     rank  8: 15.59
     rank  9: 17.98
     rank 10: 21.09
     rank 11: 19.78
     rank 12: 32.28
     rank 13: 89.32
     rank 14: 77.68
     rank 15: 91.11
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.07
     rank 13: 0.06
     rank 14: 0.07
     rank 15: 0.06
  all-grads-sync:
     rank  0: 310.86
     rank  1: 310.87
     rank  2: 310.93
     rank  3: 310.81
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.18
     rank  1: 0.18
     rank  2: 0.17
     rank  3: 0.19
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.05
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.04
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 37.62
     rank  1: 37.89
     rank  2: 37.79
     rank  3: 37.79
     rank  4: 0.04
     rank  5: 0.03
     rank  6: 0.04
     rank  7: 0.03
     rank  8: 0.08
     rank  9: 0.04
     rank 10: 0.06
     rank 11: 0.04
     rank 12: 0.15
     rank 13: 0.05
     rank 14: 0.08
     rank 15: 0.05
  optimizer:
     rank  0: 38.30
     rank  1: 38.58
     rank  2: 38.49
     rank  3: 38.48
     rank  4: 0.74
     rank  5: 0.72
     rank  6: 0.72
     rank  7: 0.72
     rank  8: 0.77
     rank  9: 0.72
     rank 10: 0.74
     rank 11: 0.73
     rank 12: 0.84
     rank 13: 0.74
     rank 14: 0.77
     rank 15: 0.74
 [2024-12-30 22:33:57] iteration        8/      10 | consumed samples:          256 | elapsed time per iteration (ms): 3186.1 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 4.413028E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 3122.19
     rank  1: 3122.18
     rank  2: 3122.21
     rank  3: 3122.20
     rank  4: 3118.85
     rank  5: 3118.74
     rank  6: 3118.75
     rank  7: 3118.75
     rank  8: 3118.83
     rank  9: 3118.80
     rank 10: 3118.79
     rank 11: 3118.79
     rank 12: 3118.74
     rank 13: 3118.75
     rank 14: 3118.76
     rank 15: 3118.78
  forward-compute:
     rank  0: 783.48
     rank  1: 811.82
     rank  2: 853.12
     rank  3: 802.62
     rank  4: 1041.82
     rank  5: 1039.70
     rank  6: 1021.77
     rank  7: 1046.63
     rank  8: 916.77
     rank  9: 992.37
     rank 10: 988.12
     rank 11: 991.78
     rank 12: 1063.12
     rank 13: 1004.30
     rank 14: 1035.47
     rank 15: 989.26
  backward-compute:
     rank  0: 890.08
     rank  1: 907.84
     rank  2: 912.86
     rank  3: 902.67
     rank  4: 965.76
     rank  5: 964.39
     rank  6: 944.24
     rank  7: 970.38
     rank  8: 952.94
     rank  9: 1034.74
     rank 10: 1033.41
     rank 11: 1043.51
     rank 12: 994.45
     rank 13: 989.30
     rank 14: 986.93
     rank 15: 995.29
  pure-backward-compute:
     rank  0: 889.75
     rank  1: 906.06
     rank  2: 912.41
     rank  3: 902.21
     rank  4: 965.09
     rank  5: 963.84
     rank  6: 943.70
     rank  7: 969.70
     rank  8: 952.14
     rank  9: 1033.93
     rank 10: 1032.64
     rank 11: 1042.63
     rank 12: 992.89
     rank 13: 988.04
     rank 14: 985.72
     rank 15: 993.87
  batch-generator:
     rank  0: 23.09
     rank  1: 34.29
     rank  2: 27.23
     rank  3: 26.84
     rank  4: 27.69
     rank  5: 23.65
     rank  6: 21.55
     rank  7: 22.14
     rank  8: 25.40
     rank  9: 28.85
     rank 10: 27.11
     rank 11: 25.75
     rank 12: 33.18
     rank 13: 27.83
     rank 14: 37.12
     rank 15: 26.68
  forward-recv:
     rank  4: 100.86
     rank  5: 104.69
     rank  6: 106.53
     rank  7: 105.44
     rank  8: 248.83
     rank  9: 238.80
     rank 10: 240.44
     rank 11: 244.29
     rank 12: 344.79
     rank 13: 359.86
     rank 14: 359.84
     rank 15: 359.48
  forward-send:
     rank  0: 67.88
     rank  1: 68.22
     rank  2: 67.08
     rank  3: 72.45
     rank  4: 3.37
     rank  5: 5.05
     rank  6: 5.70
     rank  7: 4.82
     rank  8: 2.68
     rank  9: 4.08
     rank 10: 4.06
     rank 11: 3.65
  backward-recv:
     rank  0: 450.51
     rank  1: 429.57
     rank  2: 435.44
     rank  3: 427.00
     rank  4: 278.54
     rank  5: 271.97
     rank  6: 285.49
     rank  7: 266.97
     rank  8: 140.97
     rank  9: 124.83
     rank 10: 130.70
     rank 11: 120.55
  backward-send:
     rank  4: 4.64
     rank  5: 4.32
     rank  6: 4.37
     rank  7: 4.39
     rank  8: 3.18
     rank  9: 4.14
     rank 10: 3.96
     rank 11: 3.16
     rank 12: 4.64
     rank 13: 4.47
     rank 14: 3.76
     rank 15: 4.64
  forward-send-backward-recv:
     rank  0: 595.98
     rank  1: 579.39
     rank  2: 527.01
     rank  3: 594.40
     rank  4: 273.84
     rank  5: 286.23
     rank  6: 306.20
     rank  7: 279.66
     rank  8: 279.70
     rank  9: 152.77
     rank 10: 151.16
     rank 11: 147.00
  backward-send-forward-recv:
     rank  4: 10.72
     rank  5: 12.03
     rank  6: 11.30
     rank  7: 12.42
     rank  8: 14.58
     rank  9: 16.48
     rank 10: 15.92
     rank 11: 16.33
     rank 12: 32.17
     rank 13: 80.56
     rank 14: 51.20
     rank 15: 90.54
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.08
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.04
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.04
     rank  2: 0.06
     rank  3: 0.04
     rank  4: 0.04
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.06
     rank 13: 0.06
     rank 14: 0.07
     rank 15: 0.08
  all-grads-sync:
     rank  0: 310.76
     rank  1: 310.85
     rank  2: 310.84
     rank  3: 310.70
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.19
     rank  1: 0.18
     rank  2: 0.21
     rank  3: 0.19
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 38.02
     rank  1: 37.57
     rank  2: 38.05
     rank  3: 37.95
     rank  4: 0.06
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.05
     rank 15: 0.04
  optimizer:
     rank  0: 38.88
     rank  1: 38.40
     rank  2: 38.94
     rank  3: 38.80
     rank  4: 0.92
     rank  5: 0.88
     rank  6: 0.89
     rank  7: 0.89
     rank  8: 0.90
     rank  9: 0.89
     rank 10: 0.89
     rank 11: 0.89
     rank 12: 0.89
     rank 13: 0.90
     rank 14: 0.90
     rank 15: 0.90
 [2024-12-30 22:34:00] iteration        9/      10 | consumed samples:          288 | elapsed time per iteration (ms): 3199.8 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 4.607039E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 3135.06
     rank  1: 3135.14
     rank  2: 3135.05
     rank  3: 3135.06
     rank  4: 3131.61
     rank  5: 3131.61
     rank  6: 3131.55
     rank  7: 3131.57
     rank  8: 3131.67
     rank  9: 3131.62
     rank 10: 3131.62
     rank 11: 3131.61
     rank 12: 3131.68
     rank 13: 3131.57
     rank 14: 3131.63
     rank 15: 3131.64
  forward-compute:
     rank  0: 783.13
     rank  1: 855.14
     rank  2: 845.03
     rank  3: 792.03
     rank  4: 1051.23
     rank  5: 1037.97
     rank  6: 1016.55
     rank  7: 1041.32
     rank  8: 918.51
     rank  9: 989.77
     rank 10: 990.38
     rank 11: 993.52
     rank 12: 1070.01
     rank 13: 1008.47
     rank 14: 1024.26
     rank 15: 1003.07
  backward-compute:
     rank  0: 890.58
     rank  1: 908.71
     rank  2: 911.56
     rank  3: 904.73
     rank  4: 970.64
     rank  5: 956.33
     rank  6: 937.63
     rank  7: 958.29
     rank  8: 958.67
     rank  9: 1041.59
     rank 10: 1037.36
     rank 11: 1048.27
     rank 12: 996.31
     rank 13: 990.67
     rank 14: 992.95
     rank 15: 997.28
  pure-backward-compute:
     rank  0: 890.17
     rank  1: 908.26
     rank  2: 911.13
     rank  3: 904.41
     rank  4: 969.79
     rank  5: 955.59
     rank  6: 937.15
     rank  7: 957.68
     rank  8: 957.80
     rank  9: 1040.42
     rank 10: 1036.57
     rank 11: 1047.22
     rank 12: 994.86
     rank 13: 989.46
     rank 14: 991.70
     rank 15: 995.85
  batch-generator:
     rank  0: 23.94
     rank  1: 27.66
     rank  2: 27.26
     rank  3: 22.32
     rank  4: 28.14
     rank  5: 23.32
     rank  6: 22.44
     rank  7: 23.96
     rank  8: 25.51
     rank  9: 28.02
     rank 10: 27.07
     rank 11: 27.46
     rank 12: 29.25
     rank 13: 27.01
     rank 14: 32.85
     rank 15: 28.46
  forward-recv:
     rank  4: 102.89
     rank  5: 103.95
     rank  6: 113.44
     rank  7: 104.23
     rank  8: 255.35
     rank  9: 242.31
     rank 10: 245.65
     rank 11: 244.90
     rank 12: 348.39
     rank 13: 354.16
     rank 14: 362.13
     rank 15: 354.91
  forward-send:
     rank  0: 76.09
     rank  1: 67.51
     rank  2: 41.25
     rank  3: 68.69
     rank  4: 4.00
     rank  5: 4.17
     rank  6: 4.33
     rank  7: 4.71
     rank  8: 2.60
     rank  9: 2.81
     rank 10: 1.64
     rank 11: 2.44
  backward-recv:
     rank  0: 456.45
     rank  1: 437.04
     rank  2: 439.33
     rank  3: 434.29
     rank  4: 283.66
     rank  5: 276.85
     rank  6: 288.32
     rank  7: 273.38
     rank  8: 140.14
     rank  9: 124.37
     rank 10: 132.22
     rank 11: 119.72
  backward-send:
     rank  4: 4.60
     rank  5: 5.34
     rank  6: 4.34
     rank  7: 5.47
     rank  8: 3.15
     rank  9: 5.03
     rank 10: 4.21
     rank 11: 4.22
     rank 12: 4.98
     rank 13: 4.54
     rank 14: 4.49
     rank 15: 4.41
  forward-send-backward-recv:
     rank  0: 594.19
     rank  1: 544.69
     rank  2: 572.51
     rank  3: 614.47
     rank  4: 265.99
     rank  5: 307.63
     rank  6: 324.20
     rank  7: 305.09
     rank  8: 269.44
     rank  9: 157.77
     rank 10: 152.89
     rank 11: 152.28
  backward-send-forward-recv:
     rank  4: 10.20
     rank  5: 11.93
     rank  6: 11.56
     rank  7: 12.03
     rank  8: 24.44
     rank  9: 18.10
     rank 10: 17.86
     rank 11: 18.89
     rank 12: 32.26
     rank 13: 93.54
     rank 14: 67.25
     rank 15: 92.55
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.06
     rank  2: 0.05
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.08
     rank 13: 0.07
     rank 14: 0.07
     rank 15: 0.07
  all-grads-sync:
     rank  0: 308.58
     rank  1: 308.88
     rank  2: 308.50
     rank  3: 308.52
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.20
     rank  1: 0.23
     rank  2: 0.18
     rank  3: 0.20
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 37.99
     rank  1: 38.16
     rank  2: 37.78
     rank  3: 37.97
     rank  4: 0.07
     rank  5: 0.04
     rank  6: 0.03
     rank  7: 0.06
     rank  8: 0.05
     rank  9: 0.04
     rank 10: 0.08
     rank 11: 0.08
     rank 12: 0.08
     rank 13: 0.07
     rank 14: 0.04
     rank 15: 0.07
  optimizer:
     rank  0: 38.90
     rank  1: 39.04
     rank  2: 38.69
     rank  3: 38.86
     rank  4: 0.97
     rank  5: 0.95
     rank  6: 0.93
     rank  7: 0.96
     rank  8: 0.95
     rank  9: 0.94
     rank 10: 0.98
     rank 11: 0.98
     rank 12: 0.98
     rank 13: 0.97
     rank 14: 0.94
     rank 15: 0.97
 [2024-12-30 22:34:03] iteration       10/      10 | consumed samples:          320 | elapsed time per iteration (ms): 3189.9 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 3.989021E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 3125.39
     rank  1: 3125.40
     rank  2: 3125.41
     rank  3: 3125.42
     rank  4: 3122.00
     rank  5: 3121.98
     rank  6: 3121.95
     rank  7: 3121.96
     rank  8: 3122.06
     rank  9: 3122.07
     rank 10: 3122.06
     rank 11: 3122.13
     rank 12: 3122.00
     rank 13: 3122.01
     rank 14: 3122.01
     rank 15: 3122.08
  forward-compute:
     rank  0: 798.17
     rank  1: 824.72
     rank  2: 804.63
     rank  3: 787.47
     rank  4: 1046.82
     rank  5: 1035.93
     rank  6: 1016.17
     rank  7: 1035.90
     rank  8: 916.40
     rank  9: 995.50
     rank 10: 993.26
     rank 11: 1001.07
     rank 12: 1067.99
     rank 13: 1015.26
     rank 14: 1072.25
     rank 15: 1007.76
  backward-compute:
     rank  0: 896.82
     rank  1: 902.54
     rank  2: 912.37
     rank  3: 902.99
     rank  4: 970.56
     rank  5: 952.21
     rank  6: 941.43
     rank  7: 957.27
     rank  8: 961.12
     rank  9: 1042.40
     rank 10: 1041.38
     rank 11: 1052.93
     rank 12: 999.04
     rank 13: 992.18
     rank 14: 992.64
     rank 15: 995.98
  pure-backward-compute:
     rank  0: 896.42
     rank  1: 902.12
     rank  2: 912.04
     rank  3: 902.68
     rank  4: 969.90
     rank  5: 951.58
     rank  6: 940.95
     rank  7: 956.64
     rank  8: 960.27
     rank  9: 1041.51
     rank 10: 1040.58
     rank 11: 1051.83
     rank 12: 997.44
     rank 13: 990.94
     rank 14: 991.33
     rank 15: 994.47
  batch-generator:
     rank  0: 27.34
     rank  1: 27.90
     rank  2: 21.89
     rank  3: 22.92
     rank  4: 26.92
     rank  5: 27.18
     rank  6: 21.44
     rank  7: 22.40
     rank  8: 25.65
     rank  9: 27.57
     rank 10: 31.85
     rank 11: 26.52
     rank 12: 31.77
     rank 13: 27.43
     rank 14: 39.74
     rank 15: 29.69
  forward-recv:
     rank  4: 103.19
     rank  5: 113.50
     rank  6: 104.97
     rank  7: 103.80
     rank  8: 253.55
     rank  9: 249.80
     rank 10: 232.83
     rank 11: 240.74
     rank 12: 350.41
     rank 13: 366.37
     rank 14: 356.95
     rank 15: 355.09
  forward-send:
     rank  0: 68.42
     rank  1: 55.37
     rank  2: 55.25
     rank  3: 67.18
     rank  4: 3.49
     rank  5: 3.69
     rank  6: 3.20
     rank  7: 3.35
     rank  8: 2.61
     rank  9: 2.78
     rank 10: 1.70
     rank 11: 1.59
  backward-recv:
     rank  0: 456.88
     rank  1: 444.02
     rank  2: 451.02
     rank  3: 437.31
     rank  4: 276.37
     rank  5: 278.02
     rank  6: 290.97
     rank  7: 273.50
     rank  8: 140.22
     rank  9: 125.19
     rank 10: 132.83
     rank 11: 120.95
  backward-send:
     rank  4: 5.59
     rank  5: 4.44
     rank  6: 6.25
     rank  7: 5.65
     rank  8: 3.13
     rank  9: 3.11
     rank 10: 4.15
     rank 11: 4.32
     rank 12: 4.69
     rank 13: 4.13
     rank 14: 4.40
     rank 15: 4.54
  forward-send-backward-recv:
     rank  0: 590.57
     rank  1: 590.09
     rank  2: 597.14
     rank  3: 627.00
     rank  4: 285.75
     rank  5: 308.96
     rank  6: 339.18
     rank  7: 321.82
     rank  8: 289.33
     rank  9: 154.04
     rank 10: 170.67
     rank 11: 154.73
  backward-send-forward-recv:
     rank  4: 10.39
     rank  5: 10.67
     rank  6: 9.37
     rank  7: 10.65
     rank  8: 15.27
     rank  9: 15.45
     rank 10: 14.28
     rank 11: 15.48
     rank 12: 37.95
     rank 13: 81.08
     rank 14: 32.94
     rank 15: 96.76
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.04
     rank  2: 0.05
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.06
     rank 13: 0.06
     rank 14: 0.07
     rank 15: 0.06
  all-grads-sync:
     rank  0: 292.24
     rank  1: 292.25
     rank  2: 292.22
     rank  3: 292.19
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.19
     rank  1: 0.18
     rank  2: 0.18
     rank  3: 0.19
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 37.82
     rank  1: 37.61
     rank  2: 37.87
     rank  3: 37.98
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.03
     rank  7: 0.04
     rank  8: 0.04
     rank  9: 0.08
     rank 10: 0.04
     rank 11: 0.05
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.05
  optimizer:
     rank  0: 38.50
     rank  1: 38.25
     rank  2: 38.54
     rank  3: 38.70
     rank  4: 0.72
     rank  5: 0.72
     rank  6: 0.70
     rank  7: 0.70
     rank  8: 0.71
     rank  9: 0.74
     rank 10: 0.71
     rank 11: 0.72
     rank 12: 0.71
     rank 13: 0.72
     rank 14: 0.72
     rank 15: 0.72
