examples/multimodal/pretrain-freeze-llm-homo.sh: line 4: activate: No such file or directory
[2024-12-30 21:22:54,648] torch.distributed.run: [WARNING] 
[2024-12-30 21:22:54,648] torch.distributed.run: [WARNING] *****************************************
[2024-12-30 21:22:54,648] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-12-30 21:22:54,648] torch.distributed.run: [WARNING] *****************************************
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
> setting tensorboard ...
WARNING: one_logger package is required to enable e2e metrics tracking. please go to https://confluence.nvidia.com/display/MLWFO/Package+Repositories for details to install it
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
---Rank 13---Tensor Parallel Group GPUs: [0]
---Rank 14---Tensor Parallel Group GPUs: [0]
---Rank 12---Tensor Parallel Group GPUs: [0]---Rank 13---Pipeline Parallel Group GPUs: [3, 3, 3, 3]

---Rank 14---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
---Rank 12---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
---Rank 15---Tensor Parallel Group GPUs: [0]
[rank13]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
---Rank 15---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
[rank14]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank12]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank15]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
 > number of parameters on (tensor, pipeline) model parallel rank (0, 3): 1006669824
INFO:megatron.core.distributed.param_and_grad_buffer:Number of buckets for gradient all-reduce / reduce-scatter: 1
Params for bucket 1 (1006669824 elements):
	language_model.decoder.layers.2.mlp.linear_fc1.weight
	language_model.decoder.layers.0.mlp.linear_fc2.weight
	language_model.decoder.layers.2.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.2.self_attention.linear_proj.weight
	language_model.decoder.layers.1.mlp.linear_fc1.weight
	language_model.decoder.layers.0.self_attention.linear_proj.weight
	language_model.output_layer.weight
	language_model.decoder.layers.3.mlp.linear_fc1.weight
	language_model.decoder.layers.3.mlp.linear_fc2.weight
	language_model.decoder.layers.1.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.0.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.3.self_attention.linear_proj.weight
	language_model.decoder.layers.2.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.1.mlp.linear_fc2.weight
	language_model.decoder.layers.0.self_attention.linear_qkv.weight
	language_model.decoder.layers.3.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.2.self_attention.linear_qkv.weight
	language_model.decoder.layers.1.self_attention.linear_proj.weight
	language_model.decoder.final_layernorm.weight
	language_model.decoder.layers.3.self_attention.linear_qkv.weight
	language_model.decoder.layers.1.self_attention.linear_qkv.weight
	language_model.decoder.layers.0.mlp.linear_fc1.weight
	language_model.decoder.layers.3.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.2.mlp.linear_fc2.weight
	language_model.decoder.layers.1.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.0.self_attention.linear_qkv.layer_norm_weight
rank=2, worker=0: shard_range=[pretrain-31.tar[0, 100), pretrain-31.tar[100, 200), pretrain-31.tar[200, 300), ...<619>, pretrain-37.tar[2200, 2300), pretrain-37.tar[2300, 2400), pretrain-37.tar[2400, 2500)] sum(count)=62500
rank=2, worker=1: shard_range=[pretrain-37.tar[2500, 2600), pretrain-37.tar[2600, 2700), pretrain-37.tar[2700, 2800), ...<619>, pretrain-42.tar[4700, 4800), pretrain-42.tar[4800, 4900), pretrain-42.tar[4900, 5000)] sum(count)=62500
rank=1, worker=0: shard_range=[pretrain-2.tar[5000, 5100), pretrain-2.tar[5100, 5200), pretrain-2.tar[5200, 5300), ...<619>, pretrain-25.tar[7200, 7300), pretrain-25.tar[7300, 7400), pretrain-25.tar[7400, 7500)] sum(count)=62500
rank=1, worker=1: shard_range=[pretrain-25.tar[7500, 7600), pretrain-25.tar[7600, 7700), pretrain-25.tar[7700, 7800), ...<619>, pretrain-30.tar[9700, 9800), pretrain-30.tar[9800, 9900), pretrain-30.tar[9900, 10000)] sum(count)=62500
rank=0, worker=0: shard_range=[pretrain-0.tar[0, 100), pretrain-0.tar[100, 200), pretrain-0.tar[200, 300), ...<619>, pretrain-14.tar[2200, 2300), pretrain-14.tar[2300, 2400), pretrain-14.tar[2400, 2500)] sum(count)=62500
rank=0, worker=1: shard_range=[pretrain-14.tar[2500, 2600), pretrain-14.tar[2600, 2700), pretrain-14.tar[2700, 2800), ...<619>, pretrain-2.tar[4700, 4800), pretrain-2.tar[4800, 4900), pretrain-2.tar[4900, 5000)] sum(count)=62500
rank=3, worker=0: shard_range=[pretrain-42.tar[5000, 5100), pretrain-42.tar[5100, 5200), pretrain-42.tar[5200, 5300), ...<619>, pretrain-48.tar[7200, 7300), pretrain-48.tar[7300, 7400), pretrain-48.tar[7400, 7500)] sum(count)=62500
rank=3, worker=1: shard_range=[pretrain-48.tar[7500, 7600), pretrain-48.tar[7600, 7700), pretrain-48.tar[7700, 7800), ...<619>, pretrain-53.tar[9700, 9800), pretrain-53.tar[9800, 9900), pretrain-53.tar[9900, 10000)] sum(count)=62500
rank=0, worker=0: shard_range=[pretrain-54.tar[0, 7266)] sum(count)=7266
rank=0, worker=1: shard_range=[pretrain-54.tar[7266, 10000), pretrain-55.tar[0, 4532)] sum(count)=7266
rank=1, worker=0: shard_range=[pretrain-55.tar[4532, 8128), pretrain-6.tar[0, 3670)] sum(count)=7266
rank=1, worker=1: shard_range=[pretrain-6.tar[3670, 10000), pretrain-7.tar[0, 936)] sum(count)=7266
rank=2, worker=0: shard_range=[pretrain-7.tar[936, 8202)] sum(count)=7266
rank=2, worker=1: shard_range=[pretrain-7.tar[8202, 10000), pretrain-8.tar[0, 5468)] sum(count)=7266
rank=3, worker=0: shard_range=[pretrain-8.tar[5468, 10000), pretrain-9.tar[0, 2734)] sum(count)=7266
rank=3, worker=1: shard_range=[pretrain-9.tar[2734, 10000)] sum(count)=7266
times across ranks (ms):
  model-and-optimizer-setup:
     rank  0: 91.27
     rank  1: 86.31
     rank  2: 88.36
     rank  3: 88.42
     rank  4: 188.96
     rank  5: 188.71
     rank  6: 184.22
     rank  7: 179.92
     rank  8: 210.18
     rank  9: 191.17
     rank 10: 210.68
     rank 11: 210.49
     rank 12: 131.67
     rank 13: 131.65
     rank 14: 131.44
     rank 15: 131.86
  train/valid/test-data-iterators-setup:
     rank  0: 999.82
     rank  1: 999.73
     rank  2: 999.72
     rank  3: 999.70
     rank  4: 1388.47
     rank  5: 1388.51
     rank  6: 1487.94
     rank  7: 1487.59
     rank  8: 1488.03
     rank  9: 1487.97
     rank 10: 1487.87
     rank 11: 1487.86
     rank 12: 1487.83
     rank 13: 1487.82
     rank 14: 1487.93
     rank 15: 1487.91
 [2024-12-30 21:25:03] iteration        1/      10 | consumed samples:           32 | elapsed time per iteration (ms): 27804.8 | learning rate: 7.500000E-07 | global batch size:    32 | lm loss: 7.114373E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
stage4 GPU utialization:170.9298393943093 %
[Rank 12] (after 1 iterations) memory (MB) | allocated: 15413.8154296875 | max allocated: 19253.537109375 | reserved: 20410.0 | max reserved: 20410.0
times across ranks (ms):
  forward-backward:
     rank  0: 27455.58
     rank  1: 27455.61
     rank  2: 27455.54
     rank  3: 27455.62
     rank  4: 27461.73
     rank  5: 27461.62
     rank  6: 27461.65
     rank  7: 27461.70
     rank  8: 27460.25
     rank  9: 27460.23
     rank 10: 27460.21
     rank 11: 27460.29
     rank 12: 27461.38
     rank 13: 27461.34
     rank 14: 27461.35
     rank 15: 27461.47
  forward-compute:
     rank  0: 4322.42
     rank  1: 4363.30
     rank  2: 4765.16
     rank  3: 4401.81
     rank  4: 7892.63
     rank  5: 7905.80
     rank  6: 7473.80
     rank  7: 7846.03
     rank  8: 7228.74
     rank  9: 7220.61
     rank 10: 7221.79
     rank 11: 7229.56
     rank 12: 5707.72
     rank 13: 5679.56
     rank 14: 5763.50
     rank 15: 5721.87
  backward-compute:
     rank  0: 1463.72
     rank  1: 1478.08
     rank  2: 1449.91
     rank  3: 1472.66
     rank  4: 1111.51
     rank  5: 1112.27
     rank  6: 1105.70
     rank  7: 1114.47
     rank  8: 1042.53
     rank  9: 1038.00
     rank 10: 1045.29
     rank 11: 1042.91
     rank 12: 1227.66
     rank 13: 1242.88
     rank 14: 1218.51
     rank 15: 1229.87
  pure-backward-compute:
     rank  0: 1463.06
     rank  1: 1477.42
     rank  2: 1449.03
     rank  3: 1471.85
     rank  4: 1110.66
     rank  5: 1111.25
     rank  6: 1104.53
     rank  7: 1113.87
     rank  8: 1041.70
     rank  9: 1037.00
     rank 10: 1044.51
     rank 11: 1042.00
     rank 12: 1225.98
     rank 13: 1241.59
     rank 14: 1217.08
     rank 15: 1228.37
  batch-generator:
     rank  0: 1146.43
     rank  1: 1545.08
     rank  2: 1616.60
     rank  3: 1640.37
     rank  4: 1852.22
     rank  5: 1849.48
     rank  6: 1430.78
     rank  7: 1799.20
     rank  8: 1425.80
     rank  9: 1417.83
     rank 10: 1425.27
     rank 11: 1425.61
     rank 12: 1348.38
     rank 13: 1349.70
     rank 14: 1350.52
     rank 15: 1353.01
  forward-recv:
     rank  4: 4052.65
     rank  5: 4054.85
     rank  6: 4477.14
     rank  7: 4109.35
     rank  8: 11484.45
     rank  9: 11495.54
     rank 10: 11488.21
     rank 11: 11488.55
     rank 12: 18266.40
     rank 13: 18260.39
     rank 14: 18264.35
     rank 15: 18262.35
  forward-send:
     rank  0: 14261.37
     rank  1: 14267.40
     rank  2: 13869.66
     rank  3: 14190.33
     rank  4: 6737.09
     rank  5: 6721.83
     rank  6: 6733.65
     rank  7: 6735.92
     rank  8: 31.99
     rank  9: 25.86
     rank 10: 29.98
     rank 11: 27.95
  backward-recv:
     rank  0: 546.22
     rank  1: 537.22
     rank  2: 543.44
     rank  3: 533.51
     rank  4: 215.78
     rank  5: 214.00
     rank  6: 219.45
     rank  7: 218.93
     rank  8: 106.94
     rank  9: 107.38
     rank 10: 106.80
     rank 11: 105.20
  backward-send:
     rank  4: 3.70
     rank  5: 4.32
     rank  6: 2.78
     rank  7: 2.65
     rank  8: 8.16
     rank  9: 8.33
     rank 10: 7.79
     rank 11: 6.63
     rank 12: 4.45
     rank 13: 4.25
     rank 14: 4.27
     rank 15: 2.92
  forward-send-backward-recv:
     rank  0: 5862.08
     rank  1: 5811.27
     rank  2: 5831.17
     rank  3: 5853.96
     rank  4: 5456.08
     rank  5: 5432.00
     rank  6: 5495.31
     rank  7: 5452.62
     rank  8: 5368.51
     rank  9: 5346.80
     rank 10: 5409.28
     rank 11: 5381.42
  backward-send-forward-recv:
     rank  4: 930.37
     rank  5: 955.55
     rank  6: 889.15
     rank  7: 917.10
     rank  8: 997.88
     rank  9: 1022.49
     rank 10: 958.37
     rank 11: 981.30
     rank 12: 927.91
     rank 13: 947.91
     rank 14: 883.33
     rank 15: 914.33
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.06
     rank  2: 0.04
     rank  3: 0.08
     rank  4: 0.03
     rank  5: 0.04
     rank  6: 0.03
     rank  7: 0.04
     rank  8: 0.05
     rank  9: 0.05
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.04
     rank 13: 0.03
     rank 14: 0.04
     rank 15: 0.09
  embedding-grads-all-reduce:
     rank  0: 0.07
     rank  1: 0.08
     rank  2: 0.09
     rank  3: 0.09
     rank  4: 0.05
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.05
     rank  9: 0.04
     rank 10: 0.03
     rank 11: 0.04
     rank 12: 0.09
     rank 13: 0.06
     rank 14: 0.08
     rank 15: 0.19
  all-grads-sync:
     rank  0: 418.37
     rank  1: 418.41
     rank  2: 418.35
     rank  3: 418.28
     rank  4: 983.21
     rank  5: 983.20
     rank  6: 983.22
     rank  7: 983.24
     rank  8: 866.58
     rank  9: 866.57
     rank 10: 866.57
     rank 11: 866.56
     rank 12: 854.30
     rank 13: 854.34
     rank 14: 854.34
     rank 15: 854.26
  optimizer-copy-to-main-grad:
     rank  0: 0.25
     rank  1: 0.28
     rank  2: 0.29
     rank  3: 0.33
     rank  4: 0.07
     rank  5: 0.06
     rank  6: 0.20
     rank  7: 0.06
     rank  8: 0.11
     rank  9: 0.06
     rank 10: 0.06
     rank 11: 0.10
     rank 12: 0.11
     rank 13: 0.05
     rank 14: 0.06
     rank 15: 0.12
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.05
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 41.64
     rank  1: 43.26
     rank  2: 43.22
     rank  3: 43.29
     rank  4: 331.86
     rank  5: 331.82
     rank  6: 330.88
     rank  7: 335.86
     rank  8: 230.82
     rank  9: 230.72
     rank 10: 230.83
     rank 11: 230.84
     rank 12: 169.99
     rank 13: 169.94
     rank 14: 169.97
     rank 15: 170.07
  optimizer:
     rank  0: 42.90
     rank  1: 44.54
     rank  2: 44.49
     rank  3: 44.57
     rank  4: 333.10
     rank  5: 333.09
     rank  6: 332.14
     rank  7: 337.19
     rank  8: 232.03
     rank  9: 231.99
     rank 10: 232.10
     rank 11: 232.14
     rank 12: 171.26
     rank 13: 171.22
     rank 14: 171.25
     rank 15: 171.34
 [2024-12-30 21:25:06] iteration        2/      10 | consumed samples:           64 | elapsed time per iteration (ms): 3508.9 | learning rate: 1.500000E-06 | global batch size:    32 | lm loss: 7.105109E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 3368.73
     rank  1: 3368.70
     rank  2: 3368.65
     rank  3: 3368.65
     rank  4: 3374.67
     rank  5: 3374.57
     rank  6: 3374.55
     rank  7: 3374.60
     rank  8: 3373.33
     rank  9: 3373.34
     rank 10: 3373.31
     rank 11: 3373.33
     rank 12: 3374.57
     rank 13: 3374.50
     rank 14: 3374.51
     rank 15: 3374.58
  forward-compute:
     rank  0: 468.25
     rank  1: 598.02
     rank  2: 557.39
     rank  3: 535.12
     rank  4: 554.26
     rank  5: 574.30
     rank  6: 551.88
     rank  7: 553.66
     rank  8: 531.19
     rank  9: 528.29
     rank 10: 526.34
     rank 11: 529.69
     rank 12: 775.34
     rank 13: 692.74
     rank 14: 655.98
     rank 15: 651.20
  backward-compute:
     rank  0: 459.64
     rank  1: 492.38
     rank  2: 482.79
     rank  3: 443.54
     rank  4: 1212.08
     rank  5: 1260.70
     rank  6: 1279.65
     rank  7: 1281.92
     rank  8: 1034.37
     rank  9: 1032.05
     rank 10: 1028.02
     rank 11: 1037.60
     rank 12: 1218.49
     rank 13: 1218.15
     rank 14: 1238.10
     rank 15: 1230.11
  pure-backward-compute:
     rank  0: 459.20
     rank  1: 491.79
     rank  2: 482.41
     rank  3: 443.20
     rank  4: 1211.42
     rank  5: 1260.00
     rank  6: 1278.63
     rank  7: 1280.91
     rank  8: 1033.31
     rank  9: 1031.08
     rank 10: 1027.20
     rank 11: 1036.78
     rank 12: 1216.27
     rank 13: 1216.95
     rank 14: 1236.73
     rank 15: 1228.58
  batch-generator:
     rank  0: 23.93
     rank  1: 36.90
     rank  2: 25.73
     rank  3: 30.07
     rank  4: 28.36
     rank  5: 37.76
     rank  6: 38.36
     rank  7: 36.61
     rank  8: 29.25
     rank  9: 29.18
     rank 10: 29.34
     rank 11: 29.84
     rank 12: 30.99
     rank 13: 26.33
     rank 14: 28.63
     rank 15: 30.32
  forward-recv:
     rank  4: 54.62
     rank  5: 81.46
     rank  6: 80.54
     rank  7: 77.32
     rank  8: 126.84
     rank  9: 147.32
     rank 10: 145.89
     rank 11: 144.40
     rank 12: 190.89
     rank 13: 206.21
     rank 14: 207.63
     rank 15: 210.00
  forward-send:
     rank  0: 22.48
     rank  1: 7.95
     rank  2: 4.52
     rank  3: 4.53
     rank  4: 3.39
     rank  5: 3.32
     rank  6: 4.77
     rank  7: 5.14
     rank  8: 1.63
     rank  9: 1.77
     rank 10: 1.58
     rank 11: 1.78
  backward-recv:
     rank  0: 604.40
     rank  1: 530.11
     rank  2: 534.61
     rank  3: 541.09
     rank  4: 223.03
     rank  5: 214.79
     rank  6: 216.76
     rank  7: 214.45
     rank  8: 106.62
     rank  9: 105.07
     rank 10: 109.47
     rank 11: 103.81
  backward-send:
     rank  4: 3.27
     rank  5: 2.84
     rank  6: 3.56
     rank  7: 3.37
     rank  8: 6.73
     rank  9: 7.45
     rank 10: 6.13
     rank 11: 6.92
     rank 12: 2.70
     rank 13: 1.94
     rank 14: 2.60
     rank 15: 1.84
  forward-send-backward-recv:
     rank  0: 971.13
     rank  1: 905.08
     rank  2: 952.38
     rank  3: 1000.00
     rank  4: 418.52
     rank  5: 327.78
     rank  6: 328.18
     rank  7: 325.23
     rank  8: 443.83
     rank  9: 298.39
     rank 10: 301.08
     rank 11: 294.27
  backward-send-forward-recv:
     rank  4: 6.90
     rank  5: 8.32
     rank  6: 7.73
     rank  7: 9.96
     rank  8: 91.63
     rank  9: 220.22
     rank 10: 224.20
     rank 11: 221.03
     rank 12: 23.50
     rank 13: 90.37
     rank 14: 107.41
     rank 15: 114.56
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.07
     rank  1: 0.07
     rank  2: 0.05
     rank  3: 0.04
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.08
     rank 13: 0.05
     rank 14: 0.07
     rank 15: 0.07
  all-grads-sync:
     rank  0: 309.09
     rank  1: 309.08
     rank  2: 309.15
     rank  3: 308.99
     rank  4: 823.34
     rank  5: 823.31
     rank  6: 823.32
     rank  7: 823.31
     rank  8: 693.25
     rank  9: 693.23
     rank 10: 693.24
     rank 11: 693.23
     rank 12: 817.32
     rank 13: 817.32
     rank 14: 817.27
     rank 15: 817.32
  optimizer-copy-to-main-grad:
     rank  0: 0.26
     rank  1: 0.25
     rank  2: 0.18
     rank  3: 0.18
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.07
     rank  7: 0.05
     rank  8: 0.05
     rank  9: 0.05
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.06
     rank 13: 0.04
     rank 14: 0.05
     rank 15: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 38.13
     rank  1: 38.18
     rank  2: 37.96
     rank  3: 37.74
     rank  4: 98.81
     rank  5: 98.70
     rank  6: 98.88
     rank  7: 98.83
     rank  8: 85.62
     rank  9: 85.72
     rank 10: 85.62
     rank 11: 85.76
     rank 12: 98.81
     rank 13: 98.67
     rank 14: 98.84
     rank 15: 98.68
  optimizer:
     rank  0: 39.13
     rank  1: 39.09
     rank  2: 38.85
     rank  3: 38.64
     rank  4: 99.71
     rank  5: 99.61
     rank  6: 99.78
     rank  7: 99.73
     rank  8: 86.52
     rank  9: 86.63
     rank 10: 86.52
     rank 11: 86.67
     rank 12: 99.71
     rank 13: 99.57
     rank 14: 99.74
     rank 15: 99.59
 [2024-12-30 21:25:10] iteration        3/      10 | consumed samples:           96 | elapsed time per iteration (ms): 3419.2 | learning rate: 2.250000E-06 | global batch size:    32 | lm loss: 6.529927E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 3281.17
     rank  1: 3281.15
     rank  2: 3281.17
     rank  3: 3281.23
     rank  4: 3287.14
     rank  5: 3287.10
     rank  6: 3287.14
     rank  7: 3287.18
     rank  8: 3285.96
     rank  9: 3285.96
     rank 10: 3285.94
     rank 11: 3286.02
     rank 12: 3287.02
     rank 13: 3287.00
     rank 14: 3287.02
     rank 15: 3287.12
  forward-compute:
     rank  0: 556.92
     rank  1: 554.03
     rank  2: 432.53
     rank  3: 420.79
     rank  4: 546.81
     rank  5: 541.88
     rank  6: 558.18
     rank  7: 551.00
     rank  8: 530.89
     rank  9: 527.67
     rank 10: 527.07
     rank 11: 535.41
     rank 12: 658.79
     rank 13: 649.98
     rank 14: 669.92
     rank 15: 684.09
  backward-compute:
     rank  0: 432.86
     rank  1: 432.58
     rank  2: 482.67
     rank  3: 455.24
     rank  4: 1049.23
     rank  5: 1050.48
     rank  6: 1045.29
     rank  7: 1051.01
     rank  8: 1036.57
     rank  9: 1027.68
     rank 10: 1028.10
     rank 11: 1033.66
     rank 12: 1229.86
     rank 13: 1235.04
     rank 14: 1239.59
     rank 15: 1220.96
  pure-backward-compute:
     rank  0: 432.27
     rank  1: 431.96
     rank  2: 482.34
     rank  3: 454.90
     rank  4: 1048.29
     rank  5: 1049.91
     rank  6: 1044.34
     rank  7: 1050.15
     rank  8: 1035.46
     rank  9: 1026.61
     rank 10: 1027.34
     rank 11: 1032.49
     rank 12: 1228.24
     rank 13: 1233.90
     rank 14: 1238.19
     rank 15: 1219.51
  batch-generator:
     rank  0: 32.77
     rank  1: 28.76
     rank  2: 23.76
     rank  3: 20.96
     rank  4: 34.97
     rank  5: 26.30
     rank  6: 42.29
     rank  7: 33.62
     rank  8: 26.95
     rank  9: 28.58
     rank 10: 27.92
     rank 11: 31.61
     rank 12: 29.28
     rank 13: 23.01
     rank 14: 27.54
     rank 15: 31.72
  forward-recv:
     rank  4: 75.79
     rank  5: 74.38
     rank  6: 55.10
     rank  7: 54.14
     rank  8: 141.38
     rank  9: 145.31
     rank 10: 124.35
     rank 11: 126.08
     rank 12: 203.92
     rank 13: 206.89
     rank 14: 188.79
     rank 15: 190.00
  forward-send:
     rank  0: 3.39
     rank  1: 4.36
     rank  2: 33.15
     rank  3: 38.40
     rank  4: 3.14
     rank  5: 3.62
     rank  6: 3.62
     rank  7: 4.00
     rank  8: 1.63
     rank  9: 1.63
     rank 10: 1.68
     rank 11: 1.90
  backward-recv:
     rank  0: 555.64
     rank  1: 560.94
     rank  2: 539.06
     rank  3: 546.58
     rank  4: 213.43
     rank  5: 211.82
     rank  6: 212.17
     rank  7: 209.02
     rank  8: 109.31
     rank  9: 108.68
     rank 10: 108.98
     rank 11: 109.58
  backward-send:
     rank  4: 4.50
     rank  5: 3.99
     rank  6: 5.65
     rank  7: 4.74
     rank  8: 6.39
     rank  9: 5.59
     rank 10: 5.85
     rank 11: 3.47
     rank 12: 3.41
     rank 13: 3.33
     rank 14: 2.47
     rank 15: 2.02
  forward-send-backward-recv:
     rank  0: 891.05
     rank  1: 887.38
     rank  2: 959.20
     rank  3: 983.01
     rank  4: 485.29
     rank  5: 493.15
     rank  6: 497.78
     rank  7: 503.94
     rank  8: 404.67
     rank  9: 411.38
     rank 10: 434.77
     rank 11: 419.71
  backward-send-forward-recv:
     rank  4: 12.26
     rank  5: 10.56
     rank  6: 11.30
     rank  7: 8.99
     rank  8: 27.66
     rank  9: 28.37
     rank 10: 28.00
     rank 11: 24.18
     rank 12: 30.18
     rank 13: 31.24
     rank 14: 26.71
     rank 15: 26.51
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.05
  embedding-grads-all-reduce:
     rank  0: 0.07
     rank  1: 0.06
     rank  2: 0.04
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.07
     rank 13: 0.05
     rank 14: 0.07
     rank 15: 0.13
  all-grads-sync:
     rank  0: 308.83
     rank  1: 308.88
     rank  2: 308.90
     rank  3: 308.79
     rank  4: 822.72
     rank  5: 822.72
     rank  6: 822.71
     rank  7: 822.75
     rank  8: 700.67
     rank  9: 700.68
     rank 10: 700.66
     rank 11: 700.61
     rank 12: 824.11
     rank 13: 824.17
     rank 14: 824.12
     rank 15: 824.07
  optimizer-copy-to-main-grad:
     rank  0: 0.26
     rank  1: 0.37
     rank  2: 0.18
     rank  3: 0.18
     rank  4: 0.04
     rank  5: 0.03
     rank  6: 0.04
     rank  7: 0.05
     rank  8: 0.06
     rank  9: 0.06
     rank 10: 0.06
     rank 11: 0.06
     rank 12: 0.05
     rank 13: 0.04
     rank 14: 0.05
     rank 15: 0.11
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 37.78
     rank  1: 37.94
     rank  2: 37.89
     rank  3: 37.89
     rank  4: 98.69
     rank  5: 98.65
     rank  6: 98.75
     rank  7: 98.71
     rank  8: 85.73
     rank  9: 85.76
     rank 10: 85.74
     rank 11: 85.81
     rank 12: 98.75
     rank 13: 98.68
     rank 14: 98.78
     rank 15: 98.86
  optimizer:
     rank  0: 38.91
     rank  1: 39.07
     rank  2: 39.00
     rank  3: 39.00
     rank  4: 99.87
     rank  5: 99.77
     rank  6: 99.87
     rank  7: 99.83
     rank  8: 86.85
     rank  9: 86.87
     rank 10: 86.85
     rank 11: 87.01
     rank 12: 99.87
     rank 13: 99.80
     rank 14: 99.91
     rank 15: 100.10
 [2024-12-30 21:25:13] iteration        4/      10 | consumed samples:          128 | elapsed time per iteration (ms): 3422.7 | learning rate: 3.000000E-06 | global batch size:    32 | lm loss: 4.201710E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 3285.39
     rank  1: 3285.41
     rank  2: 3285.42
     rank  3: 3285.42
     rank  4: 3291.44
     rank  5: 3291.43
     rank  6: 3291.66
     rank  7: 3291.49
     rank  8: 3290.15
     rank  9: 3290.18
     rank 10: 3290.22
     rank 11: 3290.18
     rank 12: 3291.38
     rank 13: 3291.32
     rank 14: 3291.37
     rank 15: 3291.38
  forward-compute:
     rank  0: 493.61
     rank  1: 468.84
     rank  2: 428.75
     rank  3: 422.69
     rank  4: 536.15
     rank  5: 533.36
     rank  6: 556.21
     rank  7: 549.46
     rank  8: 530.25
     rank  9: 529.84
     rank 10: 529.69
     rank 11: 538.21
     rank 12: 650.69
     rank 13: 661.10
     rank 14: 658.37
     rank 15: 689.74
  backward-compute:
     rank  0: 440.45
     rank  1: 450.69
     rank  2: 484.46
     rank  3: 452.19
     rank  4: 1050.64
     rank  5: 1053.89
     rank  6: 1049.60
     rank  7: 1056.84
     rank  8: 1034.83
     rank  9: 1031.93
     rank 10: 1031.26
     rank 11: 1036.79
     rank 12: 1235.94
     rank 13: 1233.86
     rank 14: 1237.53
     rank 15: 1217.90
  pure-backward-compute:
     rank  0: 440.04
     rank  1: 449.80
     rank  2: 484.06
     rank  3: 451.87
     rank  4: 1050.07
     rank  5: 1053.39
     rank  6: 1048.60
     rank  7: 1056.13
     rank  8: 1034.01
     rank  9: 1030.79
     rank 10: 1030.53
     rank 11: 1035.97
     rank 12: 1234.40
     rank 13: 1232.62
     rank 14: 1235.92
     rank 15: 1216.49
  batch-generator:
     rank  0: 32.05
     rank  1: 38.67
     rank  2: 22.48
     rank  3: 22.67
     rank  4: 23.88
     rank  5: 21.97
     rank  6: 37.34
     rank  7: 31.37
     rank  8: 26.37
     rank  9: 28.05
     rank 10: 26.82
     rank 11: 32.36
     rank 12: 27.90
     rank 13: 22.26
     rank 14: 26.63
     rank 15: 35.64
  forward-recv:
     rank  4: 70.47
     rank  5: 57.77
     rank  6: 55.90
     rank  7: 54.88
     rank  8: 140.70
     rank  9: 127.45
     rank 10: 127.07
     rank 11: 126.22
     rank 12: 203.28
     rank 13: 193.27
     rank 14: 193.27
     rank 15: 193.11
  forward-send:
     rank  0: 4.25
     rank  1: 34.50
     rank  2: 40.87
     rank  3: 42.50
     rank  4: 3.24
     rank  5: 8.08
     rank  6: 7.94
     rank  7: 9.08
     rank  8: 1.58
     rank  9: 3.94
     rank 10: 4.04
     rank 11: 4.07
  backward-recv:
     rank  0: 563.93
     rank  1: 550.08
     rank  2: 547.35
     rank  3: 555.67
     rank  4: 217.28
     rank  5: 214.34
     rank  6: 215.58
     rank  7: 215.52
     rank  8: 107.37
     rank  9: 107.39
     rank 10: 107.53
     rank 11: 107.05
  backward-send:
     rank  4: 4.37
     rank  5: 5.24
     rank  6: 5.63
     rank  7: 2.68
     rank  8: 7.78
     rank  9: 7.54
     rank 10: 7.85
     rank 11: 3.81
     rank 12: 3.61
     rank 13: 3.65
     rank 14: 3.70
     rank 15: 1.65
  forward-send-backward-recv:
     rank  0: 943.03
     rank  1: 936.58
     rank  2: 949.29
     rank  3: 965.96
     rank  4: 495.86
     rank  5: 505.34
     rank  6: 485.37
     rank  7: 487.52
     rank  8: 410.15
     rank  9: 422.02
     rank 10: 423.98
     rank 11: 419.55
  backward-send-forward-recv:
     rank  4: 11.61
     rank  5: 11.32
     rank  6: 10.34
     rank  7: 7.24
     rank  8: 23.84
     rank  9: 25.27
     rank 10: 24.41
     rank 11: 14.29
     rank 12: 29.71
     rank 13: 31.00
     rank 14: 29.76
     rank 15: 16.74
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.04
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.05
     rank  2: 0.05
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.04
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.07
     rank 13: 0.05
     rank 14: 0.07
     rank 15: 0.07
  all-grads-sync:
     rank  0: 309.08
     rank  1: 309.26
     rank  2: 309.21
     rank  3: 309.07
     rank  4: 822.60
     rank  5: 822.53
     rank  6: 822.60
     rank  7: 822.66
     rank  8: 701.76
     rank  9: 701.69
     rank 10: 701.76
     rank 11: 701.75
     rank 12: 824.47
     rank 13: 824.48
     rank 14: 824.51
     rank 15: 824.48
  optimizer-copy-to-main-grad:
     rank  0: 0.19
     rank  1: 0.20
     rank  2: 0.19
     rank  3: 0.17
     rank  4: 0.04
     rank  5: 0.03
     rank  6: 0.05
     rank  7: 0.10
     rank  8: 0.06
     rank  9: 0.06
     rank 10: 0.06
     rank 11: 0.07
     rank 12: 0.05
     rank 13: 0.04
     rank 14: 0.10
     rank 15: 0.06
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.05
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 37.92
     rank  1: 38.01
     rank  2: 37.88
     rank  3: 37.84
     rank  4: 98.70
     rank  5: 98.88
     rank  6: 99.14
     rank  7: 99.27
     rank  8: 85.76
     rank  9: 85.87
     rank 10: 85.74
     rank 11: 85.86
     rank 12: 98.78
     rank 13: 98.65
     rank 14: 98.84
     rank 15: 98.85
  optimizer:
     rank  0: 38.89
     rank  1: 38.98
     rank  2: 38.86
     rank  3: 38.82
     rank  4: 99.67
     rank  5: 99.86
     rank  6: 100.12
     rank  7: 100.27
     rank  8: 86.73
     rank  9: 86.88
     rank 10: 86.71
     rank 11: 86.84
     rank 12: 99.79
     rank 13: 99.63
     rank 14: 99.81
     rank 15: 99.83
 [2024-12-30 21:25:16] iteration        5/      10 | consumed samples:          160 | elapsed time per iteration (ms): 3415.5 | learning rate: 3.750000E-06 | global batch size:    32 | lm loss: 2.102496E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 3277.98
     rank  1: 3277.93
     rank  2: 3277.92
     rank  3: 3277.92
     rank  4: 3283.85
     rank  5: 3283.82
     rank  6: 3283.88
     rank  7: 3283.86
     rank  8: 3282.62
     rank  9: 3282.63
     rank 10: 3282.60
     rank 11: 3282.64
     rank 12: 3283.85
     rank 13: 3283.82
     rank 14: 3283.80
     rank 15: 3283.87
  forward-compute:
     rank  0: 430.15
     rank  1: 454.86
     rank  2: 432.68
     rank  3: 421.01
     rank  4: 536.70
     rank  5: 535.16
     rank  6: 561.94
     rank  7: 562.72
     rank  8: 533.67
     rank  9: 528.51
     rank 10: 524.01
     rank 11: 534.42
     rank 12: 662.59
     rank 13: 651.15
     rank 14: 653.43
     rank 15: 666.98
  backward-compute:
     rank  0: 430.31
     rank  1: 440.21
     rank  2: 476.96
     rank  3: 441.15
     rank  4: 1054.98
     rank  5: 1052.79
     rank  6: 1049.09
     rank  7: 1057.13
     rank  8: 1037.15
     rank  9: 1031.04
     rank 10: 1030.39
     rank 11: 1036.97
     rank 12: 1236.39
     rank 13: 1240.08
     rank 14: 1243.64
     rank 15: 1229.72
  pure-backward-compute:
     rank  0: 429.92
     rank  1: 439.41
     rank  2: 476.59
     rank  3: 440.81
     rank  4: 1054.43
     rank  5: 1052.32
     rank  6: 1047.81
     rank  7: 1056.28
     rank  8: 1036.35
     rank  9: 1030.25
     rank 10: 1029.77
     rank 11: 1036.11
     rank 12: 1234.82
     rank 13: 1238.58
     rank 14: 1242.20
     rank 15: 1228.29
  batch-generator:
     rank  0: 25.79
     rank  1: 38.19
     rank  2: 24.15
     rank  3: 21.89
     rank  4: 23.35
     rank  5: 22.52
     rank  6: 41.44
     rank  7: 40.13
     rank  8: 27.87
     rank  9: 25.76
     rank 10: 22.02
     rank 11: 29.54
     rank 12: 29.77
     rank 13: 29.19
     rank 14: 22.82
     rank 15: 30.33
  forward-recv:
     rank  4: 56.86
     rank  5: 57.78
     rank  6: 58.39
     rank  7: 57.38
     rank  8: 127.73
     rank  9: 128.37
     rank 10: 131.43
     rank 11: 130.56
     rank 12: 192.70
     rank 13: 196.02
     rank 14: 196.07
     rank 15: 196.15
  forward-send:
     rank  0: 38.04
     rank  1: 34.95
     rank  2: 41.32
     rank  3: 43.31
     rank  4: 4.78
     rank  5: 7.84
     rank  6: 6.86
     rank  7: 7.38
     rank  8: 1.78
     rank  9: 4.12
     rank 10: 4.04
     rank 11: 4.16
  backward-recv:
     rank  0: 556.77
     rank  1: 549.80
     rank  2: 543.03
     rank  3: 554.52
     rank  4: 212.37
     rank  5: 210.91
     rank  6: 219.53
     rank  7: 215.34
     rank  8: 106.35
     rank  9: 106.10
     rank 10: 108.07
     rank 11: 108.38
  backward-send:
     rank  4: 3.07
     rank  5: 3.07
     rank  6: 3.69
     rank  7: 3.94
     rank  8: 5.44
     rank  9: 4.90
     rank 10: 5.70
     rank 11: 4.31
     rank 12: 1.65
     rank 13: 2.63
     rank 14: 1.71
     rank 15: 2.47
  forward-send-backward-recv:
     rank  0: 983.66
     rank  1: 957.01
     rank  2: 949.38
     rank  3: 982.26
     rank  4: 507.44
     rank  5: 507.23
     rank  6: 475.27
     rank  7: 468.86
     rank  8: 416.17
     rank  9: 420.42
     rank 10: 425.50
     rank 11: 408.58
  backward-send-forward-recv:
     rank  4: 11.55
     rank  5: 11.39
     rank  6: 11.14
     rank  7: 12.11
     rank  8: 26.63
     rank  9: 28.88
     rank 10: 26.80
     rank 11: 24.96
     rank 12: 29.25
     rank 13: 30.98
     rank 14: 29.55
     rank 15: 24.92
  layernorm-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.08
     rank  1: 0.05
     rank  2: 0.05
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.07
     rank 13: 0.07
     rank 14: 0.05
     rank 15: 0.07
  all-grads-sync:
     rank  0: 309.61
     rank  1: 309.69
     rank  2: 309.68
     rank  3: 309.56
     rank  4: 819.23
     rank  5: 819.23
     rank  6: 819.22
     rank  7: 819.24
     rank  8: 697.20
     rank  9: 697.07
     rank 10: 697.20
     rank 11: 697.17
     rank 12: 824.36
     rank 13: 824.36
     rank 14: 824.38
     rank 15: 824.33
  optimizer-copy-to-main-grad:
     rank  0: 0.21
     rank  1: 0.20
     rank  2: 0.18
     rank  3: 0.17
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.05
     rank  7: 0.04
     rank  8: 0.04
     rank  9: 0.06
     rank 10: 0.04
     rank 11: 0.05
     rank 12: 0.06
     rank 13: 0.05
     rank 14: 0.14
     rank 15: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 38.03
     rank  1: 37.75
     rank  2: 37.86
     rank  3: 37.61
     rank  4: 98.68
     rank  5: 98.62
     rank  6: 98.89
     rank  7: 98.69
     rank  8: 85.68
     rank  9: 85.81
     rank 10: 85.72
     rank 11: 85.73
     rank 12: 98.83
     rank 13: 98.77
     rank 14: 98.70
     rank 15: 98.70
  optimizer:
     rank  0: 40.13
     rank  1: 39.84
     rank  2: 39.95
     rank  3: 39.70
     rank  4: 100.78
     rank  5: 100.73
     rank  6: 100.98
     rank  7: 100.78
     rank  8: 87.79
     rank  9: 87.92
     rank 10: 87.82
     rank 11: 87.86
     rank 12: 100.94
     rank 13: 100.88
     rank 14: 100.80
     rank 15: 100.81
 [2024-12-30 21:25:20] iteration        6/      10 | consumed samples:          192 | elapsed time per iteration (ms): 3412.4 | learning rate: 4.500000E-06 | global batch size:    32 | lm loss: 3.264702E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 3276.72
     rank  1: 3276.80
     rank  2: 3276.72
     rank  3: 3276.72
     rank  4: 3282.64
     rank  5: 3282.62
     rank  6: 3282.62
     rank  7: 3282.70
     rank  8: 3281.34
     rank  9: 3281.36
     rank 10: 3281.37
     rank 11: 3281.39
     rank 12: 3282.49
     rank 13: 3282.51
     rank 14: 3282.49
     rank 15: 3282.52
  forward-compute:
     rank  0: 432.21
     rank  1: 455.26
     rank  2: 431.43
     rank  3: 422.91
     rank  4: 537.07
     rank  5: 532.94
     rank  6: 546.05
     rank  7: 541.03
     rank  8: 527.44
     rank  9: 528.52
     rank 10: 530.05
     rank 11: 537.74
     rank 12: 659.85
     rank 13: 649.02
     rank 14: 666.96
     rank 15: 697.20
  backward-compute:
     rank  0: 435.13
     rank  1: 441.34
     rank  2: 476.14
     rank  3: 450.52
     rank  4: 1054.32
     rank  5: 1054.00
     rank  6: 1048.11
     rank  7: 1058.38
     rank  8: 1037.75
     rank  9: 1032.70
     rank 10: 1032.29
     rank 11: 1037.16
     rank 12: 1238.67
     rank 13: 1252.50
     rank 14: 1236.02
     rank 15: 1215.98
  pure-backward-compute:
     rank  0: 434.60
     rank  1: 440.52
     rank  2: 475.81
     rank  3: 450.20
     rank  4: 1053.81
     rank  5: 1053.52
     rank  6: 1047.36
     rank  7: 1057.85
     rank  8: 1037.07
     rank  9: 1031.82
     rank 10: 1031.56
     rank 11: 1036.24
     rank 12: 1237.45
     rank 13: 1251.18
     rank 14: 1234.77
     rank 15: 1214.85
  batch-generator:
     rank  0: 28.22
     rank  1: 38.29
     rank  2: 22.01
     rank  3: 21.77
     rank  4: 23.46
     rank  5: 21.26
     rank  6: 32.58
     rank  7: 22.88
     rank  8: 22.49
     rank  9: 26.14
     rank 10: 25.71
     rank 11: 29.87
     rank 12: 25.30
     rank 13: 25.93
     rank 14: 23.51
     rank 15: 25.44
  forward-recv:
     rank  4: 56.36
     rank  5: 57.12
     rank  6: 57.05
     rank  7: 54.30
     rank  8: 127.21
     rank  9: 128.70
     rank 10: 129.82
     rank 11: 126.19
     rank 12: 194.37
     rank 13: 195.03
     rank 14: 194.54
     rank 15: 190.73
  forward-send:
     rank  0: 36.17
     rank  1: 37.53
     rank  2: 38.89
     rank  3: 35.62
     rank  4: 7.32
     rank  5: 8.78
     rank  6: 7.21
     rank  7: 4.56
     rank  8: 3.51
     rank  9: 3.50
     rank 10: 3.51
     rank 11: 1.68
  backward-recv:
     rank  0: 555.41
     rank  1: 549.00
     rank  2: 543.38
     rank  3: 550.36
     rank  4: 214.26
     rank  5: 213.97
     rank  6: 217.78
     rank  7: 214.40
     rank  8: 108.22
     rank  9: 107.98
     rank 10: 107.36
     rank 11: 110.48
  backward-send:
     rank  4: 3.79
     rank  5: 3.94
     rank  6: 3.60
     rank  7: 2.95
     rank  8: 6.05
     rank  9: 6.56
     rank 10: 5.58
     rank 11: 3.08
     rank 12: 3.11
     rank 13: 2.23
     rank 14: 3.04
     rank 15: 1.69
  forward-send-backward-recv:
     rank  0: 982.46
     rank  1: 956.90
     rank  2: 950.96
     rank  3: 980.65
     rank  4: 503.39
     rank  5: 506.11
     rank  6: 495.59
     rank  7: 499.84
     rank  8: 420.06
     rank  9: 421.71
     rank 10: 428.59
     rank 11: 421.15
  backward-send-forward-recv:
     rank  4: 11.84
     rank  5: 11.99
     rank  6: 8.52
     rank  7: 7.28
     rank  8: 24.90
     rank  9: 25.23
     rank 10: 15.96
     rank 11: 12.34
     rank 12: 25.37
     rank 13: 23.85
     rank 14: 20.92
     rank 15: 13.33
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.04
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.07
     rank  2: 0.05
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.04
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.05
     rank 13: 0.07
     rank 14: 0.05
     rank 15: 0.05
  all-grads-sync:
     rank  0: 309.69
     rank  1: 309.79
     rank  2: 309.72
     rank  3: 309.62
     rank  4: 818.68
     rank  5: 818.70
     rank  6: 818.70
     rank  7: 818.76
     rank  8: 694.76
     rank  9: 694.74
     rank 10: 694.74
     rank 11: 694.73
     rank 12: 823.18
     rank 13: 823.17
     rank 14: 823.18
     rank 15: 823.13
  optimizer-copy-to-main-grad:
     rank  0: 0.21
     rank  1: 0.26
     rank  2: 0.18
     rank  3: 0.18
     rank  4: 0.04
     rank  5: 0.03
     rank  6: 0.04
     rank  7: 0.08
     rank  8: 0.08
     rank  9: 0.05
     rank 10: 0.06
     rank 11: 0.05
     rank 12: 0.04
     rank 13: 0.05
     rank 14: 0.04
     rank 15: 0.08
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 37.93
     rank  1: 38.16
     rank  2: 37.87
     rank  3: 37.86
     rank  4: 98.67
     rank  5: 98.64
     rank  6: 98.76
     rank  7: 98.81
     rank  8: 85.59
     rank  9: 85.70
     rank 10: 85.67
     rank 11: 85.65
     rank 12: 98.70
     rank 13: 98.76
     rank 14: 98.71
     rank 15: 98.69
  optimizer:
     rank  0: 38.87
     rank  1: 39.10
     rank  2: 38.80
     rank  3: 38.79
     rank  4: 99.60
     rank  5: 99.58
     rank  6: 99.69
     rank  7: 99.75
     rank  8: 86.53
     rank  9: 86.71
     rank 10: 86.61
     rank 11: 86.65
     rank 12: 99.64
     rank 13: 99.70
     rank 14: 99.65
     rank 15: 99.63
 [2024-12-30 21:25:23] iteration        7/      10 | consumed samples:          224 | elapsed time per iteration (ms): 3430.9 | learning rate: 5.250000E-06 | global batch size:    32 | lm loss: 3.563227E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 3295.51
     rank  1: 3295.51
     rank  2: 3295.51
     rank  3: 3295.53
     rank  4: 3301.44
     rank  5: 3301.41
     rank  6: 3301.45
     rank  7: 3301.45
     rank  8: 3300.16
     rank  9: 3300.15
     rank 10: 3300.19
     rank 11: 3300.19
     rank 12: 3301.34
     rank 13: 3301.36
     rank 14: 3301.34
     rank 15: 3301.37
  forward-compute:
     rank  0: 424.09
     rank  1: 467.32
     rank  2: 429.80
     rank  3: 420.70
     rank  4: 536.72
     rank  5: 533.46
     rank  6: 540.73
     rank  7: 550.28
     rank  8: 524.93
     rank  9: 525.99
     rank 10: 533.44
     rank 11: 532.36
     rank 12: 680.81
     rank 13: 650.23
     rank 14: 703.09
     rank 15: 709.95
  backward-compute:
     rank  0: 435.91
     rank  1: 418.63
     rank  2: 478.09
     rank  3: 453.52
     rank  4: 1055.71
     rank  5: 1052.68
     rank  6: 1049.09
     rank  7: 1058.62
     rank  8: 1036.90
     rank  9: 1030.05
     rank 10: 1033.58
     rank 11: 1036.47
     rank 12: 1239.69
     rank 13: 1251.43
     rank 14: 1226.01
     rank 15: 1215.10
  pure-backward-compute:
     rank  0: 435.31
     rank  1: 418.29
     rank  2: 477.76
     rank  3: 453.19
     rank  4: 1054.99
     rank  5: 1052.23
     rank  6: 1048.48
     rank  7: 1058.02
     rank  8: 1036.25
     rank  9: 1029.40
     rank 10: 1032.81
     rank 11: 1035.84
     rank 12: 1238.39
     rank 13: 1249.96
     rank 14: 1224.77
     rank 15: 1213.92
  batch-generator:
     rank  0: 22.14
     rank  1: 26.32
     rank  2: 22.96
     rank  3: 21.40
     rank  4: 22.54
     rank  5: 20.47
     rank  6: 27.93
     rank  7: 28.14
     rank  8: 20.78
     rank  9: 23.43
     rank 10: 28.43
     rank 11: 26.85
     rank 12: 24.32
     rank 13: 26.39
     rank 14: 25.06
     rank 15: 27.34
  forward-recv:
     rank  4: 56.32
     rank  5: 79.56
     rank  6: 55.18
     rank  7: 54.90
     rank  8: 128.40
     rank  9: 147.10
     rank 10: 125.94
     rank 11: 127.60
     rank 12: 192.32
     rank 13: 212.80
     rank 14: 192.64
     rank 15: 192.78
  forward-send:
     rank  0: 35.10
     rank  1: 20.00
     rank  2: 34.07
     rank  3: 39.08
     rank  4: 7.25
     rank  5: 3.16
     rank  6: 7.17
     rank  7: 7.44
     rank  8: 3.44
     rank  9: 1.62
     rank 10: 3.79
     rank 11: 3.88
  backward-recv:
     rank  0: 553.48
     rank  1: 564.81
     rank  2: 556.02
     rank  3: 548.67
     rank  4: 216.96
     rank  5: 216.82
     rank  6: 226.65
     rank  7: 215.32
     rank  8: 112.66
     rank  9: 111.85
     rank 10: 113.91
     rank 11: 111.25
  backward-send:
     rank  4: 3.29
     rank  5: 2.46
     rank  6: 3.59
     rank  7: 2.94
     rank  8: 4.73
     rank  9: 3.93
     rank 10: 4.86
     rank 11: 3.05
     rank 12: 2.91
     rank 13: 2.16
     rank 14: 2.66
     rank 15: 1.59
  forward-send-backward-recv:
     rank  0: 1009.45
     rank  1: 987.14
     rank  2: 967.32
     rank  3: 993.81
     rank  4: 524.67
     rank  5: 512.59
     rank  6: 520.20
     rank  7: 503.85
     rank  8: 441.82
     rank  9: 431.38
     rank 10: 447.64
     rank 11: 440.91
  backward-send-forward-recv:
     rank  4: 8.50
     rank  5: 7.47
     rank  6: 6.63
     rank  7: 6.91
     rank  8: 24.25
     rank  9: 23.55
     rank 10: 12.66
     rank 11: 11.63
     rank 12: 27.61
     rank 13: 27.60
     rank 14: 18.14
     rank 15: 17.35
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.05
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.05
     rank  2: 0.05
     rank  3: 0.04
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.04
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.05
     rank 13: 0.07
     rank 14: 0.05
     rank 15: 0.06
  all-grads-sync:
     rank  0: 303.55
     rank  1: 303.73
     rank  2: 303.67
     rank  3: 303.53
     rank  4: 806.68
     rank  5: 806.66
     rank  6: 806.69
     rank  7: 806.67
     rank  8: 695.18
     rank  9: 695.15
     rank 10: 695.15
     rank 11: 695.16
     rank 12: 820.00
     rank 13: 819.98
     rank 14: 819.99
     rank 15: 819.96
  optimizer-copy-to-main-grad:
     rank  0: 0.19
     rank  1: 0.19
     rank  2: 0.19
     rank  3: 0.18
     rank  4: 0.05
     rank  5: 0.03
     rank  6: 0.08
     rank  7: 0.03
     rank  8: 0.04
     rank  9: 0.03
     rank 10: 0.05
     rank 11: 0.04
     rank 12: 0.04
     rank 13: 0.05
     rank 14: 0.04
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 37.81
     rank  1: 37.90
     rank  2: 37.91
     rank  3: 37.59
     rank  4: 98.77
     rank  5: 98.62
     rank  6: 98.95
     rank  7: 98.61
     rank  8: 85.60
     rank  9: 85.58
     rank 10: 85.75
     rank 11: 85.73
     rank 12: 98.70
     rank 13: 98.72
     rank 14: 98.78
     rank 15: 98.63
  optimizer:
     rank  0: 38.50
     rank  1: 38.59
     rank  2: 38.61
     rank  3: 38.29
     rank  4: 99.47
     rank  5: 99.32
     rank  6: 99.75
     rank  7: 99.30
     rank  8: 86.30
     rank  9: 86.28
     rank 10: 86.46
     rank 11: 86.42
     rank 12: 99.40
     rank 13: 99.42
     rank 14: 99.48
     rank 15: 99.33
 [2024-12-30 21:25:27] iteration        8/      10 | consumed samples:          256 | elapsed time per iteration (ms): 3410.6 | learning rate: 6.000000E-06 | global batch size:    32 | lm loss: 2.044054E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 3277.45
     rank  1: 3277.48
     rank  2: 3277.46
     rank  3: 3277.47
     rank  4: 3283.38
     rank  5: 3283.41
     rank  6: 3283.39
     rank  7: 3283.40
     rank  8: 3282.13
     rank  9: 3282.18
     rank 10: 3282.14
     rank 11: 3282.17
     rank 12: 3283.32
     rank 13: 3283.34
     rank 14: 3283.32
     rank 15: 3283.35
  forward-compute:
     rank  0: 432.12
     rank  1: 425.83
     rank  2: 428.24
     rank  3: 417.64
     rank  4: 542.98
     rank  5: 548.67
     rank  6: 546.27
     rank  7: 564.60
     rank  8: 526.18
     rank  9: 520.62
     rank 10: 527.62
     rank 11: 530.69
     rank 12: 665.49
     rank 13: 661.46
     rank 14: 659.27
     rank 15: 705.16
  backward-compute:
     rank  0: 445.22
     rank  1: 427.59
     rank  2: 480.40
     rank  3: 434.93
     rank  4: 1054.86
     rank  5: 1052.18
     rank  6: 1049.14
     rank  7: 1062.83
     rank  8: 1033.07
     rank  9: 1023.94
     rank 10: 1034.80
     rank 11: 1032.32
     rank 12: 1239.89
     rank 13: 1245.83
     rank 14: 1246.71
     rank 15: 1212.02
  pure-backward-compute:
     rank  0: 444.78
     rank  1: 427.22
     rank  2: 480.07
     rank  3: 434.61
     rank  4: 1054.33
     rank  5: 1051.49
     rank  6: 1048.51
     rank  7: 1062.05
     rank  8: 1032.51
     rank  9: 1023.02
     rank 10: 1034.19
     rank 11: 1031.63
     rank 12: 1238.64
     rank 13: 1244.49
     rank 14: 1245.42
     rank 15: 1210.79
  batch-generator:
     rank  0: 28.81
     rank  1: 23.01
     rank  2: 21.88
     rank  3: 21.93
     rank  4: 27.04
     rank  5: 30.95
     rank  6: 30.62
     rank  7: 36.97
     rank  8: 21.55
     rank  9: 22.64
     rank 10: 22.63
     rank 11: 25.33
     rank 12: 24.50
     rank 13: 31.19
     rank 14: 23.38
     rank 15: 28.51
  forward-recv:
     rank  4: 56.03
     rank  5: 55.66
     rank  6: 56.06
     rank  7: 54.59
     rank  8: 130.26
     rank  9: 130.53
     rank 10: 129.89
     rank 11: 128.05
     rank 12: 192.77
     rank 13: 191.01
     rank 14: 193.44
     rank 15: 189.53
  forward-send:
     rank  0: 39.38
     rank  1: 34.19
     rank  2: 40.30
     rank  3: 37.46
     rank  4: 8.18
     rank  5: 7.69
     rank  6: 7.68
     rank  7: 4.96
     rank  8: 2.78
     rank  9: 2.19
     rank 10: 2.42
     rank 11: 1.84
  backward-recv:
     rank  0: 558.20
     rank  1: 556.31
     rank  2: 544.58
     rank  3: 560.40
     rank  4: 214.11
     rank  5: 211.83
     rank  6: 216.17
     rank  7: 214.01
     rank  8: 109.47
     rank  9: 109.04
     rank 10: 108.58
     rank 11: 109.71
  backward-send:
     rank  4: 4.05
     rank  5: 4.01
     rank  6: 3.74
     rank  7: 3.07
     rank  8: 5.18
     rank  9: 3.49
     rank 10: 4.82
     rank 11: 3.09
     rank 12: 3.16
     rank 13: 2.22
     rank 14: 3.15
     rank 15: 1.61
  forward-send-backward-recv:
     rank  0: 971.08
     rank  1: 999.13
     rank  2: 952.94
     rank  3: 991.58
     rank  4: 503.80
     rank  5: 498.79
     rank  6: 502.44
     rank  7: 473.74
     rank  8: 430.69
     rank  9: 445.11
     rank 10: 431.08
     rank 11: 433.51
  backward-send-forward-recv:
     rank  4: 7.53
     rank  5: 8.68
     rank  6: 8.95
     rank  7: 7.37
     rank  8: 21.20
     rank  9: 20.51
     rank 10: 20.24
     rank 11: 12.50
     rank 12: 25.87
     rank 13: 24.35
     rank 14: 24.36
     rank 15: 13.43
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.05
     rank  2: 0.05
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.05
     rank 13: 0.07
     rank 14: 0.05
     rank 15: 0.06
  all-grads-sync:
     rank  0: 297.93
     rank  1: 297.98
     rank  2: 297.92
     rank  3: 297.84
     rank  4: 821.00
     rank  5: 821.00
     rank  6: 821.01
     rank  7: 821.01
     rank  8: 692.78
     rank  9: 692.73
     rank 10: 692.78
     rank 11: 692.77
     rank 12: 815.30
     rank 13: 815.30
     rank 14: 815.30
     rank 15: 815.33
  optimizer-copy-to-main-grad:
     rank  0: 0.19
     rank  1: 0.19
     rank  2: 0.18
     rank  3: 0.17
     rank  4: 0.04
     rank  5: 0.03
     rank  6: 0.07
     rank  7: 0.07
     rank  8: 0.04
     rank  9: 0.07
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.04
     rank 13: 0.05
     rank 14: 0.04
     rank 15: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 37.66
     rank  1: 37.82
     rank  2: 37.87
     rank  3: 37.71
     rank  4: 98.74
     rank  5: 98.60
     rank  6: 98.65
     rank  7: 98.66
     rank  8: 85.57
     rank  9: 85.53
     rank 10: 85.57
     rank 11: 85.59
     rank 12: 98.70
     rank 13: 98.79
     rank 14: 98.81
     rank 15: 98.70
  optimizer:
     rank  0: 38.33
     rank  1: 38.49
     rank  2: 38.54
     rank  3: 38.39
     rank  4: 99.41
     rank  5: 99.27
     rank  6: 99.32
     rank  7: 99.33
     rank  8: 86.23
     rank  9: 86.20
     rank 10: 86.24
     rank 11: 86.27
     rank 12: 99.37
     rank 13: 99.47
     rank 14: 99.48
     rank 15: 99.37
 [2024-12-30 21:25:30] iteration        9/      10 | consumed samples:          288 | elapsed time per iteration (ms): 3391.8 | learning rate: 6.750000E-06 | global batch size:    32 | lm loss: 1.211288E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 3258.92
     rank  1: 3258.92
     rank  2: 3258.90
     rank  3: 3258.92
     rank  4: 3264.99
     rank  5: 3264.99
     rank  6: 3265.08
     rank  7: 3265.00
     rank  8: 3263.68
     rank  9: 3263.69
     rank 10: 3263.69
     rank 11: 3263.66
     rank 12: 3264.80
     rank 13: 3264.75
     rank 14: 3264.75
     rank 15: 3264.80
  forward-compute:
     rank  0: 432.45
     rank  1: 434.98
     rank  2: 436.39
     rank  3: 430.92
     rank  4: 537.77
     rank  5: 548.18
     rank  6: 534.69
     rank  7: 543.23
     rank  8: 525.61
     rank  9: 521.43
     rank 10: 526.90
     rank 11: 532.58
     rank 12: 656.68
     rank 13: 650.60
     rank 14: 650.57
     rank 15: 687.85
  backward-compute:
     rank  0: 444.44
     rank  1: 438.52
     rank  2: 478.32
     rank  3: 439.55
     rank  4: 1055.53
     rank  5: 1055.19
     rank  6: 1049.72
     rank  7: 1067.67
     rank  8: 1030.58
     rank  9: 1023.00
     rank 10: 1034.69
     rank 11: 1032.30
     rank 12: 1245.12
     rank 13: 1246.62
     rank 14: 1245.19
     rank 15: 1216.06
  pure-backward-compute:
     rank  0: 443.95
     rank  1: 438.18
     rank  2: 477.99
     rank  3: 439.23
     rank  4: 1055.04
     rank  5: 1054.53
     rank  6: 1049.19
     rank  7: 1067.01
     rank  8: 1029.84
     rank  9: 1022.40
     rank 10: 1034.09
     rank 11: 1031.58
     rank 12: 1243.62
     rank 13: 1245.48
     rank 14: 1243.77
     rank 15: 1214.99
  batch-generator:
     rank  0: 26.53
     rank  1: 26.36
     rank  2: 22.11
     rank  3: 22.27
     rank  4: 23.29
     rank  5: 29.06
     rank  6: 22.94
     rank  7: 22.24
     rank  8: 22.94
     rank  9: 23.30
     rank 10: 21.70
     rank 11: 28.28
     rank 12: 24.52
     rank 13: 23.25
     rank 14: 23.20
     rank 15: 25.85
  forward-recv:
     rank  4: 53.62
     rank  5: 57.76
     rank  6: 57.62
     rank  7: 55.74
     rank  8: 126.33
     rank  9: 129.87
     rank 10: 128.61
     rank 11: 128.28
     rank 12: 187.71
     rank 13: 191.68
     rank 14: 192.86
     rank 15: 192.54
  forward-send:
     rank  0: 30.41
     rank  1: 35.50
     rank  2: 38.77
     rank  3: 40.43
     rank  4: 4.47
     rank  5: 8.27
     rank  6: 8.47
     rank  7: 8.19
     rank  8: 1.59
     rank  9: 2.96
     rank 10: 3.54
     rank 11: 3.59
  backward-recv:
     rank  0: 557.16
     rank  1: 559.38
     rank  2: 540.74
     rank  3: 564.17
     rank  4: 211.63
     rank  5: 211.92
     rank  6: 207.52
     rank  7: 212.71
     rank  8: 107.91
     rank  9: 110.17
     rank 10: 109.28
     rank 11: 110.62
  backward-send:
     rank  4: 3.23
     rank  5: 3.05
     rank  6: 3.52
     rank  7: 2.82
     rank  8: 3.85
     rank  9: 3.59
     rank 10: 2.93
     rank 11: 3.09
     rank 12: 2.04
     rank 13: 2.23
     rank 14: 1.81
     rank 15: 1.60
  forward-send-backward-recv:
     rank  0: 970.43
     rank  1: 962.02
     rank  2: 941.87
     rank  3: 955.88
     rank  4: 507.25
     rank  5: 487.16
     rank  6: 505.33
     rank  7: 478.89
     rank  8: 433.18
     rank  9: 439.96
     rank 10: 421.05
     rank 11: 419.43
  backward-send-forward-recv:
     rank  4: 7.37
     rank  5: 8.30
     rank  6: 8.18
     rank  7: 6.55
     rank  8: 19.23
     rank  9: 16.57
     rank 10: 17.38
     rank 11: 12.24
     rank 12: 25.18
     rank 13: 26.51
     rank 14: 22.76
     rank 15: 13.88
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.05
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.05
     rank  2: 0.05
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.04
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.05
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.05
  all-grads-sync:
     rank  0: 292.41
     rank  1: 292.47
     rank  2: 292.41
     rank  3: 292.32
     rank  4: 812.04
     rank  5: 812.03
     rank  6: 812.22
     rank  7: 812.03
     rank  8: 692.00
     rank  9: 691.96
     rank 10: 691.98
     rank 11: 691.98
     rank 12: 808.32
     rank 13: 808.31
     rank 14: 808.31
     rank 15: 808.31
  optimizer-copy-to-main-grad:
     rank  0: 0.20
     rank  1: 0.34
     rank  2: 0.19
     rank  3: 0.18
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.04
     rank  7: 0.03
     rank  8: 0.07
     rank  9: 0.03
     rank 10: 0.04
     rank 11: 0.05
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 37.84
     rank  1: 37.92
     rank  2: 37.94
     rank  3: 37.90
     rank  4: 98.97
     rank  5: 98.58
     rank  6: 99.04
     rank  7: 98.68
     rank  8: 85.61
     rank  9: 85.54
     rank 10: 85.62
     rank 11: 85.67
     rank 12: 98.66
     rank 13: 98.71
     rank 14: 98.71
     rank 15: 98.62
  optimizer:
     rank  0: 38.69
     rank  1: 38.76
     rank  2: 38.78
     rank  3: 38.74
     rank  4: 99.82
     rank  5: 99.43
     rank  6: 99.88
     rank  7: 99.52
     rank  8: 86.45
     rank  9: 86.38
     rank 10: 86.47
     rank 11: 86.52
     rank 12: 99.50
     rank 13: 99.55
     rank 14: 99.57
     rank 15: 99.46
 [2024-12-30 21:25:34] iteration       10/      10 | consumed samples:          320 | elapsed time per iteration (ms): 3391.9 | learning rate: 7.500000E-06 | global batch size:    32 | lm loss: 1.774324E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 3259.56
     rank  1: 3259.56
     rank  2: 3259.54
     rank  3: 3259.53
     rank  4: 3265.49
     rank  5: 3265.49
     rank  6: 3265.50
     rank  7: 3265.57
     rank  8: 3264.25
     rank  9: 3264.25
     rank 10: 3264.23
     rank 11: 3264.29
     rank 12: 3265.39
     rank 13: 3265.38
     rank 14: 3265.41
     rank 15: 3265.40
  forward-compute:
     rank  0: 445.00
     rank  1: 439.11
     rank  2: 428.48
     rank  3: 424.71
     rank  4: 544.33
     rank  5: 551.51
     rank  6: 539.03
     rank  7: 555.38
     rank  8: 522.60
     rank  9: 519.55
     rank 10: 526.14
     rank 11: 532.72
     rank 12: 654.74
     rank 13: 643.19
     rank 14: 671.47
     rank 15: 680.20
  backward-compute:
     rank  0: 450.06
     rank  1: 434.60
     rank  2: 479.51
     rank  3: 438.24
     rank  4: 1057.05
     rank  5: 1053.11
     rank  6: 1051.82
     rank  7: 1066.45
     rank  8: 1031.05
     rank  9: 1025.42
     rank 10: 1037.10
     rank 11: 1031.24
     rank 12: 1237.49
     rank 13: 1249.87
     rank 14: 1222.42
     rank 15: 1214.45
  pure-backward-compute:
     rank  0: 449.45
     rank  1: 434.13
     rank  2: 479.11
     rank  3: 437.92
     rank  4: 1056.45
     rank  5: 1052.49
     rank  6: 1051.24
     rank  7: 1065.71
     rank  8: 1030.43
     rank  9: 1024.53
     rank 10: 1036.42
     rank 11: 1030.50
     rank 12: 1236.32
     rank 13: 1248.59
     rank 14: 1221.09
     rank 15: 1213.32
  batch-generator:
     rank  0: 33.60
     rank  1: 27.93
     rank  2: 21.84
     rank  3: 22.31
     rank  4: 26.33
     rank  5: 32.03
     rank  6: 26.75
     rank  7: 30.66
     rank  8: 20.75
     rank  9: 23.03
     rank 10: 21.34
     rank 11: 29.53
     rank 12: 24.93
     rank 13: 21.34
     rank 14: 23.70
     rank 15: 26.35
  forward-recv:
     rank  4: 52.02
     rank  5: 54.77
     rank  6: 54.96
     rank  7: 53.92
     rank  8: 122.27
     rank  9: 127.46
     rank 10: 127.35
     rank 11: 125.88
     rank 12: 184.63
     rank 13: 187.23
     rank 14: 189.18
     rank 15: 188.28
  forward-send:
     rank  0: 29.98
     rank  1: 32.61
     rank  2: 37.34
     rank  3: 38.79
     rank  4: 3.25
     rank  5: 5.48
     rank  6: 5.20
     rank  7: 5.69
     rank  8: 1.60
     rank  9: 2.21
     rank 10: 2.04
     rank 11: 2.68
  backward-recv:
     rank  0: 552.33
     rank  1: 553.52
     rank  2: 541.56
     rank  3: 550.46
     rank  4: 209.28
     rank  5: 211.59
     rank  6: 213.26
     rank  7: 207.39
     rank  8: 107.50
     rank  9: 107.13
     rank 10: 105.56
     rank 11: 107.21
  backward-send:
     rank  4: 3.71
     rank  5: 3.23
     rank  6: 3.72
     rank  7: 2.91
     rank  8: 5.97
     rank  9: 6.91
     rank 10: 6.88
     rank 11: 3.07
     rank 12: 3.06
     rank 13: 2.39
     rank 14: 2.75
     rank 15: 1.61
  forward-send-backward-recv:
     rank  0: 949.99
     rank  1: 961.21
     rank  2: 940.93
     rank  3: 964.20
     rank  4: 493.11
     rank  5: 480.93
     rank  6: 496.68
     rank  7: 464.92
     rank  8: 424.19
     rank  9: 426.10
     rank 10: 416.04
     rank 11: 411.17
  backward-send-forward-recv:
     rank  4: 9.55
     rank  5: 10.30
     rank  6: 7.35
     rank  7: 8.31
     rank  8: 23.53
     rank  9: 24.36
     rank 10: 18.28
     rank 11: 17.34
     rank 12: 25.97
     rank 13: 24.36
     rank 14: 19.58
     rank 15: 16.99
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.05
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.05
     rank  2: 0.05
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.04
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.05
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.05
  all-grads-sync:
     rank  0: 308.39
     rank  1: 308.65
     rank  2: 308.58
     rank  3: 308.45
     rank  4: 821.13
     rank  5: 821.12
     rank  6: 821.13
     rank  7: 821.17
     rank  8: 693.26
     rank  9: 693.26
     rank 10: 693.26
     rank 11: 693.25
     rank 12: 820.69
     rank 13: 820.69
     rank 14: 820.69
     rank 15: 820.69
  optimizer-copy-to-main-grad:
     rank  0: 0.21
     rank  1: 0.20
     rank  2: 0.18
     rank  3: 0.18
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.07
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.05
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 37.58
     rank  1: 37.90
     rank  2: 37.88
     rank  3: 37.90
     rank  4: 98.68
     rank  5: 98.59
     rank  6: 98.71
     rank  7: 98.82
     rank  8: 85.62
     rank  9: 85.64
     rank 10: 85.62
     rank 11: 85.63
     rank 12: 98.66
     rank 13: 98.66
     rank 14: 98.72
     rank 15: 98.65
  optimizer:
     rank  0: 38.25
     rank  1: 38.57
     rank  2: 38.56
     rank  3: 38.56
     rank  4: 99.36
     rank  5: 99.27
     rank  6: 99.38
     rank  7: 99.49
     rank  8: 86.30
     rank  9: 86.31
     rank 10: 86.29
     rank 11: 86.31
     rank 12: 99.34
     rank 13: 99.33
     rank 14: 99.39
     rank 15: 99.33
