examples/multimodal/pretrain-freeze-llm-hete-2080first.sh: line 4: activate: No such file or directory
4
[2025-01-02 16:40:47,191] torch.distributed.run: [WARNING] 
[2025-01-02 16:40:47,191] torch.distributed.run: [WARNING] *****************************************
[2025-01-02 16:40:47,191] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2025-01-02 16:40:47,191] torch.distributed.run: [WARNING] *****************************************
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:20------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:20------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:20------
------num_pipeline_model_parallel_groups:4------
> setting tensorboard ...
WARNING: one_logger package is required to enable e2e metrics tracking. please go to https://confluence.nvidia.com/display/MLWFO/Package+Repositories for details to install it
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:20------
------num_pipeline_model_parallel_groups:4------
---Rank 16---Tensor Parallel Group GPUs: [0, 0, 0, 0]---Rank 19---Tensor Parallel Group GPUs: [3, 3, 3, 3]

---Rank 17---Tensor Parallel Group GPUs: [1, 1, 1, 1]---Rank 16---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]---Rank 19---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]


---Rank 17---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]
[rank16]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank19]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
---Rank 18---Tensor Parallel Group GPUs: [2, 2, 2, 2][rank17]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())

---Rank 18---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]
[rank18]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
 > number of parameters on (tensor, pipeline) model parallel rank (0, 4): 469831680
INFO:megatron.core.distributed.param_and_grad_buffer:Number of buckets for gradient all-reduce / reduce-scatter: 1
Params for bucket 1 (469831680 elements):
	language_model.decoder.layers.6.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.1.mlp.linear_fc2.weight
	language_model.decoder.layers.0.mlp.linear_fc1.weight
	language_model.decoder.layers.0.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.7.mlp.linear_fc2.weight
	language_model.decoder.layers.7.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.5.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.3.mlp.linear_fc1.weight
	language_model.decoder.layers.2.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.2.self_attention.linear_qkv.weight
	language_model.decoder.layers.1.mlp.linear_fc1.layer_norm_weight
	language_model.output_layer.weight
	language_model.decoder.layers.7.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.6.mlp.linear_fc1.weight
	language_model.decoder.layers.6.self_attention.linear_qkv.weight
	language_model.decoder.layers.5.mlp.linear_fc1.weight
	language_model.decoder.layers.5.self_attention.linear_qkv.weight
	language_model.decoder.layers.4.mlp.linear_fc1.weight
	language_model.decoder.layers.4.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.2.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.1.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.7.self_attention.linear_proj.weight
	language_model.decoder.layers.6.self_attention.linear_proj.weight
	language_model.decoder.layers.5.mlp.linear_fc2.weight
	language_model.decoder.layers.4.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.1.self_attention.linear_proj.weight
	language_model.decoder.layers.0.mlp.linear_fc2.weight
	language_model.decoder.layers.7.mlp.linear_fc1.weight
	language_model.decoder.layers.6.mlp.linear_fc2.weight
	language_model.decoder.layers.5.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.3.mlp.linear_fc2.weight
	language_model.decoder.layers.3.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.2.mlp.linear_fc1.weight
	language_model.decoder.layers.2.self_attention.linear_proj.weight
	language_model.decoder.final_layernorm.weight
	language_model.decoder.layers.7.self_attention.linear_qkv.weight
	language_model.decoder.layers.4.self_attention.linear_qkv.weight
	language_model.decoder.layers.4.self_attention.linear_proj.weight
	language_model.decoder.layers.3.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.1.mlp.linear_fc1.weight
	language_model.decoder.layers.1.self_attention.linear_qkv.weight
	language_model.decoder.layers.0.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.0.self_attention.linear_proj.weight
	language_model.decoder.layers.3.self_attention.linear_proj.weight
	language_model.decoder.layers.6.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.5.self_attention.linear_proj.weight
	language_model.decoder.layers.4.mlp.linear_fc2.weight
	language_model.decoder.layers.3.self_attention.linear_qkv.weight
	language_model.decoder.layers.2.mlp.linear_fc2.weight
	language_model.decoder.layers.0.self_attention.linear_qkv.weight
 > number of parameters on (tensor, pipeline) model parallel rank (1, 4): 469831680
 > number of parameters on (tensor, pipeline) model parallel rank (2, 4): 469831680
 > number of parameters on (tensor, pipeline) model parallel rank (3, 4): 469831680
rank=0, worker=0: shard_range=[pretrain-0.tar[0, 100), pretrain-0.tar[100, 200), pretrain-0.tar[200, 300), ...<2494>, pretrain-30.tar[9700, 9800), pretrain-30.tar[9800, 9900), pretrain-30.tar[9900, 10000)] sum(count)=250000
rank=0, worker=1: shard_range=[pretrain-31.tar[0, 100), pretrain-31.tar[100, 200), pretrain-31.tar[200, 300), ...<2494>, pretrain-53.tar[9700, 9800), pretrain-53.tar[9800, 9900), pretrain-53.tar[9900, 10000)] sum(count)=250000
rank=0, worker=0: shard_range=[pretrain-54.tar[0, 10000), pretrain-55.tar[0, 8128), pretrain-6.tar[0, 10000), pretrain-7.tar[0, 936)] sum(count)=29064
rank=0, worker=1: shard_range=[pretrain-7.tar[936, 10000), pretrain-8.tar[0, 10000), pretrain-9.tar[0, 10000)] sum(count)=29064
times across ranks (ms):
  model-and-optimizer-setup:
     rank  0: 133.80
     rank  1: 134.36
     rank  2: 135.60
     rank  3: 138.64
     rank  4: 65.53
     rank  5: 66.35
     rank  6: 74.68
     rank  7: 66.79
     rank  8: 81.69
     rank  9: 81.45
     rank 10: 93.32
     rank 11: 81.45
     rank 12: 62.88
     rank 13: 61.71
     rank 14: 62.81
     rank 15: 49.73
     rank 16: 29.36
     rank 17: 34.60
     rank 18: 34.76
     rank 19: 43.79
  train/valid/test-data-iterators-setup:
     rank  0: 1019.20
     rank  1: 1019.17
     rank  2: 1243.75
     rank  3: 1019.05
     rank  4: 1242.61
     rank  5: 1242.80
     rank  6: 1019.16
     rank  7: 1244.45
     rank  8: 1242.70
     rank  9: 1242.75
     rank 10: 1243.47
     rank 11: 1242.72
     rank 12: 1242.55
     rank 13: 1242.79
     rank 14: 1243.08
     rank 15: 1242.76
     rank 16: 1242.79
     rank 17: 1242.76
     rank 18: 1242.68
     rank 19: 1242.83
 [2025-01-02 16:41:34] iteration        1/      10 | consumed samples:           32 | elapsed time per iteration (ms): 19549.5 | learning rate: 7.500000E-07 | global batch size:    32 | lm loss: 6.959259E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
[Rank 17] (after 1 iterations) memory (MB) | allocated: 7222.3154296875 | max allocated: 9013.798828125 | reserved: 9676.0 | max reserved: 9676.0
[Rank 18] (after 1 iterations) memory (MB) | allocated: 7222.3154296875 | max allocated: 9013.798828125 | reserved: 9654.0 | max reserved: 9654.0
[Rank 19] (after 1 iterations) memory (MB) | allocated: 7222.3154296875 | max allocated: 9013.798828125 | reserved: 9762.0 | max reserved: 9762.0
stage5 GPU utialization:110.03172397613525 %
[Rank 16] (after 1 iterations) memory (MB) | allocated: 7222.3154296875 | max allocated: 9013.798828125 | reserved: 9700.0 | max reserved: 9700.0
times across ranks (ms):
  forward-backward:
     rank  0: 19464.40
     rank  1: 19464.49
     rank  2: 19464.58
     rank  3: 19464.59
     rank  4: 19465.54
     rank  5: 19465.09
     rank  6: 19465.30
     rank  7: 19465.45
     rank  8: 19466.36
     rank  9: 19466.16
     rank 10: 19466.33
     rank 11: 19466.03
     rank 12: 19465.22
     rank 13: 19465.11
     rank 14: 19465.17
     rank 15: 19465.13
     rank 16: 19464.28
     rank 17: 19464.14
     rank 18: 19464.24
     rank 19: 19464.16
  forward-compute:
     rank  0: 7771.15
     rank  1: 7771.77
     rank  2: 7766.61
     rank  3: 7759.41
     rank  4: 5038.07
     rank  5: 5038.90
     rank  6: 5019.00
     rank  7: 5019.74
     rank  8: 4662.14
     rank  9: 4665.32
     rank 10: 4706.19
     rank 11: 4671.23
     rank 12: 5914.55
     rank 13: 5909.76
     rank 14: 5899.80
     rank 15: 5908.88
     rank 16: 5272.47
     rank 17: 5284.03
     rank 18: 5265.92
     rank 19: 5291.05
  backward-compute:
     rank  0: 3166.58
     rank  1: 3169.48
     rank  2: 3175.80
     rank  3: 3169.62
     rank  4: 4167.07
     rank  5: 4159.27
     rank  6: 4226.91
     rank  7: 4193.65
     rank  8: 4299.75
     rank  9: 4300.16
     rank 10: 4293.72
     rank 11: 4304.73
     rank 12: 4251.81
     rank 13: 4264.40
     rank 14: 4256.10
     rank 15: 4279.89
     rank 16: 3623.25
     rank 17: 3626.27
     rank 18: 3630.04
     rank 19: 3627.20
  pure-backward-compute:
     rank  0: 3164.76
     rank  1: 3167.47
     rank  2: 3174.01
     rank  3: 3167.84
     rank  4: 4162.77
     rank  5: 4155.75
     rank  6: 4223.75
     rank  7: 4190.86
     rank  8: 4295.99
     rank  9: 4297.54
     rank 10: 4289.67
     rank 11: 4301.67
     rank 12: 4247.77
     rank 13: 4262.64
     rank 14: 4252.91
     rank 15: 4277.95
     rank 16: 3618.49
     rank 17: 3622.90
     rank 18: 3625.11
     rank 19: 3622.37
  batch-generator:
     rank  0: 1152.29
     rank  1: 1162.86
     rank  2: 1159.03
     rank  3: 1159.25
     rank  4: 1331.35
     rank  5: 1341.40
     rank  6: 1341.69
     rank  7: 1336.37
     rank  8: 1309.00
     rank  9: 1302.86
     rank 10: 1360.12
     rank 11: 1329.49
     rank 12: 1286.45
     rank 13: 1282.04
     rank 14: 1284.58
     rank 15: 1289.44
     rank 16: 929.57
     rank 17: 939.90
     rank 18: 931.28
     rank 19: 956.50
  forward-recv:
     rank  4: 2422.78
     rank  5: 2419.49
     rank  6: 2417.40
     rank  7: 2424.54
     rank  8: 3851.06
     rank  9: 3851.74
     rank 10: 3855.41
     rank 11: 3855.27
     rank 12: 5273.97
     rank 13: 5272.38
     rank 14: 5270.24
     rank 15: 5271.24
     rank 16: 7692.67
     rank 17: 7693.97
     rank 18: 7700.25
     rank 19: 7699.68
  forward-send:
     rank  0: 4909.69
     rank  1: 4908.97
     rank  2: 4914.08
     rank  3: 4923.74
     rank  4: 3628.78
     rank  5: 3631.75
     rank  6: 3639.79
     rank  7: 3639.66
     rank  8: 2313.37
     rank  9: 2313.22
     rank 10: 2317.11
     rank 11: 2317.74
     rank 12: 24.54
     rank 13: 26.42
     rank 14: 32.75
     rank 15: 31.75
  backward-recv:
     rank  0: 591.14
     rank  1: 591.07
     rank  2: 585.44
     rank  3: 589.06
     rank  4: 319.23
     rank  5: 320.65
     rank  6: 325.53
     rank  7: 322.06
     rank  8: 192.21
     rank  9: 191.25
     rank 10: 191.00
     rank 11: 191.87
     rank 12: 77.29
     rank 13: 77.15
     rank 14: 77.23
     rank 15: 78.33
  backward-send:
     rank  4: 20.23
     rank  5: 19.92
     rank  6: 16.35
     rank  7: 18.93
     rank  8: 14.94
     rank  9: 15.29
     rank 10: 15.69
     rank 11: 14.98
     rank 12: 10.40
     rank 13: 9.83
     rank 14: 10.28
     rank 15: 9.41
     rank 16: 5.11
     rank 17: 4.42
     rank 18: 5.01
     rank 19: 5.07
  forward-send-backward-recv:
     rank  0: 2942.40
     rank  1: 2939.61
     rank  2: 2939.57
     rank  3: 2939.96
     rank  4: 2867.10
     rank  5: 2869.11
     rank  6: 2808.01
     rank  7: 2843.80
     rank  8: 2622.20
     rank  9: 2624.80
     rank 10: 2630.05
     rank 11: 2621.48
     rank 12: 2446.05
     rank 13: 2444.00
     rank 14: 2447.17
     rank 15: 2429.19
  backward-send-forward-recv:
     rank  4: 812.36
     rank  5: 812.61
     rank  6: 826.67
     rank  7: 817.21
     rank  8: 1187.65
     rank  9: 1184.50
     rank 10: 1135.54
     rank 11: 1171.11
     rank 12: 1000.51
     rank 13: 1006.52
     rank 14: 1007.56
     rank 15: 1001.99
     rank 16: 2276.12
     rank 17: 2265.84
     rank 18: 2271.90
     rank 19: 2246.33
  layernorm-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.03
     rank  3: 0.04
     rank  4: 0.08
     rank  5: 0.07
     rank  6: 0.08
     rank  7: 0.08
     rank  8: 0.06
     rank  9: 0.08
     rank 10: 0.07
     rank 11: 0.07
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.02
     rank 16: 0.03
     rank 17: 0.02
     rank 18: 0.03
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.10
     rank  1: 0.10
     rank  2: 0.10
     rank  3: 0.10
     rank  4: 0.07
     rank  5: 0.06
     rank  6: 0.07
     rank  7: 0.07
     rank  8: 0.06
     rank  9: 0.06
     rank 10: 0.06
     rank 11: 0.06
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.08
     rank 17: 0.05
     rank 18: 0.07
     rank 19: 0.06
  all-grads-sync:
     rank  0: 61.54
     rank  1: 59.15
     rank  2: 61.99
     rank  3: 61.85
     rank  4: 59.95
     rank  5: 60.31
     rank  6: 64.64
     rank  7: 61.73
     rank  8: 62.68
     rank  9: 61.20
     rank 10: 62.27
     rank 11: 57.44
     rank 12: 44.86
     rank 13: 45.11
     rank 14: 46.93
     rank 15: 39.80
     rank 16: 2.77
     rank 17: 2.66
     rank 18: 2.74
     rank 19: 2.58
  optimizer-copy-to-main-grad:
     rank  0: 0.07
     rank  1: 0.06
     rank  2: 0.06
     rank  3: 0.07
     rank  4: 0.11
     rank  5: 0.11
     rank  6: 0.08
     rank  7: 0.08
     rank  8: 0.15
     rank  9: 0.10
     rank 10: 0.11
     rank 11: 0.06
     rank 12: 0.07
     rank 13: 0.06
     rank 14: 0.07
     rank 15: 0.07
     rank 16: 0.07
     rank 17: 0.05
     rank 18: 0.06
     rank 19: 0.06
  optimizer-clip-main-grad:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.06
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.05
     rank  9: 0.03
     rank 10: 0.04
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.02
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 62.44
     rank  1: 62.25
     rank  2: 62.65
     rank  3: 62.65
     rank  4: 73.24
     rank  5: 69.12
     rank  6: 69.09
     rank  7: 68.86
     rank  8: 77.54
     rank  9: 75.97
     rank 10: 77.32
     rank 11: 74.91
     rank 12: 70.55
     rank 13: 70.67
     rank 14: 69.57
     rank 15: 69.73
     rank 16: 67.02
     rank 17: 65.54
     rank 18: 68.78
     rank 19: 65.08
  optimizer:
     rank  0: 63.99
     rank  1: 63.82
     rank  2: 64.21
     rank  3: 64.21
     rank  4: 74.80
     rank  5: 70.67
     rank  6: 70.65
     rank  7: 70.42
     rank  8: 79.10
     rank  9: 77.52
     rank 10: 78.89
     rank 11: 76.48
     rank 12: 72.11
     rank 13: 72.23
     rank 14: 71.15
     rank 15: 71.28
     rank 16: 68.58
     rank 17: 67.09
     rank 18: 70.35
     rank 19: 66.64
 [2025-01-02 16:41:44] iteration        2/      10 | consumed samples:           64 | elapsed time per iteration (ms): 9952.0 | learning rate: 1.500000E-06 | global batch size:    32 | lm loss: 6.904085E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 9860.04
     rank  1: 9860.03
     rank  2: 9860.11
     rank  3: 9860.04
     rank  4: 9860.02
     rank  5: 9860.01
     rank  6: 9860.07
     rank  7: 9860.02
     rank  8: 9860.87
     rank  9: 9860.85
     rank 10: 9861.00
     rank 11: 9860.93
     rank 12: 9861.11
     rank 13: 9861.02
     rank 14: 9861.13
     rank 15: 9860.99
     rank 16: 9860.26
     rank 17: 9860.20
     rank 18: 9860.43
     rank 19: 9860.19
  forward-compute:
     rank  0: 5622.30
     rank  1: 5623.72
     rank  2: 5630.72
     rank  3: 5626.70
     rank  4: 3719.78
     rank  5: 3715.38
     rank  6: 3695.50
     rank  7: 3710.72
     rank  8: 3368.09
     rank  9: 3381.33
     rank 10: 3447.73
     rank 11: 3393.65
     rank 12: 3598.07
     rank 13: 3588.84
     rank 14: 3577.23
     rank 15: 3589.18
     rank 16: 3081.51
     rank 17: 3094.16
     rank 18: 3083.04
     rank 19: 3109.54
  backward-compute:
     rank  0: 3117.24
     rank  1: 3117.93
     rank  2: 3121.55
     rank  3: 3121.89
     rank  4: 4152.90
     rank  5: 4152.35
     rank  6: 4223.32
     rank  7: 4179.03
     rank  8: 4324.96
     rank  9: 4320.35
     rank 10: 4307.16
     rank 11: 4323.63
     rank 12: 4243.98
     rank 13: 4254.52
     rank 14: 4244.34
     rank 15: 4269.78
     rank 16: 3612.08
     rank 17: 3616.16
     rank 18: 3616.60
     rank 19: 3613.00
  pure-backward-compute:
     rank  0: 3115.50
     rank  1: 3116.12
     rank  2: 3119.94
     rank  3: 3120.07
     rank  4: 4149.61
     rank  5: 4149.03
     rank  6: 4220.89
     rank  7: 4176.56
     rank  8: 4321.55
     rank  9: 4317.68
     rank 10: 4303.13
     rank 11: 4320.65
     rank 12: 4240.53
     rank 13: 4252.88
     rank 14: 4241.28
     rank 15: 4268.27
     rank 16: 3607.38
     rank 17: 3613.02
     rank 18: 3612.72
     rank 19: 3608.43
  batch-generator:
     rank  0: 129.59
     rank  1: 139.44
     rank  2: 137.12
     rank  3: 145.83
     rank  4: 119.38
     rank  5: 125.21
     rank  6: 121.25
     rank  7: 131.71
     rank  8: 113.12
     rank  9: 121.93
     rank 10: 206.72
     rank 11: 150.75
     rank 12: 102.80
     rank 13: 90.30
     rank 14: 89.09
     rank 15: 97.86
     rank 16: 100.21
     rank 17: 109.75
     rank 18: 106.50
     rank 19: 130.38
  forward-recv:
     rank  4: 364.87
     rank  5: 364.05
     rank  6: 370.02
     rank  7: 366.43
     rank  8: 454.42
     rank  9: 453.38
     rank 10: 449.29
     rank 11: 451.69
     rank 12: 480.46
     rank 13: 481.29
     rank 14: 481.47
     rank 15: 482.24
     rank 16: 529.83
     rank 17: 529.84
     rank 18: 529.94
     rank 19: 529.19
  forward-send:
     rank  0: 20.90
     rank  1: 19.60
     rank  2: 20.82
     rank  3: 19.75
     rank  4: 14.87
     rank  5: 15.10
     rank  6: 12.08
     rank  7: 13.93
     rank  8: 11.28
     rank  9: 11.70
     rank 10: 12.09
     rank 11: 12.04
     rank 12: 5.06
     rank 13: 4.93
     rank 14: 5.07
     rank 15: 4.31
  backward-recv:
     rank  0: 594.08
     rank  1: 594.38
     rank  2: 588.88
     rank  3: 592.40
     rank  4: 316.57
     rank  5: 319.07
     rank  6: 326.04
     rank  7: 320.66
     rank  8: 192.98
     rank  9: 191.99
     rank 10: 191.71
     rank 11: 191.04
     rank 12: 77.52
     rank 13: 77.62
     rank 14: 77.83
     rank 15: 78.96
  backward-send:
     rank  4: 22.08
     rank  5: 20.26
     rank  6: 16.69
     rank  7: 19.07
     rank  8: 15.02
     rank  9: 15.31
     rank 10: 15.67
     rank 11: 14.97
     rank 12: 10.40
     rank 13: 9.83
     rank 14: 10.17
     rank 15: 9.17
     rank 16: 5.14
     rank 17: 4.45
     rank 18: 4.96
     rank 19: 5.03
  forward-send-backward-recv:
     rank  0: 485.31
     rank  1: 483.96
     rank  2: 478.88
     rank  3: 479.69
     rank  4: 428.88
     rank  5: 429.01
     rank  6: 362.52
     rank  7: 409.86
     rank  8: 279.54
     rank  9: 282.97
     rank 10: 283.90
     rank 11: 279.37
     rank 12: 193.67
     rank 13: 191.16
     rank 14: 197.80
     rank 15: 178.79
  backward-send-forward-recv:
     rank  4: 715.71
     rank  5: 717.19
     rank  6: 734.49
     rank  7: 720.92
     rank  8: 957.34
     rank  9: 948.67
     rank 10: 889.51
     rank 11: 938.46
     rank 12: 847.77
     rank 13: 860.01
     rank 14: 866.32
     rank 15: 856.41
     rank 16: 2097.59
     rank 17: 2087.55
     rank 18: 2095.52
     rank 19: 2070.22
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.04
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.08
     rank  1: 0.08
     rank  2: 0.09
     rank  3: 0.08
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.07
     rank 17: 0.05
     rank 18: 0.13
     rank 19: 0.05
  all-grads-sync:
     rank  0: 2.19
     rank  1: 2.14
     rank  2: 2.23
     rank  3: 2.20
     rank  4: 2.18
     rank  5: 2.14
     rank  6: 2.19
     rank  7: 2.14
     rank  8: 2.52
     rank  9: 2.52
     rank 10: 2.66
     rank 11: 2.67
     rank 12: 2.76
     rank 13: 2.70
     rank 14: 2.74
     rank 15: 2.69
     rank 16: 2.41
     rank 17: 2.37
     rank 18: 2.70
     rank 19: 2.37
  optimizer-copy-to-main-grad:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.06
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.07
     rank  8: 0.06
     rank  9: 0.06
     rank 10: 0.06
     rank 11: 0.06
     rank 12: 0.08
     rank 13: 0.05
     rank 14: 0.06
     rank 15: 0.05
     rank 16: 0.06
     rank 17: 0.05
     rank 18: 0.08
     rank 19: 0.06
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.02
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.02
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 41.23
     rank  1: 41.15
     rank  2: 41.25
     rank  3: 41.21
     rank  4: 43.05
     rank  5: 43.63
     rank  6: 43.57
     rank  7: 42.89
     rank  8: 51.99
     rank  9: 52.12
     rank 10: 52.42
     rank 11: 52.31
     rank 12: 53.85
     rank 13: 53.70
     rank 14: 53.73
     rank 15: 53.71
     rank 16: 46.40
     rank 17: 46.38
     rank 18: 46.60
     rank 19: 46.31
  optimizer:
     rank  0: 41.93
     rank  1: 41.85
     rank  2: 41.96
     rank  3: 41.92
     rank  4: 43.76
     rank  5: 44.36
     rank  6: 44.27
     rank  7: 43.59
     rank  8: 52.70
     rank  9: 52.83
     rank 10: 53.13
     rank 11: 53.02
     rank 12: 54.57
     rank 13: 54.41
     rank 14: 54.43
     rank 15: 54.42
     rank 16: 47.11
     rank 17: 47.09
     rank 18: 47.31
     rank 19: 47.02
 [2025-01-02 16:41:54] iteration        3/      10 | consumed samples:           96 | elapsed time per iteration (ms): 9978.2 | learning rate: 2.250000E-06 | global batch size:    32 | lm loss: 3.685931E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 9885.31
     rank  1: 9885.34
     rank  2: 9885.30
     rank  3: 9885.39
     rank  4: 9885.32
     rank  5: 9885.33
     rank  6: 9885.26
     rank  7: 9885.28
     rank  8: 9886.19
     rank  9: 9886.19
     rank 10: 9886.14
     rank 11: 9886.14
     rank 12: 9886.31
     rank 13: 9886.31
     rank 14: 9886.32
     rank 15: 9886.29
     rank 16: 9885.47
     rank 17: 9885.51
     rank 18: 9885.58
     rank 19: 9885.48
  forward-compute:
     rank  0: 5634.95
     rank  1: 5636.52
     rank  2: 5638.37
     rank  3: 5639.16
     rank  4: 3719.66
     rank  5: 3717.04
     rank  6: 3700.47
     rank  7: 3713.63
     rank  8: 3412.52
     rank  9: 3418.70
     rank 10: 3481.81
     rank 11: 3431.33
     rank 12: 3583.95
     rank 13: 3578.65
     rank 14: 3569.82
     rank 15: 3581.62
     rank 16: 3066.15
     rank 17: 3077.50
     rank 18: 3067.43
     rank 19: 3091.84
  backward-compute:
     rank  0: 3124.64
     rank  1: 3123.78
     rank  2: 3132.06
     rank  3: 3128.50
     rank  4: 4164.64
     rank  5: 4156.67
     rank  6: 4231.49
     rank  7: 4186.50
     rank  8: 4351.82
     rank  9: 4350.99
     rank 10: 4345.72
     rank 11: 4358.15
     rank 12: 4235.07
     rank 13: 4244.28
     rank 14: 4235.58
     rank 15: 4259.97
     rank 16: 3624.13
     rank 17: 3628.13
     rank 18: 3628.21
     rank 19: 3623.96
  pure-backward-compute:
     rank  0: 3122.88
     rank  1: 3121.96
     rank  2: 3130.46
     rank  3: 3126.70
     rank  4: 4161.74
     rank  5: 4153.27
     rank  6: 4229.11
     rank  7: 4184.35
     rank  8: 4348.57
     rank  9: 4348.08
     rank 10: 4342.51
     rank 11: 4355.15
     rank 12: 4232.59
     rank 13: 4242.79
     rank 14: 4233.02
     rank 15: 4258.58
     rank 16: 3619.71
     rank 17: 3625.08
     rank 18: 3624.57
     rank 19: 3619.50
  batch-generator:
     rank  0: 130.62
     rank  1: 139.92
     rank  2: 137.82
     rank  3: 146.44
     rank  4: 114.31
     rank  5: 122.11
     rank  6: 120.39
     rank  7: 128.69
     rank  8: 125.78
     rank  9: 125.50
     rank 10: 210.45
     rank 11: 155.63
     rank 12: 92.89
     rank 13: 86.89
     rank 14: 87.60
     rank 15: 96.04
     rank 16: 87.08
     rank 17: 98.99
     rank 18: 96.20
     rank 19: 118.94
  forward-recv:
     rank  4: 360.42
     rank  5: 359.79
     rank  6: 365.50
     rank  7: 361.85
     rank  8: 448.45
     rank  9: 447.71
     rank 10: 443.12
     rank 11: 446.18
     rank 12: 475.19
     rank 13: 475.94
     rank 14: 476.12
     rank 15: 476.74
     rank 16: 525.81
     rank 17: 525.77
     rank 18: 525.74
     rank 19: 525.08
  forward-send:
     rank  0: 20.75
     rank  1: 19.60
     rank  2: 20.65
     rank  3: 19.47
     rank  4: 14.69
     rank  5: 15.00
     rank  6: 11.82
     rank  7: 13.81
     rank  8: 10.51
     rank  9: 10.73
     rank 10: 11.29
     rank 11: 10.88
     rank 12: 5.06
     rank 13: 4.89
     rank 14: 5.04
     rank 15: 4.21
  backward-recv:
     rank  0: 594.26
     rank  1: 594.66
     rank  2: 587.54
     rank  3: 592.22
     rank  4: 321.81
     rank  5: 322.06
     rank  6: 327.42
     rank  7: 324.10
     rank  8: 188.81
     rank  9: 187.75
     rank 10: 188.35
     rank 11: 188.39
     rank 12: 76.54
     rank 13: 76.89
     rank 14: 76.54
     rank 15: 77.50
  backward-send:
     rank  4: 20.20
     rank  5: 20.31
     rank  6: 16.15
     rank  7: 18.93
     rank  8: 15.35
     rank  9: 15.22
     rank 10: 15.50
     rank 11: 15.10
     rank 12: 10.58
     rank 13: 9.88
     rank 14: 10.55
     rank 15: 9.80
     rank 16: 5.06
     rank 17: 4.53
     rank 18: 5.08
     rank 19: 5.02
  forward-send-backward-recv:
     rank  0: 491.03
     rank  1: 490.53
     rank  2: 488.46
     rank  3: 486.88
     rank  4: 433.14
     rank  5: 438.51
     rank  6: 369.01
     rank  7: 414.19
     rank  8: 277.00
     rank  9: 277.67
     rank 10: 281.80
     rank 11: 273.23
     rank 12: 194.10
     rank 13: 191.30
     rank 14: 196.73
     rank 15: 179.42
  backward-send-forward-recv:
     rank  4: 727.77
     rank  5: 729.88
     rank  6: 744.07
     rank  7: 733.22
     rank  8: 923.34
     rank  9: 922.17
     rank 10: 859.80
     rank 11: 907.82
     rank 12: 903.56
     rank 13: 911.07
     rank 14: 913.74
     rank 15: 903.92
     rank 16: 2129.68
     rank 17: 2120.84
     rank 18: 2128.32
     rank 19: 2104.88
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.08
     rank  1: 0.08
     rank  2: 0.07
     rank  3: 0.08
     rank  4: 0.02
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.05
     rank 17: 0.05
     rank 18: 0.06
     rank 19: 0.05
  all-grads-sync:
     rank  0: 2.14
     rank  1: 2.20
     rank  2: 2.13
     rank  3: 2.24
     rank  4: 2.13
     rank  5: 2.20
     rank  6: 2.12
     rank  7: 2.12
     rank  8: 2.55
     rank  9: 2.54
     rank 10: 2.55
     rank 11: 2.53
     rank 12: 2.70
     rank 13: 2.65
     rank 14: 2.72
     rank 15: 2.64
     rank 16: 2.37
     rank 17: 2.44
     rank 18: 2.39
     rank 19: 2.38
  optimizer-copy-to-main-grad:
     rank  0: 0.05
     rank  1: 0.06
     rank  2: 0.04
     rank  3: 0.05
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.04
     rank  7: 0.04
     rank  8: 0.06
     rank  9: 0.06
     rank 10: 0.06
     rank 11: 0.06
     rank 12: 0.05
     rank 13: 0.04
     rank 14: 0.06
     rank 15: 0.04
     rank 16: 0.06
     rank 17: 0.06
     rank 18: 0.06
     rank 19: 0.06
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.02
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.02
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 41.13
     rank  1: 41.30
     rank  2: 41.22
     rank  3: 41.30
     rank  4: 42.76
     rank  5: 43.64
     rank  6: 43.46
     rank  7: 42.65
     rank  8: 52.11
     rank  9: 52.13
     rank 10: 52.21
     rank 11: 52.00
     rank 12: 53.65
     rank 13: 53.64
     rank 14: 53.73
     rank 15: 53.60
     rank 16: 46.39
     rank 17: 46.38
     rank 18: 46.45
     rank 19: 46.34
  optimizer:
     rank  0: 41.81
     rank  1: 41.98
     rank  2: 41.90
     rank  3: 42.00
     rank  4: 43.44
     rank  5: 44.32
     rank  6: 44.13
     rank  7: 43.33
     rank  8: 52.79
     rank  9: 52.81
     rank 10: 52.90
     rank 11: 52.69
     rank 12: 54.33
     rank 13: 54.32
     rank 14: 54.40
     rank 15: 54.28
     rank 16: 47.07
     rank 17: 47.05
     rank 18: 47.13
     rank 19: 47.02
 [2025-01-02 16:42:04] iteration        4/      10 | consumed samples:          128 | elapsed time per iteration (ms): 9981.6 | learning rate: 3.000000E-06 | global batch size:    32 | lm loss: 3.755624E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 9887.53
     rank  1: 9887.52
     rank  2: 9887.55
     rank  3: 9887.56
     rank  4: 9887.47
     rank  5: 9887.46
     rank  6: 9887.49
     rank  7: 9887.50
     rank  8: 9888.35
     rank  9: 9888.31
     rank 10: 9888.35
     rank 11: 9888.35
     rank 12: 9888.54
     rank 13: 9888.47
     rank 14: 9888.52
     rank 15: 9888.49
     rank 16: 9887.67
     rank 17: 9887.66
     rank 18: 9887.65
     rank 19: 9887.67
  forward-compute:
     rank  0: 5628.38
     rank  1: 5630.28
     rank  2: 5632.78
     rank  3: 5633.41
     rank  4: 3724.93
     rank  5: 3722.68
     rank  6: 3704.84
     rank  7: 3720.23
     rank  8: 3401.41
     rank  9: 3406.47
     rank 10: 3467.49
     rank 11: 3419.40
     rank 12: 3580.25
     rank 13: 3582.56
     rank 14: 3571.05
     rank 15: 3583.32
     rank 16: 3059.43
     rank 17: 3071.17
     rank 18: 3061.91
     rank 19: 3084.67
  backward-compute:
     rank  0: 3129.75
     rank  1: 3129.81
     rank  2: 3135.44
     rank  3: 3134.78
     rank  4: 4167.75
     rank  5: 4159.71
     rank  6: 4230.65
     rank  7: 4186.88
     rank  8: 4378.64
     rank  9: 4388.51
     rank 10: 4377.38
     rank 11: 4395.33
     rank 12: 4247.56
     rank 13: 4258.80
     rank 14: 4249.58
     rank 15: 4272.17
     rank 16: 3627.64
     rank 17: 3631.44
     rank 18: 3633.56
     rank 19: 3626.42
  pure-backward-compute:
     rank  0: 3127.92
     rank  1: 3128.00
     rank  2: 3133.83
     rank  3: 3133.09
     rank  4: 4165.11
     rank  5: 4156.47
     rank  6: 4228.27
     rank  7: 4184.43
     rank  8: 4374.94
     rank  9: 4386.01
     rank 10: 4374.03
     rank 11: 4392.84
     rank 12: 4245.23
     rank 13: 4257.35
     rank 14: 4247.12
     rank 15: 4270.59
     rank 16: 3623.23
     rank 17: 3628.77
     rank 18: 3630.89
     rank 19: 3622.03
  batch-generator:
     rank  0: 133.97
     rank  1: 143.26
     rank  2: 141.36
     rank  3: 149.23
     rank  4: 112.82
     rank  5: 120.32
     rank  6: 118.53
     rank  7: 129.27
     rank  8: 137.20
     rank  9: 130.44
     rank 10: 193.99
     rank 11: 151.23
     rank 12: 87.18
     rank 13: 91.70
     rank 14: 89.00
     rank 15: 99.07
     rank 16: 86.13
     rank 17: 98.21
     rank 18: 91.13
     rank 19: 117.82
  forward-recv:
     rank  4: 360.93
     rank  5: 360.59
     rank  6: 366.00
     rank  7: 362.34
     rank  8: 446.84
     rank  9: 446.17
     rank 10: 442.39
     rank 11: 445.41
     rank 12: 478.65
     rank 13: 479.39
     rank 14: 479.37
     rank 15: 479.43
     rank 16: 528.40
     rank 17: 528.29
     rank 18: 528.43
     rank 19: 527.68
  forward-send:
     rank  0: 20.91
     rank  1: 19.80
     rank  2: 20.58
     rank  3: 19.25
     rank  4: 14.78
     rank  5: 15.00
     rank  6: 12.08
     rank  7: 13.82
     rank  8: 9.84
     rank  9: 10.23
     rank 10: 10.36
     rank 11: 9.65
     rank 12: 5.05
     rank 13: 4.91
     rank 14: 5.05
     rank 15: 4.27
  backward-recv:
     rank  0: 597.29
     rank  1: 597.34
     rank  2: 591.07
     rank  3: 596.50
     rank  4: 323.05
     rank  5: 323.09
     rank  6: 328.75
     rank  7: 323.47
     rank  8: 186.69
     rank  9: 186.22
     rank 10: 186.66
     rank 11: 187.08
     rank 12: 75.75
     rank 13: 75.66
     rank 14: 75.72
     rank 15: 76.71
  backward-send:
     rank  4: 19.99
     rank  5: 19.96
     rank  6: 15.46
     rank  7: 19.37
     rank  8: 15.52
     rank  9: 15.02
     rank 10: 15.43
     rank 11: 14.65
     rank 12: 10.49
     rank 13: 9.88
     rank 14: 10.33
     rank 15: 9.55
     rank 16: 5.10
     rank 17: 4.56
     rank 18: 4.90
     rank 19: 5.11
  forward-send-backward-recv:
     rank  0: 491.37
     rank  1: 490.17
     rank  2: 489.54
     rank  3: 484.57
     rank  4: 435.48
     rank  5: 441.97
     rank  6: 376.30
     rank  7: 421.32
     rank  8: 283.02
     rank  9: 275.32
     rank 10: 283.68
     rank 11: 273.29
     rank 12: 195.21
     rank 13: 193.89
     rank 14: 200.11
     rank 15: 182.70
  backward-send-forward-recv:
     rank  4: 717.08
     rank  5: 718.72
     rank  6: 733.86
     rank  7: 720.94
     rank  8: 904.20
     rank  9: 905.63
     rank 10: 846.12
     rank 11: 889.48
     rank 12: 891.89
     rank 13: 887.88
     rank 14: 894.84
     rank 15: 885.15
     rank 16: 2130.22
     rank 17: 2121.46
     rank 18: 2128.45
     rank 19: 2106.62
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.08
     rank  1: 0.08
     rank  2: 0.08
     rank  3: 0.08
     rank  4: 0.02
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.05
     rank 17: 0.04
     rank 18: 0.04
     rank 19: 0.05
  all-grads-sync:
     rank  0: 2.20
     rank  1: 2.16
     rank  2: 2.21
     rank  3: 2.21
     rank  4: 2.13
     rank  5: 2.16
     rank  6: 2.16
     rank  7: 2.20
     rank  8: 2.56
     rank  9: 2.51
     rank 10: 2.58
     rank 11: 2.49
     rank 12: 2.67
     rank 13: 2.65
     rank 14: 2.66
     rank 15: 2.67
     rank 16: 2.38
     rank 17: 2.31
     rank 18: 2.34
     rank 19: 2.40
  optimizer-copy-to-main-grad:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.05
     rank  5: 0.06
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.06
     rank  9: 0.05
     rank 10: 0.06
     rank 11: 0.05
     rank 12: 0.06
     rank 13: 0.04
     rank 14: 0.05
     rank 15: 0.04
     rank 16: 0.05
     rank 17: 0.05
     rank 18: 0.06
     rank 19: 0.06
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 41.21
     rank  1: 41.11
     rank  2: 41.16
     rank  3: 41.22
     rank  4: 42.89
     rank  5: 43.55
     rank  6: 43.42
     rank  7: 42.90
     rank  8: 52.07
     rank  9: 51.93
     rank 10: 52.09
     rank 11: 51.92
     rank 12: 53.68
     rank 13: 53.67
     rank 14: 53.63
     rank 15: 53.65
     rank 16: 46.37
     rank 17: 46.34
     rank 18: 46.45
     rank 19: 46.35
  optimizer:
     rank  0: 41.93
     rank  1: 41.83
     rank  2: 41.89
     rank  3: 41.94
     rank  4: 43.61
     rank  5: 44.27
     rank  6: 44.15
     rank  7: 43.62
     rank  8: 52.79
     rank  9: 52.66
     rank 10: 52.82
     rank 11: 52.65
     rank 12: 54.40
     rank 13: 54.40
     rank 14: 54.35
     rank 15: 54.37
     rank 16: 47.09
     rank 17: 47.06
     rank 18: 47.17
     rank 19: 47.07
 [2025-01-02 16:42:14] iteration        5/      10 | consumed samples:          160 | elapsed time per iteration (ms): 10032.3 | learning rate: 3.750000E-06 | global batch size:    32 | lm loss: 3.126418E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 9947.38
     rank  1: 9947.16
     rank  2: 9947.16
     rank  3: 9947.17
     rank  4: 9947.35
     rank  5: 9947.18
     rank  6: 9947.07
     rank  7: 9947.12
     rank  8: 9948.21
     rank  9: 9948.04
     rank 10: 9947.99
     rank 11: 9947.95
     rank 12: 9948.37
     rank 13: 9948.16
     rank 14: 9948.11
     rank 15: 9948.13
     rank 16: 9948.02
     rank 17: 9947.34
     rank 18: 9947.35
     rank 19: 9947.36
  forward-compute:
     rank  0: 5682.47
     rank  1: 5684.47
     rank  2: 5686.82
     rank  3: 5687.36
     rank  4: 3734.57
     rank  5: 3731.90
     rank  6: 3717.06
     rank  7: 3731.29
     rank  8: 3379.89
     rank  9: 3384.08
     rank 10: 3448.40
     rank 11: 3400.23
     rank 12: 3594.34
     rank 13: 3602.14
     rank 14: 3588.18
     rank 15: 3611.34
     rank 16: 3071.36
     rank 17: 3082.55
     rank 18: 3073.87
     rank 19: 3095.87
  backward-compute:
     rank  0: 3133.62
     rank  1: 3133.71
     rank  2: 3140.00
     rank  3: 3141.62
     rank  4: 4186.63
     rank  5: 4180.22
     rank  6: 4256.65
     rank  7: 4214.31
     rank  8: 4401.25
     rank  9: 4409.87
     rank 10: 4397.52
     rank 11: 4432.67
     rank 12: 4250.04
     rank 13: 4260.13
     rank 14: 4251.88
     rank 15: 4276.13
     rank 16: 3628.03
     rank 17: 3632.18
     rank 18: 3634.42
     rank 19: 3627.48
  pure-backward-compute:
     rank  0: 3131.57
     rank  1: 3131.87
     rank  2: 3138.42
     rank  3: 3139.93
     rank  4: 4183.96
     rank  5: 4176.48
     rank  6: 4254.31
     rank  7: 4212.15
     rank  8: 4397.31
     rank  9: 4407.60
     rank 10: 4394.30
     rank 11: 4430.37
     rank 12: 4247.64
     rank 13: 4258.59
     rank 14: 4249.46
     rank 15: 4274.52
     rank 16: 3623.56
     rank 17: 3629.34
     rank 18: 3631.76
     rank 19: 3622.99
  batch-generator:
     rank  0: 141.66
     rank  1: 149.82
     rank  2: 147.43
     rank  3: 155.31
     rank  4: 112.67
     rank  5: 122.20
     rank  6: 121.79
     rank  7: 131.31
     rank  8: 116.80
     rank  9: 115.26
     rank 10: 185.94
     rank 11: 142.36
     rank 12: 94.95
     rank 13: 102.00
     rank 14: 97.56
     rank 15: 117.70
     rank 16: 93.22
     rank 17: 102.92
     rank 18: 95.76
     rank 19: 122.82
  forward-recv:
     rank  4: 363.23
     rank  5: 362.65
     rank  6: 368.56
     rank  7: 364.70
     rank  8: 446.40
     rank  9: 447.04
     rank 10: 441.70
     rank 11: 444.63
     rank 12: 482.31
     rank 13: 482.20
     rank 14: 482.59
     rank 15: 483.11
     rank 16: 529.11
     rank 17: 529.05
     rank 18: 529.09
     rank 19: 528.55
  forward-send:
     rank  0: 20.82
     rank  1: 19.78
     rank  2: 20.65
     rank  3: 19.28
     rank  4: 14.65
     rank  5: 14.91
     rank  6: 11.52
     rank  7: 13.53
     rank  8: 12.48
     rank  9: 11.72
     rank 10: 12.67
     rank 11: 12.24
     rank 12: 5.08
     rank 13: 4.95
     rank 14: 5.11
     rank 15: 4.47
  backward-recv:
     rank  0: 600.46
     rank  1: 599.75
     rank  2: 594.10
     rank  3: 597.63
     rank  4: 323.83
     rank  5: 324.78
     rank  6: 330.06
     rank  7: 327.90
     rank  8: 186.14
     rank  9: 185.93
     rank 10: 185.83
     rank 11: 185.44
     rank 12: 77.06
     rank 13: 77.28
     rank 14: 76.92
     rank 15: 77.85
  backward-send:
     rank  4: 21.02
     rank  5: 19.81
     rank  6: 16.04
     rank  7: 18.48
     rank  8: 15.60
     rank  9: 14.98
     rank 10: 15.64
     rank 11: 15.50
     rank 12: 10.46
     rank 13: 9.80
     rank 14: 10.46
     rank 15: 9.53
     rank 16: 5.12
     rank 17: 4.54
     rank 18: 4.92
     rank 19: 5.14
  forward-send-backward-recv:
     rank  0: 489.49
     rank  1: 489.08
     rank  2: 487.26
     rank  3: 482.28
     rank  4: 434.18
     rank  5: 437.56
     rank  6: 367.90
     rank  7: 410.09
     rank  8: 284.88
     rank  9: 273.06
     rank 10: 285.65
     rank 11: 262.43
     rank 12: 191.69
     rank 13: 189.90
     rank 14: 195.46
     rank 15: 177.13
  backward-send-forward-recv:
     rank  4: 744.74
     rank  5: 745.85
     rank  6: 759.39
     rank  7: 747.52
     rank  8: 958.10
     rank  9: 966.33
     rank 10: 899.74
     rank 11: 940.48
     rank 12: 930.81
     rank 13: 924.33
     rank 14: 932.40
     rank 15: 910.83
     rank 16: 2173.94
     rank 17: 2165.61
     rank 18: 2172.23
     rank 19: 2150.38
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.06
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.08
     rank  1: 0.07
     rank  2: 0.07
     rank  3: 0.08
     rank  4: 0.02
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.16
     rank 17: 0.05
     rank 18: 0.04
     rank 19: 0.05
  all-grads-sync:
     rank  0: 2.17
     rank  1: 2.13
     rank  2: 2.13
     rank  3: 2.15
     rank  4: 2.11
     rank  5: 2.17
     rank  6: 2.10
     rank  7: 2.11
     rank  8: 2.57
     rank  9: 2.56
     rank 10: 2.47
     rank 11: 2.49
     rank 12: 2.66
     rank 13: 2.65
     rank 14: 2.69
     rank 15: 2.69
     rank 16: 2.78
     rank 17: 2.32
     rank 18: 2.30
     rank 19: 2.40
  optimizer-copy-to-main-grad:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.03
     rank  3: 0.04
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.04
     rank  7: 0.04
     rank  8: 0.06
     rank  9: 0.05
     rank 10: 0.05
     rank 11: 0.04
     rank 12: 0.05
     rank 13: 0.04
     rank 14: 0.05
     rank 15: 0.05
     rank 16: 0.11
     rank 17: 0.04
     rank 18: 0.04
     rank 19: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.04
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.04
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 41.09
     rank  1: 41.11
     rank  2: 41.08
     rank  3: 41.08
     rank  4: 42.76
     rank  5: 43.56
     rank  6: 43.38
     rank  7: 42.84
     rank  8: 52.03
     rank  9: 51.88
     rank 10: 52.00
     rank 11: 52.11
     rank 12: 53.66
     rank 13: 53.64
     rank 14: 53.70
     rank 15: 53.70
     rank 16: 46.84
     rank 17: 46.26
     rank 18: 46.32
     rank 19: 46.40
  optimizer:
     rank  0: 42.29
     rank  1: 42.32
     rank  2: 42.28
     rank  3: 42.28
     rank  4: 43.95
     rank  5: 44.76
     rank  6: 44.57
     rank  7: 44.04
     rank  8: 53.23
     rank  9: 53.08
     rank 10: 53.21
     rank 11: 53.31
     rank 12: 54.86
     rank 13: 54.85
     rank 14: 54.90
     rank 15: 54.91
     rank 16: 48.02
     rank 17: 47.47
     rank 18: 47.52
     rank 19: 47.60
 [2025-01-02 16:42:24] iteration        6/      10 | consumed samples:          192 | elapsed time per iteration (ms): 9994.9 | learning rate: 4.500000E-06 | global batch size:    32 | lm loss: 1.870082E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 9909.27
     rank  1: 9909.27
     rank  2: 9909.32
     rank  3: 9909.32
     rank  4: 9909.27
     rank  5: 9909.25
     rank  6: 9909.20
     rank  7: 9909.28
     rank  8: 9910.12
     rank  9: 9910.05
     rank 10: 9910.07
     rank 11: 9910.10
     rank 12: 9910.29
     rank 13: 9910.25
     rank 14: 9910.25
     rank 15: 9910.28
     rank 16: 9909.47
     rank 17: 9909.45
     rank 18: 9909.45
     rank 19: 9909.46
  forward-compute:
     rank  0: 5641.60
     rank  1: 5643.54
     rank  2: 5645.53
     rank  3: 5645.73
     rank  4: 3737.43
     rank  5: 3734.93
     rank  6: 3718.12
     rank  7: 3731.88
     rank  8: 3392.53
     rank  9: 3400.50
     rank 10: 3468.42
     rank 11: 3414.68
     rank 12: 3592.75
     rank 13: 3604.47
     rank 14: 3585.91
     rank 15: 3595.30
     rank 16: 3061.04
     rank 17: 3073.32
     rank 18: 3063.91
     rank 19: 3085.91
  backward-compute:
     rank  0: 3140.08
     rank  1: 3139.56
     rank  2: 3146.19
     rank  3: 3146.16
     rank  4: 4203.92
     rank  5: 4202.22
     rank  6: 4275.49
     rank  7: 4226.69
     rank  8: 4452.97
     rank  9: 4468.67
     rank 10: 4449.73
     rank 11: 4468.10
     rank 12: 4250.88
     rank 13: 4260.71
     rank 14: 4252.80
     rank 15: 4274.90
     rank 16: 3621.36
     rank 17: 3627.06
     rank 18: 3628.79
     rank 19: 3622.86
  pure-backward-compute:
     rank  0: 3138.38
     rank  1: 3137.79
     rank  2: 3144.63
     rank  3: 3144.53
     rank  4: 4201.06
     rank  5: 4198.98
     rank  6: 4273.17
     rank  7: 4224.47
     rank  8: 4449.43
     rank  9: 4466.54
     rank 10: 4446.11
     rank 11: 4465.79
     rank 12: 4248.49
     rank 13: 4259.16
     rank 14: 4250.29
     rank 15: 4273.44
     rank 16: 3616.35
     rank 17: 3624.06
     rank 18: 3626.17
     rank 19: 3618.50
  batch-generator:
     rank  0: 129.42
     rank  1: 139.46
     rank  2: 137.20
     rank  3: 144.64
     rank  4: 113.83
     rank  5: 120.80
     rank  6: 119.00
     rank  7: 128.77
     rank  8: 116.94
     rank  9: 119.55
     rank 10: 189.13
     rank 11: 138.63
     rank 12: 94.55
     rank 13: 105.41
     rank 14: 95.76
     rank 15: 101.67
     rank 16: 93.72
     rank 17: 105.00
     rank 18: 96.78
     rank 19: 123.40
  forward-recv:
     rank  4: 370.99
     rank  5: 369.96
     rank  6: 376.22
     rank  7: 372.62
     rank  8: 451.54
     rank  9: 452.33
     rank 10: 447.14
     rank 11: 450.03
     rank 12: 488.33
     rank 13: 488.14
     rank 14: 488.50
     rank 15: 489.02
     rank 16: 528.93
     rank 17: 528.77
     rank 18: 528.97
     rank 19: 528.53
  forward-send:
     rank  0: 20.92
     rank  1: 19.50
     rank  2: 20.78
     rank  3: 19.89
     rank  4: 14.69
     rank  5: 15.02
     rank  6: 11.64
     rank  7: 13.75
     rank  8: 11.14
     rank  9: 10.09
     rank 10: 11.08
     rank 11: 10.87
     rank 12: 5.12
     rank 13: 4.80
     rank 14: 5.16
     rank 15: 4.55
  backward-recv:
     rank  0: 601.12
     rank  1: 601.22
     rank  2: 595.63
     rank  3: 600.38
     rank  4: 325.08
     rank  5: 324.36
     rank  6: 330.31
     rank  7: 326.05
     rank  8: 182.85
     rank  9: 183.59
     rank 10: 182.58
     rank 11: 182.22
     rank 12: 78.03
     rank 13: 78.12
     rank 14: 77.96
     rank 15: 78.89
  backward-send:
     rank  4: 19.98
     rank  5: 19.79
     rank  6: 16.22
     rank  7: 20.25
     rank  8: 15.80
     rank  9: 14.43
     rank 10: 15.79
     rank 11: 15.75
     rank 12: 10.44
     rank 13: 9.79
     rank 14: 10.39
     rank 15: 9.67
     rank 16: 5.18
     rank 17: 4.51
     rank 18: 4.95
     rank 19: 5.00
  forward-send-backward-recv:
     rank  0: 485.90
     rank  1: 485.39
     rank  2: 482.83
     rank  3: 478.37
     rank  4: 429.51
     rank  5: 429.64
     rank  6: 360.60
     rank  7: 409.31
     rank  8: 276.74
     rank  9: 260.95
     rank 10: 275.40
     rank 11: 267.52
     rank 12: 185.25
     rank 13: 183.42
     rank 14: 189.14
     rank 15: 172.21
  backward-send-forward-recv:
     rank  4: 684.55
     rank  5: 686.97
     rank  6: 701.30
     rank  7: 689.13
     rank  8: 864.41
     rank  9: 865.34
     rank 10: 799.94
     rank 11: 847.33
     rank 12: 891.32
     rank 13: 881.88
     rank 14: 893.83
     rank 15: 887.16
     rank 16: 2150.62
     rank 17: 2141.50
     rank 18: 2149.14
     rank 19: 2126.75
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.08
     rank  1: 0.07
     rank  2: 0.08
     rank  3: 0.08
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.05
     rank 17: 0.05
     rank 18: 0.05
     rank 19: 0.05
  all-grads-sync:
     rank  0: 2.14
     rank  1: 2.15
     rank  2: 2.16
     rank  3: 2.21
     rank  4: 2.13
     rank  5: 2.14
     rank  6: 2.13
     rank  7: 2.20
     rank  8: 2.57
     rank  9: 2.45
     rank 10: 2.56
     rank 11: 2.51
     rank 12: 2.67
     rank 13: 2.70
     rank 14: 2.71
     rank 15: 2.65
     rank 16: 2.52
     rank 17: 2.35
     rank 18: 2.31
     rank 19: 2.39
  optimizer-copy-to-main-grad:
     rank  0: 0.05
     rank  1: 0.05
     rank  2: 0.05
     rank  3: 0.06
     rank  4: 0.05
     rank  5: 0.04
     rank  6: 0.04
     rank  7: 0.06
     rank  8: 0.06
     rank  9: 0.04
     rank 10: 0.06
     rank 11: 0.05
     rank 12: 0.06
     rank 13: 0.05
     rank 14: 0.06
     rank 15: 0.04
     rank 16: 0.06
     rank 17: 0.04
     rank 18: 0.04
     rank 19: 0.06
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 41.10
     rank  1: 41.12
     rank  2: 41.12
     rank  3: 41.15
     rank  4: 42.78
     rank  5: 43.53
     rank  6: 43.50
     rank  7: 42.85
     rank  8: 51.97
     rank  9: 51.78
     rank 10: 52.15
     rank 11: 51.88
     rank 12: 53.69
     rank 13: 53.71
     rank 14: 53.73
     rank 15: 53.64
     rank 16: 46.40
     rank 17: 46.35
     rank 18: 46.30
     rank 19: 46.29
  optimizer:
     rank  0: 41.75
     rank  1: 41.77
     rank  2: 41.76
     rank  3: 41.80
     rank  4: 43.44
     rank  5: 44.20
     rank  6: 44.17
     rank  7: 43.52
     rank  8: 52.63
     rank  9: 52.45
     rank 10: 52.82
     rank 11: 52.54
     rank 12: 54.35
     rank 13: 54.38
     rank 14: 54.39
     rank 15: 54.30
     rank 16: 47.06
     rank 17: 47.01
     rank 18: 46.96
     rank 19: 46.95
 [2025-01-02 16:42:34] iteration        7/      10 | consumed samples:          224 | elapsed time per iteration (ms): 10036.0 | learning rate: 5.250000E-06 | global batch size:    32 | lm loss: 1.389131E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 9951.21
     rank  1: 9950.95
     rank  2: 9950.96
     rank  3: 9950.95
     rank  4: 9951.19
     rank  5: 9950.90
     rank  6: 9950.89
     rank  7: 9950.90
     rank  8: 9952.07
     rank  9: 9951.73
     rank 10: 9951.77
     rank 11: 9951.73
     rank 12: 9952.25
     rank 13: 9951.86
     rank 14: 9951.89
     rank 15: 9951.86
     rank 16: 9951.79
     rank 17: 9951.12
     rank 18: 9951.17
     rank 19: 9951.16
  forward-compute:
     rank  0: 5669.82
     rank  1: 5671.02
     rank  2: 5673.89
     rank  3: 5674.68
     rank  4: 3740.55
     rank  5: 3736.26
     rank  6: 3719.30
     rank  7: 3735.61
     rank  8: 3392.44
     rank  9: 3399.47
     rank 10: 3466.41
     rank 11: 3415.36
     rank 12: 3592.65
     rank 13: 3601.60
     rank 14: 3584.39
     rank 15: 3590.68
     rank 16: 3073.60
     rank 17: 3085.30
     rank 18: 3076.77
     rank 19: 3099.83
  backward-compute:
     rank  0: 3150.04
     rank  1: 3149.97
     rank  2: 3155.67
     rank  3: 3157.07
     rank  4: 4205.11
     rank  5: 4200.68
     rank  6: 4273.64
     rank  7: 4228.13
     rank  8: 4472.64
     rank  9: 4486.80
     rank 10: 4467.23
     rank 11: 4484.04
     rank 12: 4253.33
     rank 13: 4263.27
     rank 14: 4255.64
     rank 15: 4279.55
     rank 16: 3611.45
     rank 17: 3616.66
     rank 18: 3617.79
     rank 19: 3611.49
  pure-backward-compute:
     rank  0: 3148.24
     rank  1: 3148.20
     rank  2: 3154.11
     rank  3: 3155.43
     rank  4: 4202.43
     rank  5: 4197.37
     rank  6: 4271.32
     rank  7: 4225.95
     rank  8: 4468.96
     rank  9: 4484.64
     rank 10: 4464.12
     rank 11: 4481.82
     rank 12: 4251.02
     rank 13: 4261.82
     rank 14: 4253.15
     rank 15: 4278.03
     rank 16: 3606.05
     rank 17: 3613.99
     rank 18: 3615.16
     rank 19: 3607.12
  batch-generator:
     rank  0: 135.03
     rank  1: 142.70
     rank  2: 141.11
     rank  3: 149.40
     rank  4: 111.55
     rank  5: 118.38
     rank  6: 117.65
     rank  7: 129.09
     rank  8: 112.90
     rank  9: 114.07
     rank 10: 181.30
     rank 11: 134.64
     rank 12: 91.98
     rank 13: 100.24
     rank 14: 93.48
     rank 15: 96.94
     rank 16: 101.99
     rank 17: 110.41
     rank 18: 103.26
     rank 19: 130.93
  forward-recv:
     rank  4: 367.73
     rank  5: 367.44
     rank  6: 375.20
     rank  7: 368.09
     rank  8: 455.24
     rank  9: 455.55
     rank 10: 450.16
     rank 11: 454.32
     rank 12: 488.24
     rank 13: 488.31
     rank 14: 488.53
     rank 15: 489.26
     rank 16: 540.68
     rank 17: 540.36
     rank 18: 540.45
     rank 19: 539.81
  forward-send:
     rank  0: 20.81
     rank  1: 19.92
     rank  2: 20.67
     rank  3: 19.30
     rank  4: 14.61
     rank  5: 14.74
     rank  6: 11.16
     rank  7: 14.06
     rank  8: 10.61
     rank  9: 10.12
     rank 10: 10.68
     rank 11: 10.33
     rank 12: 5.05
     rank 13: 4.88
     rank 14: 5.06
     rank 15: 4.28
  backward-recv:
     rank  0: 592.38
     rank  1: 592.48
     rank  2: 586.75
     rank  3: 590.71
     rank  4: 320.71
     rank  5: 320.49
     rank  6: 326.19
     rank  7: 323.39
     rank  8: 178.60
     rank  9: 179.76
     rank 10: 178.75
     rank 11: 178.14
     rank 12: 75.62
     rank 13: 75.88
     rank 14: 75.45
     rank 15: 76.58
  backward-send:
     rank  4: 20.30
     rank  5: 20.15
     rank  6: 16.31
     rank  7: 19.11
     rank  8: 15.49
     rank  9: 14.78
     rank 10: 15.71
     rank 11: 15.60
     rank 12: 10.39
     rank 13: 9.88
     rank 14: 10.44
     rank 15: 9.44
     rank 16: 5.09
     rank 17: 4.44
     rank 18: 4.88
     rank 19: 5.08
  forward-send-backward-recv:
     rank  0: 497.47
     rank  1: 497.03
     rank  2: 495.11
     rank  3: 489.90
     rank  4: 441.94
     rank  5: 444.38
     rank  6: 375.94
     rank  7: 421.69
     rank  8: 289.74
     rank  9: 275.51
     rank 10: 289.69
     rank 11: 282.63
     rank 12: 198.64
     rank 13: 196.29
     rank 14: 202.06
     rank 15: 183.87
  backward-send-forward-recv:
     rank  4: 716.17
     rank  5: 719.64
     rank  6: 732.62
     rank  7: 720.51
     rank  8: 874.41
     rank  9: 875.37
     rank 10: 813.02
     rank 11: 856.86
     rank 12: 919.86
     rank 13: 912.75
     rank 14: 923.57
     rank 15: 918.97
     rank 16: 2177.54
     rank 17: 2169.28
     rank 18: 2176.75
     rank 19: 2153.94
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.05
     rank 17: 0.02
     rank 18: 0.03
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.08
     rank  1: 0.08
     rank  2: 0.08
     rank  3: 0.07
     rank  4: 0.02
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.16
     rank 17: 0.05
     rank 18: 0.07
     rank 19: 0.05
  all-grads-sync:
     rank  0: 2.15
     rank  1: 2.15
     rank  2: 2.17
     rank  3: 2.15
     rank  4: 2.08
     rank  5: 2.12
     rank  6: 2.11
     rank  7: 2.17
     rank  8: 2.53
     rank  9: 2.54
     rank 10: 2.56
     rank 11: 2.50
     rank 12: 2.72
     rank 13: 2.65
     rank 14: 2.66
     rank 15: 2.66
     rank 16: 3.05
     rank 17: 2.34
     rank 18: 2.47
     rank 19: 2.39
  optimizer-copy-to-main-grad:
     rank  0: 0.03
     rank  1: 0.04
     rank  2: 0.05
     rank  3: 0.05
     rank  4: 0.04
     rank  5: 0.04
     rank  6: 0.04
     rank  7: 0.05
     rank  8: 0.06
     rank  9: 0.04
     rank 10: 0.07
     rank 11: 0.05
     rank 12: 0.06
     rank 13: 0.04
     rank 14: 0.05
     rank 15: 0.05
     rank 16: 0.13
     rank 17: 0.05
     rank 18: 0.06
     rank 19: 0.06
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.04
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.03
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 41.09
     rank  1: 41.07
     rank  2: 41.07
     rank  3: 41.12
     rank  4: 42.66
     rank  5: 43.39
     rank  6: 43.37
     rank  7: 42.81
     rank  8: 51.76
     rank  9: 52.02
     rank 10: 52.04
     rank 11: 52.02
     rank 12: 53.71
     rank 13: 53.64
     rank 14: 53.68
     rank 15: 53.68
     rank 16: 47.03
     rank 17: 46.29
     rank 18: 46.47
     rank 19: 46.30
  optimizer:
     rank  0: 42.21
     rank  1: 42.20
     rank  2: 42.20
     rank  3: 42.25
     rank  4: 43.80
     rank  5: 44.53
     rank  6: 44.51
     rank  7: 43.95
     rank  8: 52.90
     rank  9: 53.16
     rank 10: 53.19
     rank 11: 53.16
     rank 12: 54.85
     rank 13: 54.78
     rank 14: 54.82
     rank 15: 54.82
     rank 16: 48.19
     rank 17: 47.43
     rank 18: 47.60
     rank 19: 47.44
 [2025-01-02 16:42:44] iteration        8/      10 | consumed samples:          256 | elapsed time per iteration (ms): 10027.6 | learning rate: 6.000000E-06 | global batch size:    32 | lm loss: 2.716836E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 9939.91
     rank  1: 9939.66
     rank  2: 9939.67
     rank  3: 9939.69
     rank  4: 9939.90
     rank  5: 9939.64
     rank  6: 9939.63
     rank  7: 9939.65
     rank  8: 9940.74
     rank  9: 9940.51
     rank 10: 9940.51
     rank 11: 9940.53
     rank 12: 9940.92
     rank 13: 9940.71
     rank 14: 9940.72
     rank 15: 9940.74
     rank 16: 9940.44
     rank 17: 9939.82
     rank 18: 9939.82
     rank 19: 9939.85
  forward-compute:
     rank  0: 5646.40
     rank  1: 5647.83
     rank  2: 5650.40
     rank  3: 5651.89
     rank  4: 3755.20
     rank  5: 3753.03
     rank  6: 3736.04
     rank  7: 3750.19
     rank  8: 3408.97
     rank  9: 3418.11
     rank 10: 3480.78
     rank 11: 3431.68
     rank 12: 3595.37
     rank 13: 3602.54
     rank 14: 3587.03
     rank 15: 3599.60
     rank 16: 3088.42
     rank 17: 3099.62
     rank 18: 3091.68
     rank 19: 3113.93
  backward-compute:
     rank  0: 3153.10
     rank  1: 3153.13
     rank  2: 3158.21
     rank  3: 3157.36
     rank  4: 4218.87
     rank  5: 4213.97
     rank  6: 4286.09
     rank  7: 4240.92
     rank  8: 4501.07
     rank  9: 4511.54
     rank 10: 4495.66
     rank 11: 4517.90
     rank 12: 4251.45
     rank 13: 4259.42
     rank 14: 4252.82
     rank 15: 4276.49
     rank 16: 3620.47
     rank 17: 3626.31
     rank 18: 3628.32
     rank 19: 3621.41
  pure-backward-compute:
     rank  0: 3151.34
     rank  1: 3151.39
     rank  2: 3156.72
     rank  3: 3155.73
     rank  4: 4216.05
     rank  5: 4210.62
     rank  6: 4283.67
     rank  7: 4238.76
     rank  8: 4497.77
     rank  9: 4509.46
     rank 10: 4492.48
     rank 11: 4515.51
     rank 12: 4248.72
     rank 13: 4257.98
     rank 14: 4250.41
     rank 15: 4275.00
     rank 16: 3614.68
     rank 17: 3623.65
     rank 18: 3625.75
     rank 19: 3616.98
  batch-generator:
     rank  0: 130.58
     rank  1: 139.65
     rank  2: 137.91
     rank  3: 146.69
     rank  4: 118.42
     rank  5: 124.41
     rank  6: 122.55
     rank  7: 132.30
     rank  8: 113.59
     rank  9: 115.54
     rank 10: 181.56
     rank 11: 136.22
     rank 12: 91.69
     rank 13: 96.93
     rank 14: 93.42
     rank 15: 102.60
     rank 16: 113.35
     rank 17: 117.90
     rank 18: 111.11
     rank 19: 138.20
  forward-recv:
     rank  4: 363.61
     rank  5: 362.89
     rank  6: 368.67
     rank  7: 364.85
     rank  8: 446.94
     rank  9: 446.89
     rank 10: 442.53
     rank 11: 446.21
     rank 12: 482.38
     rank 13: 482.47
     rank 14: 482.63
     rank 15: 482.40
     rank 16: 531.99
     rank 17: 531.87
     rank 18: 531.94
     rank 19: 531.34
  forward-send:
     rank  0: 20.82
     rank  1: 19.68
     rank  2: 20.69
     rank  3: 19.27
     rank  4: 14.72
     rank  5: 14.97
     rank  6: 11.79
     rank  7: 13.82
     rank  8: 11.42
     rank  9: 10.78
     rank 10: 11.32
     rank 11: 10.33
     rank 12: 5.08
     rank 13: 4.89
     rank 14: 5.06
     rank 15: 4.33
  backward-recv:
     rank  0: 601.79
     rank  1: 601.86
     rank  2: 596.21
     rank  3: 600.08
     rank  4: 322.92
     rank  5: 323.98
     rank  6: 329.13
     rank  7: 325.94
     rank  8: 181.96
     rank  9: 181.58
     rank 10: 181.03
     rank 11: 181.20
     rank 12: 78.02
     rank 13: 78.21
     rank 14: 77.92
     rank 15: 78.74
  backward-send:
     rank  4: 20.19
     rank  5: 20.09
     rank  6: 16.28
     rank  7: 19.07
     rank  8: 14.88
     rank  9: 15.15
     rank 10: 15.57
     rank 11: 15.29
     rank 12: 10.49
     rank 13: 9.97
     rank 14: 10.40
     rank 15: 9.56
     rank 16: 5.15
     rank 17: 4.54
     rank 18: 4.91
     rank 19: 5.05
  forward-send-backward-recv:
     rank  0: 497.48
     rank  1: 496.69
     rank  2: 495.64
     rank  3: 491.79
     rank  4: 437.80
     rank  5: 439.68
     rank  6: 372.92
     rank  7: 418.56
     rank  8: 286.77
     rank  9: 274.77
     rank 10: 287.38
     rank 11: 274.96
     rank 12: 196.75
     rank 13: 193.74
     rank 14: 200.20
     rank 15: 181.56
  backward-send-forward-recv:
     rank  4: 681.66
     rank  5: 683.37
     rank  6: 698.03
     rank  7: 686.09
     rank  8: 825.88
     rank  9: 826.71
     rank 10: 765.18
     rank 11: 807.78
     rank 12: 912.58
     rank 13: 909.23
     rank 14: 917.22
     rank 15: 907.72
     rank 16: 2147.78
     rank 17: 2141.67
     rank 18: 2147.63
     rank 19: 2125.87
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.04
     rank 16: 0.05
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.07
     rank  1: 0.07
     rank  2: 0.07
     rank  3: 0.08
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.03
     rank 16: 0.15
     rank 17: 0.04
     rank 18: 0.05
     rank 19: 0.05
  all-grads-sync:
     rank  0: 2.16
     rank  1: 2.16
     rank  2: 2.15
     rank  3: 2.21
     rank  4: 2.12
     rank  5: 2.11
     rank  6: 2.14
     rank  7: 2.13
     rank  8: 2.52
     rank  9: 2.48
     rank 10: 2.49
     rank 11: 2.45
     rank 12: 2.65
     rank 13: 2.68
     rank 14: 2.66
     rank 15: 2.84
     rank 16: 2.99
     rank 17: 2.33
     rank 18: 2.33
     rank 19: 2.39
  optimizer-copy-to-main-grad:
     rank  0: 0.05
     rank  1: 0.06
     rank  2: 0.05
     rank  3: 0.05
     rank  4: 0.04
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.05
     rank  9: 0.04
     rank 10: 0.05
     rank 11: 0.04
     rank 12: 0.05
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.09
     rank 16: 0.13
     rank 17: 0.05
     rank 18: 0.05
     rank 19: 0.06
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.04
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.03
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 41.07
     rank  1: 41.10
     rank  2: 41.08
     rank  3: 41.18
     rank  4: 42.70
     rank  5: 43.39
     rank  6: 43.53
     rank  7: 42.81
     rank  8: 51.97
     rank  9: 51.65
     rank 10: 51.89
     rank 11: 51.84
     rank 12: 53.66
     rank 13: 53.72
     rank 14: 53.67
     rank 15: 53.82
     rank 16: 47.06
     rank 17: 46.32
     rank 18: 46.29
     rank 19: 46.32
  optimizer:
     rank  0: 42.20
     rank  1: 42.23
     rank  2: 42.21
     rank  3: 42.31
     rank  4: 43.85
     rank  5: 44.54
     rank  6: 44.67
     rank  7: 43.95
     rank  8: 53.11
     rank  9: 52.80
     rank 10: 53.03
     rank 11: 52.98
     rank 12: 54.79
     rank 13: 54.86
     rank 14: 54.81
     rank 15: 54.96
     rank 16: 48.23
     rank 17: 47.46
     rank 18: 47.43
     rank 19: 47.45
 [2025-01-02 16:42:54] iteration        9/      10 | consumed samples:          288 | elapsed time per iteration (ms): 10033.3 | learning rate: 6.750000E-06 | global batch size:    32 | lm loss: 2.338521E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 9947.66
     rank  1: 9947.45
     rank  2: 9947.46
     rank  3: 9947.41
     rank  4: 9947.62
     rank  5: 9947.42
     rank  6: 9947.42
     rank  7: 9947.38
     rank  8: 9948.51
     rank  9: 9948.25
     rank 10: 9948.29
     rank 11: 9948.25
     rank 12: 9948.67
     rank 13: 9948.37
     rank 14: 9948.44
     rank 15: 9948.40
     rank 16: 9947.91
     rank 17: 9947.63
     rank 18: 9947.70
     rank 19: 9947.63
  forward-compute:
     rank  0: 5627.38
     rank  1: 5629.00
     rank  2: 5630.74
     rank  3: 5632.15
     rank  4: 3757.69
     rank  5: 3755.27
     rank  6: 3738.88
     rank  7: 3752.93
     rank  8: 3436.14
     rank  9: 3444.18
     rank 10: 3507.69
     rank 11: 3457.68
     rank 12: 3597.95
     rank 13: 3604.53
     rank 14: 3590.02
     rank 15: 3599.73
     rank 16: 3093.32
     rank 17: 3105.30
     rank 18: 3095.38
     rank 19: 3119.27
  backward-compute:
     rank  0: 3174.26
     rank  1: 3173.67
     rank  2: 3180.80
     rank  3: 3179.46
     rank  4: 4237.86
     rank  5: 4233.62
     rank  6: 4304.88
     rank  7: 4258.41
     rank  8: 4526.47
     rank  9: 4537.53
     rank 10: 4521.40
     rank 11: 4542.36
     rank 12: 4249.19
     rank 13: 4259.55
     rank 14: 4250.45
     rank 15: 4275.50
     rank 16: 3625.90
     rank 17: 3631.84
     rank 18: 3632.68
     rank 19: 3628.95
  pure-backward-compute:
     rank  0: 3172.52
     rank  1: 3171.90
     rank  2: 3179.24
     rank  3: 3177.78
     rank  4: 4234.91
     rank  5: 4230.10
     rank  6: 4302.55
     rank  7: 4256.19
     rank  8: 4523.20
     rank  9: 4535.22
     rank 10: 4518.26
     rank 11: 4539.94
     rank 12: 4246.85
     rank 13: 4258.11
     rank 14: 4247.91
     rank 15: 4274.02
     rank 16: 3620.05
     rank 17: 3629.19
     rank 18: 3629.37
     rank 19: 3624.64
  batch-generator:
     rank  0: 130.16
     rank  1: 139.75
     rank  2: 137.93
     rank  3: 146.15
     rank  4: 116.99
     rank  5: 123.55
     rank  6: 122.66
     rank  7: 132.06
     rank  8: 114.51
     rank  9: 115.84
     rank 10: 181.09
     rank 11: 135.57
     rank 12: 89.94
     rank 13: 96.61
     rank 14: 92.91
     rank 15: 98.12
     rank 16: 114.15
     rank 17: 119.68
     rank 18: 115.65
     rank 19: 139.40
  forward-recv:
     rank  4: 357.39
     rank  5: 356.85
     rank  6: 362.82
     rank  7: 358.72
     rank  8: 446.23
     rank  9: 446.00
     rank 10: 441.05
     rank 11: 444.19
     rank 12: 481.62
     rank 13: 481.89
     rank 14: 482.19
     rank 15: 482.76
     rank 16: 529.55
     rank 17: 529.44
     rank 18: 529.51
     rank 19: 528.89
  forward-send:
     rank  0: 20.88
     rank  1: 19.73
     rank  2: 20.64
     rank  3: 19.40
     rank  4: 14.64
     rank  5: 14.82
     rank  6: 11.71
     rank  7: 13.70
     rank  8: 11.78
     rank  9: 11.47
     rank 10: 12.35
     rank 11: 11.85
     rank 12: 5.06
     rank 13: 4.92
     rank 14: 5.07
     rank 15: 4.34
  backward-recv:
     rank  0: 602.31
     rank  1: 602.45
     rank  2: 596.72
     rank  3: 600.54
     rank  4: 323.85
     rank  5: 323.82
     rank  6: 329.13
     rank  7: 326.49
     rank  8: 180.54
     rank  9: 181.35
     rank 10: 180.11
     rank 11: 179.33
     rank 12: 78.20
     rank 13: 77.97
     rank 14: 78.38
     rank 15: 79.07
  backward-send:
     rank  4: 20.10
     rank  5: 20.05
     rank  6: 16.26
     rank  7: 18.99
     rank  8: 15.49
     rank  9: 14.59
     rank 10: 15.62
     rank 11: 15.68
     rank 12: 10.40
     rank 13: 9.93
     rank 14: 10.35
     rank 15: 9.46
     rank 16: 4.98
     rank 17: 4.06
     rank 18: 4.98
     rank 19: 4.98
  forward-send-backward-recv:
     rank  0: 502.72
     rank  1: 502.42
     rank  2: 500.28
     rank  3: 497.05
     rank  4: 441.40
     rank  5: 443.62
     rank  6: 376.82
     rank  7: 423.17
     rank  8: 284.78
     rank  9: 271.68
     rank 10: 284.58
     rank 11: 274.61
     rank 12: 195.10
     rank 13: 191.95
     rank 14: 197.95
     rank 15: 179.63
  backward-send-forward-recv:
     rank  4: 670.79
     rank  5: 672.76
     rank  6: 687.05
     rank  7: 675.66
     rank  8: 784.40
     rank  9: 786.08
     rank 10: 724.48
     rank 11: 767.81
     rank 12: 921.29
     rank 13: 916.71
     rank 14: 924.69
     rank 15: 916.73
     rank 16: 2147.23
     rank 17: 2139.80
     rank 18: 2146.99
     rank 19: 2122.84
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.05
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.08
     rank  1: 0.08
     rank  2: 0.07
     rank  3: 0.07
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.15
     rank 17: 0.05
     rank 18: 0.06
     rank 19: 0.05
  all-grads-sync:
     rank  0: 2.16
     rank  1: 2.17
     rank  2: 2.15
     rank  3: 2.14
     rank  4: 2.13
     rank  5: 2.17
     rank  6: 2.12
     rank  7: 2.12
     rank  8: 2.52
     rank  9: 2.55
     rank 10: 2.56
     rank 11: 2.54
     rank 12: 2.65
     rank 13: 2.65
     rank 14: 2.65
     rank 15: 2.66
     rank 16: 2.74
     rank 17: 2.32
     rank 18: 2.38
     rank 19: 2.35
  optimizer-copy-to-main-grad:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.03
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.04
     rank  7: 0.04
     rank  8: 0.07
     rank  9: 0.05
     rank 10: 0.06
     rank 11: 0.05
     rank 12: 0.05
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.05
     rank 16: 0.13
     rank 17: 0.09
     rank 18: 0.05
     rank 19: 0.06
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 41.06
     rank  1: 41.07
     rank  2: 41.03
     rank  3: 41.05
     rank  4: 42.85
     rank  5: 43.49
     rank  6: 43.41
     rank  7: 42.81
     rank  8: 51.89
     rank  9: 51.95
     rank 10: 52.16
     rank 11: 51.95
     rank 12: 53.68
     rank 13: 53.71
     rank 14: 53.67
     rank 15: 53.71
     rank 16: 46.80
     rank 17: 46.29
     rank 18: 46.37
     rank 19: 46.36
  optimizer:
     rank  0: 41.79
     rank  1: 41.81
     rank  2: 41.76
     rank  3: 41.78
     rank  4: 43.58
     rank  5: 44.22
     rank  6: 44.14
     rank  7: 43.56
     rank  8: 52.62
     rank  9: 52.69
     rank 10: 52.90
     rank 11: 52.69
     rank 12: 54.41
     rank 13: 54.44
     rank 14: 54.40
     rank 15: 54.43
     rank 16: 47.53
     rank 17: 47.02
     rank 18: 47.10
     rank 19: 47.09
 [2025-01-02 16:43:04] iteration       10/      10 | consumed samples:          320 | elapsed time per iteration (ms): 10027.7 | learning rate: 7.500000E-06 | global batch size:    32 | lm loss: 2.564539E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 9940.85
     rank  1: 9940.87
     rank  2: 9940.85
     rank  3: 9940.91
     rank  4: 9940.83
     rank  5: 9940.79
     rank  6: 9940.76
     rank  7: 9940.84
     rank  8: 9941.73
     rank  9: 9941.66
     rank 10: 9941.65
     rank 11: 9941.77
     rank 12: 9941.90
     rank 13: 9941.86
     rank 14: 9941.91
     rank 15: 9941.88
     rank 16: 9941.07
     rank 17: 9941.04
     rank 18: 9941.04
     rank 19: 9941.21
  forward-compute:
     rank  0: 5631.63
     rank  1: 5633.23
     rank  2: 5635.71
     rank  3: 5636.60
     rank  4: 3756.09
     rank  5: 3753.44
     rank  6: 3736.70
     rank  7: 3750.68
     rank  8: 3458.45
     rank  9: 3467.12
     rank 10: 3531.11
     rank 11: 3480.59
     rank 12: 3600.25
     rank 13: 3604.20
     rank 14: 3591.54
     rank 15: 3601.66
     rank 16: 3116.91
     rank 17: 3128.45
     rank 18: 3120.23
     rank 19: 3144.04
  backward-compute:
     rank  0: 3152.43
     rank  1: 3152.18
     rank  2: 3157.81
     rank  3: 3157.71
     rank  4: 4235.49
     rank  5: 4231.39
     rank  6: 4302.36
     rank  7: 4257.86
     rank  8: 4562.88
     rank  9: 4577.04
     rank 10: 4558.83
     rank 11: 4576.57
     rank 12: 4254.68
     rank 13: 4263.74
     rank 14: 4256.41
     rank 15: 4280.59
     rank 16: 3625.46
     rank 17: 3630.98
     rank 18: 3633.34
     rank 19: 3626.97
  pure-backward-compute:
     rank  0: 3150.73
     rank  1: 3150.42
     rank  2: 3156.25
     rank  3: 3156.08
     rank  4: 4232.88
     rank  5: 4228.06
     rank  6: 4299.96
     rank  7: 4255.55
     rank  8: 4559.74
     rank  9: 4574.94
     rank 10: 4555.75
     rank 11: 4574.45
     rank 12: 4252.27
     rank 13: 4262.29
     rank 14: 4254.00
     rank 15: 4279.19
     rank 16: 3619.91
     rank 17: 3628.31
     rank 18: 3630.83
     rank 19: 3621.89
  batch-generator:
     rank  0: 128.52
     rank  1: 138.01
     rank  2: 136.46
     rank  3: 144.50
     rank  4: 110.68
     rank  5: 118.12
     rank  6: 117.28
     rank  7: 126.76
     rank  8: 113.05
     rank  9: 114.89
     rank 10: 180.49
     rank 11: 134.07
     rank 12: 95.04
     rank 13: 97.38
     rank 14: 94.34
     rank 15: 101.61
     rank 16: 116.40
     rank 17: 120.80
     rank 18: 113.86
     rank 19: 145.92
  forward-recv:
     rank  4: 354.55
     rank  5: 354.05
     rank  6: 359.69
     rank  7: 355.80
     rank  8: 442.64
     rank  9: 442.42
     rank 10: 438.13
     rank 11: 441.97
     rank 12: 479.72
     rank 13: 479.97
     rank 14: 480.04
     rank 15: 479.91
     rank 16: 530.63
     rank 17: 530.52
     rank 18: 530.53
     rank 19: 529.92
  forward-send:
     rank  0: 20.78
     rank  1: 19.81
     rank  2: 20.64
     rank  3: 19.38
     rank  4: 14.69
     rank  5: 14.94
     rank  6: 11.72
     rank  7: 13.78
     rank  8: 11.53
     rank  9: 11.21
     rank 10: 11.69
     rank 11: 10.59
     rank 12: 5.02
     rank 13: 4.91
     rank 14: 5.06
     rank 15: 4.31
  backward-recv:
     rank  0: 608.59
     rank  1: 608.78
     rank  2: 603.17
     rank  3: 607.07
     rank  4: 330.09
     rank  5: 330.96
     rank  6: 335.50
     rank  7: 330.71
     rank  8: 178.03
     rank  9: 177.49
     rank 10: 177.67
     rank 11: 179.06
     rank 12: 76.57
     rank 13: 76.48
     rank 14: 76.37
     rank 15: 77.77
  backward-send:
     rank  4: 20.13
     rank  5: 20.06
     rank  6: 16.25
     rank  7: 19.10
     rank  8: 15.05
     rank  9: 15.25
     rank 10: 15.47
     rank 11: 13.73
     rank 12: 10.42
     rank 13: 10.04
     rank 14: 10.40
     rank 15: 9.13
     rank 16: 5.10
     rank 17: 4.42
     rank 18: 4.82
     rank 19: 5.13
  forward-send-backward-recv:
     rank  0: 507.70
     rank  1: 506.73
     rank  2: 505.35
     rank  3: 500.96
     rank  4: 449.12
     rank  5: 450.32
     rank  6: 385.15
     rank  7: 431.53
     rank  8: 292.57
     rank  9: 283.27
     rank 10: 294.73
     rank 11: 283.37
     rank 12: 199.78
     rank 13: 197.47
     rank 14: 203.28
     rank 15: 184.42
  backward-send-forward-recv:
     rank  4: 656.98
     rank  5: 658.87
     rank  6: 673.24
     rank  7: 661.38
     rank  8: 716.74
     rank  9: 712.04
     rank 10: 651.82
     rank 11: 700.14
     rank 12: 901.57
     rank 13: 899.60
     rank 14: 905.97
     rank 15: 898.46
     rank 16: 2113.05
     rank 17: 2105.67
     rank 18: 2111.62
     rank 19: 2085.76
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.07
     rank  1: 0.07
     rank  2: 0.07
     rank  3: 0.08
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.05
     rank 17: 0.04
     rank 18: 0.05
     rank 19: 0.07
  all-grads-sync:
     rank  0: 2.11
     rank  1: 2.13
     rank  2: 2.12
     rank  3: 2.19
     rank  4: 2.09
     rank  5: 2.09
     rank  6: 2.09
     rank  7: 2.10
     rank  8: 2.56
     rank  9: 2.49
     rank 10: 2.50
     rank 11: 2.64
     rank 12: 2.72
     rank 13: 2.71
     rank 14: 2.71
     rank 15: 2.64
     rank 16: 2.39
     rank 17: 2.33
     rank 18: 2.33
     rank 19: 2.48
  optimizer-copy-to-main-grad:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.04
     rank  4: 0.04
     rank  5: 0.04
     rank  6: 0.04
     rank  7: 0.04
     rank  8: 0.06
     rank  9: 0.04
     rank 10: 0.05
     rank 11: 0.07
     rank 12: 0.07
     rank 13: 0.05
     rank 14: 0.07
     rank 15: 0.04
     rank 16: 0.05
     rank 17: 0.05
     rank 18: 0.05
     rank 19: 0.07
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 41.07
     rank  1: 41.00
     rank  2: 41.02
     rank  3: 41.13
     rank  4: 42.64
     rank  5: 43.45
     rank  6: 43.38
     rank  7: 42.71
     rank  8: 51.93
     rank  9: 51.65
     rank 10: 51.89
     rank 11: 52.04
     rank 12: 53.79
     rank 13: 53.75
     rank 14: 53.76
     rank 15: 53.68
     rank 16: 46.32
     rank 17: 46.32
     rank 18: 46.36
     rank 19: 46.54
  optimizer:
     rank  0: 41.74
     rank  1: 41.67
     rank  2: 41.69
     rank  3: 41.80
     rank  4: 43.31
     rank  5: 44.11
     rank  6: 44.05
     rank  7: 43.37
     rank  8: 52.60
     rank  9: 52.32
     rank 10: 52.56
     rank 11: 52.71
     rank 12: 54.46
     rank 13: 54.41
     rank 14: 54.43
     rank 15: 54.35
     rank 16: 46.99
     rank 17: 46.99
     rank 18: 47.03
     rank 19: 47.22
