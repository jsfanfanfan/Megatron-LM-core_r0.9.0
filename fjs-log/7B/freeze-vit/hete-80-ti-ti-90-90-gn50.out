examples/multimodal/pretrain-freeze-llm-hete-2080first.sh: line 4: activate: No such file or directory
4
[2025-01-02 18:16:52,244] torch.distributed.run: [WARNING] 
[2025-01-02 18:16:52,244] torch.distributed.run: [WARNING] *****************************************
[2025-01-02 18:16:52,244] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2025-01-02 18:16:52,244] torch.distributed.run: [WARNING] *****************************************
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:20------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:20------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:20------
------num_pipeline_model_parallel_groups:4------
> setting tensorboard ...
WARNING: one_logger package is required to enable e2e metrics tracking. please go to https://confluence.nvidia.com/display/MLWFO/Package+Repositories for details to install it
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:20------
------num_pipeline_model_parallel_groups:4------
---Rank 17---Tensor Parallel Group GPUs: [1, 1, 1, 1]
---Rank 17---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]
---Rank 19---Tensor Parallel Group GPUs: [3, 3, 3, 3]
---Rank 19---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]
---Rank 18---Tensor Parallel Group GPUs: [2, 2, 2, 2]
[rank17]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
---Rank 18---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]
[rank19]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank18]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
---Rank 16---Tensor Parallel Group GPUs: [0, 0, 0, 0]
---Rank 16---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]
[rank16]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
 > number of parameters on (tensor, pipeline) model parallel rank (0, 4): 578899968
 > number of parameters on (tensor, pipeline) model parallel rank (3, 4): 578899968
 > number of parameters on (tensor, pipeline) model parallel rank (2, 4): 578899968
 > number of parameters on (tensor, pipeline) model parallel rank (1, 4): 578899968
INFO:megatron.core.distributed.param_and_grad_buffer:Number of buckets for gradient all-reduce / reduce-scatter: 1
Params for bucket 1 (578899968 elements):
	language_model.decoder.layers.9.mlp.linear_fc2.weight
	language_model.decoder.layers.9.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.8.self_attention.linear_proj.weight
	language_model.decoder.layers.7.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.6.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.6.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.5.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.4.mlp.linear_fc2.weight
	language_model.decoder.layers.4.self_attention.linear_proj.weight
	language_model.decoder.layers.3.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.0.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.9.mlp.linear_fc1.weight
	language_model.decoder.layers.7.self_attention.linear_qkv.weight
	language_model.decoder.layers.5.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.5.self_attention.linear_proj.weight
	language_model.decoder.final_layernorm.weight
	language_model.decoder.layers.9.self_attention.linear_proj.weight
	language_model.decoder.layers.8.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.6.mlp.linear_fc2.weight
	language_model.decoder.layers.5.self_attention.linear_qkv.weight
	language_model.decoder.layers.3.mlp.linear_fc1.weight
	language_model.decoder.layers.2.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.2.self_attention.linear_qkv.weight
	language_model.decoder.layers.1.self_attention.linear_proj.weight
	language_model.decoder.layers.0.mlp.linear_fc1.weight
	language_model.decoder.layers.8.self_attention.linear_qkv.weight
	language_model.decoder.layers.6.self_attention.linear_proj.weight
	language_model.decoder.layers.4.mlp.linear_fc1.weight
	language_model.decoder.layers.4.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.1.mlp.linear_fc1.weight
	language_model.decoder.layers.1.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.0.self_attention.linear_proj.weight
	language_model.decoder.layers.9.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.7.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.7.mlp.linear_fc2.weight
	language_model.decoder.layers.6.self_attention.linear_qkv.weight
	language_model.decoder.layers.3.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.2.mlp.linear_fc2.weight
	language_model.decoder.layers.0.mlp.linear_fc2.weight
	language_model.decoder.layers.3.self_attention.linear_qkv.weight
	language_model.decoder.layers.2.self_attention.linear_proj.weight
	language_model.decoder.layers.9.self_attention.linear_qkv.weight
	language_model.decoder.layers.7.mlp.linear_fc1.weight
	language_model.decoder.layers.1.mlp.linear_fc2.weight
	language_model.decoder.layers.1.self_attention.linear_qkv.weight
	language_model.output_layer.weight
	language_model.decoder.layers.8.mlp.linear_fc2.weight
	language_model.decoder.layers.8.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.7.self_attention.linear_proj.weight
	language_model.decoder.layers.6.mlp.linear_fc1.weight
	language_model.decoder.layers.5.mlp.linear_fc1.weight
	language_model.decoder.layers.4.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.2.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.0.self_attention.linear_qkv.weight
	language_model.decoder.layers.0.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.8.mlp.linear_fc1.weight
	language_model.decoder.layers.5.mlp.linear_fc2.weight
	language_model.decoder.layers.4.self_attention.linear_qkv.weight
	language_model.decoder.layers.3.mlp.linear_fc2.weight
	language_model.decoder.layers.3.self_attention.linear_proj.weight
	language_model.decoder.layers.2.mlp.linear_fc1.weight
	language_model.decoder.layers.1.self_attention.linear_qkv.layer_norm_weight
rank=0, worker=0: shard_range=[pretrain-0.tar[0, 100), pretrain-0.tar[100, 200), pretrain-0.tar[200, 300), ...<2494>, pretrain-30.tar[9700, 9800), pretrain-30.tar[9800, 9900), pretrain-30.tar[9900, 10000)] sum(count)=250000
rank=0, worker=1: shard_range=[pretrain-31.tar[0, 100), pretrain-31.tar[100, 200), pretrain-31.tar[200, 300), ...<2494>, pretrain-53.tar[9700, 9800), pretrain-53.tar[9800, 9900), pretrain-53.tar[9900, 10000)] sum(count)=250000
rank=0, worker=0: shard_range=[pretrain-54.tar[0, 10000), pretrain-55.tar[0, 8128), pretrain-6.tar[0, 10000), pretrain-7.tar[0, 936)] sum(count)=29064
rank=0, worker=1: shard_range=[pretrain-7.tar[936, 10000), pretrain-8.tar[0, 10000), pretrain-9.tar[0, 10000)] sum(count)=29064
times across ranks (ms):
  model-and-optimizer-setup:
     rank  0: 111.99
     rank  1: 112.25
     rank  2: 112.32
     rank  3: 111.87
     rank  4: 96.57
     rank  5: 96.27
     rank  6: 97.77
     rank  7: 94.10
     rank  8: 64.72
     rank  9: 64.62
     rank 10: 65.12
     rank 11: 65.50
     rank 12: 178.68
     rank 13: 178.27
     rank 14: 178.50
     rank 15: 178.52
     rank 16: 234.02
     rank 17: 233.98
     rank 18: 234.01
     rank 19: 233.92
  train/valid/test-data-iterators-setup:
     rank  0: 1095.54
     rank  1: 1095.39
     rank  2: 1509.28
     rank  3: 1095.66
     rank  4: 1245.49
     rank  5: 1245.35
     rank  6: 1095.28
     rank  7: 1245.69
     rank  8: 1245.41
     rank  9: 1245.43
     rank 10: 1245.42
     rank 11: 1245.49
     rank 12: 1245.41
     rank 13: 1245.46
     rank 14: 1245.78
     rank 15: 1245.47
     rank 16: 1509.13
     rank 17: 1508.98
     rank 18: 1509.00
     rank 19: 1508.99
 [2025-01-02 18:18:30] iteration        1/      10 | consumed samples:           32 | elapsed time per iteration (ms): 29164.6 | learning rate: 7.500000E-07 | global batch size:    32 | lm loss: 7.018427E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
[Rank 17] (after 1 iterations) memory (MB) | allocated: 8886.5654296875 | max allocated: 11093.923828125 | reserved: 11866.0 | max reserved: 11866.0
[Rank 18] (after 1 iterations) memory (MB) | allocated: 8886.5654296875 | max allocated: 11093.923828125 | reserved: 11886.0 | max reserved: 11886.0
stage5 GPU utialization:135.4238748550415 %
[Rank 16] (after 1 iterations) memory (MB) | allocated: 8886.5654296875 | max allocated: 11093.923828125 | reserved: 11830.0 | max reserved: 11830.0
[Rank 19] (after 1 iterations) memory (MB) | allocated: 8886.5654296875 | max allocated: 11093.923828125 | reserved: 11900.0 | max reserved: 11900.0
times across ranks (ms):
  forward-backward:
     rank  0: 29014.54
     rank  1: 29014.30
     rank  2: 29014.34
     rank  3: 29014.39
     rank  4: 29015.56
     rank  5: 29015.33
     rank  6: 29015.30
     rank  7: 29015.35
     rank  8: 29015.18
     rank  9: 29015.25
     rank 10: 29015.25
     rank 11: 29015.10
     rank 12: 29014.80
     rank 13: 29014.72
     rank 14: 29014.82
     rank 15: 29014.82
     rank 16: 29014.97
     rank 17: 29014.79
     rank 18: 29014.87
     rank 19: 29014.87
  forward-compute:
     rank  0: 5065.48
     rank  1: 5070.18
     rank  2: 5078.94
     rank  3: 5082.44
     rank  4: 5935.61
     rank  5: 5933.62
     rank  6: 5932.36
     rank  7: 5937.21
     rank  8: 4705.19
     rank  9: 4724.52
     rank 10: 4721.33
     rank 11: 4717.07
     rank 12: 9609.30
     rank 13: 9602.62
     rank 14: 9607.58
     rank 15: 9599.37
     rank 16: 10571.70
     rank 17: 10588.47
     rank 18: 10588.33
     rank 19: 10574.81
  backward-compute:
     rank  0: 125.16
     rank  1: 130.24
     rank  2: 141.84
     rank  3: 135.40
     rank  4: 5104.84
     rank  5: 5114.33
     rank  6: 5112.54
     rank  7: 5116.04
     rank  8: 4296.85
     rank  9: 4294.43
     rank 10: 4305.84
     rank 11: 4293.75
     rank 12: 4249.34
     rank 13: 4260.29
     rank 14: 4267.74
     rank 15: 4249.15
     rank 16: 4560.25
     rank 17: 4555.85
     rank 18: 4546.40
     rank 19: 4543.57
  pure-backward-compute:
     rank  0: 123.67
     rank  1: 128.83
     rank  2: 140.22
     rank  3: 133.51
     rank  4: 5101.29
     rank  5: 5111.38
     rank  6: 5109.67
     rank  7: 5113.47
     rank  8: 4293.80
     rank  9: 4291.73
     rank 10: 4303.34
     rank 11: 4290.20
     rank 12: 4245.83
     rank 13: 4258.20
     rank 14: 4265.95
     rank 15: 4245.79
     rank 16: 4556.08
     rank 17: 4552.86
     rank 18: 4541.11
     rank 19: 4538.07
  batch-generator:
     rank  0: 1185.91
     rank  1: 1194.95
     rank  2: 1207.54
     rank  3: 1209.45
     rank  4: 1320.95
     rank  5: 1342.84
     rank  6: 1357.97
     rank  7: 1361.81
     rank  8: 1411.53
     rank  9: 1426.81
     rank 10: 1428.71
     rank 11: 1440.24
     rank 12: 1641.47
     rank 13: 1638.13
     rank 14: 1645.35
     rank 15: 1644.56
     rank 16: 1532.71
     rank 17: 1545.73
     rank 18: 1547.32
     rank 19: 1535.01
  forward-recv:
     rank  4: 2380.01
     rank  5: 2378.16
     rank  6: 2383.18
     rank  7: 2379.74
     rank  8: 3909.25
     rank  9: 3904.00
     rank 10: 3910.66
     rank 11: 3911.05
     rank 12: 5431.32
     rank 13: 5431.54
     rank 14: 5427.73
     rank 15: 5428.51
     rank 16: 11573.97
     rank 17: 11574.23
     rank 18: 11580.80
     rank 19: 11580.96
  forward-send:
     rank  0: 9090.58
     rank  1: 9082.02
     rank  2: 9094.31
     rank  3: 9093.02
     rank  4: 7416.45
     rank  5: 7411.87
     rank  6: 7419.74
     rank  7: 7421.68
     rank  8: 6063.05
     rank  9: 6062.78
     rank 10: 6062.99
     rank 11: 6064.66
     rank 12: 24.12
     rank 13: 24.63
     rank 14: 31.03
     rank 15: 31.32
  backward-recv:
     rank  0: 1058.07
     rank  1: 1057.79
     rank  2: 1056.99
     rank  3: 1057.46
     rank  4: 288.09
     rank  5: 291.11
     rank  6: 294.64
     rank  7: 291.80
     rank  8: 243.62
     rank  9: 242.32
     rank 10: 242.50
     rank 11: 243.01
     rank 12: 125.65
     rank 13: 126.07
     rank 14: 126.20
     rank 15: 125.77
  backward-send:
     rank  4: 10.19
     rank  5: 9.87
     rank  6: 6.51
     rank  7: 9.49
     rank  8: 14.57
     rank  9: 15.64
     rank 10: 15.47
     rank 11: 15.44
     rank 12: 10.37
     rank 13: 9.84
     rank 14: 10.00
     rank 15: 10.36
     rank 16: 5.08
     rank 17: 4.91
     rank 18: 5.14
     rank 19: 5.07
  forward-send-backward-recv:
     rank  0: 13558.09
     rank  1: 13559.60
     rank  2: 13526.52
     rank  3: 13531.10
     rank  4: 7593.84
     rank  5: 7590.95
     rank  6: 7583.83
     rank  7: 7577.14
     rank  8: 7406.43
     rank  9: 7409.36
     rank 10: 7401.53
     rank 11: 7411.73
     rank 12: 7208.25
     rank 13: 7203.33
     rank 14: 7198.88
     rank 15: 7210.86
  backward-send-forward-recv:
     rank  4: 149.47
     rank  5: 153.61
     rank  6: 142.18
     rank  7: 150.50
     rank  8: 2086.29
     rank  9: 2076.38
     rank 10: 2069.88
     rank 11: 2068.06
     rank 12: 1923.20
     rank 13: 1930.85
     rank 14: 1923.33
     rank 15: 1929.02
     rank 16: 1740.30
     rank 17: 1730.60
     rank 18: 1725.61
     rank 19: 1741.77
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.04
     rank  7: 0.05
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.06
     rank 11: 0.04
     rank 12: 0.07
     rank 13: 0.06
     rank 14: 0.05
     rank 15: 0.05
     rank 16: 0.03
     rank 17: 0.02
     rank 18: 0.03
     rank 19: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.08
     rank  1: 0.08
     rank  2: 0.07
     rank  3: 0.08
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.04
     rank 10: 0.05
     rank 11: 0.03
     rank 12: 0.06
     rank 13: 0.05
     rank 14: 0.06
     rank 15: 0.06
     rank 16: 0.08
     rank 17: 0.05
     rank 18: 0.06
     rank 19: 0.06
  all-grads-sync:
     rank  0: 53.95
     rank  1: 52.52
     rank  2: 56.86
     rank  3: 54.90
     rank  4: 63.12
     rank  5: 72.61
     rank  6: 72.38
     rank  7: 62.49
     rank  8: 83.16
     rank  9: 81.95
     rank 10: 83.82
     rank 11: 86.12
     rank 12: 94.22
     rank 13: 95.71
     rank 14: 95.17
     rank 15: 99.28
     rank 16: 49.70
     rank 17: 49.75
     rank 18: 50.78
     rank 19: 49.94
  optimizer-copy-to-main-grad:
     rank  0: 0.04
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.04
     rank  4: 0.08
     rank  5: 0.08
     rank  6: 0.07
     rank  7: 0.07
     rank  8: 0.08
     rank  9: 0.07
     rank 10: 0.07
     rank 11: 0.07
     rank 12: 0.09
     rank 13: 0.08
     rank 14: 0.08
     rank 15: 0.11
     rank 16: 0.08
     rank 17: 0.06
     rank 18: 0.07
     rank 19: 0.08
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.03
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 27.34
     rank  1: 27.36
     rank  2: 27.00
     rank  3: 27.00
     rank  4: 81.37
     rank  5: 84.13
     rank  6: 81.98
     rank  7: 81.19
     rank  8: 75.67
     rank  9: 77.48
     rank 10: 75.29
     rank 11: 79.00
     rank 12: 138.84
     rank 13: 138.82
     rank 14: 138.87
     rank 15: 138.86
     rank 16: 142.31
     rank 17: 142.30
     rank 18: 142.38
     rank 19: 142.36
  optimizer:
     rank  0: 28.57
     rank  1: 28.59
     rank  2: 28.23
     rank  3: 28.23
     rank  4: 82.60
     rank  5: 85.35
     rank  6: 83.21
     rank  7: 82.41
     rank  8: 76.90
     rank  9: 78.70
     rank 10: 76.52
     rank 11: 80.23
     rank 12: 140.06
     rank 13: 140.05
     rank 14: 140.10
     rank 15: 140.09
     rank 16: 143.54
     rank 17: 143.53
     rank 18: 143.60
     rank 19: 143.59
 [2025-01-02 18:18:41] iteration        2/      10 | consumed samples:           64 | elapsed time per iteration (ms): 10953.5 | learning rate: 1.500000E-06 | global batch size:    32 | lm loss: 6.991076E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 10844.12
     rank  1: 10844.25
     rank  2: 10844.19
     rank  3: 10844.16
     rank  4: 10849.23
     rank  5: 10849.24
     rank  6: 10849.20
     rank  7: 10849.20
     rank  8: 10848.98
     rank  9: 10848.79
     rank 10: 10848.79
     rank 11: 10848.76
     rank 12: 10848.88
     rank 13: 10848.91
     rank 14: 10848.90
     rank 15: 10848.88
     rank 16: 10849.17
     rank 17: 10849.56
     rank 18: 10849.23
     rank 19: 10849.23
  forward-compute:
     rank  0: 2850.04
     rank  1: 2840.69
     rank  2: 2862.55
     rank  3: 2863.99
     rank  4: 4628.40
     rank  5: 4623.11
     rank  6: 4644.35
     rank  7: 4631.76
     rank  8: 3283.48
     rank  9: 3294.31
     rank 10: 3294.84
     rank 11: 3301.58
     rank 12: 3576.61
     rank 13: 3579.93
     rank 14: 3584.24
     rank 15: 3574.96
     rank 16: 3760.94
     rank 17: 3772.99
     rank 18: 3776.48
     rank 19: 3762.16
  backward-compute:
     rank  0: 119.77
     rank  1: 129.24
     rank  2: 143.32
     rank  3: 128.52
     rank  4: 5078.24
     rank  5: 5080.79
     rank  6: 5072.57
     rank  7: 5095.78
     rank  8: 4291.95
     rank  9: 4305.81
     rank 10: 4313.85
     rank 11: 4299.62
     rank 12: 4237.62
     rank 13: 4247.26
     rank 14: 4255.73
     rank 15: 4236.79
     rank 16: 4467.66
     rank 17: 4468.90
     rank 18: 4461.75
     rank 19: 4460.13
  pure-backward-compute:
     rank  0: 118.49
     rank  1: 127.84
     rank  2: 141.80
     rank  3: 126.87
     rank  4: 5075.29
     rank  5: 5078.31
     rank  6: 5069.87
     rank  7: 5093.45
     rank  8: 4289.09
     rank  9: 4303.45
     rank 10: 4311.57
     rank 11: 4296.24
     rank 12: 4234.51
     rank 13: 4245.69
     rank 14: 4254.05
     rank 15: 4234.21
     rank 16: 4463.98
     rank 17: 4466.14
     rank 18: 4456.69
     rank 19: 4454.90
  batch-generator:
     rank  0: 101.82
     rank  1: 101.79
     rank  2: 127.90
     rank  3: 130.36
     rank  4: 112.41
     rank  5: 121.03
     rank  6: 158.48
     rank  7: 143.45
     rank  8: 124.35
     rank  9: 130.36
     rank 10: 136.98
     rank 11: 153.89
     rank 12: 92.33
     rank 13: 96.58
     rank 14: 103.90
     rank 15: 101.52
     rank 16: 90.89
     rank 17: 103.21
     rank 18: 113.13
     rank 19: 100.43
  forward-recv:
     rank  4: 100.72
     rank  5: 100.67
     rank  6: 99.32
     rank  7: 98.79
     rank  8: 329.63
     rank  9: 328.87
     rank 10: 328.12
     rank 11: 327.89
     rank 12: 387.94
     rank 13: 388.47
     rank 14: 388.47
     rank 15: 387.88
     rank 16: 470.75
     rank 17: 470.53
     rank 18: 470.73
     rank 19: 470.77
  forward-send:
     rank  0: 183.68
     rank  1: 182.04
     rank  2: 179.18
     rank  3: 179.15
     rank  4: 15.60
     rank  5: 15.25
     rank  6: 14.82
     rank  7: 14.48
     rank  8: 12.12
     rank  9: 11.89
     rank 10: 12.09
     rank 11: 11.98
     rank 12: 5.17
     rank 13: 4.76
     rank 14: 4.79
     rank 15: 5.10
  backward-recv:
     rank  0: 1066.69
     rank  1: 1065.70
     rank  2: 1064.92
     rank  3: 1065.14
     rank  4: 287.49
     rank  5: 290.23
     rank  6: 293.84
     rank  7: 291.07
     rank  8: 239.50
     rank  9: 236.55
     rank 10: 236.93
     rank 11: 237.72
     rank 12: 123.20
     rank 13: 125.07
     rank 14: 125.01
     rank 15: 124.38
  backward-send:
     rank  4: 10.40
     rank  5: 9.70
     rank  6: 6.69
     rank  7: 9.02
     rank  8: 14.93
     rank  9: 15.63
     rank 10: 15.53
     rank 11: 15.31
     rank 12: 11.52
     rank 13: 9.71
     rank 14: 9.84
     rank 15: 10.44
     rank 16: 4.93
     rank 17: 4.95
     rank 18: 5.19
     rank 19: 5.01
  forward-send-backward-recv:
     rank  0: 6612.90
     rank  1: 6612.86
     rank  2: 6577.13
     rank  3: 6595.10
     rank  4: 551.42
     rank  5: 548.25
     rank  6: 545.64
     rank  7: 531.54
     rank  8: 409.02
     rank  9: 402.98
     rank 10: 397.66
     rank 11: 407.09
     rank 12: 292.59
     rank 13: 289.52
     rank 14: 284.72
     rank 15: 295.98
  backward-send-forward-recv:
     rank  4: 141.61
     rank  5: 147.93
     rank  6: 128.69
     rank  7: 143.40
     rank  8: 2073.64
     rank  9: 2064.79
     rank 10: 2062.13
     rank 11: 2053.78
     rank 12: 1877.63
     rank 13: 1875.99
     rank 14: 1867.77
     rank 15: 1876.95
     rank 16: 1675.21
     rank 17: 1664.72
     rank 18: 1659.67
     rank 19: 1675.59
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.05
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.05
     rank  2: 0.06
     rank  3: 0.06
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.04
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.05
     rank 17: 0.11
     rank 18: 0.05
     rank 19: 0.06
  all-grads-sync:
     rank  0: 0.39
     rank  1: 0.46
     rank  2: 0.46
     rank  3: 0.42
     rank  4: 2.99
     rank  5: 2.78
     rank  6: 2.83
     rank  7: 2.79
     rank  8: 2.74
     rank  9: 2.54
     rank 10: 2.55
     rank 11: 2.91
     rank 12: 2.70
     rank 13: 2.70
     rank 14: 2.70
     rank 15: 2.71
     rank 16: 2.98
     rank 17: 3.25
     rank 18: 2.99
     rank 19: 3.01
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.06
     rank  5: 0.06
     rank  6: 0.06
     rank  7: 0.05
     rank  8: 0.08
     rank  9: 0.06
     rank 10: 0.05
     rank 11: 0.07
     rank 12: 0.06
     rank 13: 0.04
     rank 14: 0.05
     rank 15: 0.06
     rank 16: 0.13
     rank 17: 0.10
     rank 18: 0.07
     rank 19: 0.07
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.03
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.03
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 3.70
     rank  1: 3.78
     rank  2: 3.75
     rank  3: 3.71
     rank  4: 56.48
     rank  5: 57.45
     rank  6: 57.10
     rank  7: 56.66
     rank  8: 52.05
     rank  9: 51.96
     rank 10: 52.14
     rank 11: 52.35
     rank 12: 53.75
     rank 13: 53.74
     rank 14: 53.83
     rank 15: 53.79
     rank 16: 57.15
     rank 17: 57.30
     rank 18: 57.11
     rank 19: 57.08
  optimizer:
     rank  0: 4.60
     rank  1: 4.68
     rank  2: 4.65
     rank  3: 4.61
     rank  4: 57.37
     rank  5: 58.35
     rank  6: 58.00
     rank  7: 57.56
     rank  8: 52.94
     rank  9: 52.86
     rank 10: 53.03
     rank 11: 53.24
     rank 12: 54.64
     rank 13: 54.63
     rank 14: 54.79
     rank 15: 54.68
     rank 16: 58.04
     rank 17: 58.22
     rank 18: 58.01
     rank 19: 57.98
 [2025-01-02 18:18:52] iteration        3/      10 | consumed samples:           96 | elapsed time per iteration (ms): 10972.7 | learning rate: 2.250000E-06 | global batch size:    32 | lm loss: 3.794223E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 10877.30
     rank  1: 10877.27
     rank  2: 10877.27
     rank  3: 10877.30
     rank  4: 10882.36
     rank  5: 10882.34
     rank  6: 10882.33
     rank  7: 10882.32
     rank  8: 10881.92
     rank  9: 10881.87
     rank 10: 10881.93
     rank 11: 10881.88
     rank 12: 10882.05
     rank 13: 10882.00
     rank 14: 10882.03
     rank 15: 10882.01
     rank 16: 10882.31
     rank 17: 10882.31
     rank 18: 10882.33
     rank 19: 10882.33
  forward-compute:
     rank  0: 2860.68
     rank  1: 2853.94
     rank  2: 2868.27
     rank  3: 2877.66
     rank  4: 4655.35
     rank  5: 4651.77
     rank  6: 4667.17
     rank  7: 4664.68
     rank  8: 3280.00
     rank  9: 3291.24
     rank 10: 3294.95
     rank 11: 3300.56
     rank 12: 3580.95
     rank 13: 3581.73
     rank 14: 3583.58
     rank 15: 3576.02
     rank 16: 3739.27
     rank 17: 3750.70
     rank 18: 3754.84
     rank 19: 3739.51
  backward-compute:
     rank  0: 120.28
     rank  1: 128.64
     rank  2: 142.06
     rank  3: 127.68
     rank  4: 5095.25
     rank  5: 5102.00
     rank  6: 5094.56
     rank  7: 5114.13
     rank  8: 4325.62
     rank  9: 4333.72
     rank 10: 4342.39
     rank 11: 4325.87
     rank 12: 4238.73
     rank 13: 4248.73
     rank 14: 4257.00
     rank 15: 4237.31
     rank 16: 4454.37
     rank 17: 4452.57
     rank 18: 4448.81
     rank 19: 4447.29
  pure-backward-compute:
     rank  0: 118.99
     rank  1: 127.26
     rank  2: 140.48
     rank  3: 126.03
     rank  4: 5092.53
     rank  5: 5099.57
     rank  6: 5091.83
     rank  7: 5111.69
     rank  8: 4322.71
     rank  9: 4331.41
     rank 10: 4340.06
     rank 11: 4322.88
     rank 12: 4236.00
     rank 13: 4247.24
     rank 14: 4255.54
     rank 15: 4234.88
     rank 16: 4451.16
     rank 17: 4449.33
     rank 18: 4443.94
     rank 19: 4442.22
  batch-generator:
     rank  0: 98.26
     rank  1: 101.01
     rank  2: 121.03
     rank  3: 130.25
     rank  4: 110.88
     rank  5: 118.56
     rank  6: 151.67
     rank  7: 150.54
     rank  8: 117.03
     rank  9: 122.98
     rank 10: 130.81
     rank 11: 147.02
     rank 12: 93.23
     rank 13: 94.76
     rank 14: 100.75
     rank 15: 98.87
     rank 16: 86.07
     rank 17: 99.19
     rank 18: 108.51
     rank 19: 94.01
  forward-recv:
     rank  4: 101.03
     rank  5: 101.23
     rank  6: 99.89
     rank  7: 96.64
     rank  8: 335.59
     rank  9: 335.03
     rank 10: 333.98
     rank 11: 333.07
     rank 12: 391.15
     rank 13: 391.61
     rank 14: 392.26
     rank 15: 391.60
     rank 16: 469.36
     rank 17: 469.42
     rank 18: 468.87
     rank 19: 469.33
  forward-send:
     rank  0: 188.26
     rank  1: 187.33
     rank  2: 185.48
     rank  3: 181.79
     rank  4: 15.53
     rank  5: 15.28
     rank  6: 15.06
     rank  7: 13.94
     rank  8: 12.33
     rank  9: 12.33
     rank 10: 12.56
     rank 11: 12.77
     rank 12: 5.08
     rank 13: 4.83
     rank 14: 4.53
     rank 15: 5.09
  backward-recv:
     rank  0: 1067.81
     rank  1: 1066.95
     rank  2: 1066.79
     rank  3: 1067.82
     rank  4: 285.46
     rank  5: 285.97
     rank  6: 290.33
     rank  7: 287.42
     rank  8: 235.73
     rank  9: 236.23
     rank 10: 235.44
     rank 11: 235.11
     rank 12: 123.69
     rank 13: 124.43
     rank 14: 124.33
     rank 15: 123.50
  backward-send:
     rank  4: 10.56
     rank  5: 10.12
     rank  6: 6.92
     rank  7: 9.68
     rank  8: 15.38
     rank  9: 15.01
     rank 10: 15.49
     rank 11: 15.49
     rank 12: 10.40
     rank 13: 9.88
     rank 14: 10.03
     rank 15: 10.24
     rank 16: 5.04
     rank 17: 5.07
     rank 18: 5.11
     rank 19: 4.84
  forward-send-backward-recv:
     rank  0: 6630.02
     rank  1: 6627.52
     rank  2: 6598.44
     rank  3: 6611.46
     rank  4: 541.53
     rank  5: 536.74
     rank  6: 533.52
     rank  7: 520.92
     rank  8: 417.31
     rank  9: 411.80
     rank 10: 404.73
     rank 11: 417.91
     rank 12: 285.88
     rank 13: 283.94
     rank 14: 279.37
     rank 15: 291.10
  backward-send-forward-recv:
     rank  4: 142.72
     rank  5: 145.91
     rank  6: 131.74
     rank  7: 141.82
     rank  8: 2067.65
     rank  9: 2060.17
     rank 10: 2055.66
     rank 11: 2048.31
     rank 12: 1909.69
     rank 13: 1910.05
     rank 14: 1903.74
     rank 15: 1911.47
     rank 16: 1747.23
     rank 17: 1736.60
     rank 18: 1731.21
     rank 19: 1747.65
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.06
     rank  2: 0.06
     rank  3: 0.06
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.02
     rank 16: 0.05
     rank 17: 0.05
     rank 18: 0.05
     rank 19: 0.05
  all-grads-sync:
     rank  0: 0.41
     rank  1: 0.41
     rank  2: 0.44
     rank  3: 0.45
     rank  4: 2.73
     rank  5: 2.78
     rank  6: 2.79
     rank  7: 2.76
     rank  8: 2.55
     rank  9: 2.47
     rank 10: 2.49
     rank 11: 2.49
     rank 12: 2.71
     rank 13: 2.64
     rank 14: 2.65
     rank 15: 2.67
     rank 16: 3.05
     rank 17: 2.87
     rank 18: 2.93
     rank 19: 2.91
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.05
     rank  5: 0.06
     rank  6: 0.07
     rank  7: 0.06
     rank  8: 0.06
     rank  9: 0.05
     rank 10: 0.06
     rank 11: 0.04
     rank 12: 0.06
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.05
     rank 16: 0.07
     rank 17: 0.06
     rank 18: 0.07
     rank 19: 0.07
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.07
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.04
     rank 17: 0.01
     rank 18: 0.02
     rank 19: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 3.77
     rank  1: 3.72
     rank  2: 3.80
     rank  3: 3.77
     rank  4: 56.19
     rank  5: 57.36
     rank  6: 57.01
     rank  7: 56.50
     rank  8: 51.95
     rank  9: 51.71
     rank 10: 52.06
     rank 11: 51.85
     rank 12: 53.74
     rank 13: 53.68
     rank 14: 53.73
     rank 15: 53.76
     rank 16: 57.29
     rank 17: 57.03
     rank 18: 57.09
     rank 19: 57.05
  optimizer:
     rank  0: 4.46
     rank  1: 4.42
     rank  2: 4.49
     rank  3: 4.47
     rank  4: 56.88
     rank  5: 58.06
     rank  6: 57.71
     rank  7: 57.19
     rank  8: 52.64
     rank  9: 52.41
     rank 10: 52.75
     rank 11: 52.54
     rank 12: 54.44
     rank 13: 54.37
     rank 14: 54.42
     rank 15: 54.45
     rank 16: 57.98
     rank 17: 57.72
     rank 18: 57.79
     rank 19: 57.74
 [2025-01-02 18:19:03] iteration        4/      10 | consumed samples:          128 | elapsed time per iteration (ms): 11063.7 | learning rate: 3.000000E-06 | global batch size:    32 | lm loss: 3.507803E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 10969.17
     rank  1: 10969.28
     rank  2: 10969.23
     rank  3: 10969.18
     rank  4: 10974.76
     rank  5: 10974.30
     rank  6: 10974.30
     rank  7: 10974.19
     rank  8: 10973.91
     rank  9: 10973.87
     rank 10: 10973.79
     rank 11: 10973.78
     rank 12: 10974.04
     rank 13: 10973.97
     rank 14: 10973.91
     rank 15: 10973.89
     rank 16: 10974.22
     rank 17: 10974.21
     rank 18: 10974.27
     rank 19: 10974.26
  forward-compute:
     rank  0: 2873.29
     rank  1: 2870.23
     rank  2: 2893.95
     rank  3: 2896.40
     rank  4: 4718.99
     rank  5: 4721.28
     rank  6: 4744.65
     rank  7: 4729.34
     rank  8: 3306.14
     rank  9: 3318.87
     rank 10: 3325.24
     rank 11: 3329.44
     rank 12: 3575.45
     rank 13: 3576.59
     rank 14: 3574.14
     rank 15: 3568.09
     rank 16: 3745.18
     rank 17: 3755.12
     rank 18: 3761.15
     rank 19: 3745.56
  backward-compute:
     rank  0: 120.65
     rank  1: 133.83
     rank  2: 146.67
     rank  3: 128.62
     rank  4: 5122.50
     rank  5: 5125.82
     rank  6: 5124.69
     rank  7: 5140.52
     rank  8: 4368.30
     rank  9: 4374.74
     rank 10: 4381.14
     rank 11: 4369.69
     rank 12: 4230.99
     rank 13: 4239.11
     rank 14: 4249.95
     rank 15: 4230.48
     rank 16: 4450.71
     rank 17: 4452.92
     rank 18: 4443.61
     rank 19: 4442.83
  pure-backward-compute:
     rank  0: 119.38
     rank  1: 132.37
     rank  2: 145.14
     rank  3: 126.87
     rank  4: 5117.99
     rank  5: 5123.49
     rank  6: 5122.30
     rank  7: 5138.09
     rank  8: 4365.09
     rank  9: 4372.26
     rank 10: 4378.76
     rank 11: 4366.63
     rank 12: 4228.60
     rank 13: 4237.71
     rank 14: 4248.46
     rank 15: 4227.94
     rank 16: 4447.63
     rank 17: 4449.91
     rank 18: 4438.80
     rank 19: 4437.52
  batch-generator:
     rank  0: 100.78
     rank  1: 106.54
     rank  2: 135.56
     rank  3: 137.80
     rank  4: 190.22
     rank  5: 183.49
     rank  6: 224.52
     rank  7: 206.70
     rank  8: 120.88
     rank  9: 127.64
     rank 10: 137.08
     rank 11: 151.14
     rank 12: 92.40
     rank 13: 93.05
     rank 14: 96.08
     rank 15: 95.10
     rank 16: 84.72
     rank 17: 96.00
     rank 18: 107.82
     rank 19: 93.17
  forward-recv:
     rank  4: 101.99
     rank  5: 102.24
     rank  6: 101.07
     rank  7: 96.92
     rank  8: 336.71
     rank  9: 334.76
     rank 10: 334.21
     rank 11: 332.53
     rank 12: 394.17
     rank 13: 395.61
     rank 14: 395.61
     rank 15: 395.26
     rank 16: 473.77
     rank 17: 473.72
     rank 18: 473.48
     rank 19: 473.75
  forward-send:
     rank  0: 191.62
     rank  1: 190.24
     rank  2: 189.12
     rank  3: 183.66
     rank  4: 15.23
     rank  5: 15.06
     rank  6: 15.14
     rank  7: 13.36
     rank  8: 12.16
     rank  9: 13.33
     rank 10: 12.96
     rank 11: 13.41
     rank 12: 5.14
     rank 13: 4.84
     rank 14: 4.67
     rank 15: 5.10
  backward-recv:
     rank  0: 1067.03
     rank  1: 1066.15
     rank  2: 1064.93
     rank  3: 1066.71
     rank  4: 282.79
     rank  5: 284.97
     rank  6: 289.77
     rank  7: 285.63
     rank  8: 231.95
     rank  9: 232.73
     rank 10: 232.17
     rank 11: 231.72
     rank 12: 123.75
     rank 13: 124.29
     rank 14: 124.35
     rank 15: 123.43
  backward-send:
     rank  4: 10.73
     rank  5: 9.85
     rank  6: 6.53
     rank  7: 9.65
     rank  8: 15.35
     rank  9: 14.97
     rank 10: 15.58
     rank 11: 15.80
     rank 12: 10.35
     rank 13: 9.90
     rank 14: 10.01
     rank 15: 10.44
     rank 16: 4.90
     rank 17: 5.08
     rank 18: 5.18
     rank 19: 4.89
  forward-send-backward-recv:
     rank  0: 6705.93
     rank  1: 6694.76
     rank  2: 6657.65
     rank  3: 6682.19
     rank  4: 537.77
     rank  5: 534.11
     rank  6: 524.36
     rank  7: 519.62
     rank  8: 405.74
     rank  9: 399.97
     rank 10: 397.53
     rank 11: 408.52
     rank 12: 281.88
     rank 13: 280.39
     rank 14: 274.22
     rank 15: 286.46
  backward-send-forward-recv:
     rank  4: 144.25
     rank  5: 147.53
     rank  6: 124.31
     rank  7: 145.37
     rank  8: 2101.69
     rank  9: 2096.10
     rank 10: 2086.35
     rank 11: 2078.90
     rank 12: 2015.30
     rank 13: 2014.73
     rank 14: 2012.36
     rank 15: 2018.09
     rank 16: 1831.65
     rank 17: 1820.23
     rank 18: 1814.99
     rank 19: 1831.51
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.06
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.06
     rank  2: 0.06
     rank  3: 0.05
     rank  4: 0.07
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.05
     rank 17: 0.05
     rank 18: 0.05
     rank 19: 0.05
  all-grads-sync:
     rank  0: 0.39
     rank  1: 0.46
     rank  2: 0.45
     rank  3: 0.42
     rank  4: 3.04
     rank  5: 2.80
     rank  6: 2.81
     rank  7: 2.72
     rank  8: 2.57
     rank  9: 2.55
     rank 10: 2.58
     rank 11: 2.63
     rank 12: 2.65
     rank 13: 2.66
     rank 14: 2.65
     rank 15: 2.73
     rank 16: 2.83
     rank 17: 2.85
     rank 18: 2.88
     rank 19: 2.91
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.05
     rank  5: 0.06
     rank  6: 0.06
     rank  7: 0.05
     rank  8: 0.06
     rank  9: 0.06
     rank 10: 0.06
     rank 11: 0.06
     rank 12: 0.05
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.06
     rank 16: 0.05
     rank 17: 0.06
     rank 18: 0.06
     rank 19: 0.07
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 3.70
     rank  1: 3.80
     rank  2: 3.75
     rank  3: 3.76
     rank  4: 56.24
     rank  5: 57.24
     rank  6: 57.09
     rank  7: 56.40
     rank  8: 52.04
     rank  9: 52.06
     rank 10: 52.20
     rank 11: 52.16
     rank 12: 53.71
     rank 13: 53.59
     rank 14: 53.65
     rank 15: 53.76
     rank 16: 57.01
     rank 17: 57.01
     rank 18: 56.97
     rank 19: 57.01
  optimizer:
     rank  0: 4.38
     rank  1: 4.48
     rank  2: 4.43
     rank  3: 4.45
     rank  4: 56.93
     rank  5: 57.94
     rank  6: 57.78
     rank  7: 57.09
     rank  8: 52.72
     rank  9: 52.74
     rank 10: 52.88
     rank 11: 52.85
     rank 12: 54.39
     rank 13: 54.27
     rank 14: 54.34
     rank 15: 54.43
     rank 16: 57.69
     rank 17: 57.70
     rank 18: 57.65
     rank 19: 57.69
 [2025-01-02 18:19:14] iteration        5/      10 | consumed samples:          160 | elapsed time per iteration (ms): 11062.0 | learning rate: 3.750000E-06 | global batch size:    32 | lm loss: 2.499635E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 10969.12
     rank  1: 10969.23
     rank  2: 10969.18
     rank  3: 10969.14
     rank  4: 10974.14
     rank  5: 10974.19
     rank  6: 10974.16
     rank  7: 10974.12
     rank  8: 10973.73
     rank  9: 10973.74
     rank 10: 10973.70
     rank 11: 10973.72
     rank 12: 10973.88
     rank 13: 10973.89
     rank 14: 10973.84
     rank 15: 10973.85
     rank 16: 10974.14
     rank 17: 10974.13
     rank 18: 10974.19
     rank 19: 10974.18
  forward-compute:
     rank  0: 2859.87
     rank  1: 2852.33
     rank  2: 2874.21
     rank  3: 2873.34
     rank  4: 4697.35
     rank  5: 4694.92
     rank  6: 4723.24
     rank  7: 4702.01
     rank  8: 3315.92
     rank  9: 3324.16
     rank 10: 3334.10
     rank 11: 3334.61
     rank 12: 3565.84
     rank 13: 3572.97
     rank 14: 3565.55
     rank 15: 3559.45
     rank 16: 3755.73
     rank 17: 3765.92
     rank 18: 3771.67
     rank 19: 3757.29
  backward-compute:
     rank  0: 119.93
     rank  1: 131.05
     rank  2: 146.60
     rank  3: 127.67
     rank  4: 5145.97
     rank  5: 5149.73
     rank  6: 5153.13
     rank  7: 5159.38
     rank  8: 4414.12
     rank  9: 4425.94
     rank 10: 4424.62
     rank 11: 4413.61
     rank 12: 4225.93
     rank 13: 4232.57
     rank 14: 4244.62
     rank 15: 4224.26
     rank 16: 4458.38
     rank 17: 4459.08
     rank 18: 4453.77
     rank 19: 4452.64
  pure-backward-compute:
     rank  0: 118.67
     rank  1: 129.63
     rank  2: 145.01
     rank  3: 126.05
     rank  4: 5142.52
     rank  5: 5147.48
     rank  6: 5151.07
     rank  7: 5156.91
     rank  8: 4410.66
     rank  9: 4423.84
     rank 10: 4422.25
     rank 11: 4410.25
     rank 12: 4223.36
     rank 13: 4231.12
     rank 14: 4243.06
     rank 15: 4221.97
     rank 16: 4455.09
     rank 17: 4456.18
     rank 18: 4449.00
     rank 19: 4447.66
  batch-generator:
     rank  0: 99.79
     rank  1: 101.93
     rank  2: 129.65
     rank  3: 128.52
     rank  4: 153.42
     rank  5: 148.77
     rank  6: 192.81
     rank  7: 173.09
     rank  8: 114.39
     rank  9: 121.14
     rank 10: 132.19
     rank 11: 140.09
     rank 12: 88.18
     rank 13: 95.70
     rank 14: 92.58
     rank 15: 93.08
     rank 16: 92.84
     rank 17: 102.62
     rank 18: 113.60
     rank 19: 99.88
  forward-recv:
     rank  4: 100.22
     rank  5: 100.36
     rank  6: 99.03
     rank  7: 95.99
     rank  8: 334.04
     rank  9: 333.23
     rank 10: 332.85
     rank 11: 332.66
     rank 12: 393.65
     rank 13: 394.30
     rank 14: 394.37
     rank 15: 393.47
     rank 16: 470.49
     rank 17: 470.36
     rank 18: 470.24
     rank 19: 470.43
  forward-send:
     rank  0: 188.17
     rank  1: 187.26
     rank  2: 185.50
     rank  3: 181.58
     rank  4: 15.58
     rank  5: 15.40
     rank  6: 15.22
     rank  7: 14.07
     rank  8: 12.20
     rank  9: 12.30
     rank 10: 12.24
     rank 11: 11.84
     rank 12: 5.16
     rank 13: 4.85
     rank 14: 4.72
     rank 15: 5.07
  backward-recv:
     rank  0: 1069.76
     rank  1: 1069.31
     rank  2: 1068.78
     rank  3: 1068.98
     rank  4: 287.40
     rank  5: 287.94
     rank  6: 292.70
     rank  7: 289.91
     rank  8: 230.97
     rank  9: 231.14
     rank 10: 230.66
     rank 11: 230.39
     rank 12: 123.83
     rank 13: 125.23
     rank 14: 124.76
     rank 15: 124.26
  backward-send:
     rank  4: 10.52
     rank  5: 10.05
     rank  6: 6.65
     rank  7: 9.47
     rank  8: 15.49
     rank  9: 14.86
     rank 10: 15.56
     rank 11: 15.78
     rank 12: 10.29
     rank 13: 9.43
     rank 14: 10.02
     rank 15: 10.26
     rank 16: 4.73
     rank 17: 5.07
     rank 18: 5.19
     rank 19: 4.97
  forward-send-backward-recv:
     rank  0: 6720.43
     rank  1: 6715.90
     rank  2: 6676.42
     rank  3: 6705.93
     rank  4: 535.71
     rank  5: 533.58
     rank  6: 520.30
     rank  7: 523.03
     rank  8: 394.36
     rank  9: 384.60
     rank 10: 388.36
     rank 11: 396.56
     rank 12: 283.24
     rank 13: 281.89
     rank 14: 274.36
     rank 15: 286.09
  backward-send-forward-recv:
     rank  4: 143.99
     rank  5: 149.02
     rank  6: 121.67
     rank  7: 145.96
     rank  8: 2062.40
     rank  9: 2059.45
     rank 10: 2047.12
     rank 11: 2043.79
     rank 12: 2026.50
     rank 13: 2020.37
     rank 14: 2023.70
     rank 15: 2031.50
     rank 16: 1812.70
     rank 17: 1803.54
     rank 18: 1796.06
     rank 19: 1811.80
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.06
     rank  2: 0.06
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.04
     rank 17: 0.04
     rank 18: 0.05
     rank 19: 0.05
  all-grads-sync:
     rank  0: 0.39
     rank  1: 0.47
     rank  2: 0.48
     rank  3: 0.40
     rank  4: 2.72
     rank  5: 2.72
     rank  6: 2.72
     rank  7: 2.76
     rank  8: 2.55
     rank  9: 2.47
     rank 10: 2.48
     rank 11: 2.49
     rank 12: 2.76
     rank 13: 2.70
     rank 14: 2.76
     rank 15: 2.64
     rank 16: 2.81
     rank 17: 2.86
     rank 18: 2.93
     rank 19: 2.88
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.06
     rank  8: 0.06
     rank  9: 0.04
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.07
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.05
     rank 16: 0.06
     rank 17: 0.06
     rank 18: 0.08
     rank 19: 0.07
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.02
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 3.71
     rank  1: 3.81
     rank  2: 3.80
     rank  3: 3.70
     rank  4: 56.08
     rank  5: 57.21
     rank  6: 56.89
     rank  7: 56.49
     rank  8: 51.95
     rank  9: 51.80
     rank 10: 52.09
     rank 11: 51.93
     rank 12: 53.86
     rank 13: 53.71
     rank 14: 53.81
     rank 15: 53.72
     rank 16: 57.01
     rank 17: 57.07
     rank 18: 57.14
     rank 19: 56.98
  optimizer:
     rank  0: 4.37
     rank  1: 4.47
     rank  2: 4.47
     rank  3: 4.37
     rank  4: 56.74
     rank  5: 57.87
     rank  6: 57.55
     rank  7: 57.15
     rank  8: 52.61
     rank  9: 52.46
     rank 10: 52.75
     rank 11: 52.59
     rank 12: 54.53
     rank 13: 54.37
     rank 14: 54.48
     rank 15: 54.37
     rank 16: 57.67
     rank 17: 57.73
     rank 18: 57.80
     rank 19: 57.64
 [2025-01-02 18:19:25] iteration        6/      10 | consumed samples:          192 | elapsed time per iteration (ms): 11089.0 | learning rate: 4.500000E-06 | global batch size:    32 | lm loss: 1.882874E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 10994.43
     rank  1: 10994.42
     rank  2: 10994.54
     rank  3: 10994.40
     rank  4: 10999.68
     rank  5: 10999.42
     rank  6: 10999.47
     rank  7: 10999.41
     rank  8: 10999.07
     rank  9: 10999.00
     rank 10: 10999.06
     rank 11: 10999.00
     rank 12: 10999.23
     rank 13: 10999.13
     rank 14: 10999.16
     rank 15: 10999.11
     rank 16: 10999.44
     rank 17: 10999.42
     rank 18: 10999.47
     rank 19: 10999.46
  forward-compute:
     rank  0: 2894.59
     rank  1: 2890.35
     rank  2: 2912.78
     rank  3: 2909.43
     rank  4: 4711.66
     rank  5: 4713.51
     rank  6: 4747.54
     rank  7: 4713.80
     rank  8: 3329.57
     rank  9: 3338.09
     rank 10: 3347.70
     rank 11: 3348.09
     rank 12: 3575.64
     rank 13: 3584.90
     rank 14: 3575.44
     rank 15: 3567.72
     rank 16: 3748.53
     rank 17: 3759.89
     rank 18: 3763.07
     rank 19: 3749.11
  backward-compute:
     rank  0: 119.13
     rank  1: 133.26
     rank  2: 150.97
     rank  3: 125.48
     rank  4: 5161.02
     rank  5: 5162.76
     rank  6: 5162.73
     rank  7: 5169.44
     rank  8: 4467.71
     rank  9: 4486.11
     rank 10: 4481.27
     rank 11: 4467.59
     rank 12: 4234.10
     rank 13: 4243.41
     rank 14: 4250.83
     rank 15: 4231.64
     rank 16: 4466.74
     rank 17: 4466.44
     rank 18: 4461.86
     rank 19: 4458.81
  pure-backward-compute:
     rank  0: 117.90
     rank  1: 131.80
     rank  2: 149.45
     rank  3: 123.84
     rank  4: 5157.16
     rank  5: 5160.53
     rank  6: 5160.69
     rank  7: 5166.71
     rank  8: 4464.56
     rank  9: 4483.88
     rank 10: 4478.79
     rank 11: 4464.43
     rank 12: 4231.71
     rank 13: 4242.01
     rank 14: 4249.42
     rank 15: 4229.34
     rank 16: 4463.56
     rank 17: 4463.71
     rank 18: 4457.26
     rank 19: 4454.07
  batch-generator:
     rank  0: 98.29
     rank  1: 104.03
     rank  2: 135.02
     rank  3: 129.67
     rank  4: 172.32
     rank  5: 168.10
     rank  6: 217.21
     rank  7: 184.48
     rank  8: 113.31
     rank  9: 121.94
     rank 10: 131.27
     rank 11: 137.64
     rank 12: 95.19
     rank 13: 104.23
     rank 14: 98.46
     rank 15: 97.14
     rank 16: 83.99
     rank 17: 97.19
     rank 18: 105.80
     rank 19: 92.18
  forward-recv:
     rank  4: 101.42
     rank  5: 101.48
     rank  6: 100.13
     rank  7: 99.12
     rank  8: 334.20
     rank  9: 332.89
     rank 10: 331.65
     rank 11: 330.94
     rank 12: 391.25
     rank 13: 392.83
     rank 14: 392.96
     rank 15: 392.55
     rank 16: 468.18
     rank 17: 467.96
     rank 18: 467.91
     rank 19: 468.16
  forward-send:
     rank  0: 191.53
     rank  1: 190.67
     rank  2: 188.90
     rank  3: 185.09
     rank  4: 15.60
     rank  5: 15.42
     rank  6: 15.10
     rank  7: 14.17
     rank  8: 10.58
     rank  9: 11.51
     rank 10: 11.50
     rank 11: 11.78
     rank 12: 5.15
     rank 13: 4.75
     rank 14: 4.69
     rank 15: 5.13
  backward-recv:
     rank  0: 1076.72
     rank  1: 1075.47
     rank  2: 1074.06
     rank  3: 1075.65
     rank  4: 284.55
     rank  5: 287.03
     rank  6: 291.82
     rank  7: 287.91
     rank  8: 232.56
     rank  9: 231.93
     rank 10: 231.65
     rank 11: 231.51
     rank 12: 124.87
     rank 13: 125.84
     rank 14: 125.66
     rank 15: 125.04
  backward-send:
     rank  4: 10.43
     rank  5: 9.78
     rank  6: 6.03
     rank  7: 9.61
     rank  8: 14.68
     rank  9: 15.17
     rank 10: 15.44
     rank 11: 15.67
     rank 12: 10.35
     rank 13: 9.58
     rank 14: 10.02
     rank 15: 10.24
     rank 16: 4.73
     rank 17: 4.89
     rank 18: 5.27
     rank 19: 4.98
  forward-send-backward-recv:
     rank  0: 6702.31
     rank  1: 6691.43
     rank  2: 6651.77
     rank  3: 6687.83
     rank  4: 534.89
     rank  5: 530.76
     rank  6: 520.63
     rank  7: 524.03
     rank  8: 405.20
     rank  9: 389.85
     rank 10: 396.72
     rank 11: 406.50
     rank 12: 281.49
     rank 13: 280.40
     rank 14: 275.82
     rank 15: 288.03
  backward-send-forward-recv:
     rank  4: 142.00
     rank  5: 146.51
     rank  6: 113.47
     rank  7: 147.22
     rank  8: 2008.99
     rank  9: 2004.78
     rank 10: 1993.96
     rank 11: 1991.63
     rank 12: 2035.34
     rank 13: 2026.01
     rank 14: 2032.10
     rank 15: 2039.64
     rank 16: 1840.31
     rank 17: 1830.37
     rank 18: 1825.17
     rank 19: 1841.62
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.04
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.05
     rank  2: 0.08
     rank  3: 0.06
     rank  4: 0.04
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.05
     rank 17: 0.05
     rank 18: 0.05
     rank 19: 0.05
  all-grads-sync:
     rank  0: 0.40
     rank  1: 0.40
     rank  2: 0.52
     rank  3: 0.43
     rank  4: 2.85
     rank  5: 2.74
     rank  6: 2.79
     rank  7: 2.76
     rank  8: 2.54
     rank  9: 2.56
     rank 10: 2.57
     rank 11: 2.58
     rank 12: 2.70
     rank 13: 2.64
     rank 14: 2.66
     rank 15: 2.68
     rank 16: 2.90
     rank 17: 2.83
     rank 18: 2.86
     rank 19: 2.91
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.07
     rank  7: 0.06
     rank  8: 0.06
     rank  9: 0.05
     rank 10: 0.05
     rank 11: 0.06
     rank 12: 0.06
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.05
     rank 16: 0.06
     rank 17: 0.06
     rank 18: 0.06
     rank 19: 0.06
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 3.69
     rank  1: 3.73
     rank  2: 3.88
     rank  3: 3.75
     rank  4: 56.03
     rank  5: 57.29
     rank  6: 56.99
     rank  7: 56.43
     rank  8: 51.91
     rank  9: 51.81
     rank 10: 52.21
     rank 11: 52.06
     rank 12: 53.73
     rank 13: 53.62
     rank 14: 53.70
     rank 15: 53.73
     rank 16: 57.00
     rank 17: 56.95
     rank 18: 56.98
     rank 19: 57.01
  optimizer:
     rank  0: 4.36
     rank  1: 4.41
     rank  2: 4.56
     rank  3: 4.43
     rank  4: 56.70
     rank  5: 57.97
     rank  6: 57.67
     rank  7: 57.10
     rank  8: 52.59
     rank  9: 52.49
     rank 10: 52.88
     rank 11: 52.75
     rank 12: 54.41
     rank 13: 54.29
     rank 14: 54.38
     rank 15: 54.40
     rank 16: 57.67
     rank 17: 57.62
     rank 18: 57.65
     rank 19: 57.69
 [2025-01-02 18:19:36] iteration        7/      10 | consumed samples:          224 | elapsed time per iteration (ms): 11180.2 | learning rate: 5.250000E-06 | global batch size:    32 | lm loss: 1.743500E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 10999.54
     rank  1: 10999.57
     rank  2: 10999.54
     rank  3: 10999.53
     rank  4: 11004.58
     rank  5: 11004.59
     rank  6: 11004.54
     rank  7: 11004.55
     rank  8: 11004.11
     rank  9: 11004.13
     rank 10: 11004.10
     rank 11: 11004.11
     rank 12: 11004.23
     rank 13: 11004.23
     rank 14: 11004.24
     rank 15: 11004.22
     rank 16: 11004.59
     rank 17: 11004.58
     rank 18: 11004.63
     rank 19: 11004.63
  forward-compute:
     rank  0: 2866.82
     rank  1: 2864.67
     rank  2: 2896.92
     rank  3: 2878.42
     rank  4: 4680.17
     rank  5: 4680.97
     rank  6: 4715.37
     rank  7: 4676.87
     rank  8: 3334.48
     rank  9: 3343.64
     rank 10: 3356.94
     rank 11: 3349.46
     rank 12: 3573.14
     rank 13: 3578.13
     rank 14: 3573.96
     rank 15: 3564.93
     rank 16: 3750.29
     rank 17: 3762.03
     rank 18: 3763.94
     rank 19: 3750.79
  backward-compute:
     rank  0: 121.21
     rank  1: 133.10
     rank  2: 148.74
     rank  3: 128.26
     rank  4: 5192.66
     rank  5: 5192.70
     rank  6: 5199.54
     rank  7: 5198.65
     rank  8: 4473.30
     rank  9: 4482.79
     rank 10: 4486.52
     rank 11: 4472.58
     rank 12: 4232.48
     rank 13: 4241.47
     rank 14: 4249.00
     rank 15: 4230.96
     rank 16: 4463.41
     rank 17: 4462.13
     rank 18: 4456.90
     rank 19: 4455.18
  pure-backward-compute:
     rank  0: 119.92
     rank  1: 131.66
     rank  2: 147.24
     rank  3: 126.64
     rank  4: 5189.06
     rank  5: 5190.42
     rank  6: 5197.58
     rank  7: 5196.16
     rank  8: 4470.12
     rank  9: 4480.62
     rank 10: 4484.23
     rank 11: 4469.55
     rank 12: 4230.19
     rank 13: 4240.08
     rank 14: 4247.59
     rank 15: 4228.58
     rank 16: 4460.43
     rank 17: 4459.44
     rank 18: 4452.14
     rank 19: 4450.50
  batch-generator:
     rank  0: 101.66
     rank  1: 107.84
     rank  2: 143.85
     rank  3: 126.23
     rank  4: 130.15
     rank  5: 136.20
     rank  6: 186.88
     rank  7: 148.58
     rank  8: 111.95
     rank  9: 119.52
     rank 10: 134.31
     rank 11: 134.99
     rank 12: 89.05
     rank 13: 94.49
     rank 14: 93.92
     rank 15: 92.08
     rank 16: 81.58
     rank 17: 94.58
     rank 18: 104.26
     rank 19: 91.99
  forward-recv:
     rank  4: 102.22
     rank  5: 102.37
     rank  6: 99.80
     rank  7: 101.75
     rank  8: 330.94
     rank  9: 330.44
     rank 10: 327.97
     rank 11: 328.87
     rank 12: 393.61
     rank 13: 394.08
     rank 14: 395.03
     rank 15: 394.45
     rank 16: 472.34
     rank 17: 472.20
     rank 18: 471.98
     rank 19: 472.32
  forward-send:
     rank  0: 181.96
     rank  1: 179.89
     rank  2: 176.37
     rank  3: 178.97
     rank  4: 15.66
     rank  5: 15.07
     rank  6: 14.16
     rank  7: 14.94
     rank  8: 12.17
     rank  9: 12.06
     rank 10: 12.81
     rank 11: 12.87
     rank 12: 5.11
     rank 13: 4.86
     rank 14: 4.60
     rank 15: 5.12
  backward-recv:
     rank  0: 1074.61
     rank  1: 1073.46
     rank  2: 1072.41
     rank  3: 1074.69
     rank  4: 285.59
     rank  5: 286.53
     rank  6: 288.67
     rank  7: 289.04
     rank  8: 231.25
     rank  9: 230.34
     rank 10: 230.06
     rank 11: 230.14
     rank 12: 124.85
     rank 13: 125.82
     rank 14: 125.51
     rank 15: 125.02
  backward-send:
     rank  4: 10.22
     rank  5: 10.13
     rank  6: 9.53
     rank  7: 9.36
     rank  8: 14.96
     rank  9: 15.32
     rank 10: 15.70
     rank 11: 15.87
     rank 12: 10.33
     rank 13: 9.60
     rank 14: 10.00
     rank 15: 10.48
     rank 16: 4.83
     rank 17: 5.03
     rank 18: 5.14
     rank 19: 5.13
  forward-send-backward-recv:
     rank  0: 6744.27
     rank  1: 6735.06
     rank  2: 6689.88
     rank  3: 6727.78
     rank  4: 538.38
     rank  5: 536.36
     rank  6: 518.47
     rank  7: 528.89
     rank  8: 403.13
     rank  9: 394.76
     rank 10: 395.53
     rank 11: 407.02
     rank 12: 286.22
     rank 13: 284.18
     rank 14: 279.54
     rank 15: 290.88
  backward-send-forward-recv:
     rank  4: 142.05
     rank  5: 148.26
     rank  6: 117.29
     rank  7: 151.02
     rank  8: 2008.35
     rank  9: 2005.69
     rank 10: 1989.52
     rank 11: 1992.52
     rank 12: 2037.67
     rank 13: 2033.73
     rank 14: 2034.03
     rank 15: 2042.65
     rank 16: 1841.45
     rank 17: 1831.50
     rank 18: 1827.03
     rank 19: 1841.75
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.06
     rank  2: 0.05
     rank  3: 0.05
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.05
     rank 17: 0.05
     rank 18: 0.05
     rank 19: 0.06
  all-grads-sync:
     rank  0: 0.44
     rank  1: 0.46
     rank  2: 0.42
     rank  3: 0.42
     rank  4: 2.75
     rank  5: 2.81
     rank  6: 2.80
     rank  7: 2.72
     rank  8: 2.52
     rank  9: 2.56
     rank 10: 2.48
     rank 11: 2.50
     rank 12: 2.65
     rank 13: 2.64
     rank 14: 2.64
     rank 15: 2.72
     rank 16: 2.84
     rank 17: 2.84
     rank 18: 2.92
     rank 19: 2.91
  optimizer-copy-to-main-grad:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.06
     rank  6: 0.06
     rank  7: 0.05
     rank  8: 0.05
     rank  9: 0.06
     rank 10: 0.04
     rank 11: 0.05
     rank 12: 0.05
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.06
     rank 16: 0.05
     rank 17: 0.05
     rank 18: 0.07
     rank 19: 0.07
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 3.76
     rank  1: 3.80
     rank  2: 3.73
     rank  3: 3.70
     rank  4: 56.24
     rank  5: 57.42
     rank  6: 57.03
     rank  7: 144.32
     rank  8: 51.88
     rank  9: 51.89
     rank 10: 52.03
     rank 11: 51.87
     rank 12: 53.63
     rank 13: 53.59
     rank 14: 53.72
     rank 15: 53.75
     rank 16: 56.91
     rank 17: 56.91
     rank 18: 57.07
     rank 19: 57.09
  optimizer:
     rank  0: 4.44
     rank  1: 4.48
     rank  2: 4.41
     rank  3: 4.38
     rank  4: 56.92
     rank  5: 58.10
     rank  6: 57.70
     rank  7: 145.00
     rank  8: 52.56
     rank  9: 52.58
     rank 10: 52.71
     rank 11: 52.56
     rank 12: 54.31
     rank 13: 54.27
     rank 14: 54.40
     rank 15: 54.42
     rank 16: 57.59
     rank 17: 57.59
     rank 18: 57.75
     rank 19: 57.76
 [2025-01-02 18:19:48] iteration        8/      10 | consumed samples:          256 | elapsed time per iteration (ms): 11210.1 | learning rate: 6.000000E-06 | global batch size:    32 | lm loss: 2.484623E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 11027.35
     rank  1: 11027.29
     rank  2: 11027.34
     rank  3: 11027.33
     rank  4: 11032.79
     rank  5: 11032.31
     rank  6: 11032.25
     rank  7: 11032.32
     rank  8: 11031.98
     rank  9: 11031.82
     rank 10: 11031.82
     rank 11: 11031.88
     rank 12: 11032.12
     rank 13: 11031.96
     rank 14: 11031.96
     rank 15: 11032.01
     rank 16: 11032.60
     rank 17: 11032.30
     rank 18: 11032.34
     rank 19: 11032.33
  forward-compute:
     rank  0: 2904.68
     rank  1: 2903.30
     rank  2: 2933.10
     rank  3: 2917.84
     rank  4: 4683.92
     rank  5: 4683.77
     rank  6: 4721.05
     rank  7: 4684.43
     rank  8: 3333.04
     rank  9: 3345.56
     rank 10: 3354.19
     rank 11: 3345.23
     rank 12: 3572.90
     rank 13: 3574.05
     rank 14: 3569.69
     rank 15: 3565.21
     rank 16: 3752.36
     rank 17: 3763.08
     rank 18: 3767.51
     rank 19: 3753.39
  backward-compute:
     rank  0: 121.64
     rank  1: 131.99
     rank  2: 142.60
     rank  3: 128.08
     rank  4: 5204.46
     rank  5: 5205.06
     rank  6: 5210.66
     rank  7: 5205.68
     rank  8: 4476.58
     rank  9: 4482.85
     rank 10: 4485.66
     rank 11: 4475.42
     rank 12: 4233.54
     rank 13: 4242.40
     rank 14: 4251.40
     rank 15: 4232.32
     rank 16: 4461.46
     rank 17: 4460.89
     rank 18: 4455.78
     rank 19: 4454.28
  pure-backward-compute:
     rank  0: 120.35
     rank  1: 130.58
     rank  2: 140.82
     rank  3: 126.54
     rank  4: 5200.57
     rank  5: 5202.95
     rank  6: 5208.62
     rank  7: 5203.03
     rank  8: 4473.42
     rank  9: 4480.71
     rank 10: 4483.26
     rank 11: 4472.19
     rank 12: 4231.36
     rank 13: 4240.91
     rank 14: 4250.02
     rank 15: 4230.09
     rank 16: 4458.20
     rank 17: 4458.10
     rank 18: 4451.34
     rank 19: 4449.68
  batch-generator:
     rank  0: 103.99
     rank  1: 109.65
     rank  2: 144.44
     rank  3: 129.71
     rank  4: 129.31
     rank  5: 132.99
     rank  6: 187.18
     rank  7: 150.53
     rank  8: 112.34
     rank  9: 120.27
     rank 10: 131.17
     rank 11: 131.78
     rank 12: 87.69
     rank 13: 88.61
     rank 14: 88.92
     rank 15: 90.41
     rank 16: 87.53
     rank 17: 98.30
     rank 18: 108.51
     rank 19: 96.24
  forward-recv:
     rank  4: 120.57
     rank  5: 120.68
     rank  6: 119.68
     rank  7: 115.81
     rank  8: 353.58
     rank  9: 352.23
     rank 10: 351.89
     rank 11: 350.90
     rank 12: 412.06
     rank 13: 413.14
     rank 14: 413.42
     rank 15: 412.40
     rank 16: 486.94
     rank 17: 486.80
     rank 18: 486.57
     rank 19: 486.89
  forward-send:
     rank  0: 190.25
     rank  1: 189.62
     rank  2: 188.19
     rank  3: 183.08
     rank  4: 15.46
     rank  5: 15.38
     rank  6: 15.32
     rank  7: 13.40
     rank  8: 11.61
     rank  9: 12.27
     rank 10: 12.14
     rank 11: 11.92
     rank 12: 5.12
     rank 13: 4.89
     rank 14: 4.61
     rank 15: 5.10
  backward-recv:
     rank  0: 1077.79
     rank  1: 1077.05
     rank  2: 1078.30
     rank  3: 1077.04
     rank  4: 285.23
     rank  5: 287.46
     rank  6: 292.14
     rank  7: 288.96
     rank  8: 230.22
     rank  9: 228.73
     rank 10: 229.09
     rank 11: 229.47
     rank 12: 125.03
     rank 13: 125.62
     rank 14: 125.59
     rank 15: 125.07
  backward-send:
     rank  4: 10.30
     rank  5: 10.08
     rank  6: 6.04
     rank  7: 9.31
     rank  8: 14.39
     rank  9: 15.55
     rank 10: 15.40
     rank 11: 15.49
     rank 12: 10.26
     rank 13: 9.63
     rank 14: 10.00
     rank 15: 10.49
     rank 16: 4.86
     rank 17: 4.79
     rank 18: 5.23
     rank 19: 5.08
  forward-send-backward-recv:
     rank  0: 6721.55
     rank  1: 6711.23
     rank  2: 6667.69
     rank  3: 6709.13
     rank  4: 534.33
     rank  5: 530.29
     rank  6: 514.99
     rank  7: 529.72
     rank  8: 389.43
     rank  9: 384.34
     rank 10: 385.49
     rank 11: 393.50
     rank 12: 281.51
     rank 13: 279.99
     rank 14: 274.30
     rank 15: 286.33
  backward-send-forward-recv:
     rank  4: 140.26
     rank  5: 147.66
     rank  6: 111.11
     rank  7: 149.96
     rank  8: 2025.76
     rank  9: 2019.80
     rank 10: 2007.16
     rank 11: 2013.19
     rank 12: 2047.78
     rank 13: 2047.18
     rank 14: 2047.59
     rank 15: 2052.49
     rank 16: 1850.83
     rank 17: 1842.17
     rank 18: 1835.82
     rank 19: 1851.09
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.06
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.03
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.05
     rank  2: 0.07
     rank  3: 0.05
     rank  4: 0.06
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.07
     rank 17: 0.05
     rank 18: 0.05
     rank 19: 0.05
  all-grads-sync:
     rank  0: 0.40
     rank  1: 0.40
     rank  2: 0.49
     rank  3: 0.41
     rank  4: 3.08
     rank  5: 2.80
     rank  6: 2.74
     rank  7: 2.68
     rank  8: 2.48
     rank  9: 2.45
     rank 10: 2.51
     rank 11: 2.54
     rank 12: 2.67
     rank 13: 2.66
     rank 14: 2.64
     rank 15: 2.69
     rank 16: 3.38
     rank 17: 2.85
     rank 18: 2.89
     rank 19: 2.87
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.07
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.05
     rank  9: 0.04
     rank 10: 0.05
     rank 11: 0.06
     rank 12: 0.06
     rank 13: 0.04
     rank 14: 0.05
     rank 15: 0.06
     rank 16: 0.09
     rank 17: 0.06
     rank 18: 0.07
     rank 19: 0.07
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.05
     rank 17: 0.01
     rank 18: 0.02
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.04
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 3.72
     rank  1: 3.71
     rank  2: 3.85
     rank  3: 3.73
     rank  4: 56.02
     rank  5: 57.39
     rank  6: 146.76
     rank  7: 56.27
     rank  8: 51.81
     rank  9: 51.53
     rank 10: 52.08
     rank 11: 51.91
     rank 12: 53.60
     rank 13: 53.66
     rank 14: 53.71
     rank 15: 53.75
     rank 16: 57.39
     rank 17: 57.02
     rank 18: 57.11
     rank 19: 57.01
  optimizer:
     rank  0: 4.80
     rank  1: 4.80
     rank  2: 4.93
     rank  3: 4.81
     rank  4: 57.10
     rank  5: 58.47
     rank  6: 147.84
     rank  7: 57.35
     rank  8: 52.89
     rank  9: 52.61
     rank 10: 53.16
     rank 11: 52.99
     rank 12: 54.68
     rank 13: 54.74
     rank 14: 54.79
     rank 15: 54.83
     rank 16: 58.53
     rank 17: 58.10
     rank 18: 58.19
     rank 19: 58.08
 [2025-01-02 18:19:59] iteration        9/      10 | consumed samples:          288 | elapsed time per iteration (ms): 11134.1 | learning rate: 6.750000E-06 | global batch size:    32 | lm loss: 1.772830E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 11040.13
     rank  1: 11040.09
     rank  2: 11040.16
     rank  3: 11040.05
     rank  4: 11045.34
     rank  5: 11045.11
     rank  6: 11045.07
     rank  7: 11045.06
     rank  8: 11044.77
     rank  9: 11044.69
     rank 10: 11044.65
     rank 11: 11044.63
     rank 12: 11044.90
     rank 13: 11044.79
     rank 14: 11044.76
     rank 15: 11044.76
     rank 16: 11045.14
     rank 17: 11045.11
     rank 18: 11045.12
     rank 19: 11045.11
  forward-compute:
     rank  0: 2847.85
     rank  1: 2845.57
     rank  2: 2873.46
     rank  3: 2861.91
     rank  4: 4721.69
     rank  5: 4722.84
     rank  6: 4747.17
     rank  7: 4724.82
     rank  8: 3359.70
     rank  9: 3371.66
     rank 10: 3379.20
     rank 11: 3382.46
     rank 12: 3589.72
     rank 13: 3594.00
     rank 14: 3586.59
     rank 15: 3580.95
     rank 16: 3759.88
     rank 17: 3771.33
     rank 18: 3776.15
     rank 19: 3760.62
  backward-compute:
     rank  0: 122.21
     rank  1: 134.12
     rank  2: 144.28
     rank  3: 129.40
     rank  4: 5198.73
     rank  5: 5199.72
     rank  6: 5196.42
     rank  7: 5210.85
     rank  8: 4499.46
     rank  9: 4509.49
     rank 10: 4509.78
     rank 11: 4498.46
     rank 12: 4234.62
     rank 13: 4243.49
     rank 14: 4253.94
     rank 15: 4233.07
     rank 16: 4455.87
     rank 17: 4455.38
     rank 18: 4453.34
     rank 19: 4451.57
  pure-backward-compute:
     rank  0: 120.91
     rank  1: 132.64
     rank  2: 142.74
     rank  3: 127.75
     rank  4: 5194.78
     rank  5: 5197.65
     rank  6: 5193.88
     rank  7: 5208.36
     rank  8: 4496.26
     rank  9: 4507.32
     rank 10: 4507.51
     rank 11: 4495.23
     rank 12: 4232.44
     rank 13: 4242.08
     rank 14: 4252.56
     rank 15: 4230.67
     rank 16: 4452.06
     rank 17: 4452.16
     rank 18: 4449.11
     rank 19: 4447.62
  batch-generator:
     rank  0: 105.49
     rank  1: 109.70
     rank  2: 141.85
     rank  3: 131.76
     rank  4: 149.25
     rank  5: 150.16
     rank  6: 192.92
     rank  7: 174.60
     rank  8: 113.02
     rank  9: 121.32
     rank 10: 129.38
     rank 11: 141.82
     rank 12: 94.06
     rank 13: 97.00
     rank 14: 95.05
     rank 15: 95.99
     rank 16: 90.23
     rank 17: 102.64
     rank 18: 114.15
     rank 19: 98.18
  forward-recv:
     rank  4: 100.88
     rank  5: 100.82
     rank  6: 98.22
     rank  7: 98.83
     rank  8: 331.48
     rank  9: 330.34
     rank 10: 328.73
     rank 11: 327.89
     rank 12: 394.08
     rank 13: 395.36
     rank 14: 395.85
     rank 15: 395.13
     rank 16: 472.39
     rank 17: 472.15
     rank 18: 471.99
     rank 19: 472.38
  forward-send:
     rank  0: 183.89
     rank  1: 181.77
     rank  2: 178.82
     rank  3: 178.74
     rank  4: 15.37
     rank  5: 14.86
     rank  6: 14.46
     rank  7: 13.95
     rank  8: 12.09
     rank  9: 12.66
     rank 10: 12.82
     rank 11: 13.08
     rank 12: 5.12
     rank 13: 4.76
     rank 14: 4.58
     rank 15: 5.14
  backward-recv:
     rank  0: 1082.51
     rank  1: 1081.35
     rank  2: 1078.72
     rank  3: 1082.89
     rank  4: 285.51
     rank  5: 288.38
     rank  6: 292.11
     rank  7: 290.52
     rank  8: 226.33
     rank  9: 224.76
     rank 10: 224.44
     rank 11: 224.77
     rank 12: 124.50
     rank 13: 124.85
     rank 14: 125.28
     rank 15: 124.57
  backward-send:
     rank  4: 11.06
     rank  5: 9.98
     rank  6: 6.91
     rank  7: 9.07
     rank  8: 14.71
     rank  9: 15.49
     rank 10: 15.54
     rank 11: 15.75
     rank 12: 10.18
     rank 13: 10.02
     rank 14: 9.89
     rank 15: 10.46
     rank 16: 4.73
     rank 17: 4.96
     rank 18: 5.26
     rank 19: 5.03
  forward-send-backward-recv:
     rank  0: 6792.27
     rank  1: 6783.47
     rank  2: 6748.55
     rank  3: 6774.44
     rank  4: 533.51
     rank  5: 529.75
     rank  6: 520.71
     rank  7: 518.05
     rank  8: 395.19
     rank  9: 387.22
     rank 10: 390.22
     rank 11: 398.39
     rank 12: 282.23
     rank 13: 281.04
     rank 14: 274.14
     rank 15: 286.39
  backward-send-forward-recv:
     rank  4: 140.09
     rank  5: 146.18
     rank  6: 124.38
     rank  7: 144.35
     rank  8: 2008.84
     rank  9: 2002.45
     rank 10: 1993.32
     rank 11: 1987.18
     rank 12: 2058.83
     rank 13: 2054.88
     rank 14: 2057.90
     rank 15: 2063.67
     rank 16: 1872.57
     rank 17: 1863.45
     rank 18: 1856.98
     rank 19: 1874.37
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.06
     rank  2: 0.08
     rank  3: 0.05
     rank  4: 0.04
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.05
     rank 17: 0.05
     rank 18: 0.05
     rank 19: 0.04
  all-grads-sync:
     rank  0: 0.40
     rank  1: 0.44
     rank  2: 0.51
     rank  3: 0.39
     rank  4: 3.08
     rank  5: 2.73
     rank  6: 2.75
     rank  7: 2.69
     rank  8: 2.56
     rank  9: 2.50
     rank 10: 2.48
     rank 11: 2.46
     rank 12: 2.69
     rank 13: 2.67
     rank 14: 2.66
     rank 15: 2.66
     rank 16: 2.85
     rank 17: 2.82
     rank 18: 2.84
     rank 19: 2.86
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.06
     rank  6: 0.06
     rank  7: 0.05
     rank  8: 0.06
     rank  9: 0.05
     rank 10: 0.05
     rank 11: 0.04
     rank 12: 0.06
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.06
     rank 16: 0.07
     rank 17: 0.06
     rank 18: 0.07
     rank 19: 0.06
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 3.76
     rank  1: 3.78
     rank  2: 3.88
     rank  3: 3.70
     rank  4: 56.00
     rank  5: 57.22
     rank  6: 56.83
     rank  7: 56.32
     rank  8: 52.05
     rank  9: 51.74
     rank 10: 51.95
     rank 11: 52.05
     rank 12: 53.72
     rank 13: 53.60
     rank 14: 53.72
     rank 15: 53.73
     rank 16: 57.06
     rank 17: 56.98
     rank 18: 56.99
     rank 19: 56.96
  optimizer:
     rank  0: 4.45
     rank  1: 4.47
     rank  2: 4.57
     rank  3: 4.39
     rank  4: 56.74
     rank  5: 57.89
     rank  6: 57.50
     rank  7: 57.02
     rank  8: 52.74
     rank  9: 52.43
     rank 10: 52.64
     rank 11: 52.74
     rank 12: 54.40
     rank 13: 54.29
     rank 14: 54.40
     rank 15: 54.41
     rank 16: 57.75
     rank 17: 57.66
     rank 18: 57.68
     rank 19: 57.64
 [2025-01-02 18:20:10] iteration       10/      10 | consumed samples:          320 | elapsed time per iteration (ms): 11248.8 | learning rate: 7.500000E-06 | global batch size:    32 | lm loss: 2.443528E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 11143.36
     rank  1: 11143.30
     rank  2: 11143.33
     rank  3: 11143.31
     rank  4: 11148.76
     rank  5: 11148.31
     rank  6: 11148.29
     rank  7: 11148.30
     rank  8: 11148.05
     rank  9: 11147.95
     rank 10: 11147.86
     rank 11: 11147.89
     rank 12: 11148.17
     rank 13: 11148.01
     rank 14: 11147.97
     rank 15: 11148.01
     rank 16: 11148.33
     rank 17: 11148.32
     rank 18: 11148.34
     rank 19: 11148.36
  forward-compute:
     rank  0: 2832.88
     rank  1: 2839.07
     rank  2: 2874.72
     rank  3: 2849.93
     rank  4: 4791.54
     rank  5: 4797.80
     rank  6: 4839.35
     rank  7: 4793.16
     rank  8: 3381.88
     rank  9: 3399.72
     rank 10: 3414.06
     rank 11: 3398.09
     rank 12: 3587.74
     rank 13: 3588.26
     rank 14: 3582.84
     rank 15: 3577.90
     rank 16: 3752.46
     rank 17: 3763.86
     rank 18: 3768.14
     rank 19: 3753.32
  backward-compute:
     rank  0: 121.70
     rank  1: 135.55
     rank  2: 147.56
     rank  3: 129.85
     rank  4: 5218.70
     rank  5: 5227.85
     rank  6: 5240.09
     rank  7: 5224.38
     rank  8: 4536.36
     rank  9: 4543.70
     rank 10: 4544.81
     rank 11: 4532.68
     rank 12: 4233.24
     rank 13: 4243.27
     rank 14: 4252.28
     rank 15: 4231.94
     rank 16: 4463.43
     rank 17: 4462.65
     rank 18: 4457.36
     rank 19: 4456.01
  pure-backward-compute:
     rank  0: 120.42
     rank  1: 134.06
     rank  2: 146.12
     rank  3: 128.10
     rank  4: 5213.26
     rank  5: 5225.85
     rank  6: 5238.01
     rank  7: 5221.65
     rank  8: 4533.10
     rank  9: 4541.55
     rank 10: 4542.46
     rank 11: 4529.32
     rank 12: 4231.04
     rank 13: 4241.75
     rank 14: 4250.92
     rank 15: 4229.31
     rank 16: 4460.16
     rank 17: 4459.94
     rank 18: 4452.73
     rank 19: 4451.81
  batch-generator:
     rank  0: 105.36
     rank  1: 117.92
     rank  2: 157.36
     rank  3: 134.22
     rank  4: 222.56
     rank  5: 210.25
     rank  6: 269.85
     rank  7: 222.81
     rank  8: 113.70
     rank  9: 127.48
     rank 10: 142.37
     rank 11: 136.38
     rank 12: 92.25
     rank 13: 92.22
     rank 14: 91.58
     rank 15: 95.39
     rank 16: 84.25
     rank 17: 96.84
     rank 18: 109.10
     rank 19: 92.99
  forward-recv:
     rank  4: 103.63
     rank  5: 103.61
     rank  6: 100.35
     rank  7: 102.67
     rank  8: 335.75
     rank  9: 334.54
     rank 10: 333.13
     rank 11: 334.21
     rank 12: 400.81
     rank 13: 401.41
     rank 14: 401.86
     rank 15: 401.16
     rank 16: 478.13
     rank 17: 478.05
     rank 18: 477.69
     rank 19: 478.09
  forward-send:
     rank  0: 194.44
     rank  1: 192.23
     rank  2: 187.90
     rank  3: 190.76
     rank  4: 15.38
     rank  5: 14.96
     rank  6: 13.76
     rank  7: 14.68
     rank  8: 12.37
     rank  9: 12.64
     rank 10: 12.54
     rank 11: 12.63
     rank 12: 5.08
     rank 13: 4.93
     rank 14: 4.54
     rank 15: 5.04
  backward-recv:
     rank  0: 1086.38
     rank  1: 1085.10
     rank  2: 1084.22
     rank  3: 1085.96
     rank  4: 287.47
     rank  5: 290.00
     rank  6: 294.68
     rank  7: 291.59
     rank  8: 223.64
     rank  9: 223.16
     rank 10: 222.91
     rank 11: 222.73
     rank 12: 124.42
     rank 13: 124.92
     rank 14: 124.85
     rank 15: 124.44
  backward-send:
     rank  4: 10.96
     rank  5: 9.65
     rank  6: 6.21
     rank  7: 9.42
     rank  8: 15.28
     rank  9: 14.98
     rank 10: 15.55
     rank 11: 15.81
     rank 12: 10.40
     rank 13: 9.69
     rank 14: 10.22
     rank 15: 10.44
     rank 16: 4.95
     rank 17: 4.83
     rank 18: 5.14
     rank 19: 5.16
  forward-send-backward-recv:
     rank  0: 6896.39
     rank  1: 6877.74
     rank  2: 6833.12
     rank  3: 6874.48
     rank  4: 533.16
     rank  5: 527.57
     rank  6: 505.39
     rank  7: 529.75
     rank  8: 410.84
     rank  9: 405.21
     rank 10: 406.91
     rank 11: 416.99
     rank 12: 283.44
     rank 13: 280.63
     rank 14: 274.44
     rank 15: 287.13
  backward-send-forward-recv:
     rank  4: 141.94
     rank  5: 145.42
     rank  6: 108.12
     rank  7: 147.70
     rank  8: 2035.38
     rank  9: 2023.10
     rank 10: 2007.35
     rank 11: 2018.64
     rank 12: 2157.00
     rank 13: 2157.09
     rank 14: 2158.66
     rank 15: 2163.32
     rank 16: 1971.96
     rank 17: 1962.47
     rank 18: 1956.26
     rank 19: 1972.95
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.06
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.05
     rank  2: 0.07
     rank  3: 0.05
     rank  4: 0.07
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.05
     rank 17: 0.05
     rank 18: 0.05
     rank 19: 0.05
  all-grads-sync:
     rank  0: 0.38
     rank  1: 0.40
     rank  2: 0.47
     rank  3: 0.42
     rank  4: 3.04
     rank  5: 2.76
     rank  6: 2.71
     rank  7: 2.72
     rank  8: 2.47
     rank  9: 2.56
     rank 10: 2.53
     rank 11: 2.49
     rank 12: 2.65
     rank 13: 2.67
     rank 14: 2.67
     rank 15: 2.66
     rank 16: 2.89
     rank 17: 2.85
     rank 18: 2.88
     rank 19: 2.88
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.06
     rank  5: 0.06
     rank  6: 0.05
     rank  7: 0.06
     rank  8: 0.05
     rank  9: 0.05
     rank 10: 0.06
     rank 11: 0.05
     rank 12: 0.05
     rank 13: 0.04
     rank 14: 0.05
     rank 15: 0.06
     rank 16: 0.07
     rank 17: 0.06
     rank 18: 0.06
     rank 19: 0.12
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 3.71
     rank  1: 3.72
     rank  2: 3.84
     rank  3: 3.75
     rank  4: 56.18
     rank  5: 57.30
     rank  6: 56.79
     rank  7: 56.31
     rank  8: 51.86
     rank  9: 51.77
     rank 10: 52.09
     rank 11: 51.93
     rank 12: 53.68
     rank 13: 53.64
     rank 14: 53.78
     rank 15: 53.74
     rank 16: 57.07
     rank 17: 57.00
     rank 18: 56.99
     rank 19: 56.97
  optimizer:
     rank  0: 4.43
     rank  1: 4.44
     rank  2: 4.56
     rank  3: 4.47
     rank  4: 56.91
     rank  5: 58.03
     rank  6: 57.52
     rank  7: 57.03
     rank  8: 52.58
     rank  9: 52.49
     rank 10: 52.81
     rank 11: 52.65
     rank 12: 54.40
     rank 13: 54.35
     rank 14: 54.50
     rank 15: 54.46
     rank 16: 57.79
     rank 17: 57.72
     rank 18: 57.72
     rank 19: 57.70
