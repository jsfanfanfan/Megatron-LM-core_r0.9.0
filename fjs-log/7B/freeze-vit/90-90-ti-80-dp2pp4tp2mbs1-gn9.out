examples/multimodal/pretrain-freeze-llm-hete-3090first.sh: line 4: activate: No such file or directory
3
[2024-12-30 23:01:04,324] torch.distributed.run: [WARNING] 
[2024-12-30 23:01:04,324] torch.distributed.run: [WARNING] *****************************************
[2024-12-30 23:01:04,324] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-12-30 23:01:04,324] torch.distributed.run: [WARNING] *****************************************
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:8------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:8------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:8------
------num_pipeline_model_parallel_groups:4------
> setting tensorboard ...
WARNING: one_logger package is required to enable e2e metrics tracking. please go to https://confluence.nvidia.com/display/MLWFO/Package+Repositories for details to install it
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:8------
------num_pipeline_model_parallel_groups:4------
---Rank 13---Tensor Parallel Group GPUs: [1, 1]---Rank 12---Tensor Parallel Group GPUs: [0, 0]
---Rank 14---Tensor Parallel Group GPUs: [0, 0]
---Rank 15---Tensor Parallel Group GPUs: [1, 1]

---Rank 13---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
---Rank 12---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
---Rank 14---Pipeline Parallel Group GPUs: [3, 3, 3, 3]---Rank 15---Pipeline Parallel Group GPUs: [3, 3, 3, 3]

[rank13]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank12]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank14]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank15]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
 > number of parameters on (tensor, pipeline) model parallel rank (1, 3): 285233152
 > number of parameters on (tensor, pipeline) model parallel rank (0, 3): 285233152
INFO:megatron.core.distributed.param_and_grad_buffer:Number of buckets for gradient all-reduce / reduce-scatter: 1
Params for bucket 1 (285233152 elements):
	language_model.output_layer.weight
	language_model.decoder.layers.1.mlp.linear_fc2.weight
	language_model.decoder.final_layernorm.weight
	language_model.decoder.layers.0.mlp.linear_fc2.weight
	language_model.decoder.layers.0.self_attention.linear_qkv.weight
	language_model.decoder.layers.1.pre_mlp_layernorm.weight
	language_model.decoder.layers.1.mlp.linear_fc1.weight
	language_model.decoder.layers.1.self_attention.linear_qkv.weight
	language_model.decoder.layers.1.self_attention.linear_proj.weight
	language_model.decoder.layers.1.input_layernorm.weight
	language_model.decoder.layers.0.mlp.linear_fc1.weight
	language_model.decoder.layers.0.pre_mlp_layernorm.weight
	language_model.decoder.layers.0.self_attention.linear_proj.weight
	language_model.decoder.layers.0.input_layernorm.weight
rank=1, worker=0: shard_range=[pretrain-31.tar[0, 100), pretrain-31.tar[100, 200), pretrain-31.tar[200, 300), ...<1244>, pretrain-42.tar[4700, 4800), pretrain-42.tar[4800, 4900), pretrain-42.tar[4900, 5000)] sum(count)=125000
rank=1, worker=1: shard_range=[pretrain-42.tar[5000, 5100), pretrain-42.tar[5100, 5200), pretrain-42.tar[5200, 5300), ...<1244>, pretrain-53.tar[9700, 9800), pretrain-53.tar[9800, 9900), pretrain-53.tar[9900, 10000)] sum(count)=125000
rank=0, worker=0: shard_range=[pretrain-0.tar[0, 100), pretrain-0.tar[100, 200), pretrain-0.tar[200, 300), ...<1244>, pretrain-2.tar[4700, 4800), pretrain-2.tar[4800, 4900), pretrain-2.tar[4900, 5000)] sum(count)=125000
rank=0, worker=1: shard_range=[pretrain-2.tar[5000, 5100), pretrain-2.tar[5100, 5200), pretrain-2.tar[5200, 5300), ...<1244>, pretrain-30.tar[9700, 9800), pretrain-30.tar[9800, 9900), pretrain-30.tar[9900, 10000)] sum(count)=125000
rank=1, worker=0: shard_range=[pretrain-7.tar[936, 10000), pretrain-8.tar[0, 5468)] sum(count)=14532
rank=1, worker=1: shard_range=[pretrain-8.tar[5468, 10000), pretrain-9.tar[0, 10000)] sum(count)=14532
rank=0, worker=0: shard_range=[pretrain-54.tar[0, 10000), pretrain-55.tar[0, 4532)] sum(count)=14532
rank=0, worker=1: shard_range=[pretrain-55.tar[4532, 8128), pretrain-6.tar[0, 10000), pretrain-7.tar[0, 936)] sum(count)=14532
times across ranks (ms):
  model-and-optimizer-setup:
     rank  0: 59.45
     rank  1: 85.68
     rank  2: 62.70
     rank  3: 88.48
     rank  4: 43.27
     rank  5: 35.62
     rank  6: 35.61
     rank  7: 43.26
     rank  8: 49.79
     rank  9: 50.11
     rank 10: 50.07
     rank 11: 50.71
     rank 12: 46.00
     rank 13: 45.34
     rank 14: 44.67
     rank 15: 45.29
  train/valid/test-data-iterators-setup:
     rank  0: 774.77
     rank  1: 774.80
     rank  2: 944.52
     rank  3: 944.39
     rank  4: 1148.49
     rank  5: 1148.05
     rank  6: 1147.94
     rank  7: 1148.43
     rank  8: 1304.76
     rank  9: 1305.44
     rank 10: 1304.95
     rank 11: 1305.07
     rank 12: 1304.81
     rank 13: 1304.88
     rank 14: 1304.96
     rank 15: 1305.99
 [2024-12-30 23:01:39] iteration        1/      10 | consumed samples:           32 | elapsed time per iteration (ms): 12672.9 | learning rate: 7.500000E-07 | global batch size:    32 | lm loss: 7.231088E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
[Rank 13] (after 1 iterations) memory (MB) | allocated: 4464.5654296875 | max allocated: 5552.572265625 | reserved: 5934.0 | max reserved: 5934.0
stage4 GPU utialization:49.29485321044922 %
[Rank 12] (after 1 iterations) memory (MB) | allocated: 4464.5654296875 | max allocated: 5552.572265625 | reserved: 5934.0 | max reserved: 5934.0
times across ranks (ms):
  forward-backward:
     rank  0: 12579.63
     rank  1: 12579.58
     rank  2: 12579.72
     rank  3: 12579.68
     rank  4: 12581.88
     rank  5: 12581.86
     rank  6: 12581.84
     rank  7: 12581.96
     rank  8: 12582.08
     rank  9: 12581.97
     rank 10: 12582.13
     rank 11: 12582.04
     rank 12: 12582.29
     rank 13: 12582.18
     rank 14: 12582.27
     rank 15: 12582.17
  forward-compute:
     rank  0: 4721.68
     rank  1: 4705.41
     rank  2: 4958.69
     rank  3: 4945.92
     rank  4: 3429.47
     rank  5: 3411.84
     rank  6: 3221.04
     rank  7: 3206.18
     rank  8: 2463.49
     rank  9: 2442.50
     rank 10: 2467.11
     rank 11: 2460.12
     rank 12: 2589.68
     rank 13: 2581.11
     rank 14: 2693.26
     rank 15: 2688.59
  backward-compute:
     rank  0: 794.21
     rank  1: 793.99
     rank  2: 807.44
     rank  3: 803.18
     rank  4: 1802.35
     rank  5: 1796.52
     rank  6: 1802.78
     rank  7: 1804.18
     rank  8: 1897.61
     rank  9: 1907.88
     rank 10: 1920.27
     rank 11: 1919.25
     rank 12: 1949.50
     rank 13: 1945.71
     rank 14: 1929.26
     rank 15: 1926.01
  pure-backward-compute:
     rank  0: 793.06
     rank  1: 793.09
     rank  2: 806.59
     rank  3: 802.00
     rank  4: 1800.41
     rank  5: 1794.33
     rank  6: 1801.51
     rank  7: 1801.66
     rank  8: 1895.66
     rank  9: 1906.11
     rank 10: 1918.07
     rank 11: 1917.08
     rank 12: 1946.87
     rank 13: 1943.23
     rank 14: 1926.67
     rank 15: 1922.93
  batch-generator:
     rank  0: 870.91
     rank  1: 852.42
     rank  2: 1048.27
     rank  3: 1042.83
     rank  4: 1075.59
     rank  5: 1057.31
     rank  6: 826.68
     rank  7: 818.99
     rank  8: 1191.16
     rank  9: 1156.20
     rank 10: 1181.14
     rank 11: 1173.11
     rank 12: 1019.00
     rank 13: 1009.27
     rank 14: 1220.23
     rank 15: 1215.36
  forward-recv:
     rank  4: 3584.08
     rank  5: 3583.83
     rank  6: 3700.58
     rank  7: 3707.97
     rank  8: 5769.74
     rank  9: 5769.94
     rank 10: 5694.03
     rank 11: 5695.23
     rank 12: 7063.47
     rank 13: 7079.46
     rank 14: 6992.09
     rank 15: 6996.95
  forward-send:
     rank  0: 3485.26
     rank  1: 3501.87
     rank  2: 3260.59
     rank  3: 3274.61
     rank  4: 1232.99
     rank  5: 1249.46
     rank  6: 1239.74
     rank  7: 1245.96
     rank  8: 20.06
     rank  9: 36.22
     rank 10: 21.30
     rank 11: 26.36
  backward-recv:
     rank  0: 477.35
     rank  1: 478.14
     rank  2: 475.71
     rank  3: 476.88
     rank  4: 185.42
     rank  5: 184.28
     rank  6: 185.44
     rank  7: 184.14
     rank  8: 83.11
     rank  9: 82.11
     rank 10: 81.85
     rank 11: 81.71
  backward-send:
     rank  4: 11.52
     rank  5: 12.69
     rank  6: 11.61
     rank  7: 12.54
     rank  8: 8.13
     rank  9: 9.44
     rank 10: 9.64
     rank 11: 9.80
     rank 12: 5.28
     rank 13: 4.80
     rank 14: 5.26
     rank 15: 5.15
  forward-send-backward-recv:
     rank  0: 2579.49
     rank  1: 2579.45
     rank  2: 2558.69
     rank  3: 2559.83
     rank  4: 1673.53
     rank  5: 1680.79
     rank  6: 1774.94
     rank  7: 1774.45
     rank  8: 1562.40
     rank  9: 1555.09
     rank 10: 1618.48
     rank 11: 1619.93
  backward-send-forward-recv:
     rank  4: 83.06
     rank  5: 84.09
     rank  6: 72.21
     rank  7: 71.05
     rank  8: 84.57
     rank  9: 88.25
     rank 10: 79.67
     rank 11: 80.20
     rank 12: 160.24
     rank 13: 156.73
     rank 14: 148.70
     rank 15: 151.43
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.04
     rank  3: 0.03
     rank  4: 0.04
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.04
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.05
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.06
     rank  2: 0.09
     rank  3: 0.06
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.12
     rank 13: 0.09
     rank 14: 0.09
     rank 15: 0.08
  all-grads-sync:
     rank  0: 343.44
     rank  1: 343.53
     rank  2: 343.45
     rank  3: 343.49
     rank  4: 497.22
     rank  5: 508.24
     rank  6: 497.21
     rank  7: 508.23
     rank  8: 356.03
     rank  9: 362.14
     rank 10: 356.02
     rank 11: 362.14
     rank 12: 480.23
     rank 13: 458.38
     rank 14: 480.37
     rank 15: 458.37
  optimizer-copy-to-main-grad:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.05
     rank  3: 0.03
     rank  4: 0.07
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.06
     rank  8: 0.05
     rank  9: 0.06
     rank 10: 0.05
     rank 11: 0.06
     rank 12: 0.05
     rank 13: 0.04
     rank 14: 0.05
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 38.85
     rank  1: 38.84
     rank  2: 39.17
     rank  3: 38.97
     rank  4: 69.16
     rank  5: 67.98
     rank  6: 69.34
     rank  7: 68.61
     rank  8: 81.89
     rank  9: 81.83
     rank 10: 81.64
     rank 11: 81.79
     rank 12: 84.84
     rank 13: 84.32
     rank 14: 83.95
     rank 15: 84.84
  optimizer:
     rank  0: 39.63
     rank  1: 39.61
     rank  2: 39.95
     rank  3: 39.74
     rank  4: 69.96
     rank  5: 68.76
     rank  6: 70.12
     rank  7: 69.39
     rank  8: 82.66
     rank  9: 82.61
     rank 10: 82.42
     rank 11: 82.57
     rank 12: 85.62
     rank 13: 85.30
     rank 14: 84.74
     rank 15: 85.62
 [2024-12-30 23:01:43] iteration        2/      10 | consumed samples:           64 | elapsed time per iteration (ms): 4503.4 | learning rate: 1.500000E-06 | global batch size:    32 | lm loss: 7.232357E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4412.50
     rank  1: 4412.51
     rank  2: 4412.50
     rank  3: 4412.54
     rank  4: 4414.71
     rank  5: 4414.66
     rank  6: 4414.67
     rank  7: 4414.73
     rank  8: 4414.51
     rank  9: 4414.41
     rank 10: 4414.62
     rank 11: 4414.46
     rank 12: 4414.91
     rank 13: 4414.86
     rank 14: 4414.90
     rank 15: 4414.89
  forward-compute:
     rank  0: 1318.51
     rank  1: 1318.85
     rank  2: 1416.84
     rank  3: 1417.30
     rank  4: 1333.67
     rank  5: 1332.79
     rank  6: 1326.07
     rank  7: 1325.31
     rank  8: 1231.62
     rank  9: 1227.04
     rank 10: 1252.22
     rank 11: 1254.03
     rank 12: 1336.12
     rank 13: 1346.88
     rank 14: 1295.47
     rank 15: 1296.14
  backward-compute:
     rank  0: 793.12
     rank  1: 796.01
     rank  2: 799.76
     rank  3: 796.98
     rank  4: 1810.05
     rank  5: 1803.09
     rank  6: 1806.22
     rank  7: 1809.97
     rank  8: 1900.46
     rank  9: 1913.34
     rank 10: 1927.37
     rank 11: 1926.92
     rank 12: 1922.95
     rank 13: 1919.92
     rank 14: 1923.22
     rank 15: 1921.80
  pure-backward-compute:
     rank  0: 792.27
     rank  1: 795.28
     rank  2: 798.89
     rank  3: 796.07
     rank  4: 1807.90
     rank  5: 1801.10
     rank  6: 1804.89
     rank  7: 1807.54
     rank  8: 1898.78
     rank  9: 1911.69
     rank 10: 1925.16
     rank 11: 1925.27
     rank 12: 1920.19
     rank 13: 1917.52
     rank 14: 1920.50
     rank 15: 1918.32
  batch-generator:
     rank  0: 48.95
     rank  1: 47.78
     rank  2: 50.08
     rank  3: 55.70
     rank  4: 60.80
     rank  5: 57.38
     rank  6: 49.17
     rank  7: 50.33
     rank  8: 57.66
     rank  9: 51.88
     rank 10: 68.80
     rank 11: 67.67
     rank 12: 62.57
     rank 13: 74.92
     rank 14: 62.33
     rank 15: 61.46
  forward-recv:
     rank  4: 88.26
     rank  5: 88.09
     rank  6: 130.80
     rank  7: 130.08
     rank  8: 179.85
     rank  9: 179.65
     rank 10: 208.82
     rank 11: 208.98
     rank 12: 246.46
     rank 13: 246.44
     rank 14: 261.97
     rank 15: 262.17
  forward-send:
     rank  0: 14.89
     rank  1: 13.89
     rank  2: 7.99
     rank  3: 7.65
     rank  4: 5.93
     rank  5: 5.59
     rank  6: 5.67
     rank  7: 6.12
     rank  8: 4.98
     rank  9: 5.01
     rank 10: 2.83
     rank 11: 2.88
  backward-recv:
     rank  0: 479.04
     rank  1: 478.64
     rank  2: 479.14
     rank  3: 479.61
     rank  4: 188.88
     rank  5: 189.49
     rank  6: 187.01
     rank  7: 186.50
     rank  8: 84.90
     rank  9: 83.99
     rank 10: 82.17
     rank 11: 82.69
  backward-send:
     rank  4: 9.35
     rank  5: 9.25
     rank  6: 9.26
     rank  7: 9.50
     rank  8: 7.87
     rank  9: 8.06
     rank 10: 8.69
     rank 11: 8.56
     rank 12: 5.27
     rank 13: 4.93
     rank 14: 5.23
     rank 15: 5.20
  forward-send-backward-recv:
     rank  0: 1327.63
     rank  1: 1326.22
     rank  2: 1232.55
     rank  3: 1234.66
     rank  4: 366.38
     rank  5: 370.74
     rank  6: 353.13
     rank  7: 350.16
     rank  8: 287.24
     rank  9: 277.09
     rank 10: 219.61
     rank 11: 219.28
  backward-send-forward-recv:
     rank  4: 72.78
     rank  5: 74.19
     rank  6: 64.81
     rank  7: 64.13
     rank  8: 70.51
     rank  9: 73.74
     rank 10: 65.68
     rank 11: 65.71
     rank 12: 133.23
     rank 13: 125.21
     rank 14: 157.58
     rank 15: 158.29
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.05
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.07
     rank 13: 0.06
     rank 14: 0.07
     rank 15: 0.07
  all-grads-sync:
     rank  0: 257.63
     rank  1: 257.70
     rank  2: 257.61
     rank  3: 257.70
     rank  4: 438.01
     rank  5: 438.01
     rank  6: 438.01
     rank  7: 438.00
     rank  8: 279.49
     rank  9: 275.54
     rank 10: 279.48
     rank 11: 275.53
     rank 12: 466.93
     rank 13: 444.02
     rank 14: 466.91
     rank 15: 444.02
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.05
     rank  5: 0.04
     rank  6: 0.04
     rank  7: 0.05
     rank  8: 0.09
     rank  9: 0.03
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 31.69
     rank  1: 31.67
     rank  2: 31.83
     rank  3: 31.82
     rank  4: 54.05
     rank  5: 53.87
     rank  6: 54.00
     rank  7: 54.07
     rank  8: 52.38
     rank  9: 52.09
     rank 10: 52.21
     rank 11: 52.10
     rank 12: 54.68
     rank 13: 54.58
     rank 14: 54.63
     rank 15: 54.67
  optimizer:
     rank  0: 32.33
     rank  1: 32.30
     rank  2: 32.46
     rank  3: 32.45
     rank  4: 54.69
     rank  5: 54.50
     rank  6: 54.63
     rank  7: 54.70
     rank  8: 53.02
     rank  9: 52.72
     rank 10: 52.85
     rank 11: 52.73
     rank 12: 55.32
     rank 13: 55.22
     rank 14: 55.27
     rank 15: 55.31
 [2024-12-30 23:01:48] iteration        3/      10 | consumed samples:           96 | elapsed time per iteration (ms): 4511.6 | learning rate: 2.250000E-06 | global batch size:    32 | lm loss: 6.796421E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4421.95
     rank  1: 4422.11
     rank  2: 4422.01
     rank  3: 4422.09
     rank  4: 4424.17
     rank  5: 4424.35
     rank  6: 4424.12
     rank  7: 4424.30
     rank  8: 4423.96
     rank  9: 4424.11
     rank 10: 4424.06
     rank 11: 4424.08
     rank 12: 4424.37
     rank 13: 4424.31
     rank 14: 4424.37
     rank 15: 4424.37
  forward-compute:
     rank  0: 1333.25
     rank  1: 1333.11
     rank  2: 1444.37
     rank  3: 1444.14
     rank  4: 1341.52
     rank  5: 1340.83
     rank  6: 1338.90
     rank  7: 1336.63
     rank  8: 1232.83
     rank  9: 1229.80
     rank 10: 1262.46
     rank 11: 1261.55
     rank 12: 1329.56
     rank 13: 1338.49
     rank 14: 1301.44
     rank 15: 1301.68
  backward-compute:
     rank  0: 794.23
     rank  1: 796.50
     rank  2: 800.52
     rank  3: 797.05
     rank  4: 1810.72
     rank  5: 1805.54
     rank  6: 1817.12
     rank  7: 1818.45
     rank  8: 1908.03
     rank  9: 1920.40
     rank 10: 1938.22
     rank 11: 1939.49
     rank 12: 1927.91
     rank 13: 1925.35
     rank 14: 1929.48
     rank 15: 1933.14
  pure-backward-compute:
     rank  0: 793.15
     rank  1: 795.75
     rank  2: 799.71
     rank  3: 796.03
     rank  4: 1809.06
     rank  5: 1803.74
     rank  6: 1815.71
     rank  7: 1815.98
     rank  8: 1906.40
     rank  9: 1918.77
     rank 10: 1936.22
     rank 11: 1937.79
     rank 12: 1925.17
     rank 13: 1922.29
     rank 14: 1926.66
     rank 15: 1929.55
  batch-generator:
     rank  0: 47.66
     rank  1: 49.21
     rank  2: 46.08
     rank  3: 52.40
     rank  4: 65.93
     rank  5: 58.24
     rank  6: 55.29
     rank  7: 53.01
     rank  8: 57.73
     rank  9: 53.20
     rank 10: 66.00
     rank 11: 63.36
     rank 12: 61.06
     rank 13: 71.62
     rank 14: 62.83
     rank 15: 61.65
  forward-recv:
     rank  4: 95.53
     rank  5: 95.20
     rank  6: 96.48
     rank  7: 95.62
     rank  8: 188.73
     rank  9: 188.73
     rank 10: 187.84
     rank 11: 188.22
     rank 12: 254.47
     rank 13: 254.47
     rank 14: 255.51
     rank 15: 255.45
  forward-send:
     rank  0: 21.51
     rank  1: 21.16
     rank  2: 18.90
     rank  3: 19.00
     rank  4: 10.63
     rank  5: 10.45
     rank  6: 10.67
     rank  7: 10.96
     rank  8: 5.21
     rank  9: 5.09
     rank 10: 4.54
     rank 11: 4.61
  backward-recv:
     rank  0: 489.29
     rank  1: 488.90
     rank  2: 484.64
     rank  3: 485.26
     rank  4: 194.33
     rank  5: 195.18
     rank  6: 187.42
     rank  7: 187.47
     rank  8: 87.37
     rank  9: 86.31
     rank 10: 83.22
     rank 11: 83.28
  backward-send:
     rank  4: 9.71
     rank  5: 9.81
     rank  6: 9.80
     rank  7: 10.26
     rank  8: 7.71
     rank  9: 7.86
     rank 10: 7.31
     rank 11: 7.75
     rank 12: 5.13
     rank 13: 4.46
     rank 14: 5.14
     rank 15: 5.16
  forward-send-backward-recv:
     rank  0: 1309.81
     rank  1: 1309.25
     rank  2: 1201.25
     rank  3: 1203.68
     rank  4: 357.07
     rank  5: 362.09
     rank  6: 376.52
     rank  7: 376.02
     rank  8: 279.75
     rank  9: 269.57
     rank 10: 230.07
     rank 11: 230.18
  backward-send-forward-recv:
     rank  4: 71.87
     rank  5: 72.19
     rank  6: 59.34
     rank  7: 59.69
     rank  8: 69.29
     rank  9: 71.49
     rank 10: 64.26
     rank 11: 64.62
     rank 12: 137.93
     rank 13: 130.71
     rank 14: 163.36
     rank 15: 159.36
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.06
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.07
     rank  2: 0.05
     rank  3: 0.05
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.05
     rank 11: 0.02
     rank 12: 0.07
     rank 13: 0.06
     rank 14: 0.07
     rank 15: 0.07
  all-grads-sync:
     rank  0: 257.17
     rank  1: 257.22
     rank  2: 257.19
     rank  3: 257.21
     rank  4: 446.95
     rank  5: 447.05
     rank  6: 446.96
     rank  7: 447.02
     rank  8: 280.28
     rank  9: 277.26
     rank 10: 280.29
     rank 11: 277.33
     rank 12: 463.11
     rank 13: 441.17
     rank 14: 463.10
     rank 15: 441.18
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.04
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.05
     rank  5: 0.11
     rank  6: 0.04
     rank  7: 0.05
     rank  8: 0.05
     rank  9: 0.05
     rank 10: 0.06
     rank 11: 0.06
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.07
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.06
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 31.74
     rank  1: 31.76
     rank  2: 31.85
     rank  3: 31.83
     rank  4: 54.19
     rank  5: 54.07
     rank  6: 54.04
     rank  7: 54.24
     rank  8: 52.43
     rank  9: 52.25
     rank 10: 52.23
     rank 11: 52.17
     rank 12: 54.58
     rank 13: 54.63
     rank 14: 54.99
     rank 15: 54.69
  optimizer:
     rank  0: 32.52
     rank  1: 32.54
     rank  2: 32.72
     rank  3: 32.61
     rank  4: 54.98
     rank  5: 54.86
     rank  6: 54.82
     rank  7: 55.03
     rank  8: 53.21
     rank  9: 53.03
     rank 10: 53.01
     rank 11: 52.96
     rank 12: 55.36
     rank 13: 55.41
     rank 14: 55.78
     rank 15: 55.48
 [2024-12-30 23:01:53] iteration        4/      10 | consumed samples:          128 | elapsed time per iteration (ms): 4510.5 | learning rate: 3.000000E-06 | global batch size:    32 | lm loss: 1.820526E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4420.61
     rank  1: 4420.54
     rank  2: 4420.58
     rank  3: 4420.56
     rank  4: 4422.78
     rank  5: 4422.86
     rank  6: 4422.74
     rank  7: 4422.96
     rank  8: 4422.56
     rank  9: 4422.64
     rank 10: 4422.57
     rank 11: 4422.71
     rank 12: 4422.98
     rank 13: 4422.94
     rank 14: 4423.01
     rank 15: 4422.95
  forward-compute:
     rank  0: 1325.22
     rank  1: 1320.96
     rank  2: 1428.22
     rank  3: 1428.46
     rank  4: 1338.26
     rank  5: 1336.67
     rank  6: 1343.42
     rank  7: 1342.19
     rank  8: 1239.23
     rank  9: 1235.35
     rank 10: 1264.53
     rank 11: 1264.07
     rank 12: 1339.26
     rank 13: 1350.54
     rank 14: 1297.25
     rank 15: 1298.33
  backward-compute:
     rank  0: 786.79
     rank  1: 791.72
     rank  2: 798.60
     rank  3: 795.26
     rank  4: 1804.90
     rank  5: 1798.48
     rank  6: 1816.93
     rank  7: 1817.34
     rank  8: 1910.71
     rank  9: 1926.78
     rank 10: 1951.74
     rank 11: 1954.83
     rank 12: 1931.39
     rank 13: 1929.06
     rank 14: 1930.64
     rank 15: 1928.00
  pure-backward-compute:
     rank  0: 786.00
     rank  1: 790.94
     rank  2: 797.78
     rank  3: 794.36
     rank  4: 1803.32
     rank  5: 1796.94
     rank  6: 1815.46
     rank  7: 1815.43
     rank  8: 1909.09
     rank  9: 1925.19
     rank 10: 1949.78
     rank 11: 1953.07
     rank 12: 1928.73
     rank 13: 1926.30
     rank 14: 1927.82
     rank 15: 1925.00
  batch-generator:
     rank  0: 44.27
     rank  1: 40.46
     rank  2: 48.05
     rank  3: 50.67
     rank  4: 62.34
     rank  5: 62.71
     rank  6: 55.31
     rank  7: 54.49
     rank  8: 58.32
     rank  9: 53.60
     rank 10: 65.25
     rank 11: 63.24
     rank 12: 62.11
     rank 13: 75.10
     rank 14: 61.90
     rank 15: 61.16
  forward-recv:
     rank  4: 95.01
     rank  5: 96.85
     rank  6: 96.83
     rank  7: 96.60
     rank  8: 189.64
     rank  9: 189.93
     rank 10: 189.02
     rank 11: 189.33
     rank 12: 255.84
     rank 13: 256.09
     rank 14: 257.23
     rank 15: 257.24
  forward-send:
     rank  0: 20.60
     rank  1: 23.64
     rank  2: 24.37
     rank  3: 24.76
     rank  4: 9.86
     rank  5: 10.66
     rank  6: 9.99
     rank  7: 10.31
     rank  8: 4.98
     rank  9: 5.20
     rank 10: 4.41
     rank 11: 4.43
  backward-recv:
     rank  0: 488.02
     rank  1: 487.33
     rank  2: 483.52
     rank  3: 484.29
     rank  4: 193.54
     rank  5: 194.30
     rank  6: 189.75
     rank  7: 189.59
     rank  8: 86.11
     rank  9: 85.53
     rank 10: 82.94
     rank 11: 82.30
  backward-send:
     rank  4: 8.06
     rank  5: 8.22
     rank  6: 7.64
     rank  7: 8.32
     rank  8: 5.80
     rank  9: 6.55
     rank 10: 6.57
     rank 11: 6.64
     rank 12: 5.33
     rank 13: 5.05
     rank 14: 5.27
     rank 15: 4.95
  forward-send-backward-recv:
     rank  0: 1330.33
     rank  1: 1327.44
     rank  2: 1219.70
     rank  3: 1221.45
     rank  4: 376.77
     rank  5: 381.60
     rank  6: 385.97
     rank  7: 386.33
     rank  8: 283.07
     rank  9: 269.85
     rank 10: 227.11
     rank 11: 226.76
  backward-send-forward-recv:
     rank  4: 70.07
     rank  5: 68.91
     rank  6: 49.96
     rank  7: 50.79
     rank  8: 64.74
     rank  9: 66.51
     rank 10: 59.36
     rank 11: 58.46
     rank 12: 129.20
     rank 13: 119.73
     rank 14: 170.48
     rank 15: 171.59
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.05
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.05
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.07
     rank 13: 0.06
     rank 14: 0.06
     rank 15: 0.07
  all-grads-sync:
     rank  0: 258.41
     rank  1: 258.47
     rank  2: 258.41
     rank  3: 258.42
     rank  4: 449.83
     rank  5: 449.84
     rank  6: 449.87
     rank  7: 449.88
     rank  8: 275.60
     rank  9: 274.48
     rank 10: 275.59
     rank 11: 274.37
     rank 12: 456.97
     rank 13: 434.25
     rank 14: 456.97
     rank 15: 434.25
  optimizer-copy-to-main-grad:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.09
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.08
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 31.83
     rank  1: 31.79
     rank  2: 31.81
     rank  3: 31.77
     rank  4: 54.10
     rank  5: 54.03
     rank  6: 54.04
     rank  7: 54.34
     rank  8: 52.29
     rank  9: 52.01
     rank 10: 52.20
     rank 11: 52.31
     rank 12: 54.67
     rank 13: 54.55
     rank 14: 54.60
     rank 15: 54.62
  optimizer:
     rank  0: 32.63
     rank  1: 32.59
     rank  2: 32.61
     rank  3: 32.58
     rank  4: 54.91
     rank  5: 54.84
     rank  6: 54.85
     rank  7: 55.16
     rank  8: 53.09
     rank  9: 52.81
     rank 10: 53.01
     rank 11: 53.12
     rank 12: 55.48
     rank 13: 55.36
     rank 14: 55.41
     rank 15: 55.43
 [2024-12-30 23:01:57] iteration        5/      10 | consumed samples:          160 | elapsed time per iteration (ms): 4536.2 | learning rate: 3.750000E-06 | global batch size:    32 | lm loss: 1.614893E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4445.97
     rank  1: 4445.94
     rank  2: 4446.01
     rank  3: 4445.98
     rank  4: 4448.13
     rank  5: 4448.23
     rank  6: 4448.16
     rank  7: 4448.16
     rank  8: 4447.93
     rank  9: 4447.95
     rank 10: 4447.97
     rank 11: 4447.94
     rank 12: 4448.37
     rank 13: 4448.31
     rank 14: 4448.48
     rank 15: 4448.31
  forward-compute:
     rank  0: 1328.45
     rank  1: 1326.65
     rank  2: 1341.25
     rank  3: 1337.46
     rank  4: 1347.04
     rank  5: 1346.20
     rank  6: 1344.18
     rank  7: 1338.81
     rank  8: 1239.66
     rank  9: 1237.43
     rank 10: 1275.93
     rank 11: 1273.33
     rank 12: 1355.57
     rank 13: 1368.74
     rank 14: 1299.15
     rank 15: 1300.15
  backward-compute:
     rank  0: 794.09
     rank  1: 795.30
     rank  2: 799.35
     rank  3: 797.18
     rank  4: 1807.90
     rank  5: 1800.56
     rank  6: 1800.63
     rank  7: 1799.60
     rank  8: 1911.42
     rank  9: 1932.21
     rank 10: 1963.20
     rank 11: 1966.59
     rank 12: 1933.12
     rank 13: 1930.18
     rank 14: 1934.32
     rank 15: 1932.59
  pure-backward-compute:
     rank  0: 793.32
     rank  1: 794.57
     rank  2: 798.52
     rank  3: 796.48
     rank  4: 1806.28
     rank  5: 1798.98
     rank  6: 1799.18
     rank  7: 1798.08
     rank  8: 1909.83
     rank  9: 1930.61
     rank 10: 1961.25
     rank 11: 1965.00
     rank 12: 1930.53
     rank 13: 1927.59
     rank 14: 1931.70
     rank 15: 1929.70
  batch-generator:
     rank  0: 46.54
     rank  1: 45.99
     rank  2: 49.32
     rank  3: 45.52
     rank  4: 65.38
     rank  5: 66.21
     rank  6: 60.82
     rank  7: 56.69
     rank  8: 56.93
     rank  9: 53.35
     rank 10: 65.81
     rank 11: 63.15
     rank 12: 63.57
     rank 13: 82.53
     rank 14: 62.30
     rank 15: 61.75
  forward-recv:
     rank  4: 95.46
     rank  5: 95.48
     rank  6: 92.94
     rank  7: 95.66
     rank  8: 190.49
     rank  9: 190.25
     rank 10: 188.40
     rank 11: 190.09
     rank 12: 257.27
     rank 13: 257.47
     rank 14: 257.50
     rank 15: 257.48
  forward-send:
     rank  0: 25.12
     rank  1: 25.01
     rank  2: 20.33
     rank  3: 25.11
     rank  4: 10.24
     rank  5: 10.19
     rank  6: 8.74
     rank  7: 10.38
     rank  8: 5.07
     rank  9: 5.23
     rank 10: 5.29
     rank 11: 5.31
  backward-recv:
     rank  0: 488.31
     rank  1: 488.77
     rank  2: 485.70
     rank  3: 486.34
     rank  4: 192.11
     rank  5: 194.35
     rank  6: 192.85
     rank  7: 192.68
     rank  8: 89.41
     rank  9: 88.58
     rank 10: 82.60
     rank 11: 82.14
  backward-send:
     rank  4: 9.55
     rank  5: 9.42
     rank  6: 9.15
     rank  7: 9.49
     rank  8: 5.19
     rank  9: 5.92
     rank 10: 5.90
     rank 11: 5.97
     rank 12: 5.16
     rank 13: 4.54
     rank 14: 5.15
     rank 15: 5.22
  forward-send-backward-recv:
     rank  0: 1336.27
     rank  1: 1337.02
     rank  2: 1328.05
     rank  3: 1329.03
     rank  4: 385.17
     rank  5: 390.48
     rank  6: 420.96
     rank  7: 422.08
     rank  8: 297.55
     rank  9: 280.25
     rank 10: 227.32
     rank 11: 226.94
  backward-send-forward-recv:
     rank  4: 69.53
     rank  5: 70.32
     rank  6: 51.56
     rank  7: 52.19
     rank  8: 64.75
     rank  9: 65.30
     rank 10: 57.26
     rank 11: 56.63
     rank 12: 130.22
     rank 13: 119.02
     rank 14: 184.99
     rank 15: 185.80
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.04
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.05
     rank  3: 0.06
     rank  4: 0.02
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.06
     rank 13: 0.06
     rank 14: 0.13
     rank 15: 0.06
  all-grads-sync:
     rank  0: 259.42
     rank  1: 259.46
     rank  2: 259.39
     rank  3: 259.49
     rank  4: 453.83
     rank  5: 453.78
     rank  6: 453.83
     rank  7: 453.78
     rank  8: 276.63
     rank  9: 275.58
     rank 10: 276.62
     rank 11: 275.57
     rank 12: 461.90
     rank 13: 440.20
     rank 14: 461.74
     rank 15: 440.21
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.04
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.04
     rank  9: 0.03
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.03
     rank 13: 0.04
     rank 14: 0.09
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 31.69
     rank  1: 31.72
     rank  2: 31.74
     rank  3: 31.85
     rank  4: 54.12
     rank  5: 54.17
     rank  6: 54.05
     rank  7: 54.05
     rank  8: 52.33
     rank  9: 51.96
     rank 10: 52.13
     rank 11: 52.21
     rank 12: 54.50
     rank 13: 54.55
     rank 14: 54.90
     rank 15: 54.56
  optimizer:
     rank  0: 32.50
     rank  1: 32.52
     rank  2: 32.55
     rank  3: 32.66
     rank  4: 54.94
     rank  5: 54.99
     rank  6: 54.87
     rank  7: 54.89
     rank  8: 53.15
     rank  9: 52.78
     rank 10: 52.94
     rank 11: 53.02
     rank 12: 55.31
     rank 13: 55.37
     rank 14: 55.71
     rank 15: 55.38
 [2024-12-30 23:02:02] iteration        6/      10 | consumed samples:          192 | elapsed time per iteration (ms): 4571.7 | learning rate: 4.500000E-06 | global batch size:    32 | lm loss: 3.905613E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4482.08
     rank  1: 4481.98
     rank  2: 4482.17
     rank  3: 4482.01
     rank  4: 4484.31
     rank  5: 4484.22
     rank  6: 4484.22
     rank  7: 4484.27
     rank  8: 4484.05
     rank  9: 4484.02
     rank 10: 4484.06
     rank 11: 4484.00
     rank 12: 4484.46
     rank 13: 4484.40
     rank 14: 4484.56
     rank 15: 4484.43
  forward-compute:
     rank  0: 1332.26
     rank  1: 1331.21
     rank  2: 1368.66
     rank  3: 1369.68
     rank  4: 1344.06
     rank  5: 1343.16
     rank  6: 1335.17
     rank  7: 1332.99
     rank  8: 1247.63
     rank  9: 1242.70
     rank 10: 1280.57
     rank 11: 1279.83
     rank 12: 1370.43
     rank 13: 1370.72
     rank 14: 1304.90
     rank 15: 1305.29
  backward-compute:
     rank  0: 791.75
     rank  1: 795.10
     rank  2: 801.47
     rank  3: 797.18
     rank  4: 1812.39
     rank  5: 1804.20
     rank  6: 1802.36
     rank  7: 1801.36
     rank  8: 1930.22
     rank  9: 1937.24
     rank 10: 1975.09
     rank 11: 1978.05
     rank 12: 1936.42
     rank 13: 1934.13
     rank 14: 1939.19
     rank 15: 1936.78
  pure-backward-compute:
     rank  0: 790.93
     rank  1: 794.37
     rank  2: 800.29
     rank  3: 796.42
     rank  4: 1810.65
     rank  5: 1802.55
     rank  6: 1800.93
     rank  7: 1799.83
     rank  8: 1928.65
     rank  9: 1935.34
     rank 10: 1972.94
     rank 11: 1976.39
     rank 12: 1933.83
     rank 13: 1931.35
     rank 14: 1936.54
     rank 15: 1933.65
  batch-generator:
     rank  0: 47.72
     rank  1: 47.13
     rank  2: 56.74
     rank  3: 56.82
     rank  4: 62.34
     rank  5: 63.59
     rank  6: 56.40
     rank  7: 54.26
     rank  8: 57.62
     rank  9: 51.56
     rank 10: 66.95
     rank 11: 63.62
     rank 12: 65.96
     rank 13: 73.87
     rank 14: 62.79
     rank 15: 61.43
  forward-recv:
     rank  4: 98.22
     rank  5: 98.13
     rank  6: 97.98
     rank  7: 98.48
     rank  8: 189.95
     rank  9: 189.99
     rank 10: 188.84
     rank 11: 188.98
     rank 12: 256.46
     rank 13: 256.50
     rank 14: 256.98
     rank 15: 257.03
  forward-send:
     rank  0: 23.61
     rank  1: 23.64
     rank  2: 22.54
     rank  3: 23.51
     rank  4: 10.56
     rank  5: 10.67
     rank  6: 10.36
     rank  7: 10.63
     rank  8: 5.21
     rank  9: 5.23
     rank 10: 5.16
     rank 11: 5.09
  backward-recv:
     rank  0: 493.91
     rank  1: 493.65
     rank  2: 484.10
     rank  3: 485.62
     rank  4: 195.57
     rank  5: 197.11
     rank  6: 191.14
     rank  7: 191.26
     rank  8: 90.12
     rank  9: 89.37
     rank 10: 82.05
     rank 11: 81.65
  backward-send:
     rank  4: 8.38
     rank  5: 7.78
     rank  6: 7.75
     rank  7: 8.18
     rank  8: 5.06
     rank  9: 5.35
     rank 10: 5.10
     rank 11: 5.43
     rank 12: 4.86
     rank 13: 4.50
     rank 14: 5.07
     rank 15: 5.17
  forward-send-backward-recv:
     rank  0: 1343.63
     rank  1: 1342.33
     rank  2: 1312.46
     rank  3: 1314.25
     rank  4: 391.52
     rank  5: 398.92
     rank  6: 436.80
     rank  7: 437.14
     rank  8: 289.54
     rank  9: 285.47
     rank 10: 227.56
     rank 11: 227.40
  backward-send-forward-recv:
     rank  4: 69.91
     rank  5: 70.64
     rank  6: 54.20
     rank  7: 55.35
     rank  8: 60.58
     rank  9: 63.45
     rank 10: 57.44
     rank 11: 57.03
     rank 12: 129.46
     rank 13: 130.89
     rank 14: 192.05
     rank 15: 193.48
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.06
     rank  3: 0.04
     rank  4: 0.04
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.06
     rank 13: 0.07
     rank 14: 0.08
     rank 15: 0.07
  all-grads-sync:
     rank  0: 261.45
     rank  1: 261.51
     rank  2: 261.41
     rank  3: 261.55
     rank  4: 445.86
     rank  5: 445.86
     rank  6: 445.83
     rank  7: 445.86
     rank  8: 280.98
     rank  9: 277.94
     rank 10: 280.97
     rank 11: 277.94
     rank 12: 482.49
     rank 13: 458.05
     rank 14: 482.52
     rank 15: 458.00
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.10
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.11
     rank  8: 0.04
     rank  9: 0.05
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.05
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 31.70
     rank  1: 31.72
     rank  2: 31.81
     rank  3: 31.76
     rank  4: 54.24
     rank  5: 54.04
     rank  6: 54.06
     rank  7: 54.18
     rank  8: 52.25
     rank  9: 52.22
     rank 10: 52.12
     rank 11: 52.12
     rank 12: 54.49
     rank 13: 54.55
     rank 14: 54.57
     rank 15: 54.66
  optimizer:
     rank  0: 32.44
     rank  1: 32.46
     rank  2: 32.56
     rank  3: 32.50
     rank  4: 54.99
     rank  5: 54.79
     rank  6: 54.80
     rank  7: 54.93
     rank  8: 53.00
     rank  9: 52.97
     rank 10: 52.87
     rank 11: 52.87
     rank 12: 55.24
     rank 13: 55.30
     rank 14: 55.30
     rank 15: 55.41
 [2024-12-30 23:02:06] iteration        7/      10 | consumed samples:          224 | elapsed time per iteration (ms): 4565.9 | learning rate: 5.250000E-06 | global batch size:    32 | lm loss: 3.187654E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4474.54
     rank  1: 4474.47
     rank  2: 4474.58
     rank  3: 4474.49
     rank  4: 4476.72
     rank  5: 4476.70
     rank  6: 4476.76
     rank  7: 4476.76
     rank  8: 4476.52
     rank  9: 4476.48
     rank 10: 4476.59
     rank 11: 4476.53
     rank 12: 4476.87
     rank 13: 4476.86
     rank 14: 4476.92
     rank 15: 4476.88
  forward-compute:
     rank  0: 1333.16
     rank  1: 1330.96
     rank  2: 1399.36
     rank  3: 1399.58
     rank  4: 1347.69
     rank  5: 1347.43
     rank  6: 1337.95
     rank  7: 1336.11
     rank  8: 1249.77
     rank  9: 1247.64
     rank 10: 1279.94
     rank 11: 1277.06
     rank 12: 1386.44
     rank 13: 1398.09
     rank 14: 1304.42
     rank 15: 1304.64
  backward-compute:
     rank  0: 790.06
     rank  1: 793.06
     rank  2: 798.52
     rank  3: 796.44
     rank  4: 1807.13
     rank  5: 1802.10
     rank  6: 1805.02
     rank  7: 1802.25
     rank  8: 1910.51
     rank  9: 1930.37
     rank 10: 1987.93
     rank 11: 1991.57
     rank 12: 1939.35
     rank 13: 1936.99
     rank 14: 1941.69
     rank 15: 1939.12
  pure-backward-compute:
     rank  0: 789.21
     rank  1: 792.19
     rank  2: 797.64
     rank  3: 795.65
     rank  4: 1805.34
     rank  5: 1800.39
     rank  6: 1803.54
     rank  7: 1800.49
     rank  8: 1908.67
     rank  9: 1928.81
     rank 10: 1986.37
     rank 11: 1989.95
     rank 12: 1936.75
     rank 13: 1934.16
     rank 14: 1939.08
     rank 15: 1936.37
  batch-generator:
     rank  0: 46.60
     rank  1: 46.16
     rank  2: 51.50
     rank  3: 50.68
     rank  4: 63.92
     rank  5: 65.48
     rank  6: 55.31
     rank  7: 55.48
     rank  8: 59.48
     rank  9: 56.15
     rank 10: 60.94
     rank 11: 57.07
     rank 12: 63.47
     rank 13: 82.63
     rank 14: 62.71
     rank 15: 61.31
  forward-recv:
     rank  4: 90.06
     rank  5: 90.26
     rank  6: 120.78
     rank  7: 119.95
     rank  8: 183.74
     rank  9: 183.64
     rank 10: 209.78
     rank 11: 209.95
     rank 12: 250.02
     rank 13: 250.09
     rank 14: 267.46
     rank 15: 267.50
  forward-send:
     rank  0: 10.97
     rank  1: 11.69
     rank  2: 8.46
     rank  3: 8.15
     rank  4: 6.17
     rank  5: 6.10
     rank  6: 5.83
     rank  7: 6.14
     rank  8: 4.84
     rank  9: 4.99
     rank 10: 2.96
     rank 11: 2.89
  backward-recv:
     rank  0: 499.94
     rank  1: 499.19
     rank  2: 487.73
     rank  3: 488.37
     rank  4: 205.06
     rank  5: 205.67
     rank  6: 192.01
     rank  7: 192.06
     rank  8: 88.53
     rank  9: 88.14
     rank 10: 80.71
     rank 11: 80.27
  backward-send:
     rank  4: 8.39
     rank  5: 8.24
     rank  6: 8.40
     rank  7: 8.77
     rank  8: 5.14
     rank  9: 5.56
     rank 10: 5.40
     rank 11: 5.60
     rank 12: 4.69
     rank 13: 4.66
     rank 14: 5.03
     rank 15: 5.13
  forward-send-backward-recv:
     rank  0: 1363.81
     rank  1: 1363.46
     rank  2: 1307.44
     rank  3: 1309.39
     rank  4: 411.73
     rank  5: 415.18
     rank  6: 428.71
     rank  7: 431.84
     rank  8: 324.24
     rank  9: 306.83
     rank 10: 215.01
     rank 11: 214.62
  backward-send-forward-recv:
     rank  4: 67.70
     rank  5: 67.35
     rank  6: 49.19
     rank  7: 51.07
     rank  8: 64.64
     rank  9: 65.38
     rank 10: 52.56
     rank 11: 53.02
     rank 12: 127.49
     rank 13: 117.85
     rank 14: 190.24
     rank 15: 192.28
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.06
     rank  3: 0.05
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.06
     rank 13: 0.06
     rank 14: 0.07
     rank 15: 0.07
  all-grads-sync:
     rank  0: 258.57
     rank  1: 258.63
     rank  2: 258.55
     rank  3: 258.63
     rank  4: 446.55
     rank  5: 446.57
     rank  6: 446.54
     rank  7: 446.57
     rank  8: 279.12
     rank  9: 278.04
     rank 10: 279.13
     rank 11: 278.04
     rank 12: 463.36
     rank 13: 440.16
     rank 14: 463.35
     rank 15: 440.18
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.04
     rank  7: 0.06
     rank  8: 0.04
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.04
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 31.70
     rank  1: 31.71
     rank  2: 31.80
     rank  3: 31.78
     rank  4: 54.12
     rank  5: 54.06
     rank  6: 54.03
     rank  7: 54.09
     rank  8: 52.37
     rank  9: 52.03
     rank 10: 52.09
     rank 11: 52.05
     rank 12: 54.51
     rank 13: 54.49
     rank 14: 54.53
     rank 15: 54.62
  optimizer:
     rank  0: 32.41
     rank  1: 32.42
     rank  2: 32.51
     rank  3: 32.50
     rank  4: 54.84
     rank  5: 54.77
     rank  6: 54.75
     rank  7: 54.81
     rank  8: 53.09
     rank  9: 52.74
     rank 10: 52.80
     rank 11: 52.77
     rank 12: 55.22
     rank 13: 55.21
     rank 14: 55.25
     rank 15: 55.33
 [2024-12-30 23:02:11] iteration        8/      10 | consumed samples:          256 | elapsed time per iteration (ms): 4567.5 | learning rate: 6.000000E-06 | global batch size:    32 | lm loss: 2.108932E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4478.37
     rank  1: 4478.26
     rank  2: 4478.36
     rank  3: 4478.31
     rank  4: 4480.46
     rank  5: 4480.50
     rank  6: 4480.51
     rank  7: 4480.52
     rank  8: 4480.24
     rank  9: 4480.27
     rank 10: 4480.28
     rank 11: 4480.30
     rank 12: 4480.73
     rank 13: 4480.67
     rank 14: 4480.84
     rank 15: 4480.68
  forward-compute:
     rank  0: 1448.12
     rank  1: 1446.26
     rank  2: 1329.45
     rank  3: 1326.58
     rank  4: 1345.00
     rank  5: 1342.58
     rank  6: 1339.89
     rank  7: 1336.38
     rank  8: 1247.92
     rank  9: 1244.75
     rank 10: 1285.34
     rank 11: 1277.16
     rank 12: 1384.82
     rank 13: 1395.87
     rank 14: 1306.43
     rank 15: 1306.39
  backward-compute:
     rank  0: 793.46
     rank  1: 794.39
     rank  2: 800.97
     rank  3: 797.26
     rank  4: 1804.10
     rank  5: 1799.16
     rank  6: 1809.16
     rank  7: 1803.86
     rank  8: 1920.97
     rank  9: 1941.72
     rank 10: 2001.49
     rank 11: 2005.92
     rank 12: 1942.96
     rank 13: 1940.12
     rank 14: 1944.05
     rank 15: 1941.74
  pure-backward-compute:
     rank  0: 792.13
     rank  1: 793.60
     rank  2: 800.14
     rank  3: 796.55
     rank  4: 1802.57
     rank  5: 1797.52
     rank  6: 1807.66
     rank  7: 1802.31
     rank  8: 1919.32
     rank  9: 1940.14
     rank 10: 1999.94
     rank 11: 2004.30
     rank 12: 1940.42
     rank 13: 1937.68
     rank 14: 1941.34
     rank 15: 1938.76
  batch-generator:
     rank  0: 63.23
     rank  1: 58.66
     rank  2: 50.48
     rank  3: 48.64
     rank  4: 61.38
     rank  5: 62.26
     rank  6: 56.67
     rank  7: 55.96
     rank  8: 55.28
     rank  9: 51.28
     rank 10: 58.52
     rank 11: 52.83
     rank 12: 64.43
     rank 13: 83.59
     rank 14: 63.20
     rank 15: 61.63
  forward-recv:
     rank  4: 93.94
     rank  5: 93.76
     rank  6: 90.97
     rank  7: 92.80
     rank  8: 187.44
     rank  9: 187.30
     rank 10: 182.29
     rank 11: 184.86
     rank 12: 253.99
     rank 13: 254.28
     rank 14: 255.36
     rank 15: 255.32
  forward-send:
     rank  0: 21.61
     rank  1: 21.82
     rank  2: 14.71
     rank  3: 19.07
     rank  4: 9.24
     rank  5: 9.40
     rank  6: 6.96
     rank  7: 9.34
     rank  8: 4.82
     rank  9: 5.11
     rank 10: 4.44
     rank 11: 4.54
  backward-recv:
     rank  0: 499.50
     rank  1: 499.15
     rank  2: 492.50
     rank  3: 493.48
     rank  4: 199.72
     rank  5: 200.57
     rank  6: 192.67
     rank  7: 193.33
     rank  8: 93.11
     rank  9: 92.50
     rank 10: 82.30
     rank 11: 81.68
  backward-send:
     rank  4: 8.25
     rank  5: 8.06
     rank  6: 7.95
     rank  7: 8.25
     rank  8: 5.07
     rank  9: 5.43
     rank 10: 4.76
     rank 11: 5.20
     rank 12: 5.27
     rank 13: 5.01
     rank 14: 5.28
     rank 15: 5.01
  forward-send-backward-recv:
     rank  0: 1241.85
     rank  1: 1244.61
     rank  2: 1372.71
     rank  3: 1373.89
     rank  4: 423.56
     rank  5: 429.95
     rank  6: 458.19
     rank  7: 461.51
     rank  8: 317.51
     rank  9: 300.13
     rank 10: 229.12
     rank 11: 228.89
  backward-send-forward-recv:
     rank  4: 67.11
     rank  5: 67.76
     rank  6: 49.95
     rank  7: 50.30
     rank  8: 61.40
     rank  9: 62.51
     rank 10: 52.42
     rank 11: 54.72
     rank 12: 129.47
     rank 13: 120.55
     rank 14: 205.10
     rank 15: 207.32
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.04
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.04
     rank  2: 0.05
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.06
     rank 13: 0.06
     rank 14: 0.10
     rank 15: 0.06
  all-grads-sync:
     rank  0: 255.44
     rank  1: 255.50
     rank  2: 255.41
     rank  3: 255.50
     rank  4: 446.53
     rank  5: 446.53
     rank  6: 446.53
     rank  7: 446.54
     rank  8: 281.48
     rank  9: 277.19
     rank 10: 281.49
     rank 11: 277.18
     rank 12: 459.00
     rank 13: 438.40
     rank 14: 458.80
     rank 15: 438.39
  optimizer-copy-to-main-grad:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.04
     rank  9: 0.03
     rank 10: 0.05
     rank 11: 0.04
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.08
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 31.81
     rank  1: 31.71
     rank  2: 31.76
     rank  3: 31.76
     rank  4: 54.07
     rank  5: 54.09
     rank  6: 54.00
     rank  7: 54.17
     rank  8: 52.20
     rank  9: 51.99
     rank 10: 52.14
     rank 11: 52.22
     rank 12: 54.50
     rank 13: 54.55
     rank 14: 54.73
     rank 15: 54.56
  optimizer:
     rank  0: 32.57
     rank  1: 32.46
     rank  2: 32.51
     rank  3: 32.51
     rank  4: 54.82
     rank  5: 54.84
     rank  6: 54.76
     rank  7: 54.92
     rank  8: 52.95
     rank  9: 52.74
     rank 10: 52.89
     rank 11: 53.11
     rank 12: 55.26
     rank 13: 55.30
     rank 14: 55.47
     rank 15: 55.31
 [2024-12-30 23:02:15] iteration        9/      10 | consumed samples:          288 | elapsed time per iteration (ms): 4596.5 | learning rate: 6.750000E-06 | global batch size:    32 | lm loss: 2.178279E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4506.95
     rank  1: 4506.95
     rank  2: 4506.93
     rank  3: 4506.92
     rank  4: 4509.15
     rank  5: 4509.13
     rank  6: 4509.10
     rank  7: 4509.14
     rank  8: 4508.91
     rank  9: 4508.92
     rank 10: 4508.86
     rank 11: 4508.91
     rank 12: 4509.33
     rank 13: 4509.56
     rank 14: 4509.40
     rank 15: 4509.49
  forward-compute:
     rank  0: 1475.11
     rank  1: 1474.14
     rank  2: 1420.62
     rank  3: 1422.30
     rank  4: 1342.05
     rank  5: 1342.29
     rank  6: 1339.34
     rank  7: 1337.28
     rank  8: 1252.40
     rank  9: 1247.89
     rank 10: 1288.76
     rank 11: 1285.00
     rank 12: 1393.41
     rank 13: 1403.75
     rank 14: 1324.95
     rank 15: 1324.49
  backward-compute:
     rank  0: 791.92
     rank  1: 793.75
     rank  2: 802.39
     rank  3: 797.09
     rank  4: 1804.43
     rank  5: 1798.71
     rank  6: 1807.95
     rank  7: 1805.40
     rank  8: 1934.22
     rank  9: 1954.41
     rank 10: 2018.66
     rank 11: 2023.17
     rank 12: 1944.55
     rank 13: 1942.82
     rank 14: 1949.22
     rank 15: 1947.97
  pure-backward-compute:
     rank  0: 790.98
     rank  1: 792.96
     rank  2: 801.46
     rank  3: 796.18
     rank  4: 1802.84
     rank  5: 1797.10
     rank  6: 1806.52
     rank  7: 1803.44
     rank  8: 1932.64
     rank  9: 1952.87
     rank 10: 2017.17
     rank 11: 2021.57
     rank 12: 1941.88
     rank 13: 1939.59
     rank 14: 1946.56
     rank 15: 1944.76
  batch-generator:
     rank  0: 57.47
     rank  1: 57.01
     rank  2: 56.38
     rank  3: 61.18
     rank  4: 60.79
     rank  5: 63.44
     rank  6: 57.91
     rank  7: 54.98
     rank  8: 55.90
     rank  9: 51.21
     rank 10: 56.62
     rank 11: 53.15
     rank 12: 62.99
     rank 13: 82.33
     rank 14: 62.84
     rank 15: 61.93
  forward-recv:
     rank  4: 123.29
     rank  5: 122.23
     rank  6: 112.00
     rank  7: 110.87
     rank  8: 204.85
     rank  9: 204.46
     rank 10: 194.31
     rank 11: 194.48
     rank 12: 263.12
     rank 13: 263.16
     rank 14: 252.19
     rank 15: 252.26
  forward-send:
     rank  0: 7.42
     rank  1: 6.68
     rank  2: 8.03
     rank  3: 7.61
     rank  4: 5.84
     rank  5: 5.46
     rank  6: 5.43
     rank  7: 5.88
     rank  8: 4.95
     rank  9: 5.02
     rank 10: 2.78
     rank 11: 2.86
  backward-recv:
     rank  0: 499.35
     rank  1: 498.70
     rank  2: 497.67
     rank  3: 498.63
     rank  4: 201.39
     rank  5: 202.12
     rank  6: 200.29
     rank  7: 200.76
     rank  8: 93.07
     rank  9: 92.08
     rank 10: 77.59
     rank 11: 76.97
  backward-send:
     rank  4: 8.17
     rank  5: 8.12
     rank  6: 7.73
     rank  7: 8.16
     rank  8: 4.95
     rank  9: 5.32
     rank 10: 4.67
     rank 11: 5.09
     rank 12: 5.03
     rank 13: 4.51
     rank 14: 5.11
     rank 15: 5.19
  forward-send-backward-recv:
     rank  0: 1252.21
     rank  1: 1253.83
     rank  2: 1305.24
     rank  3: 1308.79
     rank  4: 420.93
     rank  5: 426.79
     rank  6: 461.06
     rank  7: 463.88
     rank  8: 305.83
     rank  9: 289.19
     rank 10: 229.05
     rank 11: 228.44
  backward-send-forward-recv:
     rank  4: 66.87
     rank  5: 67.27
     rank  6: 47.25
     rank  7: 49.10
     rank  8: 59.31
     rank  9: 61.74
     rank 10: 52.13
     rank 11: 52.85
     rank 12: 129.82
     rank 13: 120.90
     rank 14: 204.66
     rank 15: 206.35
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.06
     rank 13: 0.08
     rank 14: 0.06
     rank 15: 0.06
  all-grads-sync:
     rank  0: 254.06
     rank  1: 254.15
     rank  2: 254.07
     rank  3: 254.15
     rank  4: 447.43
     rank  5: 447.37
     rank  6: 447.43
     rank  7: 447.37
     rank  8: 278.59
     rank  9: 275.81
     rank 10: 278.60
     rank 11: 275.80
     rank 12: 463.09
     rank 13: 441.02
     rank 14: 463.08
     rank 15: 440.90
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.04
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.04
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.04
     rank 13: 0.08
     rank 14: 0.04
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 31.71
     rank  1: 31.68
     rank  2: 31.75
     rank  3: 31.72
     rank  4: 54.05
     rank  5: 54.04
     rank  6: 54.05
     rank  7: 54.03
     rank  8: 52.18
     rank  9: 52.17
     rank 10: 52.06
     rank 11: 52.25
     rank 12: 54.54
     rank 13: 54.53
     rank 14: 54.50
     rank 15: 54.61
  optimizer:
     rank  0: 32.43
     rank  1: 32.39
     rank  2: 32.47
     rank  3: 32.44
     rank  4: 54.78
     rank  5: 54.77
     rank  6: 54.77
     rank  7: 54.76
     rank  8: 52.90
     rank  9: 52.89
     rank 10: 52.78
     rank 11: 52.97
     rank 12: 55.26
     rank 13: 55.24
     rank 14: 55.22
     rank 15: 55.33
 [2024-12-30 23:02:20] iteration       10/      10 | consumed samples:          320 | elapsed time per iteration (ms): 4638.1 | learning rate: 7.500000E-06 | global batch size:    32 | lm loss: 1.004962E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4548.98
     rank  1: 4549.00
     rank  2: 4548.97
     rank  3: 4549.08
     rank  4: 4551.18
     rank  5: 4551.15
     rank  6: 4551.14
     rank  7: 4551.20
     rank  8: 4550.94
     rank  9: 4550.92
     rank 10: 4551.04
     rank 11: 4550.96
     rank 12: 4551.37
     rank 13: 4551.36
     rank 14: 4551.45
     rank 15: 4551.35
  forward-compute:
     rank  0: 1331.39
     rank  1: 1329.48
     rank  2: 1395.15
     rank  3: 1393.34
     rank  4: 1346.41
     rank  5: 1345.36
     rank  6: 1341.00
     rank  7: 1333.73
     rank  8: 1254.70
     rank  9: 1250.92
     rank 10: 1302.36
     rank 11: 1298.63
     rank 12: 1427.84
     rank 13: 1435.45
     rank 14: 1311.30
     rank 15: 1309.76
  backward-compute:
     rank  0: 784.04
     rank  1: 787.29
     rank  2: 805.79
     rank  3: 800.01
     rank  4: 1813.39
     rank  5: 1807.79
     rank  6: 1804.36
     rank  7: 1802.21
     rank  8: 1935.28
     rank  9: 1949.29
     rank 10: 2040.49
     rank 11: 2045.57
     rank 12: 1949.82
     rank 13: 1947.71
     rank 14: 1951.63
     rank 15: 1949.93
  pure-backward-compute:
     rank  0: 783.21
     rank  1: 786.52
     rank  2: 805.00
     rank  3: 798.82
     rank  4: 1811.87
     rank  5: 1806.13
     rank  6: 1802.91
     rank  7: 1800.55
     rank  8: 1933.64
     rank  9: 1947.74
     rank 10: 2038.95
     rank 11: 2043.93
     rank 12: 1947.13
     rank 13: 1944.46
     rank 14: 1948.98
     rank 15: 1946.71
  batch-generator:
     rank  0: 48.16
     rank  1: 45.42
     rank  2: 46.89
     rank  3: 54.84
     rank  4: 58.31
     rank  5: 57.76
     rank  6: 56.09
     rank  7: 50.99
     rank  8: 55.89
     rank  9: 51.61
     rank 10: 58.18
     rank 11: 53.70
     rank 12: 58.04
     rank 13: 75.95
     rank 14: 62.52
     rank 15: 60.36
  forward-recv:
     rank  4: 93.93
     rank  5: 93.83
     rank  6: 91.42
     rank  7: 93.50
     rank  8: 188.11
     rank  9: 187.66
     rank 10: 182.95
     rank 11: 184.17
     rank 12: 254.79
     rank 13: 255.18
     rank 14: 256.36
     rank 15: 256.37
  forward-send:
     rank  0: 19.36
     rank  1: 19.30
     rank  2: 18.35
     rank  3: 22.00
     rank  4: 8.96
     rank  5: 9.16
     rank  6: 7.59
     rank  7: 8.99
     rank  8: 4.74
     rank  9: 5.08
     rank 10: 4.34
     rank 11: 4.25
  backward-recv:
     rank  0: 508.20
     rank  1: 507.62
     rank  2: 498.14
     rank  3: 498.33
     rank  4: 205.72
     rank  5: 205.85
     rank  6: 197.34
     rank  7: 197.55
     rank  8: 94.79
     rank  9: 94.05
     rank 10: 78.96
     rank 11: 78.10
  backward-send:
     rank  4: 8.18
     rank  5: 8.16
     rank  6: 7.69
     rank  7: 8.25
     rank  8: 5.07
     rank  9: 5.40
     rank 10: 4.80
     rank 11: 5.20
     rank 12: 5.28
     rank 13: 5.01
     rank 14: 5.30
     rank 15: 5.06
  forward-send-backward-recv:
     rank  0: 1407.19
     rank  1: 1406.96
     rank  2: 1340.65
     rank  3: 1343.44
     rank  4: 453.07
     rank  5: 457.61
     rank  6: 509.86
     rank  7: 512.18
     rank  8: 345.13
     rank  9: 335.17
     rank 10: 226.57
     rank 11: 226.12
  backward-send-forward-recv:
     rank  4: 67.13
     rank  5: 67.66
     rank  6: 44.40
     rank  7: 47.27
     rank  8: 57.01
     rank  9: 58.35
     rank 10: 50.19
     rank 11: 49.75
     rank 12: 123.93
     rank 13: 117.48
     rank 14: 236.62
     rank 15: 239.73
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.05
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.07
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.04
     rank 11: 0.02
     rank 12: 0.06
     rank 13: 0.06
     rank 14: 0.07
     rank 15: 0.06
  all-grads-sync:
     rank  0: 258.54
     rank  1: 258.68
     rank  2: 258.59
     rank  3: 258.63
     rank  4: 444.96
     rank  5: 444.93
     rank  6: 444.97
     rank  7: 444.93
     rank  8: 275.09
     rank  9: 273.19
     rank 10: 274.85
     rank 11: 273.19
     rank 12: 482.01
     rank 13: 458.23
     rank 14: 482.02
     rank 15: 458.23
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.04
     rank  4: 0.11
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.04
     rank  8: 0.04
     rank  9: 0.03
     rank 10: 0.07
     rank 11: 0.04
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 31.71
     rank  1: 31.69
     rank  2: 31.75
     rank  3: 31.87
     rank  4: 54.11
     rank  5: 54.01
     rank  6: 54.03
     rank  7: 54.06
     rank  8: 52.23
     rank  9: 52.00
     rank 10: 52.37
     rank 11: 52.03
     rank 12: 54.46
     rank 13: 54.43
     rank 14: 54.51
     rank 15: 54.49
  optimizer:
     rank  0: 32.50
     rank  1: 32.48
     rank  2: 32.54
     rank  3: 32.67
     rank  4: 54.90
     rank  5: 54.80
     rank  6: 54.82
     rank  7: 54.85
     rank  8: 53.02
     rank  9: 52.79
     rank 10: 53.16
     rank 11: 52.81
     rank 12: 55.26
     rank 13: 55.22
     rank 14: 55.29
     rank 15: 55.28
