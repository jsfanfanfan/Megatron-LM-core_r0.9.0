examples/multimodal/pretrain-freeze-llm-homo.sh: line 4: activate: No such file or directory
[2024-12-30 21:35:55,509] torch.distributed.run: [WARNING] 
[2024-12-30 21:35:55,509] torch.distributed.run: [WARNING] *****************************************
[2024-12-30 21:35:55,509] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-12-30 21:35:55,509] torch.distributed.run: [WARNING] *****************************************
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
> setting tensorboard ...
WARNING: one_logger package is required to enable e2e metrics tracking. please go to https://confluence.nvidia.com/display/MLWFO/Package+Repositories for details to install it
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
---Rank 15---Tensor Parallel Group GPUs: [0]
---Rank 13---Tensor Parallel Group GPUs: [0]
---Rank 12---Tensor Parallel Group GPUs: [0]---Rank 15---Pipeline Parallel Group GPUs: [3, 3, 3, 3]

---Rank 13---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
---Rank 12---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
---Rank 14---Tensor Parallel Group GPUs: [0]
---Rank 14---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
[rank12]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank15]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank13]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank14]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
 > number of parameters on (tensor, pipeline) model parallel rank (0, 3): 1006669824
INFO:megatron.core.distributed.param_and_grad_buffer:Number of buckets for gradient all-reduce / reduce-scatter: 1
Params for bucket 1 (1006669824 elements):
	language_model.decoder.layers.3.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.3.self_attention.linear_qkv.weight
	language_model.decoder.layers.3.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.1.self_attention.linear_qkv.weight
	language_model.decoder.layers.0.self_attention.linear_qkv.weight
	language_model.decoder.layers.3.mlp.linear_fc1.weight
	language_model.decoder.layers.3.mlp.linear_fc2.weight
	language_model.decoder.layers.2.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.1.mlp.linear_fc1.weight
	language_model.decoder.layers.0.mlp.linear_fc1.layer_norm_weight
	language_model.output_layer.weight
	language_model.decoder.layers.2.mlp.linear_fc1.weight
	language_model.decoder.layers.2.self_attention.linear_qkv.weight
	language_model.decoder.layers.1.mlp.linear_fc2.weight
	language_model.decoder.layers.0.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.2.mlp.linear_fc2.weight
	language_model.decoder.layers.1.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.0.mlp.linear_fc2.weight
	language_model.decoder.final_layernorm.weight
	language_model.decoder.layers.1.self_attention.linear_proj.weight
	language_model.decoder.layers.2.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.0.mlp.linear_fc1.weight
	language_model.decoder.layers.3.self_attention.linear_proj.weight
	language_model.decoder.layers.2.self_attention.linear_proj.weight
	language_model.decoder.layers.1.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.0.self_attention.linear_proj.weight
rank=2, worker=0: shard_range=[pretrain-31.tar[0, 100), pretrain-31.tar[100, 200), pretrain-31.tar[200, 300), ...<619>, pretrain-37.tar[2200, 2300), pretrain-37.tar[2300, 2400), pretrain-37.tar[2400, 2500)] sum(count)=62500
rank=2, worker=1: shard_range=[pretrain-37.tar[2500, 2600), pretrain-37.tar[2600, 2700), pretrain-37.tar[2700, 2800), ...<619>, pretrain-42.tar[4700, 4800), pretrain-42.tar[4800, 4900), pretrain-42.tar[4900, 5000)] sum(count)=62500
rank=0, worker=0: shard_range=[pretrain-0.tar[0, 100), pretrain-0.tar[100, 200), pretrain-0.tar[200, 300), ...<619>, pretrain-14.tar[2200, 2300), pretrain-14.tar[2300, 2400), pretrain-14.tar[2400, 2500)] sum(count)=62500
rank=0, worker=1: shard_range=[pretrain-14.tar[2500, 2600), pretrain-14.tar[2600, 2700), pretrain-14.tar[2700, 2800), ...<619>, pretrain-2.tar[4700, 4800), pretrain-2.tar[4800, 4900), pretrain-2.tar[4900, 5000)] sum(count)=62500
rank=1, worker=0: shard_range=[pretrain-2.tar[5000, 5100), pretrain-2.tar[5100, 5200), pretrain-2.tar[5200, 5300), ...<619>, pretrain-25.tar[7200, 7300), pretrain-25.tar[7300, 7400), pretrain-25.tar[7400, 7500)] sum(count)=62500
rank=1, worker=1: shard_range=[pretrain-25.tar[7500, 7600), pretrain-25.tar[7600, 7700), pretrain-25.tar[7700, 7800), ...<619>, pretrain-30.tar[9700, 9800), pretrain-30.tar[9800, 9900), pretrain-30.tar[9900, 10000)] sum(count)=62500
rank=3, worker=0: shard_range=[pretrain-42.tar[5000, 5100), pretrain-42.tar[5100, 5200), pretrain-42.tar[5200, 5300), ...<619>, pretrain-48.tar[7200, 7300), pretrain-48.tar[7300, 7400), pretrain-48.tar[7400, 7500)] sum(count)=62500
rank=3, worker=1: shard_range=[pretrain-48.tar[7500, 7600), pretrain-48.tar[7600, 7700), pretrain-48.tar[7700, 7800), ...<619>, pretrain-53.tar[9700, 9800), pretrain-53.tar[9800, 9900), pretrain-53.tar[9900, 10000)] sum(count)=62500
rank=2, worker=0: shard_range=[pretrain-7.tar[936, 8202)] sum(count)=7266
rank=2, worker=1: shard_range=[pretrain-7.tar[8202, 10000), pretrain-8.tar[0, 5468)] sum(count)=7266
rank=0, worker=0: shard_range=[pretrain-54.tar[0, 7266)] sum(count)=7266
rank=0, worker=1: shard_range=[pretrain-54.tar[7266, 10000), pretrain-55.tar[0, 4532)] sum(count)=7266
rank=3, worker=0: shard_range=[pretrain-8.tar[5468, 10000), pretrain-9.tar[0, 2734)] sum(count)=7266
rank=3, worker=1: shard_range=[pretrain-9.tar[2734, 10000)] sum(count)=7266
rank=1, worker=0: shard_range=[pretrain-55.tar[4532, 8128), pretrain-6.tar[0, 3670)] sum(count)=7266
rank=1, worker=1: shard_range=[pretrain-6.tar[3670, 10000), pretrain-7.tar[0, 936)] sum(count)=7266
times across ranks (ms):
  model-and-optimizer-setup:
     rank  0: 115.97
     rank  1: 119.89
     rank  2: 80.38
     rank  3: 83.87
     rank  4: 57.39
     rank  5: 44.82
     rank  6: 56.65
     rank  7: 64.12
     rank  8: 32.00
     rank  9: 47.84
     rank 10: 47.88
     rank 11: 47.97
     rank 12: 49.66
     rank 13: 56.08
     rank 14: 30.38
     rank 15: 49.66
  train/valid/test-data-iterators-setup:
     rank  0: 1156.11
     rank  1: 1244.24
     rank  2: 1244.12
     rank  3: 1244.09
     rank  4: 1274.34
     rank  5: 1274.25
     rank  6: 1274.36
     rank  7: 1274.29
     rank  8: 1274.40
     rank  9: 1274.38
     rank 10: 1274.40
     rank 11: 1274.51
     rank 12: 1274.44
     rank 13: 1274.94
     rank 14: 1274.47
     rank 15: 1274.52
 [2024-12-30 21:36:35] iteration        1/      10 | consumed samples:           32 | elapsed time per iteration (ms): 13850.5 | learning rate: 7.500000E-07 | global batch size:    32 | lm loss: 7.114373E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
stage4 GPU utialization:170.9298393943093 %
[Rank 12] (after 1 iterations) memory (MB) | allocated: 15413.8154296875 | max allocated: 19253.537109375 | reserved: 20410.0 | max reserved: 20410.0
times across ranks (ms):
  forward-backward:
     rank  0: 13613.17
     rank  1: 13613.15
     rank  2: 13613.17
     rank  3: 13613.14
     rank  4: 13622.03
     rank  5: 13622.00
     rank  6: 13622.02
     rank  7: 13622.05
     rank  8: 13620.90
     rank  9: 13620.84
     rank 10: 13620.84
     rank 11: 13620.95
     rank 12: 13621.92
     rank 13: 13621.93
     rank 14: 13621.91
     rank 15: 13622.02
  forward-compute:
     rank  0: 4364.31
     rank  1: 4223.20
     rank  2: 3992.29
     rank  3: 3932.02
     rank  4: 2628.82
     rank  5: 2412.07
     rank  6: 2681.92
     rank  7: 2724.74
     rank  8: 2240.95
     rank  9: 2453.18
     rank 10: 2323.36
     rank 11: 2626.10
     rank 12: 3009.81
     rank 13: 3118.56
     rank 14: 3287.58
     rank 15: 2975.29
  backward-compute:
     rank  0: 44.24
     rank  1: 45.23
     rank  2: 44.04
     rank  3: 42.29
     rank  4: 1069.49
     rank  5: 1064.03
     rank  6: 1055.11
     rank  7: 1066.69
     rank  8: 1047.68
     rank  9: 1040.19
     rank 10: 1037.29
     rank 11: 1046.84
     rank 12: 1227.40
     rank 13: 1237.49
     rank 14: 1228.45
     rank 15: 1233.42
  pure-backward-compute:
     rank  0: 43.82
     rank  1: 44.80
     rank  2: 43.54
     rank  3: 41.84
     rank  4: 1068.74
     rank  5: 1062.95
     rank  6: 1054.29
     rank  7: 1065.79
     rank  8: 1046.35
     rank  9: 1039.23
     rank 10: 1036.48
     rank 11: 1045.96
     rank 12: 1225.79
     rank 13: 1235.77
     rank 14: 1226.91
     rank 15: 1231.17
  batch-generator:
     rank  0: 1093.10
     rank  1: 1115.87
     rank  2: 867.53
     rank  3: 860.47
     rank  4: 1000.26
     rank  5: 1106.21
     rank  6: 1094.39
     rank  7: 1056.36
     rank  8: 930.80
     rank  9: 852.53
     rank 10: 973.01
     rank 11: 1006.59
     rank 12: 993.68
     rank 13: 1034.27
     rank 14: 1008.80
     rank 15: 955.96
  forward-recv:
     rank  4: 4143.36
     rank  5: 4031.96
     rank  6: 3722.45
     rank  7: 3701.44
     rank  8: 6302.12
     rank  9: 5974.17
     rank 10: 5943.46
     rank 11: 5955.80
     rank 12: 8095.89
     rank 13: 7981.85
     rank 14: 7820.89
     rank 15: 8125.87
  forward-send:
     rank  0: 4015.67
     rank  1: 4014.18
     rank  2: 4137.90
     rank  3: 4481.37
     rank  4: 1746.35
     rank  5: 1960.28
     rank  6: 1833.31
     rank  7: 2122.28
     rank  8: 26.52
     rank  9: 26.76
     rank 10: 27.57
     rank 11: 17.92
  backward-recv:
     rank  0: 703.48
     rank  1: 703.36
     rank  2: 709.20
     rank  3: 703.77
     rank  4: 212.44
     rank  5: 215.23
     rank  6: 217.41
     rank  7: 212.83
     rank  8: 105.88
     rank  9: 107.65
     rank 10: 108.85
     rank 11: 106.39
  backward-send:
     rank  4: 4.46
     rank  5: 3.27
     rank  6: 2.59
     rank  7: 4.56
     rank  8: 6.88
     rank  9: 7.15
     rank 10: 3.74
     rank 11: 7.17
     rank 12: 4.68
     rank 13: 4.98
     rank 14: 4.26
     rank 15: 4.99
  forward-send-backward-recv:
     rank  0: 3535.36
     rank  1: 3676.41
     rank  2: 3773.28
     rank  3: 3503.79
     rank  4: 2828.09
     rank  5: 2941.52
     rank  6: 3115.07
     rank  7: 2801.09
     rank  8: 2737.65
     rank  9: 2861.84
     rank 10: 3033.74
     rank 11: 2715.40
  backward-send-forward-recv:
     rank  4: 21.45
     rank  5: 24.92
     rank  6: 21.62
     rank  7: 21.81
     rank  8: 53.79
     rank  9: 51.56
     rank 10: 40.53
     rank 11: 47.16
     rank 12: 50.71
     rank 13: 46.20
     rank 14: 46.79
     rank 15: 49.27
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.04
     rank  2: 0.05
     rank  3: 0.04
     rank  4: 0.04
     rank  5: 0.02
     rank  6: 0.05
     rank  7: 0.03
     rank  8: 0.06
     rank  9: 0.05
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.06
  embedding-grads-all-reduce:
     rank  0: 0.07
     rank  1: 0.07
     rank  2: 0.09
     rank  3: 0.07
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.05
     rank  9: 0.04
     rank 10: 0.03
     rank 11: 0.04
     rank 12: 0.09
     rank 13: 0.09
     rank 14: 0.09
     rank 15: 0.14
  all-grads-sync:
     rank  0: 174.72
     rank  1: 174.71
     rank  2: 174.71
     rank  3: 174.72
     rank  4: 945.13
     rank  5: 945.06
     rank  6: 945.12
     rank  7: 945.13
     rank  8: 859.86
     rank  9: 859.79
     rank 10: 859.78
     rank 11: 859.80
     rank 12: 813.86
     rank 13: 813.87
     rank 14: 813.85
     rank 15: 813.75
  optimizer-copy-to-main-grad:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.04
     rank  3: 0.03
     rank  4: 0.12
     rank  5: 0.04
     rank  6: 0.06
     rank  7: 0.04
     rank  8: 0.08
     rank  9: 0.07
     rank 10: 0.06
     rank 11: 0.13
     rank 12: 0.06
     rank 13: 0.07
     rank 14: 0.07
     rank 15: 0.09
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 9.88
     rank  1: 9.90
     rank  2: 9.91
     rank  3: 9.80
     rank  4: 218.84
     rank  5: 221.70
     rank  6: 219.76
     rank  7: 221.68
     rank  8: 115.91
     rank  9: 107.61
     rank 10: 107.64
     rank 11: 108.48
     rank 12: 126.10
     rank 13: 133.96
     rank 14: 134.24
     rank 15: 130.08
  optimizer:
     rank  0: 11.07
     rank  1: 11.08
     rank  2: 11.10
     rank  3: 10.98
     rank  4: 220.05
     rank  5: 222.89
     rank  6: 220.94
     rank  7: 222.88
     rank  8: 117.10
     rank  9: 108.80
     rank 10: 108.83
     rank 11: 109.66
     rank 12: 127.30
     rank 13: 135.19
     rank 14: 135.43
     rank 15: 131.27
 [2024-12-30 21:36:39] iteration        2/      10 | consumed samples:           64 | elapsed time per iteration (ms): 3427.1 | learning rate: 1.500000E-06 | global batch size:    32 | lm loss: 7.105109E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 3281.31
     rank  1: 3281.25
     rank  2: 3281.24
     rank  3: 3281.25
     rank  4: 3290.03
     rank  5: 3289.95
     rank  6: 3291.61
     rank  7: 3289.97
     rank  8: 3288.69
     rank  9: 3288.68
     rank 10: 3288.70
     rank 11: 3288.74
     rank 12: 3289.93
     rank 13: 3289.95
     rank 14: 3289.94
     rank 15: 3290.01
  forward-compute:
     rank  0: 383.73
     rank  1: 374.61
     rank  2: 392.27
     rank  3: 375.58
     rank  4: 543.33
     rank  5: 584.40
     rank  6: 582.07
     rank  7: 539.38
     rank  8: 537.04
     rank  9: 526.92
     rank 10: 526.22
     rank 11: 534.50
     rank 12: 683.05
     rank 13: 716.79
     rank 14: 716.57
     rank 15: 647.87
  backward-compute:
     rank  0: 43.24
     rank  1: 42.42
     rank  2: 44.80
     rank  3: 41.21
     rank  4: 1280.56
     rank  5: 1225.30
     rank  6: 1212.72
     rank  7: 1303.97
     rank  8: 1040.65
     rank  9: 1031.45
     rank 10: 1030.92
     rank 11: 1043.35
     rank 12: 1217.60
     rank 13: 1228.26
     rank 14: 1223.06
     rank 15: 1238.33
  pure-backward-compute:
     rank  0: 42.85
     rank  1: 42.08
     rank  2: 44.42
     rank  3: 40.82
     rank  4: 1279.85
     rank  5: 1224.54
     rank  6: 1212.05
     rank  7: 1303.48
     rank  8: 1039.46
     rank  9: 1030.69
     rank 10: 1030.09
     rank 11: 1042.50
     rank 12: 1215.97
     rank 13: 1226.14
     rank 14: 1221.52
     rank 15: 1236.10
  batch-generator:
     rank  0: 22.02
     rank  1: 22.13
     rank  2: 24.80
     rank  3: 21.31
     rank  4: 29.96
     rank  5: 34.83
     rank  6: 29.33
     rank  7: 26.09
     rank  8: 31.08
     rank  9: 28.44
     rank 10: 27.58
     rank 11: 29.38
     rank 12: 29.58
     rank 13: 29.44
     rank 14: 32.43
     rank 15: 28.57
  forward-recv:
     rank  4: 50.68
     rank  5: 47.66
     rank  6: 53.03
     rank  7: 50.44
     rank  8: 120.91
     rank  9: 115.63
     rank 10: 122.80
     rank 11: 120.97
     rank 12: 189.76
     rank 13: 181.35
     rank 14: 189.40
     rank 15: 189.84
  forward-send:
     rank  0: 47.80
     rank  1: 38.82
     rank  2: 41.25
     rank  3: 50.39
     rank  4: 8.81
     rank  5: 3.18
     rank  6: 4.38
     rank  7: 9.57
     rank  8: 3.95
     rank  9: 1.60
     rank 10: 3.55
     rank 11: 4.10
  backward-recv:
     rank  0: 713.08
     rank  1: 728.40
     rank  2: 738.61
     rank  3: 695.82
     rank  4: 213.03
     rank  5: 213.87
     rank  6: 215.66
     rank  7: 215.35
     rank  8: 108.24
     rank  9: 108.32
     rank 10: 106.76
     rank 11: 107.95
  backward-send:
     rank  4: 3.74
     rank  5: 4.14
     rank  6: 3.39
     rank  7: 2.69
     rank  8: 3.75
     rank  9: 5.00
     rank 10: 5.60
     rank 11: 3.83
     rank 12: 1.89
     rank 13: 2.07
     rank 14: 1.82
     rank 15: 2.13
  forward-send-backward-recv:
     rank  0: 1290.62
     rank  1: 1294.67
     rank  2: 1261.01
     rank  3: 1317.81
     rank  4: 361.54
     rank  5: 384.28
     rank  6: 391.92
     rank  7: 345.24
     rank  8: 302.33
     rank  9: 352.44
     rank 10: 356.66
     rank 11: 289.75
  backward-send-forward-recv:
     rank  4: 7.96
     rank  5: 8.01
     rank  6: 6.30
     rank  7: 6.56
     rank  8: 219.25
     rank  9: 197.23
     rank 10: 185.23
     rank 11: 235.45
     rank 12: 112.07
     rank 13: 78.03
     rank 14: 74.75
     rank 15: 130.09
  layernorm-grads-all-reduce:
     rank  0: 0.10
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.12
     rank  1: 0.05
     rank  2: 0.06
     rank  3: 0.09
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.07
     rank 13: 0.07
     rank 14: 0.07
     rank 15: 0.08
  all-grads-sync:
     rank  0: 58.28
     rank  1: 58.33
     rank  2: 58.29
     rank  3: 58.21
     rank  4: 793.35
     rank  5: 793.32
     rank  6: 793.31
     rank  7: 793.33
     rank  8: 696.42
     rank  9: 696.43
     rank 10: 696.43
     rank 11: 696.31
     rank 12: 796.34
     rank 13: 796.34
     rank 14: 796.36
     rank 15: 796.35
  optimizer-copy-to-main-grad:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.06
     rank  5: 0.04
     rank  6: 0.04
     rank  7: 0.04
     rank  8: 0.05
     rank  9: 0.05
     rank 10: 0.04
     rank 11: 0.07
     rank 12: 0.05
     rank 13: 0.05
     rank 14: 0.10
     rank 15: 0.11
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.03
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 7.54
     rank  1: 7.38
     rank  2: 7.45
     rank  3: 7.49
     rank  4: 98.88
     rank  5: 98.60
     rank  6: 98.71
     rank  7: 98.71
     rank  8: 85.68
     rank  9: 85.67
     rank 10: 85.71
     rank 11: 85.84
     rank 12: 98.70
     rank 13: 98.88
     rank 14: 98.76
     rank 15: 98.77
  optimizer:
     rank  0: 8.41
     rank  1: 8.25
     rank  2: 8.32
     rank  3: 8.36
     rank  4: 99.75
     rank  5: 99.47
     rank  6: 99.57
     rank  7: 99.58
     rank  8: 86.55
     rank  9: 86.54
     rank 10: 86.58
     rank 11: 86.71
     rank 12: 99.58
     rank 13: 99.75
     rank 14: 99.64
     rank 15: 99.64
 [2024-12-30 21:36:42] iteration        3/      10 | consumed samples:           96 | elapsed time per iteration (ms): 3358.4 | learning rate: 2.250000E-06 | global batch size:    32 | lm loss: 6.628859E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 3216.67
     rank  1: 3216.67
     rank  2: 3216.70
     rank  3: 3216.68
     rank  4: 3225.40
     rank  5: 3225.43
     rank  6: 3225.45
     rank  7: 3225.42
     rank  8: 3224.20
     rank  9: 3224.20
     rank 10: 3224.22
     rank 11: 3224.21
     rank 12: 3225.35
     rank 13: 3225.36
     rank 14: 3225.34
     rank 15: 3225.37
  forward-compute:
     rank  0: 392.76
     rank  1: 382.34
     rank  2: 394.65
     rank  3: 385.23
     rank  4: 548.77
     rank  5: 538.51
     rank  6: 539.41
     rank  7: 550.90
     rank  8: 529.60
     rank  9: 530.28
     rank 10: 530.93
     rank 11: 530.73
     rank 12: 667.53
     rank 13: 664.33
     rank 14: 652.87
     rank 15: 651.40
  backward-compute:
     rank  0: 43.63
     rank  1: 40.75
     rank  2: 44.89
     rank  3: 40.86
     rank  4: 1052.06
     rank  5: 1050.41
     rank  6: 1046.80
     rank  7: 1055.38
     rank  8: 1037.06
     rank  9: 1031.38
     rank 10: 1030.83
     rank 11: 1038.69
     rank 12: 1216.87
     rank 13: 1229.79
     rank 14: 1233.15
     rank 15: 1235.49
  pure-backward-compute:
     rank  0: 43.26
     rank  1: 40.42
     rank  2: 44.54
     rank  3: 40.53
     rank  4: 1051.39
     rank  5: 1049.83
     rank  6: 1046.20
     rank  7: 1054.59
     rank  8: 1036.17
     rank  9: 1030.64
     rank 10: 1030.06
     rank 11: 1037.70
     rank 12: 1215.21
     rank 13: 1227.79
     rank 14: 1231.57
     rank 15: 1233.05
  batch-generator:
     rank  0: 23.21
     rank  1: 22.26
     rank  2: 21.64
     rank  3: 22.16
     rank  4: 32.78
     rank  5: 24.96
     rank  6: 27.60
     rank  7: 32.39
     rank  8: 24.95
     rank  9: 28.47
     rank 10: 28.38
     rank 11: 24.32
     rank 12: 31.46
     rank 13: 28.98
     rank 14: 30.50
     rank 15: 29.12
  forward-recv:
     rank  4: 55.32
     rank  5: 49.81
     rank  6: 55.83
     rank  7: 56.07
     rank  8: 125.90
     rank  9: 118.25
     rank 10: 126.37
     rank 11: 125.83
     rank 12: 191.68
     rank 13: 182.82
     rank 14: 191.93
     rank 15: 191.81
  forward-send:
     rank  0: 41.30
     rank  1: 37.43
     rank  2: 43.68
     rank  3: 44.87
     rank  4: 7.14
     rank  5: 3.28
     rank  6: 6.85
     rank  7: 7.05
     rank  8: 3.74
     rank  9: 1.58
     rank 10: 4.03
     rank 11: 3.84
  backward-recv:
     rank  0: 698.13
     rank  1: 703.90
     rank  2: 701.48
     rank  3: 704.38
     rank  4: 218.55
     rank  5: 220.15
     rank  6: 220.83
     rank  7: 217.71
     rank  8: 109.74
     rank  9: 107.11
     rank 10: 107.72
     rank 11: 106.94
  backward-send:
     rank  4: 2.59
     rank  5: 2.88
     rank  6: 2.85
     rank  7: 2.76
     rank  8: 3.01
     rank  9: 7.34
     rank 10: 6.76
     rank 11: 7.36
     rank 12: 1.90
     rank 13: 3.93
     rank 14: 3.89
     rank 15: 4.16
  forward-send-backward-recv:
     rank  0: 1206.03
     rank  1: 1222.34
     rank  2: 1201.83
     rank  3: 1212.58
     rank  4: 477.99
     rank  5: 504.32
     rank  6: 496.22
     rank  7: 480.50
     rank  8: 410.49
     rank  9: 429.07
     rank 10: 417.30
     rank 11: 412.92
  backward-send-forward-recv:
     rank  4: 11.59
     rank  5: 10.26
     rank  6: 9.51
     rank  7: 10.06
     rank  8: 21.71
     rank  9: 22.37
     rank 10: 23.27
     rank 11: 21.76
     rank 12: 31.04
     rank 13: 32.34
     rank 14: 31.28
     rank 15: 30.65
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.06
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.04
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.04
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.08
     rank  2: 0.07
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.04
     rank 12: 0.07
     rank 13: 0.07
     rank 14: 0.07
     rank 15: 0.07
  all-grads-sync:
     rank  0: 57.93
     rank  1: 57.90
     rank  2: 57.92
     rank  3: 57.95
     rank  4: 825.03
     rank  5: 825.04
     rank  6: 825.08
     rank  7: 825.04
     rank  8: 687.58
     rank  9: 687.60
     rank 10: 687.60
     rank 11: 687.58
     rank 12: 815.99
     rank 13: 816.03
     rank 14: 815.93
     rank 15: 816.03
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.05
     rank  7: 0.03
     rank  8: 0.08
     rank  9: 0.05
     rank 10: 0.04
     rank 11: 0.08
     rank 12: 0.05
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 7.38
     rank  1: 7.40
     rank  2: 7.49
     rank  3: 7.37
     rank  4: 98.66
     rank  5: 98.64
     rank  6: 98.78
     rank  7: 98.63
     rank  8: 85.72
     rank  9: 85.67
     rank 10: 85.65
     rank 11: 85.80
     rank 12: 98.76
     rank 13: 98.76
     rank 14: 98.73
     rank 15: 98.75
  optimizer:
     rank  0: 8.16
     rank  1: 8.18
     rank  2: 8.27
     rank  3: 8.15
     rank  4: 99.43
     rank  5: 99.42
     rank  6: 99.56
     rank  7: 99.41
     rank  8: 86.50
     rank  9: 86.46
     rank 10: 86.43
     rank 11: 86.63
     rank 12: 99.55
     rank 13: 99.54
     rank 14: 99.52
     rank 15: 99.53
 [2024-12-30 21:36:46] iteration        4/      10 | consumed samples:          128 | elapsed time per iteration (ms): 3370.4 | learning rate: 3.000000E-06 | global batch size:    32 | lm loss: 4.335878E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 3225.41
     rank  1: 3225.41
     rank  2: 3225.41
     rank  3: 3225.46
     rank  4: 3234.12
     rank  5: 3234.09
     rank  6: 3234.10
     rank  7: 3234.13
     rank  8: 3232.88
     rank  9: 3232.88
     rank 10: 3232.92
     rank 11: 3232.91
     rank 12: 3234.08
     rank 13: 3234.11
     rank 14: 3234.16
     rank 15: 3234.10
  forward-compute:
     rank  0: 392.23
     rank  1: 386.64
     rank  2: 380.51
     rank  3: 374.29
     rank  4: 536.69
     rank  5: 543.73
     rank  6: 531.90
     rank  7: 559.40
     rank  8: 528.24
     rank  9: 527.76
     rank 10: 531.64
     rank 11: 532.16
     rank 12: 658.05
     rank 13: 652.65
     rank 14: 662.25
     rank 15: 657.21
  backward-compute:
     rank  0: 43.78
     rank  1: 41.99
     rank  2: 43.68
     rank  3: 40.82
     rank  4: 1054.19
     rank  5: 1050.08
     rank  6: 1048.90
     rank  7: 1056.57
     rank  8: 1036.14
     rank  9: 1025.58
     rank 10: 1031.97
     rank 11: 1042.36
     rank 12: 1233.05
     rank 13: 1241.23
     rank 14: 1230.97
     rank 15: 1238.02
  pure-backward-compute:
     rank  0: 43.39
     rank  1: 41.65
     rank  2: 43.33
     rank  3: 40.49
     rank  4: 1053.66
     rank  5: 1049.50
     rank  6: 1048.39
     rank  7: 1055.53
     rank  8: 1035.23
     rank  9: 1024.84
     rank 10: 1031.29
     rank 11: 1041.35
     rank 12: 1231.39
     rank 13: 1239.25
     rank 14: 1229.26
     rank 15: 1236.05
  batch-generator:
     rank  0: 22.87
     rank  1: 22.91
     rank  2: 21.75
     rank  3: 21.31
     rank  4: 23.33
     rank  5: 27.38
     rank  6: 21.75
     rank  7: 38.26
     rank  8: 23.63
     rank  9: 28.42
     rank 10: 28.43
     rank 11: 24.49
     rank 12: 27.62
     rank 13: 27.37
     rank 14: 30.39
     rank 15: 31.41
  forward-recv:
     rank  4: 53.47
     rank  5: 52.36
     rank  6: 53.38
     rank  7: 49.14
     rank  8: 123.75
     rank  9: 121.31
     rank 10: 123.33
     rank 11: 118.52
     rank 12: 189.04
     rank 13: 188.08
     rank 14: 189.08
     rank 15: 182.90
  forward-send:
     rank  0: 41.18
     rank  1: 38.33
     rank  2: 46.69
     rank  3: 43.93
     rank  4: 6.31
     rank  5: 4.58
     rank  6: 7.28
     rank  7: 3.39
     rank  8: 3.61
     rank  9: 3.06
     rank 10: 3.67
     rank 11: 1.73
  backward-recv:
     rank  0: 711.11
     rank  1: 712.21
     rank  2: 713.29
     rank  3: 706.33
     rank  4: 221.86
     rank  5: 218.82
     rank  6: 220.57
     rank  7: 209.77
     rank  8: 108.50
     rank  9: 110.16
     rank 10: 106.26
     rank 11: 101.71
  backward-send:
     rank  4: 3.16
     rank  5: 3.79
     rank  6: 4.41
     rank  7: 3.35
     rank  8: 5.66
     rank  9: 4.17
     rank 10: 6.08
     rank 11: 3.87
     rank 12: 3.55
     rank 13: 3.65
     rank 14: 2.98
     rank 15: 1.93
  forward-send-backward-recv:
     rank  0: 1208.86
     rank  1: 1216.21
     rank  2: 1213.36
     rank  3: 1227.02
     rank  4: 506.12
     rank  5: 506.55
     rank  6: 517.26
     rank  7: 493.44
     rank  8: 426.25
     rank  9: 438.25
     rank 10: 435.47
     rank 11: 426.87
  backward-send-forward-recv:
     rank  4: 7.62
     rank  5: 8.01
     rank  6: 6.40
     rank  7: 8.94
     rank  8: 24.74
     rank  9: 24.56
     rank 10: 17.86
     rank 11: 24.39
     rank 12: 39.91
     rank 13: 37.80
     rank 14: 37.13
     rank 15: 38.61
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.08
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.05
     rank  2: 0.05
     rank  3: 0.10
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.07
     rank 13: 0.07
     rank 14: 0.07
     rank 15: 0.07
  all-grads-sync:
     rank  0: 57.87
     rank  1: 57.83
     rank  2: 57.86
     rank  3: 57.90
     rank  4: 824.23
     rank  5: 824.18
     rank  6: 824.15
     rank  7: 824.21
     rank  8: 688.53
     rank  9: 688.55
     rank 10: 688.55
     rank 11: 688.55
     rank 12: 818.20
     rank 13: 818.13
     rank 14: 818.20
     rank 15: 818.21
  optimizer-copy-to-main-grad:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.07
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.04
     rank  8: 0.05
     rank  9: 0.05
     rank 10: 0.05
     rank 11: 0.04
     rank 12: 0.05
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 7.42
     rank  1: 7.42
     rank  2: 7.38
     rank  3: 7.52
     rank  4: 98.71
     rank  5: 98.60
     rank  6: 98.68
     rank  7: 98.69
     rank  8: 85.65
     rank  9: 85.66
     rank 10: 85.65
     rank 11: 85.63
     rank 12: 98.75
     rank 13: 98.80
     rank 14: 98.79
     rank 15: 98.80
  optimizer:
     rank  0: 8.19
     rank  1: 8.19
     rank  2: 8.15
     rank  3: 8.29
     rank  4: 99.48
     rank  5: 99.38
     rank  6: 99.47
     rank  7: 99.47
     rank  8: 86.43
     rank  9: 86.43
     rank 10: 86.44
     rank 11: 86.41
     rank 12: 99.53
     rank 13: 99.57
     rank 14: 99.56
     rank 15: 99.67
 [2024-12-30 21:36:49] iteration        5/      10 | consumed samples:          160 | elapsed time per iteration (ms): 3318.6 | learning rate: 3.750000E-06 | global batch size:    32 | lm loss: 2.095671E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 3182.14
     rank  1: 3182.16
     rank  2: 3182.12
     rank  3: 3182.13
     rank  4: 3190.87
     rank  5: 3190.88
     rank  6: 3190.85
     rank  7: 3190.86
     rank  8: 3189.73
     rank  9: 3189.70
     rank 10: 3189.72
     rank 11: 3189.82
     rank 12: 3190.85
     rank 13: 3190.89
     rank 14: 3190.84
     rank 15: 3190.85
  forward-compute:
     rank  0: 392.53
     rank  1: 379.59
     rank  2: 379.79
     rank  3: 370.61
     rank  4: 536.71
     rank  5: 547.69
     rank  6: 541.46
     rank  7: 553.18
     rank  8: 525.15
     rank  9: 523.78
     rank 10: 533.10
     rank 11: 537.13
     rank 12: 666.53
     rank 13: 652.90
     rank 14: 661.61
     rank 15: 650.12
  backward-compute:
     rank  0: 41.64
     rank  1: 40.92
     rank  2: 44.15
     rank  3: 40.75
     rank  4: 1052.88
     rank  5: 1055.43
     rank  6: 1053.74
     rank  7: 1056.16
     rank  8: 1034.30
     rank  9: 1023.20
     rank 10: 1036.80
     rank 11: 1044.74
     rank 12: 1225.65
     rank 13: 1243.14
     rank 14: 1232.38
     rank 15: 1239.37
  pure-backward-compute:
     rank  0: 41.29
     rank  1: 40.58
     rank  2: 43.82
     rank  3: 40.43
     rank  4: 1052.41
     rank  5: 1054.70
     rank  6: 1053.17
     rank  7: 1055.06
     rank  8: 1033.31
     rank  9: 1022.65
     rank 10: 1036.09
     rank 11: 1043.68
     rank 12: 1224.35
     rank 13: 1241.51
     rank 14: 1231.09
     rank 15: 1237.82
  batch-generator:
     rank  0: 21.98
     rank  1: 22.50
     rank  2: 21.52
     rank  3: 21.25
     rank  4: 22.51
     rank  5: 31.37
     rank  6: 26.84
     rank  7: 33.38
     rank  8: 24.52
     rank  9: 26.98
     rank 10: 28.54
     rank 11: 27.33
     rank 12: 30.22
     rank 13: 29.00
     rank 14: 27.62
     rank 15: 22.92
  forward-recv:
     rank  4: 52.07
     rank  5: 49.00
     rank  6: 49.83
     rank  7: 51.58
     rank  8: 123.50
     rank  9: 119.56
     rank 10: 119.03
     rank 11: 122.60
     rank 12: 185.07
     rank 13: 181.15
     rank 14: 182.17
     rank 15: 185.53
  forward-send:
     rank  0: 43.70
     rank  1: 42.42
     rank  2: 42.83
     rank  3: 50.18
     rank  4: 5.35
     rank  5: 4.93
     rank  6: 4.98
     rank  7: 5.30
     rank  8: 2.37
     rank  9: 1.72
     rank 10: 1.86
     rank 11: 2.53
  backward-recv:
     rank  0: 704.72
     rank  1: 704.57
     rank  2: 706.03
     rank  3: 706.12
     rank  4: 208.73
     rank  5: 211.38
     rank  6: 214.29
     rank  7: 211.85
     rank  8: 104.27
     rank  9: 109.85
     rank 10: 107.13
     rank 11: 105.40
  backward-send:
     rank  4: 4.13
     rank  5: 4.15
     rank  6: 4.51
     rank  7: 4.18
     rank  8: 5.18
     rank  9: 3.91
     rank 10: 6.42
     rank 11: 6.04
     rank 12: 1.84
     rank 13: 3.47
     rank 14: 3.43
     rank 15: 3.09
  forward-send-backward-recv:
     rank  0: 1192.76
     rank  1: 1210.97
     rank  2: 1208.11
     rank  3: 1213.79
     rank  4: 501.63
     rank  5: 489.64
     rank  6: 498.18
     rank  7: 482.05
     rank  8: 419.13
     rank  9: 434.04
     rank 10: 413.62
     rank 11: 404.81
  backward-send-forward-recv:
     rank  4: 6.34
     rank  5: 8.73
     rank  6: 6.28
     rank  7: 8.75
     rank  8: 21.92
     rank  9: 22.64
     rank 10: 23.22
     rank 11: 17.24
     rank 12: 25.44
     rank 13: 27.69
     rank 14: 28.39
     rank 15: 29.00
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.04
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.07
     rank  1: 0.05
     rank  2: 0.04
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.04
     rank 12: 0.07
     rank 13: 0.07
     rank 14: 0.07
     rank 15: 0.05
  all-grads-sync:
     rank  0: 57.26
     rank  1: 57.27
     rank  2: 57.25
     rank  3: 57.22
     rank  4: 797.28
     rank  5: 797.28
     rank  6: 797.22
     rank  7: 797.25
     rank  8: 673.50
     rank  9: 673.53
     rank 10: 673.52
     rank 11: 673.54
     rank 12: 784.10
     rank 13: 784.11
     rank 14: 784.12
     rank 15: 784.07
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.04
     rank  8: 0.05
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.11
     rank 12: 0.05
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 7.50
     rank  1: 7.36
     rank  2: 7.37
     rank  3: 7.36
     rank  4: 98.65
     rank  5: 98.60
     rank  6: 98.65
     rank  7: 98.68
     rank  8: 85.70
     rank  9: 85.55
     rank 10: 85.69
     rank 11: 85.86
     rank 12: 98.74
     rank 13: 98.85
     rank 14: 98.80
     rank 15: 98.69
  optimizer:
     rank  0: 8.30
     rank  1: 8.16
     rank  2: 8.17
     rank  3: 8.15
     rank  4: 99.45
     rank  5: 99.40
     rank  6: 99.44
     rank  7: 99.48
     rank  8: 86.51
     rank  9: 86.35
     rank 10: 86.51
     rank 11: 86.66
     rank 12: 99.55
     rank 13: 99.64
     rank 14: 99.60
     rank 15: 99.49
 [2024-12-30 21:36:52] iteration        6/      10 | consumed samples:          192 | elapsed time per iteration (ms): 3348.8 | learning rate: 4.500000E-06 | global batch size:    32 | lm loss: 3.170696E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 3212.61
     rank  1: 3212.63
     rank  2: 3212.69
     rank  3: 3212.63
     rank  4: 3221.34
     rank  5: 3221.33
     rank  6: 3221.34
     rank  7: 3221.37
     rank  8: 3220.12
     rank  9: 3220.09
     rank 10: 3220.14
     rank 11: 3220.09
     rank 12: 3221.34
     rank 13: 3221.28
     rank 14: 3221.33
     rank 15: 3221.29
  forward-compute:
     rank  0: 387.35
     rank  1: 380.35
     rank  2: 387.12
     rank  3: 377.04
     rank  4: 536.24
     rank  5: 539.11
     rank  6: 544.04
     rank  7: 554.78
     rank  8: 525.17
     rank  9: 524.47
     rank 10: 533.64
     rank 11: 538.61
     rank 12: 655.32
     rank 13: 653.45
     rank 14: 653.78
     rank 15: 650.86
  backward-compute:
     rank  0: 40.79
     rank  1: 41.29
     rank  2: 44.27
     rank  3: 40.79
     rank  4: 1055.22
     rank  5: 1053.15
     rank  6: 1050.81
     rank  7: 1057.49
     rank  8: 1034.40
     rank  9: 1022.49
     rank 10: 1037.28
     rank 11: 1043.69
     rank 12: 1236.66
     rank 13: 1240.48
     rank 14: 1236.47
     rank 15: 1238.96
  pure-backward-compute:
     rank  0: 40.45
     rank  1: 40.96
     rank  2: 43.90
     rank  3: 40.45
     rank  4: 1054.68
     rank  5: 1052.67
     rank  6: 1050.21
     rank  7: 1056.46
     rank  8: 1033.52
     rank  9: 1021.92
     rank 10: 1036.60
     rank 11: 1042.67
     rank 12: 1235.02
     rank 13: 1239.02
     rank 14: 1235.20
     rank 15: 1237.42
  batch-generator:
     rank  0: 22.23
     rank  1: 22.31
     rank  2: 21.91
     rank  3: 21.04
     rank  4: 22.38
     rank  5: 24.46
     rank  6: 28.62
     rank  7: 36.69
     rank  8: 23.01
     rank  9: 26.68
     rank 10: 27.34
     rank 11: 28.35
     rank 12: 28.30
     rank 13: 22.85
     rank 14: 28.17
     rank 15: 22.72
  forward-recv:
     rank  4: 54.58
     rank  5: 51.93
     rank  6: 53.25
     rank  7: 52.02
     rank  8: 127.32
     rank  9: 124.38
     rank 10: 124.00
     rank 11: 123.99
     rank 12: 188.33
     rank 13: 184.90
     rank 14: 189.83
     rank 15: 190.16
  forward-send:
     rank  0: 43.09
     rank  1: 41.70
     rank  2: 40.91
     rank  3: 46.71
     rank  4: 6.60
     rank  5: 4.93
     rank  6: 7.31
     rank  7: 8.35
     rank  8: 2.22
     rank  9: 1.52
     rank 10: 3.05
     rank 11: 2.93
  backward-recv:
     rank  0: 708.93
     rank  1: 704.94
     rank  2: 700.59
     rank  3: 705.66
     rank  4: 217.77
     rank  5: 217.06
     rank  6: 213.74
     rank  7: 212.88
     rank  8: 106.73
     rank  9: 111.65
     rank 10: 105.76
     rank 11: 106.33
  backward-send:
     rank  4: 2.99
     rank  5: 2.72
     rank  6: 2.65
     rank  7: 3.59
     rank  8: 5.98
     rank  9: 3.79
     rank 10: 4.04
     rank 11: 5.64
     rank 12: 4.14
     rank 13: 3.55
     rank 14: 2.24
     rank 15: 4.00
  forward-send-backward-recv:
     rank  0: 1207.67
     rank  1: 1217.09
     rank  2: 1211.39
     rank  3: 1218.50
     rank  4: 500.29
     rank  5: 501.84
     rank  6: 497.00
     rank  7: 482.85
     rank  8: 424.78
     rank  9: 439.60
     rank 10: 416.38
     rank 11: 408.74
  backward-send-forward-recv:
     rank  4: 6.92
     rank  5: 7.48
     rank  6: 7.80
     rank  7: 8.32
     rank  8: 20.12
     rank  9: 18.42
     rank 10: 20.28
     rank 11: 17.73
     rank 12: 30.40
     rank 13: 33.50
     rank 14: 29.93
     rank 15: 31.06
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.08
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.05
     rank  2: 0.11
     rank  3: 0.04
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.07
     rank 13: 0.05
     rank 14: 0.07
     rank 15: 0.05
  all-grads-sync:
     rank  0: 56.96
     rank  1: 57.11
     rank  2: 56.89
     rank  3: 56.87
     rank  4: 820.21
     rank  5: 820.19
     rank  6: 820.20
     rank  7: 820.14
     rank  8: 687.34
     rank  9: 687.31
     rank 10: 687.30
     rank 11: 687.31
     rank 12: 793.47
     rank 13: 793.49
     rank 14: 793.48
     rank 15: 793.44
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.04
     rank  3: 0.02
     rank  4: 0.06
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.04
     rank  8: 0.05
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.06
     rank 12: 0.12
     rank 13: 0.04
     rank 14: 0.05
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 7.36
     rank  1: 7.36
     rank  2: 7.52
     rank  3: 7.36
     rank  4: 98.74
     rank  5: 98.64
     rank  6: 98.68
     rank  7: 98.70
     rank  8: 85.75
     rank  9: 85.54
     rank 10: 85.67
     rank 11: 85.83
     rank 12: 98.72
     rank 13: 98.67
     rank 14: 98.86
     rank 15: 98.66
  optimizer:
     rank  0: 8.10
     rank  1: 8.10
     rank  2: 8.25
     rank  3: 8.09
     rank  4: 99.56
     rank  5: 99.38
     rank  6: 99.41
     rank  7: 99.43
     rank  8: 86.48
     rank  9: 86.27
     rank 10: 86.41
     rank 11: 86.57
     rank 12: 99.46
     rank 13: 99.40
     rank 14: 99.60
     rank 15: 99.42
 [2024-12-30 21:36:56] iteration        7/      10 | consumed samples:          224 | elapsed time per iteration (ms): 3352.6 | learning rate: 5.250000E-06 | global batch size:    32 | lm loss: 3.627055E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 3215.82
     rank  1: 3215.82
     rank  2: 3215.82
     rank  3: 3215.86
     rank  4: 3224.59
     rank  5: 3224.58
     rank  6: 3224.59
     rank  7: 3224.65
     rank  8: 3223.34
     rank  9: 3223.33
     rank 10: 3223.32
     rank 11: 3223.38
     rank 12: 3224.47
     rank 13: 3224.50
     rank 14: 3224.53
     rank 15: 3224.50
  forward-compute:
     rank  0: 380.44
     rank  1: 373.15
     rank  2: 382.55
     rank  3: 372.50
     rank  4: 538.90
     rank  5: 543.98
     rank  6: 543.88
     rank  7: 562.87
     rank  8: 528.53
     rank  9: 521.14
     rank 10: 533.93
     rank 11: 537.42
     rank 12: 664.38
     rank 13: 654.93
     rank 14: 656.12
     rank 15: 670.82
  backward-compute:
     rank  0: 40.88
     rank  1: 40.62
     rank  2: 44.01
     rank  3: 41.08
     rank  4: 1056.58
     rank  5: 1056.83
     rank  6: 1052.34
     rank  7: 1063.33
     rank  8: 1031.15
     rank  9: 1025.16
     rank 10: 1038.26
     rank 11: 1045.01
     rank 12: 1229.15
     rank 13: 1251.28
     rank 14: 1237.14
     rank 15: 1231.52
  pure-backward-compute:
     rank  0: 40.50
     rank  1: 40.29
     rank  2: 43.67
     rank  3: 40.69
     rank  4: 1056.12
     rank  5: 1056.28
     rank  6: 1051.67
     rank  7: 1062.35
     rank  8: 1030.39
     rank  9: 1024.43
     rank 10: 1037.49
     rank 11: 1044.01
     rank 12: 1227.88
     rank 13: 1250.02
     rank 14: 1235.83
     rank 15: 1230.03
  batch-generator:
     rank  0: 21.74
     rank  1: 22.01
     rank  2: 21.69
     rank  3: 21.31
     rank  4: 23.15
     rank  5: 26.35
     rank  6: 28.83
     rank  7: 36.29
     rank  8: 24.88
     rank  9: 24.29
     rank 10: 27.26
     rank 11: 26.74
     rank 12: 24.00
     rank 13: 21.87
     rank 14: 26.18
     rank 15: 26.89
  forward-recv:
     rank  4: 50.81
     rank  5: 48.38
     rank  6: 52.26
     rank  7: 47.97
     rank  8: 121.44
     rank  9: 119.22
     rank 10: 121.13
     rank 11: 119.55
     rank 12: 187.27
     rank 13: 179.90
     rank 14: 187.53
     rank 15: 183.94
  forward-send:
     rank  0: 45.31
     rank  1: 41.97
     rank  2: 42.98
     rank  3: 45.43
     rank  4: 5.61
     rank  5: 3.19
     rank  6: 5.81
     rank  7: 3.33
     rank  8: 2.74
     rank  9: 1.54
     rank 10: 2.85
     rank 11: 1.66
  backward-recv:
     rank  0: 703.14
     rank  1: 702.19
     rank  2: 697.47
     rank  3: 703.53
     rank  4: 213.16
     rank  5: 208.78
     rank  6: 208.94
     rank  7: 212.07
     rank  8: 105.68
     rank  9: 106.66
     rank 10: 101.69
     rank 11: 107.95
  backward-send:
     rank  4: 2.56
     rank  5: 4.34
     rank  6: 4.48
     rank  7: 4.41
     rank  8: 5.35
     rank  9: 5.50
     rank 10: 5.06
     rank 11: 4.74
     rank 12: 2.08
     rank 13: 2.22
     rank 14: 1.52
     rank 15: 2.73
  forward-send-backward-recv:
     rank  0: 1208.58
     rank  1: 1222.40
     rank  2: 1210.35
     rank  3: 1219.85
     rank  4: 496.36
     rank  5: 499.63
     rank  6: 492.79
     rank  7: 470.94
     rank  8: 424.04
     rank  9: 442.44
     rank 10: 413.95
     rank 11: 405.92
  backward-send-forward-recv:
     rank  4: 7.05
     rank  5: 7.66
     rank  6: 9.09
     rank  7: 8.93
     rank  8: 19.37
     rank  9: 18.41
     rank 10: 19.97
     rank 11: 18.84
     rank 12: 24.79
     rank 13: 21.75
     rank 14: 23.07
     rank 15: 19.98
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.04
     rank  2: 0.05
     rank  3: 0.07
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.05
     rank 13: 0.06
     rank 14: 0.07
     rank 15: 0.05
  all-grads-sync:
     rank  0: 60.31
     rank  1: 60.25
     rank  2: 60.28
     rank  3: 60.33
     rank  4: 829.91
     rank  5: 829.84
     rank  6: 829.90
     rank  7: 829.89
     rank  8: 686.11
     rank  9: 686.13
     rank 10: 686.12
     rank 11: 686.12
     rank 12: 821.08
     rank 13: 821.04
     rank 14: 821.07
     rank 15: 821.08
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.04
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.10
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.04
     rank 13: 0.08
     rank 14: 0.05
     rank 15: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 7.42
     rank  1: 7.36
     rank  2: 7.36
     rank  3: 7.46
     rank  4: 98.71
     rank  5: 98.67
     rank  6: 98.67
     rank  7: 98.80
     rank  8: 85.59
     rank  9: 85.59
     rank 10: 85.68
     rank 11: 85.71
     rank 12: 98.68
     rank 13: 98.77
     rank 14: 98.85
     rank 15: 98.81
  optimizer:
     rank  0: 8.02
     rank  1: 7.96
     rank  2: 7.95
     rank  3: 8.05
     rank  4: 99.31
     rank  5: 99.27
     rank  6: 99.27
     rank  7: 99.40
     rank  8: 86.19
     rank  9: 86.18
     rank 10: 86.28
     rank 11: 86.32
     rank 12: 99.28
     rank 13: 99.36
     rank 14: 99.45
     rank 15: 99.42
 [2024-12-30 21:36:59] iteration        8/      10 | consumed samples:          256 | elapsed time per iteration (ms): 3338.0 | learning rate: 6.000000E-06 | global batch size:    32 | lm loss: 2.063096E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 3201.66
     rank  1: 3201.67
     rank  2: 3201.65
     rank  3: 3201.67
     rank  4: 3210.44
     rank  5: 3210.44
     rank  6: 3210.45
     rank  7: 3210.52
     rank  8: 3209.18
     rank  9: 3209.16
     rank 10: 3209.17
     rank 11: 3209.21
     rank 12: 3210.35
     rank 13: 3210.37
     rank 14: 3210.37
     rank 15: 3210.45
  forward-compute:
     rank  0: 380.52
     rank  1: 382.78
     rank  2: 379.70
     rank  3: 372.21
     rank  4: 543.88
     rank  5: 543.85
     rank  6: 541.58
     rank  7: 560.27
     rank  8: 526.69
     rank  9: 523.90
     rank 10: 534.05
     rank 11: 537.11
     rank 12: 670.06
     rank 13: 649.20
     rank 14: 656.74
     rank 15: 663.44
  backward-compute:
     rank  0: 40.65
     rank  1: 41.29
     rank  2: 44.23
     rank  3: 40.91
     rank  4: 1057.51
     rank  5: 1056.01
     rank  6: 1046.93
     rank  7: 1062.79
     rank  8: 1034.03
     rank  9: 1024.66
     rank 10: 1038.47
     rank 11: 1042.95
     rank 12: 1229.43
     rank 13: 1240.07
     rank 14: 1243.81
     rank 15: 1232.46
  pure-backward-compute:
     rank  0: 40.31
     rank  1: 40.96
     rank  2: 43.90
     rank  3: 40.60
     rank  4: 1057.00
     rank  5: 1055.40
     rank  6: 1046.30
     rank  7: 1061.79
     rank  8: 1033.17
     rank  9: 1024.12
     rank 10: 1037.79
     rank 11: 1041.91
     rank 12: 1228.34
     rank 13: 1238.55
     rank 14: 1242.56
     rank 15: 1230.90
  batch-generator:
     rank  0: 21.74
     rank  1: 25.81
     rank  2: 22.07
     rank  3: 20.50
     rank  4: 25.95
     rank  5: 26.43
     rank  6: 28.64
     rank  7: 33.58
     rank  8: 23.90
     rank  9: 25.84
     rank 10: 26.75
     rank 11: 27.57
     rank 12: 24.80
     rank 13: 22.04
     rank 14: 26.15
     rank 15: 26.75
  forward-recv:
     rank  4: 49.77
     rank  5: 57.55
     rank  6: 49.64
     rank  7: 48.89
     rank  8: 120.50
     rank  9: 128.99
     rank 10: 118.17
     rank 11: 121.61
     rank 12: 184.06
     rank 13: 190.71
     rank 14: 182.31
     rank 15: 185.50
  forward-send:
     rank  0: 41.87
     rank  1: 44.15
     rank  2: 42.68
     rank  3: 49.51
     rank  4: 3.99
     rank  5: 3.15
     rank  6: 3.28
     rank  7: 3.95
     rank  8: 1.61
     rank  9: 1.57
     rank 10: 1.58
     rank 11: 1.92
  backward-recv:
     rank  0: 704.89
     rank  1: 707.82
     rank  2: 706.88
     rank  3: 707.01
     rank  4: 209.43
     rank  5: 212.81
     rank  6: 216.91
     rank  7: 219.67
     rank  8: 106.49
     rank  9: 108.93
     rank 10: 107.39
     rank 11: 107.53
  backward-send:
     rank  4: 2.91
     rank  5: 3.79
     rank  6: 3.77
     rank  7: 3.36
     rank  8: 4.39
     rank  9: 5.49
     rank 10: 6.11
     rank 11: 6.82
     rank 12: 1.67
     rank 13: 3.96
     rank 14: 4.05
     rank 15: 3.96
  forward-send-backward-recv:
     rank  0: 1214.77
     rank  1: 1210.85
     rank  2: 1214.06
     rank  3: 1219.97
     rank  4: 500.15
     rank  5: 493.29
     rank  6: 507.34
     rank  7: 474.19
     rank  8: 426.03
     rank  9: 431.23
     rank 10: 418.38
     rank 11: 408.26
  backward-send-forward-recv:
     rank  4: 7.65
     rank  5: 8.57
     rank  6: 8.27
     rank  7: 7.79
     rank  8: 22.50
     rank  9: 21.53
     rank 10: 24.03
     rank 11: 21.20
     rank 12: 26.43
     rank 13: 31.39
     rank 14: 28.31
     rank 15: 29.40
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.05
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.05
     rank 13: 0.05
     rank 14: 0.07
     rank 15: 0.07
  all-grads-sync:
     rank  0: 57.58
     rank  1: 57.60
     rank  2: 57.58
     rank  3: 57.54
     rank  4: 808.53
     rank  5: 808.52
     rank  6: 808.49
     rank  7: 808.53
     rank  8: 689.52
     rank  9: 689.52
     rank 10: 689.52
     rank 11: 689.52
     rank 12: 782.74
     rank 13: 782.70
     rank 14: 782.74
     rank 15: 782.73
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.04
     rank  7: 0.04
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.05
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.05
     rank 15: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 7.36
     rank  1: 7.36
     rank  2: 7.37
     rank  3: 7.36
     rank  4: 98.71
     rank  5: 98.64
     rank  6: 98.71
     rank  7: 98.75
     rank  8: 85.64
     rank  9: 85.53
     rank 10: 85.74
     rank 11: 85.65
     rank 12: 98.70
     rank 13: 98.72
     rank 14: 98.83
     rank 15: 98.75
  optimizer:
     rank  0: 7.93
     rank  1: 7.93
     rank  2: 7.94
     rank  3: 7.93
     rank  4: 99.28
     rank  5: 99.22
     rank  6: 99.28
     rank  7: 99.32
     rank  8: 86.23
     rank  9: 86.10
     rank 10: 86.31
     rank 11: 86.22
     rank 12: 99.27
     rank 13: 99.29
     rank 14: 99.41
     rank 15: 99.33
 [2024-12-30 21:37:02] iteration        9/      10 | consumed samples:          288 | elapsed time per iteration (ms): 3355.2 | learning rate: 6.750000E-06 | global batch size:    32 | lm loss: 1.971237E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 3216.94
     rank  1: 3216.94
     rank  2: 3216.92
     rank  3: 3216.96
     rank  4: 3225.69
     rank  5: 3225.68
     rank  6: 3225.68
     rank  7: 3225.72
     rank  8: 3224.39
     rank  9: 3224.39
     rank 10: 3224.40
     rank 11: 3224.45
     rank 12: 3225.65
     rank 13: 3225.65
     rank 14: 3225.62
     rank 15: 3225.71
  forward-compute:
     rank  0: 450.83
     rank  1: 386.64
     rank  2: 387.18
     rank  3: 374.93
     rank  4: 544.27
     rank  5: 537.83
     rank  6: 542.09
     rank  7: 565.35
     rank  8: 525.20
     rank  9: 521.07
     rank 10: 532.55
     rank 11: 530.65
     rank 12: 663.02
     rank 13: 651.79
     rank 14: 657.99
     rank 15: 650.72
  backward-compute:
     rank  0: 40.91
     rank  1: 42.38
     rank  2: 44.14
     rank  3: 40.88
     rank  4: 1058.16
     rank  5: 1052.41
     rank  6: 1044.21
     rank  7: 1064.51
     rank  8: 1035.66
     rank  9: 1027.30
     rank 10: 1040.83
     rank 11: 1034.17
     rank 12: 1232.69
     rank 13: 1249.00
     rank 14: 1235.66
     rank 15: 1242.19
  pure-backward-compute:
     rank  0: 40.51
     rank  1: 42.01
     rank  2: 43.81
     rank  3: 40.55
     rank  4: 1057.51
     rank  5: 1051.78
     rank  6: 1043.67
     rank  7: 1063.34
     rank  8: 1035.04
     rank  9: 1026.77
     rank 10: 1040.14
     rank 11: 1032.87
     rank 12: 1231.65
     rank 13: 1247.57
     rank 14: 1234.60
     rank 15: 1240.73
  batch-generator:
     rank  0: 24.04
     rank  1: 23.54
     rank  2: 21.79
     rank  3: 20.44
     rank  4: 26.31
     rank  5: 24.11
     rank  6: 29.25
     rank  7: 39.24
     rank  8: 23.23
     rank  9: 23.22
     rank 10: 26.63
     rank 11: 26.49
     rank 12: 23.08
     rank 13: 22.84
     rank 14: 22.32
     rank 15: 26.97
  forward-recv:
     rank  4: 52.43
     rank  5: 51.75
     rank  6: 51.92
     rank  7: 49.74
     rank  8: 125.80
     rank  9: 125.55
     rank 10: 123.87
     rank 11: 125.59
     rank 12: 189.54
     rank 13: 187.10
     rank 14: 190.05
     rank 15: 190.31
  forward-send:
     rank  0: 20.86
     rank  1: 45.28
     rank  2: 45.49
     rank  3: 51.85
     rank  4: 8.56
     rank  5: 6.73
     rank  6: 9.51
     rank  7: 7.24
     rank  8: 3.78
     rank  9: 2.08
     rank 10: 3.95
     rank 11: 3.67
  backward-recv:
     rank  0: 706.63
     rank  1: 707.89
     rank  2: 706.91
     rank  3: 707.31
     rank  4: 210.99
     rank  5: 214.32
     rank  6: 215.50
     rank  7: 212.04
     rank  8: 109.04
     rank  9: 108.69
     rank 10: 106.32
     rank 11: 108.00
  backward-send:
     rank  4: 2.94
     rank  5: 3.99
     rank  6: 3.98
     rank  7: 3.43
     rank  8: 3.00
     rank  9: 6.98
     rank 10: 7.24
     rank 11: 7.47
     rank 12: 2.40
     rank 13: 3.54
     rank 14: 3.41
     rank 15: 3.51
  forward-send-backward-recv:
     rank  0: 1168.88
     rank  1: 1209.46
     rank  2: 1207.73
     rank  3: 1218.51
     rank  4: 494.28
     rank  5: 508.29
     rank  6: 509.47
     rank  7: 473.57
     rank  8: 416.93
     rank  9: 430.60
     rank 10: 406.83
     rank 11: 412.51
  backward-send-forward-recv:
     rank  4: 8.92
     rank  5: 9.11
     rank  6: 7.03
     rank  7: 8.72
     rank  8: 28.57
     rank  9: 30.20
     rank 10: 30.23
     rank 11: 30.21
     rank 12: 28.66
     rank 13: 27.78
     rank 14: 30.65
     rank 15: 32.29
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.04
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.07
     rank  1: 0.06
     rank  2: 0.05
     rank  3: 0.06
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.05
     rank 13: 0.06
     rank 14: 0.05
     rank 15: 0.07
  all-grads-sync:
     rank  0: 57.38
     rank  1: 57.32
     rank  2: 57.36
     rank  3: 57.41
     rank  4: 820.02
     rank  5: 820.02
     rank  6: 820.02
     rank  7: 820.02
     rank  8: 666.77
     rank  9: 666.77
     rank 10: 666.75
     rank 11: 666.77
     rank 12: 814.20
     rank 13: 814.11
     rank 14: 814.22
     rank 15: 814.20
  optimizer-copy-to-main-grad:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.04
     rank  5: 0.04
     rank  6: 0.03
     rank  7: 0.04
     rank  8: 0.04
     rank  9: 0.09
     rank 10: 0.05
     rank 11: 0.04
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.10
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 7.46
     rank  1: 7.44
     rank  2: 7.36
     rank  3: 7.36
     rank  4: 98.75
     rank  5: 98.65
     rank  6: 98.60
     rank  7: 98.85
     rank  8: 85.64
     rank  9: 85.60
     rank 10: 85.75
     rank 11: 85.65
     rank 12: 98.72
     rank 13: 98.81
     rank 14: 98.73
     rank 15: 98.82
  optimizer:
     rank  0: 8.09
     rank  1: 8.07
     rank  2: 7.98
     rank  3: 7.98
     rank  4: 99.39
     rank  5: 99.29
     rank  6: 99.24
     rank  7: 99.49
     rank  8: 86.26
     rank  9: 86.22
     rank 10: 86.37
     rank 11: 86.27
     rank 12: 99.34
     rank 13: 99.43
     rank 14: 99.35
     rank 15: 99.44
 [2024-12-30 21:37:06] iteration       10/      10 | consumed samples:          320 | elapsed time per iteration (ms): 3349.3 | learning rate: 7.500000E-06 | global batch size:    32 | lm loss: 2.133995E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 3212.38
     rank  1: 3212.38
     rank  2: 3212.39
     rank  3: 3212.40
     rank  4: 3221.13
     rank  5: 3221.13
     rank  6: 3221.14
     rank  7: 3221.21
     rank  8: 3219.99
     rank  9: 3219.91
     rank 10: 3219.91
     rank 11: 3219.91
     rank 12: 3221.12
     rank 13: 3221.11
     rank 14: 3221.10
     rank 15: 3221.15
  forward-compute:
     rank  0: 428.74
     rank  1: 378.42
     rank  2: 381.48
     rank  3: 371.86
     rank  4: 544.35
     rank  5: 540.70
     rank  6: 545.52
     rank  7: 557.84
     rank  8: 527.71
     rank  9: 523.76
     rank 10: 532.90
     rank 11: 528.02
     rank 12: 661.87
     rank 13: 652.14
     rank 14: 661.66
     rank 15: 651.99
  backward-compute:
     rank  0: 40.49
     rank  1: 40.75
     rank  2: 43.66
     rank  3: 40.94
     rank  4: 1060.31
     rank  5: 1051.12
     rank  6: 1044.47
     rank  7: 1061.53
     rank  8: 1040.52
     rank  9: 1029.76
     rank 10: 1035.64
     rank 11: 1034.17
     rank 12: 1231.43
     rank 13: 1243.06
     rank 14: 1236.31
     rank 15: 1239.19
  pure-backward-compute:
     rank  0: 40.12
     rank  1: 40.42
     rank  2: 43.34
     rank  3: 40.61
     rank  4: 1059.70
     rank  5: 1050.48
     rank  6: 1043.98
     rank  7: 1060.41
     rank  8: 1039.85
     rank  9: 1029.20
     rank 10: 1034.97
     rank 11: 1033.30
     rank 12: 1230.15
     rank 13: 1241.85
     rank 14: 1235.25
     rank 15: 1237.83
  batch-generator:
     rank  0: 23.44
     rank  1: 22.44
     rank  2: 22.24
     rank  3: 20.76
     rank  4: 26.91
     rank  5: 26.90
     rank  6: 30.48
     rank  7: 35.01
     rank  8: 23.24
     rank  9: 23.75
     rank 10: 27.24
     rank 11: 23.93
     rank 12: 24.01
     rank 13: 22.51
     rank 14: 23.07
     rank 15: 27.47
  forward-recv:
     rank  4: 51.34
     rank  5: 50.41
     rank  6: 51.15
     rank  7: 50.67
     rank  8: 124.97
     rank  9: 121.67
     rank 10: 120.16
     rank 11: 123.94
     rank 12: 186.41
     rank 13: 182.66
     rank 14: 183.60
     rank 15: 186.69
  forward-send:
     rank  0: 46.54
     rank  1: 44.36
     rank  2: 43.56
     rank  3: 51.18
     rank  4: 5.35
     rank  5: 5.47
     rank  6: 5.13
     rank  7: 5.27
     rank  8: 2.42
     rank  9: 1.85
     rank 10: 1.96
     rank 11: 2.66
  backward-recv:
     rank  0: 704.26
     rank  1: 704.71
     rank  2: 707.41
     rank  3: 699.03
     rank  4: 211.24
     rank  5: 214.37
     rank  6: 216.15
     rank  7: 205.59
     rank  8: 106.08
     rank  9: 107.71
     rank 10: 107.37
     rank 11: 109.99
  backward-send:
     rank  4: 3.19
     rank  5: 3.47
     rank  6: 2.78
     rank  7: 3.93
     rank  8: 6.90
     rank  9: 6.78
     rank 10: 6.98
     rank 11: 3.04
     rank 12: 3.79
     rank 13: 3.94
     rank 14: 3.92
     rank 15: 2.32
  forward-send-backward-recv:
     rank  0: 1163.45
     rank  1: 1213.99
     rank  2: 1204.91
     rank  3: 1215.71
     rank  4: 491.65
     rank  5: 500.86
     rank  6: 501.63
     rank  7: 475.91
     rank  8: 411.64
     rank  9: 426.27
     rank 10: 416.16
     rank 11: 409.73
  backward-send-forward-recv:
     rank  4: 8.63
     rank  5: 8.49
     rank  6: 6.61
     rank  7: 9.22
     rank  8: 22.95
     rank  9: 24.99
     rank 10: 21.09
     rank 11: 26.55
     rank 12: 25.71
     rank 13: 28.09
     rank 14: 24.75
     rank 15: 26.36
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.04
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.05
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.05
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.07
  all-grads-sync:
     rank  0: 56.66
     rank  1: 56.66
     rank  2: 56.62
     rank  3: 56.62
     rank  4: 825.29
     rank  5: 825.27
     rank  6: 825.26
     rank  7: 825.32
     rank  8: 689.56
     rank  9: 689.52
     rank 10: 689.50
     rank 11: 689.51
     rank 12: 802.02
     rank 13: 801.99
     rank 14: 802.04
     rank 15: 802.03
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.07
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.04
     rank  8: 0.08
     rank  9: 0.04
     rank 10: 0.05
     rank 11: 0.04
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 7.37
     rank  1: 7.36
     rank  2: 7.38
     rank  3: 7.36
     rank  4: 98.69
     rank  5: 98.55
     rank  6: 98.59
     rank  7: 98.73
     rank  8: 85.76
     rank  9: 85.59
     rank 10: 85.65
     rank 11: 85.59
     rank 12: 98.93
     rank 13: 98.69
     rank 14: 98.77
     rank 15: 98.72
  optimizer:
     rank  0: 7.92
     rank  1: 7.92
     rank  2: 7.93
     rank  3: 7.91
     rank  4: 99.25
     rank  5: 99.10
     rank  6: 99.15
     rank  7: 99.27
     rank  8: 86.32
     rank  9: 86.14
     rank 10: 86.22
     rank 11: 86.14
     rank 12: 99.49
     rank 13: 99.24
     rank 14: 99.32
     rank 15: 99.27
