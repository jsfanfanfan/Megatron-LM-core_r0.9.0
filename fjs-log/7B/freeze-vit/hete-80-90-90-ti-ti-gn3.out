examples/multimodal/pretrain-freeze-llm-hete-2080first.sh: line 4: activate: No such file or directory
4
[2025-01-02 12:30:35,499] torch.distributed.run: [WARNING] 
[2025-01-02 12:30:35,499] torch.distributed.run: [WARNING] *****************************************
[2025-01-02 12:30:35,499] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2025-01-02 12:30:35,499] torch.distributed.run: [WARNING] *****************************************
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:20------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:20------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:20------
------num_pipeline_model_parallel_groups:4------
> setting tensorboard ...
WARNING: one_logger package is required to enable e2e metrics tracking. please go to https://confluence.nvidia.com/display/MLWFO/Package+Repositories for details to install it
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:20------
------num_pipeline_model_parallel_groups:4------
---Rank 16---Tensor Parallel Group GPUs: [0, 0, 0, 0]
---Rank 16---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]
---Rank 18---Tensor Parallel Group GPUs: [2, 2, 2, 2]
---Rank 19---Tensor Parallel Group GPUs: [3, 3, 3, 3]
---Rank 18---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]
---Rank 19---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]
[rank16]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank18]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank19]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
---Rank 17---Tensor Parallel Group GPUs: [1, 1, 1, 1]
---Rank 17---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]
[rank17]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
 > number of parameters on (tensor, pipeline) model parallel rank (0, 4): 360763392
INFO:megatron.core.distributed.param_and_grad_buffer:Number of buckets for gradient all-reduce / reduce-scatter: 1
Params for bucket 1 (360763392 elements):
	language_model.decoder.layers.5.self_attention.linear_proj.weight
	language_model.decoder.layers.1.mlp.linear_fc2.weight
	language_model.decoder.layers.1.self_attention.linear_qkv.weight
	language_model.decoder.layers.3.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.5.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.2.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.0.self_attention.linear_qkv.weight
	language_model.decoder.layers.4.mlp.linear_fc1.weight
	language_model.decoder.layers.3.mlp.linear_fc2.weight
	language_model.decoder.layers.0.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.4.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.5.mlp.linear_fc1.weight
	language_model.decoder.final_layernorm.weight
	language_model.decoder.layers.3.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.3.self_attention.linear_proj.weight
	language_model.decoder.layers.2.mlp.linear_fc1.weight
	language_model.decoder.layers.2.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.2.self_attention.linear_proj.weight
	language_model.decoder.layers.1.self_attention.linear_proj.weight
	language_model.decoder.layers.0.mlp.linear_fc1.weight
	language_model.decoder.layers.0.self_attention.linear_proj.weight
	language_model.decoder.layers.3.self_attention.linear_qkv.weight
	language_model.decoder.layers.4.self_attention.linear_proj.weight
	language_model.decoder.layers.5.mlp.linear_fc2.weight
	language_model.decoder.layers.5.self_attention.linear_qkv.weight
	language_model.decoder.layers.4.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.2.mlp.linear_fc2.weight
	language_model.decoder.layers.1.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.1.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.0.mlp.linear_fc2.weight
	language_model.decoder.layers.3.mlp.linear_fc1.weight
	language_model.output_layer.weight
	language_model.decoder.layers.5.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.4.mlp.linear_fc2.weight
	language_model.decoder.layers.4.self_attention.linear_qkv.weight
	language_model.decoder.layers.2.self_attention.linear_qkv.weight
	language_model.decoder.layers.1.mlp.linear_fc1.weight
	language_model.decoder.layers.0.mlp.linear_fc1.layer_norm_weight
 > number of parameters on (tensor, pipeline) model parallel rank (3, 4): 360763392
 > number of parameters on (tensor, pipeline) model parallel rank (1, 4): 360763392
 > number of parameters on (tensor, pipeline) model parallel rank (2, 4): 360763392
rank=0, worker=0: shard_range=[pretrain-0.tar[0, 100), pretrain-0.tar[100, 200), pretrain-0.tar[200, 300), ...<2494>, pretrain-30.tar[9700, 9800), pretrain-30.tar[9800, 9900), pretrain-30.tar[9900, 10000)] sum(count)=250000
rank=0, worker=1: shard_range=[pretrain-31.tar[0, 100), pretrain-31.tar[100, 200), pretrain-31.tar[200, 300), ...<2494>, pretrain-53.tar[9700, 9800), pretrain-53.tar[9800, 9900), pretrain-53.tar[9900, 10000)] sum(count)=250000
rank=0, worker=0: shard_range=[pretrain-54.tar[0, 10000), pretrain-55.tar[0, 8128), pretrain-6.tar[0, 10000), pretrain-7.tar[0, 936)] sum(count)=29064
rank=0, worker=1: shard_range=[pretrain-7.tar[936, 10000), pretrain-8.tar[0, 10000), pretrain-9.tar[0, 10000)] sum(count)=29064
times across ranks (ms):
  model-and-optimizer-setup:
     rank  0: 137.73
     rank  1: 135.72
     rank  2: 138.72
     rank  3: 137.68
     rank  4: 54.22
     rank  5: 36.01
     rank  6: 60.24
     rank  7: 54.02
     rank  8: 63.34
     rank  9: 55.31
     rank 10: 55.15
     rank 11: 55.24
     rank 12: 65.98
     rank 13: 72.08
     rank 14: 73.55
     rank 15: 69.66
     rank 16: 64.07
     rank 17: 69.65
     rank 18: 68.69
     rank 19: 66.85
  train/valid/test-data-iterators-setup:
     rank  0: 1011.12
     rank  1: 1011.03
     rank  2: 1253.75
     rank  3: 1013.29
     rank  4: 1030.84
     rank  5: 1030.86
     rank  6: 1030.90
     rank  7: 1030.84
     rank  8: 1101.84
     rank  9: 1101.85
     rank 10: 1101.83
     rank 11: 1102.10
     rank 12: 1253.43
     rank 13: 1253.34
     rank 14: 1102.52
     rank 15: 1253.33
     rank 16: 1253.47
     rank 17: 1253.70
     rank 18: 1253.69
     rank 19: 1253.34
 [2025-01-02 12:31:15] iteration        1/      10 | consumed samples:           32 | elapsed time per iteration (ms): 19163.0 | learning rate: 7.500000E-07 | global batch size:    32 | lm loss: 7.094884E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
[Rank 18] (after 1 iterations) memory (MB) | allocated: 5558.0654296875 | max allocated: 6933.673828125 | reserved: 7436.0 | max reserved: 7436.0
[Rank 17] (after 1 iterations) memory (MB) | allocated: 5558.0654296875 | max allocated: 6933.673828125 | reserved: 7430.0 | max reserved: 7430.0
stage5 GPU utialization:84.639573097229 %
[Rank 16] (after 1 iterations) memory (MB) | allocated: 5558.0654296875 | max allocated: 6933.673828125 | reserved: 7442.0 | max reserved: 7442.0
[Rank 19] (after 1 iterations) memory (MB) | allocated: 5558.0654296875 | max allocated: 6933.673828125 | reserved: 7444.0 | max reserved: 7444.0
times across ranks (ms):
  forward-backward:
     rank  0: 19056.02
     rank  1: 19056.17
     rank  2: 19056.21
     rank  3: 19056.28
     rank  4: 19058.83
     rank  5: 19058.75
     rank  6: 19058.76
     rank  7: 19058.74
     rank  8: 19059.14
     rank  9: 19058.98
     rank 10: 19058.95
     rank 11: 19058.92
     rank 12: 19058.82
     rank 13: 19058.35
     rank 14: 19058.78
     rank 15: 19058.61
     rank 16: 19059.65
     rank 17: 19059.67
     rank 18: 19059.51
     rank 19: 19059.56
  forward-compute:
     rank  0: 6086.18
     rank  1: 6087.57
     rank  2: 6068.60
     rank  3: 6084.01
     rank  4: 5695.71
     rank  5: 5706.11
     rank  6: 5685.01
     rank  7: 5717.65
     rank  8: 5969.43
     rank  9: 5976.71
     rank 10: 5975.32
     rank 11: 5972.02
     rank 12: 4955.19
     rank 13: 4964.05
     rank 14: 4959.82
     rank 15: 4954.00
     rank 16: 5048.94
     rank 17: 5047.27
     rank 18: 5040.45
     rank 19: 5054.68
  backward-compute:
     rank  0: 1202.69
     rank  1: 1212.83
     rank  2: 1203.39
     rank  3: 1223.64
     rank  4: 4248.57
     rank  5: 4242.30
     rank  6: 4247.56
     rank  7: 4241.45
     rank  8: 4252.93
     rank  9: 4258.98
     rank 10: 4288.35
     rank 11: 4270.60
     rank 12: 4231.54
     rank 13: 4218.70
     rank 14: 4204.86
     rank 15: 4227.13
     rank 16: 4662.97
     rank 17: 4669.04
     rank 18: 4671.91
     rank 19: 4664.92
  pure-backward-compute:
     rank  0: 1200.92
     rank  1: 1211.02
     rank  2: 1201.63
     rank  3: 1221.82
     rank  4: 4245.65
     rank  5: 4240.72
     rank  6: 4244.90
     rank  7: 4239.89
     rank  8: 4250.75
     rank  9: 4256.49
     rank 10: 4286.62
     rank 11: 4267.91
     rank 12: 4226.97
     rank 13: 4216.10
     rank 14: 4199.11
     rank 15: 4223.52
     rank 16: 4656.62
     rank 17: 4664.26
     rank 18: 4665.55
     rank 19: 4659.93
  batch-generator:
     rank  0: 1178.78
     rank  1: 1193.39
     rank  2: 1182.65
     rank  3: 1205.15
     rank  4: 1127.66
     rank  5: 1141.86
     rank  6: 1129.75
     rank  7: 1160.47
     rank  8: 1317.78
     rank  9: 1329.73
     rank 10: 1319.19
     rank 11: 1322.93
     rank 12: 1272.33
     rank 13: 1283.12
     rank 14: 1308.01
     rank 15: 1298.81
     rank 16: 1423.32
     rank 17: 1426.48
     rank 18: 1422.06
     rank 19: 1436.54
  forward-recv:
     rank  4: 2356.12
     rank  5: 2361.93
     rank  6: 2358.21
     rank  7: 2348.34
     rank  8: 4591.00
     rank  9: 4590.71
     rank 10: 4590.97
     rank 11: 4590.17
     rank 12: 7068.53
     rank 13: 7061.31
     rank 14: 7070.11
     rank 15: 7066.19
     rank 16: 8461.91
     rank 17: 8458.92
     rank 18: 8463.74
     rank 19: 8463.58
  forward-send:
     rank  0: 5901.78
     rank  1: 5899.78
     rank  2: 5910.68
     rank  3: 5895.77
     rank  4: 3672.08
     rank  5: 3662.79
     rank  6: 3677.48
     rank  7: 3671.37
     rank  8: 1308.36
     rank  9: 1299.11
     rank 10: 1312.09
     rank 11: 1308.69
     rank 12: 26.52
     rank 13: 23.93
     rank 14: 29.26
     rank 15: 28.82
  backward-recv:
     rank  0: 910.02
     rank  1: 910.18
     rank  2: 910.05
     rank  3: 910.08
     rank  4: 376.90
     rank  5: 378.39
     rank  6: 376.60
     rank  7: 378.17
     rank  8: 251.75
     rank  9: 251.54
     rank 10: 251.36
     rank 11: 251.03
     rank 12: 126.99
     rank 13: 127.37
     rank 14: 127.23
     rank 15: 127.32
  backward-send:
     rank  4: 20.70
     rank  5: 19.83
     rank  6: 20.91
     rank  7: 19.47
     rank  8: 14.78
     rank  9: 15.10
     rank 10: 14.63
     rank 11: 14.84
     rank 12: 10.30
     rank 13: 10.15
     rank 14: 9.68
     rank 15: 9.84
     rank 16: 5.11
     rank 17: 5.30
     rank 18: 5.19
     rank 19: 4.98
  forward-send-backward-recv:
     rank  0: 4870.34
     rank  1: 4860.65
     rank  2: 4877.29
     rank  3: 4856.81
     rank  4: 2303.44
     rank  5: 2314.11
     rank  6: 2307.28
     rank  7: 2317.29
     rank  8: 2206.96
     rank  9: 2198.04
     rank 10: 2171.27
     rank 11: 2185.05
     rank 12: 1924.33
     rank 13: 1936.19
     rank 14: 1943.96
     rank 15: 1926.59
  backward-send-forward-recv:
     rank  4: 247.96
     rank  5: 243.74
     rank  6: 249.45
     rank  7: 235.50
     rank  8: 189.31
     rank  9: 192.63
     rank 10: 185.25
     rank 11: 192.02
     rank 12: 304.81
     rank 13: 308.66
     rank 14: 294.48
     rank 15: 307.69
     rank 16: 331.35
     rank 17: 330.08
     rank 18: 329.64
     rank 19: 323.76
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.06
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.06
     rank 13: 0.03
     rank 14: 0.05
     rank 15: 0.05
     rank 16: 0.03
     rank 17: 0.03
     rank 18: 0.03
     rank 19: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.09
     rank  1: 0.09
     rank  2: 0.09
     rank  3: 0.09
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.05
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.07
     rank 13: 0.03
     rank 14: 0.06
     rank 15: 0.05
     rank 16: 0.08
     rank 17: 0.08
     rank 18: 0.07
     rank 19: 0.08
  all-grads-sync:
     rank  0: 55.48
     rank  1: 59.22
     rank  2: 57.71
     rank  3: 57.77
     rank  4: 46.69
     rank  5: 47.09
     rank  6: 46.28
     rank  7: 42.64
     rank  8: 45.79
     rank  9: 47.33
     rank 10: 44.95
     rank 11: 38.12
     rank 12: 68.76
     rank 13: 71.47
     rank 14: 63.88
     rank 15: 62.56
     rank 16: 24.74
     rank 17: 26.37
     rank 18: 24.91
     rank 19: 26.25
  optimizer-copy-to-main-grad:
     rank  0: 0.04
     rank  1: 0.05
     rank  2: 0.05
     rank  3: 0.09
     rank  4: 0.07
     rank  5: 0.07
     rank  6: 0.07
     rank  7: 0.06
     rank  8: 0.17
     rank  9: 0.07
     rank 10: 0.08
     rank 11: 0.07
     rank 12: 0.07
     rank 13: 0.06
     rank 14: 0.08
     rank 15: 0.09
     rank 16: 0.08
     rank 17: 0.07
     rank 18: 0.07
     rank 19: 0.07
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.05
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.02
     rank 19: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 41.00
     rank  1: 41.52
     rank  2: 40.56
     rank  3: 41.53
     rank  4: 71.54
     rank  5: 71.54
     rank  6: 71.66
     rank  7: 71.67
     rank  8: 74.82
     rank  9: 74.30
     rank 10: 74.94
     rank 11: 73.42
     rank 12: 66.27
     rank 13: 69.03
     rank 14: 68.81
     rank 15: 68.77
     rank 16: 93.22
     rank 17: 93.00
     rank 18: 93.01
     rank 19: 95.63
  optimizer:
     rank  0: 42.33
     rank  1: 42.85
     rank  2: 41.89
     rank  3: 42.85
     rank  4: 72.86
     rank  5: 72.86
     rank  6: 72.99
     rank  7: 73.01
     rank  8: 76.15
     rank  9: 75.62
     rank 10: 76.27
     rank 11: 74.74
     rank 12: 67.59
     rank 13: 70.36
     rank 14: 70.27
     rank 15: 70.09
     rank 16: 94.55
     rank 17: 94.33
     rank 18: 94.34
     rank 19: 96.96
 [2025-01-02 12:31:25] iteration        2/      10 | consumed samples:           64 | elapsed time per iteration (ms): 9589.7 | learning rate: 1.500000E-06 | global batch size:    32 | lm loss: 7.111776E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 9483.88
     rank  1: 9484.06
     rank  2: 9484.00
     rank  3: 9483.96
     rank  4: 9486.86
     rank  5: 9486.87
     rank  6: 9486.92
     rank  7: 9486.85
     rank  8: 9486.96
     rank  9: 9486.93
     rank 10: 9487.02
     rank 11: 9486.95
     rank 12: 9485.95
     rank 13: 9485.95
     rank 14: 9486.03
     rank 15: 9486.00
     rank 16: 9487.22
     rank 17: 9487.16
     rank 18: 9487.32
     rank 19: 9487.23
  forward-compute:
     rank  0: 3989.06
     rank  1: 3990.28
     rank  2: 3982.34
     rank  3: 3987.28
     rank  4: 3596.07
     rank  5: 3604.83
     rank  6: 3593.27
     rank  7: 3605.50
     rank  8: 3587.43
     rank  9: 3582.78
     rank 10: 3591.53
     rank 11: 3588.62
     rank 12: 3679.31
     rank 13: 3678.58
     rank 14: 3689.92
     rank 15: 3677.72
     rank 16: 3569.48
     rank 17: 3574.73
     rank 18: 3567.53
     rank 19: 3573.10
  backward-compute:
     rank  0: 1159.01
     rank  1: 1169.41
     rank  2: 1159.22
     rank  3: 1171.58
     rank  4: 4234.78
     rank  5: 4229.30
     rank  6: 4234.32
     rank  7: 4229.82
     rank  8: 4228.51
     rank  9: 4239.89
     rank 10: 4271.09
     rank 11: 4249.01
     rank 12: 4229.05
     rank 13: 4233.19
     rank 14: 4205.16
     rank 15: 4218.68
     rank 16: 4689.63
     rank 17: 4691.77
     rank 18: 4693.05
     rank 19: 4696.53
  pure-backward-compute:
     rank  0: 1157.27
     rank  1: 1167.64
     rank  2: 1157.55
     rank  3: 1169.96
     rank  4: 4232.20
     rank  5: 4227.88
     rank  6: 4231.75
     rank  7: 4228.40
     rank  8: 4226.53
     rank  9: 4237.15
     rank 10: 4269.50
     rank 11: 4246.68
     rank 12: 4224.89
     rank 13: 4230.56
     rank 14: 4199.87
     rank 15: 4215.46
     rank 16: 4684.03
     rank 17: 4687.63
     rank 18: 4687.73
     rank 19: 4692.30
  batch-generator:
     rank  0: 139.91
     rank  1: 154.44
     rank  2: 147.62
     rank  3: 157.08
     rank  4: 96.09
     rank  5: 104.38
     rank  6: 103.25
     rank  7: 110.81
     rank  8: 91.11
     rank  9: 91.49
     rank 10: 93.50
     rank 11: 97.29
     rank 12: 112.29
     rank 13: 120.96
     rank 14: 148.80
     rank 15: 132.35
     rank 16: 117.50
     rank 17: 125.64
     rank 18: 123.94
     rank 19: 130.65
  forward-recv:
     rank  4: 177.06
     rank  5: 177.51
     rank  6: 176.29
     rank  7: 177.13
     rank  8: 272.67
     rank  9: 271.10
     rank 10: 271.55
     rank 11: 269.45
     rank 12: 377.54
     rank 13: 378.49
     rank 14: 379.08
     rank 15: 378.79
     rank 16: 485.57
     rank 17: 485.51
     rank 18: 485.10
     rank 19: 485.69
  forward-send:
     rank  0: 24.94
     rank  1: 24.80
     rank  2: 24.36
     rank  3: 22.01
     rank  4: 15.02
     rank  5: 14.60
     rank  6: 15.20
     rank  7: 12.77
     rank  8: 9.61
     rank  9: 10.60
     rank 10: 10.42
     rank 11: 10.53
     rank 12: 5.22
     rank 13: 5.18
     rank 14: 4.91
     rank 15: 5.06
  backward-recv:
     rank  0: 915.50
     rank  1: 915.62
     rank  2: 915.78
     rank  3: 915.95
     rank  4: 386.68
     rank  5: 388.17
     rank  6: 386.59
     rank  7: 388.06
     rank  8: 255.41
     rank  9: 255.58
     rank 10: 254.36
     rank 11: 254.87
     rank 12: 127.82
     rank 13: 127.65
     rank 14: 129.03
     rank 15: 128.70
  backward-send:
     rank  4: 20.60
     rank  5: 19.42
     rank  6: 20.56
     rank  7: 19.70
     rank  8: 14.95
     rank  9: 14.63
     rank 10: 14.98
     rank 11: 14.99
     rank 12: 10.11
     rank 13: 10.06
     rank 14: 9.02
     rank 15: 9.79
     rank 16: 5.27
     rank 17: 4.75
     rank 18: 5.25
     rank 19: 5.20
  forward-send-backward-recv:
     rank  0: 3379.82
     rank  1: 3368.47
     rank  2: 3386.15
     rank  3: 3372.25
     rank  4: 747.60
     rank  5: 758.35
     rank  6: 747.99
     rank  7: 760.70
     rank  8: 753.18
     rank  9: 739.59
     rank 10: 712.15
     rank 11: 728.73
     rank 12: 436.17
     rank 13: 430.91
     rank 14: 451.52
     rank 15: 443.61
  backward-send-forward-recv:
     rank  4: 240.09
     rank  5: 234.31
     rank  6: 240.81
     rank  7: 232.58
     rank  8: 163.67
     rank  9: 168.15
     rank 10: 162.76
     rank 11: 166.86
     rank 12: 282.25
     rank 13: 284.11
     rank 14: 270.59
     rank 15: 283.44
     rank 16: 259.59
     rank 17: 256.07
     rank 18: 258.86
     rank 19: 252.36
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.03
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.03
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.07
     rank  1: 0.08
     rank  2: 0.08
     rank  3: 0.08
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.06
     rank 17: 0.06
     rank 18: 0.08
     rank 19: 0.06
  all-grads-sync:
     rank  0: 1.19
     rank  1: 1.29
     rank  2: 1.24
     rank  3: 1.29
     rank  4: 2.71
     rank  5: 2.65
     rank  6: 2.71
     rank  7: 2.64
     rank  8: 2.75
     rank  9: 2.64
     rank 10: 2.72
     rank 11: 2.71
     rank 12: 2.11
     rank 13: 2.21
     rank 14: 2.38
     rank 15: 2.28
     rank 16: 2.81
     rank 17: 2.75
     rank 18: 2.99
     rank 19: 2.79
  optimizer-copy-to-main-grad:
     rank  0: 0.04
     rank  1: 0.07
     rank  2: 0.04
     rank  3: 0.05
     rank  4: 0.06
     rank  5: 0.04
     rank  6: 0.06
     rank  7: 0.04
     rank  8: 0.07
     rank  9: 0.05
     rank 10: 0.05
     rank 11: 0.06
     rank 12: 0.04
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.07
     rank 16: 0.08
     rank 17: 0.06
     rank 18: 0.11
     rank 19: 0.06
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.02
  optimizer-inner-step:
     rank  0: 20.46
     rank  1: 20.64
     rank  2: 20.52
     rank  3: 20.53
     rank  4: 53.76
     rank  5: 53.67
     rank  6: 53.87
     rank  7: 53.70
     rank  8: 53.77
     rank  9: 53.63
     rank 10: 53.72
     rank 11: 53.74
     rank 12: 42.77
     rank 13: 43.36
     rank 14: 43.34
     rank 15: 43.08
     rank 16: 57.25
     rank 17: 57.18
     rank 18: 57.06
     rank 19: 57.33
  optimizer:
     rank  0: 21.43
     rank  1: 21.48
     rank  2: 21.49
     rank  3: 21.50
     rank  4: 54.73
     rank  5: 54.65
     rank  6: 54.85
     rank  7: 54.68
     rank  8: 54.75
     rank  9: 54.61
     rank 10: 54.69
     rank 11: 54.71
     rank 12: 43.77
     rank 13: 44.34
     rank 14: 44.32
     rank 15: 44.06
     rank 16: 58.24
     rank 17: 58.17
     rank 18: 58.04
     rank 19: 58.32
 [2025-01-02 12:31:35] iteration        3/      10 | consumed samples:           96 | elapsed time per iteration (ms): 9665.9 | learning rate: 2.250000E-06 | global batch size:    32 | lm loss: 4.436059E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 9564.97
     rank  1: 9565.10
     rank  2: 9565.08
     rank  3: 9565.04
     rank  4: 9567.92
     rank  5: 9567.92
     rank  6: 9568.02
     rank  7: 9567.89
     rank  8: 9568.05
     rank  9: 9568.01
     rank 10: 9568.10
     rank 11: 9567.99
     rank 12: 9567.06
     rank 13: 9566.98
     rank 14: 9567.14
     rank 15: 9567.01
     rank 16: 9568.33
     rank 17: 9568.27
     rank 18: 9568.42
     rank 19: 9568.28
  forward-compute:
     rank  0: 4033.88
     rank  1: 4034.14
     rank  2: 4028.83
     rank  3: 4033.50
     rank  4: 3574.44
     rank  5: 3582.67
     rank  6: 3572.79
     rank  7: 3583.88
     rank  8: 3594.87
     rank  9: 3593.07
     rank 10: 3601.18
     rank 11: 3598.62
     rank 12: 3689.83
     rank 13: 3690.36
     rank 14: 3698.46
     rank 15: 3690.86
     rank 16: 3593.78
     rank 17: 3606.38
     rank 18: 3597.15
     rank 19: 3597.02
  backward-compute:
     rank  0: 1161.11
     rank  1: 1166.95
     rank  2: 1159.82
     rank  3: 1169.09
     rank  4: 4217.79
     rank  5: 4214.71
     rank  6: 4218.48
     rank  7: 4214.08
     rank  8: 4232.96
     rank  9: 4242.93
     rank 10: 4273.87
     rank 11: 4256.52
     rank 12: 4242.38
     rank 13: 4251.08
     rank 14: 4224.44
     rank 15: 4229.32
     rank 16: 4744.09
     rank 17: 4743.67
     rank 18: 4746.11
     rank 19: 4750.50
  pure-backward-compute:
     rank  0: 1159.41
     rank  1: 1165.22
     rank  2: 1158.18
     rank  3: 1167.50
     rank  4: 4215.18
     rank  5: 4213.32
     rank  6: 4215.88
     rank  7: 4212.73
     rank  8: 4230.75
     rank  9: 4240.78
     rank 10: 4272.29
     rank 11: 4254.30
     rank 12: 4237.98
     rank 13: 4248.82
     rank 14: 4218.90
     rank 15: 4226.35
     rank 16: 4738.57
     rank 17: 4739.54
     rank 18: 4740.91
     rank 19: 4746.18
  batch-generator:
     rank  0: 183.14
     rank  1: 197.36
     rank  2: 192.72
     rank  3: 201.62
     rank  4: 91.93
     rank  5: 100.25
     rank  6: 101.11
     rank  7: 108.60
     rank  8: 95.97
     rank  9: 98.53
     rank 10: 99.60
     rank 11: 102.16
     rank 12: 112.48
     rank 13: 123.47
     rank 14: 149.55
     rank 15: 135.98
     rank 16: 116.50
     rank 17: 131.52
     rank 18: 126.08
     rank 19: 127.07
  forward-recv:
     rank  4: 167.63
     rank  5: 168.56
     rank  6: 166.67
     rank  7: 167.11
     rank  8: 262.90
     rank  9: 263.20
     rank 10: 262.87
     rank 11: 261.28
     rank 12: 378.14
     rank 13: 378.53
     rank 14: 379.92
     rank 15: 379.35
     rank 16: 485.34
     rank 17: 484.90
     rank 18: 484.21
     rank 19: 484.75
  forward-send:
     rank  0: 21.88
     rank  1: 22.08
     rank  2: 20.87
     rank  3: 18.69
     rank  4: 15.13
     rank  5: 14.53
     rank  6: 15.17
     rank  7: 13.26
     rank  8: 16.09
     rank  9: 15.81
     rank 10: 16.31
     rank 11: 16.47
     rank 12: 5.10
     rank 13: 4.98
     rank 14: 4.40
     rank 15: 5.01
  backward-recv:
     rank  0: 929.83
     rank  1: 930.22
     rank  2: 930.06
     rank  3: 929.74
     rank  4: 395.33
     rank  5: 396.80
     rank  6: 395.66
     rank  7: 397.37
     rank  8: 262.67
     rank  9: 262.73
     rank 10: 260.77
     rank 11: 262.30
     rank 12: 130.70
     rank 13: 130.69
     rank 14: 132.22
     rank 15: 131.46
  backward-send:
     rank  4: 20.73
     rank  5: 19.79
     rank  6: 20.73
     rank  7: 19.19
     rank  8: 15.00
     rank  9: 14.60
     rank 10: 14.88
     rank 11: 15.01
     rank 12: 9.89
     rank 13: 9.71
     rank 14: 8.06
     rank 15: 9.77
     rank 16: 5.30
     rank 17: 4.80
     rank 18: 5.25
     rank 19: 5.14
  forward-send-backward-recv:
     rank  0: 3402.36
     rank  1: 3396.49
     rank  2: 3409.41
     rank  3: 3399.31
     rank  4: 877.66
     rank  5: 885.30
     rank  6: 876.01
     rank  7: 888.55
     rank  8: 814.60
     rank  9: 802.49
     rank 10: 777.79
     rank 11: 787.57
     rank 12: 484.83
     rank 13: 476.67
     rank 14: 497.82
     rank 15: 496.11
  backward-send-forward-recv:
     rank  4: 231.53
     rank  5: 225.83
     rank  6: 231.74
     rank  7: 224.22
     rank  8: 166.05
     rank  9: 169.09
     rank 10: 163.02
     rank 11: 167.77
     rank 12: 286.39
     rank 13: 288.66
     rank 14: 274.94
     rank 15: 286.02
     rank 16: 262.30
     rank 17: 253.60
     rank 18: 257.57
     rank 19: 255.77
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.03
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.08
     rank  1: 0.07
     rank  2: 0.08
     rank  3: 0.08
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
     rank 16: 0.06
     rank 17: 0.06
     rank 18: 0.08
     rank 19: 0.06
  all-grads-sync:
     rank  0: 1.22
     rank  1: 1.25
     rank  2: 1.22
     rank  3: 1.27
     rank  4: 2.65
     rank  5: 2.64
     rank  6: 2.70
     rank  7: 2.64
     rank  8: 2.76
     rank  9: 2.65
     rank 10: 2.66
     rank 11: 2.67
     rank 12: 2.18
     rank 13: 2.17
     rank 14: 2.34
     rank 15: 2.13
     rank 16: 2.79
     rank 17: 2.75
     rank 18: 3.01
     rank 19: 2.73
  optimizer-copy-to-main-grad:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.04
     rank  5: 0.04
     rank  6: 0.06
     rank  7: 0.04
     rank  8: 0.07
     rank  9: 0.06
     rank 10: 0.04
     rank 11: 0.06
     rank 12: 0.05
     rank 13: 0.04
     rank 14: 0.07
     rank 15: 0.04
     rank 16: 0.06
     rank 17: 0.05
     rank 18: 0.10
     rank 19: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.02
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 20.56
     rank  1: 20.47
     rank  2: 20.52
     rank  3: 20.61
     rank  4: 53.63
     rank  5: 53.61
     rank  6: 53.79
     rank  7: 53.66
     rank  8: 53.76
     rank  9: 53.61
     rank 10: 53.66
     rank 11: 53.67
     rank 12: 42.98
     rank 13: 43.15
     rank 14: 43.50
     rank 15: 42.71
     rank 16: 57.29
     rank 17: 57.09
     rank 18: 57.12
     rank 19: 57.12
  optimizer:
     rank  0: 21.32
     rank  1: 21.26
     rank  2: 21.28
     rank  3: 21.38
     rank  4: 54.41
     rank  5: 54.38
     rank  6: 54.55
     rank  7: 54.43
     rank  8: 54.52
     rank  9: 54.37
     rank 10: 54.42
     rank 11: 54.44
     rank 12: 43.75
     rank 13: 43.91
     rank 14: 44.27
     rank 15: 43.48
     rank 16: 58.06
     rank 17: 57.86
     rank 18: 57.89
     rank 19: 57.89
 [2025-01-02 12:31:44] iteration        4/      10 | consumed samples:          128 | elapsed time per iteration (ms): 9761.3 | learning rate: 3.000000E-06 | global batch size:    32 | lm loss: 3.023907E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 9660.52
     rank  1: 9660.69
     rank  2: 9660.59
     rank  3: 9660.61
     rank  4: 9663.56
     rank  5: 9663.50
     rank  6: 9663.54
     rank  7: 9663.50
     rank  8: 9663.65
     rank  9: 9663.64
     rank 10: 9663.63
     rank 11: 9663.65
     rank 12: 9662.62
     rank 13: 9662.62
     rank 14: 9662.70
     rank 15: 9662.64
     rank 16: 9663.95
     rank 17: 9663.86
     rank 18: 9663.86
     rank 19: 9663.85
  forward-compute:
     rank  0: 4039.39
     rank  1: 4040.52
     rank  2: 4033.78
     rank  3: 4036.94
     rank  4: 3592.51
     rank  5: 3599.27
     rank  6: 3588.56
     rank  7: 3603.26
     rank  8: 3594.56
     rank  9: 3591.31
     rank 10: 3598.27
     rank 11: 3598.15
     rank 12: 3712.95
     rank 13: 3714.38
     rank 14: 3725.20
     rank 15: 3715.36
     rank 16: 3613.59
     rank 17: 3626.10
     rank 18: 3613.07
     rank 19: 3613.61
  backward-compute:
     rank  0: 1161.62
     rank  1: 1164.44
     rank  2: 1159.63
     rank  3: 1168.17
     rank  4: 4217.54
     rank  5: 4213.69
     rank  6: 4218.79
     rank  7: 4214.20
     rank  8: 4241.78
     rank  9: 4251.31
     rank 10: 4282.10
     rank 11: 4262.69
     rank 12: 4268.80
     rank 13: 4281.15
     rank 14: 4249.92
     rank 15: 4252.49
     rank 16: 4815.72
     rank 17: 4818.87
     rank 18: 4818.73
     rank 19: 4827.17
  pure-backward-compute:
     rank  0: 1160.03
     rank  1: 1162.67
     rank  2: 1158.01
     rank  3: 1166.51
     rank  4: 4215.11
     rank  5: 4212.32
     rank  6: 4215.15
     rank  7: 4212.84
     rank  8: 4239.87
     rank  9: 4249.23
     rank 10: 4280.52
     rank 11: 4260.73
     rank 12: 4265.06
     rank 13: 4278.87
     rank 14: 4243.76
     rank 15: 4249.00
     rank 16: 4809.17
     rank 17: 4815.10
     rank 18: 4813.37
     rank 19: 4823.16
  batch-generator:
     rank  0: 178.55
     rank  1: 200.01
     rank  2: 193.26
     rank  3: 201.97
     rank  4: 95.12
     rank  5: 102.40
     rank  6: 102.39
     rank  7: 111.98
     rank  8: 91.36
     rank  9: 93.39
     rank 10: 94.35
     rank 11: 96.54
     rank 12: 109.27
     rank 13: 120.60
     rank 14: 151.16
     rank 15: 134.93
     rank 16: 116.69
     rank 17: 132.26
     rank 18: 124.34
     rank 19: 124.61
  forward-recv:
     rank  4: 163.74
     rank  5: 164.65
     rank  6: 163.23
     rank  7: 163.13
     rank  8: 261.56
     rank  9: 260.81
     rank 10: 262.81
     rank 11: 260.73
     rank 12: 371.79
     rank 13: 372.34
     rank 14: 371.61
     rank 15: 371.91
     rank 16: 488.93
     rank 17: 488.77
     rank 18: 488.34
     rank 19: 488.51
  forward-send:
     rank  0: 20.29
     rank  1: 20.20
     rank  2: 19.91
     rank  3: 17.39
     rank  4: 15.26
     rank  5: 14.54
     rank  6: 15.34
     rank  7: 13.47
     rank  8: 16.34
     rank  9: 16.46
     rank 10: 14.85
     rank 11: 15.44
     rank 12: 5.08
     rank 13: 5.03
     rank 14: 4.73
     rank 15: 4.77
  backward-recv:
     rank  0: 938.83
     rank  1: 938.98
     rank  2: 938.83
     rank  3: 939.35
     rank  4: 400.32
     rank  5: 401.12
     rank  6: 400.10
     rank  7: 400.70
     rank  8: 265.16
     rank  9: 265.29
     rank 10: 264.64
     rank 11: 264.69
     rank 12: 131.33
     rank 13: 131.23
     rank 14: 132.34
     rank 15: 132.20
  backward-send:
     rank  4: 22.40
     rank  5: 21.58
     rank  6: 22.42
     rank  7: 21.58
     rank  8: 14.96
     rank  9: 14.89
     rank 10: 14.84
     rank 11: 14.61
     rank 12: 10.24
     rank 13: 10.23
     rank 14: 9.45
     rank 15: 9.63
     rank 16: 5.26
     rank 17: 4.86
     rank 18: 5.29
     rank 19: 5.17
  forward-send-backward-recv:
     rank  0: 3485.14
     rank  1: 3481.35
     rank  2: 3492.60
     rank  3: 3484.16
     rank  4: 949.71
     rank  5: 959.68
     rank  6: 950.79
     rank  7: 961.42
     rank  8: 903.21
     rank  9: 891.93
     rank 10: 865.26
     rank 11: 877.14
     rank 12: 531.51
     rank 13: 518.53
     rank 14: 543.60
     rank 15: 545.79
  backward-send-forward-recv:
     rank  4: 234.43
     rank  5: 228.99
     rank  6: 234.62
     rank  7: 225.68
     rank  8: 164.35
     rank  9: 167.97
     rank 10: 162.74
     rank 11: 166.76
     rank 12: 291.42
     rank 13: 292.19
     rank 14: 277.30
     rank 15: 289.61
     rank 16: 259.84
     rank 17: 251.86
     rank 18: 259.08
     rank 19: 256.41
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.04
     rank 15: 0.03
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.08
     rank  2: 0.08
     rank  3: 0.08
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
     rank 16: 0.08
     rank 17: 0.06
     rank 18: 0.06
     rank 19: 0.05
  all-grads-sync:
     rank  0: 1.18
     rank  1: 1.28
     rank  2: 1.22
     rank  3: 1.28
     rank  4: 2.67
     rank  5: 2.64
     rank  6: 2.70
     rank  7: 2.63
     rank  8: 2.67
     rank  9: 2.65
     rank 10: 2.70
     rank 11: 2.69
     rank 12: 2.13
     rank 13: 2.21
     rank 14: 2.41
     rank 15: 2.19
     rank 16: 2.98
     rank 17: 2.77
     rank 18: 2.73
     rank 19: 2.74
  optimizer-copy-to-main-grad:
     rank  0: 0.03
     rank  1: 0.05
     rank  2: 0.04
     rank  3: 0.06
     rank  4: 0.05
     rank  5: 0.04
     rank  6: 0.05
     rank  7: 0.04
     rank  8: 0.07
     rank  9: 0.05
     rank 10: 0.05
     rank 11: 0.06
     rank 12: 0.06
     rank 13: 0.06
     rank 14: 0.09
     rank 15: 0.06
     rank 16: 0.07
     rank 17: 0.05
     rank 18: 0.06
     rank 19: 0.06
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.01
     rank 19: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 20.50
     rank  1: 20.45
     rank  2: 20.46
     rank  3: 20.54
     rank  4: 53.72
     rank  5: 53.61
     rank  6: 53.86
     rank  7: 53.66
     rank  8: 53.75
     rank  9: 53.64
     rank 10: 53.74
     rank 11: 53.74
     rank 12: 43.00
     rank 13: 43.46
     rank 14: 43.47
     rank 15: 43.03
     rank 16: 57.24
     rank 17: 57.17
     rank 18: 56.90
     rank 19: 57.25
  optimizer:
     rank  0: 21.31
     rank  1: 21.26
     rank  2: 21.28
     rank  3: 21.35
     rank  4: 54.54
     rank  5: 54.43
     rank  6: 54.67
     rank  7: 54.47
     rank  8: 54.58
     rank  9: 54.45
     rank 10: 54.55
     rank 11: 54.56
     rank 12: 43.82
     rank 13: 44.28
     rank 14: 44.30
     rank 15: 43.85
     rank 16: 58.06
     rank 17: 58.00
     rank 18: 57.71
     rank 19: 58.07
 [2025-01-02 12:31:54] iteration        5/      10 | consumed samples:          160 | elapsed time per iteration (ms): 9784.3 | learning rate: 3.750000E-06 | global batch size:    32 | lm loss: 2.595140E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 9683.71
     rank  1: 9683.81
     rank  2: 9683.74
     rank  3: 9683.73
     rank  4: 9686.63
     rank  5: 9686.63
     rank  6: 9686.63
     rank  7: 9686.57
     rank  8: 9686.72
     rank  9: 9686.74
     rank 10: 9686.72
     rank 11: 9686.66
     rank 12: 9685.71
     rank 13: 9685.67
     rank 14: 9685.78
     rank 15: 9685.71
     rank 16: 9687.02
     rank 17: 9686.92
     rank 18: 9686.98
     rank 19: 9686.94
  forward-compute:
     rank  0: 4033.24
     rank  1: 4034.63
     rank  2: 4026.84
     rank  3: 4032.97
     rank  4: 3582.66
     rank  5: 3589.30
     rank  6: 3580.75
     rank  7: 3595.37
     rank  8: 3596.54
     rank  9: 3594.67
     rank 10: 3602.35
     rank 11: 3601.55
     rank 12: 3719.88
     rank 13: 3718.02
     rank 14: 3727.63
     rank 15: 3713.44
     rank 16: 3624.45
     rank 17: 3636.15
     rank 18: 3623.95
     rank 19: 3625.59
  backward-compute:
     rank  0: 1162.75
     rank  1: 1165.45
     rank  2: 1161.77
     rank  3: 1169.28
     rank  4: 4226.48
     rank  5: 4223.64
     rank  6: 4227.75
     rank  7: 4224.60
     rank  8: 4250.68
     rank  9: 4257.53
     rank 10: 4288.89
     rank 11: 4264.71
     rank 12: 4275.70
     rank 13: 4284.77
     rank 14: 4254.68
     rank 15: 4262.76
     rank 16: 4829.59
     rank 17: 4833.27
     rank 18: 4832.90
     rank 19: 4840.49
  pure-backward-compute:
     rank  0: 1161.09
     rank  1: 1163.68
     rank  2: 1160.10
     rank  3: 1167.69
     rank  4: 4224.16
     rank  5: 4221.96
     rank  6: 4225.18
     rank  7: 4223.20
     rank  8: 4248.83
     rank  9: 4255.31
     rank 10: 4287.42
     rank 11: 4262.75
     rank 12: 4272.05
     rank 13: 4282.55
     rank 14: 4248.64
     rank 15: 4258.96
     rank 16: 4823.54
     rank 17: 4829.52
     rank 18: 4827.57
     rank 19: 4836.86
  batch-generator:
     rank  0: 177.81
     rank  1: 191.99
     rank  2: 185.73
     rank  3: 197.75
     rank  4: 95.00
     rank  5: 102.08
     rank  6: 100.93
     rank  7: 112.85
     rank  8: 94.39
     rank  9: 97.42
     rank 10: 99.82
     rank 11: 102.00
     rank 12: 111.27
     rank 13: 119.53
     rank 14: 147.32
     rank 15: 127.81
     rank 16: 114.38
     rank 17: 127.79
     rank 18: 120.95
     rank 19: 122.39
  forward-recv:
     rank  4: 171.19
     rank  5: 171.79
     rank  6: 170.70
     rank  7: 169.53
     rank  8: 266.29
     rank  9: 263.73
     rank 10: 264.19
     rank 11: 262.31
     rank 12: 380.47
     rank 13: 382.20
     rank 14: 382.41
     rank 15: 382.84
     rank 16: 484.13
     rank 17: 483.98
     rank 18: 483.81
     rank 19: 483.60
  forward-send:
     rank  0: 24.21
     rank  1: 24.03
     rank  2: 23.73
     rank  3: 20.33
     rank  4: 15.25
     rank  5: 14.56
     rank  6: 15.16
     rank  7: 13.08
     rank  8: 17.09
     rank  9: 18.96
     rank 10: 18.66
     rank 11: 18.94
     rank 12: 5.17
     rank 13: 5.05
     rank 14: 4.95
     rank 15: 4.68
  backward-recv:
     rank  0: 938.24
     rank  1: 937.99
     rank  2: 938.55
     rank  3: 938.75
     rank  4: 399.37
     rank  5: 400.77
     rank  6: 399.26
     rank  7: 399.76
     rank  8: 264.62
     rank  9: 264.69
     rank 10: 264.43
     rank 11: 264.17
     rank 12: 131.51
     rank 13: 131.96
     rank 14: 133.12
     rank 15: 132.69
  backward-send:
     rank  4: 21.04
     rank  5: 19.78
     rank  6: 21.05
     rank  7: 20.60
     rank  8: 14.88
     rank  9: 15.19
     rank 10: 14.66
     rank 11: 14.32
     rank 12: 10.18
     rank 13: 10.05
     rank 14: 9.74
     rank 15: 9.33
     rank 16: 5.23
     rank 17: 4.97
     rank 18: 5.30
     rank 19: 5.19
  forward-send-backward-recv:
     rank  0: 3510.22
     rank  1: 3506.77
     rank  2: 3517.18
     rank  3: 3508.34
     rank  4: 969.36
     rank  5: 977.65
     rank  6: 969.56
     rank  7: 979.52
     rank  8: 910.13
     rank  9: 899.94
     rank 10: 873.01
     rank 11: 890.88
     rank 12: 533.76
     rank 13: 523.50
     rank 14: 547.95
     rank 15: 543.91
  backward-send-forward-recv:
     rank  4: 234.37
     rank  5: 228.70
     rank  6: 234.53
     rank  7: 224.55
     rank  8: 164.08
     rank  9: 168.12
     rank 10: 162.85
     rank 11: 166.54
     rank 12: 289.78
     rank 13: 292.15
     rank 14: 276.52
     rank 15: 293.43
     rank 16: 263.08
     rank 17: 255.41
     rank 18: 261.34
     rank 19: 259.10
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.07
     rank  1: 0.08
     rank  2: 0.08
     rank  3: 0.08
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
     rank 16: 0.07
     rank 17: 0.06
     rank 18: 0.06
     rank 19: 0.06
  all-grads-sync:
     rank  0: 1.21
     rank  1: 1.27
     rank  2: 1.26
     rank  3: 1.26
     rank  4: 2.65
     rank  5: 2.68
     rank  6: 2.71
     rank  7: 2.65
     rank  8: 2.76
     rank  9: 2.73
     rank 10: 2.67
     rank 11: 2.65
     rank 12: 2.16
     rank 13: 2.12
     rank 14: 2.30
     rank 15: 2.18
     rank 16: 2.80
     rank 17: 2.70
     rank 18: 2.78
     rank 19: 2.70
  optimizer-copy-to-main-grad:
     rank  0: 0.03
     rank  1: 0.04
     rank  2: 0.03
     rank  3: 0.04
     rank  4: 0.05
     rank  5: 0.04
     rank  6: 0.06
     rank  7: 0.04
     rank  8: 0.11
     rank  9: 0.06
     rank 10: 0.04
     rank 11: 0.05
     rank 12: 0.05
     rank 13: 0.04
     rank 14: 0.07
     rank 15: 0.05
     rank 16: 0.08
     rank 17: 0.04
     rank 18: 0.06
     rank 19: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.02
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 20.48
     rank  1: 20.50
     rank  2: 20.55
     rank  3: 20.49
     rank  4: 53.69
     rank  5: 53.73
     rank  6: 53.85
     rank  7: 53.68
     rank  8: 53.77
     rank  9: 53.78
     rank 10: 53.67
     rank 11: 53.68
     rank 12: 42.80
     rank 13: 43.31
     rank 14: 43.51
     rank 15: 42.88
     rank 16: 57.15
     rank 17: 56.97
     rank 18: 56.92
     rank 19: 57.22
  optimizer:
     rank  0: 21.27
     rank  1: 21.29
     rank  2: 21.34
     rank  3: 21.28
     rank  4: 54.49
     rank  5: 54.53
     rank  6: 54.65
     rank  7: 54.47
     rank  8: 54.57
     rank  9: 54.58
     rank 10: 54.47
     rank 11: 54.47
     rank 12: 43.61
     rank 13: 44.11
     rank 14: 44.32
     rank 15: 43.68
     rank 16: 57.95
     rank 17: 57.77
     rank 18: 57.73
     rank 19: 58.02
 [2025-01-02 12:32:04] iteration        6/      10 | consumed samples:          192 | elapsed time per iteration (ms): 9809.9 | learning rate: 4.500000E-06 | global batch size:    32 | lm loss: 2.299130E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 9709.55
     rank  1: 9709.66
     rank  2: 9709.55
     rank  3: 9709.70
     rank  4: 9712.54
     rank  5: 9712.44
     rank  6: 9712.56
     rank  7: 9712.46
     rank  8: 9712.60
     rank  9: 9712.53
     rank 10: 9712.61
     rank 11: 9712.57
     rank 12: 9711.57
     rank 13: 9711.45
     rank 14: 9711.56
     rank 15: 9711.59
     rank 16: 9712.86
     rank 17: 9712.79
     rank 18: 9712.93
     rank 19: 9712.81
  forward-compute:
     rank  0: 3992.40
     rank  1: 3993.42
     rank  2: 3985.09
     rank  3: 3991.93
     rank  4: 3575.76
     rank  5: 3582.64
     rank  6: 3572.62
     rank  7: 3586.18
     rank  8: 3594.17
     rank  9: 3589.04
     rank 10: 3600.81
     rank 11: 3597.96
     rank 12: 3716.60
     rank 13: 3716.34
     rank 14: 3729.81
     rank 15: 3717.58
     rank 16: 3632.56
     rank 17: 3643.89
     rank 18: 3633.02
     rank 19: 3635.79
  backward-compute:
     rank  0: 1164.49
     rank  1: 1165.95
     rank  2: 1164.14
     rank  3: 1167.86
     rank  4: 4231.12
     rank  5: 4226.44
     rank  6: 4233.62
     rank  7: 4228.66
     rank  8: 4240.72
     rank  9: 4249.15
     rank 10: 4284.69
     rank 11: 4261.42
     rank 12: 4279.10
     rank 13: 4288.10
     rank 14: 4258.75
     rank 15: 4270.35
     rank 16: 4849.67
     rank 17: 4853.57
     rank 18: 4852.43
     rank 19: 4859.46
  pure-backward-compute:
     rank  0: 1162.88
     rank  1: 1164.24
     rank  2: 1162.34
     rank  3: 1166.00
     rank  4: 4228.98
     rank  5: 4225.02
     rank  6: 4231.16
     rank  7: 4227.25
     rank  8: 4238.90
     rank  9: 4247.05
     rank 10: 4283.27
     rank 11: 4259.37
     rank 12: 4275.41
     rank 13: 4285.09
     rank 14: 4253.02
     rank 15: 4266.38
     rank 16: 4843.70
     rank 17: 4849.83
     rank 18: 4847.12
     rank 19: 4855.75
  batch-generator:
     rank  0: 134.62
     rank  1: 150.63
     rank  2: 145.40
     rank  3: 155.30
     rank  4: 89.93
     rank  5: 97.76
     rank  6: 95.27
     rank  7: 106.09
     rank  8: 90.16
     rank  9: 91.50
     rank 10: 96.12
     rank 11: 97.93
     rank 12: 113.80
     rank 13: 123.69
     rank 14: 155.76
     rank 15: 137.03
     rank 16: 114.51
     rank 17: 127.06
     rank 18: 121.86
     rank 19: 124.34
  forward-recv:
     rank  4: 166.14
     rank  5: 166.51
     rank  6: 165.45
     rank  7: 165.92
     rank  8: 270.69
     rank  9: 268.97
     rank 10: 269.21
     rank 11: 267.52
     rank 12: 372.23
     rank 13: 372.89
     rank 14: 374.24
     rank 15: 373.42
     rank 16: 482.29
     rank 17: 481.95
     rank 18: 481.14
     rank 19: 481.74
  forward-send:
     rank  0: 21.07
     rank  1: 20.82
     rank  2: 20.34
     rank  3: 18.27
     rank  4: 15.09
     rank  5: 14.65
     rank  6: 15.18
     rank  7: 12.97
     rank  8: 9.50
     rank  9: 10.58
     rank 10: 10.41
     rank 11: 10.43
     rank 12: 5.10
     rank 13: 5.09
     rank 14: 4.47
     rank 15: 5.04
  backward-recv:
     rank  0: 944.30
     rank  1: 944.67
     rank  2: 944.45
     rank  3: 944.90
     rank  4: 403.58
     rank  5: 404.25
     rank  6: 403.30
     rank  7: 404.36
     rank  8: 267.37
     rank  9: 267.25
     rank 10: 266.90
     rank 11: 266.68
     rank 12: 133.51
     rank 13: 133.06
     rank 14: 134.23
     rank 15: 134.15
  backward-send:
     rank  4: 23.48
     rank  5: 22.68
     rank  6: 23.79
     rank  7: 22.53
     rank  8: 14.89
     rank  9: 14.88
     rank 10: 14.66
     rank 11: 14.83
     rank 12: 10.29
     rank 13: 10.24
     rank 14: 9.43
     rank 15: 9.84
     rank 16: 5.27
     rank 17: 4.71
     rank 18: 5.27
     rank 19: 5.19
  forward-send-backward-recv:
     rank  0: 3571.63
     rank  1: 3569.58
     rank  2: 3579.27
     rank  3: 3571.14
     rank  4: 994.38
     rank  5: 1005.62
     rank  6: 995.96
     rank  7: 1005.50
     rank  8: 948.57
     rank  9: 937.51
     rank 10: 906.85
     rank 11: 922.58
     rank 12: 558.15
     rank 13: 549.14
     rank 14: 573.44
     rank 15: 564.79
  backward-send-forward-recv:
     rank  4: 234.88
     rank  5: 229.19
     rank  6: 235.34
     rank  7: 225.88
     rank  8: 164.61
     rank  9: 170.49
     rank 10: 161.38
     rank 11: 167.08
     rank 12: 297.02
     rank 13: 297.48
     rank 14: 279.24
     rank 15: 293.90
     rank 16: 261.88
     rank 17: 254.00
     rank 18: 260.21
     rank 19: 256.44
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.03
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.08
     rank  1: 0.08
     rank  2: 0.10
     rank  3: 0.10
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.04
     rank 14: 0.03
     rank 15: 0.03
     rank 16: 0.06
     rank 17: 0.05
     rank 18: 0.08
     rank 19: 0.05
  all-grads-sync:
     rank  0: 1.22
     rank  1: 1.25
     rank  2: 1.36
     rank  3: 1.33
     rank  4: 2.82
     rank  5: 2.64
     rank  6: 2.68
     rank  7: 2.63
     rank  8: 2.67
     rank  9: 2.65
     rank 10: 2.65
     rank 11: 2.66
     rank 12: 2.11
     rank 13: 2.16
     rank 14: 2.13
     rank 15: 2.23
     rank 16: 2.79
     rank 17: 2.75
     rank 18: 2.92
     rank 19: 2.70
  optimizer-copy-to-main-grad:
     rank  0: 0.03
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.09
     rank  5: 0.04
     rank  6: 0.05
     rank  7: 0.04
     rank  8: 0.07
     rank  9: 0.05
     rank 10: 0.04
     rank 11: 0.05
     rank 12: 0.04
     rank 13: 0.05
     rank 14: 0.04
     rank 15: 0.06
     rank 16: 0.07
     rank 17: 0.04
     rank 18: 0.10
     rank 19: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 20.52
     rank  1: 20.50
     rank  2: 20.55
     rank  3: 20.60
     rank  4: 53.74
     rank  5: 53.66
     rank  6: 53.77
     rank  7: 53.66
     rank  8: 53.65
     rank  9: 53.63
     rank 10: 53.67
     rank 11: 53.66
     rank 12: 42.94
     rank 13: 43.25
     rank 14: 43.30
     rank 15: 42.85
     rank 16: 57.05
     rank 17: 56.97
     rank 18: 56.91
     rank 19: 57.28
  optimizer:
     rank  0: 21.22
     rank  1: 21.22
     rank  2: 21.25
     rank  3: 21.30
     rank  4: 54.44
     rank  5: 54.36
     rank  6: 54.47
     rank  7: 54.36
     rank  8: 54.35
     rank  9: 54.33
     rank 10: 54.39
     rank 11: 54.36
     rank 12: 43.64
     rank 13: 43.95
     rank 14: 44.00
     rank 15: 43.55
     rank 16: 57.74
     rank 17: 57.67
     rank 18: 57.61
     rank 19: 57.98
 [2025-01-02 12:32:14] iteration        7/      10 | consumed samples:          224 | elapsed time per iteration (ms): 9876.0 | learning rate: 5.250000E-06 | global batch size:    32 | lm loss: 1.897869E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 9774.90
     rank  1: 9774.98
     rank  2: 9775.11
     rank  3: 9774.96
     rank  4: 9777.78
     rank  5: 9777.81
     rank  6: 9777.88
     rank  7: 9777.81
     rank  8: 9777.87
     rank  9: 9777.92
     rank 10: 9777.96
     rank 11: 9777.92
     rank 12: 9776.84
     rank 13: 9776.89
     rank 14: 9776.96
     rank 15: 9776.87
     rank 16: 9778.17
     rank 17: 9778.15
     rank 18: 9778.21
     rank 19: 9778.15
  forward-compute:
     rank  0: 4047.32
     rank  1: 4048.38
     rank  2: 4041.67
     rank  3: 4044.38
     rank  4: 3595.30
     rank  5: 3603.05
     rank  6: 3592.09
     rank  7: 3605.51
     rank  8: 3590.86
     rank  9: 3590.14
     rank 10: 3596.58
     rank 11: 3595.42
     rank 12: 3722.00
     rank 13: 3722.04
     rank 14: 3730.76
     rank 15: 3723.35
     rank 16: 3664.96
     rank 17: 3668.09
     rank 18: 3663.02
     rank 19: 3666.50
  backward-compute:
     rank  0: 1164.40
     rank  1: 1164.94
     rank  2: 1163.41
     rank  3: 1168.24
     rank  4: 4228.41
     rank  5: 4224.78
     rank  6: 4229.01
     rank  7: 4224.97
     rank  8: 4238.63
     rank  9: 4249.87
     rank 10: 4279.67
     rank 11: 4262.12
     rank 12: 4306.08
     rank 13: 4303.35
     rank 14: 4282.84
     rank 15: 4294.47
     rank 16: 4880.44
     rank 17: 4886.36
     rank 18: 4884.77
     rank 19: 4889.89
  pure-backward-compute:
     rank  0: 1162.77
     rank  1: 1163.22
     rank  2: 1161.63
     rank  3: 1166.62
     rank  4: 4225.95
     rank  5: 4223.25
     rank  6: 4226.64
     rank  7: 4223.60
     rank  8: 4236.75
     rank  9: 4247.73
     rank 10: 4278.23
     rank 11: 4260.12
     rank 12: 4302.81
     rank 13: 4300.37
     rank 14: 4276.81
     rank 15: 4290.63
     rank 16: 4874.41
     rank 17: 4882.53
     rank 18: 4879.45
     rank 19: 4886.21
  batch-generator:
     rank  0: 188.28
     rank  1: 203.15
     rank  2: 197.20
     rank  3: 205.78
     rank  4: 98.35
     rank  5: 105.25
     rank  6: 103.57
     rank  7: 114.22
     rank  8: 91.43
     rank  9: 93.45
     rank 10: 95.35
     rank 11: 97.90
     rank 12: 109.79
     rank 13: 119.49
     rank 14: 146.08
     rank 15: 132.41
     rank 16: 114.40
     rank 17: 119.12
     rank 18: 119.62
     rank 19: 122.59
  forward-recv:
     rank  4: 164.73
     rank  5: 165.11
     rank  6: 163.32
     rank  7: 164.86
     rank  8: 261.22
     rank  9: 258.61
     rank 10: 259.29
     rank 11: 257.19
     rank 12: 376.46
     rank 13: 378.35
     rank 14: 378.88
     rank 15: 378.90
     rank 16: 485.58
     rank 17: 485.59
     rank 18: 485.04
     rank 19: 485.06
  forward-send:
     rank  0: 20.53
     rank  1: 20.39
     rank  2: 19.56
     rank  3: 18.47
     rank  4: 15.04
     rank  5: 14.50
     rank  6: 15.10
     rank  7: 13.24
     rank  8: 17.71
     rank  9: 19.75
     rank 10: 19.39
     rank 11: 19.68
     rank 12: 5.19
     rank 13: 5.12
     rank 14: 4.93
     rank 15: 4.85
  backward-recv:
     rank  0: 949.43
     rank  1: 950.11
     rank  2: 949.54
     rank  3: 949.95
     rank  4: 406.26
     rank  5: 407.08
     rank  6: 406.67
     rank  7: 406.87
     rank  8: 271.67
     rank  9: 271.93
     rank 10: 270.88
     rank 11: 271.60
     rank 12: 133.30
     rank 13: 133.32
     rank 14: 134.12
     rank 15: 133.89
  backward-send:
     rank  4: 22.89
     rank  5: 22.42
     rank  6: 22.74
     rank  7: 22.23
     rank  8: 15.01
     rank  9: 14.78
     rank 10: 15.11
     rank 11: 14.62
     rank 12: 10.29
     rank 13: 10.18
     rank 14: 9.45
     rank 15: 9.88
     rank 16: 5.20
     rank 17: 5.00
     rank 18: 5.28
     rank 19: 5.19
  forward-send-backward-recv:
     rank  0: 3577.82
     rank  1: 3576.26
     rank  2: 3584.88
     rank  3: 3579.20
     rank  4: 1027.36
     rank  5: 1037.06
     rank  6: 1030.45
     rank  7: 1039.35
     rank  8: 1014.06
     rank  9: 999.60
     rank 10: 975.68
     rank 11: 985.51
     rank 12: 578.78
     rank 13: 579.89
     rank 14: 595.78
     rank 15: 587.22
  backward-send-forward-recv:
     rank  4: 249.76
     rank  5: 243.79
     rank  6: 250.44
     rank  7: 240.41
     rank  8: 165.65
     rank  9: 168.27
     rank 10: 162.69
     rank 11: 167.46
     rank 12: 306.00
     rank 13: 304.72
     rank 14: 290.71
     rank 15: 301.43
     rank 16: 261.12
     rank 17: 258.69
     rank 18: 259.17
     rank 19: 257.04
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.03
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.07
     rank  1: 0.07
     rank  2: 0.10
     rank  3: 0.10
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.06
     rank 17: 0.06
     rank 18: 0.08
     rank 19: 0.06
  all-grads-sync:
     rank  0: 1.23
     rank  1: 1.22
     rank  2: 1.30
     rank  3: 1.31
     rank  4: 2.68
     rank  5: 2.64
     rank  6: 2.69
     rank  7: 2.70
     rank  8: 2.67
     rank  9: 2.65
     rank 10: 2.69
     rank 11: 2.68
     rank 12: 2.17
     rank 13: 2.16
     rank 14: 2.20
     rank 15: 2.13
     rank 16: 2.78
     rank 17: 2.79
     rank 18: 2.83
     rank 19: 2.76
  optimizer-copy-to-main-grad:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.04
     rank  4: 0.05
     rank  5: 0.04
     rank  6: 0.05
     rank  7: 0.04
     rank  8: 0.07
     rank  9: 0.05
     rank 10: 0.04
     rank 11: 0.06
     rank 12: 0.05
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.04
     rank 16: 0.06
     rank 17: 0.05
     rank 18: 0.08
     rank 19: 0.06
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.02
     rank 18: 0.01
     rank 19: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.02
  optimizer-inner-step:
     rank  0: 20.50
     rank  1: 20.44
     rank  2: 20.43
     rank  3: 20.54
     rank  4: 53.71
     rank  5: 53.65
     rank  6: 53.83
     rank  7: 53.75
     rank  8: 53.69
     rank  9: 53.63
     rank 10: 53.74
     rank 11: 53.74
     rank 12: 42.77
     rank 13: 43.25
     rank 14: 43.34
     rank 15: 42.71
     rank 16: 56.99
     rank 17: 57.12
     rank 18: 56.97
     rank 19: 57.26
  optimizer:
     rank  0: 21.13
     rank  1: 21.07
     rank  2: 21.06
     rank  3: 21.18
     rank  4: 54.34
     rank  5: 54.27
     rank  6: 54.46
     rank  7: 54.37
     rank  8: 54.32
     rank  9: 54.25
     rank 10: 54.36
     rank 11: 54.36
     rank 12: 43.39
     rank 13: 43.88
     rank 14: 43.97
     rank 15: 43.34
     rank 16: 57.61
     rank 17: 57.75
     rank 18: 57.60
     rank 19: 57.88
 [2025-01-02 12:32:24] iteration        8/      10 | consumed samples:          256 | elapsed time per iteration (ms): 9953.6 | learning rate: 6.000000E-06 | global batch size:    32 | lm loss: 2.242702E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 9853.74
     rank  1: 9853.84
     rank  2: 9853.76
     rank  3: 9853.80
     rank  4: 9856.66
     rank  5: 9856.68
     rank  6: 9856.65
     rank  7: 9856.69
     rank  8: 9856.77
     rank  9: 9856.78
     rank 10: 9856.75
     rank 11: 9856.76
     rank 12: 9855.76
     rank 13: 9855.75
     rank 14: 9855.78
     rank 15: 9855.76
     rank 16: 9857.01
     rank 17: 9857.08
     rank 18: 9857.01
     rank 19: 9857.02
  forward-compute:
     rank  0: 4039.67
     rank  1: 4040.43
     rank  2: 4032.93
     rank  3: 4039.50
     rank  4: 3570.93
     rank  5: 3579.29
     rank  6: 3568.70
     rank  7: 3584.50
     rank  8: 3587.76
     rank  9: 3585.08
     rank 10: 3592.64
     rank 11: 3591.47
     rank 12: 3711.90
     rank 13: 3712.99
     rank 14: 3724.37
     rank 15: 3716.34
     rank 16: 3690.62
     rank 17: 3684.23
     rank 18: 3685.28
     rank 19: 3695.35
  backward-compute:
     rank  0: 1167.02
     rank  1: 1169.70
     rank  2: 1166.63
     rank  3: 1173.56
     rank  4: 4229.79
     rank  5: 4226.10
     rank  6: 4230.39
     rank  7: 4226.82
     rank  8: 4240.72
     rank  9: 4251.59
     rank 10: 4280.52
     rank 11: 4263.55
     rank 12: 4303.12
     rank 13: 4283.68
     rank 14: 4271.33
     rank 15: 4294.97
     rank 16: 4939.27
     rank 17: 4950.95
     rank 18: 4947.51
     rank 19: 4948.35
  pure-backward-compute:
     rank  0: 1165.41
     rank  1: 1167.94
     rank  2: 1164.84
     rank  3: 1171.94
     rank  4: 4227.43
     rank  5: 4224.67
     rank  6: 4228.17
     rank  7: 4225.44
     rank  8: 4238.80
     rank  9: 4249.43
     rank 10: 4279.02
     rank 11: 4261.66
     rank 12: 4298.94
     rank 13: 4281.21
     rank 14: 4265.83
     rank 15: 4291.34
     rank 16: 4933.54
     rank 17: 4947.15
     rank 18: 4942.16
     rank 19: 4944.44
  batch-generator:
     rank  0: 167.81
     rank  1: 181.39
     rank  2: 176.40
     rank  3: 185.94
     rank  4: 87.55
     rank  5: 96.59
     rank  6: 93.71
     rank  7: 107.35
     rank  8: 87.44
     rank  9: 90.90
     rank 10: 93.08
     rank 11: 95.80
     rank 12: 111.81
     rank 13: 122.37
     rank 14: 151.31
     rank 15: 138.16
     rank 16: 115.11
     rank 17: 111.49
     rank 18: 117.98
     rank 19: 128.25
  forward-recv:
     rank  4: 170.76
     rank  5: 171.70
     rank  6: 169.52
     rank  7: 169.25
     rank  8: 268.73
     rank  9: 266.23
     rank 10: 266.90
     rank 11: 265.42
     rank 12: 379.01
     rank 13: 380.85
     rank 14: 381.63
     rank 15: 381.37
     rank 16: 485.89
     rank 17: 485.68
     rank 18: 485.08
     rank 19: 485.39
  forward-send:
     rank  0: 24.70
     rank  1: 24.86
     rank  2: 23.74
     rank  3: 21.31
     rank  4: 15.18
     rank  5: 14.36
     rank  6: 15.33
     rank  7: 13.60
     rank  8: 15.18
     rank  9: 16.94
     rank 10: 16.67
     rank 11: 16.85
     rank 12: 5.08
     rank 13: 4.99
     rank 14: 4.49
     rank 15: 4.77
  backward-recv:
     rank  0: 961.99
     rank  1: 962.10
     rank  2: 961.90
     rank  3: 962.74
     rank  4: 415.76
     rank  5: 416.80
     rank  6: 415.80
     rank  7: 415.99
     rank  8: 281.65
     rank  9: 281.85
     rank 10: 280.84
     rank 11: 281.92
     rank 12: 137.50
     rank 13: 140.24
     rank 14: 138.58
     rank 15: 137.89
  backward-send:
     rank  4: 22.45
     rank  5: 21.43
     rank  6: 22.34
     rank  7: 21.93
     rank  8: 15.12
     rank  9: 14.89
     rank 10: 14.92
     rank 11: 14.58
     rank 12: 10.20
     rank 13: 10.12
     rank 14: 9.08
     rank 15: 9.96
     rank 16: 3.94
     rank 17: 6.98
     rank 18: 4.12
     rank 19: 3.86
  forward-send-backward-recv:
     rank  0: 3645.51
     rank  1: 3641.97
     rank  2: 3652.59
     rank  3: 3642.25
     rank  4: 1091.62
     rank  5: 1100.57
     rank  6: 1094.03
     rank  7: 1102.45
     rank  8: 1080.44
     rank  9: 1067.15
     rank 10: 1043.66
     rank 11: 1052.50
     rank 12: 659.47
     rank 13: 677.61
     rank 14: 687.84
     rank 15: 666.18
  backward-send-forward-recv:
     rank  4: 272.97
     rank  5: 266.25
     rank  6: 273.69
     rank  7: 262.11
     rank  8: 165.08
     rank  9: 168.42
     rank 10: 162.75
     rank 11: 166.90
     rank 12: 307.82
     rank 13: 307.65
     rank 14: 291.54
     rank 15: 302.33
     rank 16: 254.96
     rank 17: 256.67
     rank 18: 253.07
     rank 19: 248.50
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.03
     rank 16: 0.02
     rank 17: 0.03
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.07
     rank  1: 0.07
     rank  2: 0.07
     rank  3: 0.09
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.06
     rank 17: 0.09
     rank 18: 0.06
     rank 19: 0.06
  all-grads-sync:
     rank  0: 1.21
     rank  1: 1.23
     rank  2: 1.25
     rank  3: 1.33
     rank  4: 2.64
     rank  5: 2.65
     rank  6: 2.65
     rank  7: 2.64
     rank  8: 2.73
     rank  9: 2.65
     rank 10: 2.65
     rank 11: 2.64
     rank 12: 2.14
     rank 13: 2.13
     rank 14: 2.52
     rank 15: 2.22
     rank 16: 2.80
     rank 17: 2.92
     rank 18: 2.81
     rank 19: 2.73
  optimizer-copy-to-main-grad:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.05
     rank  5: 0.04
     rank  6: 0.05
     rank  7: 0.04
     rank  8: 0.08
     rank  9: 0.05
     rank 10: 0.04
     rank 11: 0.05
     rank 12: 0.05
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.06
     rank 16: 0.06
     rank 17: 0.06
     rank 18: 0.06
     rank 19: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.01
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 20.48
     rank  1: 20.43
     rank  2: 20.54
     rank  3: 20.55
     rank  4: 53.66
     rank  5: 53.69
     rank  6: 53.76
     rank  7: 53.74
     rank  8: 53.78
     rank  9: 53.66
     rank 10: 53.63
     rank 11: 53.64
     rank 12: 42.81
     rank 13: 43.15
     rank 14: 43.39
     rank 15: 42.94
     rank 16: 56.93
     rank 17: 57.16
     rank 18: 56.96
     rank 19: 57.15
  optimizer:
     rank  0: 21.12
     rank  1: 21.09
     rank  2: 21.19
     rank  3: 21.20
     rank  4: 54.30
     rank  5: 54.34
     rank  6: 54.42
     rank  7: 54.39
     rank  8: 54.43
     rank  9: 54.31
     rank 10: 54.27
     rank 11: 54.29
     rank 12: 43.46
     rank 13: 43.80
     rank 14: 44.04
     rank 15: 43.59
     rank 16: 57.59
     rank 17: 57.82
     rank 18: 57.62
     rank 19: 57.80
 [2025-01-02 12:32:34] iteration        9/      10 | consumed samples:          288 | elapsed time per iteration (ms): 10034.6 | learning rate: 6.750000E-06 | global batch size:    32 | lm loss: 1.325985E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 9933.96
     rank  1: 9934.07
     rank  2: 9933.94
     rank  3: 9934.03
     rank  4: 9936.91
     rank  5: 9936.92
     rank  6: 9936.92
     rank  7: 9936.88
     rank  8: 9937.01
     rank  9: 9937.00
     rank 10: 9937.01
     rank 11: 9936.98
     rank 12: 9935.98
     rank 13: 9935.98
     rank 14: 9935.98
     rank 15: 9935.95
     rank 16: 9937.26
     rank 17: 9937.25
     rank 18: 9937.26
     rank 19: 9937.25
  forward-compute:
     rank  0: 4017.80
     rank  1: 4018.24
     rank  2: 4009.48
     rank  3: 4016.04
     rank  4: 3574.43
     rank  5: 3583.54
     rank  6: 3571.28
     rank  7: 3587.34
     rank  8: 3598.88
     rank  9: 3596.99
     rank 10: 3606.84
     rank 11: 3601.34
     rank 12: 3713.09
     rank 13: 3711.70
     rank 14: 3715.95
     rank 15: 3712.41
     rank 16: 3716.67
     rank 17: 3714.39
     rank 18: 3712.53
     rank 19: 3718.40
  backward-compute:
     rank  0: 1167.64
     rank  1: 1174.31
     rank  2: 1168.90
     rank  3: 1177.50
     rank  4: 4228.09
     rank  5: 4224.10
     rank  6: 4229.90
     rank  7: 4223.78
     rank  8: 4240.05
     rank  9: 4247.35
     rank 10: 4270.61
     rank 11: 4257.67
     rank 12: 4304.52
     rank 13: 4294.33
     rank 14: 4274.24
     rank 15: 4293.11
     rank 16: 4992.43
     rank 17: 5002.17
     rank 18: 4999.65
     rank 19: 5001.03
  pure-backward-compute:
     rank  0: 1165.97
     rank  1: 1172.56
     rank  2: 1167.11
     rank  3: 1175.80
     rank  4: 4225.83
     rank  5: 4222.61
     rank  6: 4227.63
     rank  7: 4222.41
     rank  8: 4238.21
     rank  9: 4245.34
     rank 10: 4269.15
     rank 11: 4255.31
     rank 12: 4300.27
     rank 13: 4291.42
     rank 14: 4268.50
     rank 15: 4289.36
     rank 16: 4986.45
     rank 17: 4998.44
     rank 18: 4993.96
     rank 19: 4997.39
  batch-generator:
     rank  0: 165.12
     rank  1: 179.39
     rank  2: 174.96
     rank  3: 184.07
     rank  4: 88.53
     rank  5: 98.32
     rank  6: 93.47
     rank  7: 107.24
     rank  8: 94.32
     rank  9: 96.06
     rank 10: 101.08
     rank 11: 99.73
     rank 12: 108.38
     rank 13: 117.32
     rank 14: 140.51
     rank 15: 129.63
     rank 16: 114.05
     rank 17: 113.39
     rank 18: 117.08
     rank 19: 122.75
  forward-recv:
     rank  4: 165.63
     rank  5: 166.01
     rank  6: 164.76
     rank  7: 165.20
     rank  8: 268.85
     rank  9: 267.42
     rank 10: 267.90
     rank 11: 265.85
     rank 12: 375.23
     rank 13: 375.95
     rank 14: 377.36
     rank 15: 376.79
     rank 16: 482.81
     rank 17: 482.69
     rank 18: 481.74
     rank 19: 482.19
  forward-send:
     rank  0: 22.18
     rank  1: 22.10
     rank  2: 21.34
     rank  3: 19.27
     rank  4: 15.15
     rank  5: 14.78
     rank  6: 15.08
     rank  7: 13.06
     rank  8: 12.16
     rank  9: 13.22
     rank 10: 12.78
     rank 11: 13.18
     rank 12: 4.98
     rank 13: 5.11
     rank 14: 4.26
     rank 15: 4.69
  backward-recv:
     rank  0: 972.61
     rank  1: 973.26
     rank  2: 972.77
     rank  3: 971.71
     rank  4: 422.24
     rank  5: 423.26
     rank  6: 422.46
     rank  7: 423.95
     rank  8: 283.25
     rank  9: 282.81
     rank 10: 282.08
     rank 11: 282.53
     rank 12: 137.76
     rank 13: 138.06
     rank 14: 138.87
     rank 15: 137.97
  backward-send:
     rank  4: 25.15
     rank  5: 24.59
     rank  6: 25.06
     rank  7: 23.50
     rank  8: 14.71
     rank  9: 15.17
     rank 10: 14.92
     rank 11: 14.71
     rank 12: 9.93
     rank 13: 10.00
     rank 14: 9.14
     rank 15: 9.69
     rank 16: 5.24
     rank 17: 5.09
     rank 18: 5.25
     rank 19: 4.68
  forward-send-backward-recv:
     rank  0: 3738.65
     rank  1: 3731.23
     rank  2: 3745.81
     rank  3: 3735.35
     rank  4: 1156.88
     rank  5: 1165.76
     rank  6: 1158.42
     rank  7: 1169.01
     rank  8: 1151.11
     rank  9: 1141.42
     rank 10: 1123.85
     rank 11: 1129.12
     rank 12: 740.74
     rank 13: 750.49
     rank 14: 765.04
     rank 15: 749.03
  backward-send-forward-recv:
     rank  4: 281.93
     rank  5: 274.20
     rank  6: 282.87
     rank  7: 270.54
     rank  8: 165.23
     rank  9: 168.13
     rank 10: 160.31
     rank 11: 168.33
     rank 12: 310.34
     rank 13: 312.20
     rank 14: 303.15
     rank 15: 309.69
     rank 16: 258.93
     rank 17: 258.01
     rank 18: 256.82
     rank 19: 255.54
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.08
     rank  1: 0.08
     rank  2: 0.06
     rank  3: 0.09
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
     rank 16: 0.06
     rank 17: 0.06
     rank 18: 0.06
     rank 19: 0.06
  all-grads-sync:
     rank  0: 1.24
     rank  1: 1.24
     rank  2: 1.21
     rank  3: 1.28
     rank  4: 2.64
     rank  5: 2.68
     rank  6: 2.69
     rank  7: 2.65
     rank  8: 2.67
     rank  9: 2.65
     rank 10: 2.65
     rank 11: 2.64
     rank 12: 2.17
     rank 13: 2.15
     rank 14: 2.22
     rank 15: 2.11
     rank 16: 2.78
     rank 17: 2.73
     rank 18: 2.76
     rank 19: 2.72
  optimizer-copy-to-main-grad:
     rank  0: 0.04
     rank  1: 0.05
     rank  2: 0.03
     rank  3: 0.05
     rank  4: 0.04
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.04
     rank  8: 0.07
     rank  9: 0.06
     rank 10: 0.04
     rank 11: 0.05
     rank 12: 0.05
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.04
     rank 16: 0.07
     rank 17: 0.05
     rank 18: 0.06
     rank 19: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 20.63
     rank  1: 20.44
     rank  2: 20.50
     rank  3: 20.56
     rank  4: 53.65
     rank  5: 53.74
     rank  6: 53.83
     rank  7: 53.69
     rank  8: 53.76
     rank  9: 53.69
     rank 10: 53.65
     rank 11: 53.66
     rank 12: 43.05
     rank 13: 43.23
     rank 14: 43.38
     rank 15: 42.76
     rank 16: 57.06
     rank 17: 56.92
     rank 18: 56.98
     rank 19: 57.17
  optimizer:
     rank  0: 21.40
     rank  1: 21.23
     rank  2: 21.27
     rank  3: 21.33
     rank  4: 54.41
     rank  5: 54.52
     rank  6: 54.60
     rank  7: 54.45
     rank  8: 54.52
     rank  9: 54.45
     rank 10: 54.41
     rank 11: 54.43
     rank 12: 43.81
     rank 13: 44.00
     rank 14: 44.14
     rank 15: 43.52
     rank 16: 57.83
     rank 17: 57.69
     rank 18: 57.75
     rank 19: 57.93
 [2025-01-02 12:32:44] iteration       10/      10 | consumed samples:          320 | elapsed time per iteration (ms): 10080.3 | learning rate: 7.500000E-06 | global batch size:    32 | lm loss: 2.429607E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 9980.55
     rank  1: 9980.59
     rank  2: 9980.46
     rank  3: 9980.55
     rank  4: 9983.42
     rank  5: 9983.47
     rank  6: 9983.45
     rank  7: 9983.46
     rank  8: 9983.54
     rank  9: 9983.58
     rank 10: 9983.53
     rank 11: 9983.56
     rank 12: 9982.48
     rank 13: 9982.56
     rank 14: 9982.48
     rank 15: 9982.56
     rank 16: 9983.85
     rank 17: 9983.79
     rank 18: 9983.83
     rank 19: 9983.79
  forward-compute:
     rank  0: 4001.77
     rank  1: 4003.26
     rank  2: 3994.43
     rank  3: 3999.94
     rank  4: 3579.27
     rank  5: 3591.81
     rank  6: 3576.99
     rank  7: 3592.75
     rank  8: 3594.08
     rank  9: 3592.46
     rank 10: 3603.40
     rank 11: 3597.75
     rank 12: 3713.85
     rank 13: 3712.26
     rank 14: 3722.88
     rank 15: 3711.81
     rank 16: 3728.93
     rank 17: 3724.22
     rank 18: 3722.66
     rank 19: 3727.92
  backward-compute:
     rank  0: 1167.11
     rank  1: 1175.71
     rank  2: 1165.77
     rank  3: 1176.65
     rank  4: 4228.75
     rank  5: 4225.98
     rank  6: 4230.96
     rank  7: 4225.79
     rank  8: 4232.65
     rank  9: 4238.99
     rank 10: 4263.46
     rank 11: 4245.37
     rank 12: 4313.96
     rank 13: 4299.37
     rank 14: 4279.61
     rank 15: 4297.66
     rank 16: 5027.87
     rank 17: 5038.50
     rank 18: 5035.90
     rank 19: 5036.84
  pure-backward-compute:
     rank  0: 1165.47
     rank  1: 1173.97
     rank  2: 1164.07
     rank  3: 1174.98
     rank  4: 4226.66
     rank  5: 4224.57
     rank  6: 4228.75
     rank  7: 4224.43
     rank  8: 4230.72
     rank  9: 4236.95
     rank 10: 4262.04
     rank 11: 4243.20
     rank 12: 4309.23
     rank 13: 4296.80
     rank 14: 4274.30
     rank 15: 4294.37
     rank 16: 5021.96
     rank 17: 5034.77
     rank 18: 5030.49
     rank 19: 5033.27
  batch-generator:
     rank  0: 142.33
     rank  1: 157.23
     rank  2: 150.35
     rank  3: 160.58
     rank  4: 88.14
     rank  5: 101.26
     rank  6: 95.44
     rank  7: 108.02
     rank  8: 93.85
     rank  9: 96.91
     rank 10: 100.99
     rank 11: 100.40
     rank 12: 112.93
     rank 13: 119.81
     rank 14: 148.11
     rank 15: 132.32
     rank 16: 114.46
     rank 17: 111.39
     rank 18: 115.31
     rank 19: 120.38
  forward-recv:
     rank  4: 164.17
     rank  5: 164.42
     rank  6: 162.96
     rank  7: 163.37
     rank  8: 268.39
     rank  9: 266.35
     rank 10: 266.99
     rank 11: 264.62
     rank 12: 373.94
     rank 13: 375.65
     rank 14: 376.01
     rank 15: 375.28
     rank 16: 486.17
     rank 17: 485.92
     rank 18: 485.41
     rank 19: 486.24
  forward-send:
     rank  0: 20.20
     rank  1: 19.95
     rank  2: 19.39
     rank  3: 17.24
     rank  4: 15.11
     rank  5: 14.53
     rank  6: 15.25
     rank  7: 13.07
     rank  8: 12.90
     rank  9: 14.33
     rank 10: 13.93
     rank 11: 14.46
     rank 12: 5.15
     rank 13: 4.78
     rank 14: 4.45
     rank 15: 5.42
  backward-recv:
     rank  0: 977.57
     rank  1: 977.38
     rank  2: 977.46
     rank  3: 977.56
     rank  4: 430.32
     rank  5: 431.23
     rank  6: 430.13
     rank  7: 431.18
     rank  8: 281.60
     rank  9: 281.71
     rank 10: 280.91
     rank 11: 281.52
     rank 12: 140.60
     rank 13: 140.75
     rank 14: 141.29
     rank 15: 140.90
  backward-send:
     rank  4: 20.74
     rank  5: 19.57
     rank  6: 20.78
     rank  7: 19.92
     rank  8: 14.95
     rank  9: 15.04
     rank 10: 14.89
     rank 11: 14.78
     rank 12: 10.31
     rank 13: 10.20
     rank 14: 9.32
     rank 15: 10.06
     rank 16: 5.20
     rank 17: 5.23
     rank 18: 5.20
     rank 19: 4.96
  forward-send-backward-recv:
     rank  0: 3798.96
     rank  1: 3789.74
     rank  2: 3807.92
     rank  3: 3794.55
     rank  4: 1184.76
     rank  5: 1193.01
     rank  6: 1184.77
     rank  7: 1196.45
     rank  8: 1209.19
     rank  9: 1201.46
     rank 10: 1181.70
     rank 11: 1192.13
     rank 12: 776.14
     rank 13: 791.28
     rank 14: 805.82
     rank 15: 789.91
  backward-send-forward-recv:
     rank  4: 293.53
     rank  5: 282.91
     rank  6: 293.72
     rank  7: 281.71
     rank  8: 165.70
     rank  9: 167.99
     rank 10: 160.40
     rank 11: 168.32
     rank 12: 308.29
     rank 13: 311.27
     rank 14: 296.89
     rank 15: 309.87
     rank 16: 253.91
     rank 17: 254.84
     rank 18: 252.41
     rank 19: 251.97
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.04
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.07
     rank  1: 0.07
     rank  2: 0.05
     rank  3: 0.09
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.03
     rank 16: 0.06
     rank 17: 0.05
     rank 18: 0.06
     rank 19: 0.05
  all-grads-sync:
     rank  0: 1.21
     rank  1: 1.25
     rank  2: 1.15
     rank  3: 1.29
     rank  4: 2.64
     rank  5: 2.64
     rank  6: 2.64
     rank  7: 2.64
     rank  8: 2.65
     rank  9: 2.65
     rank 10: 2.64
     rank 11: 2.65
     rank 12: 2.10
     rank 13: 2.17
     rank 14: 2.12
     rank 15: 2.26
     rank 16: 2.77
     rank 17: 2.71
     rank 18: 2.76
     rank 19: 2.72
  optimizer-copy-to-main-grad:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.05
     rank  5: 0.04
     rank  6: 0.04
     rank  7: 0.04
     rank  8: 0.06
     rank  9: 0.05
     rank 10: 0.04
     rank 11: 0.05
     rank 12: 0.04
     rank 13: 0.05
     rank 14: 0.04
     rank 15: 0.06
     rank 16: 0.06
     rank 17: 0.04
     rank 18: 0.06
     rank 19: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.05
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 20.45
     rank  1: 20.52
     rank  2: 20.41
     rank  3: 20.56
     rank  4: 53.61
     rank  5: 53.64
     rank  6: 53.73
     rank  7: 53.68
     rank  8: 53.91
     rank  9: 53.64
     rank 10: 53.67
     rank 11: 53.67
     rank 12: 42.91
     rank 13: 43.18
     rank 14: 43.29
     rank 15: 42.87
     rank 16: 57.06
     rank 17: 56.97
     rank 18: 56.87
     rank 19: 57.01
  optimizer:
     rank  0: 21.13
     rank  1: 21.20
     rank  2: 21.10
     rank  3: 21.24
     rank  4: 54.29
     rank  5: 54.32
     rank  6: 54.41
     rank  7: 54.36
     rank  8: 54.59
     rank  9: 54.36
     rank 10: 54.35
     rank 11: 54.36
     rank 12: 43.83
     rank 13: 43.87
     rank 14: 43.98
     rank 15: 43.57
     rank 16: 57.74
     rank 17: 57.66
     rank 18: 57.55
     rank 19: 57.70
