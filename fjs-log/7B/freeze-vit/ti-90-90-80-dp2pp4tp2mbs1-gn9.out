examples/multimodal/pretrain-freeze-llm-hete-2080tifirst.sh: line 4: activate: No such file or directory
3
[2024-12-30 22:45:52,085] torch.distributed.run: [WARNING] 
[2024-12-30 22:45:52,085] torch.distributed.run: [WARNING] *****************************************
[2024-12-30 22:45:52,085] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-12-30 22:45:52,085] torch.distributed.run: [WARNING] *****************************************
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:8------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:8------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:8------
------num_pipeline_model_parallel_groups:4------
> setting tensorboard ...
WARNING: one_logger package is required to enable e2e metrics tracking. please go to https://confluence.nvidia.com/display/MLWFO/Package+Repositories for details to install it
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:8------
------num_pipeline_model_parallel_groups:4------
---Rank 12---Tensor Parallel Group GPUs: [0, 0]
---Rank 15---Tensor Parallel Group GPUs: [1, 1]---Rank 13---Tensor Parallel Group GPUs: [1, 1]
---Rank 12---Pipeline Parallel Group GPUs: [3, 3, 3, 3]

---Rank 15---Pipeline Parallel Group GPUs: [3, 3, 3, 3]---Rank 14---Tensor Parallel Group GPUs: [0, 0]
---Rank 13---Pipeline Parallel Group GPUs: [3, 3, 3, 3]

---Rank 14---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
[rank12]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank15]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank13]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank14]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
 > number of parameters on (tensor, pipeline) model parallel rank (1, 3): 176173056
 > number of parameters on (tensor, pipeline) model parallel rank (0, 3): 176173056
INFO:megatron.core.distributed.param_and_grad_buffer:Number of buckets for gradient all-reduce / reduce-scatter: 1
Params for bucket 1 (176173056 elements):
	language_model.output_layer.weight
	language_model.decoder.layers.0.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.final_layernorm.weight
	language_model.decoder.layers.0.mlp.linear_fc1.weight
	language_model.decoder.layers.0.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.0.self_attention.linear_proj.weight
	language_model.decoder.layers.0.mlp.linear_fc2.weight
	language_model.decoder.layers.0.self_attention.linear_qkv.weight
rank=1, worker=0: shard_range=[pretrain-31.tar[0, 100), pretrain-31.tar[100, 200), pretrain-31.tar[200, 300), ...<1244>, pretrain-42.tar[4700, 4800), pretrain-42.tar[4800, 4900), pretrain-42.tar[4900, 5000)] sum(count)=125000
rank=1, worker=1: shard_range=[pretrain-42.tar[5000, 5100), pretrain-42.tar[5100, 5200), pretrain-42.tar[5200, 5300), ...<1244>, pretrain-53.tar[9700, 9800), pretrain-53.tar[9800, 9900), pretrain-53.tar[9900, 10000)] sum(count)=125000
rank=0, worker=0: shard_range=[pretrain-0.tar[0, 100), pretrain-0.tar[100, 200), pretrain-0.tar[200, 300), ...<1244>, pretrain-2.tar[4700, 4800), pretrain-2.tar[4800, 4900), pretrain-2.tar[4900, 5000)] sum(count)=125000
rank=0, worker=1: shard_range=[pretrain-2.tar[5000, 5100), pretrain-2.tar[5100, 5200), pretrain-2.tar[5200, 5300), ...<1244>, pretrain-30.tar[9700, 9800), pretrain-30.tar[9800, 9900), pretrain-30.tar[9900, 10000)] sum(count)=125000
rank=1, worker=0: shard_range=[pretrain-7.tar[936, 10000), pretrain-8.tar[0, 5468)] sum(count)=14532
rank=1, worker=1: shard_range=[pretrain-8.tar[5468, 10000), pretrain-9.tar[0, 10000)] sum(count)=14532
rank=0, worker=0: shard_range=[pretrain-54.tar[0, 10000), pretrain-55.tar[0, 4532)] sum(count)=14532
rank=0, worker=1: shard_range=[pretrain-55.tar[4532, 8128), pretrain-6.tar[0, 10000), pretrain-7.tar[0, 936)] sum(count)=14532
times across ranks (ms):
  model-and-optimizer-setup:
     rank  0: 94.50
     rank  1: 99.56
     rank  2: 89.30
     rank  3: 93.57
     rank  4: 40.86
     rank  5: 40.86
     rank  6: 33.60
     rank  7: 25.24
     rank  8: 47.24
     rank  9: 61.65
     rank 10: 53.57
     rank 11: 53.73
     rank 12: 43.54
     rank 13: 43.23
     rank 14: 43.13
     rank 15: 43.58
  train/valid/test-data-iterators-setup:
     rank  0: 1253.22
     rank  1: 1254.01
     rank  2: 1253.41
     rank  3: 1253.89
     rank  4: 1253.26
     rank  5: 1253.45
     rank  6: 1253.33
     rank  7: 1253.39
     rank  8: 1253.34
     rank  9: 1253.54
     rank 10: 1253.33
     rank 11: 1253.38
     rank 12: 1253.34
     rank 13: 1253.34
     rank 14: 1253.44
     rank 15: 1253.69
 [2024-12-30 22:46:27] iteration        1/      10 | consumed samples:           32 | elapsed time per iteration (ms): 12672.3 | learning rate: 7.500000E-07 | global batch size:    32 | lm loss: 7.182502E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
[Rank 13] (after 1 iterations) memory (MB) | allocated: 2741.4404296875 | max allocated: 3413.353515625 | reserved: 3668.0 | max reserved: 3668.0
stage4 GPU utialization:30.303209478204902 %
[Rank 12] (after 1 iterations) memory (MB) | allocated: 2741.4404296875 | max allocated: 3413.353515625 | reserved: 3668.0 | max reserved: 3668.0
times across ranks (ms):
  forward-backward:
     rank  0: 12577.86
     rank  1: 12577.87
     rank  2: 12578.09
     rank  3: 12578.07
     rank  4: 12579.54
     rank  5: 12579.54
     rank  6: 12579.55
     rank  7: 12579.59
     rank  8: 12580.07
     rank  9: 12580.12
     rank 10: 12580.15
     rank 11: 12580.21
     rank 12: 12577.34
     rank 13: 12577.16
     rank 14: 12577.36
     rank 15: 12577.38
  forward-compute:
     rank  0: 3915.89
     rank  1: 3933.71
     rank  2: 3749.69
     rank  3: 3757.64
     rank  4: 3241.12
     rank  5: 3259.99
     rank  6: 3171.96
     rank  7: 3173.30
     rank  8: 3576.73
     rank  9: 3578.85
     rank 10: 3702.51
     rank 11: 3701.81
     rank 12: 2037.32
     rank 13: 2045.88
     rank 14: 2268.75
     rank 15: 2277.14
  backward-compute:
     rank  0: 93.15
     rank  1: 94.49
     rank  2: 98.09
     rank  3: 94.06
     rank  4: 1487.50
     rank  5: 1490.06
     rank  6: 1506.54
     rank  7: 1504.52
     rank  8: 1756.48
     rank  9: 1765.61
     rank 10: 1766.11
     rank 11: 1778.19
     rank 12: 1229.92
     rank 13: 1228.88
     rank 14: 1214.98
     rank 15: 1213.40
  pure-backward-compute:
     rank  0: 92.18
     rank  1: 93.49
     rank  2: 97.15
     rank  3: 93.02
     rank  4: 1486.25
     rank  5: 1488.30
     rank  6: 1505.46
     rank  7: 1503.22
     rank  8: 1754.32
     rank  9: 1764.20
     rank 10: 1764.57
     rank 11: 1776.46
     rank 12: 1227.29
     rank 13: 1227.02
     rank 14: 1211.51
     rank 15: 1211.26
  batch-generator:
     rank  0: 1296.15
     rank  1: 1329.81
     rank  2: 1165.36
     rank  3: 1179.52
     rank  4: 1110.01
     rank  5: 1138.04
     rank  6: 1103.79
     rank  7: 1114.07
     rank  8: 1151.41
     rank  9: 1148.64
     rank 10: 1257.72
     rank 11: 1256.84
     rank 12: 1117.56
     rank 13: 1129.51
     rank 14: 1154.65
     rank 15: 1162.59
  forward-recv:
     rank  4: 2711.83
     rank  5: 2690.34
     rank  6: 2505.09
     rank  7: 2501.40
     rank  8: 4969.36
     rank  9: 4966.18
     rank 10: 4700.71
     rank 11: 4702.93
     rank 12: 7431.15
     rank 13: 7432.47
     rank 14: 7275.50
     rank 15: 7275.55
  forward-send:
     rank  0: 4719.33
     rank  1: 4697.45
     rank  2: 4736.35
     rank  3: 4734.43
     rank  4: 2421.66
     rank  5: 2420.74
     rank  6: 2536.09
     rank  7: 2538.95
     rank  8: 22.16
     rank  9: 23.57
     rank 10: 25.82
     rank 11: 26.04
  backward-recv:
     rank  0: 514.00
     rank  1: 513.65
     rank  2: 519.70
     rank  3: 520.63
     rank  4: 143.08
     rank  5: 142.41
     rank  6: 144.54
     rank  7: 146.08
     rank  8: 19.57
     rank  9: 19.54
     rank 10: 24.62
     rank 11: 22.46
  backward-send:
     rank  4: 3.92
     rank  5: 4.88
     rank  6: 4.76
     rank  7: 5.24
     rank  8: 7.16
     rank  9: 7.22
     rank 10: 5.70
     rank 11: 7.55
     rank 12: 4.57
     rank 13: 4.64
     rank 14: 4.45
     rank 15: 2.88
  forward-send-backward-recv:
     rank  0: 2719.71
     rank  1: 2723.14
     rank  2: 2858.21
     rank  3: 2856.77
     rank  4: 1897.65
     rank  5: 1895.53
     rank  6: 2040.36
     rank  7: 2040.57
     rank  8: 1425.32
     rank  9: 1421.03
     rank 10: 1560.35
     rank 11: 1551.42
  backward-send-forward-recv:
     rank  4: 44.81
     rank  5: 48.06
     rank  6: 45.33
     rank  7: 44.07
     rank  8: 76.64
     rank  9: 76.09
     rank 10: 67.79
     rank 11: 66.49
     rank 12: 1041.70
     rank 13: 1034.75
     rank 14: 979.27
     rank 15: 974.73
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.06
     rank  2: 0.10
     rank  3: 0.16
     rank  4: 0.04
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.04
     rank  9: 0.03
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.04
  embedding-grads-all-reduce:
     rank  0: 0.08
     rank  1: 0.13
     rank  2: 0.15
     rank  3: 0.15
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.04
     rank 12: 0.09
     rank 13: 0.07
     rank 14: 0.08
     rank 15: 0.09
  all-grads-sync:
     rank  0: 119.72
     rank  1: 121.32
     rank  2: 119.62
     rank  3: 121.25
     rank  4: 540.16
     rank  5: 547.06
     rank  6: 540.14
     rank  7: 547.08
     rank  8: 595.65
     rank  9: 602.50
     rank 10: 595.63
     rank 11: 602.49
     rank 12: 307.38
     rank 13: 295.05
     rank 14: 307.46
     rank 15: 295.12
  optimizer-copy-to-main-grad:
     rank  0: 0.09
     rank  1: 0.05
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.10
     rank  5: 0.06
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.05
     rank  9: 0.07
     rank 10: 0.06
     rank 11: 0.07
     rank 12: 0.04
     rank 13: 0.03
     rank 14: 0.04
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 30.31
     rank  1: 31.13
     rank  2: 31.29
     rank  3: 30.83
     rank  4: 76.11
     rank  5: 76.54
     rank  6: 76.19
     rank  7: 76.24
     rank  8: 84.00
     rank  9: 87.38
     rank 10: 82.35
     rank 11: 84.94
     rank 12: 51.36
     rank 13: 51.22
     rank 14: 51.41
     rank 15: 51.19
  optimizer:
     rank  0: 31.11
     rank  1: 31.94
     rank  2: 32.09
     rank  3: 31.63
     rank  4: 76.90
     rank  5: 77.35
     rank  6: 76.99
     rank  7: 77.04
     rank  8: 84.82
     rank  9: 88.19
     rank 10: 83.16
     rank 11: 85.75
     rank 12: 52.16
     rank 13: 52.02
     rank 14: 52.22
     rank 15: 51.99
 [2024-12-30 22:46:31] iteration        2/      10 | consumed samples:           64 | elapsed time per iteration (ms): 4147.5 | learning rate: 1.500000E-06 | global batch size:    32 | lm loss: 7.158663E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4046.90
     rank  1: 4046.93
     rank  2: 4046.95
     rank  3: 4046.99
     rank  4: 4051.89
     rank  5: 4051.97
     rank  6: 4051.86
     rank  7: 4052.01
     rank  8: 4052.38
     rank  9: 4052.65
     rank 10: 4052.40
     rank 11: 4052.49
     rank 12: 4049.48
     rank 13: 4049.44
     rank 14: 4049.51
     rank 15: 4049.50
  forward-compute:
     rank  0: 1360.20
     rank  1: 1353.50
     rank  2: 1406.84
     rank  3: 1406.58
     rank  4: 1046.64
     rank  5: 1043.58
     rank  6: 1068.97
     rank  7: 1065.16
     rank  8: 1209.87
     rank  9: 1212.54
     rank 10: 1222.36
     rank 11: 1228.35
     rank 12: 817.91
     rank 13: 831.17
     rank 14: 1054.42
     rank 15: 1059.71
  backward-compute:
     rank  0: 88.73
     rank  1: 94.87
     rank  2: 93.83
     rank  3: 90.00
     rank  4: 1491.99
     rank  5: 1495.84
     rank  6: 1506.26
     rank  7: 1508.93
     rank  8: 1761.50
     rank  9: 1776.13
     rank 10: 1768.79
     rank 11: 1774.95
     rank 12: 1204.02
     rank 13: 1202.45
     rank 14: 1195.91
     rank 15: 1193.25
  pure-backward-compute:
     rank  0: 88.00
     rank  1: 93.84
     rank  2: 93.00
     rank  3: 89.17
     rank  4: 1490.98
     rank  5: 1494.71
     rank  6: 1505.38
     rank  7: 1507.49
     rank  8: 1759.01
     rank  9: 1774.86
     rank 10: 1766.55
     rank 11: 1773.60
     rank 12: 1201.30
     rank 13: 1200.62
     rank 14: 1191.81
     rank 15: 1191.12
  batch-generator:
     rank  0: 56.69
     rank  1: 54.11
     rank  2: 61.91
     rank  3: 63.38
     rank  4: 50.39
     rank  5: 51.26
     rank  6: 44.54
     rank  7: 55.68
     rank  8: 77.99
     rank  9: 77.00
     rank 10: 67.87
     rank 11: 69.58
     rank 12: 64.29
     rank 13: 77.21
     rank 14: 80.25
     rank 15: 82.86
  forward-recv:
     rank  4: 125.13
     rank  5: 124.49
     rank  6: 130.86
     rank  7: 130.56
     rank  8: 161.39
     rank  9: 162.57
     rank 10: 168.14
     rank 11: 168.37
     rank 12: 231.80
     rank 13: 231.24
     rank 14: 237.46
     rank 15: 237.47
  forward-send:
     rank  0: 5.07
     rank  1: 5.08
     rank  2: 5.14
     rank  3: 5.42
     rank  4: 5.29
     rank  5: 5.57
     rank  6: 5.18
     rank  7: 5.52
     rank  8: 4.69
     rank  9: 4.32
     rank 10: 2.90
     rank 11: 2.83
  backward-recv:
     rank  0: 517.30
     rank  1: 516.96
     rank  2: 537.92
     rank  3: 538.22
     rank  4: 143.76
     rank  5: 143.38
     rank  6: 166.35
     rank  7: 166.40
     rank  8: 18.42
     rank  9: 18.42
     rank 10: 46.36
     rank 11: 45.23
  backward-send:
     rank  4: 4.12
     rank  5: 4.50
     rank  6: 4.43
     rank  7: 4.79
     rank  8: 7.84
     rank  9: 7.57
     rank 10: 7.42
     rank 11: 7.39
     rank 12: 5.09
     rank 13: 4.95
     rank 14: 5.09
     rank 15: 4.25
  forward-send-backward-recv:
     rank  0: 1548.26
     rank  1: 1549.54
     rank  2: 1477.75
     rank  3: 1480.62
     rank  4: 659.19
     rank  5: 656.69
     rank  6: 598.97
     rank  7: 596.01
     rank  8: 180.00
     rank  9: 170.27
     rank 10: 138.91
     rank 11: 133.77
  backward-send-forward-recv:
     rank  4: 32.29
     rank  5: 34.39
     rank  6: 30.51
     rank  7: 32.81
     rank  8: 66.22
     rank  9: 63.46
     rank 10: 56.94
     rank 11: 52.33
     rank 12: 1041.93
     rank 13: 1032.34
     rank 14: 806.49
     rank 15: 806.32
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.05
     rank  3: 0.10
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.08
     rank  1: 0.06
     rank  2: 0.08
     rank  3: 0.13
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.07
     rank 13: 0.06
     rank 14: 0.07
     rank 15: 0.08
  all-grads-sync:
     rank  0: 30.42
     rank  1: 29.75
     rank  2: 30.49
     rank  3: 29.75
     rank  4: 488.16
     rank  5: 487.40
     rank  6: 488.16
     rank  7: 487.36
     rank  8: 519.14
     rank  9: 519.13
     rank 10: 519.15
     rank 11: 519.10
     rank 12: 295.50
     rank 13: 283.01
     rank 14: 295.49
     rank 15: 282.79
  optimizer-copy-to-main-grad:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.04
     rank  5: 0.05
     rank  6: 0.03
     rank  7: 0.04
     rank  8: 0.06
     rank  9: 0.06
     rank 10: 0.11
     rank 11: 0.09
     rank 12: 0.04
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 6.19
     rank  1: 6.14
     rank  2: 6.10
     rank  3: 6.31
     rank  4: 60.22
     rank  5: 60.23
     rank  6: 60.17
     rank  7: 60.25
     rank  8: 64.35
     rank  9: 64.41
     rank 10: 64.41
     rank 11: 64.35
     rank 12: 33.77
     rank 13: 33.72
     rank 14: 33.70
     rank 15: 33.82
  optimizer:
     rank  0: 7.09
     rank  1: 7.05
     rank  2: 7.00
     rank  3: 7.21
     rank  4: 61.12
     rank  5: 61.14
     rank  6: 61.07
     rank  7: 61.16
     rank  8: 65.26
     rank  9: 65.31
     rank 10: 65.32
     rank 11: 65.24
     rank 12: 34.67
     rank 13: 34.63
     rank 14: 34.60
     rank 15: 34.73
 [2024-12-30 22:46:35] iteration        3/      10 | consumed samples:           96 | elapsed time per iteration (ms): 4162.6 | learning rate: 2.250000E-06 | global batch size:    32 | lm loss: 6.703331E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4066.19
     rank  1: 4066.18
     rank  2: 4066.16
     rank  3: 4066.25
     rank  4: 4071.15
     rank  5: 4071.36
     rank  6: 4071.11
     rank  7: 4071.28
     rank  8: 4071.60
     rank  9: 4071.82
     rank 10: 4071.56
     rank 11: 4071.78
     rank 12: 4068.77
     rank 13: 4068.81
     rank 14: 4068.78
     rank 15: 4068.88
  forward-compute:
     rank  0: 1359.23
     rank  1: 1351.26
     rank  2: 1379.10
     rank  3: 1380.47
     rank  4: 1056.76
     rank  5: 1054.09
     rank  6: 1048.54
     rank  7: 1047.80
     rank  8: 1207.21
     rank  9: 1212.26
     rank 10: 1192.42
     rank 11: 1193.76
     rank 12: 815.52
     rank 13: 825.59
     rank 14: 1073.55
     rank 15: 1077.05
  backward-compute:
     rank  0: 88.97
     rank  1: 94.19
     rank  2: 93.98
     rank  3: 91.03
     rank  4: 1490.49
     rank  5: 1493.80
     rank  6: 1512.23
     rank  7: 1510.98
     rank  8: 1765.77
     rank  9: 1778.26
     rank 10: 1770.55
     rank 11: 1771.84
     rank 12: 1203.00
     rank 13: 1201.84
     rank 14: 1198.87
     rank 15: 1196.32
  pure-backward-compute:
     rank  0: 88.22
     rank  1: 93.17
     rank  2: 93.09
     rank  3: 90.21
     rank  4: 1489.41
     rank  5: 1492.48
     rank  6: 1511.35
     rank  7: 1509.79
     rank  8: 1763.68
     rank  9: 1776.87
     rank 10: 1768.99
     rank 11: 1770.75
     rank 12: 1200.38
     rank 13: 1200.01
     rank 14: 1195.31
     rank 15: 1194.33
  batch-generator:
     rank  0: 58.18
     rank  1: 53.66
     rank  2: 59.93
     rank  3: 62.57
     rank  4: 55.28
     rank  5: 59.84
     rank  6: 43.03
     rank  7: 45.76
     rank  8: 69.09
     rank  9: 71.02
     rank 10: 50.64
     rank 11: 50.77
     rank 12: 63.28
     rank 13: 70.83
     rank 14: 70.60
     rank 15: 74.24
  forward-recv:
     rank  4: 125.55
     rank  5: 127.16
     rank  6: 127.05
     rank  7: 127.06
     rank  8: 162.73
     rank  9: 161.64
     rank 10: 165.87
     rank 11: 165.58
     rank 12: 238.97
     rank 13: 238.80
     rank 14: 239.19
     rank 15: 239.40
  forward-send:
     rank  0: 6.01
     rank  1: 6.91
     rank  2: 6.45
     rank  3: 6.76
     rank  4: 6.55
     rank  5: 6.04
     rank  6: 7.08
     rank  7: 7.07
     rank  8: 5.34
     rank  9: 5.26
     rank 10: 5.25
     rank 11: 5.17
  backward-recv:
     rank  0: 520.46
     rank  1: 517.90
     rank  2: 555.04
     rank  3: 555.34
     rank  4: 146.28
     rank  5: 145.21
     rank  6: 185.81
     rank  7: 184.99
     rank  8: 20.00
     rank  9: 19.90
     rank 10: 66.76
     rank 11: 68.24
  backward-send:
     rank  4: 3.99
     rank  5: 4.21
     rank  6: 4.76
     rank  7: 4.91
     rank  8: 7.87
     rank  9: 7.61
     rank 10: 6.44
     rank 11: 6.41
     rank 12: 5.32
     rank 13: 4.89
     rank 14: 5.27
     rank 15: 4.90
  forward-send-backward-recv:
     rank  0: 1560.67
     rank  1: 1562.65
     rank  2: 1499.67
     rank  3: 1500.23
     rank  4: 656.34
     rank  5: 653.50
     rank  6: 604.35
     rank  7: 604.63
     rank  8: 181.86
     rank  9: 174.37
     rank 10: 158.19
     rank 11: 155.85
  backward-send-forward-recv:
     rank  4: 34.35
     rank  5: 36.23
     rank  6: 34.52
     rank  7: 35.75
     rank  8: 70.98
     rank  9: 67.36
     rank 10: 59.64
     rank 11: 59.17
     rank 12: 1050.54
     rank 13: 1043.38
     rank 14: 795.61
     rank 15: 796.55
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.05
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.06
     rank  2: 0.06
     rank  3: 0.09
     rank  4: 0.02
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.07
     rank 13: 0.07
     rank 14: 0.07
     rank 15: 0.08
  all-grads-sync:
     rank  0: 30.22
     rank  1: 29.73
     rank  2: 30.33
     rank  3: 29.83
     rank  4: 482.95
     rank  5: 482.98
     rank  6: 482.98
     rank  7: 482.95
     rank  8: 525.41
     rank  9: 525.34
     rank 10: 525.42
     rank 11: 525.39
     rank 12: 285.61
     rank 13: 274.01
     rank 14: 285.59
     rank 15: 274.11
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.04
     rank  5: 0.07
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.05
     rank  9: 0.06
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.05
     rank 13: 0.03
     rank 14: 0.04
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 6.05
     rank  1: 6.10
     rank  2: 6.03
     rank  3: 6.06
     rank  4: 60.15
     rank  5: 60.27
     rank  6: 60.17
     rank  7: 60.25
     rank  8: 64.38
     rank  9: 64.45
     rank 10: 64.37
     rank 11: 64.37
     rank 12: 33.70
     rank 13: 33.69
     rank 14: 33.74
     rank 15: 33.80
  optimizer:
     rank  0: 6.65
     rank  1: 6.70
     rank  2: 6.62
     rank  3: 6.65
     rank  4: 60.74
     rank  5: 60.86
     rank  6: 60.76
     rank  7: 60.84
     rank  8: 64.97
     rank  9: 65.04
     rank 10: 64.96
     rank 11: 64.96
     rank 12: 34.30
     rank 13: 34.28
     rank 14: 34.33
     rank 15: 34.39
 [2024-12-30 22:46:39] iteration        4/      10 | consumed samples:          128 | elapsed time per iteration (ms): 4171.9 | learning rate: 3.000000E-06 | global batch size:    32 | lm loss: 3.459491E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4062.47
     rank  1: 4062.50
     rank  2: 4062.52
     rank  3: 4062.48
     rank  4: 4067.70
     rank  5: 4067.59
     rank  6: 4067.62
     rank  7: 4067.58
     rank  8: 4068.11
     rank  9: 4068.15
     rank 10: 4068.09
     rank 11: 4068.15
     rank 12: 4065.28
     rank 13: 4065.18
     rank 14: 4065.22
     rank 15: 4065.23
  forward-compute:
     rank  0: 1380.03
     rank  1: 1379.12
     rank  2: 1370.94
     rank  3: 1371.43
     rank  4: 1062.25
     rank  5: 1067.94
     rank  6: 1042.05
     rank  7: 1041.94
     rank  8: 1216.08
     rank  9: 1216.62
     rank 10: 1203.80
     rank 11: 1199.95
     rank 12: 823.59
     rank 13: 835.36
     rank 14: 1215.97
     rank 15: 1212.85
  backward-compute:
     rank  0: 88.47
     rank  1: 93.72
     rank  2: 93.71
     rank  3: 91.75
     rank  4: 1500.46
     rank  5: 1500.43
     rank  6: 1515.35
     rank  7: 1508.71
     rank  8: 1771.24
     rank  9: 1784.94
     rank 10: 1778.91
     rank 11: 1777.36
     rank 12: 1207.15
     rank 13: 1205.33
     rank 14: 1199.12
     rank 15: 1196.09
  pure-backward-compute:
     rank  0: 87.57
     rank  1: 92.70
     rank  2: 92.88
     rank  3: 90.92
     rank  4: 1498.75
     rank  5: 1499.35
     rank  6: 1514.43
     rank  7: 1507.84
     rank  8: 1769.07
     rank  9: 1783.20
     rank 10: 1777.27
     rank 11: 1775.01
     rank 12: 1204.14
     rank 13: 1203.53
     rank 14: 1195.27
     rank 15: 1194.00
  batch-generator:
     rank  0: 61.70
     rank  1: 61.75
     rank  2: 59.01
     rank  3: 60.51
     rank  4: 70.33
     rank  5: 71.74
     rank  6: 42.50
     rank  7: 45.44
     rank  8: 75.41
     rank  9: 76.04
     rank 10: 53.65
     rank 11: 53.09
     rank 12: 70.49
     rank 13: 79.82
     rank 14: 73.17
     rank 15: 68.34
  forward-recv:
     rank  4: 123.12
     rank  5: 122.44
     rank  6: 124.83
     rank  7: 124.94
     rank  8: 159.82
     rank  9: 161.59
     rank 10: 163.92
     rank 11: 164.07
     rank 12: 235.56
     rank 13: 235.18
     rank 14: 235.70
     rank 15: 235.65
  forward-send:
     rank  0: 6.05
     rank  1: 6.61
     rank  2: 6.57
     rank  3: 6.79
     rank  4: 6.62
     rank  5: 7.45
     rank  6: 7.41
     rank  7: 7.29
     rank  8: 5.15
     rank  9: 4.77
     rank 10: 5.27
     rank 11: 5.14
  backward-recv:
     rank  0: 516.84
     rank  1: 516.17
     rank  2: 562.49
     rank  3: 563.02
     rank  4: 141.46
     rank  5: 141.52
     rank  6: 188.65
     rank  7: 189.76
     rank  8: 17.50
     rank  9: 17.07
     rank 10: 70.64
     rank 11: 70.62
  backward-send:
     rank  4: 5.96
     rank  5: 5.56
     rank  6: 5.27
     rank  7: 4.65
     rank  8: 7.31
     rank  9: 7.54
     rank 10: 6.85
     rank 11: 7.17
     rank 12: 5.06
     rank 13: 4.95
     rank 14: 5.02
     rank 15: 4.02
  forward-send-backward-recv:
     rank  0: 1542.83
     rank  1: 1538.82
     rank  2: 1500.74
     rank  3: 1500.44
     rank  4: 647.65
     rank  5: 645.68
     rank  6: 607.77
     rank  7: 613.17
     rank  8: 178.37
     rank  9: 168.22
     rank 10: 143.83
     rank 11: 144.23
  backward-send-forward-recv:
     rank  4: 34.81
     rank  5: 32.42
     rank  6: 32.41
     rank  7: 33.00
     rank  8: 67.93
     rank  9: 65.94
     rank 10: 51.34
     rank 11: 54.19
     rank 12: 1041.36
     rank 13: 1033.83
     rank 14: 656.25
     rank 15: 664.48
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.04
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.06
     rank  2: 0.07
     rank  3: 0.06
     rank  4: 0.04
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.08
     rank 13: 0.06
     rank 14: 0.07
     rank 15: 0.07
  all-grads-sync:
     rank  0: 30.46
     rank  1: 29.70
     rank  2: 30.38
     rank  3: 29.62
     rank  4: 484.15
     rank  5: 483.49
     rank  6: 484.17
     rank  7: 483.50
     rank  8: 522.44
     rank  9: 522.49
     rank 10: 522.36
     rank 11: 522.33
     rank 12: 293.15
     rank 13: 280.05
     rank 14: 293.13
     rank 15: 280.09
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.10
     rank  5: 0.09
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.05
     rank  9: 0.06
     rank 10: 0.05
     rank 11: 0.06
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 6.01
     rank  1: 6.02
     rank  2: 6.02
     rank  3: 6.10
     rank  4: 60.34
     rank  5: 60.18
     rank  6: 60.19
     rank  7: 60.21
     rank  8: 64.37
     rank  9: 64.50
     rank 10: 64.41
     rank 11: 64.50
     rank 12: 33.82
     rank 13: 33.71
     rank 14: 33.68
     rank 15: 33.81
  optimizer:
     rank  0: 6.78
     rank  1: 6.80
     rank  2: 6.80
     rank  3: 6.87
     rank  4: 61.11
     rank  5: 60.94
     rank  6: 60.96
     rank  7: 60.98
     rank  8: 65.14
     rank  9: 65.28
     rank 10: 65.18
     rank 11: 65.27
     rank 12: 34.59
     rank 13: 34.48
     rank 14: 34.45
     rank 15: 34.58
 [2024-12-30 22:46:44] iteration        5/      10 | consumed samples:          160 | elapsed time per iteration (ms): 4182.3 | learning rate: 3.750000E-06 | global batch size:    32 | lm loss: 2.736337E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4074.38
     rank  1: 4074.47
     rank  2: 4074.43
     rank  3: 4074.46
     rank  4: 4079.57
     rank  5: 4079.60
     rank  6: 4079.49
     rank  7: 4079.55
     rank  8: 4079.97
     rank  9: 4080.09
     rank 10: 4079.96
     rank 11: 4080.04
     rank 12: 4077.12
     rank 13: 4077.10
     rank 14: 4077.09
     rank 15: 4077.12
  forward-compute:
     rank  0: 1375.15
     rank  1: 1377.08
     rank  2: 1367.02
     rank  3: 1369.14
     rank  4: 1093.17
     rank  5: 1100.74
     rank  6: 1039.94
     rank  7: 1038.93
     rank  8: 1208.51
     rank  9: 1211.31
     rank 10: 1209.62
     rank 11: 1201.47
     rank 12: 815.64
     rank 13: 826.25
     rank 14: 924.56
     rank 15: 919.69
  backward-compute:
     rank  0: 91.88
     rank  1: 93.93
     rank  2: 94.02
     rank  3: 90.06
     rank  4: 1502.04
     rank  5: 1503.72
     rank  6: 1515.48
     rank  7: 1506.26
     rank  8: 1774.11
     rank  9: 1782.37
     rank 10: 1779.48
     rank 11: 1776.41
     rank 12: 1206.78
     rank 13: 1205.18
     rank 14: 1199.45
     rank 15: 1196.36
  pure-backward-compute:
     rank  0: 91.02
     rank  1: 93.07
     rank  2: 93.20
     rank  3: 89.25
     rank  4: 1500.18
     rank  5: 1502.69
     rank  6: 1514.64
     rank  7: 1505.36
     rank  8: 1771.99
     rank  9: 1781.06
     rank 10: 1777.44
     rank 11: 1774.90
     rank 12: 1204.08
     rank 13: 1203.18
     rank 14: 1195.69
     rank 15: 1194.32
  batch-generator:
     rank  0: 58.04
     rank  1: 61.44
     rank  2: 62.12
     rank  3: 64.08
     rank  4: 88.13
     rank  5: 88.11
     rank  6: 42.97
     rank  7: 45.19
     rank  8: 69.09
     rank  9: 70.60
     rank 10: 60.11
     rank 11: 55.79
     rank 12: 66.10
     rank 13: 75.81
     rank 14: 77.83
     rank 15: 71.93
  forward-recv:
     rank  4: 115.27
     rank  5: 116.90
     rank  6: 121.55
     rank  7: 121.72
     rank  8: 160.69
     rank  9: 160.08
     rank 10: 162.86
     rank 11: 163.11
     rank 12: 237.74
     rank 13: 237.49
     rank 14: 236.92
     rank 15: 236.74
  forward-send:
     rank  0: 5.30
     rank  1: 6.04
     rank  2: 6.15
     rank  3: 6.45
     rank  4: 9.71
     rank  5: 8.62
     rank  6: 9.14
     rank  7: 9.03
     rank  8: 5.77
     rank  9: 5.60
     rank 10: 5.50
     rank 11: 5.22
  backward-recv:
     rank  0: 514.78
     rank  1: 515.82
     rank  2: 532.59
     rank  3: 534.13
     rank  4: 140.26
     rank  5: 139.86
     rank  6: 160.91
     rank  7: 160.98
     rank  8: 17.43
     rank  9: 18.28
     rank 10: 40.78
     rank 11: 41.42
  backward-send:
     rank  4: 5.65
     rank  5: 5.31
     rank  6: 4.68
     rank  7: 5.09
     rank  8: 7.19
     rank  9: 6.82
     rank 10: 6.72
     rank 11: 6.90
     rank 12: 5.27
     rank 13: 4.72
     rank 14: 5.34
     rank 15: 4.84
  forward-send-backward-recv:
     rank  0: 1556.02
     rank  1: 1550.63
     rank  2: 1542.86
     rank  3: 1543.36
     rank  4: 621.19
     rank  5: 619.46
     rank  6: 640.47
     rank  7: 649.46
     rank  8: 183.90
     rank  9: 178.21
     rank 10: 164.91
     rank 11: 166.85
  backward-send-forward-recv:
     rank  4: 43.33
     rank  5: 38.19
     rank  6: 40.27
     rank  7: 41.21
     rank  8: 74.07
     rank  9: 72.79
     rank 10: 63.14
     rank 11: 71.90
     rank 12: 1057.20
     rank 13: 1049.79
     rank 14: 955.75
     rank 15: 965.75
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.08
     rank  2: 0.08
     rank  3: 0.06
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.04
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.07
     rank 13: 0.07
     rank 14: 0.07
     rank 15: 0.08
  all-grads-sync:
     rank  0: 30.25
     rank  1: 29.37
     rank  2: 30.33
     rank  3: 29.37
     rank  4: 487.13
     rank  5: 487.14
     rank  6: 487.17
     rank  7: 487.15
     rank  8: 525.18
     rank  9: 525.19
     rank 10: 525.20
     rank 11: 525.19
     rank 12: 294.46
     rank 13: 281.78
     rank 14: 294.46
     rank 15: 281.78
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.04
     rank  5: 0.04
     rank  6: 0.04
     rank  7: 0.03
     rank  8: 0.06
     rank  9: 0.05
     rank 10: 0.09
     rank 11: 0.05
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.03
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 6.01
     rank  1: 6.05
     rank  2: 6.13
     rank  3: 6.07
     rank  4: 60.30
     rank  5: 60.21
     rank  6: 60.18
     rank  7: 60.20
     rank  8: 64.42
     rank  9: 64.39
     rank 10: 64.37
     rank 11: 64.38
     rank 12: 33.76
     rank 13: 33.76
     rank 14: 33.69
     rank 15: 33.75
  optimizer:
     rank  0: 6.61
     rank  1: 6.65
     rank  2: 6.72
     rank  3: 6.67
     rank  4: 60.91
     rank  5: 60.81
     rank  6: 60.78
     rank  7: 60.80
     rank  8: 65.04
     rank  9: 64.99
     rank 10: 64.97
     rank 11: 64.98
     rank 12: 34.37
     rank 13: 34.37
     rank 14: 34.30
     rank 15: 34.36
 [2024-12-30 22:46:48] iteration        6/      10 | consumed samples:          192 | elapsed time per iteration (ms): 4152.7 | learning rate: 4.500000E-06 | global batch size:    32 | lm loss: 2.409986E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4055.50
     rank  1: 4055.49
     rank  2: 4055.50
     rank  3: 4055.52
     rank  4: 4060.64
     rank  5: 4060.58
     rank  6: 4060.58
     rank  7: 4060.60
     rank  8: 4061.07
     rank  9: 4061.11
     rank 10: 4061.04
     rank 11: 4061.17
     rank 12: 4058.30
     rank 13: 4058.19
     rank 14: 4058.24
     rank 15: 4058.20
  forward-compute:
     rank  0: 1350.31
     rank  1: 1353.89
     rank  2: 1365.55
     rank  3: 1367.17
     rank  4: 1094.27
     rank  5: 1100.67
     rank  6: 1053.09
     rank  7: 1052.33
     rank  8: 1210.91
     rank  9: 1216.43
     rank 10: 1201.79
     rank 11: 1202.40
     rank 12: 812.71
     rank 13: 825.22
     rank 14: 1143.73
     rank 15: 1143.85
  backward-compute:
     rank  0: 93.17
     rank  1: 93.10
     rank  2: 94.74
     rank  3: 90.99
     rank  4: 1499.60
     rank  5: 1505.47
     rank  6: 1503.75
     rank  7: 1502.89
     rank  8: 1774.56
     rank  9: 1789.67
     rank 10: 1778.43
     rank 11: 1779.14
     rank 12: 1206.96
     rank 13: 1204.95
     rank 14: 1198.59
     rank 15: 1195.06
  pure-backward-compute:
     rank  0: 92.27
     rank  1: 92.10
     rank  2: 93.90
     rank  3: 90.12
     rank  4: 1497.62
     rank  5: 1504.32
     rank  6: 1502.89
     rank  7: 1502.01
     rank  8: 1771.54
     rank  9: 1788.38
     rank 10: 1776.35
     rank 11: 1777.47
     rank 12: 1204.17
     rank 13: 1203.10
     rank 14: 1194.16
     rank 15: 1192.62
  batch-generator:
     rank  0: 58.16
     rank  1: 63.48
     rank  2: 59.87
     rank  3: 62.67
     rank  4: 87.34
     rank  5: 85.97
     rank  6: 50.04
     rank  7: 52.43
     rank  8: 71.03
     rank  9: 76.00
     rank 10: 54.25
     rank 11: 57.26
     rank 12: 57.95
     rank 13: 70.94
     rank 14: 74.45
     rank 15: 71.09
  forward-recv:
     rank  4: 117.51
     rank  5: 118.19
     rank  6: 124.33
     rank  7: 124.05
     rank  8: 160.77
     rank  9: 160.69
     rank 10: 164.81
     rank 11: 163.81
     rank 12: 236.55
     rank 13: 236.31
     rank 14: 234.86
     rank 15: 235.73
  forward-send:
     rank  0: 5.29
     rank  1: 5.81
     rank  2: 5.86
     rank  3: 5.74
     rank  4: 8.08
     rank  5: 7.70
     rank  6: 8.24
     rank  7: 8.21
     rank  8: 5.27
     rank  9: 5.12
     rank 10: 4.15
     rank 11: 4.99
  backward-recv:
     rank  0: 513.74
     rank  1: 514.53
     rank  2: 552.25
     rank  3: 553.09
     rank  4: 140.09
     rank  5: 139.69
     rank  6: 183.00
     rank  7: 183.43
     rank  8: 17.04
     rank  9: 16.86
     rank 10: 63.03
     rank 11: 62.50
  backward-send:
     rank  4: 5.22
     rank  5: 5.32
     rank  6: 5.43
     rank  7: 5.51
     rank  8: 7.44
     rank  9: 6.74
     rank 10: 7.39
     rank 11: 7.92
     rank 12: 5.27
     rank 13: 4.60
     rank 14: 5.25
     rank 15: 4.93
  forward-send-backward-recv:
     rank  0: 1565.35
     rank  1: 1561.03
     rank  2: 1510.41
     rank  3: 1511.18
     rank  4: 615.56
     rank  5: 611.03
     rank  6: 608.77
     rank  7: 609.31
     rank  8: 177.17
     rank  9: 165.20
     rank 10: 147.96
     rank 11: 145.78
  backward-send-forward-recv:
     rank  4: 33.90
     rank  5: 28.90
     rank  6: 32.27
     rank  7: 33.25
     rank  8: 62.84
     rank  9: 60.28
     rank 10: 52.95
     rank 11: 53.16
     rank 12: 1046.22
     rank 13: 1037.23
     rank 14: 724.56
     rank 15: 728.79
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.05
     rank  2: 0.06
     rank  3: 0.06
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.08
     rank 13: 0.07
     rank 14: 0.06
     rank 15: 0.07
  all-grads-sync:
     rank  0: 29.96
     rank  1: 28.91
     rank  2: 30.05
     rank  3: 28.95
     rank  4: 483.90
     rank  5: 483.89
     rank  6: 483.91
     rank  7: 483.89
     rank  8: 520.85
     rank  9: 521.21
     rank 10: 520.84
     rank 11: 521.21
     rank 12: 286.50
     rank 13: 276.60
     rank 14: 286.46
     rank 15: 276.59
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.04
     rank  5: 0.04
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.05
     rank  9: 0.11
     rank 10: 0.05
     rank 11: 0.10
     rank 12: 0.04
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 6.08
     rank  1: 5.99
     rank  2: 6.03
     rank  3: 6.03
     rank  4: 60.23
     rank  5: 60.16
     rank  6: 60.21
     rank  7: 60.17
     rank  8: 64.37
     rank  9: 64.33
     rank 10: 64.35
     rank 11: 64.41
     rank 12: 33.71
     rank 13: 33.68
     rank 14: 33.66
     rank 15: 33.76
  optimizer:
     rank  0: 6.73
     rank  1: 6.64
     rank  2: 6.68
     rank  3: 6.68
     rank  4: 60.89
     rank  5: 60.81
     rank  6: 60.87
     rank  7: 60.82
     rank  8: 65.03
     rank  9: 64.99
     rank 10: 64.99
     rank 11: 65.07
     rank 12: 34.37
     rank 13: 34.33
     rank 14: 34.31
     rank 15: 34.42
 [2024-12-30 22:46:52] iteration        7/      10 | consumed samples:          224 | elapsed time per iteration (ms): 4175.9 | learning rate: 5.250000E-06 | global batch size:    32 | lm loss: 2.422122E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4069.83
     rank  1: 4069.86
     rank  2: 4069.83
     rank  3: 4069.87
     rank  4: 4074.98
     rank  5: 4075.00
     rank  6: 4074.92
     rank  7: 4074.96
     rank  8: 4075.43
     rank  9: 4075.47
     rank 10: 4075.38
     rank 11: 4075.51
     rank 12: 4072.55
     rank 13: 4072.57
     rank 14: 4072.55
     rank 15: 4072.62
  forward-compute:
     rank  0: 1360.84
     rank  1: 1358.71
     rank  2: 1380.57
     rank  3: 1382.72
     rank  4: 1079.25
     rank  5: 1082.32
     rank  6: 1048.90
     rank  7: 1049.11
     rank  8: 1215.42
     rank  9: 1219.98
     rank 10: 1200.55
     rank 11: 1201.26
     rank 12: 813.19
     rank 13: 824.77
     rank 14: 1096.69
     rank 15: 1091.57
  backward-compute:
     rank  0: 92.80
     rank  1: 94.34
     rank  2: 94.25
     rank  3: 90.44
     rank  4: 1501.19
     rank  5: 1505.99
     rank  6: 1503.02
     rank  7: 1502.44
     rank  8: 1767.71
     rank  9: 1777.69
     rank 10: 1783.99
     rank 11: 1780.62
     rank 12: 1203.32
     rank 13: 1202.18
     rank 14: 1202.74
     rank 15: 1201.08
  pure-backward-compute:
     rank  0: 91.99
     rank  1: 93.36
     rank  2: 93.48
     rank  3: 89.62
     rank  4: 1499.48
     rank  5: 1504.71
     rank  6: 1502.07
     rank  7: 1501.58
     rank  8: 1765.17
     rank  9: 1776.25
     rank 10: 1781.90
     rank 11: 1779.02
     rank 12: 1200.73
     rank 13: 1200.11
     rank 14: 1200.09
     rank 15: 1199.12
  batch-generator:
     rank  0: 58.10
     rank  1: 59.33
     rank  2: 57.64
     rank  3: 61.57
     rank  4: 73.86
     rank  5: 74.06
     rank  6: 46.67
     rank  7: 50.79
     rank  8: 74.62
     rank  9: 74.54
     rank 10: 51.13
     rank 11: 55.35
     rank 12: 58.08
     rank 13: 70.38
     rank 14: 74.62
     rank 15: 67.82
  forward-recv:
     rank  4: 119.04
     rank  5: 119.32
     rank  6: 125.85
     rank  7: 126.04
     rank  8: 162.98
     rank  9: 163.16
     rank 10: 164.87
     rank 11: 164.56
     rank 12: 236.44
     rank 13: 236.18
     rank 14: 236.46
     rank 15: 236.56
  forward-send:
     rank  0: 5.17
     rank  1: 5.32
     rank  2: 5.04
     rank  3: 5.51
     rank  4: 9.42
     rank  5: 9.18
     rank  6: 8.97
     rank  7: 8.99
     rank  8: 5.38
     rank  9: 5.13
     rank 10: 5.24
     rank 11: 5.41
  backward-recv:
     rank  0: 512.88
     rank  1: 511.65
     rank  2: 551.41
     rank  3: 552.16
     rank  4: 139.90
     rank  5: 139.29
     rank  6: 180.16
     rank  7: 179.92
     rank  8: 18.29
     rank  9: 18.97
     rank 10: 59.24
     rank 11: 59.56
  backward-send:
     rank  4: 5.04
     rank  5: 3.75
     rank  6: 4.88
     rank  7: 4.76
     rank  8: 7.38
     rank  9: 6.33
     rank 10: 7.54
     rank 11: 7.23
     rank 12: 5.03
     rank 13: 4.87
     rank 14: 5.20
     rank 15: 5.05
  forward-send-backward-recv:
     rank  0: 1564.37
     rank  1: 1564.61
     rank  2: 1505.63
     rank  3: 1505.44
     rank  4: 631.23
     rank  5: 626.91
     rank  6: 620.49
     rank  7: 620.44
     rank  8: 180.89
     rank  9: 172.51
     rank 10: 152.56
     rank 11: 153.76
  backward-send-forward-recv:
     rank  4: 37.72
     rank  5: 35.78
     rank  6: 34.56
     rank  7: 34.69
     rank  8: 67.65
     rank  9: 64.39
     rank 10: 54.69
     rank 11: 55.20
     rank 12: 1058.07
     rank 13: 1049.24
     rank 14: 775.03
     rank 15: 783.40
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.04
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.05
     rank  2: 0.05
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.06
     rank 13: 0.06
     rank 14: 0.06
     rank 15: 0.10
  all-grads-sync:
     rank  0: 30.43
     rank  1: 29.89
     rank  2: 30.36
     rank  3: 29.78
     rank  4: 488.91
     rank  5: 488.93
     rank  6: 488.96
     rank  7: 488.88
     rank  8: 525.96
     rank  9: 527.51
     rank 10: 525.96
     rank 11: 527.56
     rank 12: 292.08
     rank 13: 279.74
     rank 14: 292.07
     rank 15: 279.64
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.05
     rank  5: 0.04
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.05
     rank  9: 0.05
     rank 10: 0.05
     rank 11: 0.07
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 5.99
     rank  1: 6.08
     rank  2: 6.01
     rank  3: 6.08
     rank  4: 60.24
     rank  5: 60.27
     rank  6: 60.13
     rank  7: 60.15
     rank  8: 64.38
     rank  9: 64.32
     rank 10: 64.37
     rank 11: 64.54
     rank 12: 33.67
     rank 13: 33.68
     rank 14: 33.65
     rank 15: 33.80
  optimizer:
     rank  0: 6.64
     rank  1: 6.74
     rank  2: 6.67
     rank  3: 6.73
     rank  4: 60.90
     rank  5: 60.93
     rank  6: 60.79
     rank  7: 60.81
     rank  8: 65.05
     rank  9: 64.99
     rank 10: 65.05
     rank 11: 65.20
     rank 12: 34.33
     rank 13: 34.34
     rank 14: 34.31
     rank 15: 34.47
 [2024-12-30 22:46:56] iteration        8/      10 | consumed samples:          256 | elapsed time per iteration (ms): 4156.6 | learning rate: 6.000000E-06 | global batch size:    32 | lm loss: 2.505616E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4058.48
     rank  1: 4058.39
     rank  2: 4058.47
     rank  3: 4058.35
     rank  4: 4063.56
     rank  5: 4063.45
     rank  6: 4063.50
     rank  7: 4063.44
     rank  8: 4064.01
     rank  9: 4064.02
     rank 10: 4064.12
     rank 11: 4064.10
     rank 12: 4061.09
     rank 13: 4061.07
     rank 14: 4061.09
     rank 15: 4061.08
  forward-compute:
     rank  0: 1366.36
     rank  1: 1373.28
     rank  2: 1374.81
     rank  3: 1377.82
     rank  4: 1073.79
     rank  5: 1085.39
     rank  6: 1042.41
     rank  7: 1041.33
     rank  8: 1200.56
     rank  9: 1210.61
     rank 10: 1206.07
     rank 11: 1203.50
     rank 12: 823.82
     rank 13: 838.68
     rank 14: 843.90
     rank 15: 832.42
  backward-compute:
     rank  0: 95.35
     rank  1: 95.38
     rank  2: 94.57
     rank  3: 88.47
     rank  4: 1494.81
     rank  5: 1503.00
     rank  6: 1505.26
     rank  7: 1502.07
     rank  8: 1758.72
     rank  9: 1770.05
     rank 10: 1782.70
     rank 11: 1774.31
     rank 12: 1207.77
     rank 13: 1206.80
     rank 14: 1205.40
     rank 15: 1202.66
  pure-backward-compute:
     rank  0: 94.48
     rank  1: 94.49
     rank  2: 93.75
     rank  3: 87.74
     rank  4: 1493.12
     rank  5: 1502.02
     rank  6: 1504.38
     rank  7: 1501.04
     rank  8: 1755.98
     rank  9: 1768.58
     rank 10: 1780.82
     rank 11: 1771.45
     rank 12: 1205.13
     rank 13: 1204.98
     rank 14: 1201.80
     rank 15: 1200.52
  batch-generator:
     rank  0: 59.81
     rank  1: 68.58
     rank  2: 57.90
     rank  3: 61.43
     rank  4: 74.60
     rank  5: 82.68
     rank  6: 45.47
     rank  7: 48.41
     rank  8: 70.09
     rank  9: 78.42
     rank 10: 49.51
     rank 11: 53.65
     rank 12: 64.15
     rank 13: 78.62
     rank 14: 79.75
     rank 15: 67.74
  forward-recv:
     rank  4: 117.57
     rank  5: 118.10
     rank  6: 123.30
     rank  7: 123.41
     rank  8: 164.24
     rank  9: 164.50
     rank 10: 166.20
     rank 11: 164.53
     rank 12: 236.47
     rank 13: 236.16
     rank 14: 233.75
     rank 15: 235.29
  forward-send:
     rank  0: 6.44
     rank  1: 7.13
     rank  2: 7.17
     rank  3: 7.44
     rank  4: 9.97
     rank  5: 9.88
     rank  6: 9.57
     rank  7: 9.52
     rank  8: 5.09
     rank  9: 5.01
     rank 10: 3.48
     rank 11: 4.95
  backward-recv:
     rank  0: 516.70
     rank  1: 516.24
     rank  2: 515.99
     rank  3: 517.81
     rank  4: 142.87
     rank  5: 142.67
     rank  6: 146.91
     rank  7: 147.28
     rank  8: 19.06
     rank  9: 19.80
     rank 10: 23.97
     rank 11: 23.01
  backward-send:
     rank  4: 4.90
     rank  5: 4.61
     rank  6: 5.15
     rank  7: 5.08
     rank  8: 7.24
     rank  9: 7.31
     rank 10: 7.43
     rank 11: 7.77
     rank 12: 5.28
     rank 13: 5.17
     rank 14: 5.29
     rank 15: 4.98
  forward-send-backward-recv:
     rank  0: 1544.25
     rank  1: 1535.67
     rank  2: 1536.46
     rank  3: 1536.87
     rank  4: 626.48
     rank  5: 618.06
     rank  6: 647.15
     rank  7: 649.96
     rank  8: 183.40
     rank  9: 177.31
     rank 10: 163.75
     rank 11: 169.63
  backward-send-forward-recv:
     rank  4: 44.26
     rank  5: 34.16
     rank  6: 39.31
     rank  7: 39.98
     rank  8: 75.53
     rank  9: 66.78
     rank 10: 67.63
     rank 11: 68.77
     rank 12: 1034.87
     rank 13: 1022.85
     rank 14: 1019.37
     rank 15: 1034.24
  layernorm-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.04
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.09
     rank  1: 0.06
     rank  2: 0.06
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.07
     rank 13: 0.06
     rank 14: 0.07
     rank 15: 0.07
  all-grads-sync:
     rank  0: 30.46
     rank  1: 29.82
     rank  2: 30.38
     rank  3: 29.73
     rank  4: 482.48
     rank  5: 483.57
     rank  6: 482.49
     rank  7: 483.56
     rank  8: 523.51
     rank  9: 523.59
     rank 10: 523.54
     rank 11: 523.51
     rank 12: 290.48
     rank 13: 279.42
     rank 14: 290.45
     rank 15: 279.41
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.06
     rank  9: 0.07
     rank 10: 0.08
     rank 11: 0.12
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 6.21
     rank  1: 6.02
     rank  2: 6.01
     rank  3: 6.01
     rank  4: 60.21
     rank  5: 60.15
     rank  6: 60.23
     rank  7: 60.17
     rank  8: 64.37
     rank  9: 64.49
     rank 10: 64.54
     rank 11: 64.53
     rank 12: 33.75
     rank 13: 33.65
     rank 14: 33.71
     rank 15: 33.72
  optimizer:
     rank  0: 7.26
     rank  1: 7.06
     rank  2: 7.05
     rank  3: 7.05
     rank  4: 61.25
     rank  5: 61.19
     rank  6: 61.27
     rank  7: 61.21
     rank  8: 65.42
     rank  9: 65.54
     rank 10: 65.59
     rank 11: 65.58
     rank 12: 34.80
     rank 13: 34.70
     rank 14: 34.75
     rank 15: 34.78
 [2024-12-30 22:47:00] iteration        9/      10 | consumed samples:          288 | elapsed time per iteration (ms): 4169.6 | learning rate: 6.750000E-06 | global batch size:    32 | lm loss: 2.544036E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4071.28
     rank  1: 4071.42
     rank  2: 4071.26
     rank  3: 4071.51
     rank  4: 4076.43
     rank  5: 4076.45
     rank  6: 4076.42
     rank  7: 4076.48
     rank  8: 4076.83
     rank  9: 4076.94
     rank 10: 4076.92
     rank 11: 4077.02
     rank 12: 4073.98
     rank 13: 4074.02
     rank 14: 4073.98
     rank 15: 4074.07
  forward-compute:
     rank  0: 1356.86
     rank  1: 1357.77
     rank  2: 1366.71
     rank  3: 1371.08
     rank  4: 1047.39
     rank  5: 1049.70
     rank  6: 1039.07
     rank  7: 1037.49
     rank  8: 1197.50
     rank  9: 1209.34
     rank 10: 1210.55
     rank 11: 1209.35
     rank 12: 817.91
     rank 13: 832.65
     rank 14: 834.11
     rank 15: 838.75
  backward-compute:
     rank  0: 94.10
     rank  1: 94.08
     rank  2: 93.99
     rank  3: 88.30
     rank  4: 1491.65
     rank  5: 1501.39
     rank  6: 1504.37
     rank  7: 1503.75
     rank  8: 1763.96
     rank  9: 1774.29
     rank 10: 1771.24
     rank 11: 1778.26
     rank 12: 1210.07
     rank 13: 1208.57
     rank 14: 1206.45
     rank 15: 1203.97
  pure-backward-compute:
     rank  0: 93.21
     rank  1: 93.27
     rank  2: 93.21
     rank  3: 87.61
     rank  4: 1490.72
     rank  5: 1500.34
     rank  6: 1503.52
     rank  7: 1502.85
     rank  8: 1760.75
     rank  9: 1772.81
     rank 10: 1769.47
     rank 11: 1776.14
     rank 12: 1207.46
     rank 13: 1206.69
     rank 14: 1203.46
     rank 15: 1201.90
  batch-generator:
     rank  0: 58.56
     rank  1: 60.30
     rank  2: 57.37
     rank  3: 62.94
     rank  4: 49.56
     rank  5: 59.19
     rank  6: 42.92
     rank  7: 45.99
     rank  8: 62.67
     rank  9: 72.89
     rank 10: 63.14
     rank 11: 61.38
     rank 12: 61.17
     rank 13: 76.08
     rank 14: 73.45
     rank 15: 77.76
  forward-recv:
     rank  4: 121.32
     rank  5: 121.45
     rank  6: 123.39
     rank  7: 123.54
     rank  8: 161.85
     rank  9: 162.78
     rank 10: 163.40
     rank 11: 162.99
     rank 12: 237.68
     rank 13: 237.13
     rank 14: 237.71
     rank 15: 237.89
  forward-send:
     rank  0: 6.51
     rank  1: 6.64
     rank  2: 6.37
     rank  3: 6.67
     rank  4: 9.30
     rank  5: 9.15
     rank  6: 9.17
     rank  7: 9.08
     rank  8: 5.15
     rank  9: 4.47
     rank 10: 5.02
     rank 11: 5.11
  backward-recv:
     rank  0: 513.32
     rank  1: 513.44
     rank  2: 520.19
     rank  3: 520.58
     rank  4: 142.82
     rank  5: 142.10
     rank  6: 147.82
     rank  7: 147.44
     rank  8: 18.68
     rank  9: 18.59
     rank 10: 25.08
     rank 11: 25.22
  backward-send:
     rank  4: 4.32
     rank  5: 4.33
     rank  6: 4.65
     rank  7: 4.71
     rank  8: 7.50
     rank  9: 7.01
     rank 10: 7.40
     rank 11: 7.09
     rank 12: 5.31
     rank 13: 5.06
     rank 14: 5.36
     rank 15: 4.73
  forward-send-backward-recv:
     rank  0: 1564.41
     rank  1: 1563.16
     rank  2: 1549.47
     rank  3: 1549.79
     rank  4: 663.48
     rank  5: 654.67
     rank  6: 659.55
     rank  7: 660.79
     rank  8: 187.00
     rank  9: 181.24
     rank 10: 173.91
     rank 11: 169.34
  backward-send-forward-recv:
     rank  4: 41.19
     rank  5: 38.87
     rank  6: 38.84
     rank  7: 39.76
     rank  8: 77.75
     rank  9: 69.45
     rank 10: 71.19
     rank 11: 70.64
     rank 12: 1045.44
     rank 13: 1033.93
     rank 14: 1032.74
     rank 15: 1031.70
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.05
     rank  4: 0.04
     rank  5: 0.02
     rank  6: 0.04
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.05
  embedding-grads-all-reduce:
     rank  0: 0.07
     rank  1: 0.05
     rank  2: 0.05
     rank  3: 0.07
     rank  4: 0.04
     rank  5: 0.02
     rank  6: 0.04
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.07
     rank 13: 0.07
     rank 14: 0.07
     rank 15: 0.12
  all-grads-sync:
     rank  0: 29.74
     rank  1: 29.15
     rank  2: 29.79
     rank  3: 29.09
     rank  4: 477.74
     rank  5: 477.71
     rank  6: 477.75
     rank  7: 477.71
     rank  8: 528.33
     rank  9: 528.71
     rank 10: 528.30
     rank 11: 528.76
     rank 12: 289.57
     rank 13: 276.57
     rank 14: 289.54
     rank 15: 276.62
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.08
     rank  5: 0.04
     rank  6: 0.04
     rank  7: 0.03
     rank  8: 0.05
     rank  9: 0.05
     rank 10: 0.06
     rank 11: 0.07
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.03
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 6.00
     rank  1: 6.00
     rank  2: 6.00
     rank  3: 6.05
     rank  4: 60.20
     rank  5: 60.11
     rank  6: 60.26
     rank  7: 60.18
     rank  8: 64.28
     rank  9: 64.34
     rank 10: 64.53
     rank 11: 64.48
     rank 12: 33.65
     rank 13: 33.69
     rank 14: 33.66
     rank 15: 33.84
  optimizer:
     rank  0: 6.67
     rank  1: 6.67
     rank  2: 6.67
     rank  3: 6.72
     rank  4: 60.86
     rank  5: 60.77
     rank  6: 60.92
     rank  7: 60.86
     rank  8: 64.94
     rank  9: 65.00
     rank 10: 65.29
     rank 11: 65.15
     rank 12: 34.31
     rank 13: 34.35
     rank 14: 34.33
     rank 15: 34.50
 [2024-12-30 22:47:04] iteration       10/      10 | consumed samples:          320 | elapsed time per iteration (ms): 4142.8 | learning rate: 7.500000E-06 | global batch size:    32 | lm loss: 2.083034E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 4045.62
     rank  1: 4045.63
     rank  2: 4045.63
     rank  3: 4045.62
     rank  4: 4050.72
     rank  5: 4050.70
     rank  6: 4050.68
     rank  7: 4050.68
     rank  8: 4051.12
     rank  9: 4051.20
     rank 10: 4051.11
     rank 11: 4051.22
     rank 12: 4048.35
     rank 13: 4048.32
     rank 14: 4048.36
     rank 15: 4048.37
  forward-compute:
     rank  0: 1368.78
     rank  1: 1370.59
     rank  2: 1362.18
     rank  3: 1365.38
     rank  4: 1048.62
     rank  5: 1053.45
     rank  6: 1031.63
     rank  7: 1031.13
     rank  8: 1184.90
     rank  9: 1193.05
     rank 10: 1201.02
     rank 11: 1199.83
     rank 12: 820.78
     rank 13: 835.04
     rank 14: 817.32
     rank 15: 819.21
  backward-compute:
     rank  0: 93.93
     rank  1: 94.68
     rank  2: 91.70
     rank  3: 87.63
     rank  4: 1494.93
     rank  5: 1505.07
     rank  6: 1508.72
     rank  7: 1506.74
     rank  8: 1760.94
     rank  9: 1768.25
     rank 10: 1769.12
     rank 11: 1772.06
     rank 12: 1212.24
     rank 13: 1210.46
     rank 14: 1206.84
     rank 15: 1203.55
  pure-backward-compute:
     rank  0: 93.11
     rank  1: 93.80
     rank  2: 90.94
     rank  3: 86.99
     rank  4: 1493.73
     rank  5: 1504.08
     rank  6: 1507.85
     rank  7: 1505.90
     rank  8: 1757.70
     rank  9: 1766.65
     rank 10: 1767.70
     rank 11: 1770.58
     rank 12: 1209.69
     rank 13: 1208.52
     rank 14: 1203.12
     rank 15: 1201.63
  batch-generator:
     rank  0: 59.86
     rank  1: 63.03
     rank  2: 58.38
     rank  3: 62.46
     rank  4: 53.74
     rank  5: 58.11
     rank  6: 42.56
     rank  7: 43.28
     rank  8: 54.83
     rank  9: 66.52
     rank 10: 55.29
     rank 11: 53.76
     rank 12: 59.45
     rank 13: 74.01
     rank 14: 60.94
     rank 15: 62.41
  forward-recv:
     rank  4: 121.33
     rank  5: 121.56
     rank  6: 124.52
     rank  7: 124.67
     rank  8: 158.88
     rank  9: 158.99
     rank 10: 162.65
     rank 11: 162.74
     rank 12: 230.27
     rank 13: 230.09
     rank 14: 232.56
     rank 15: 232.52
  forward-send:
     rank  0: 4.95
     rank  1: 5.18
     rank  2: 4.91
     rank  3: 5.18
     rank  4: 5.90
     rank  5: 5.69
     rank  6: 6.01
     rank  7: 6.04
     rank  8: 4.86
     rank  9: 4.69
     rank 10: 3.30
     rank 11: 3.23
  backward-recv:
     rank  0: 511.22
     rank  1: 511.05
     rank  2: 512.55
     rank  3: 513.44
     rank  4: 142.06
     rank  5: 139.37
     rank  6: 139.67
     rank  7: 140.02
     rank  8: 17.58
     rank  9: 19.98
     rank 10: 16.81
     rank 11: 17.18
  backward-send:
     rank  4: 4.68
     rank  5: 4.38
     rank  6: 5.00
     rank  7: 4.71
     rank  8: 9.00
     rank  9: 6.54
     rank 10: 9.26
     rank 11: 9.00
     rank 12: 5.14
     rank 13: 4.83
     rank 14: 5.28
     rank 15: 5.07
  forward-send-backward-recv:
     rank  0: 1536.18
     rank  1: 1533.31
     rank  2: 1545.36
     rank  3: 1544.53
     rank  4: 642.93
     rank  5: 635.75
     rank  6: 651.89
     rank  7: 653.39
     rank  8: 184.77
     rank  9: 183.13
     rank 10: 171.77
     rank 11: 168.99
  backward-send-forward-recv:
     rank  4: 42.73
     rank  5: 38.80
     rank  6: 39.90
     rank  7: 39.98
     rank  8: 79.12
     rank  9: 72.84
     rank 10: 74.94
     rank 11: 75.91
     rank 12: 1027.66
     rank 13: 1016.49
     rank 14: 1034.18
     rank 15: 1037.19
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.06
     rank  2: 0.06
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.07
     rank 13: 0.06
     rank 14: 0.08
     rank 15: 0.07
  all-grads-sync:
     rank  0: 30.02
     rank  1: 29.03
     rank  2: 30.10
     rank  3: 29.11
     rank  4: 487.23
     rank  5: 487.39
     rank  6: 487.21
     rank  7: 487.39
     rank  8: 523.53
     rank  9: 523.62
     rank 10: 523.53
     rank 11: 523.62
     rank 12: 290.34
     rank 13: 278.08
     rank 14: 290.25
     rank 15: 277.87
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.04
     rank  5: 0.04
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.04
     rank  9: 0.05
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.04
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 6.00
     rank  1: 6.02
     rank  2: 6.02
     rank  3: 5.99
     rank  4: 60.19
     rank  5: 60.18
     rank  6: 60.23
     rank  7: 60.17
     rank  8: 64.32
     rank  9: 64.31
     rank 10: 64.33
     rank 11: 64.38
     rank 12: 33.63
     rank 13: 33.66
     rank 14: 33.69
     rank 15: 33.70
  optimizer:
     rank  0: 6.57
     rank  1: 6.59
     rank  2: 6.60
     rank  3: 6.56
     rank  4: 60.76
     rank  5: 60.75
     rank  6: 60.81
     rank  7: 60.74
     rank  8: 64.89
     rank  9: 64.89
     rank 10: 64.91
     rank 11: 64.96
     rank 12: 34.20
     rank 13: 34.24
     rank 14: 34.27
     rank 15: 34.28
