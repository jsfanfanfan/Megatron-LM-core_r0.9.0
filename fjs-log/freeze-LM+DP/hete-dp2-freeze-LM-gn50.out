examples/multimodal/pretrain-freeze-llm-hete-2080first.sh: line 4: activate: No such file or directory
4
[2024-12-12 13:07:22,576] torch.distributed.run: [WARNING] 
[2024-12-12 13:07:22,576] torch.distributed.run: [WARNING] *****************************************
[2024-12-12 13:07:22,576] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-12-12 13:07:22,576] torch.distributed.run: [WARNING] *****************************************
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:10------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:10------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:10------
------num_pipeline_model_parallel_groups:4------
> setting tensorboard ...
WARNING: one_logger package is required to enable e2e metrics tracking. please go to https://confluence.nvidia.com/display/MLWFO/Package+Repositories for details to install it
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:10------
------num_pipeline_model_parallel_groups:4------
---Rank 17---Tensor Parallel Group GPUs: [1, 1]---Rank 16---Tensor Parallel Group GPUs: [0, 0]

---Rank 17---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]---Rank 16---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]

---Rank 19---Tensor Parallel Group GPUs: [1, 1]
---Rank 19---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4][rank17]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())

[rank16]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
---Rank 18---Tensor Parallel Group GPUs: [0, 0]
---Rank 18---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]
[rank19]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank18]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
 > number of parameters on (tensor, pipeline) model parallel rank (1, 4): 1375834112
 > number of parameters on (tensor, pipeline) model parallel rank (0, 4): 1375834112
rank=0, worker=0: shard_range=[pretrain-0.tar[0, 100), pretrain-0.tar[100, 200), pretrain-0.tar[200, 300), ...<1244>, pretrain-2.tar[4700, 4800), pretrain-2.tar[4800, 4900), pretrain-2.tar[4900, 5000)] sum(count)=125000
rank=0, worker=1: shard_range=[pretrain-2.tar[5000, 5100), pretrain-2.tar[5100, 5200), pretrain-2.tar[5200, 5300), ...<1244>, pretrain-30.tar[9700, 9800), pretrain-30.tar[9800, 9900), pretrain-30.tar[9900, 10000)] sum(count)=125000
rank=1, worker=0: shard_range=[pretrain-31.tar[0, 100), pretrain-31.tar[100, 200), pretrain-31.tar[200, 300), ...<1244>, pretrain-42.tar[4700, 4800), pretrain-42.tar[4800, 4900), pretrain-42.tar[4900, 5000)] sum(count)=125000
rank=1, worker=1: shard_range=[pretrain-42.tar[5000, 5100), pretrain-42.tar[5100, 5200), pretrain-42.tar[5200, 5300), ...<1244>, pretrain-53.tar[9700, 9800), pretrain-53.tar[9800, 9900), pretrain-53.tar[9900, 10000)] sum(count)=125000
rank=0, worker=0: shard_range=[pretrain-54.tar[0, 10000), pretrain-55.tar[0, 4532)] sum(count)=14532
rank=0, worker=1: shard_range=[pretrain-55.tar[4532, 8128), pretrain-6.tar[0, 10000), pretrain-7.tar[0, 936)] sum(count)=14532
rank=1, worker=0: shard_range=[pretrain-7.tar[936, 10000), pretrain-8.tar[0, 5468)] sum(count)=14532
rank=1, worker=1: shard_range=[pretrain-8.tar[5468, 10000), pretrain-9.tar[0, 10000)] sum(count)=14532
times across ranks (ms):
  model-and-optimizer-setup:
     rank  0: 76.79
     rank  1: 77.18
     rank  2: 76.38
     rank  3: 74.86
     rank  4: 84.76
     rank  5: 81.09
     rank  6: 85.33
     rank  7: 80.45
     rank  8: 77.43
     rank  9: 66.79
     rank 10: 65.72
     rank 11: 66.33
     rank 12: 93.64
     rank 13: 87.29
     rank 14: 87.18
     rank 15: 94.86
     rank 16: 63.11
     rank 17: 50.23
     rank 18: 67.32
     rank 19: 52.72
  train/valid/test-data-iterators-setup:
     rank  0: 1019.40
     rank  1: 1019.39
     rank  2: 1358.01
     rank  3: 1019.64
     rank  4: 1357.85
     rank  5: 1358.56
     rank  6: 1338.88
     rank  7: 1357.82
     rank  8: 1357.83
     rank  9: 1358.75
     rank 10: 1357.86
     rank 11: 1357.90
     rank 12: 1358.31
     rank 13: 1358.13
     rank 14: 1358.02
     rank 15: 1358.19
     rank 16: 1357.98
     rank 17: 1358.01
     rank 18: 1358.01
     rank 19: 1358.07
 [2024-12-12 13:08:01] iteration        1/      10 | consumed samples:           32 | elapsed time per iteration (ms): 18346.6 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 7.033182E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
[Rank 16] (after 1 iterations) memory (MB) | allocated: 5333.6435546875 | max allocated: 10449.3818359375 | reserved: 11528.0 | max reserved: 11528.0
[Rank 17] (after 1 iterations) memory (MB) | allocated: 5333.6435546875 | max allocated: 10449.3818359375 | reserved: 11400.0 | max reserved: 11400.0
times across ranks (ms):
  forward-backward:
     rank  0: 18221.29
     rank  1: 18220.82
     rank  2: 18220.96
     rank  3: 18220.72
     rank  4: 18218.45
     rank  5: 18216.72
     rank  6: 18217.19
     rank  7: 18217.04
     rank  8: 18280.76
     rank  9: 18277.67
     rank 10: 18280.86
     rank 11: 18277.79
     rank 12: 18288.17
     rank 13: 18295.62
     rank 14: 18288.22
     rank 15: 18295.92
     rank 16: 18214.85
     rank 17: 18214.79
     rank 18: 18214.87
     rank 19: 18214.85
  forward-compute:
     rank  0: 2620.80
     rank  1: 2643.58
     rank  2: 2576.50
     rank  3: 2581.37
     rank  4: 3671.17
     rank  5: 3694.02
     rank  6: 3542.24
     rank  7: 3544.42
     rank  8: 3417.64
     rank  9: 3439.84
     rank 10: 3380.91
     rank 11: 3377.83
     rank 12: 4378.76
     rank 13: 4385.94
     rank 14: 4553.04
     rank 15: 4542.95
     rank 16: 4653.40
     rank 17: 4671.22
     rank 18: 4379.16
     rank 19: 4378.64
  backward-compute:
     rank  0: 1508.17
     rank  1: 1505.78
     rank  2: 1507.99
     rank  3: 1502.90
     rank  4: 2051.34
     rank  5: 2050.24
     rank  6: 2160.63
     rank  7: 2159.88
     rank  8: 2233.28
     rank  9: 2235.65
     rank 10: 2136.30
     rank 11: 2130.37
     rank 12: 2838.64
     rank 13: 2847.96
     rank 14: 2839.13
     rank 15: 2832.34
     rank 16: 2719.43
     rank 17: 2709.86
     rank 18: 2728.73
     rank 19: 2720.64
  pure-backward-compute:
     rank  0: 1507.43
     rank  1: 1505.21
     rank  2: 1507.41
     rank  3: 1502.28
     rank  4: 2050.07
     rank  5: 2049.04
     rank  6: 2159.24
     rank  7: 2158.44
     rank  8: 2232.23
     rank  9: 2234.70
     rank 10: 2135.13
     rank 11: 2129.47
     rank 12: 2837.46
     rank 13: 2845.61
     rank 14: 2838.21
     rank 15: 2829.83
     rank 16: 2717.95
     rank 17: 2707.64
     rank 18: 2727.13
     rank 19: 2718.94
  batch-generator:
     rank  0: 1042.51
     rank  1: 1062.51
     rank  2: 999.67
     rank  3: 1008.83
     rank  4: 1215.77
     rank  5: 1235.25
     rank  6: 1231.93
     rank  7: 1232.45
     rank  8: 1291.32
     rank  9: 1301.44
     rank 10: 1362.26
     rank 11: 1361.83
     rank 12: 855.61
     rank 13: 862.77
     rank 14: 1038.33
     rank 15: 1034.52
     rank 16: 1005.20
     rank 17: 1014.19
     rank 18: 1068.49
     rank 19: 1058.75
  forward-recv:
     rank  4: 2205.27
     rank  5: 2206.40
     rank  6: 2184.48
     rank  7: 2177.07
     rank  8: 4807.61
     rank  9: 4790.26
     rank 10: 4725.62
     rank 11: 4726.66
     rank 12: 6453.62
     rank 13: 6452.56
     rank 14: 6420.23
     rank 15: 6420.42
     rank 16: 8755.23
     rank 17: 8753.59
     rank 18: 8902.68
     rank 19: 8904.12
  forward-send:
     rank  0: 6468.28
     rank  1: 6447.24
     rank  2: 6668.49
     rank  3: 6665.97
     rank  4: 3684.88
     rank  5: 3660.98
     rank  6: 3926.32
     rank  7: 3931.08
     rank  8: 2079.01
     rank  9: 2074.77
     rank 10: 2274.96
     rank 11: 2277.01
     rank 12: 32.16
     rank 13: 30.30
     rank 14: 21.59
     rank 15: 22.93
  backward-recv:
     rank  0: 2347.98
     rank  1: 2348.76
     rank  2: 2301.61
     rank  3: 2302.26
     rank  4: 1554.73
     rank  5: 1554.68
     rank  6: 1524.42
     rank  7: 1525.37
     rank  8: 779.51
     rank  9: 780.32
     rank 10: 766.76
     rank 11: 766.89
     rank 12: 297.66
     rank 13: 297.77
     rank 14: 282.28
     rank 15: 282.68
  backward-send:
     rank  4: 4.60
     rank  5: 4.17
     rank  6: 3.11
     rank  7: 2.98
     rank  8: 20.00
     rank  9: 18.92
     rank 10: 16.61
     rank 11: 16.51
     rank 12: 17.84
     rank 13: 16.95
     rank 14: 15.80
     rank 15: 15.57
     rank 16: 6.85
     rank 17: 7.09
     rank 18: 7.23
     rank 19: 7.27
  forward-send-backward-recv:
     rank  0: 5004.75
     rank  1: 5005.12
     rank  2: 4880.17
     rank  3: 4881.10
     rank  4: 4005.99
     rank  5: 4005.82
     rank  6: 3819.85
     rank  7: 3821.01
     rank  8: 3313.94
     rank  9: 3312.09
     rank 10: 3227.30
     rank 11: 3233.86
     rank 12: 2584.14
     rank 13: 2575.02
     rank 14: 2401.87
     rank 15: 2403.70
  backward-send-forward-recv:
     rank  4: 683.91
     rank  5: 683.48
     rank  6: 685.74
     rank  7: 686.63
     rank  8: 1058.27
     rank  9: 1058.32
     rank 10: 1172.07
     rank 11: 1171.53
     rank 12: 827.47
     rank 13: 820.61
     rank 14: 897.01
     rank 15: 903.30
     rank 16: 933.04
     rank 17: 925.90
     rank 18: 1053.91
     rank 19: 1060.93
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.06
     rank  3: 0.04
     rank  4: 0.11
     rank  5: 0.04
     rank  6: 0.04
     rank  7: 0.07
     rank  8: 0.07
     rank  9: 0.03
     rank 10: 0.16
     rank 11: 0.09
     rank 12: 0.05
     rank 13: 0.03
     rank 14: 0.05
     rank 15: 0.05
     rank 16: 0.03
     rank 17: 0.02
     rank 18: 0.03
     rank 19: 0.04
  embedding-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.16
     rank  5: 0.12
     rank  6: 0.12
     rank  7: 0.17
     rank  8: 0.04
     rank  9: 0.03
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
     rank 16: 0.06
     rank 17: 0.05
     rank 18: 0.06
     rank 19: 0.07
  all-grads-sync:
     rank  0: 255.61
     rank  1: 249.92
     rank  2: 255.78
     rank  3: 250.09
     rank  4: 236.54
     rank  5: 227.31
     rank  6: 236.57
     rank  7: 227.39
     rank  8: 0.07
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.04
     rank 13: 0.03
     rank 14: 0.04
     rank 15: 0.03
     rank 16: 0.26
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.22
     rank  1: 0.22
     rank  2: 0.31
     rank  3: 0.22
     rank  4: 0.36
     rank  5: 0.14
     rank  6: 0.17
     rank  7: 0.18
     rank  8: 0.11
     rank  9: 0.03
     rank 10: 0.05
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.04
     rank 14: 0.03
     rank 15: 0.14
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.01
     rank 19: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.06
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.04
     rank 14: 0.02
     rank 15: 0.07
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.04
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 39.85
     rank  1: 40.43
     rank  2: 44.86
     rank  3: 40.73
     rank  4: 37.21
     rank  5: 35.67
     rank  6: 35.94
     rank  7: 35.01
     rank  8: 0.18
     rank  9: 0.12
     rank 10: 0.18
     rank 11: 0.17
     rank 12: 0.17
     rank 13: 0.22
     rank 14: 0.14
     rank 15: 0.75
     rank 16: 0.09
     rank 17: 0.10
     rank 18: 0.10
     rank 19: 0.07
  optimizer:
     rank  0: 42.33
     rank  1: 42.91
     rank  2: 47.36
     rank  3: 43.22
     rank  4: 39.69
     rank  5: 38.15
     rank  6: 38.43
     rank  7: 37.49
     rank  8: 2.66
     rank  9: 2.58
     rank 10: 2.63
     rank 11: 2.61
     rank 12: 2.63
     rank 13: 2.72
     rank 14: 2.59
     rank 15: 3.23
     rank 16: 1.60
     rank 17: 2.55
     rank 18: 2.57
     rank 19: 2.55
 [2024-12-12 13:08:08] iteration        2/      10 | consumed samples:           64 | elapsed time per iteration (ms): 7241.8 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 7.133366E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 7181.77
     rank  1: 7181.80
     rank  2: 7181.80
     rank  3: 7181.87
     rank  4: 7183.42
     rank  5: 7181.34
     rank  6: 7181.74
     rank  7: 7181.57
     rank  8: 7180.37
     rank  9: 7180.06
     rank 10: 7180.35
     rank 11: 7180.12
     rank 12: 7180.23
     rank 13: 7180.08
     rank 14: 7180.19
     rank 15: 7180.16
     rank 16: 7179.88
     rank 17: 7179.91
     rank 18: 7179.86
     rank 19: 7179.96
  forward-compute:
     rank  0: 627.15
     rank  1: 632.62
     rank  2: 614.76
     rank  3: 615.84
     rank  4: 1218.13
     rank  5: 1224.46
     rank  6: 1158.73
     rank  7: 1160.07
     rank  8: 2061.83
     rank  9: 2071.19
     rank 10: 1981.23
     rank 11: 1982.05
     rank 12: 2375.99
     rank 13: 2386.87
     rank 14: 2357.67
     rank 15: 2355.62
     rank 16: 2303.50
     rank 17: 2303.13
     rank 18: 2510.11
     rank 19: 2510.30
  backward-compute:
     rank  0: 675.84
     rank  1: 677.16
     rank  2: 690.64
     rank  3: 690.26
     rank  4: 1236.15
     rank  5: 1249.62
     rank  6: 1198.04
     rank  7: 1197.94
     rank  8: 2184.53
     rank  9: 2190.35
     rank 10: 2122.46
     rank 11: 2122.49
     rank 12: 2813.54
     rank 13: 2814.34
     rank 14: 2809.82
     rank 15: 2808.50
     rank 16: 2736.98
     rank 17: 2732.64
     rank 18: 2709.67
     rank 19: 2709.77
  pure-backward-compute:
     rank  0: 675.35
     rank  1: 676.68
     rank  2: 690.14
     rank  3: 689.77
     rank  4: 1234.91
     rank  5: 1248.78
     rank  6: 1197.06
     rank  7: 1196.99
     rank  8: 2183.77
     rank  9: 2189.73
     rank 10: 2121.76
     rank 11: 2121.75
     rank 12: 2812.23
     rank 13: 2812.86
     rank 14: 2808.73
     rank 15: 2807.57
     rank 16: 2735.14
     rank 17: 2731.27
     rank 18: 2708.19
     rank 19: 2708.15
  batch-generator:
     rank  0: 47.83
     rank  1: 53.88
     rank  2: 41.55
     rank  3: 43.63
     rank  4: 54.31
     rank  5: 60.16
     rank  6: 48.61
     rank  7: 51.24
     rank  8: 36.41
     rank  9: 47.44
     rank 10: 47.98
     rank 11: 48.62
     rank 12: 33.79
     rank 13: 44.71
     rank 14: 30.03
     rank 15: 29.31
     rank 16: 31.61
     rank 17: 31.85
     rank 18: 28.15
     rank 19: 27.83
  forward-recv:
     rank  4: 82.37
     rank  5: 80.89
     rank  6: 82.71
     rank  7: 81.69
     rank  8: 268.39
     rank  9: 268.10
     rank 10: 261.13
     rank 11: 259.90
     rank 12: 521.05
     rank 13: 518.03
     rank 14: 511.49
     rank 15: 511.54
     rank 16: 823.03
     rank 17: 823.25
     rank 18: 808.17
     rank 19: 808.35
  forward-send:
     rank  0: 526.33
     rank  1: 521.10
     rank  2: 510.03
     rank  3: 509.44
     rank  4: 289.71
     rank  5: 286.58
     rank  6: 283.24
     rank  7: 282.63
     rank  8: 54.89
     rank  9: 52.59
     rank 10: 58.83
     rank 11: 59.33
     rank 12: 5.54
     rank 13: 5.60
     rank 14: 5.35
     rank 15: 5.51
  backward-recv:
     rank  0: 2307.36
     rank  1: 2305.96
     rank  2: 2334.29
     rank  3: 2334.18
     rank  4: 1502.96
     rank  5: 1499.69
     rank  6: 1554.59
     rank  7: 1553.35
     rank  8: 745.79
     rank  9: 748.93
     rank 10: 800.55
     rank 11: 801.04
     rank 12: 279.61
     rank 13: 280.22
     rank 14: 316.15
     rank 15: 316.85
  backward-send:
     rank  4: 4.70
     rank  5: 3.14
     rank  6: 3.41
     rank  7: 2.92
     rank  8: 21.47
     rank  9: 17.85
     rank 10: 16.49
     rank 11: 16.16
     rank 12: 16.23
     rank 13: 16.05
     rank 14: 12.36
     rank 15: 12.16
     rank 16: 6.25
     rank 17: 6.23
     rank 18: 5.55
     rank 19: 6.29
  forward-send-backward-recv:
     rank  0: 2872.87
     rank  1: 2872.10
     rank  2: 2834.38
     rank  3: 2835.28
     rank  4: 2576.87
     rank  5: 2569.52
     rank  6: 2611.36
     rank  7: 2612.33
     rank  8: 1360.08
     rank  9: 1354.13
     rank 10: 1475.25
     rank 11: 1475.84
     rank 12: 394.40
     rank 13: 394.13
     rank 14: 419.45
     rank 15: 419.58
  backward-send-forward-recv:
     rank  4: 10.43
     rank  5: 9.38
     rank  6: 7.55
     rank  7: 7.96
     rank  8: 69.83
     rank  9: 63.42
     rank 10: 34.04
     rank 11: 34.09
     rank 12: 77.35
     rank 13: 69.19
     rank 14: 43.83
     rank 15: 45.07
     rank 16: 255.77
     rank 17: 260.30
     rank 18: 86.27
     rank 19: 86.18
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.08
     rank  5: 0.03
     rank  6: 0.04
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.06
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.04
     rank 16: 0.03
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.04
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.26
     rank  5: 0.09
     rank  6: 0.11
     rank  7: 0.11
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.04
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.06
     rank 17: 0.06
     rank 18: 0.05
     rank 19: 0.11
  all-grads-sync:
     rank  0: 163.83
     rank  1: 158.46
     rank  2: 163.93
     rank  3: 158.57
     rank  4: 149.12
     rank  5: 142.51
     rank  6: 149.20
     rank  7: 142.53
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.04
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.05
  optimizer-copy-to-main-grad:
     rank  0: 0.16
     rank  1: 0.19
     rank  2: 0.16
     rank  3: 0.20
     rank  4: 0.19
     rank  5: 0.11
     rank  6: 0.11
     rank  7: 0.20
     rank  8: 0.05
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.01
     rank 17: 0.02
     rank 18: 0.01
     rank 19: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.05
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 20.23
     rank  1: 20.46
     rank  2: 20.46
     rank  3: 20.51
     rank  4: 14.83
     rank  5: 15.02
     rank  6: 14.44
     rank  7: 15.03
     rank  8: 0.12
     rank  9: 0.05
     rank 10: 0.26
     rank 11: 0.06
     rank 12: 0.07
     rank 13: 0.07
     rank 14: 0.03
     rank 15: 0.08
     rank 16: 0.07
     rank 17: 0.07
     rank 18: 0.07
     rank 19: 0.07
  optimizer:
     rank  0: 21.68
     rank  1: 21.93
     rank  2: 21.93
     rank  3: 21.97
     rank  4: 16.08
     rank  5: 16.54
     rank  6: 15.90
     rank  7: 16.49
     rank  8: 1.58
     rank  9: 1.51
     rank 10: 1.72
     rank 11: 1.51
     rank 12: 1.53
     rank 13: 1.53
     rank 14: 1.49
     rank 15: 1.53
     rank 16: 1.53
     rank 17: 1.53
     rank 18: 1.52
     rank 19: 1.53
 [2024-12-12 13:08:16] iteration        3/      10 | consumed samples:           96 | elapsed time per iteration (ms): 7223.0 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 7.185898E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 7172.15
     rank  1: 7172.19
     rank  2: 7172.09
     rank  3: 7172.16
     rank  4: 7171.93
     rank  5: 7171.80
     rank  6: 7171.64
     rank  7: 7172.05
     rank  8: 7170.58
     rank  9: 7170.42
     rank 10: 7170.54
     rank 11: 7170.47
     rank 12: 7170.31
     rank 13: 7170.35
     rank 14: 7170.32
     rank 15: 7170.42
     rank 16: 7170.23
     rank 17: 7170.28
     rank 18: 7170.19
     rank 19: 7170.22
  forward-compute:
     rank  0: 622.32
     rank  1: 627.19
     rank  2: 614.56
     rank  3: 613.22
     rank  4: 1206.80
     rank  5: 1212.02
     rank  6: 1150.86
     rank  7: 1149.29
     rank  8: 2075.32
     rank  9: 2083.29
     rank 10: 1986.53
     rank 11: 1986.48
     rank 12: 2369.87
     rank 13: 2380.47
     rank 14: 2364.32
     rank 15: 2364.94
     rank 16: 2328.31
     rank 17: 2327.86
     rank 18: 2513.70
     rank 19: 2513.29
  backward-compute:
     rank  0: 689.59
     rank  1: 690.24
     rank  2: 673.89
     rank  3: 671.55
     rank  4: 1231.63
     rank  5: 1241.22
     rank  6: 1192.83
     rank  7: 1191.58
     rank  8: 2191.13
     rank  9: 2196.17
     rank 10: 2135.67
     rank 11: 2137.85
     rank 12: 2810.66
     rank 13: 2810.91
     rank 14: 2809.10
     rank 15: 2809.28
     rank 16: 2740.42
     rank 17: 2739.77
     rank 18: 2706.62
     rank 19: 2707.99
  pure-backward-compute:
     rank  0: 689.18
     rank  1: 689.77
     rank  2: 673.45
     rank  3: 671.09
     rank  4: 1230.87
     rank  5: 1240.49
     rank  6: 1192.21
     rank  7: 1190.46
     rank  8: 2190.37
     rank  9: 2195.49
     rank 10: 2134.74
     rank 11: 2137.03
     rank 12: 2809.88
     rank 13: 2810.14
     rank 14: 2808.34
     rank 15: 2808.58
     rank 16: 2738.46
     rank 17: 2738.64
     rank 18: 2705.17
     rank 19: 2706.66
  batch-generator:
     rank  0: 44.50
     rank  1: 50.11
     rank  2: 43.35
     rank  3: 42.83
     rank  4: 47.19
     rank  5: 53.55
     rank  6: 43.94
     rank  7: 44.47
     rank  8: 39.16
     rank  9: 47.90
     rank 10: 43.96
     rank 11: 44.22
     rank 12: 29.64
     rank 13: 40.38
     rank 14: 32.97
     rank 15: 34.19
     rank 16: 43.84
     rank 17: 41.60
     rank 18: 30.40
     rank 19: 31.05
  forward-recv:
     rank  4: 80.37
     rank  5: 78.84
     rank  6: 81.37
     rank  7: 81.62
     rank  8: 258.08
     rank  9: 257.63
     rank 10: 243.04
     rank 11: 243.11
     rank 12: 514.25
     rank 13: 512.15
     rank 14: 491.27
     rank 15: 491.31
     rank 16: 813.01
     rank 17: 812.94
     rank 18: 787.74
     rank 19: 787.85
  forward-send:
     rank  0: 517.31
     rank  1: 512.26
     rank  2: 488.73
     rank  3: 489.83
     rank  4: 292.56
     rank  5: 288.95
     rank  6: 265.37
     rank  7: 265.99
     rank  8: 49.90
     rank  9: 48.05
     rank 10: 59.87
     rank 11: 59.68
     rank 12: 5.57
     rank 13: 5.41
     rank 14: 5.48
     rank 15: 5.77
  backward-recv:
     rank  0: 2291.24
     rank  1: 2290.81
     rank  2: 2334.27
     rank  3: 2335.42
     rank  4: 1498.83
     rank  5: 1498.90
     rank  6: 1551.11
     rank  7: 1550.47
     rank  8: 744.61
     rank  9: 745.56
     rank 10: 792.12
     rank 11: 791.69
     rank 12: 280.50
     rank 13: 280.01
     rank 14: 309.81
     rank 15: 309.23
  backward-send:
     rank  4: 5.05
     rank  5: 3.18
     rank  6: 2.68
     rank  7: 3.31
     rank  8: 20.16
     rank  9: 19.02
     rank 10: 16.60
     rank 11: 16.65
     rank 12: 16.76
     rank 13: 16.42
     rank 14: 11.44
     rank 15: 11.56
     rank 16: 6.15
     rank 17: 6.16
     rank 18: 5.94
     rank 19: 5.66
  forward-send-backward-recv:
     rank  0: 2876.34
     rank  1: 2876.10
     rank  2: 2863.66
     rank  3: 2865.64
     rank  4: 2587.39
     rank  5: 2579.92
     rank  6: 2638.61
     rank  7: 2639.41
     rank  8: 1347.59
     rank  9: 1342.29
     rank 10: 1472.50
     rank 11: 1473.46
     rank 12: 400.11
     rank 13: 400.10
     rank 14: 426.61
     rank 15: 426.98
  backward-send-forward-recv:
     rank  4: 10.00
     rank  5: 9.77
     rank  6: 7.39
     rank  7: 7.46
     rank  8: 70.90
     rank  9: 65.08
     rank 10: 33.94
     rank 11: 33.97
     rank 12: 78.67
     rank 13: 70.41
     rank 14: 47.13
     rank 15: 46.24
     rank 16: 226.91
     rank 17: 228.77
     rank 18: 97.00
     rank 19: 96.31
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.04
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.04
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.05
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
     rank 16: 0.02
     rank 17: 0.04
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.12
     rank  5: 0.07
     rank  6: 0.07
     rank  7: 0.10
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.04
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.06
     rank 17: 0.11
     rank 18: 0.06
     rank 19: 0.05
  all-grads-sync:
     rank  0: 166.74
     rank  1: 160.78
     rank  2: 166.86
     rank  3: 160.96
     rank  4: 147.49
     rank  5: 141.34
     rank  6: 147.52
     rank  7: 141.34
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.04
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.07
     rank 17: 0.05
     rank 18: 0.02
     rank 19: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.17
     rank  1: 0.18
     rank  2: 0.14
     rank  3: 0.19
     rank  4: 0.19
     rank  5: 0.10
     rank  6: 0.15
     rank  7: 0.17
     rank  8: 0.04
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.01
     rank 19: 0.01
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.08
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.02
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 20.27
     rank  1: 20.36
     rank  2: 20.11
     rank  3: 20.51
     rank  4: 15.04
     rank  5: 14.24
     rank  6: 14.11
     rank  7: 14.71
     rank  8: 0.11
     rank  9: 0.15
     rank 10: 0.12
     rank 11: 0.05
     rank 12: 0.04
     rank 13: 0.03
     rank 14: 0.07
     rank 15: 0.07
     rank 16: 0.07
     rank 17: 0.08
     rank 18: 0.08
     rank 19: 0.04
  optimizer:
     rank  0: 21.30
     rank  1: 21.39
     rank  2: 21.14
     rank  3: 21.54
     rank  4: 16.07
     rank  5: 15.27
     rank  6: 15.13
     rank  7: 15.74
     rank  8: 1.13
     rank  9: 1.17
     rank 10: 1.14
     rank 11: 1.07
     rank 12: 1.06
     rank 13: 1.05
     rank 14: 1.09
     rank 15: 1.09
     rank 16: 1.08
     rank 17: 1.09
     rank 18: 1.10
     rank 19: 1.06
 [2024-12-12 13:08:23] iteration        4/      10 | consumed samples:          128 | elapsed time per iteration (ms): 7253.5 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 6.166547E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 7193.91
     rank  1: 7193.88
     rank  2: 7193.88
     rank  3: 7193.96
     rank  4: 7193.33
     rank  5: 7194.16
     rank  6: 7193.35
     rank  7: 7194.36
     rank  8: 7192.17
     rank  9: 7192.71
     rank 10: 7192.18
     rank 11: 7192.74
     rank 12: 7192.07
     rank 13: 7192.70
     rank 14: 7192.13
     rank 15: 7192.79
     rank 16: 7191.98
     rank 17: 7191.94
     rank 18: 7191.97
     rank 19: 7191.99
  forward-compute:
     rank  0: 621.68
     rank  1: 625.04
     rank  2: 607.27
     rank  3: 607.15
     rank  4: 1186.77
     rank  5: 1190.71
     rank  6: 1145.69
     rank  7: 1146.09
     rank  8: 2068.24
     rank  9: 2076.97
     rank 10: 1989.26
     rank 11: 1989.46
     rank 12: 2378.70
     rank 13: 2386.54
     rank 14: 2372.77
     rank 15: 2371.62
     rank 16: 2328.54
     rank 17: 2327.36
     rank 18: 2559.04
     rank 19: 2557.66
  backward-compute:
     rank  0: 684.68
     rank  1: 685.46
     rank  2: 676.15
     rank  3: 675.24
     rank  4: 1229.44
     rank  5: 1238.47
     rank  6: 1202.96
     rank  7: 1202.41
     rank  8: 2201.23
     rank  9: 2204.19
     rank 10: 2146.77
     rank 11: 2146.31
     rank 12: 2819.30
     rank 13: 2818.88
     rank 14: 2815.56
     rank 15: 2813.75
     rank 16: 2740.33
     rank 17: 2740.03
     rank 18: 2702.89
     rank 19: 2702.98
  pure-backward-compute:
     rank  0: 684.27
     rank  1: 685.01
     rank  2: 675.65
     rank  3: 674.78
     rank  4: 1228.76
     rank  5: 1237.76
     rank  6: 1201.88
     rank  7: 1201.40
     rank  8: 2200.54
     rank  9: 2203.50
     rank 10: 2145.86
     rank 11: 2145.57
     rank 12: 2818.52
     rank 13: 2818.11
     rank 14: 2814.92
     rank 15: 2813.10
     rank 16: 2738.60
     rank 17: 2738.94
     rank 18: 2701.71
     rank 19: 2701.71
  batch-generator:
     rank  0: 45.18
     rank  1: 49.11
     rank  2: 36.59
     rank  3: 37.69
     rank  4: 40.69
     rank  5: 45.35
     rank  6: 42.84
     rank  7: 44.86
     rank  8: 39.26
     rank  9: 48.41
     rank 10: 37.62
     rank 11: 37.95
     rank 12: 31.36
     rank 13: 39.14
     rank 14: 33.05
     rank 15: 32.16
     rank 16: 43.50
     rank 17: 42.07
     rank 18: 28.49
     rank 19: 27.94
  forward-recv:
     rank  4: 80.64
     rank  5: 79.19
     rank  6: 80.26
     rank  7: 79.71
     rank  8: 257.27
     rank  9: 256.00
     rank 10: 232.54
     rank 11: 232.42
     rank 12: 510.75
     rank 13: 509.54
     rank 14: 481.61
     rank 15: 481.70
     rank 16: 810.47
     rank 17: 810.05
     rank 18: 777.51
     rank 19: 777.58
  forward-send:
     rank  0: 514.23
     rank  1: 510.49
     rank  2: 483.66
     rank  3: 483.53
     rank  4: 289.34
     rank  5: 287.13
     rank  6: 282.74
     rank  7: 282.69
     rank  8: 45.38
     rank  9: 44.51
     rank 10: 61.22
     rank 11: 61.34
     rank 12: 5.45
     rank 13: 5.44
     rank 14: 5.50
     rank 15: 5.45
  backward-recv:
     rank  0: 2318.76
     rank  1: 2318.37
     rank  2: 2349.74
     rank  3: 2350.86
     rank  4: 1516.65
     rank  5: 1517.97
     rank  6: 1567.24
     rank  7: 1568.26
     rank  8: 749.64
     rank  9: 750.16
     rank 10: 810.40
     rank 11: 810.55
     rank 12: 287.89
     rank 13: 287.50
     rank 14: 322.90
     rank 15: 322.17
  backward-send:
     rank  4: 4.61
     rank  5: 3.85
     rank  6: 3.05
     rank  7: 3.10
     rank  8: 20.58
     rank  9: 20.07
     rank 10: 16.66
     rank 11: 16.87
     rank 12: 15.52
     rank 13: 15.74
     rank 14: 10.58
     rank 15: 11.31
     rank 16: 6.12
     rank 17: 6.14
     rank 18: 5.53
     rank 19: 5.95
  forward-send-backward-recv:
     rank  0: 2880.28
     rank  1: 2879.91
     rank  2: 2880.53
     rank  3: 2882.02
     rank  4: 2616.67
     rank  5: 2608.42
     rank  6: 2622.58
     rank  7: 2624.00
     rank  8: 1367.92
     rank  9: 1364.42
     rank 10: 1472.87
     rank 11: 1473.14
     rank 12: 399.48
     rank 13: 399.58
     rank 14: 435.13
     rank 15: 436.15
  backward-send-forward-recv:
     rank  4: 10.35
     rank  5: 10.00
     rank  6: 7.49
     rank  7: 7.46
     rank  8: 70.22
     rank  9: 63.61
     rank 10: 33.53
     rank 11: 33.68
     rank 12: 77.48
     rank 13: 71.11
     rank 14: 42.31
     rank 15: 43.33
     rank 16: 248.90
     rank 17: 251.66
     rank 18: 85.20
     rank 19: 85.93
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.04
     rank  6: 0.02
     rank  7: 0.31
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.04
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.06
     rank  5: 0.08
     rank  6: 0.09
     rank  7: 0.50
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.03
     rank 16: 0.07
     rank 17: 0.06
     rank 18: 0.06
     rank 19: 0.07
  all-grads-sync:
     rank  0: 164.85
     rank  1: 159.55
     rank  2: 164.97
     rank  3: 159.52
     rank  4: 148.17
     rank  5: 140.83
     rank  6: 148.26
     rank  7: 140.96
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.04
     rank 16: 0.07
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.16
     rank  1: 0.17
     rank  2: 0.15
     rank  3: 0.19
     rank  4: 0.10
     rank  5: 0.16
     rank  6: 0.13
     rank  7: 0.26
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 20.13
     rank  1: 20.30
     rank  2: 20.33
     rank  3: 20.49
     rank  4: 14.01
     rank  5: 14.31
     rank  6: 14.29
     rank  7: 14.65
     rank  8: 0.06
     rank  9: 0.12
     rank 10: 0.06
     rank 11: 0.08
     rank 12: 0.07
     rank 13: 0.08
     rank 14: 0.03
     rank 15: 0.07
     rank 16: 0.07
     rank 17: 0.04
     rank 18: 0.03
     rank 19: 0.07
  optimizer:
     rank  0: 21.45
     rank  1: 21.62
     rank  2: 21.65
     rank  3: 21.82
     rank  4: 15.33
     rank  5: 15.63
     rank  6: 15.61
     rank  7: 15.97
     rank  8: 1.37
     rank  9: 1.43
     rank 10: 1.38
     rank 11: 1.39
     rank 12: 1.38
     rank 13: 1.39
     rank 14: 1.35
     rank 15: 1.39
     rank 16: 1.38
     rank 17: 1.35
     rank 18: 1.35
     rank 19: 1.38
 [2024-12-12 13:08:30] iteration        5/      10 | consumed samples:          160 | elapsed time per iteration (ms): 7248.3 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 4.480733E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 7191.73
     rank  1: 7191.65
     rank  2: 7191.67
     rank  3: 7191.67
     rank  4: 7191.21
     rank  5: 7191.10
     rank  6: 7191.30
     rank  7: 7191.18
     rank  8: 7189.93
     rank  9: 7189.89
     rank 10: 7189.94
     rank 11: 7189.95
     rank 12: 7189.87
     rank 13: 7189.79
     rank 14: 7189.99
     rank 15: 7189.84
     rank 16: 7189.88
     rank 17: 7189.74
     rank 18: 7189.83
     rank 19: 7189.70
  forward-compute:
     rank  0: 619.98
     rank  1: 621.42
     rank  2: 613.24
     rank  3: 612.47
     rank  4: 1188.96
     rank  5: 1191.18
     rank  6: 1159.16
     rank  7: 1157.82
     rank  8: 2067.81
     rank  9: 2074.77
     rank 10: 2004.56
     rank 11: 2003.94
     rank 12: 2378.23
     rank 13: 2384.73
     rank 14: 2367.38
     rank 15: 2363.88
     rank 16: 2318.56
     rank 17: 2317.51
     rank 18: 2543.44
     rank 19: 2540.65
  backward-compute:
     rank  0: 693.17
     rank  1: 692.47
     rank  2: 671.49
     rank  3: 671.75
     rank  4: 1230.88
     rank  5: 1240.93
     rank  6: 1204.98
     rank  7: 1204.62
     rank  8: 2205.59
     rank  9: 2208.10
     rank 10: 2155.86
     rank 11: 2153.32
     rank 12: 2825.13
     rank 13: 2825.08
     rank 14: 2816.11
     rank 15: 2812.38
     rank 16: 2732.02
     rank 17: 2731.80
     rank 18: 2702.51
     rank 19: 2703.45
  pure-backward-compute:
     rank  0: 692.76
     rank  1: 692.03
     rank  2: 671.05
     rank  3: 671.30
     rank  4: 1230.02
     rank  5: 1240.25
     rank  6: 1203.74
     rank  7: 1203.83
     rank  8: 2204.88
     rank  9: 2207.45
     rank 10: 2154.94
     rank 11: 2152.50
     rank 12: 2824.63
     rank 13: 2824.48
     rank 14: 2815.54
     rank 15: 2811.71
     rank 16: 2730.31
     rank 17: 2730.70
     rank 18: 2701.31
     rank 19: 2702.15
  batch-generator:
     rank  0: 43.56
     rank  1: 46.32
     rank  2: 40.89
     rank  3: 41.53
     rank  4: 39.13
     rank  5: 42.39
     rank  6: 40.37
     rank  7: 40.68
     rank  8: 38.43
     rank  9: 47.11
     rank 10: 42.30
     rank 11: 42.55
     rank 12: 29.91
     rank 13: 36.59
     rank 14: 26.82
     rank 15: 25.31
     rank 16: 41.09
     rank 17: 40.04
     rank 18: 30.50
     rank 19: 28.09
  forward-recv:
     rank  4: 80.65
     rank  5: 79.57
     rank  6: 81.12
     rank  7: 82.21
     rank  8: 251.85
     rank  9: 251.38
     rank 10: 247.35
     rank 11: 247.62
     rank 12: 505.66
     rank 13: 504.75
     rank 14: 495.07
     rank 15: 495.16
     rank 16: 804.04
     rank 17: 803.96
     rank 18: 790.46
     rank 19: 790.49
  forward-send:
     rank  0: 508.04
     rank  1: 506.48
     rank  2: 491.92
     rank  3: 492.50
     rank  4: 288.18
     rank  5: 286.83
     rank  6: 273.12
     rank  7: 272.73
     rank  8: 46.51
     rank  9: 45.88
     rank 10: 52.96
     rank 11: 52.69
     rank 12: 5.34
     rank 13: 5.52
     rank 14: 5.47
     rank 15: 5.46
  backward-recv:
     rank  0: 2296.01
     rank  1: 2295.49
     rank  2: 2355.56
     rank  3: 2355.05
     rank  4: 1503.54
     rank  5: 1504.07
     rank  6: 1566.17
     rank  7: 1566.24
     rank  8: 741.27
     rank  9: 742.20
     rank 10: 799.65
     rank 11: 799.32
     rank 12: 277.88
     rank 13: 277.54
     rank 14: 318.35
     rank 15: 319.00
  backward-send:
     rank  4: 4.82
     rank  5: 3.29
     rank  6: 3.58
     rank  7: 2.86
     rank  8: 19.57
     rank  9: 19.05
     rank 10: 16.63
     rank 11: 16.53
     rank 12: 15.85
     rank 13: 16.40
     rank 14: 12.88
     rank 15: 12.16
     rank 16: 7.34
     rank 17: 7.36
     rank 18: 6.56
     rank 19: 7.34
  forward-send-backward-recv:
     rank  0: 2899.97
     rank  1: 2900.77
     rank  2: 2868.41
     rank  3: 2869.49
     rank  4: 2624.68
     rank  5: 2616.63
     rank  6: 2620.44
     rank  7: 2621.20
     rank  8: 1376.64
     rank  9: 1372.97
     rank 10: 1454.14
     rank 11: 1457.46
     rank 12: 410.32
     rank 13: 410.49
     rank 14: 430.32
     rank 15: 433.04
  backward-send-forward-recv:
     rank  4: 10.18
     rank  5: 9.70
     rank  6: 7.50
     rank  7: 7.31
     rank  8: 69.15
     rank  9: 63.04
     rank 10: 33.53
     rank 11: 33.96
     rank 12: 77.34
     rank 13: 71.44
     rank 14: 41.85
     rank 15: 45.00
     rank 16: 272.65
     rank 17: 274.22
     rank 18: 87.57
     rank 19: 89.79
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.04
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.04
     rank 15: 0.02
     rank 16: 0.03
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.10
     rank  5: 0.07
     rank  6: 0.13
     rank  7: 0.09
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
     rank 16: 0.08
     rank 17: 0.05
     rank 18: 0.05
     rank 19: 0.05
  all-grads-sync:
     rank  0: 166.24
     rank  1: 160.03
     rank  2: 166.37
     rank  3: 160.17
     rank  4: 148.26
     rank  5: 140.70
     rank  6: 148.13
     rank  7: 140.67
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.01
     rank 19: 0.01
  optimizer-copy-to-main-grad:
     rank  0: 0.15
     rank  1: 0.20
     rank  2: 0.15
     rank  3: 0.18
     rank  4: 0.10
     rank  5: 0.10
     rank  6: 0.16
     rank  7: 0.13
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.01
     rank 19: 0.01
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.02
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 20.27
     rank  1: 20.50
     rank  2: 20.28
     rank  3: 20.55
     rank  4: 14.19
     rank  5: 14.17
     rank  6: 14.42
     rank  7: 14.02
     rank  8: 0.08
     rank  9: 0.08
     rank 10: 0.08
     rank 11: 0.10
     rank 12: 0.04
     rank 13: 0.03
     rank 14: 0.07
     rank 15: 0.05
     rank 16: 0.09
     rank 17: 0.04
     rank 18: 0.07
     rank 19: 0.04
  optimizer:
     rank  0: 21.17
     rank  1: 21.42
     rank  2: 21.20
     rank  3: 21.48
     rank  4: 15.12
     rank  5: 15.09
     rank  6: 15.34
     rank  7: 14.93
     rank  8: 0.99
     rank  9: 0.99
     rank 10: 1.00
     rank 11: 1.01
     rank 12: 0.95
     rank 13: 0.94
     rank 14: 0.98
     rank 15: 0.95
     rank 16: 1.00
     rank 17: 0.95
     rank 18: 0.98
     rank 19: 0.96
 [2024-12-12 13:08:37] iteration        6/      10 | consumed samples:          192 | elapsed time per iteration (ms): 7242.4 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 2.936076E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 7192.40
     rank  1: 7192.52
     rank  2: 7192.37
     rank  3: 7192.49
     rank  4: 7191.85
     rank  5: 7191.93
     rank  6: 7191.76
     rank  7: 7191.89
     rank  8: 7190.53
     rank  9: 7190.68
     rank 10: 7190.58
     rank 11: 7190.67
     rank 12: 7190.47
     rank 13: 7190.62
     rank 14: 7190.52
     rank 15: 7190.59
     rank 16: 7190.43
     rank 17: 7190.46
     rank 18: 7190.42
     rank 19: 7190.43
  forward-compute:
     rank  0: 618.43
     rank  1: 620.82
     rank  2: 608.79
     rank  3: 607.62
     rank  4: 1184.67
     rank  5: 1185.70
     rank  6: 1153.21
     rank  7: 1150.76
     rank  8: 2072.60
     rank  9: 2079.87
     rank 10: 2017.89
     rank 11: 2017.34
     rank 12: 2382.87
     rank 13: 2390.30
     rank 14: 2376.19
     rank 15: 2375.87
     rank 16: 2309.54
     rank 17: 2309.13
     rank 18: 2533.05
     rank 19: 2532.53
  backward-compute:
     rank  0: 691.43
     rank  1: 691.48
     rank  2: 673.56
     rank  3: 672.72
     rank  4: 1232.30
     rank  5: 1240.61
     rank  6: 1198.16
     rank  7: 1196.56
     rank  8: 2208.62
     rank  9: 2211.04
     rank 10: 2168.84
     rank 11: 2167.38
     rank 12: 2826.60
     rank 13: 2827.04
     rank 14: 2814.30
     rank 15: 2813.15
     rank 16: 2733.87
     rank 17: 2733.19
     rank 18: 2706.84
     rank 19: 2707.30
  pure-backward-compute:
     rank  0: 690.97
     rank  1: 691.00
     rank  2: 673.08
     rank  3: 672.28
     rank  4: 1231.67
     rank  5: 1239.70
     rank  6: 1197.47
     rank  7: 1195.86
     rank  8: 2207.95
     rank  9: 2210.38
     rank 10: 2168.09
     rank 11: 2166.74
     rank 12: 2825.98
     rank 13: 2826.46
     rank 14: 2813.64
     rank 15: 2812.42
     rank 16: 2732.08
     rank 17: 2732.11
     rank 18: 2705.47
     rank 19: 2706.00
  batch-generator:
     rank  0: 43.01
     rank  1: 46.16
     rank  2: 37.83
     rank  3: 37.88
     rank  4: 36.60
     rank  5: 39.90
     rank  6: 43.29
     rank  7: 42.99
     rank  8: 37.71
     rank  9: 46.34
     rank 10: 43.55
     rank 11: 43.16
     rank 12: 31.63
     rank 13: 39.30
     rank 14: 34.34
     rank 15: 34.22
     rank 16: 34.90
     rank 17: 34.50
     rank 18: 26.52
     rank 19: 26.31
  forward-recv:
     rank  4: 81.00
     rank  5: 80.03
     rank  6: 78.90
     rank  7: 78.66
     rank  8: 254.12
     rank  9: 253.92
     rank 10: 240.11
     rank 11: 240.45
     rank 12: 508.93
     rank 13: 507.45
     rank 14: 490.72
     rank 15: 491.07
     rank 16: 807.62
     rank 17: 807.65
     rank 18: 787.07
     rank 19: 786.97
  forward-send:
     rank  0: 511.35
     rank  1: 509.02
     rank  2: 491.81
     rank  3: 492.92
     rank  4: 293.87
     rank  5: 292.12
     rank  6: 281.78
     rank  7: 282.94
     rank  8: 48.24
     rank  9: 47.03
     rank 10: 54.00
     rank 11: 54.00
     rank 12: 5.88
     rank 13: 5.74
     rank 14: 5.50
     rank 15: 5.33
  backward-recv:
     rank  0: 2306.73
     rank  1: 2306.16
     rank  2: 2356.32
     rank  3: 2357.86
     rank  4: 1504.12
     rank  5: 1503.75
     rank  6: 1572.80
     rank  7: 1573.97
     rank  8: 741.85
     rank  9: 742.71
     rank 10: 796.63
     rank 11: 799.80
     rank 12: 278.84
     rank 13: 278.83
     rank 14: 319.51
     rank 15: 319.88
  backward-send:
     rank  4: 4.58
     rank  5: 3.67
     rank  6: 3.22
     rank  7: 2.74
     rank  8: 20.38
     rank  9: 19.63
     rank 10: 16.08
     rank 11: 16.61
     rank 12: 16.24
     rank 13: 15.96
     rank 14: 11.87
     rank 15: 15.11
     rank 16: 7.15
     rank 17: 7.10
     rank 18: 6.68
     rank 19: 7.27
  forward-send-backward-recv:
     rank  0: 2892.16
     rank  1: 2892.29
     rank  2: 2872.23
     rank  3: 2873.02
     rank  4: 2624.59
     rank  5: 2614.52
     rank  6: 2623.60
     rank  7: 2623.28
     rank  8: 1363.93
     rank  9: 1360.88
     rank 10: 1443.91
     rank 11: 1442.41
     rank 12: 397.43
     rank 13: 397.12
     rank 14: 426.46
     rank 15: 426.86
  backward-send-forward-recv:
     rank  4: 9.33
     rank  5: 10.33
     rank  6: 7.61
     rank  7: 9.00
     rank  8: 69.99
     rank  9: 63.89
     rank 10: 33.56
     rank 11: 33.69
     rank 12: 77.24
     rank 13: 71.31
     rank 14: 43.57
     rank 15: 43.60
     rank 16: 276.69
     rank 17: 278.21
     rank 18: 97.79
     rank 19: 97.93
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.04
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.07
     rank  5: 0.07
     rank  6: 0.07
     rank  7: 0.08
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.06
     rank 17: 0.09
     rank 18: 0.05
     rank 19: 0.05
  all-grads-sync:
     rank  0: 163.94
     rank  1: 157.74
     rank  2: 164.06
     rank  3: 157.78
     rank  4: 147.99
     rank  5: 141.09
     rank  6: 148.09
     rank  7: 141.17
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.04
     rank 18: 0.01
     rank 19: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.16
     rank  1: 0.19
     rank  2: 0.15
     rank  3: 0.19
     rank  4: 0.13
     rank  5: 0.12
     rank  6: 0.14
     rank  7: 0.16
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.01
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 20.23
     rank  1: 20.44
     rank  2: 20.30
     rank  3: 20.35
     rank  4: 13.94
     rank  5: 14.20
     rank  6: 14.08
     rank  7: 14.23
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.04
     rank 15: 0.04
     rank 16: 0.07
     rank 17: 0.07
     rank 18: 0.04
     rank 19: 0.04
  optimizer:
     rank  0: 21.09
     rank  1: 21.30
     rank  2: 21.15
     rank  3: 21.19
     rank  4: 14.79
     rank  5: 15.05
     rank  6: 14.93
     rank  7: 15.08
     rank  8: 0.89
     rank  9: 0.89
     rank 10: 0.90
     rank 11: 0.90
     rank 12: 0.88
     rank 13: 0.87
     rank 14: 0.88
     rank 15: 0.88
     rank 16: 0.91
     rank 17: 0.91
     rank 18: 0.89
     rank 19: 0.88
 [2024-12-12 13:08:45] iteration        7/      10 | consumed samples:          224 | elapsed time per iteration (ms): 7242.8 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 1.832082E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 7184.43
     rank  1: 7184.32
     rank  2: 7184.39
     rank  3: 7184.37
     rank  4: 7183.85
     rank  5: 7184.68
     rank  6: 7183.79
     rank  7: 7184.96
     rank  8: 7182.68
     rank  9: 7182.92
     rank 10: 7182.61
     rank 11: 7183.00
     rank 12: 7182.52
     rank 13: 7182.87
     rank 14: 7182.51
     rank 15: 7182.92
     rank 16: 7182.54
     rank 17: 7182.39
     rank 18: 7182.47
     rank 19: 7182.40
  forward-compute:
     rank  0: 621.72
     rank  1: 623.82
     rank  2: 612.24
     rank  3: 611.90
     rank  4: 1181.71
     rank  5: 1184.03
     rank  6: 1166.18
     rank  7: 1166.69
     rank  8: 2077.78
     rank  9: 2084.42
     rank 10: 2033.39
     rank 11: 2032.00
     rank 12: 2383.29
     rank 13: 2389.09
     rank 14: 2369.69
     rank 15: 2369.66
     rank 16: 2304.74
     rank 17: 2303.38
     rank 18: 2492.48
     rank 19: 2490.86
  backward-compute:
     rank  0: 684.62
     rank  1: 685.21
     rank  2: 674.79
     rank  3: 673.44
     rank  4: 1235.16
     rank  5: 1245.46
     rank  6: 1205.43
     rank  7: 1204.60
     rank  8: 2214.83
     rank  9: 2217.08
     rank 10: 2179.46
     rank 11: 2180.31
     rank 12: 2824.77
     rank 13: 2824.70
     rank 14: 2811.98
     rank 15: 2809.60
     rank 16: 2732.72
     rank 17: 2732.34
     rank 18: 2710.87
     rank 19: 2711.74
  pure-backward-compute:
     rank  0: 684.16
     rank  1: 684.76
     rank  2: 674.38
     rank  3: 672.98
     rank  4: 1234.51
     rank  5: 1244.79
     rank  6: 1204.45
     rank  7: 1203.46
     rank  8: 2213.86
     rank  9: 2216.40
     rank 10: 2178.62
     rank 11: 2179.44
     rank 12: 2823.99
     rank 13: 2823.95
     rank 14: 2811.40
     rank 15: 2808.93
     rank 16: 2731.45
     rank 17: 2731.28
     rank 18: 2709.51
     rank 19: 2710.09
  batch-generator:
     rank  0: 42.91
     rank  1: 45.99
     rank  2: 38.70
     rank  3: 40.04
     rank  4: 36.71
     rank  5: 40.24
     rank  6: 48.86
     rank  7: 51.10
     rank  8: 37.27
     rank  9: 45.03
     rank 10: 46.94
     rank 11: 46.92
     rank 12: 31.15
     rank 13: 37.27
     rank 14: 29.82
     rank 15: 30.95
     rank 16: 29.09
     rank 17: 28.05
     rank 18: 27.60
     rank 19: 26.39
  forward-recv:
     rank  4: 81.06
     rank  5: 79.91
     rank  6: 79.68
     rank  7: 79.15
     rank  8: 253.26
     rank  9: 252.57
     rank 10: 247.11
     rank 11: 247.07
     rank 12: 505.63
     rank 13: 505.23
     rank 14: 497.48
     rank 15: 497.26
     rank 16: 805.83
     rank 17: 805.98
     rank 18: 793.34
     rank 19: 793.33
  forward-send:
     rank  0: 510.79
     rank  1: 508.41
     rank  2: 497.33
     rank  3: 497.43
     rank  4: 294.86
     rank  5: 293.64
     rank  6: 280.01
     rank  7: 279.92
     rank  8: 45.92
     rank  9: 45.58
     rank 10: 53.09
     rank 11: 53.16
     rank 12: 5.28
     rank 13: 5.46
     rank 14: 5.43
     rank 15: 5.46
  backward-recv:
     rank  0: 2304.49
     rank  1: 2303.87
     rank  2: 2341.05
     rank  3: 2342.42
     rank  4: 1498.01
     rank  5: 1497.88
     rank  6: 1561.13
     rank  7: 1561.93
     rank  8: 735.40
     rank  9: 737.39
     rank 10: 790.22
     rank 11: 789.36
     rank 12: 273.27
     rank 13: 273.07
     rank 14: 314.34
     rank 15: 314.40
  backward-send:
     rank  4: 4.60
     rank  5: 3.38
     rank  6: 2.99
     rank  7: 3.29
     rank  8: 19.85
     rank  9: 18.40
     rank 10: 16.47
     rank 11: 16.61
     rank 12: 16.07
     rank 13: 15.87
     rank 14: 12.03
     rank 15: 11.69
     rank 16: 7.35
     rank 17: 7.31
     rank 18: 6.93
     rank 19: 7.30
  forward-send-backward-recv:
     rank  0: 2885.24
     rank  1: 2885.14
     rank  2: 2865.79
     rank  3: 2866.14
     rank  4: 2617.09
     rank  5: 2608.37
     rank  6: 2602.44
     rank  7: 2602.99
     rank  8: 1349.78
     rank  9: 1346.82
     rank 10: 1401.00
     rank 11: 1400.80
     rank 12: 395.75
     rank 13: 395.88
     rank 14: 413.72
     rank 15: 414.84
  backward-send-forward-recv:
     rank  4: 10.34
     rank  5: 9.92
     rank  6: 7.11
     rank  7: 7.01
     rank  8: 71.01
     rank  9: 65.46
     rank 10: 35.24
     rank 11: 36.45
     rank 12: 79.50
     rank 13: 73.95
     rank 14: 49.11
     rank 15: 49.40
     rank 16: 272.69
     rank 17: 274.48
     rank 18: 115.79
     rank 19: 116.49
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.09
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.03
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.10
     rank  5: 0.07
     rank  6: 0.09
     rank  7: 0.24
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.08
     rank 17: 0.05
     rank 18: 0.05
     rank 19: 0.05
  all-grads-sync:
     rank  0: 167.46
     rank  1: 163.42
     rank  2: 167.59
     rank  3: 163.48
     rank  4: 146.48
     rank  5: 140.59
     rank  6: 146.57
     rank  7: 140.57
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.25
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.16
     rank  1: 0.17
     rank  2: 0.14
     rank  3: 0.18
     rank  4: 0.11
     rank  5: 0.10
     rank  6: 0.10
     rank  7: 0.22
     rank  8: 0.03
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.03
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.06
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 20.25
     rank  1: 20.27
     rank  2: 20.26
     rank  3: 20.49
     rank  4: 14.23
     rank  5: 14.08
     rank  6: 14.25
     rank  7: 15.50
     rank  8: 0.10
     rank  9: 0.04
     rank 10: 0.09
     rank 11: 0.09
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.04
     rank 16: 0.09
     rank 17: 0.04
     rank 18: 0.03
     rank 19: 0.03
  optimizer:
     rank  0: 21.47
     rank  1: 21.49
     rank  2: 21.48
     rank  3: 21.71
     rank  4: 15.44
     rank  5: 15.30
     rank  6: 15.47
     rank  7: 16.72
     rank  8: 1.31
     rank  9: 1.25
     rank 10: 1.34
     rank 11: 1.29
     rank 12: 1.24
     rank 13: 1.24
     rank 14: 1.24
     rank 15: 1.24
     rank 16: 1.30
     rank 17: 1.25
     rank 18: 1.24
     rank 19: 1.24
 [2024-12-12 13:08:52] iteration        8/      10 | consumed samples:          256 | elapsed time per iteration (ms): 7241.2 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 1.626605E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 7190.55
     rank  1: 7190.49
     rank  2: 7190.49
     rank  3: 7190.55
     rank  4: 7189.94
     rank  5: 7190.07
     rank  6: 7189.90
     rank  7: 7190.15
     rank  8: 7188.69
     rank  9: 7188.78
     rank 10: 7188.65
     rank 11: 7188.74
     rank 12: 7188.66
     rank 13: 7188.68
     rank 14: 7188.63
     rank 15: 7188.72
     rank 16: 7188.52
     rank 17: 7188.52
     rank 18: 7188.54
     rank 19: 7188.57
  forward-compute:
     rank  0: 623.13
     rank  1: 622.06
     rank  2: 613.04
     rank  3: 613.02
     rank  4: 1179.77
     rank  5: 1178.51
     rank  6: 1159.69
     rank  7: 1158.89
     rank  8: 2084.94
     rank  9: 2090.64
     rank 10: 2038.84
     rank 11: 2039.26
     rank 12: 2387.38
     rank 13: 2392.88
     rank 14: 2368.61
     rank 15: 2367.70
     rank 16: 2307.94
     rank 17: 2306.60
     rank 18: 2514.04
     rank 19: 2511.93
  backward-compute:
     rank  0: 682.50
     rank  1: 682.13
     rank  2: 675.89
     rank  3: 674.06
     rank  4: 1236.05
     rank  5: 1244.54
     rank  6: 1205.42
     rank  7: 1203.40
     rank  8: 2227.80
     rank  9: 2228.32
     rank 10: 2185.19
     rank 11: 2184.86
     rank 12: 2823.78
     rank 13: 2823.80
     rank 14: 2814.71
     rank 15: 2812.55
     rank 16: 2734.24
     rank 17: 2734.22
     rank 18: 2708.94
     rank 19: 2709.41
  pure-backward-compute:
     rank  0: 681.98
     rank  1: 681.69
     rank  2: 675.45
     rank  3: 673.62
     rank  4: 1235.42
     rank  5: 1243.72
     rank  6: 1204.76
     rank  7: 1202.30
     rank  8: 2227.08
     rank  9: 2227.58
     rank 10: 2184.42
     rank 11: 2184.07
     rank 12: 2823.19
     rank 13: 2823.14
     rank 14: 2814.06
     rank 15: 2811.87
     rank 16: 2732.82
     rank 17: 2733.10
     rank 18: 2707.64
     rank 19: 2707.99
  batch-generator:
     rank  0: 44.99
     rank  1: 44.71
     rank  2: 40.94
     rank  3: 42.38
     rank  4: 38.55
     rank  5: 39.18
     rank  6: 40.44
     rank  7: 41.95
     rank  8: 36.51
     rank  9: 43.70
     rank 10: 41.90
     rank 11: 42.50
     rank 12: 34.01
     rank 13: 38.41
     rank 14: 30.45
     rank 15: 30.52
     rank 16: 30.71
     rank 17: 29.80
     rank 18: 27.69
     rank 19: 26.03
  forward-recv:
     rank  4: 81.61
     rank  5: 81.07
     rank  6: 79.21
     rank  7: 78.77
     rank  8: 254.33
     rank  9: 254.48
     rank 10: 241.13
     rank 11: 240.98
     rank 12: 509.04
     rank 13: 508.76
     rank 14: 495.11
     rank 15: 495.14
     rank 16: 807.07
     rank 17: 807.28
     rank 18: 790.57
     rank 19: 791.73
  forward-send:
     rank  0: 507.82
     rank  1: 508.74
     rank  2: 495.40
     rank  3: 494.93
     rank  4: 294.44
     rank  5: 295.29
     rank  6: 280.31
     rank  7: 280.00
     rank  8: 45.07
     rank  9: 45.14
     rank 10: 50.59
     rank 11: 50.28
     rank 12: 5.22
     rank 13: 5.50
     rank 14: 5.65
     rank 15: 5.57
  backward-recv:
     rank  0: 2314.20
     rank  1: 2314.27
     rank  2: 2350.99
     rank  3: 2351.64
     rank  4: 1507.37
     rank  5: 1505.66
     rank  6: 1569.36
     rank  7: 1570.17
     rank  8: 737.42
     rank  9: 737.92
     rank 10: 792.70
     rank 11: 792.87
     rank 12: 276.76
     rank 13: 276.70
     rank 14: 317.17
     rank 15: 318.76
  backward-send:
     rank  4: 4.28
     rank  5: 4.76
     rank  6: 3.25
     rank  7: 2.96
     rank  8: 19.51
     rank  9: 19.09
     rank 10: 16.44
     rank 11: 16.57
     rank 12: 16.48
     rank 13: 16.30
     rank 14: 12.12
     rank 15: 12.54
     rank 16: 6.65
     rank 17: 6.60
     rank 18: 5.18
     rank 19: 6.72
  forward-send-backward-recv:
     rank  0: 2890.42
     rank  1: 2890.41
     rank  2: 2864.30
     rank  3: 2866.27
     rank  4: 2618.98
     rank  5: 2611.95
     rank  6: 2610.28
     rank  7: 2612.01
     rank  8: 1338.64
     rank  9: 1337.26
     rank 10: 1406.05
     rank 11: 1406.28
     rank 12: 395.93
     rank 13: 396.19
     rank 14: 425.86
     rank 15: 426.10
  backward-send-forward-recv:
     rank  4: 10.44
     rank  5: 10.28
     rank  6: 7.06
     rank  7: 7.58
     rank  8: 70.53
     rank  9: 64.74
     rank 10: 33.77
     rank 11: 34.04
     rank 12: 78.14
     rank 13: 72.60
     rank 14: 45.56
     rank 15: 46.32
     rank 16: 275.57
     rank 17: 277.37
     rank 18: 107.50
     rank 19: 107.85
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.04
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.08
     rank  5: 0.08
     rank  6: 0.07
     rank  7: 0.10
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.03
     rank 16: 0.05
     rank 17: 0.05
     rank 18: 0.05
     rank 19: 0.06
  all-grads-sync:
     rank  0: 164.15
     rank  1: 158.68
     rank  2: 164.27
     rank  3: 158.81
     rank  4: 147.64
     rank  5: 141.90
     rank  6: 147.71
     rank  7: 141.91
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.04
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.02
     rank 19: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.16
     rank  1: 0.19
     rank  2: 0.15
     rank  3: 0.20
     rank  4: 0.09
     rank  5: 0.15
     rank  6: 0.13
     rank  7: 0.19
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.02
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 20.28
     rank  1: 20.40
     rank  2: 20.03
     rank  3: 20.52
     rank  4: 14.03
     rank  5: 14.36
     rank  6: 14.12
     rank  7: 14.51
     rank  8: 0.04
     rank  9: 0.09
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.03
     rank 13: 0.07
     rank 14: 0.03
     rank 15: 0.06
     rank 16: 0.07
     rank 17: 0.03
     rank 18: 0.04
     rank 19: 0.07
  optimizer:
     rank  0: 21.19
     rank  1: 21.31
     rank  2: 20.93
     rank  3: 21.43
     rank  4: 14.94
     rank  5: 15.27
     rank  6: 15.03
     rank  7: 15.42
     rank  8: 0.94
     rank  9: 0.99
     rank 10: 0.95
     rank 11: 0.95
     rank 12: 0.93
     rank 13: 0.96
     rank 14: 0.93
     rank 15: 0.95
     rank 16: 0.96
     rank 17: 0.93
     rank 18: 0.93
     rank 19: 0.97
 [2024-12-12 13:08:59] iteration        9/      10 | consumed samples:          288 | elapsed time per iteration (ms): 7249.8 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 1.219160E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 7192.45
     rank  1: 7192.43
     rank  2: 7192.50
     rank  3: 7192.48
     rank  4: 7192.01
     rank  5: 7191.94
     rank  6: 7192.28
     rank  7: 7192.02
     rank  8: 7190.77
     rank  9: 7190.74
     rank 10: 7190.80
     rank 11: 7190.81
     rank 12: 7190.68
     rank 13: 7190.63
     rank 14: 7190.73
     rank 15: 7190.63
     rank 16: 7190.59
     rank 17: 7190.51
     rank 18: 7190.55
     rank 19: 7190.49
  forward-compute:
     rank  0: 622.71
     rank  1: 625.50
     rank  2: 610.00
     rank  3: 609.91
     rank  4: 1180.45
     rank  5: 1182.98
     rank  6: 1146.01
     rank  7: 1147.15
     rank  8: 2082.59
     rank  9: 2090.07
     rank 10: 2057.74
     rank 11: 2057.70
     rank 12: 2380.65
     rank 13: 2390.53
     rank 14: 2365.23
     rank 15: 2364.59
     rank 16: 2301.38
     rank 17: 2299.78
     rank 18: 2537.55
     rank 19: 2536.40
  backward-compute:
     rank  0: 686.74
     rank  1: 687.11
     rank  2: 672.41
     rank  3: 672.24
     rank  4: 1235.87
     rank  5: 1244.05
     rank  6: 1213.72
     rank  7: 1214.40
     rank  8: 2228.92
     rank  9: 2233.85
     rank 10: 2211.69
     rank 11: 2213.68
     rank 12: 2829.33
     rank 13: 2828.91
     rank 14: 2812.69
     rank 15: 2812.05
     rank 16: 2733.72
     rank 17: 2733.88
     rank 18: 2707.38
     rank 19: 2708.35
  pure-backward-compute:
     rank  0: 686.31
     rank  1: 686.59
     rank  2: 671.92
     rank  3: 671.78
     rank  4: 1235.26
     rank  5: 1243.28
     rank  6: 1212.75
     rank  7: 1213.51
     rank  8: 2228.18
     rank  9: 2233.20
     rank 10: 2211.00
     rank 11: 2212.96
     rank 12: 2828.51
     rank 13: 2828.29
     rank 14: 2811.95
     rank 15: 2811.30
     rank 16: 2732.35
     rank 17: 2732.67
     rank 18: 2705.93
     rank 19: 2706.87
  batch-generator:
     rank  0: 44.28
     rank  1: 48.15
     rank  2: 38.10
     rank  3: 39.61
     rank  4: 35.23
     rank  5: 40.82
     rank  6: 44.41
     rank  7: 44.81
     rank  8: 35.98
     rank  9: 45.06
     rank 10: 39.63
     rank 11: 39.41
     rank 12: 27.98
     rank 13: 38.08
     rank 14: 26.96
     rank 15: 27.74
     rank 16: 25.62
     rank 17: 24.78
     rank 18: 27.64
     rank 19: 27.05
  forward-recv:
     rank  4: 81.78
     rank  5: 80.28
     rank  6: 79.27
     rank  7: 78.94
     rank  8: 256.46
     rank  9: 255.64
     rank 10: 234.46
     rank 11: 234.74
     rank 12: 512.80
     rank 13: 511.58
     rank 14: 487.08
     rank 15: 487.12
     rank 16: 810.93
     rank 17: 811.13
     rank 18: 782.75
     rank 19: 782.69
  forward-send:
     rank  0: 513.42
     rank  1: 510.26
     rank  2: 488.27
     rank  3: 488.22
     rank  4: 298.55
     rank  5: 296.73
     rank  6: 288.65
     rank  7: 287.83
     rank  8: 47.81
     rank  9: 47.15
     rank 10: 52.89
     rank 11: 52.66
     rank 12: 5.34
     rank 13: 5.44
     rank 14: 5.45
     rank 15: 5.41
  backward-recv:
     rank  0: 2302.63
     rank  1: 2301.89
     rank  2: 2350.20
     rank  3: 2351.12
     rank  4: 1501.33
     rank  5: 1501.07
     rank  6: 1560.62
     rank  7: 1562.15
     rank  8: 736.42
     rank  9: 737.59
     rank 10: 783.63
     rank 11: 782.76
     rank 12: 278.56
     rank 13: 278.23
     rank 14: 319.32
     rank 15: 318.47
  backward-send:
     rank  4: 4.79
     rank  5: 3.36
     rank  6: 3.02
     rank  7: 3.18
     rank  8: 19.32
     rank  9: 17.81
     rank 10: 16.42
     rank 11: 16.70
     rank 12: 15.22
     rank 13: 15.46
     rank 14: 11.22
     rank 15: 10.89
     rank 16: 6.73
     rank 17: 6.71
     rank 18: 6.73
     rank 19: 5.79
  forward-send-backward-recv:
     rank  0: 2893.17
     rank  1: 2893.36
     rank  2: 2881.45
     rank  3: 2881.80
     rank  4: 2621.67
     rank  5: 2614.72
     rank  6: 2617.99
     rank  7: 2617.17
     rank  8: 1337.91
     rank  9: 1332.55
     rank 10: 1375.35
     rank 11: 1374.32
     rank 12: 394.63
     rank 13: 394.82
     rank 14: 438.13
     rank 15: 439.01
  backward-send-forward-recv:
     rank  4: 10.03
     rank  5: 10.40
     rank  6: 7.46
     rank  7: 6.88
     rank  8: 69.69
     rank  9: 63.64
     rank 10: 33.60
     rank 11: 33.93
     rank 12: 77.28
     rank 13: 68.56
     rank 14: 43.98
     rank 15: 44.51
     rank 16: 280.08
     rank 17: 281.83
     rank 18: 94.19
     rank 19: 94.59
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.04
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.03
     rank 17: 0.02
     rank 18: 0.03
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.07
     rank  5: 0.07
     rank  6: 0.14
     rank  7: 0.09
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.06
     rank 17: 0.05
     rank 18: 0.07
     rank 19: 0.05
  all-grads-sync:
     rank  0: 165.70
     rank  1: 160.20
     rank  2: 165.82
     rank  3: 160.23
     rank  4: 147.24
     rank  5: 139.24
     rank  6: 147.29
     rank  7: 139.25
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.01
  optimizer-copy-to-main-grad:
     rank  0: 0.16
     rank  1: 0.18
     rank  2: 0.15
     rank  3: 0.18
     rank  4: 0.09
     rank  5: 0.10
     rank  6: 0.22
     rank  7: 0.11
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.05
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 20.31
     rank  1: 20.40
     rank  2: 20.29
     rank  3: 20.39
     rank  4: 13.87
     rank  5: 14.24
     rank  6: 15.28
     rank  7: 14.20
     rank  8: 0.11
     rank  9: 0.09
     rank 10: 0.06
     rank 11: 0.10
     rank 12: 0.07
     rank 13: 0.04
     rank 14: 0.03
     rank 15: 0.05
     rank 16: 0.08
     rank 17: 0.03
     rank 18: 0.04
     rank 19: 0.04
  optimizer:
     rank  0: 21.32
     rank  1: 21.41
     rank  2: 21.30
     rank  3: 21.40
     rank  4: 14.88
     rank  5: 15.25
     rank  6: 16.28
     rank  7: 15.21
     rank  8: 1.11
     rank  9: 1.10
     rank 10: 1.06
     rank 11: 1.10
     rank 12: 1.07
     rank 13: 1.04
     rank 14: 1.03
     rank 15: 1.05
     rank 16: 1.08
     rank 17: 1.03
     rank 18: 1.04
     rank 19: 1.04
 [2024-12-12 13:09:06] iteration       10/      10 | consumed samples:          320 | elapsed time per iteration (ms): 7244.6 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 1.170855E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 7188.30
     rank  1: 7188.29
     rank  2: 7188.26
     rank  3: 7188.29
     rank  4: 7187.69
     rank  5: 7187.89
     rank  6: 7187.68
     rank  7: 7187.99
     rank  8: 7186.46
     rank  9: 7186.56
     rank 10: 7186.44
     rank 11: 7186.58
     rank 12: 7186.36
     rank 13: 7186.46
     rank 14: 7186.43
     rank 15: 7186.51
     rank 16: 7186.49
     rank 17: 7186.37
     rank 18: 7186.42
     rank 19: 7186.34
  forward-compute:
     rank  0: 621.19
     rank  1: 623.11
     rank  2: 609.84
     rank  3: 609.50
     rank  4: 1178.75
     rank  5: 1180.92
     rank  6: 1176.89
     rank  7: 1175.56
     rank  8: 2092.05
     rank  9: 2099.10
     rank 10: 2057.36
     rank 11: 2058.22
     rank 12: 2381.74
     rank 13: 2386.89
     rank 14: 2372.21
     rank 15: 2370.61
     rank 16: 2307.95
     rank 17: 2306.61
     rank 18: 2499.44
     rank 19: 2498.16
  backward-compute:
     rank  0: 689.88
     rank  1: 690.01
     rank  2: 673.45
     rank  3: 671.22
     rank  4: 1238.42
     rank  5: 1247.49
     rank  6: 1208.39
     rank  7: 1205.09
     rank  8: 2232.81
     rank  9: 2233.48
     rank 10: 2192.15
     rank 11: 2192.40
     rank 12: 2823.51
     rank 13: 2823.43
     rank 14: 2816.01
     rank 15: 2813.30
     rank 16: 2733.35
     rank 17: 2732.92
     rank 18: 2711.16
     rank 19: 2711.88
  pure-backward-compute:
     rank  0: 689.39
     rank  1: 689.57
     rank  2: 672.96
     rank  3: 670.80
     rank  4: 1237.85
     rank  5: 1246.81
     rank  6: 1207.62
     rank  7: 1203.52
     rank  8: 2232.13
     rank  9: 2232.79
     rank 10: 2191.47
     rank 11: 2191.73
     rank 12: 2822.88
     rank 13: 2822.80
     rank 14: 2815.39
     rank 15: 2812.70
     rank 16: 2732.12
     rank 17: 2731.65
     rank 18: 2710.06
     rank 19: 2710.65
  batch-generator:
     rank  0: 43.55
     rank  1: 46.43
     rank  2: 37.61
     rank  3: 38.74
     rank  4: 34.42
     rank  5: 38.02
     rank  6: 50.27
     rank  7: 52.05
     rank  8: 35.11
     rank  9: 43.72
     rank 10: 43.92
     rank 11: 44.65
     rank 12: 28.12
     rank 13: 33.63
     rank 14: 31.74
     rank 15: 31.57
     rank 16: 30.52
     rank 17: 30.00
     rank 18: 29.44
     rank 19: 28.72
  forward-recv:
     rank  4: 80.97
     rank  5: 79.11
     rank  6: 80.25
     rank  7: 80.36
     rank  8: 251.07
     rank  9: 250.57
     rank 10: 245.84
     rank 11: 245.85
     rank 12: 507.44
     rank 13: 506.69
     rank 14: 500.26
     rank 15: 500.32
     rank 16: 806.90
     rank 17: 806.99
     rank 18: 796.57
     rank 19: 796.32
  forward-send:
     rank  0: 510.71
     rank  1: 508.74
     rank  2: 500.56
     rank  3: 501.00
     rank  4: 301.73
     rank  5: 300.76
     rank  6: 287.17
     rank  7: 286.42
     rank  8: 45.77
     rank  9: 45.41
     rank 10: 47.64
     rank 11: 47.14
     rank 12: 5.40
     rank 13: 5.52
     rank 14: 5.51
     rank 15: 5.32
  backward-recv:
     rank  0: 2306.12
     rank  1: 2305.85
     rank  2: 2341.70
     rank  3: 2342.82
     rank  4: 1502.78
     rank  5: 1502.81
     rank  6: 1557.01
     rank  7: 1558.00
     rank  8: 734.81
     rank  9: 735.89
     rank 10: 790.01
     rank 11: 789.75
     rank 12: 277.10
     rank 13: 277.04
     rank 14: 318.15
     rank 15: 319.07
  backward-send:
     rank  4: 4.70
     rank  5: 3.72
     rank  6: 3.04
     rank  7: 3.20
     rank  8: 19.58
     rank  9: 18.88
     rank 10: 16.61
     rank 11: 16.53
     rank 12: 15.55
     rank 13: 15.47
     rank 14: 11.29
     rank 15: 10.77
     rank 16: 6.85
     rank 17: 6.91
     rank 18: 6.06
     rank 19: 7.01
  forward-send-backward-recv:
     rank  0: 2885.79
     rank  1: 2885.72
     rank  2: 2867.75
     rank  3: 2869.51
     rank  4: 2612.34
     rank  5: 2604.39
     rank  6: 2588.49
     rank  7: 2591.17
     rank  8: 1325.92
     rank  9: 1324.14
     rank 10: 1376.00
     rank 11: 1375.75
     rank 12: 395.68
     rank 13: 395.75
     rank 14: 408.79
     rank 15: 410.26
  backward-send-forward-recv:
     rank  4: 10.27
     rank  5: 10.27
     rank  6: 6.96
     rank  7: 7.52
     rank  8: 71.18
     rank  9: 65.03
     rank 10: 33.56
     rank 11: 33.57
     rank 12: 78.82
     rank 13: 74.42
     rank 14: 45.21
     rank 15: 46.89
     rank 16: 271.51
     rank 17: 273.01
     rank 18: 108.49
     rank 19: 109.37
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.04
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.04
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.06
     rank  5: 0.06
     rank  6: 0.06
     rank  7: 0.12
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.06
     rank 17: 0.05
     rank 18: 0.06
     rank 19: 0.05
  all-grads-sync:
     rank  0: 166.10
     rank  1: 160.40
     rank  2: 166.23
     rank  3: 160.51
     rank  4: 147.84
     rank  5: 140.82
     rank  6: 147.93
     rank  7: 140.84
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.01
  optimizer-copy-to-main-grad:
     rank  0: 0.16
     rank  1: 0.19
     rank  2: 0.15
     rank  3: 0.18
     rank  4: 0.09
     rank  5: 0.10
     rank  6: 0.08
     rank  7: 0.19
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 20.23
     rank  1: 20.36
     rank  2: 20.22
     rank  3: 20.39
     rank  4: 13.91
     rank  5: 14.12
     rank  6: 14.04
     rank  7: 14.24
     rank  8: 0.04
     rank  9: 0.09
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.03
     rank 13: 0.04
     rank 14: 0.07
     rank 15: 0.04
     rank 16: 0.04
     rank 17: 0.04
     rank 18: 0.07
     rank 19: 0.03
  optimizer:
     rank  0: 21.16
     rank  1: 21.26
     rank  2: 21.14
     rank  3: 21.32
     rank  4: 14.84
     rank  5: 15.05
     rank  6: 14.97
     rank  7: 15.17
     rank  8: 0.96
     rank  9: 1.01
     rank 10: 0.96
     rank 11: 0.96
     rank 12: 0.95
     rank 13: 0.95
     rank 14: 0.98
     rank 15: 0.95
     rank 16: 0.95
     rank 17: 0.95
     rank 18: 0.99
     rank 19: 0.95
