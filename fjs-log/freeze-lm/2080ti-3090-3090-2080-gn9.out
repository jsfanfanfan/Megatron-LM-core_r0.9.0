examples/multimodal/pretrain-freeze-llm-hete-2080tifirst.sh: line 4: activate: No such file or directory
3
[2024-12-24 21:46:51,526] torch.distributed.run: [WARNING] 
[2024-12-24 21:46:51,526] torch.distributed.run: [WARNING] *****************************************
[2024-12-24 21:46:51,526] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-12-24 21:46:51,526] torch.distributed.run: [WARNING] *****************************************
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
> setting tensorboard ...
WARNING: one_logger package is required to enable e2e metrics tracking. please go to https://confluence.nvidia.com/display/MLWFO/Package+Repositories for details to install it
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
---Rank 14---Tensor Parallel Group GPUs: [0]
---Rank 15---Tensor Parallel Group GPUs: [0]
---Rank 14---Pipeline Parallel Group GPUs: [3, 3, 3, 3]---Rank 12---Tensor Parallel Group GPUs: [0]
---Rank 13---Tensor Parallel Group GPUs: [0]
---Rank 15---Pipeline Parallel Group GPUs: [3, 3, 3, 3]

---Rank 12---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
---Rank 13---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
[rank14]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank15]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank13]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank12]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
 > number of parameters on (tensor, pipeline) model parallel rank (0, 3): 352333824
rank=2, worker=0: shard_range=[pretrain-31.tar[0, 100), pretrain-31.tar[100, 200), pretrain-31.tar[200, 300), ...<619>, pretrain-37.tar[2200, 2300), pretrain-37.tar[2300, 2400), pretrain-37.tar[2400, 2500)] sum(count)=62500
rank=2, worker=1: shard_range=[pretrain-37.tar[2500, 2600), pretrain-37.tar[2600, 2700), pretrain-37.tar[2700, 2800), ...<619>, pretrain-42.tar[4700, 4800), pretrain-42.tar[4800, 4900), pretrain-42.tar[4900, 5000)] sum(count)=62500
rank=1, worker=0: shard_range=[pretrain-2.tar[5000, 5100), pretrain-2.tar[5100, 5200), pretrain-2.tar[5200, 5300), ...<619>, pretrain-25.tar[7200, 7300), pretrain-25.tar[7300, 7400), pretrain-25.tar[7400, 7500)] sum(count)=62500
rank=1, worker=1: shard_range=[pretrain-25.tar[7500, 7600), pretrain-25.tar[7600, 7700), pretrain-25.tar[7700, 7800), ...<619>, pretrain-30.tar[9700, 9800), pretrain-30.tar[9800, 9900), pretrain-30.tar[9900, 10000)] sum(count)=62500
rank=0, worker=0: shard_range=[pretrain-0.tar[0, 100), pretrain-0.tar[100, 200), pretrain-0.tar[200, 300), ...<619>, pretrain-14.tar[2200, 2300), pretrain-14.tar[2300, 2400), pretrain-14.tar[2400, 2500)] sum(count)=62500
rank=0, worker=1: shard_range=[pretrain-14.tar[2500, 2600), pretrain-14.tar[2600, 2700), pretrain-14.tar[2700, 2800), ...<619>, pretrain-2.tar[4700, 4800), pretrain-2.tar[4800, 4900), pretrain-2.tar[4900, 5000)] sum(count)=62500
rank=3, worker=0: shard_range=[pretrain-42.tar[5000, 5100), pretrain-42.tar[5100, 5200), pretrain-42.tar[5200, 5300), ...<619>, pretrain-48.tar[7200, 7300), pretrain-48.tar[7300, 7400), pretrain-48.tar[7400, 7500)] sum(count)=62500
rank=3, worker=1: shard_range=[pretrain-48.tar[7500, 7600), pretrain-48.tar[7600, 7700), pretrain-48.tar[7700, 7800), ...<619>, pretrain-53.tar[9700, 9800), pretrain-53.tar[9800, 9900), pretrain-53.tar[9900, 10000)] sum(count)=62500
rank=2, worker=0: shard_range=[pretrain-7.tar[936, 8202)] sum(count)=7266
rank=2, worker=1: shard_range=[pretrain-7.tar[8202, 10000), pretrain-8.tar[0, 5468)] sum(count)=7266
rank=3, worker=0: shard_range=[pretrain-8.tar[5468, 10000), pretrain-9.tar[0, 2734)] sum(count)=7266
rank=3, worker=1: shard_range=[pretrain-9.tar[2734, 10000)] sum(count)=7266
rank=1, worker=0: shard_range=[pretrain-55.tar[4532, 8128), pretrain-6.tar[0, 3670)] sum(count)=7266
rank=1, worker=1: shard_range=[pretrain-6.tar[3670, 10000), pretrain-7.tar[0, 936)] sum(count)=7266
rank=0, worker=0: shard_range=[pretrain-54.tar[0, 7266)] sum(count)=7266
rank=0, worker=1: shard_range=[pretrain-54.tar[7266, 10000), pretrain-55.tar[0, 4532)] sum(count)=7266
times across ranks (ms):
  model-and-optimizer-setup:
     rank  0: 56.35
     rank  1: 58.97
     rank  2: 55.85
     rank  3: 55.47
     rank  4: 119.61
     rank  5: 128.49
     rank  6: 122.97
     rank  7: 124.74
     rank  8: 37.65
     rank  9: 29.43
     rank 10: 30.68
     rank 11: 36.22
     rank 12: 42.44
     rank 13: 42.42
     rank 14: 41.31
     rank 15: 41.34
  train/valid/test-data-iterators-setup:
     rank  0: 1308.98
     rank  1: 1536.83
     rank  2: 1536.51
     rank  3: 1536.58
     rank  4: 1536.52
     rank  5: 1536.36
     rank  6: 1536.43
     rank  7: 1536.45
     rank  8: 1536.13
     rank  9: 1536.25
     rank 10: 1536.47
     rank 11: 1536.48
     rank 12: 1536.53
     rank 13: 1536.54
     rank 14: 1536.59
     rank 15: 1536.54
 [2024-12-24 21:47:26] iteration        1/      10 | consumed samples:           16 | elapsed time per iteration (ms): 11942.2 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 7.276277E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
stage4 GPU utialization:17.53645810213956 %
[Rank 12] (after 1 iterations) memory (MB) | allocated: 1397.2998046875 | max allocated: 1975.306640625 | reserved: 2142.0 | max reserved: 2142.0
times across ranks (ms):
  forward-backward:
     rank  0: 11768.81
     rank  1: 11768.41
     rank  2: 11768.48
     rank  3: 11768.08
     rank  4: 11764.59
     rank  5: 11764.67
     rank  6: 11764.60
     rank  7: 11764.59
     rank  8: 11888.16
     rank  9: 11888.05
     rank 10: 11887.96
     rank 11: 11887.95
     rank 12: 11762.51
     rank 13: 11762.53
     rank 14: 11762.45
     rank 15: 11762.41
  forward-compute:
     rank  0: 2523.05
     rank  1: 2726.16
     rank  2: 2423.77
     rank  3: 2664.30
     rank  4: 3280.72
     rank  5: 3355.06
     rank  6: 3148.94
     rank  7: 3014.59
     rank  8: 2179.10
     rank  9: 2408.36
     rank 10: 2437.08
     rank 11: 2434.64
     rank 12: 1935.22
     rank 13: 1444.68
     rank 14: 1903.22
     rank 15: 1834.02
  backward-compute:
     rank  0: 1262.50
     rank  1: 1226.23
     rank  2: 1104.65
     rank  3: 1144.99
     rank  4: 1013.86
     rank  5: 1046.26
     rank  6: 1039.76
     rank  7: 1015.12
     rank  8: 461.68
     rank  9: 465.46
     rank 10: 463.83
     rank 11: 463.06
     rank 12: 322.58
     rank 13: 326.82
     rank 14: 323.56
     rank 15: 331.38
  pure-backward-compute:
     rank  0: 1262.00
     rank  1: 1225.78
     rank  2: 1104.27
     rank  3: 1144.36
     rank  4: 1013.48
     rank  5: 1045.86
     rank  6: 1039.40
     rank  7: 1014.68
     rank  8: 461.24
     rank  9: 464.76
     rank 10: 463.42
     rank 11: 462.69
     rank 12: 321.99
     rank 13: 326.01
     rank 14: 322.86
     rank 15: 330.68
  batch-generator:
     rank  0: 1185.46
     rank  1: 1219.42
     rank  2: 1149.51
     rank  3: 1201.98
     rank  4: 924.20
     rank  5: 989.99
     rank  6: 990.98
     rank  7: 909.66
     rank  8: 974.20
     rank  9: 914.06
     rank 10: 965.44
     rank 11: 979.33
     rank 12: 1005.21
     rank 13: 917.09
     rank 14: 1019.76
     rank 15: 1006.30
  forward-recv:
     rank  4: 2558.51
     rank  5: 2733.44
     rank  6: 2433.90
     rank  7: 2670.56
     rank  8: 5499.56
     rank  9: 5736.96
     rank 10: 5254.16
     rank 11: 5354.43
     rank 12: 7403.14
     rank 13: 7862.54
     rank 14: 7412.65
     rank 15: 7507.13
  forward-send:
     rank  0: 4930.17
     rank  1: 5199.58
     rank  2: 5036.41
     rank  3: 4902.43
     rank  4: 1801.84
     rank  5: 2024.14
     rank  6: 2064.24
     rank  7: 2057.06
     rank  8: 23.84
     rank  9: 19.71
     rank 10: 20.29
     rank 11: 16.99
  backward-recv:
     rank  0: 172.13
     rank  1: 175.70
     rank  2: 173.99
     rank  3: 169.36
     rank  4: 3.26
     rank  5: 3.29
     rank  6: 3.12
     rank  7: 3.22
     rank  8: 1.82
     rank  9: 1.85
     rank 10: 1.78
     rank 11: 1.75
  backward-send:
     rank  4: 887.64
     rank  5: 845.07
     rank  6: 738.93
     rank  7: 769.68
     rank  8: 815.42
     rank  9: 771.68
     rank 10: 665.31
     rank 11: 697.45
     rank 12: 727.23
     rank 13: 722.75
     rank 14: 599.79
     rank 15: 604.74
  forward-send-backward-recv:
     rank  0: 2476.76
     rank  1: 2030.46
     rank  2: 2497.48
     rank  3: 2364.39
     rank  4: 1770.80
     rank  5: 1303.71
     rank  6: 1759.60
     rank  7: 1665.93
     rank  8: 1660.90
     rank  9: 1198.58
     rank 10: 1652.93
     rank 11: 1558.17
  backward-send-forward-recv:
     rank  4: 14.59
     rank  5: 13.88
     rank  6: 13.52
     rank  7: 13.81
     rank  8: 559.53
     rank  9: 593.32
     rank 10: 577.88
     rank 11: 554.22
     rank 12: 686.05
     rank 13: 712.52
     rank 14: 706.13
     rank 15: 675.34
  layernorm-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.05
     rank  3: 0.06
     rank  4: 0.02
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.16
     rank  9: 0.06
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.03
     rank 13: 0.04
     rank 14: 0.05
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.04
     rank  4: 0.07
     rank  5: 0.09
     rank  6: 0.07
     rank  7: 0.07
     rank  8: 0.09
     rank  9: 0.04
     rank 10: 0.03
     rank 11: 0.04
     rank 12: 0.08
     rank 13: 0.08
     rank 14: 0.09
     rank 15: 0.07
  all-grads-sync:
     rank  0: 390.69
     rank  1: 390.79
     rank  2: 390.85
     rank  3: 390.81
     rank  4: 313.59
     rank  5: 313.56
     rank  6: 313.56
     rank  7: 313.54
     rank  8: 0.07
     rank  9: 0.04
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.17
     rank  1: 0.17
     rank  2: 0.21
     rank  3: 0.25
     rank  4: 0.13
     rank  5: 0.16
     rank  6: 0.13
     rank  7: 0.13
     rank  8: 0.05
     rank  9: 0.04
     rank 10: 0.03
     rank 11: 0.04
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.04
     rank  9: 0.03
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 49.26
     rank  1: 49.52
     rank  2: 49.48
     rank  3: 42.68
     rank  4: 27.46
     rank  5: 27.93
     rank  6: 27.51
     rank  7: 27.46
     rank  8: 0.28
     rank  9: 0.19
     rank 10: 0.15
     rank 11: 0.14
     rank 12: 0.10
     rank 13: 0.10
     rank 14: 0.11
     rank 15: 0.11
  optimizer:
     rank  0: 50.71
     rank  1: 50.97
     rank  2: 50.94
     rank  3: 44.13
     rank  4: 28.89
     rank  5: 29.36
     rank  6: 28.96
     rank  7: 28.90
     rank  8: 1.67
     rank  9: 1.58
     rank 10: 1.61
     rank 11: 1.60
     rank 12: 1.55
     rank 13: 1.55
     rank 14: 1.55
     rank 15: 1.55
 [2024-12-24 21:47:27] iteration        2/      10 | consumed samples:           32 | elapsed time per iteration (ms): 1635.4 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 7.305055E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 1576.63
     rank  1: 1576.63
     rank  2: 1576.65
     rank  3: 1576.74
     rank  4: 1577.04
     rank  5: 1577.12
     rank  6: 1577.05
     rank  7: 1577.04
     rank  8: 1574.97
     rank  9: 1575.09
     rank 10: 1574.96
     rank 11: 1574.95
     rank 12: 1574.79
     rank 13: 1574.72
     rank 14: 1574.73
     rank 15: 1574.73
  forward-compute:
     rank  0: 176.23
     rank  1: 157.77
     rank  2: 180.89
     rank  3: 192.55
     rank  4: 443.18
     rank  5: 507.52
     rank  6: 441.90
     rank  7: 440.89
     rank  8: 385.41
     rank  9: 393.09
     rank 10: 385.19
     rank 11: 383.76
     rank 12: 357.72
     rank 13: 310.72
     rank 14: 363.97
     rank 15: 353.77
  backward-compute:
     rank  0: 140.18
     rank  1: 146.89
     rank  2: 161.27
     rank  3: 142.08
     rank  4: 513.21
     rank  5: 510.64
     rank  6: 512.57
     rank  7: 512.75
     rank  8: 462.63
     rank  9: 464.28
     rank 10: 465.75
     rank 11: 463.24
     rank 12: 314.26
     rank 13: 315.01
     rank 14: 312.18
     rank 15: 316.13
  pure-backward-compute:
     rank  0: 139.97
     rank  1: 146.67
     rank  2: 161.07
     rank  3: 141.74
     rank  4: 513.00
     rank  5: 510.30
     rank  6: 512.34
     rank  7: 512.55
     rank  8: 462.25
     rank  9: 463.71
     rank 10: 465.38
     rank 11: 462.89
     rank 12: 313.62
     rank 13: 314.30
     rank 14: 311.54
     rank 15: 315.39
  batch-generator:
     rank  0: 16.45
     rank  1: 16.79
     rank  2: 17.14
     rank  3: 19.03
     rank  4: 11.55
     rank  5: 15.91
     rank  6: 11.53
     rank  7: 11.28
     rank  8: 15.89
     rank  9: 18.52
     rank 10: 13.54
     rank 11: 12.80
     rank 12: 18.19
     rank 13: 14.13
     rank 14: 16.41
     rank 15: 15.14
  forward-recv:
     rank  4: 39.10
     rank  5: 39.35
     rank  6: 40.42
     rank  7: 42.98
     rank  8: 161.33
     rank  9: 196.41
     rank 10: 162.85
     rank 11: 165.63
     rank 12: 249.57
     rank 13: 286.88
     rank 14: 248.23
     rank 15: 250.25
  forward-send:
     rank  0: 133.15
     rank  1: 188.97
     rank  2: 126.21
     rank  3: 119.49
     rank  4: 3.59
     rank  5: 3.50
     rank  6: 3.74
     rank  7: 3.02
     rank  8: 3.52
     rank  9: 2.96
     rank 10: 2.61
     rank 11: 2.85
  backward-recv:
     rank  0: 528.41
     rank  1: 520.72
     rank  2: 504.80
     rank  3: 524.21
     rank  4: 131.55
     rank  5: 124.69
     rank  6: 128.20
     rank  7: 131.54
     rank  8: 47.27
     rank  9: 42.95
     rank 10: 44.21
     rank 11: 47.49
  backward-send:
     rank  4: 1.01
     rank  5: 1.41
     rank  6: 1.29
     rank  7: 1.06
     rank  8: 7.50
     rank  9: 5.44
     rank 10: 5.09
     rank 11: 7.50
     rank 12: 4.53
     rank 13: 4.49
     rank 14: 2.69
     rank 15: 4.47
  forward-send-backward-recv:
     rank  0: 389.72
     rank  1: 352.97
     rank  2: 390.36
     rank  3: 388.01
     rank  4: 199.94
     rank  5: 142.57
     rank  6: 198.05
     rank  7: 198.90
     rank  8: 105.03
     rank  9: 62.58
     rank 10: 103.34
     rank 11: 104.58
  backward-send-forward-recv:
     rank  4: 0.69
     rank  5: 0.87
     rank  6: 0.57
     rank  7: 0.58
     rank  8: 30.34
     rank  9: 35.10
     rank 10: 30.35
     rank 11: 28.68
     rank 12: 157.60
     rank 13: 166.74
     rank 14: 154.31
     rank 15: 159.77
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.04
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.04
     rank  9: 0.14
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.05
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.05
     rank  5: 0.13
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.03
     rank  9: 0.05
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.09
     rank 13: 0.06
     rank 14: 0.06
     rank 15: 0.06
  all-grads-sync:
     rank  0: 203.30
     rank  1: 203.36
     rank  2: 203.44
     rank  3: 203.34
     rank  4: 193.14
     rank  5: 193.11
     rank  6: 193.17
     rank  7: 193.18
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.10
     rank  1: 0.11
     rank  2: 0.11
     rank  3: 0.11
     rank  4: 0.09
     rank  5: 0.19
     rank  6: 0.10
     rank  7: 0.09
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 20.45
     rank  1: 20.44
     rank  2: 20.57
     rank  3: 20.61
     rank  4: 24.95
     rank  5: 25.17
     rank  6: 24.90
     rank  7: 24.90
     rank  8: 0.05
     rank  9: 0.12
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.07
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.04
  optimizer:
     rank  0: 21.44
     rank  1: 21.43
     rank  2: 21.55
     rank  3: 21.59
     rank  4: 25.94
     rank  5: 26.13
     rank  6: 25.88
     rank  7: 25.88
     rank  8: 1.02
     rank  9: 1.10
     rank 10: 1.03
     rank 11: 1.02
     rank 12: 1.06
     rank 13: 1.03
     rank 14: 1.02
     rank 15: 1.02
 [2024-12-24 21:47:29] iteration        3/      10 | consumed samples:           48 | elapsed time per iteration (ms): 1611.5 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 6.966550E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 1558.34
     rank  1: 1558.26
     rank  2: 1558.25
     rank  3: 1558.25
     rank  4: 1558.65
     rank  5: 1558.61
     rank  6: 1558.61
     rank  7: 1558.63
     rank  8: 1556.54
     rank  9: 1556.55
     rank 10: 1556.47
     rank 11: 1556.48
     rank 12: 1556.41
     rank 13: 1556.41
     rank 14: 1556.40
     rank 15: 1556.40
  forward-compute:
     rank  0: 147.29
     rank  1: 148.82
     rank  2: 153.21
     rank  3: 143.63
     rank  4: 443.98
     rank  5: 470.37
     rank  6: 443.44
     rank  7: 444.61
     rank  8: 385.07
     rank  9: 387.40
     rank 10: 388.10
     rank 11: 384.09
     rank 12: 331.14
     rank 13: 314.94
     rank 14: 341.12
     rank 15: 337.19
  backward-compute:
     rank  0: 137.91
     rank  1: 141.19
     rank  2: 149.49
     rank  3: 151.12
     rank  4: 514.33
     rank  5: 512.47
     rank  6: 511.93
     rank  7: 513.35
     rank  8: 463.12
     rank  9: 464.63
     rank 10: 466.78
     rank 11: 463.20
     rank 12: 314.93
     rank 13: 315.53
     rank 14: 312.14
     rank 15: 316.10
  pure-backward-compute:
     rank  0: 137.71
     rank  1: 140.99
     rank  2: 149.27
     rank  3: 150.92
     rank  4: 514.13
     rank  5: 512.18
     rank  6: 511.75
     rank  7: 513.13
     rank  8: 462.64
     rank  9: 464.11
     rank 10: 466.44
     rank 11: 462.85
     rank 12: 314.16
     rank 13: 314.84
     rank 14: 311.50
     rank 15: 315.40
  batch-generator:
     rank  0: 15.05
     rank  1: 16.27
     rank  2: 18.26
     rank  3: 15.31
     rank  4: 11.24
     rank  5: 15.48
     rank  6: 11.74
     rank  7: 11.31
     rank  8: 14.12
     rank  9: 15.13
     rank 10: 13.37
     rank 11: 13.32
     rank 12: 14.51
     rank 13: 14.85
     rank 14: 18.62
     rank 15: 17.39
  forward-recv:
     rank  4: 37.12
     rank  5: 37.91
     rank  6: 38.41
     rank  7: 35.20
     rank  8: 162.97
     rank  9: 180.18
     rank 10: 165.81
     rank 11: 162.77
     rank 12: 245.56
     rank 13: 261.56
     rank 14: 247.16
     rank 15: 242.75
  forward-send:
     rank  0: 151.68
     rank  1: 170.87
     rank  2: 149.31
     rank  3: 154.00
     rank  4: 3.54
     rank  5: 3.28
     rank  6: 3.23
     rank  7: 3.43
     rank  8: 2.63
     rank  9: 2.80
     rank 10: 1.56
     rank 11: 1.88
  backward-recv:
     rank  0: 528.61
     rank  1: 527.61
     rank  2: 512.63
     rank  3: 519.89
     rank  4: 128.32
     rank  5: 130.37
     rank  6: 130.77
     rank  7: 128.99
     rank  8: 43.19
     rank  9: 42.89
     rank 10: 50.62
     rank 11: 45.57
  backward-send:
     rank  4: 1.10
     rank  5: 1.05
     rank  6: 1.12
     rank  7: 1.08
     rank  8: 6.71
     rank  9: 6.73
     rank 10: 3.11
     rank 11: 5.12
     rank 12: 4.50
     rank 13: 4.54
     rank 14: 2.57
     rank 15: 4.49
  forward-send-backward-recv:
     rank  0: 380.48
     rank  1: 360.23
     rank  2: 376.12
     rank  3: 381.79
     rank  4: 181.99
     rank  5: 153.97
     rank  6: 176.03
     rank  7: 182.85
     rank  8: 88.62
     rank  9: 68.66
     rank 10: 79.30
     rank 11: 89.10
  backward-send-forward-recv:
     rank  4: 0.61
     rank  5: 0.97
     rank  6: 0.58
     rank  7: 0.60
     rank  8: 29.30
     rank  9: 28.72
     rank 10: 22.54
     rank 11: 29.87
     rank 12: 166.40
     rank 13: 165.96
     rank 14: 156.89
     rank 15: 162.32
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.07
     rank 13: 0.07
     rank 14: 0.07
     rank 15: 0.06
  all-grads-sync:
     rank  0: 202.95
     rank  1: 202.99
     rank  2: 203.07
     rank  3: 203.00
     rank  4: 191.37
     rank  5: 191.33
     rank  6: 191.38
     rank  7: 191.39
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.09
     rank  1: 0.14
     rank  2: 0.13
     rank  3: 0.09
     rank  4: 0.10
     rank  5: 0.10
     rank  6: 0.09
     rank  7: 0.10
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 20.43
     rank  1: 20.53
     rank  2: 20.42
     rank  3: 20.41
     rank  4: 24.88
     rank  5: 24.94
     rank  6: 24.90
     rank  7: 24.88
     rank  8: 0.06
     rank  9: 0.06
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.04
     rank 13: 0.07
     rank 14: 0.04
     rank 15: 0.04
  optimizer:
     rank  0: 21.33
     rank  1: 21.42
     rank  2: 21.31
     rank  3: 21.31
     rank  4: 25.77
     rank  5: 25.83
     rank  6: 25.79
     rank  7: 25.78
     rank  8: 0.94
     rank  9: 0.94
     rank 10: 0.93
     rank 11: 0.93
     rank 12: 0.93
     rank 13: 0.96
     rank 14: 0.93
     rank 15: 0.93
 [2024-12-24 21:47:31] iteration        4/      10 | consumed samples:           64 | elapsed time per iteration (ms): 1598.5 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 7.315938E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 1545.49
     rank  1: 1545.40
     rank  2: 1545.52
     rank  3: 1545.40
     rank  4: 1545.71
     rank  5: 1545.71
     rank  6: 1545.74
     rank  7: 1545.70
     rank  8: 1543.59
     rank  9: 1543.58
     rank 10: 1543.58
     rank 11: 1543.54
     rank 12: 1543.56
     rank 13: 1543.50
     rank 14: 1543.51
     rank 15: 1543.49
  forward-compute:
     rank  0: 146.65
     rank  1: 154.79
     rank  2: 149.26
     rank  3: 140.56
     rank  4: 440.68
     rank  5: 444.59
     rank  6: 445.31
     rank  7: 442.52
     rank  8: 384.73
     rank  9: 385.85
     rank 10: 388.29
     rank 11: 384.06
     rank 12: 321.67
     rank 13: 311.81
     rank 14: 331.22
     rank 15: 335.71
  backward-compute:
     rank  0: 138.29
     rank  1: 150.64
     rank  2: 145.52
     rank  3: 144.82
     rank  4: 515.92
     rank  5: 512.16
     rank  6: 511.22
     rank  7: 513.85
     rank  8: 462.83
     rank  9: 465.00
     rank 10: 467.53
     rank 11: 464.19
     rank 12: 314.64
     rank 13: 315.58
     rank 14: 312.79
     rank 15: 316.40
  pure-backward-compute:
     rank  0: 138.10
     rank  1: 150.41
     rank  2: 145.28
     rank  3: 144.60
     rank  4: 515.72
     rank  5: 511.97
     rank  6: 510.97
     rank  7: 513.65
     rank  8: 462.45
     rank  9: 464.62
     rank 10: 467.19
     rank 11: 463.78
     rank 12: 313.95
     rank 13: 314.75
     rank 14: 312.05
     rank 15: 315.71
  batch-generator:
     rank  0: 14.60
     rank  1: 15.52
     rank  2: 15.14
     rank  3: 13.49
     rank  4: 10.66
     rank  5: 11.57
     rank  6: 14.39
     rank  7: 11.07
     rank  8: 13.87
     rank  9: 13.45
     rank 10: 13.57
     rank 11: 13.42
     rank 12: 15.13
     rank 13: 14.53
     rank 14: 15.88
     rank 15: 14.94
  forward-recv:
     rank  4: 36.47
     rank  5: 43.61
     rank  6: 36.41
     rank  7: 32.92
     rank  8: 162.39
     rank  9: 167.90
     rank 10: 161.78
     rank 11: 158.90
     rank 12: 245.32
     rank 13: 254.57
     rank 14: 246.20
     rank 15: 239.58
  forward-send:
     rank  0: 152.44
     rank  1: 151.33
     rank  2: 149.99
     rank  3: 151.16
     rank  4: 4.37
     rank  5: 3.09
     rank  6: 4.43
     rank  7: 3.11
     rank  8: 2.90
     rank  9: 2.96
     rank 10: 2.46
     rank 11: 1.80
  backward-recv:
     rank  0: 529.19
     rank  1: 516.07
     rank  2: 522.78
     rank  3: 522.64
     rank  4: 130.30
     rank  5: 131.69
     rank  6: 130.55
     rank  7: 132.63
     rank  8: 44.73
     rank  9: 42.92
     rank 10: 41.42
     rank 11: 51.96
  backward-send:
     rank  4: 1.00
     rank  5: 1.00
     rank  6: 1.02
     rank  7: 1.06
     rank  8: 6.47
     rank  9: 7.55
     rank 10: 6.31
     rank 11: 6.29
     rank 12: 5.06
     rank 13: 5.01
     rank 14: 4.16
     rank 15: 4.99
  forward-send-backward-recv:
     rank  0: 370.58
     rank  1: 363.01
     rank  2: 366.85
     rank  3: 377.43
     rank  4: 172.33
     rank  5: 164.04
     rank  6: 169.19
     rank  7: 174.32
     rank  8: 81.06
     rank  9: 73.75
     rank 10: 70.94
     rank 11: 79.77
  backward-send-forward-recv:
     rank  4: 0.58
     rank  5: 0.69
     rank  6: 0.87
     rank  7: 0.69
     rank  8: 26.76
     rank  9: 26.79
     rank 10: 32.26
     rank 11: 25.52
     rank 12: 165.18
     rank 13: 165.05
     rank 14: 156.45
     rank 15: 155.58
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.04
     rank 11: 0.03
     rank 12: 0.05
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.12
     rank 13: 0.06
     rank 14: 0.07
     rank 15: 0.06
  all-grads-sync:
     rank  0: 203.01
     rank  1: 203.04
     rank  2: 203.19
     rank  3: 203.08
     rank  4: 191.87
     rank  5: 191.86
     rank  6: 191.83
     rank  7: 191.81
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.04
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.16
     rank  1: 0.17
     rank  2: 0.20
     rank  3: 0.09
     rank  4: 0.09
     rank  5: 0.12
     rank  6: 0.11
     rank  7: 0.09
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 20.60
     rank  1: 20.41
     rank  2: 20.60
     rank  3: 20.37
     rank  4: 24.93
     rank  5: 24.95
     rank  6: 24.92
     rank  7: 24.90
     rank  8: 0.06
     rank  9: 0.06
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.08
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.04
  optimizer:
     rank  0: 21.56
     rank  1: 21.37
     rank  2: 21.55
     rank  3: 21.32
     rank  4: 25.88
     rank  5: 25.89
     rank  6: 25.87
     rank  7: 25.85
     rank  8: 1.00
     rank  9: 1.00
     rank 10: 0.99
     rank 11: 0.99
     rank 12: 1.02
     rank 13: 0.99
     rank 14: 0.99
     rank 15: 0.99
 [2024-12-24 21:47:32] iteration        5/      10 | consumed samples:           80 | elapsed time per iteration (ms): 1601.4 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 7.219877E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 1544.24
     rank  1: 1544.23
     rank  2: 1544.29
     rank  3: 1544.23
     rank  4: 1544.60
     rank  5: 1544.62
     rank  6: 1544.64
     rank  7: 1544.61
     rank  8: 1542.72
     rank  9: 1542.84
     rank 10: 1542.72
     rank 11: 1542.70
     rank 12: 1542.41
     rank 13: 1542.41
     rank 14: 1542.46
     rank 15: 1542.42
  forward-compute:
     rank  0: 144.47
     rank  1: 162.52
     rank  2: 149.42
     rank  3: 140.28
     rank  4: 442.17
     rank  5: 457.85
     rank  6: 445.82
     rank  7: 441.41
     rank  8: 386.02
     rank  9: 385.60
     rank 10: 387.88
     rank 11: 384.99
     rank 12: 324.26
     rank 13: 312.14
     rank 14: 321.65
     rank 15: 334.14
  backward-compute:
     rank  0: 138.19
     rank  1: 149.31
     rank  2: 153.54
     rank  3: 145.94
     rank  4: 515.10
     rank  5: 513.04
     rank  6: 511.60
     rank  7: 513.82
     rank  8: 463.36
     rank  9: 464.91
     rank 10: 466.90
     rank 11: 465.74
     rank 12: 315.50
     rank 13: 315.95
     rank 14: 314.92
     rank 15: 315.83
  pure-backward-compute:
     rank  0: 137.97
     rank  1: 149.08
     rank  2: 153.34
     rank  3: 145.75
     rank  4: 514.88
     rank  5: 512.74
     rank  6: 511.41
     rank  7: 513.62
     rank  8: 462.80
     rank  9: 464.51
     rank 10: 466.58
     rank 11: 465.40
     rank 12: 314.82
     rank 13: 315.30
     rank 14: 314.25
     rank 15: 315.21
  batch-generator:
     rank  0: 14.76
     rank  1: 17.30
     rank  2: 16.50
     rank  3: 13.54
     rank  4: 11.03
     rank  5: 13.03
     rank  6: 13.69
     rank  7: 11.03
     rank  8: 14.35
     rank  9: 13.57
     rank 10: 13.31
     rank 11: 13.18
     rank 12: 15.45
     rank 13: 14.36
     rank 14: 15.84
     rank 15: 15.82
  forward-recv:
     rank  4: 35.17
     rank  5: 43.23
     rank  6: 37.85
     rank  7: 33.14
     rank  8: 159.50
     rank  9: 167.25
     rank 10: 161.61
     rank 11: 158.70
     rank 12: 243.32
     rank 13: 253.83
     rank 14: 245.14
     rank 15: 239.86
  forward-send:
     rank  0: 150.93
     rank  1: 142.17
     rank  2: 148.73
     rank  3: 151.83
     rank  4: 2.96
     rank  5: 3.14
     rank  6: 3.15
     rank  7: 3.08
     rank  8: 2.61
     rank  9: 2.89
     rank 10: 1.56
     rank 11: 1.58
  backward-recv:
     rank  0: 528.04
     rank  1: 514.97
     rank  2: 513.24
     rank  3: 520.55
     rank  4: 131.43
     rank  5: 130.68
     rank  6: 128.20
     rank  7: 131.88
     rank  8: 46.11
     rank  9: 44.77
     rank 10: 42.44
     rank 11: 48.70
  backward-send:
     rank  4: 1.19
     rank  5: 1.02
     rank  6: 0.92
     rank  7: 1.10
     rank  8: 6.80
     rank  9: 6.67
     rank 10: 6.46
     rank 11: 6.30
     rank 12: 5.15
     rank 13: 5.14
     rank 14: 4.30
     rank 15: 5.06
  forward-send-backward-recv:
     rank  0: 374.10
     rank  1: 365.68
     rank  2: 370.35
     rank  3: 377.02
     rank  4: 171.97
     rank  5: 149.02
     rank  6: 171.45
     rank  7: 174.46
     rank  8: 81.91
     rank  9: 72.82
     rank 10: 75.65
     rank 11: 80.47
  backward-send-forward-recv:
     rank  4: 0.61
     rank  5: 1.10
     rank  6: 0.53
     rank  7: 0.61
     rank  8: 24.79
     rank  9: 26.23
     rank 10: 28.74
     rank 11: 24.46
     rank 12: 162.03
     rank 13: 163.36
     rank 14: 163.23
     rank 15: 155.26
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.04
     rank  9: 0.08
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.08
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.03
     rank  9: 0.05
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.07
     rank 13: 0.07
     rank 14: 0.12
     rank 15: 0.06
  all-grads-sync:
     rank  0: 203.07
     rank  1: 203.13
     rank  2: 203.20
     rank  3: 203.16
     rank  4: 196.92
     rank  5: 196.88
     rank  6: 196.93
     rank  7: 196.95
     rank  8: 0.03
     rank  9: 0.09
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.08
     rank  1: 0.17
     rank  2: 0.09
     rank  3: 0.09
     rank  4: 0.10
     rank  5: 0.11
     rank  6: 0.09
     rank  7: 0.10
     rank  8: 0.02
     rank  9: 0.04
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 20.45
     rank  1: 20.46
     rank  2: 20.45
     rank  3: 20.38
     rank  4: 24.88
     rank  5: 24.97
     rank  6: 24.91
     rank  7: 24.86
     rank  8: 0.05
     rank  9: 0.12
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.07
     rank 15: 0.04
  optimizer:
     rank  0: 21.38
     rank  1: 21.52
     rank  2: 21.38
     rank  3: 21.31
     rank  4: 25.82
     rank  5: 25.90
     rank  6: 25.84
     rank  7: 25.79
     rank  8: 0.97
     rank  9: 1.04
     rank 10: 0.97
     rank 11: 0.97
     rank 12: 0.97
     rank 13: 0.97
     rank 14: 1.00
     rank 15: 0.96
 [2024-12-24 21:47:34] iteration        6/      10 | consumed samples:           96 | elapsed time per iteration (ms): 1608.4 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 6.289687E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 1546.24
     rank  1: 1546.32
     rank  2: 1546.51
     rank  3: 1546.24
     rank  4: 1546.41
     rank  5: 1546.41
     rank  6: 1546.47
     rank  7: 1546.42
     rank  8: 1544.34
     rank  9: 1544.32
     rank 10: 1544.26
     rank 11: 1544.23
     rank 12: 1544.15
     rank 13: 1544.19
     rank 14: 1544.12
     rank 15: 1544.13
  forward-compute:
     rank  0: 151.42
     rank  1: 153.76
     rank  2: 160.39
     rank  3: 131.29
     rank  4: 443.53
     rank  5: 440.72
     rank  6: 443.74
     rank  7: 438.56
     rank  8: 385.57
     rank  9: 389.29
     rank 10: 387.99
     rank 11: 386.20
     rank 12: 317.11
     rank 13: 315.16
     rank 14: 318.47
     rank 15: 337.72
  backward-compute:
     rank  0: 137.58
     rank  1: 147.21
     rank  2: 145.67
     rank  3: 148.84
     rank  4: 515.12
     rank  5: 512.98
     rank  6: 514.72
     rank  7: 511.06
     rank  8: 463.33
     rank  9: 466.30
     rank 10: 466.99
     rank 11: 465.65
     rank 12: 315.57
     rank 13: 315.85
     rank 14: 313.04
     rank 15: 316.08
  pure-backward-compute:
     rank  0: 137.40
     rank  1: 146.98
     rank  2: 145.42
     rank  3: 148.65
     rank  4: 514.93
     rank  5: 512.78
     rank  6: 514.53
     rank  7: 510.81
     rank  8: 462.54
     rank  9: 465.83
     rank 10: 466.67
     rank 11: 465.29
     rank 12: 314.81
     rank 13: 315.18
     rank 14: 312.38
     rank 15: 315.44
  batch-generator:
     rank  0: 15.33
     rank  1: 16.32
     rank  2: 19.81
     rank  3: 13.37
     rank  4: 11.49
     rank  5: 11.08
     rank  6: 11.45
     rank  7: 10.52
     rank  8: 14.63
     rank  9: 15.11
     rank 10: 13.33
     rank 11: 13.45
     rank 12: 15.32
     rank 13: 15.26
     rank 14: 15.55
     rank 15: 15.70
  forward-recv:
     rank  4: 38.15
     rank  5: 39.81
     rank  6: 40.53
     rank  7: 30.85
     rank  8: 167.14
     rank  9: 164.94
     rank 10: 166.45
     rank 11: 153.64
     rank 12: 249.47
     rank 13: 252.17
     rank 14: 248.14
     rank 15: 237.13
  forward-send:
     rank  0: 153.35
     rank  1: 150.85
     rank  2: 151.56
     rank  3: 156.92
     rank  4: 6.60
     rank  5: 5.92
     rank  6: 5.51
     rank  7: 3.14
     rank  8: 2.77
     rank  9: 2.90
     rank 10: 2.11
     rank 11: 1.67
  backward-recv:
     rank  0: 526.16
     rank  1: 516.41
     rank  2: 515.34
     rank  3: 515.68
     rank  4: 127.86
     rank  5: 131.34
     rank  6: 126.17
     rank  7: 132.39
     rank  8: 42.15
     rank  9: 44.03
     rank 10: 39.83
     rank 11: 48.65
  backward-send:
     rank  4: 1.10
     rank  5: 0.93
     rank  6: 1.03
     rank  7: 1.30
     rank  8: 7.34
     rank  9: 6.47
     rank 10: 5.83
     rank 11: 5.88
     rank 12: 4.60
     rank 13: 4.56
     rank 14: 3.15
     rank 15: 4.56
  forward-send-backward-recv:
     rank  0: 366.03
     rank  1: 365.55
     rank  2: 358.97
     rank  3: 380.96
     rank  4: 166.34
     rank  5: 166.83
     rank  6: 164.49
     rank  7: 180.33
     rank  8: 74.13
     rank  9: 73.34
     rank 10: 73.02
     rank 11: 85.44
  backward-send-forward-recv:
     rank  4: 0.54
     rank  5: 0.56
     rank  6: 0.80
     rank  7: 0.57
     rank  8: 27.44
     rank  9: 22.98
     rank 10: 26.14
     rank 11: 23.94
     rank 12: 163.76
     rank 13: 162.85
     rank 14: 165.73
     rank 15: 155.54
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.04
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.05
     rank 14: 0.02
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.09
     rank  7: 0.05
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.07
     rank 13: 0.09
     rank 14: 0.06
     rank 15: 0.07
  all-grads-sync:
     rank  0: 205.95
     rank  1: 206.01
     rank  2: 203.16
     rank  3: 206.02
     rank  4: 191.44
     rank  5: 191.41
     rank  6: 191.44
     rank  7: 191.40
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.09
     rank  1: 0.18
     rank  2: 0.26
     rank  3: 0.09
     rank  4: 0.10
     rank  5: 0.10
     rank  6: 0.11
     rank  7: 0.10
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 20.33
     rank  1: 20.60
     rank  2: 20.92
     rank  3: 20.36
     rank  4: 24.89
     rank  5: 24.86
     rank  6: 25.07
     rank  7: 24.87
     rank  8: 0.11
     rank  9: 0.06
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.05
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.07
  optimizer:
     rank  0: 21.52
     rank  1: 21.79
     rank  2: 22.12
     rank  3: 21.55
     rank  4: 26.09
     rank  5: 26.05
     rank  6: 26.26
     rank  7: 26.06
     rank  8: 1.29
     rank  9: 1.24
     rank 10: 1.23
     rank 11: 1.23
     rank 12: 1.23
     rank 13: 1.23
     rank 14: 1.23
     rank 15: 1.26
 [2024-12-24 21:47:35] iteration        7/      10 | consumed samples:          112 | elapsed time per iteration (ms): 1606.7 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 5.883966E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 1546.89
     rank  1: 1546.79
     rank  2: 1547.02
     rank  3: 1546.87
     rank  4: 1547.15
     rank  5: 1547.15
     rank  6: 1547.20
     rank  7: 1547.15
     rank  8: 1545.14
     rank  9: 1545.25
     rank 10: 1545.13
     rank 11: 1545.12
     rank 12: 1544.89
     rank 13: 1544.89
     rank 14: 1544.88
     rank 15: 1544.88
  forward-compute:
     rank  0: 150.27
     rank  1: 151.93
     rank  2: 160.82
     rank  3: 134.28
     rank  4: 445.70
     rank  5: 443.35
     rank  6: 448.39
     rank  7: 442.39
     rank  8: 386.25
     rank  9: 387.74
     rank 10: 388.21
     rank 11: 386.18
     rank 12: 315.70
     rank 13: 313.09
     rank 14: 316.12
     rank 15: 333.33
  backward-compute:
     rank  0: 139.38
     rank  1: 149.15
     rank  2: 156.82
     rank  3: 157.57
     rank  4: 515.98
     rank  5: 512.33
     rank  6: 515.71
     rank  7: 511.56
     rank  8: 463.52
     rank  9: 466.22
     rank 10: 467.13
     rank 11: 465.54
     rank 12: 315.91
     rank 13: 316.01
     rank 14: 313.91
     rank 15: 317.10
  pure-backward-compute:
     rank  0: 139.16
     rank  1: 148.95
     rank  2: 156.42
     rank  3: 157.39
     rank  4: 515.78
     rank  5: 512.07
     rank  6: 515.52
     rank  7: 511.38
     rank  8: 463.07
     rank  9: 465.68
     rank 10: 466.79
     rank 11: 465.12
     rank 12: 315.20
     rank 13: 315.30
     rank 14: 313.23
     rank 15: 316.40
  batch-generator:
     rank  0: 14.55
     rank  1: 16.23
     rank  2: 18.16
     rank  3: 13.17
     rank  4: 11.09
     rank  5: 11.36
     rank  6: 11.46
     rank  7: 10.61
     rank  8: 14.10
     rank  9: 14.59
     rank 10: 13.60
     rank 11: 13.37
     rank 12: 15.87
     rank 13: 14.60
     rank 14: 16.32
     rank 15: 14.97
  forward-recv:
     rank  4: 37.39
     rank  5: 39.21
     rank  6: 38.98
     rank  7: 32.82
     rank  8: 160.59
     rank  9: 162.70
     rank 10: 167.37
     rank 11: 157.28
     rank 12: 248.99
     rank 13: 249.52
     rank 14: 250.15
     rank 15: 239.14
  forward-send:
     rank  0: 150.68
     rank  1: 150.35
     rank  2: 151.40
     rank  3: 157.21
     rank  4: 3.14
     rank  5: 4.41
     rank  6: 3.08
     rank  7: 3.10
     rank  8: 4.31
     rank  9: 4.75
     rank 10: 3.24
     rank 11: 1.59
  backward-recv:
     rank  0: 526.10
     rank  1: 522.39
     rank  2: 510.44
     rank  3: 513.49
     rank  4: 127.00
     rank  5: 129.70
     rank  6: 125.53
     rank  7: 133.82
     rank  8: 44.27
     rank  9: 41.66
     rank 10: 39.28
     rank 11: 53.10
  backward-send:
     rank  4: 1.08
     rank  5: 1.34
     rank  6: 1.03
     rank  7: 0.98
     rank  8: 4.18
     rank  9: 6.17
     rank 10: 4.35
     rank 11: 4.80
     rank 12: 4.56
     rank 13: 4.55
     rank 14: 2.58
     rank 15: 4.63
  forward-send-backward-recv:
     rank  0: 366.30
     rank  1: 363.58
     rank  2: 353.67
     rank  3: 374.51
     rank  4: 166.20
     rank  5: 166.67
     rank  6: 161.72
     rank  7: 171.83
     rank  8: 74.95
     rank  9: 72.14
     rank 10: 68.46
     rank 11: 75.79
  backward-send-forward-recv:
     rank  4: 0.61
     rank  5: 0.64
     rank  6: 0.72
     rank  7: 0.75
     rank  8: 29.91
     rank  9: 28.68
     rank 10: 28.17
     rank 11: 25.32
     rank 12: 165.36
     rank 13: 167.29
     rank 14: 164.79
     rank 15: 156.29
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.05
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.09
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.03
     rank  9: 0.05
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.07
     rank 13: 0.06
     rank 14: 0.07
     rank 15: 0.06
  all-grads-sync:
     rank  0: 203.11
     rank  1: 203.14
     rank  2: 203.21
     rank  3: 203.17
     rank  4: 196.22
     rank  5: 196.16
     rank  6: 196.22
     rank  7: 196.24
     rank  8: 0.02
     rank  9: 0.08
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.10
     rank  1: 0.09
     rank  2: 0.18
     rank  3: 0.09
     rank  4: 0.10
     rank  5: 0.11
     rank  6: 0.10
     rank  7: 0.10
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 20.57
     rank  1: 20.41
     rank  2: 20.66
     rank  3: 20.40
     rank  4: 24.89
     rank  5: 24.91
     rank  6: 24.92
     rank  7: 24.87
     rank  8: 0.05
     rank  9: 0.12
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.04
  optimizer:
     rank  0: 21.53
     rank  1: 21.36
     rank  2: 21.65
     rank  3: 21.36
     rank  4: 25.84
     rank  5: 25.86
     rank  6: 25.87
     rank  7: 25.82
     rank  8: 0.99
     rank  9: 1.06
     rank 10: 0.99
     rank 11: 0.98
     rank 12: 0.99
     rank 13: 0.99
     rank 14: 0.98
     rank 15: 0.99
 [2024-12-24 21:47:37] iteration        8/      10 | consumed samples:          128 | elapsed time per iteration (ms): 1600.8 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 5.081666E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 1545.12
     rank  1: 1545.11
     rank  2: 1545.12
     rank  3: 1545.24
     rank  4: 1545.43
     rank  5: 1545.45
     rank  6: 1545.45
     rank  7: 1545.46
     rank  8: 1543.32
     rank  9: 1543.31
     rank 10: 1543.25
     rank 11: 1543.31
     rank 12: 1543.17
     rank 13: 1543.16
     rank 14: 1543.13
     rank 15: 1543.14
  forward-compute:
     rank  0: 149.30
     rank  1: 146.31
     rank  2: 158.05
     rank  3: 138.65
     rank  4: 443.80
     rank  5: 446.50
     rank  6: 442.62
     rank  7: 440.72
     rank  8: 386.71
     rank  9: 390.39
     rank 10: 388.27
     rank 11: 385.53
     rank 12: 319.85
     rank 13: 314.30
     rank 14: 314.73
     rank 15: 335.71
  backward-compute:
     rank  0: 138.58
     rank  1: 145.48
     rank  2: 140.30
     rank  3: 146.83
     rank  4: 516.05
     rank  5: 514.27
     rank  6: 515.48
     rank  7: 511.66
     rank  8: 464.72
     rank  9: 467.42
     rank 10: 467.03
     rank 11: 464.96
     rank 12: 315.83
     rank 13: 316.36
     rank 14: 315.71
     rank 15: 316.53
  pure-backward-compute:
     rank  0: 138.38
     rank  1: 145.21
     rank  2: 140.12
     rank  3: 146.63
     rank  4: 515.80
     rank  5: 513.94
     rank  6: 515.30
     rank  7: 511.47
     rank  8: 464.25
     rank  9: 467.01
     rank 10: 466.71
     rank 11: 464.61
     rank 12: 315.04
     rank 13: 315.71
     rank 14: 315.05
     rank 15: 315.88
  batch-generator:
     rank  0: 14.38
     rank  1: 14.42
     rank  2: 16.83
     rank  3: 15.75
     rank  4: 10.81
     rank  5: 12.78
     rank  6: 11.09
     rank  7: 10.85
     rank  8: 14.03
     rank  9: 16.25
     rank 10: 13.14
     rank 11: 13.55
     rank 12: 16.76
     rank 13: 14.61
     rank 14: 14.96
     rank 15: 16.55
  forward-recv:
     rank  4: 38.04
     rank  5: 36.49
     rank  6: 43.44
     rank  7: 32.69
     rank  8: 162.62
     rank  9: 157.26
     rank 10: 169.11
     rank 11: 158.60
     rank 12: 248.89
     rank 13: 249.57
     rank 14: 252.61
     rank 15: 240.23
  forward-send:
     rank  0: 151.63
     rank  1: 152.25
     rank  2: 148.48
     rank  3: 157.26
     rank  4: 3.07
     rank  5: 3.32
     rank  6: 3.14
     rank  7: 3.14
     rank  8: 4.40
     rank  9: 4.96
     rank 10: 1.80
     rank 11: 1.68
  backward-recv:
     rank  0: 526.61
     rank  1: 517.42
     rank  2: 520.36
     rank  3: 522.04
     rank  4: 128.00
     rank  5: 126.06
     rank  6: 123.71
     rank  7: 132.73
     rank  8: 46.18
     rank  9: 43.06
     rank 10: 42.94
     rank 11: 52.61
  backward-send:
     rank  4: 1.30
     rank  5: 1.42
     rank  6: 1.07
     rank  7: 1.12
     rank  8: 5.40
     rank  9: 5.36
     rank 10: 3.07
     rank 11: 4.92
     rank 12: 4.97
     rank 13: 4.80
     rank 14: 3.41
     rank 15: 4.87
  forward-send-backward-recv:
     rank  0: 367.77
     rank  1: 371.89
     rank  2: 362.93
     rank  3: 371.70
     rank  4: 167.04
     rank  5: 167.95
     rank  6: 164.12
     rank  7: 174.32
     rank  8: 73.46
     rank  9: 74.09
     rank 10: 67.74
     rank 11: 75.96
  backward-send-forward-recv:
     rank  4: 0.56
     rank  5: 1.02
     rank  6: 0.60
     rank  7: 0.52
     rank  8: 25.86
     rank  9: 26.92
     rank 10: 25.67
     rank 11: 24.68
     rank 12: 160.03
     rank 13: 164.67
     rank 14: 161.15
     rank 15: 152.29
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.07
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.04
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.04
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.08
     rank 13: 0.07
     rank 14: 0.07
     rank 15: 0.06
  all-grads-sync:
     rank  0: 203.12
     rank  1: 203.12
     rank  2: 203.24
     rank  3: 203.21
     rank  4: 191.00
     rank  5: 191.00
     rank  6: 191.01
     rank  7: 191.00
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.09
     rank  1: 0.09
     rank  2: 0.10
     rank  3: 0.13
     rank  4: 0.10
     rank  5: 0.11
     rank  6: 0.10
     rank  7: 0.10
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 20.40
     rank  1: 20.37
     rank  2: 20.40
     rank  3: 20.67
     rank  4: 24.86
     rank  5: 24.98
     rank  6: 24.90
     rank  7: 24.87
     rank  8: 0.06
     rank  9: 0.06
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.04
     rank 13: 0.07
     rank 14: 0.04
     rank 15: 0.04
  optimizer:
     rank  0: 21.28
     rank  1: 21.25
     rank  2: 21.28
     rank  3: 21.54
     rank  4: 25.74
     rank  5: 25.81
     rank  6: 25.77
     rank  7: 25.74
     rank  8: 0.92
     rank  9: 0.93
     rank 10: 0.91
     rank 11: 0.91
     rank 12: 0.92
     rank 13: 0.94
     rank 14: 0.91
     rank 15: 0.91
 [2024-12-24 21:47:39] iteration        9/      10 | consumed samples:          144 | elapsed time per iteration (ms): 1601.2 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 4.411566E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 1548.45
     rank  1: 1548.36
     rank  2: 1548.37
     rank  3: 1548.36
     rank  4: 1548.72
     rank  5: 1548.67
     rank  6: 1548.69
     rank  7: 1548.68
     rank  8: 1546.45
     rank  9: 1546.45
     rank 10: 1546.42
     rank 11: 1546.43
     rank 12: 1546.55
     rank 13: 1546.48
     rank 14: 1546.49
     rank 15: 1546.48
  forward-compute:
     rank  0: 153.79
     rank  1: 152.00
     rank  2: 157.07
     rank  3: 138.67
     rank  4: 442.58
     rank  5: 443.52
     rank  6: 447.69
     rank  7: 441.14
     rank  8: 388.27
     rank  9: 388.93
     rank 10: 392.41
     rank 11: 386.21
     rank 12: 315.52
     rank 13: 315.63
     rank 14: 314.49
     rank 15: 334.97
  backward-compute:
     rank  0: 137.80
     rank  1: 152.91
     rank  2: 152.82
     rank  3: 156.99
     rank  4: 515.89
     rank  5: 510.80
     rank  6: 515.81
     rank  7: 512.24
     rank  8: 465.34
     rank  9: 467.26
     rank 10: 468.25
     rank 11: 466.02
     rank 12: 316.86
     rank 13: 316.56
     rank 14: 316.35
     rank 15: 317.47
  pure-backward-compute:
     rank  0: 137.60
     rank  1: 152.68
     rank  2: 152.43
     rank  3: 156.80
     rank  4: 515.70
     rank  5: 510.51
     rank  6: 515.49
     rank  7: 512.00
     rank  8: 464.96
     rank  9: 466.92
     rank 10: 467.76
     rank 11: 465.69
     rank 12: 316.18
     rank 13: 315.86
     rank 14: 315.65
     rank 15: 316.78
  batch-generator:
     rank  0: 15.14
     rank  1: 15.58
     rank  2: 15.88
     rank  3: 16.12
     rank  4: 10.88
     rank  5: 11.12
     rank  6: 14.77
     rank  7: 10.91
     rank  8: 14.08
     rank  9: 14.88
     rank 10: 16.16
     rank 11: 13.36
     rank 12: 14.73
     rank 13: 14.93
     rank 14: 16.01
     rank 15: 14.70
  forward-recv:
     rank  4: 37.67
     rank  5: 37.13
     rank  6: 38.14
     rank  7: 36.16
     rank  8: 163.08
     rank  9: 162.88
     rank 10: 162.86
     rank 11: 161.61
     rank 12: 250.31
     rank 13: 249.62
     rank 14: 251.56
     rank 15: 242.87
  forward-send:
     rank  0: 149.44
     rank  1: 150.31
     rank  2: 147.81
     rank  3: 156.37
     rank  4: 6.63
     rank  5: 5.57
     rank  6: 5.99
     rank  7: 3.10
     rank  8: 5.07
     rank  9: 4.40
     rank 10: 2.28
     rank 11: 1.69
  backward-recv:
     rank  0: 529.65
     rank  1: 513.71
     rank  2: 515.45
     rank  3: 514.80
     rank  4: 130.56
     rank  5: 131.59
     rank  6: 124.79
     rank  7: 134.88
     rank  8: 44.46
     rank  9: 43.13
     rank 10: 40.62
     rank 11: 55.00
  backward-send:
     rank  4: 1.07
     rank  5: 1.47
     rank  6: 1.40
     rank  7: 1.40
     rank  8: 6.38
     rank  9: 6.72
     rank 10: 5.42
     rank 11: 5.63
     rank 12: 4.75
     rank 13: 4.98
     rank 14: 3.53
     rank 15: 4.56
  forward-send-backward-recv:
     rank  0: 366.23
     rank  1: 366.38
     rank  2: 365.09
     rank  3: 373.34
     rank  4: 166.85
     rank  5: 168.97
     rank  6: 165.10
     rank  7: 169.90
     rank  8: 72.83
     rank  9: 73.33
     rank 10: 69.03
     rank 11: 73.32
  backward-send-forward-recv:
     rank  4: 0.54
     rank  5: 0.70
     rank  6: 1.01
     rank  7: 0.57
     rank  8: 27.00
     rank  9: 26.09
     rank 10: 29.45
     rank 11: 22.15
     rank 12: 165.11
     rank 13: 165.73
     rank 14: 164.52
     rank 15: 151.97
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.07
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.10
     rank 13: 0.06
     rank 14: 0.07
     rank 15: 0.06
  all-grads-sync:
     rank  0: 203.07
     rank  1: 203.05
     rank  2: 203.09
     rank  3: 203.07
     rank  4: 194.58
     rank  5: 194.54
     rank  6: 194.59
     rank  7: 194.60
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.20
     rank  1: 0.08
     rank  2: 0.17
     rank  3: 0.10
     rank  4: 0.10
     rank  5: 0.10
     rank  6: 0.10
     rank  7: 0.10
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 20.41
     rank  1: 20.37
     rank  2: 20.47
     rank  3: 20.39
     rank  4: 24.89
     rank  5: 24.86
     rank  6: 24.91
     rank  7: 24.88
     rank  8: 0.05
     rank  9: 0.05
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.08
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.04
  optimizer:
     rank  0: 21.19
     rank  1: 21.16
     rank  2: 21.26
     rank  3: 21.18
     rank  4: 25.67
     rank  5: 25.64
     rank  6: 25.70
     rank  7: 25.66
     rank  8: 0.83
     rank  9: 0.84
     rank 10: 0.83
     rank 11: 0.83
     rank 12: 0.86
     rank 13: 0.82
     rank 14: 0.82
     rank 15: 0.82
 [2024-12-24 21:47:40] iteration       10/      10 | consumed samples:          160 | elapsed time per iteration (ms): 1595.2 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 4.371122E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 1544.86
     rank  1: 1544.92
     rank  2: 1544.94
     rank  3: 1544.85
     rank  4: 1545.26
     rank  5: 1545.25
     rank  6: 1545.28
     rank  7: 1545.23
     rank  8: 1543.06
     rank  9: 1543.07
     rank 10: 1543.00
     rank 11: 1543.00
     rank 12: 1543.01
     rank 13: 1543.05
     rank 14: 1543.05
     rank 15: 1543.01
  forward-compute:
     rank  0: 154.63
     rank  1: 165.32
     rank  2: 156.17
     rank  3: 135.40
     rank  4: 442.02
     rank  5: 441.38
     rank  6: 449.01
     rank  7: 439.57
     rank  8: 387.90
     rank  9: 389.73
     rank 10: 389.28
     rank 11: 386.49
     rank 12: 316.75
     rank 13: 315.36
     rank 14: 312.77
     rank 15: 338.52
  backward-compute:
     rank  0: 147.04
     rank  1: 147.47
     rank  2: 153.25
     rank  3: 145.69
     rank  4: 516.10
     rank  5: 509.41
     rank  6: 515.86
     rank  7: 511.99
     rank  8: 465.05
     rank  9: 467.93
     rank 10: 468.77
     rank 11: 465.52
     rank 12: 317.71
     rank 13: 315.83
     rank 14: 313.90
     rank 15: 317.24
  pure-backward-compute:
     rank  0: 146.83
     rank  1: 147.25
     rank  2: 153.01
     rank  3: 145.51
     rank  4: 515.84
     rank  5: 509.11
     rank  6: 515.61
     rank  7: 511.80
     rank  8: 464.65
     rank  9: 467.53
     rank 10: 468.42
     rank 11: 465.17
     rank 12: 317.05
     rank 13: 315.14
     rank 14: 313.24
     rank 15: 316.60
  batch-generator:
     rank  0: 14.63
     rank  1: 19.00
     rank  2: 19.31
     rank  3: 13.26
     rank  4: 10.69
     rank  5: 13.50
     rank  6: 14.13
     rank  7: 10.68
     rank  8: 13.74
     rank  9: 15.03
     rank 10: 13.20
     rank 11: 13.18
     rank 12: 15.45
     rank 13: 14.56
     rank 14: 15.20
     rank 15: 14.98
  forward-recv:
     rank  4: 37.85
     rank  5: 37.81
     rank  6: 42.52
     rank  7: 32.59
     rank  8: 159.58
     rank  9: 156.57
     rank 10: 167.61
     rank 11: 156.44
     rank 12: 248.89
     rank 13: 248.79
     rank 14: 251.54
     rank 15: 238.80
  forward-send:
     rank  0: 145.24
     rank  1: 147.52
     rank  2: 149.13
     rank  3: 155.58
     rank  4: 3.02
     rank  5: 3.14
     rank  6: 3.14
     rank  7: 3.12
     rank  8: 4.78
     rank  9: 4.86
     rank 10: 1.84
     rank 11: 1.58
  backward-recv:
     rank  0: 521.39
     rank  1: 517.94
     rank  2: 511.26
     rank  3: 520.02
     rank  4: 129.46
     rank  5: 131.41
     rank  6: 121.15
     rank  7: 134.11
     rank  8: 44.11
     rank  9: 42.81
     rank 10: 39.50
     rank 11: 53.93
  backward-send:
     rank  4: 1.29
     rank  5: 1.24
     rank  6: 1.03
     rank  7: 1.06
     rank  8: 5.93
     rank  9: 6.21
     rank 10: 3.65
     rank 11: 5.29
     rank 12: 4.57
     rank 13: 4.63
     rank 14: 2.79
     rank 15: 4.46
  forward-send-backward-recv:
     rank  0: 368.61
     rank  1: 354.38
     rank  2: 363.46
     rank  3: 376.26
     rank  4: 168.16
     rank  5: 171.19
     rank  6: 161.96
     rank  7: 174.30
     rank  8: 76.90
     rank  9: 76.24
     rank 10: 65.94
     rank 11: 76.11
  backward-send-forward-recv:
     rank  4: 0.51
     rank  5: 1.06
     rank  6: 0.94
     rank  7: 0.57
     rank  8: 25.45
     rank  9: 25.35
     rank 10: 29.71
     rank 11: 24.28
     rank 12: 162.48
     rank 13: 165.48
     rank 14: 166.52
     rank 15: 150.65
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.06
     rank 13: 0.08
     rank 14: 0.07
     rank 15: 0.06
  all-grads-sync:
     rank  0: 202.97
     rank  1: 203.03
     rank  2: 203.09
     rank  3: 203.05
     rank  4: 193.00
     rank  5: 192.96
     rank  6: 193.02
     rank  7: 193.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.09
     rank  1: 0.10
     rank  2: 0.17
     rank  3: 0.09
     rank  4: 0.10
     rank  5: 0.10
     rank  6: 0.10
     rank  7: 0.10
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 20.43
     rank  1: 20.57
     rank  2: 20.52
     rank  3: 20.35
     rank  4: 24.90
     rank  5: 24.85
     rank  6: 24.92
     rank  7: 24.86
     rank  8: 0.04
     rank  9: 0.09
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.04
  optimizer:
     rank  0: 21.30
     rank  1: 21.43
     rank  2: 21.40
     rank  3: 21.22
     rank  4: 25.76
     rank  5: 25.71
     rank  6: 25.78
     rank  7: 25.72
     rank  8: 0.90
     rank  9: 0.95
     rank 10: 0.90
     rank 11: 0.90
     rank 12: 0.90
     rank 13: 0.91
     rank 14: 0.90
     rank 15: 0.91
