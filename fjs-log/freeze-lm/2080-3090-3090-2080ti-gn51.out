examples/multimodal/pretrain-freeze-llm-hete-2080first.sh: line 4: activate: No such file or directory
1
[2024-12-25 14:43:59,771] torch.distributed.run: [WARNING] 
[2024-12-25 14:43:59,771] torch.distributed.run: [WARNING] *****************************************
[2024-12-25 14:43:59,771] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-12-25 14:43:59,771] torch.distributed.run: [WARNING] *****************************************
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
---Rank 6---Tensor Parallel Group GPUs: [0]
---Rank 7---Tensor Parallel Group GPUs: [0]---Rank 5---Tensor Parallel Group GPUs: [0]---Rank 6---Pipeline Parallel Group GPUs: [1, 1, 1, 1]
---Rank 4---Tensor Parallel Group GPUs: [0]


---Rank 7---Pipeline Parallel Group GPUs: [1, 1, 1, 1]
---Rank 5---Pipeline Parallel Group GPUs: [1, 1, 1, 1]
---Rank 4---Pipeline Parallel Group GPUs: [1, 1, 1, 1]
[rank6]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank5]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank7]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank4]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
 > number of parameters on (tensor, pipeline) model parallel rank (0, 1): 1474525184
INFO:megatron.core.distributed.param_and_grad_buffer:Number of buckets for gradient all-reduce / reduce-scatter: 1
Params for bucket 1 (249747456 elements):
	vision_model.decoder.layers.13.self_attention.linear_qkv.weight
	vision_model.decoder.layers.11.self_attention.linear_proj.bias
	vision_model.decoder.layers.10.self_attention.linear_proj.bias
	vision_model.decoder.layers.8.mlp.linear_fc2.weight
	vision_model.decoder.layers.4.mlp.linear_fc2.bias
	vision_model.decoder.layers.3.mlp.linear_fc2.bias
	vision_model.decoder.layers.1.self_attention.linear_qkv.weight
	vision_model.decoder.layers.13.mlp.linear_fc1.weight
	vision_model.decoder.layers.12.mlp.linear_fc1.bias
	vision_model.decoder.layers.12.self_attention.linear_qkv.bias
	vision_model.decoder.layers.9.pre_mlp_layernorm.weight
	vision_model.decoder.layers.7.self_attention.linear_qkv.bias
	vision_model.decoder.layers.5.self_attention.linear_proj.weight
	vision_model.decoder.layers.4.self_attention.linear_proj.weight
	vision_model.decoder.layers.3.self_attention.linear_proj.bias
	vision_model.decoder.layers.2.self_attention.linear_proj.weight
	vision_projection.encoder.linear_fc2.weight
	vision_model.decoder.layers.11.input_layernorm.weight
	vision_model.decoder.layers.10.input_layernorm.weight
	vision_model.decoder.layers.7.mlp.linear_fc1.bias
	vision_model.decoder.layers.6.mlp.linear_fc1.weight
	vision_model.decoder.layers.5.mlp.linear_fc1.bias
	vision_model.decoder.layers.4.pre_mlp_layernorm.bias
	vision_model.decoder.layers.3.pre_mlp_layernorm.bias
	vision_model.decoder.layers.3.input_layernorm.weight
	vision_model.decoder.layers.0.mlp.linear_fc2.weight
	vision_model.decoder.layers.12.pre_mlp_layernorm.bias
	vision_model.decoder.layers.12.input_layernorm.bias
	vision_model.decoder.layers.11.mlp.linear_fc2.bias
	vision_model.decoder.layers.10.mlp.linear_fc2.bias
	vision_model.decoder.layers.5.input_layernorm.bias
	vision_model.decoder.layers.4.input_layernorm.bias
	vision_model.decoder.layers.9.mlp.linear_fc2.bias
	vision_model.decoder.layers.12.self_attention.linear_proj.bias
	vision_model.decoder.layers.11.self_attention.linear_proj.weight
	vision_model.decoder.layers.10.self_attention.linear_proj.weight
	vision_model.decoder.layers.6.self_attention.linear_qkv.bias
	vision_model.decoder.layers.4.mlp.linear_fc2.weight
	vision_model.decoder.layers.3.mlp.linear_fc2.weight
	vision_model.decoder.layers.2.self_attention.linear_qkv.bias
	vision_model.decoder.layers.1.self_attention.linear_qkv.bias
	vision_model.decoder.layers.0.self_attention.linear_qkv.bias
	vision_model.decoder.layers.10.pre_mlp_layernorm.weight
	vision_model.decoder.layers.9.pre_mlp_layernorm.bias
	vision_model.decoder.layers.8.self_attention.linear_qkv.bias
	vision_model.decoder.layers.7.self_attention.linear_qkv.weight
	vision_model.decoder.layers.6.self_attention.linear_qkv.weight
	vision_model.decoder.layers.5.self_attention.linear_qkv.bias
	vision_model.decoder.layers.2.input_layernorm.bias
	vision_model.decoder.layers.0.mlp.linear_fc1.bias
	vision_model.decoder.layers.13.self_attention.linear_proj.bias
	vision_model.decoder.layers.11.input_layernorm.bias
	vision_model.decoder.layers.10.input_layernorm.bias
	vision_model.decoder.layers.8.mlp.linear_fc1.bias
	vision_model.decoder.layers.7.mlp.linear_fc1.weight
	vision_model.decoder.layers.5.mlp.linear_fc1.weight
	vision_model.decoder.layers.1.self_attention.linear_proj.bias
	vision_model.decoder.layers.0.self_attention.linear_qkv.weight
	vision_model.decoder.layers.0.mlp.linear_fc2.bias
	vision_model.decoder.layers.13.input_layernorm.weight
	vision_model.decoder.layers.12.self_attention.linear_proj.weight
	vision_model.decoder.layers.10.mlp.linear_fc2.weight
	vision_model.decoder.layers.9.mlp.linear_fc2.weight
	vision_model.decoder.layers.0.mlp.linear_fc1.weight
	vision_model.decoder.layers.0.pre_mlp_layernorm.bias
	vision_model.decoder.layers.12.mlp.linear_fc2.bias
	vision_model.decoder.layers.11.mlp.linear_fc1.bias
	vision_model.decoder.layers.10.pre_mlp_layernorm.bias
	vision_model.decoder.layers.9.self_attention.linear_qkv.bias
	vision_model.decoder.layers.8.self_attention.linear_qkv.weight
	vision_model.decoder.layers.3.self_attention.linear_qkv.bias
	vision_model.decoder.layers.2.mlp.linear_fc1.bias
	vision_model.decoder.layers.1.input_layernorm.bias
	vision_model.decoder.layers.13.self_attention.linear_proj.weight
	vision_model.decoder.layers.12.pre_mlp_layernorm.weight
	vision_model.decoder.layers.8.mlp.linear_fc1.weight
	vision_model.decoder.layers.4.mlp.linear_fc1.bias
	vision_model.decoder.layers.3.mlp.linear_fc1.bias
	vision_model.decoder.layers.13.pre_mlp_layernorm.weight
	vision_model.decoder.layers.7.self_attention.linear_proj.bias
	vision_model.decoder.layers.13.input_layernorm.bias
	vision_model.decoder.layers.11.mlp.linear_fc2.weight
	vision_model.decoder.layers.6.pre_mlp_layernorm.weight
	vision_model.decoder.layers.2.self_attention.linear_proj.bias
	vision_model.decoder.layers.1.mlp.linear_fc1.bias
	vision_model.decoder.layers.7.input_layernorm.weight
	vision_model.decoder.layers.1.input_layernorm.weight
	vision_model.decoder.layers.0.self_attention.linear_proj.bias
	vision_model.decoder.layers.13.mlp.linear_fc2.bias
	vision_model.decoder.layers.12.mlp.linear_fc2.weight
	vision_model.decoder.layers.11.mlp.linear_fc1.weight
	vision_model.decoder.layers.9.self_attention.linear_qkv.weight
	vision_model.decoder.layers.5.self_attention.linear_qkv.weight
	vision_model.decoder.layers.4.self_attention.linear_qkv.bias
	vision_model.decoder.layers.3.self_attention.linear_qkv.weight
	vision_model.decoder.layers.2.pre_mlp_layernorm.weight
	vision_model.decoder.layers.1.pre_mlp_layernorm.bias
	vision_model.decoder.layers.0.input_layernorm.bias
	vision_model.decoder.layers.6.mlp.linear_fc2.bias
	vision_model.decoder.layers.4.mlp.linear_fc1.weight
	vision_model.decoder.layers.3.mlp.linear_fc1.weight
	vision_model.decoder.layers.13.pre_mlp_layernorm.bias
	vision_model.decoder.layers.8.self_attention.linear_proj.bias
	vision_model.decoder.layers.7.self_attention.linear_proj.weight
	vision_model.decoder.layers.6.self_attention.linear_proj.bias
	vision_model.decoder.layers.3.input_layernorm.bias
	vision_model.decoder.layers.2.mlp.linear_fc2.weight
	vision_projection.encoder.linear_fc1.weight
	vision_model.decoder.layers.7.pre_mlp_layernorm.weight
	vision_model.decoder.layers.6.pre_mlp_layernorm.bias
	vision_model.decoder.layers.5.pre_mlp_layernorm.weight
	vision_model.decoder.layers.0.pre_mlp_layernorm.weight
	vision_model.decoder.layers.11.self_attention.linear_qkv.bias
	vision_model.decoder.layers.10.self_attention.linear_qkv.bias
	vision_model.decoder.layers.8.input_layernorm.weight
	vision_model.decoder.layers.7.input_layernorm.bias
	vision_model.decoder.layers.6.input_layernorm.weight
	vision_model.decoder.layers.13.mlp.linear_fc2.weight
	vision_model.decoder.layers.10.mlp.linear_fc1.bias
	vision_model.decoder.layers.9.mlp.linear_fc1.weight
	vision_model.decoder.layers.4.self_attention.linear_qkv.weight
	vision_model.decoder.layers.7.mlp.linear_fc2.bias
	vision_model.decoder.layers.6.mlp.linear_fc2.weight
	vision_model.decoder.layers.5.mlp.linear_fc2.bias
	vision_model.decoder.layers.2.mlp.linear_fc1.weight
	vision_model.decoder.layers.12.input_layernorm.weight
	vision_model.decoder.layers.9.self_attention.linear_proj.bias
	vision_model.decoder.layers.8.self_attention.linear_proj.weight
	vision_model.decoder.layers.6.self_attention.linear_proj.weight
	vision_model.decoder.layers.2.self_attention.linear_qkv.weight
	vision_model.decoder.layers.1.pre_mlp_layernorm.weight
	vision_model.decoder.layers.1.self_attention.linear_proj.weight
	vision_model.decoder.layers.0.self_attention.linear_proj.weight
	vision_model.decoder.layers.8.pre_mlp_layernorm.weight
	vision_model.decoder.layers.7.pre_mlp_layernorm.bias
	vision_model.decoder.layers.5.pre_mlp_layernorm.bias
	vision_model.decoder.layers.2.pre_mlp_layernorm.bias
	vision_model.decoder.layers.2.input_layernorm.weight
	vision_model.decoder.layers.11.self_attention.linear_qkv.weight
	vision_model.decoder.layers.10.self_attention.linear_qkv.weight
	vision_model.decoder.layers.8.input_layernorm.bias
	vision_model.decoder.layers.9.input_layernorm.weight
	vision_model.decoder.layers.6.input_layernorm.bias
	vision_model.decoder.layers.1.mlp.linear_fc2.weight
	vision_model.decoder.layers.12.self_attention.linear_qkv.weight
	vision_model.decoder.layers.10.mlp.linear_fc1.weight
	vision_model.decoder.layers.9.mlp.linear_fc1.bias
	vision_model.decoder.layers.8.mlp.linear_fc2.bias
	vision_model.decoder.layers.7.mlp.linear_fc2.weight
	vision_model.decoder.layers.13.self_attention.linear_qkv.bias
	vision_model.decoder.layers.5.mlp.linear_fc2.weight
	vision_model.decoder.layers.1.mlp.linear_fc1.weight
	vision_model.decoder.layers.0.input_layernorm.weight
	vision_model.decoder.layers.13.mlp.linear_fc1.bias
	vision_model.decoder.layers.12.mlp.linear_fc1.weight
	vision_model.decoder.layers.9.self_attention.linear_proj.weight
	vision_model.decoder.layers.5.self_attention.linear_proj.bias
	vision_model.decoder.layers.4.self_attention.linear_proj.bias
	vision_model.decoder.layers.3.self_attention.linear_proj.weight
	vision_model.decoder.layers.11.pre_mlp_layernorm.weight
	vision_model.decoder.layers.8.pre_mlp_layernorm.bias
	vision_model.decoder.layers.6.mlp.linear_fc1.bias
	vision_model.decoder.layers.4.pre_mlp_layernorm.weight
	vision_model.decoder.layers.3.pre_mlp_layernorm.weight
	vision_model.decoder.layers.2.mlp.linear_fc2.bias
	vision_model.decoder.layers.11.pre_mlp_layernorm.bias
	vision_model.decoder.layers.9.input_layernorm.bias
	vision_model.decoder.layers.5.input_layernorm.weight
	vision_model.decoder.layers.4.input_layernorm.weight
	vision_model.decoder.layers.1.mlp.linear_fc2.bias
rank=1, worker=0: shard_range=[pretrain-2.tar[5000, 5100), pretrain-2.tar[5100, 5200), pretrain-2.tar[5200, 5300), ...<619>, pretrain-25.tar[7200, 7300), pretrain-25.tar[7300, 7400), pretrain-25.tar[7400, 7500)] sum(count)=62500
rank=1, worker=1: shard_range=[pretrain-25.tar[7500, 7600), pretrain-25.tar[7600, 7700), pretrain-25.tar[7700, 7800), ...<619>, pretrain-30.tar[9700, 9800), pretrain-30.tar[9800, 9900), pretrain-30.tar[9900, 10000)] sum(count)=62500
rank=3, worker=0: shard_range=[pretrain-42.tar[5000, 5100), pretrain-42.tar[5100, 5200), pretrain-42.tar[5200, 5300), ...<619>, pretrain-48.tar[7200, 7300), pretrain-48.tar[7300, 7400), pretrain-48.tar[7400, 7500)] sum(count)=62500
rank=3, worker=1: shard_range=[pretrain-48.tar[7500, 7600), pretrain-48.tar[7600, 7700), pretrain-48.tar[7700, 7800), ...<619>, pretrain-53.tar[9700, 9800), pretrain-53.tar[9800, 9900), pretrain-53.tar[9900, 10000)] sum(count)=62500
rank=2, worker=0: shard_range=[pretrain-31.tar[0, 100), pretrain-31.tar[100, 200), pretrain-31.tar[200, 300), ...<619>, pretrain-37.tar[2200, 2300), pretrain-37.tar[2300, 2400), pretrain-37.tar[2400, 2500)] sum(count)=62500
rank=2, worker=1: shard_range=[pretrain-37.tar[2500, 2600), pretrain-37.tar[2600, 2700), pretrain-37.tar[2700, 2800), ...<619>, pretrain-42.tar[4700, 4800), pretrain-42.tar[4800, 4900), pretrain-42.tar[4900, 5000)] sum(count)=62500
rank=0, worker=0: shard_range=[pretrain-0.tar[0, 100), pretrain-0.tar[100, 200), pretrain-0.tar[200, 300), ...<619>, pretrain-14.tar[2200, 2300), pretrain-14.tar[2300, 2400), pretrain-14.tar[2400, 2500)] sum(count)=62500
rank=0, worker=1: shard_range=[pretrain-14.tar[2500, 2600), pretrain-14.tar[2600, 2700), pretrain-14.tar[2700, 2800), ...<619>, pretrain-2.tar[4700, 4800), pretrain-2.tar[4800, 4900), pretrain-2.tar[4900, 5000)] sum(count)=62500
rank=1, worker=0: shard_range=[pretrain-55.tar[4532, 8128), pretrain-6.tar[0, 3670)] sum(count)=7266
rank=1, worker=1: shard_range=[pretrain-6.tar[3670, 10000), pretrain-7.tar[0, 936)] sum(count)=7266
rank=3, worker=0: shard_range=[pretrain-8.tar[5468, 10000), pretrain-9.tar[0, 2734)] sum(count)=7266
rank=3, worker=1: shard_range=[pretrain-9.tar[2734, 10000)] sum(count)=7266
rank=0, worker=0: shard_range=[pretrain-54.tar[0, 7266)] sum(count)=7266
rank=0, worker=1: shard_range=[pretrain-54.tar[7266, 10000), pretrain-55.tar[0, 4532)] sum(count)=7266
rank=2, worker=0: shard_range=[pretrain-7.tar[936, 8202)] sum(count)=7266
rank=2, worker=1: shard_range=[pretrain-7.tar[8202, 10000), pretrain-8.tar[0, 5468)] sum(count)=7266
Traceback (most recent call last):
  File "/gf3/home/fjs/project/MLLM/Megatron-LM-core_r0.9.0/examples/multimodal/train.py", line 456, in <module>
Traceback (most recent call last):
  File "/gf3/home/fjs/project/MLLM/Megatron-LM-core_r0.9.0/examples/multimodal/train.py", line 456, in <module>
Traceback (most recent call last):
  File "/gf3/home/fjs/project/MLLM/Megatron-LM-core_r0.9.0/examples/multimodal/train.py", line 456, in <module>
    pretrain(
  File "/gf3/home/fjs/project/MLLM/Megatron-LM-core_r0.9.0/megatron/training/training.py", line 407, in pretrain
    pretrain(
  File "/gf3/home/fjs/project/MLLM/Megatron-LM-core_r0.9.0/megatron/training/training.py", line 407, in pretrain
Traceback (most recent call last):
    pretrain(  File "/gf3/home/fjs/project/MLLM/Megatron-LM-core_r0.9.0/examples/multimodal/train.py", line 456, in <module>

  File "/gf3/home/fjs/project/MLLM/Megatron-LM-core_r0.9.0/megatron/training/training.py", line 407, in pretrain
    pretrain(
  File "/gf3/home/fjs/project/MLLM/Megatron-LM-core_r0.9.0/megatron/training/training.py", line 407, in pretrain
    iteration, num_floating_point_operations_so_far = train( # 调用 1172 行进行训练
  File "/gf3/home/fjs/project/MLLM/Megatron-LM-core_r0.9.0/megatron/training/training.py", line 1375, in train
    iteration, num_floating_point_operations_so_far = train( # 调用 1172 行进行训练
  File "/gf3/home/fjs/project/MLLM/Megatron-LM-core_r0.9.0/megatron/training/training.py", line 1375, in train
    iteration, num_floating_point_operations_so_far = train( # 调用 1172 行进行训练
  File "/gf3/home/fjs/project/MLLM/Megatron-LM-core_r0.9.0/megatron/training/training.py", line 1375, in train
    iteration, num_floating_point_operations_so_far = train( # 调用 1172 行进行训练
  File "/gf3/home/fjs/project/MLLM/Megatron-LM-core_r0.9.0/megatron/training/training.py", line 1375, in train
    train_step(forward_step_func, # 调用 805 行
  File "/gf3/home/fjs/project/MLLM/Megatron-LM-core_r0.9.0/megatron/training/training.py", line 854, in train_step
        train_step(forward_step_func, # 调用 805 行train_step(forward_step_func, # 调用 805 行

  File "/gf3/home/fjs/project/MLLM/Megatron-LM-core_r0.9.0/megatron/training/training.py", line 854, in train_step
  File "/gf3/home/fjs/project/MLLM/Megatron-LM-core_r0.9.0/megatron/training/training.py", line 854, in train_step
    train_step(forward_step_func, # 调用 805 行
  File "/gf3/home/fjs/project/MLLM/Megatron-LM-core_r0.9.0/megatron/training/training.py", line 854, in train_step
    losses_reduced = forward_backward_func( # schedules.py 1345 行 forward_backward_pipelining_without_interleaving
  File "/gf3/home/fjs/project/MLLM/Megatron-LM-core_r0.9.0/megatron/core/pipeline_parallel/schedules.py", line 1472, in forward_backward_pipelining_without_interleaving
    losses_reduced = forward_backward_func( # schedules.py 1345 行 forward_backward_pipelining_without_interleaving
  File "/gf3/home/fjs/project/MLLM/Megatron-LM-core_r0.9.0/megatron/core/pipeline_parallel/schedules.py", line 1472, in forward_backward_pipelining_without_interleaving
    losses_reduced = forward_backward_func( # schedules.py 1345 行 forward_backward_pipelining_without_interleaving
  File "/gf3/home/fjs/project/MLLM/Megatron-LM-core_r0.9.0/megatron/core/pipeline_parallel/schedules.py", line 1472, in forward_backward_pipelining_without_interleaving
    losses_reduced = forward_backward_func( # schedules.py 1345 行 forward_backward_pipelining_without_interleaving
  File "/gf3/home/fjs/project/MLLM/Megatron-LM-core_r0.9.0/megatron/core/pipeline_parallel/schedules.py", line 1472, in forward_backward_pipelining_without_interleaving
    input_tensor = recv_forward(recv_tensor_shapes, config)
  File "/gf3/home/fjs/project/MLLM/Megatron-LM-core_r0.9.0/megatron/core/pipeline_parallel/schedules.py", line 1280, in recv_forward
    input_tensor = recv_forward(recv_tensor_shapes, config)
  File "/gf3/home/fjs/project/MLLM/Megatron-LM-core_r0.9.0/megatron/core/pipeline_parallel/schedules.py", line 1280, in recv_forward
    input_tensor = recv_forward(recv_tensor_shapes, config)
  File "/gf3/home/fjs/project/MLLM/Megatron-LM-core_r0.9.0/megatron/core/pipeline_parallel/schedules.py", line 1280, in recv_forward
    input_tensor = recv_forward(recv_tensor_shapes, config)
  File "/gf3/home/fjs/project/MLLM/Megatron-LM-core_r0.9.0/megatron/core/pipeline_parallel/schedules.py", line 1280, in recv_forward
    input_tensors.append(p2p_communication.recv_forward(tensor_shape, config))
  File "/gf3/home/fjs/project/MLLM/Megatron-LM-core_r0.9.0/megatron/core/pipeline_parallel/p2p_communication.py", line 421, in recv_forward
    input_tensors.append(p2p_communication.recv_forward(tensor_shape, config))
  File "/gf3/home/fjs/project/MLLM/Megatron-LM-core_r0.9.0/megatron/core/pipeline_parallel/p2p_communication.py", line 421, in recv_forward
    input_tensors.append(p2p_communication.recv_forward(tensor_shape, config))
  File "/gf3/home/fjs/project/MLLM/Megatron-LM-core_r0.9.0/megatron/core/pipeline_parallel/p2p_communication.py", line 421, in recv_forward
    input_tensors.append(p2p_communication.recv_forward(tensor_shape, config))
  File "/gf3/home/fjs/project/MLLM/Megatron-LM-core_r0.9.0/megatron/core/pipeline_parallel/p2p_communication.py", line 421, in recv_forward
    input_tensor, _, _ = _communicate(
  File "/gf3/home/fjs/project/MLLM/Megatron-LM-core_r0.9.0/megatron/core/pipeline_parallel/p2p_communication.py", line 370, in _communicate
    input_tensor, _, _ = _communicate(
  File "/gf3/home/fjs/project/MLLM/Megatron-LM-core_r0.9.0/megatron/core/pipeline_parallel/p2p_communication.py", line 370, in _communicate
        input_tensor, _, _ = _communicate(input_tensor, _, _ = _communicate(

  File "/gf3/home/fjs/project/MLLM/Megatron-LM-core_r0.9.0/megatron/core/pipeline_parallel/p2p_communication.py", line 370, in _communicate
  File "/gf3/home/fjs/project/MLLM/Megatron-LM-core_r0.9.0/megatron/core/pipeline_parallel/p2p_communication.py", line 370, in _communicate
    p2p_func(
      File "/gf3/home/fjs/project/MLLM/Megatron-LM-core_r0.9.0/megatron/core/pipeline_parallel/p2p_communication.py", line 153, in _batched_p2p_ops
p2p_func(
  File "/gf3/home/fjs/project/MLLM/Megatron-LM-core_r0.9.0/megatron/core/pipeline_parallel/p2p_communication.py", line 153, in _batched_p2p_ops
        p2p_func(p2p_func(

  File "/gf3/home/fjs/project/MLLM/Megatron-LM-core_r0.9.0/megatron/core/pipeline_parallel/p2p_communication.py", line 153, in _batched_p2p_ops
  File "/gf3/home/fjs/project/MLLM/Megatron-LM-core_r0.9.0/megatron/core/pipeline_parallel/p2p_communication.py", line 153, in _batched_p2p_ops
    reqs = torch.distributed.batch_isend_irecv(ops)
  File "/gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py", line 1865, in batch_isend_irecv
    reqs = torch.distributed.batch_isend_irecv(ops)
      File "/gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py", line 1865, in batch_isend_irecv
reqs = torch.distributed.batch_isend_irecv(ops)
  File "/gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py", line 1865, in batch_isend_irecv
    reqs = torch.distributed.batch_isend_irecv(ops)
  File "/gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py", line 1865, in batch_isend_irecv
    p2p_op.op(p2p_op.tensor, p2p_op.peer, p2p_op.group, p2p_op.tag)
      File "/gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py", line 1631, in irecv
p2p_op.op(p2p_op.tensor, p2p_op.peer, p2p_op.group, p2p_op.tag)
          File "/gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py", line 1631, in irecv
p2p_op.op(p2p_op.tensor, p2p_op.peer, p2p_op.group, p2p_op.tag)p2p_op.op(p2p_op.tensor, p2p_op.peer, p2p_op.group, p2p_op.tag)

  File "/gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py", line 1631, in irecv
  File "/gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py", line 1631, in irecv
    return pg.recv([tensor], group_src_rank, tag)
torch.distributed.    DistBackendErrorreturn pg.recv([tensor], group_src_rank, tag): 
[1] is setting up NCCL communicator and retrieving ncclUniqueId from [0] via c10d key-value store by key '0', but store->get('0') got error: Connection reset by peer
Exception raised from recvBytes at ../torch/csrc/distributed/c10d/Utils.hpp:670 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7fdc40a09d87 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5894fde (0x7fdc7c702fde in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0x360 (0x7fdc7c6fd7f0 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #3: c10d::TCPStore::doGet(std::string const&) + 0x32 (0x7fdc7c6fdb32 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::get(std::string const&) + 0xa1 (0x7fdc7c6fe961 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x7fdc7c6b3dd1 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x7fdc7c6b3dd1 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x7fdc7c6b3dd1 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #8: c10d::PrefixStore::get(std::string const&) + 0x31 (0x7fdc7c6b3dd1 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #9: c10d::PrefixStore::get(std::string const&) + 0x31 (0x7fdc7c6b3dd1 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #10: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, std::string const&, int) + 0xa9 (0x7fdc41b854e9 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #11: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, std::vector<c10::Device, std::allocator<c10::Device> > const&, c10d::OpType, int, bool) + 0x22b (0x7fdc41b8c4db in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #12: c10d::ProcessGroupNCCL::recv(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) + 0x550 (0x7fdc41baf3e0 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #13: <unknown function> + 0x5838289 (0x7fdc7c6a6289 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #14: <unknown function> + 0x5843180 (0x7fdc7c6b1180 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0x5843215 (0x7fdc7c6b1215 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #16: <unknown function> + 0x4e8937c (0x7fdc7bcf737c in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #17: <unknown function> + 0x1a08a38 (0x7fdc78876a38 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #18: <unknown function> + 0x58498d4 (0x7fdc7c6b78d4 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #19: <unknown function> + 0x584eb85 (0x7fdc7c6bcb85 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #20: <unknown function> + 0xc99c3e (0x7fdc8ef67c3e in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
frame #21: <unknown function> + 0x413f64 (0x7fdc8e6e1f64 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
frame #22: <unknown function> + 0x1457e6 (0x557fcf9ef7e6 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #23: _PyObject_MakeTpCall + 0x26b (0x557fcf9e89db in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #24: <unknown function> + 0x151ec6 (0x557fcf9fbec6 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #25: _PyEval_EvalFrameDefault + 0x4c1a (0x557fcf9e3f2a in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #26: _PyFunction_Vectorcall + 0x6c (0x557fcf9efc6c in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #27: _PyEval_EvalFrameDefault + 0x4c1a (0x557fcf9e3f2a in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #28: _PyFunction_Vectorcall + 0x6c (0x557fcf9efc6c in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #29: _PyEval_EvalFrameDefault + 0x4c1a (0x557fcf9e3f2a in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #30: _PyFunction_Vectorcall + 0x6c (0x557fcf9efc6c in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #31: _PyEval_EvalFrameDefault + 0x13cc (0x557fcf9e06dc in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #32: _PyFunction_Vectorcall + 0x6c (0x557fcf9efc6c in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #33: _PyEval_EvalFrameDefault + 0x13cc (0x557fcf9e06dc in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #34: _PyFunction_Vectorcall + 0x6c (0x557fcf9efc6c in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #35: _PyEval_EvalFrameDefault + 0x4c1a (0x557fcf9e3f2a in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #36: _PyFunction_Vectorcall + 0x6c (0x557fcf9efc6c in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #37: _PyEval_EvalFrameDefault + 0x320 (0x557fcf9df630 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #38: _PyFunction_Vectorcall + 0x6c (0x557fcf9efc6c in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #39: _PyEval_EvalFrameDefault + 0x13cc (0x557fcf9e06dc in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #40: _PyFunction_Vectorcall + 0x6c (0x557fcf9efc6c in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #41: _PyEval_EvalFrameDefault + 0x320 (0x557fcf9df630 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #42: _PyFunction_Vectorcall + 0x6c (0x557fcf9efc6c in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #43: _PyEval_EvalFrameDefault + 0x320 (0x557fcf9df630 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #44: _PyFunction_Vectorcall + 0x6c (0x557fcf9efc6c in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #45: _PyEval_EvalFrameDefault + 0x13cc (0x557fcf9e06dc in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #46: <unknown function> + 0x1da820 (0x557fcfa84820 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #47: PyEval_EvalCode + 0x87 (0x557fcfa84767 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #48: <unknown function> + 0x20ac2a (0x557fcfab4c2a in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #49: <unknown function> + 0x206023 (0x557fcfab0023 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #50: <unknown function> + 0x9a558 (0x557fcf944558 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #51: _PyRun_SimpleFileObject + 0x1ae (0x557fcfaaa50e in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #52: _PyRun_AnyFileObject + 0x44 (0x557fcfaaa0a4 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #53: Py_RunMain + 0x38b (0x557fcfaa729b in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #54: Py_BytesMain + 0x37 (0x557fcfa78257 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #55: __libc_start_main + 0xe7 (0x7fdc90e00c87 in /lib/x86_64-linux-gnu/libc.so.6)
frame #56: <unknown function> + 0x1ce151 (0x557fcfa78151 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
. This may indicate a possible application crash on rank 0 or a network set up issue.torch.distributed
.DistBackendError: [1] is setting up NCCL communicator and retrieving ncclUniqueId from [0] via c10d key-value store by key '0', but store->get('0') got error: Connection reset by peer
Exception raised from recvBytes at ../torch/csrc/distributed/c10d/Utils.hpp:670 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7fdcd8b20d87 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5894fde (0x7fdd14819fde in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0x360 (0x7fdd148147f0 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #3: c10d::TCPStore::doGet(std::string const&) + 0x32 (0x7fdd14814b32 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::get(std::string const&) + 0xa1 (0x7fdd14815961 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x7fdd147cadd1 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x7fdd147cadd1 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x7fdd147cadd1 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #8: c10d::PrefixStore::get(std::string const&) + 0x31 (0x7fdd147cadd1 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #9: c10d::PrefixStore::get(std::string const&) + 0x31 (0x7fdd147cadd1 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #10: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, std::string const&, int) + 0xa9 (0x7fdcd9c9c4e9 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #11: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, std::vector<c10::Device, std::allocator<c10::Device> > const&, c10d::OpType, int, bool) + 0x22b (0x7fdcd9ca34db in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #12: c10d::ProcessGroupNCCL::recv(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) + 0x550 (0x7fdcd9cc63e0 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #13: <unknown function> + 0x5838289 (0x7fdd147bd289 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #14: <unknown function> + 0x5843180 (0x7fdd147c8180 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0x5843215 (0x7fdd147c8215 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #16: <unknown function> + 0x4e8937c (0x7fdd13e0e37c in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #17: <unknown function> + 0x1a08a38 (0x7fdd1098da38 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #18: <unknown function> + 0x58498d4 (0x7fdd147ce8d4 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #19: <unknown function> + 0x584eb85 (0x7fdd147d3b85 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #20: <unknown function> + 0xc99c3e (0x7fdd2707ec3e in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
frame #21: <unknown function> + 0x413f64 (0x7fdd267f8f64 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
frame #22: <unknown function> + 0x1457e6 (0x55b36cedc7e6 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #23: _PyObject_MakeTpCall + 0x26b (0x55b36ced59db in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #24: <unknown function> + 0x151ec6 (0x55b36cee8ec6 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #25: _PyEval_EvalFrameDefault + 0x4c1a (0x55b36ced0f2a in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #26: _PyFunction_Vectorcall + 0x6c (0x55b36cedcc6c in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #27: _PyEval_EvalFrameDefault + 0x4c1a (0x55b36ced0f2a in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #28: _PyFunction_Vectorcall + 0x6c (0x55b36cedcc6c in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #29: _PyEval_EvalFrameDefault + 0x4c1a (0x55b36ced0f2a in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #30: _PyFunction_Vectorcall + 0x6c (0x55b36cedcc6c in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #31: _PyEval_EvalFrameDefault + 0x13cc (0x55b36cecd6dc in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #32: _PyFunction_Vectorcall + 0x6c (0x55b36cedcc6c in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #33: _PyEval_EvalFrameDefault + 0x13cc (0x55b36cecd6dc in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #34: _PyFunction_Vectorcall + 0x6c (0x55b36cedcc6c in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #35: _PyEval_EvalFrameDefault + 0x4c1a (0x55b36ced0f2a in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #36: _PyFunction_Vectorcall + 0x6c (0x55b36cedcc6c in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #37: _PyEval_EvalFrameDefault + 0x320 (0x55b36cecc630 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #38: _PyFunction_Vectorcall + 0x6c (0x55b36cedcc6c in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #39: _PyEval_EvalFrameDefault + 0x13cc (0x55b36cecd6dc in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #40: _PyFunction_Vectorcall + 0x6c (0x55b36cedcc6c in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #41: _PyEval_EvalFrameDefault + 0x320 (0x55b36cecc630 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #42: _PyFunction_Vectorcall + 0x6c (0x55b36cedcc6c in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #43: _PyEval_EvalFrameDefault + 0x320 (0x55b36cecc630 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #44: _PyFunction_Vectorcall + 0x6c (0x55b36cedcc6c in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #45: _PyEval_EvalFrameDefault + 0x13cc (0x55b36cecd6dc in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #46: <unknown function> + 0x1da820 (0x55b36cf71820 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #47: PyEval_EvalCode + 0x87 (0x55b36cf71767 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #48: <unknown function> + 0x20ac2a (0x55b36cfa1c2a in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #49: <unknown function> + 0x206023 (0x55b36cf9d023 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #50: <unknown function> + 0x9a558 (0x55b36ce31558 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #51: _PyRun_SimpleFileObject + 0x1ae (0x55b36cf9750e in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #52: _PyRun_AnyFileObject + 0x44 (0x55b36cf970a4 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #53: Py_RunMain + 0x38b (0x55b36cf9429b in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #54: Py_BytesMain + 0x37 (0x55b36cf65257 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #55: __libc_start_main + 0xe7 (0x7fdd28f17c87 in /lib/x86_64-linux-gnu/libc.so.6)
frame #56: <unknown function> + 0x1ce151 (0x55b36cf65151 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
. This may indicate a possible application crash on rank 0 or a network set up issue.
    return pg.recv([tensor], group_src_rank, tag)
torch.distributed.DistBackendError: [1] is setting up NCCL communicator and retrieving ncclUniqueId from [0] via c10d key-value store by key '0', but store->get('0') got error: Connection reset by peer
Exception raised from recvBytes at ../torch/csrc/distributed/c10d/Utils.hpp:670 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7fceaa25cd87 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5894fde (0x7fcee5f55fde in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0x360 (0x7fcee5f507f0 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #3: c10d::TCPStore::doGet(std::string const&) + 0x32 (0x7fcee5f50b32 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::get(std::string const&) + 0xa1 (0x7fcee5f51961 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x7fcee5f06dd1 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x7fcee5f06dd1 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x7fcee5f06dd1 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #8: c10d::PrefixStore::get(std::string const&) + 0x31 (0x7fcee5f06dd1 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #9: c10d::PrefixStore::get(std::string const&) + 0x31 (0x7fcee5f06dd1 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #10: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, std::string const&, int) + 0xa9 (0x7fceab3d84e9 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #11: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, std::vector<c10::Device, std::allocator<c10::Device> > const&, c10d::OpType, int, bool) + 0x22b (0x7fceab3df4db in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #12: c10d::ProcessGroupNCCL::recv(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) + 0x550 (0x7fceab4023e0 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #13: <unknown function> + 0x5838289 (0x7fcee5ef9289 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #14: <unknown function> + 0x5843180 (0x7fcee5f04180 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0x5843215 (0x7fcee5f04215 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #16: <unknown function> + 0x4e8937c (0x7fcee554a37c in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #17: <unknown function> + 0x1a08a38 (0x7fcee20c9a38 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #18: <unknown function> + 0x58498d4 (0x7fcee5f0a8d4 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #19: <unknown function> + 0x584eb85 (0x7fcee5f0fb85 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #20: <unknown function> + 0xc99c3e (0x7fcef87bac3e in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
frame #21: <unknown function> + 0x413f64 (0x7fcef7f34f64 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
frame #22: <unknown function> + 0x1457e6 (0x565046cf67e6 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #23: _PyObject_MakeTpCall + 0x26b (0x565046cef9db in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #24: <unknown function> + 0x151ec6 (0x565046d02ec6 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #25: _PyEval_EvalFrameDefault + 0x4c1a (0x565046ceaf2a in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #26: _PyFunction_Vectorcall + 0x6c (0x565046cf6c6c in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #27: _PyEval_EvalFrameDefault + 0x4c1a (0x565046ceaf2a in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #28: _PyFunction_Vectorcall + 0x6c (0x565046cf6c6c in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #29: _PyEval_EvalFrameDefault + 0x4c1a (0x565046ceaf2a in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #30: _PyFunction_Vectorcall + 0x6c (0x565046cf6c6c in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #31: _PyEval_EvalFrameDefault + 0x13cc (0x565046ce76dc in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #32: _PyFunction_Vectorcall + 0x6c (0x565046cf6c6c in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #33: _PyEval_EvalFrameDefault + 0x13cc (0x565046ce76dc in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #34: _PyFunction_Vectorcall + 0x6c (0x565046cf6c6c in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #35: _PyEval_EvalFrameDefault + 0x4c1a (0x565046ceaf2a in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #36: _PyFunction_Vectorcall + 0x6c (0x565046cf6c6c in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #37: _PyEval_EvalFrameDefault + 0x320 (0x565046ce6630 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #38: _PyFunction_Vectorcall + 0x6c (0x565046cf6c6c in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #39: _PyEval_EvalFrameDefault + 0x13cc (0x565046ce76dc in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #40: _PyFunction_Vectorcall + 0x6c (0x565046cf6c6c in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #41: _PyEval_EvalFrameDefault + 0x320 (0x565046ce6630 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #42: _PyFunction_Vectorcall + 0x6c (0x565046cf6c6c in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #43: _PyEval_EvalFrameDefault + 0x320 (0x565046ce6630 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #44: _PyFunction_Vectorcall + 0x6c (0x565046cf6c6c in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #45: _PyEval_EvalFrameDefault + 0x13cc (0x565046ce76dc in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #46: <unknown function> + 0x1da820 (0x565046d8b820 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #47: PyEval_EvalCode + 0x87 (0x565046d8b767 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #48: <unknown function> + 0x20ac2a (0x565046dbbc2a in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #49: <unknown function> + 0x206023 (0x565046db7023 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #50: <unknown function> + 0x9a558 (0x565046c4b558 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #51: _PyRun_SimpleFileObject + 0x1ae (0x565046db150e in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #52: _PyRun_AnyFileObject + 0x44 (0x565046db10a4 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #53: Py_RunMain + 0x38b (0x565046dae29b in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #54: Py_BytesMain + 0x37 (0x565046d7f257 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #55: __libc_start_main + 0xe7 (0x7fcefa653c87 in /lib/x86_64-linux-gnu/libc.so.6)
frame #56: <unknown function> + 0x1ce151 (0x565046d7f151 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
. This may indicate a possible application crash on rank 0 or a network set up issue.
    return pg.recv([tensor], group_src_rank, tag)
torch.distributed.DistBackendError: [1] is setting up NCCL communicator and retrieving ncclUniqueId from [0] via c10d key-value store by key '0', but store->get('0') got error: Connection reset by peer
Exception raised from recvBytes at ../torch/csrc/distributed/c10d/Utils.hpp:670 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 (0x7fdc60e4dd87 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x5894fde (0x7fdc9cb46fde in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0x360 (0x7fdc9cb417f0 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #3: c10d::TCPStore::doGet(std::string const&) + 0x32 (0x7fdc9cb41b32 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::get(std::string const&) + 0xa1 (0x7fdc9cb42961 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x7fdc9caf7dd1 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x7fdc9caf7dd1 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x7fdc9caf7dd1 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #8: c10d::PrefixStore::get(std::string const&) + 0x31 (0x7fdc9caf7dd1 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #9: c10d::PrefixStore::get(std::string const&) + 0x31 (0x7fdc9caf7dd1 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #10: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, std::string const&, int) + 0xa9 (0x7fdc61fc94e9 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #11: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, std::vector<c10::Device, std::allocator<c10::Device> > const&, c10d::OpType, int, bool) + 0x22b (0x7fdc61fd04db in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #12: c10d::ProcessGroupNCCL::recv(std::vector<at::Tensor, std::allocator<at::Tensor> >&, int, int) + 0x550 (0x7fdc61ff33e0 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #13: <unknown function> + 0x5838289 (0x7fdc9caea289 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #14: <unknown function> + 0x5843180 (0x7fdc9caf5180 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0x5843215 (0x7fdc9caf5215 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #16: <unknown function> + 0x4e8937c (0x7fdc9c13b37c in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #17: <unknown function> + 0x1a08a38 (0x7fdc98cbaa38 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #18: <unknown function> + 0x58498d4 (0x7fdc9cafb8d4 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #19: <unknown function> + 0x584eb85 (0x7fdc9cb00b85 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_cpu.so)
frame #20: <unknown function> + 0xc99c3e (0x7fdcaf3abc3e in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
frame #21: <unknown function> + 0x413f64 (0x7fdcaeb25f64 in /gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/lib/libtorch_python.so)
frame #22: <unknown function> + 0x1457e6 (0x5561797387e6 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #23: _PyObject_MakeTpCall + 0x26b (0x5561797319db in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #24: <unknown function> + 0x151ec6 (0x556179744ec6 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #25: _PyEval_EvalFrameDefault + 0x4c1a (0x55617972cf2a in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #26: _PyFunction_Vectorcall + 0x6c (0x556179738c6c in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #27: _PyEval_EvalFrameDefault + 0x4c1a (0x55617972cf2a in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #28: _PyFunction_Vectorcall + 0x6c (0x556179738c6c in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #29: _PyEval_EvalFrameDefault + 0x4c1a (0x55617972cf2a in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #30: _PyFunction_Vectorcall + 0x6c (0x556179738c6c in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #31: _PyEval_EvalFrameDefault + 0x13cc (0x5561797296dc in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #32: _PyFunction_Vectorcall + 0x6c (0x556179738c6c in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #33: _PyEval_EvalFrameDefault + 0x13cc (0x5561797296dc in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #34: _PyFunction_Vectorcall + 0x6c (0x556179738c6c in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #35: _PyEval_EvalFrameDefault + 0x4c1a (0x55617972cf2a in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #36: _PyFunction_Vectorcall + 0x6c (0x556179738c6c in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #37: _PyEval_EvalFrameDefault + 0x320 (0x556179728630 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #38: _PyFunction_Vectorcall + 0x6c (0x556179738c6c in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #39: _PyEval_EvalFrameDefault + 0x13cc (0x5561797296dc in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #40: _PyFunction_Vectorcall + 0x6c (0x556179738c6c in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #41: _PyEval_EvalFrameDefault + 0x320 (0x556179728630 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #42: _PyFunction_Vectorcall + 0x6c (0x556179738c6c in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #43: _PyEval_EvalFrameDefault + 0x320 (0x556179728630 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #44: _PyFunction_Vectorcall + 0x6c (0x556179738c6c in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #45: _PyEval_EvalFrameDefault + 0x13cc (0x5561797296dc in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #46: <unknown function> + 0x1da820 (0x5561797cd820 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #47: PyEval_EvalCode + 0x87 (0x5561797cd767 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #48: <unknown function> + 0x20ac2a (0x5561797fdc2a in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #49: <unknown function> + 0x206023 (0x5561797f9023 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #50: <unknown function> + 0x9a558 (0x55617968d558 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #51: _PyRun_SimpleFileObject + 0x1ae (0x5561797f350e in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #52: _PyRun_AnyFileObject + 0x44 (0x5561797f30a4 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #53: Py_RunMain + 0x38b (0x5561797f029b in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #54: Py_BytesMain + 0x37 (0x5561797c1257 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
frame #55: __libc_start_main + 0xe7 (0x7fdcb1244c87 in /lib/x86_64-linux-gnu/libc.so.6)
frame #56: <unknown function> + 0x1ce151 (0x5561797c1151 in /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10)
. This may indicate a possible application crash on rank 0 or a network set up issue.
[2024-12-25 14:45:09,963] torch.distributed.elastic.multiprocessing.api: [ERROR] failed (exitcode: 1) local_rank: 0 (pid: 16676) of binary: /gf3/home/fjs/anaconda3/envs/megatron/bin/python3.10
Traceback (most recent call last):
  File "/gf3/home/fjs/anaconda3/envs/megatron/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 347, in wrapper
    return f(*args, **kwargs)
  File "/gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/distributed/run.py", line 812, in main
    run(args)
  File "/gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/distributed/run.py", line 803, in run
    elastic_launch(
  File "/gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 135, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/gf3/home/fjs/anaconda3/envs/megatron/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 268, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
examples/multimodal/train.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-12-25_14:45:09
  host      : gn51
  rank      : 5 (local_rank: 1)
  exitcode  : 1 (pid: 16677)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2024-12-25_14:45:09
  host      : gn51
  rank      : 6 (local_rank: 2)
  exitcode  : 1 (pid: 16678)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2024-12-25_14:45:09
  host      : gn51
  rank      : 7 (local_rank: 3)
  exitcode  : 1 (pid: 16679)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-12-25_14:45:09
  host      : gn51
  rank      : 4 (local_rank: 0)
  exitcode  : 1 (pid: 16676)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
