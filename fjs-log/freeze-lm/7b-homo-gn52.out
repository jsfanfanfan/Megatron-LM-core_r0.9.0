examples/multimodal/pretrain-freeze-llm-homo.sh: line 4: activate: No such file or directory
[2024-12-31 11:56:53,211] torch.distributed.run: [WARNING] 
[2024-12-31 11:56:53,211] torch.distributed.run: [WARNING] *****************************************
[2024-12-31 11:56:53,211] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-12-31 11:56:53,211] torch.distributed.run: [WARNING] *****************************************
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:20------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:20------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:20------
------num_pipeline_model_parallel_groups:4------
> setting tensorboard ...
WARNING: one_logger package is required to enable e2e metrics tracking. please go to https://confluence.nvidia.com/display/MLWFO/Package+Repositories for details to install it
------pipeline_parallel_model_size:5------
------world_size:20------
------total_model_size:20------
------num_pipeline_model_parallel_groups:4------
---Rank 17---Tensor Parallel Group GPUs: [1, 1, 1, 1]---Rank 18---Tensor Parallel Group GPUs: [2, 2, 2, 2]

---Rank 17---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]---Rank 18---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]

---Rank 16---Tensor Parallel Group GPUs: [0, 0, 0, 0]---Rank 19---Tensor Parallel Group GPUs: [3, 3, 3, 3]
[rank18]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank17]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())

---Rank 16---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]
---Rank 19---Pipeline Parallel Group GPUs: [4, 4, 4, 4, 4]
[rank16]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank19]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
 > number of parameters on (tensor, pipeline) model parallel rank (2, 4): 469831680
 > number of parameters on (tensor, pipeline) model parallel rank (1, 4): 469831680
 > number of parameters on (tensor, pipeline) model parallel rank (0, 4): 469831680
 > number of parameters on (tensor, pipeline) model parallel rank (3, 4): 469831680
INFO:megatron.core.distributed.param_and_grad_buffer:Number of buckets for gradient all-reduce / reduce-scatter: 1
Params for bucket 1 (469831680 elements):
	language_model.decoder.layers.7.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.5.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.5.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.1.mlp.linear_fc2.weight
	language_model.decoder.layers.7.self_attention.linear_qkv.weight
	language_model.decoder.layers.6.self_attention.linear_proj.weight
	language_model.decoder.layers.4.mlp.linear_fc2.weight
	language_model.decoder.layers.0.mlp.linear_fc2.weight
	language_model.decoder.layers.0.self_attention.linear_proj.weight
	language_model.decoder.final_layernorm.weight
	language_model.decoder.layers.6.self_attention.linear_qkv.weight
	language_model.decoder.layers.5.mlp.linear_fc1.weight
	language_model.decoder.layers.4.mlp.linear_fc1.weight
	language_model.decoder.layers.1.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.0.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.0.self_attention.linear_qkv.weight
	language_model.decoder.layers.6.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.4.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.4.self_attention.linear_qkv.weight
	language_model.decoder.layers.3.mlp.linear_fc2.weight
	language_model.decoder.layers.3.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.2.mlp.linear_fc2.weight
	language_model.decoder.layers.2.mlp.linear_fc1.weight
	language_model.decoder.layers.2.self_attention.linear_proj.weight
	language_model.decoder.layers.1.self_attention.linear_qkv.weight
	language_model.decoder.layers.7.mlp.linear_fc2.weight
	language_model.decoder.layers.7.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.6.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.5.self_attention.linear_qkv.weight
	language_model.decoder.layers.5.self_attention.linear_proj.weight
	language_model.decoder.layers.4.self_attention.linear_proj.weight
	language_model.decoder.layers.1.mlp.linear_fc1.weight
	language_model.decoder.layers.0.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.7.mlp.linear_fc1.weight
	language_model.decoder.layers.6.mlp.linear_fc1.weight
	language_model.decoder.layers.4.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.3.mlp.linear_fc1.weight
	language_model.decoder.layers.2.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.2.self_attention.linear_qkv.layer_norm_weight
	language_model.decoder.layers.1.self_attention.linear_proj.weight
	language_model.output_layer.weight
	language_model.decoder.layers.7.self_attention.linear_proj.weight
	language_model.decoder.layers.6.mlp.linear_fc2.weight
	language_model.decoder.layers.5.mlp.linear_fc2.weight
	language_model.decoder.layers.3.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.3.self_attention.linear_proj.weight
	language_model.decoder.layers.1.mlp.linear_fc1.layer_norm_weight
	language_model.decoder.layers.0.mlp.linear_fc1.weight
	language_model.decoder.layers.3.self_attention.linear_qkv.weight
	language_model.decoder.layers.2.self_attention.linear_qkv.weight
rank=0, worker=0: shard_range=[pretrain-0.tar[0, 100), pretrain-0.tar[100, 200), pretrain-0.tar[200, 300), ...<2494>, pretrain-30.tar[9700, 9800), pretrain-30.tar[9800, 9900), pretrain-30.tar[9900, 10000)] sum(count)=250000
rank=0, worker=1: shard_range=[pretrain-31.tar[0, 100), pretrain-31.tar[100, 200), pretrain-31.tar[200, 300), ...<2494>, pretrain-53.tar[9700, 9800), pretrain-53.tar[9800, 9900), pretrain-53.tar[9900, 10000)] sum(count)=250000
rank=0, worker=0: shard_range=[pretrain-54.tar[0, 10000), pretrain-55.tar[0, 8128), pretrain-6.tar[0, 10000), pretrain-7.tar[0, 936)] sum(count)=29064
rank=0, worker=1: shard_range=[pretrain-7.tar[936, 10000), pretrain-8.tar[0, 10000), pretrain-9.tar[0, 10000)] sum(count)=29064
times across ranks (ms):
  model-and-optimizer-setup:
     rank  0: 103.32
     rank  1: 72.96
     rank  2: 105.62
     rank  3: 107.44
     rank  4: 46.16
     rank  5: 46.00
     rank  6: 29.68
     rank  7: 51.50
     rank  8: 50.18
     rank  9: 61.84
     rank 10: 50.49
     rank 11: 53.82
     rank 12: 33.24
     rank 13: 43.36
     rank 14: 43.27
     rank 15: 29.24
     rank 16: 52.46
     rank 17: 45.24
     rank 18: 42.11
     rank 19: 52.43
  train/valid/test-data-iterators-setup:
     rank  0: 1062.67
     rank  1: 1062.67
     rank  2: 1062.54
     rank  3: 1062.49
     rank  4: 1062.63
     rank  5: 1063.02
     rank  6: 1062.78
     rank  7: 1062.65
     rank  8: 1062.75
     rank  9: 1062.75
     rank 10: 1062.73
     rank 11: 1062.77
     rank 12: 1062.88
     rank 13: 1062.87
     rank 14: 1063.21
     rank 15: 1062.80
     rank 16: 1062.79
     rank 17: 1062.94
     rank 18: 1062.82
     rank 19: 1063.05
 [2024-12-31 11:57:32] iteration        1/      10 | consumed samples:           32 | elapsed time per iteration (ms): 20912.6 | learning rate: 7.500000E-07 | global batch size:    32 | lm loss: 7.124510E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
[Rank 17] (after 1 iterations) memory (MB) | allocated: 7222.3154296875 | max allocated: 9013.798828125 | reserved: 9652.0 | max reserved: 9652.0
[Rank 18] (after 1 iterations) memory (MB) | allocated: 7222.3154296875 | max allocated: 9013.798828125 | reserved: 9762.0 | max reserved: 9762.0
stage5 GPU utialization:110.03172397613525 %
[Rank 16] (after 1 iterations) memory (MB) | allocated: 7222.3154296875 | max allocated: 9013.798828125 | reserved: 9678.0 | max reserved: 9678.0
[Rank 19] (after 1 iterations) memory (MB) | allocated: 7222.3154296875 | max allocated: 9013.798828125 | reserved: 9762.0 | max reserved: 9762.0
times across ranks (ms):
  forward-backward:
     rank  0: 20835.13
     rank  1: 20835.31
     rank  2: 20835.13
     rank  3: 20835.22
     rank  4: 20839.61
     rank  5: 20839.37
     rank  6: 20839.32
     rank  7: 20839.52
     rank  8: 20839.34
     rank  9: 20839.17
     rank 10: 20839.16
     rank 11: 20839.26
     rank 12: 20839.24
     rank 13: 20839.13
     rank 14: 20839.00
     rank 15: 20839.03
     rank 16: 20839.16
     rank 17: 20837.68
     rank 18: 20839.06
     rank 19: 20839.05
  forward-compute:
     rank  0: 5993.51
     rank  1: 6024.24
     rank  2: 6003.97
     rank  3: 6002.55
     rank  4: 5238.01
     rank  5: 5260.06
     rank  6: 5251.11
     rank  7: 5245.63
     rank  8: 5259.93
     rank  9: 5274.01
     rank 10: 5256.59
     rank 11: 5257.64
     rank 12: 5279.02
     rank 13: 5286.35
     rank 14: 5285.16
     rank 15: 5292.71
     rank 16: 5360.51
     rank 17: 5359.02
     rank 18: 5368.15
     rank 19: 5378.40
  backward-compute:
     rank  0: 69.47
     rank  1: 55.44
     rank  2: 70.62
     rank  3: 65.03
     rank  4: 3462.59
     rank  5: 3475.20
     rank  6: 3468.62
     rank  7: 3462.87
     rank  8: 3418.05
     rank  9: 3418.53
     rank 10: 3422.47
     rank 11: 3423.73
     rank 12: 3441.19
     rank 13: 3442.80
     rank 14: 3447.22
     rank 15: 3452.71
     rank 16: 3613.41
     rank 17: 3621.14
     rank 18: 3621.63
     rank 19: 3620.79
  pure-backward-compute:
     rank  0: 67.79
     rank  1: 53.89
     rank  2: 68.99
     rank  3: 63.62
     rank  4: 3460.20
     rank  5: 3473.50
     rank  6: 3466.43
     rank  7: 3460.49
     rank  8: 3414.81
     rank  9: 3417.12
     rank 10: 3420.78
     rank 11: 3419.28
     rank 12: 3437.44
     rank 13: 3438.49
     rank 14: 3445.21
     rank 15: 3450.82
     rank 16: 3607.30
     rank 17: 3615.31
     rank 18: 3618.47
     rank 19: 3617.32
  batch-generator:
     rank  0: 1172.87
     rank  1: 1202.33
     rank  2: 1185.41
     rank  3: 1184.87
     rank  4: 1215.98
     rank  5: 1242.57
     rank  6: 1232.05
     rank  7: 1236.99
     rank  8: 1150.39
     rank  9: 1164.79
     rank 10: 1150.80
     rank 11: 1163.90
     rank 12: 1295.96
     rank 13: 1306.45
     rank 14: 1303.86
     rank 15: 1313.04
     rank 16: 1224.13
     rank 17: 1233.31
     rank 18: 1231.56
     rank 19: 1240.46
  forward-recv:
     rank  4: 4086.46
     rank  5: 4087.00
     rank  6: 4079.21
     rank  7: 4087.32
     rank  8: 6334.88
     rank  9: 6338.17
     rank 10: 6339.66
     rank 11: 6335.99
     rank 12: 8771.60
     rank 13: 8770.84
     rank 14: 8771.08
     rank 15: 8767.46
     rank 16: 11200.55
     rank 17: 11195.31
     rank 18: 11202.91
     rank 19: 11202.49
  forward-send:
     rank  0: 7092.12
     rank  1: 7092.24
     rank  2: 7091.31
     rank  3: 7093.44
     rank  4: 4699.72
     rank  5: 4698.81
     rank  6: 4706.42
     rank  7: 4698.83
     rank  8: 2361.72
     rank  9: 2357.28
     rank 10: 2363.67
     rank 11: 2359.24
     rank 12: 30.77
     rank 13: 27.81
     rank 14: 33.71
     rank 15: 33.34
  backward-recv:
     rank  0: 853.55
     rank  1: 855.84
     rank  2: 853.73
     rank  3: 854.95
     rank  4: 314.95
     rank  5: 315.92
     rank  6: 314.67
     rank  7: 314.14
     rank  8: 209.53
     rank  9: 211.26
     rank 10: 210.56
     rank 11: 208.07
     rank 12: 105.17
     rank 13: 104.47
     rank 14: 105.32
     rank 15: 105.90
  backward-send:
     rank  4: 10.36
     rank  5: 8.84
     rank  6: 9.94
     rank  7: 10.71
     rank  8: 15.32
     rank  9: 14.14
     rank 10: 14.34
     rank 11: 15.35
     rank 12: 9.76
     rank 13: 10.06
     rank 14: 9.56
     rank 15: 8.13
     rank 16: 5.06
     rank 17: 5.17
     rank 18: 4.76
     rank 19: 4.16
  forward-send-backward-recv:
     rank  0: 6761.20
     rank  1: 6742.68
     rank  2: 6750.68
     rank  3: 6755.03
     rank  4: 2836.25
     rank  5: 2826.36
     rank  6: 2829.01
     rank  7: 2839.46
     rank  8: 2814.86
     rank  9: 2820.71
     rank 10: 2819.09
     rank 11: 2808.89
     rank 12: 2664.10
     rank 13: 2665.56
     rank 14: 2669.10
     rank 15: 2662.68
  backward-send-forward-recv:
     rank  4: 104.71
     rank  5: 87.36
     rank  6: 97.37
     rank  7: 98.69
     rank  8: 227.84
     rank  9: 217.96
     rank 10: 224.80
     rank 11: 231.38
     rank 12: 227.12
     rank 13: 221.63
     rank 14: 218.37
     rank 15: 216.03
     rank 16: 238.22
     rank 17: 237.73
     rank 18: 230.54
     rank 19: 222.06
  layernorm-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.06
     rank  2: 0.02
     rank  3: 0.06
     rank  4: 0.05
     rank  5: 0.04
     rank  6: 0.03
     rank  7: 0.05
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.05
     rank 11: 0.04
     rank 12: 0.03
     rank 13: 0.04
     rank 14: 0.02
     rank 15: 0.03
     rank 16: 0.02
     rank 17: 0.04
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.12
     rank  1: 0.08
     rank  2: 0.06
     rank  3: 0.07
     rank  4: 0.05
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.05
     rank  8: 0.04
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.04
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.06
     rank 17: 0.09
     rank 18: 0.05
     rank 19: 0.05
  all-grads-sync:
     rank  0: 48.56
     rank  1: 48.63
     rank  2: 36.86
     rank  3: 46.56
     rank  4: 56.47
     rank  5: 41.60
     rank  6: 42.61
     rank  7: 46.64
     rank  8: 43.06
     rank  9: 42.86
     rank 10: 43.87
     rank 11: 47.86
     rank 12: 41.17
     rank 13: 43.79
     rank 14: 44.66
     rank 15: 37.39
     rank 16: 2.68
     rank 17: 3.09
     rank 18: 2.46
     rank 19: 2.54
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.09
     rank  5: 0.07
     rank  6: 0.06
     rank  7: 0.07
     rank  8: 0.07
     rank  9: 0.06
     rank 10: 0.06
     rank 11: 0.09
     rank 12: 0.09
     rank 13: 0.09
     rank 14: 0.06
     rank 15: 0.05
     rank 16: 0.07
     rank 17: 0.07
     rank 18: 0.04
     rank 19: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 2.21
     rank  1: 2.87
     rank  2: 2.28
     rank  3: 2.44
     rank  4: 62.00
     rank  5: 62.08
     rank  6: 62.05
     rank  7: 62.17
     rank  8: 58.76
     rank  9: 58.02
     rank 10: 58.41
     rank 11: 59.08
     rank 12: 58.16
     rank 13: 58.53
     rank 14: 58.18
     rank 15: 57.64
     rank 16: 63.81
     rank 17: 63.19
     rank 18: 63.54
     rank 19: 66.66
  optimizer:
     rank  0: 3.17
     rank  1: 3.85
     rank  2: 3.24
     rank  3: 3.42
     rank  4: 62.96
     rank  5: 63.05
     rank  6: 63.02
     rank  7: 63.13
     rank  8: 59.73
     rank  9: 58.99
     rank 10: 59.39
     rank 11: 60.05
     rank 12: 59.13
     rank 13: 59.51
     rank 14: 59.17
     rank 15: 58.61
     rank 16: 64.78
     rank 17: 64.15
     rank 18: 64.51
     rank 19: 67.64
 [2024-12-31 11:57:40] iteration        2/      10 | consumed samples:           64 | elapsed time per iteration (ms): 7675.5 | learning rate: 1.500000E-06 | global batch size:    32 | lm loss: 7.075938E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 7589.50
     rank  1: 7589.41
     rank  2: 7589.42
     rank  3: 7589.44
     rank  4: 7593.72
     rank  5: 7593.60
     rank  6: 7593.59
     rank  7: 7593.64
     rank  8: 7593.50
     rank  9: 7593.34
     rank 10: 7593.38
     rank 11: 7593.44
     rank 12: 7593.50
     rank 13: 7593.32
     rank 14: 7593.32
     rank 15: 7593.34
     rank 16: 7593.75
     rank 17: 7593.64
     rank 18: 7593.54
     rank 19: 7593.55
  forward-compute:
     rank  0: 1766.38
     rank  1: 1803.03
     rank  2: 1777.51
     rank  3: 1790.84
     rank  4: 3051.62
     rank  5: 3075.58
     rank  6: 3063.20
     rank  7: 3068.18
     rank  8: 2943.08
     rank  9: 2953.94
     rank 10: 2950.36
     rank 11: 2945.86
     rank 12: 2926.95
     rank 13: 2927.92
     rank 14: 2937.82
     rank 15: 2940.38
     rank 16: 3071.80
     rank 17: 3072.78
     rank 18: 3081.18
     rank 19: 3087.64
  backward-compute:
     rank  0: 69.08
     rank  1: 50.81
     rank  2: 68.50
     rank  3: 58.92
     rank  4: 3449.76
     rank  5: 3452.75
     rank  6: 3455.38
     rank  7: 3446.71
     rank  8: 3413.43
     rank  9: 3415.37
     rank 10: 3421.56
     rank 11: 3419.03
     rank 12: 3415.73
     rank 13: 3415.63
     rank 14: 3418.93
     rank 15: 3421.55
     rank 16: 3621.44
     rank 17: 3620.41
     rank 18: 3628.15
     rank 19: 3625.69
  pure-backward-compute:
     rank  0: 67.75
     rank  1: 49.78
     rank  2: 67.24
     rank  3: 57.81
     rank  4: 3447.48
     rank  5: 3451.26
     rank  6: 3453.50
     rank  7: 3445.15
     rank  8: 3409.94
     rank  9: 3414.00
     rank 10: 3419.95
     rank 11: 3416.12
     rank 12: 3412.55
     rank 13: 3412.59
     rank 14: 3417.39
     rank 15: 3419.96
     rank 16: 3616.14
     rank 17: 3615.63
     rank 18: 3625.56
     rank 19: 3622.85
  batch-generator:
     rank  0: 94.23
     rank  1: 125.82
     rank  2: 103.15
     rank  3: 116.27
     rank  4: 121.64
     rank  5: 147.66
     rank  6: 131.55
     rank  7: 134.97
     rank  8: 119.63
     rank  9: 124.47
     rank 10: 125.36
     rank 11: 129.56
     rank 12: 107.56
     rank 13: 111.36
     rank 14: 118.37
     rank 15: 122.30
     rank 16: 98.93
     rank 17: 101.80
     rank 18: 107.11
     rank 19: 115.35
  forward-recv:
     rank  4: 63.24
     rank  5: 61.27
     rank  6: 62.12
     rank  7: 62.60
     rank  8: 164.44
     rank  9: 163.98
     rank 10: 162.61
     rank 11: 162.95
     rank 12: 261.78
     rank 13: 261.82
     rank 14: 261.03
     rank 15: 260.80
     rank 16: 355.54
     rank 17: 355.55
     rank 18: 355.20
     rank 19: 354.79
  forward-send:
     rank  0: 139.50
     rank  1: 135.08
     rank  2: 133.49
     rank  3: 133.95
     rank  4: 19.77
     rank  5: 18.32
     rank  6: 14.85
     rank  7: 15.35
     rank  8: 10.64
     rank  9: 10.44
     rank 10: 9.13
     rank 11: 8.07
     rank 12: 5.05
     rank 13: 5.08
     rank 14: 4.67
     rank 15: 4.21
  backward-recv:
     rank  0: 852.76
     rank  1: 855.53
     rank  2: 853.20
     rank  3: 854.58
     rank  4: 316.75
     rank  5: 319.11
     rank  6: 316.92
     rank  7: 318.18
     rank  8: 208.49
     rank  9: 208.93
     rank 10: 208.83
     rank 11: 207.77
     rank 12: 104.15
     rank 13: 104.35
     rank 14: 104.57
     rank 15: 104.59
  backward-send:
     rank  4: 10.29
     rank  5: 8.63
     rank  6: 10.26
     rank  7: 9.49
     rank  8: 15.08
     rank  9: 14.80
     rank 10: 14.69
     rank 11: 14.85
     rank 12: 10.22
     rank 13: 10.13
     rank 14: 9.61
     rank 15: 8.82
     rank 16: 5.15
     rank 17: 5.16
     rank 18: 4.74
     rank 19: 4.31
  forward-send-backward-recv:
     rank  0: 4751.80
     rank  1: 4736.48
     rank  2: 4747.80
     rank  3: 4743.04
     rank  4: 565.96
     rank  5: 560.28
     rank  6: 558.43
     rank  7: 567.39
     rank  8: 500.26
     rank  9: 509.80
     rank 10: 506.01
     rank 11: 500.15
     rank 12: 438.68
     rank 13: 442.75
     rank 14: 445.93
     rank 15: 443.09
  backward-send-forward-recv:
     rank  4: 85.68
     rank  5: 73.89
     rank  6: 84.75
     rank  7: 82.46
     rank  8: 193.74
     rank  9: 185.07
     rank 10: 188.63
     rank 11: 192.97
     rank 12: 178.28
     rank 13: 176.18
     rank 14: 168.78
     rank 15: 167.48
     rank 16: 177.35
     rank 17: 178.84
     rank 18: 171.18
     rank 19: 166.60
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.01
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.09
     rank 17: 0.06
     rank 18: 0.05
     rank 19: 0.05
  all-grads-sync:
     rank  0: 0.38
     rank  1: 0.32
     rank  2: 0.28
     rank  3: 0.28
     rank  4: 2.32
     rank  5: 2.34
     rank  6: 2.29
     rank  7: 2.30
     rank  8: 2.21
     rank  9: 2.14
     rank 10: 2.22
     rank 11: 2.22
     rank 12: 2.27
     rank 13: 2.18
     rank 14: 2.17
     rank 15: 2.19
     rank 16: 2.48
     rank 17: 2.42
     rank 18: 2.29
     rank 19: 2.34
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.04
     rank  5: 0.05
     rank  6: 0.04
     rank  7: 0.04
     rank  8: 0.05
     rank  9: 0.04
     rank 10: 0.05
     rank 11: 0.06
     rank 12: 0.07
     rank 13: 0.09
     rank 14: 0.04
     rank 15: 0.04
     rank 16: 0.08
     rank 17: 0.06
     rank 18: 0.04
     rank 19: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 2.08
     rank  1: 2.04
     rank  2: 2.00
     rank  3: 1.98
     rank  4: 46.26
     rank  5: 46.36
     rank  6: 46.31
     rank  7: 46.30
     rank  8: 43.10
     rank  9: 42.95
     rank 10: 43.09
     rank 11: 43.09
     rank 12: 43.17
     rank 13: 43.03
     rank 14: 43.01
     rank 15: 43.05
     rank 16: 46.58
     rank 17: 46.31
     rank 18: 46.32
     rank 19: 46.36
  optimizer:
     rank  0: 2.75
     rank  1: 2.71
     rank  2: 2.66
     rank  3: 2.64
     rank  4: 46.91
     rank  5: 47.02
     rank  6: 46.96
     rank  7: 46.96
     rank  8: 43.76
     rank  9: 43.61
     rank 10: 43.74
     rank 11: 43.77
     rank 12: 43.83
     rank 13: 43.69
     rank 14: 43.69
     rank 15: 43.70
     rank 16: 47.24
     rank 17: 47.07
     rank 18: 46.97
     rank 19: 47.02
 [2024-12-31 11:57:48] iteration        3/      10 | consumed samples:           96 | elapsed time per iteration (ms): 7682.0 | learning rate: 2.250000E-06 | global batch size:    32 | lm loss: 3.317110E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 7599.54
     rank  1: 7599.60
     rank  2: 7599.54
     rank  3: 7599.61
     rank  4: 7603.74
     rank  5: 7603.76
     rank  6: 7603.70
     rank  7: 7603.75
     rank  8: 7603.47
     rank  9: 7603.50
     rank 10: 7603.47
     rank 11: 7603.60
     rank 12: 7603.53
     rank 13: 7603.50
     rank 14: 7603.45
     rank 15: 7603.45
     rank 16: 7603.69
     rank 17: 7603.73
     rank 18: 7603.65
     rank 19: 7603.66
  forward-compute:
     rank  0: 1790.24
     rank  1: 1825.34
     rank  2: 1797.47
     rank  3: 1812.45
     rank  4: 3076.43
     rank  5: 3102.22
     rank  6: 3087.67
     rank  7: 3094.80
     rank  8: 2938.33
     rank  9: 2948.61
     rank 10: 2943.43
     rank 11: 2936.84
     rank 12: 2945.76
     rank 13: 2945.06
     rank 14: 2955.19
     rank 15: 2963.99
     rank 16: 3084.16
     rank 17: 3083.12
     rank 18: 3092.68
     rank 19: 3100.58
  backward-compute:
     rank  0: 67.29
     rank  1: 51.14
     rank  2: 67.55
     rank  3: 59.24
     rank  4: 3440.66
     rank  5: 3442.69
     rank  6: 3445.72
     rank  7: 3436.96
     rank  8: 3406.98
     rank  9: 3407.87
     rank 10: 3412.25
     rank 11: 3419.57
     rank 12: 3409.89
     rank 13: 3408.14
     rank 14: 3413.06
     rank 15: 3416.58
     rank 16: 3625.11
     rank 17: 3624.41
     rank 18: 3632.29
     rank 19: 3630.68
  pure-backward-compute:
     rank  0: 66.05
     rank  1: 50.12
     rank  2: 66.31
     rank  3: 58.03
     rank  4: 3437.69
     rank  5: 3441.30
     rank  6: 3443.87
     rank  7: 3435.55
     rank  8: 3403.91
     rank  9: 3406.49
     rank 10: 3410.86
     rank 11: 3416.55
     rank 12: 3406.59
     rank 13: 3404.80
     rank 14: 3411.52
     rank 15: 3415.19
     rank 16: 3619.88
     rank 17: 3619.61
     rank 18: 3629.77
     rank 19: 3627.88
  batch-generator:
     rank  0: 85.11
     rank  1: 116.01
     rank  2: 90.24
     rank  3: 106.40
     rank  4: 137.75
     rank  5: 159.83
     rank  6: 143.16
     rank  7: 148.48
     rank  8: 115.08
     rank  9: 118.32
     rank 10: 117.82
     rank 11: 119.80
     rank 12: 117.02
     rank 13: 118.71
     rank 14: 121.71
     rank 15: 132.53
     rank 16: 105.87
     rank 17: 104.82
     rank 18: 110.94
     rank 19: 119.89
  forward-recv:
     rank  4: 64.78
     rank  5: 62.52
     rank  6: 64.67
     rank  7: 64.51
     rank  8: 167.32
     rank  9: 166.68
     rank 10: 168.84
     rank 11: 167.41
     rank 12: 257.78
     rank 13: 257.64
     rank 14: 257.00
     rank 15: 258.70
     rank 16: 348.67
     rank 17: 349.35
     rank 18: 348.45
     rank 19: 348.05
  forward-send:
     rank  0: 139.57
     rank  1: 134.53
     rank  2: 138.25
     rank  3: 138.11
     rank  4: 15.83
     rank  5: 14.17
     rank  6: 14.89
     rank  7: 15.33
     rank  8: 10.11
     rank  9: 9.77
     rank 10: 8.72
     rank 11: 10.20
     rank 12: 5.12
     rank 13: 5.10
     rank 14: 4.80
     rank 15: 4.31
  backward-recv:
     rank  0: 847.28
     rank  1: 849.37
     rank  2: 847.19
     rank  3: 848.48
     rank  4: 311.11
     rank  5: 312.63
     rank  6: 311.94
     rank  7: 313.15
     rank  8: 207.39
     rank  9: 208.04
     rank 10: 206.77
     rank 11: 206.00
     rank 12: 103.13
     rank 13: 103.17
     rank 14: 103.61
     rank 15: 103.91
  backward-send:
     rank  4: 10.70
     rank  5: 9.08
     rank  6: 10.29
     rank  7: 9.77
     rank  8: 14.67
     rank  9: 14.03
     rank 10: 15.05
     rank 11: 15.08
     rank 12: 10.19
     rank 13: 10.03
     rank 14: 9.61
     rank 15: 9.08
     rank 16: 5.08
     rank 17: 5.18
     rank 18: 4.89
     rank 19: 4.70
  forward-send-backward-recv:
     rank  0: 4745.69
     rank  1: 4730.77
     rank  2: 4740.28
     rank  3: 4733.12
     rank  4: 564.32
     rank  5: 562.05
     rank  6: 555.86
     rank  7: 565.92
     rank  8: 542.65
     rank  9: 551.49
     rank 10: 549.61
     rank 11: 535.32
     rank 12: 446.61
     rank 13: 448.58
     rank 14: 454.30
     rank 15: 450.86
  backward-send-forward-recv:
     rank  4: 85.81
     rank  5: 75.12
     rank  6: 84.14
     rank  7: 80.55
     rank  8: 173.25
     rank  9: 165.21
     rank 10: 167.05
     rank 11: 172.83
     rank 12: 171.01
     rank 13: 171.88
     rank 14: 163.47
     rank 15: 153.69
     rank 16: 177.61
     rank 17: 180.04
     rank 18: 172.02
     rank 19: 165.92
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.05
     rank 17: 0.05
     rank 18: 0.04
     rank 19: 0.04
  all-grads-sync:
     rank  0: 0.29
     rank  1: 0.29
     rank  2: 0.29
     rank  3: 0.34
     rank  4: 2.35
     rank  5: 2.32
     rank  6: 2.35
     rank  7: 2.30
     rank  8: 2.16
     rank  9: 2.13
     rank 10: 2.14
     rank 11: 2.31
     rank 12: 2.25
     rank 13: 2.23
     rank 14: 2.20
     rank 15: 2.15
     rank 16: 2.39
     rank 17: 2.43
     rank 18: 2.30
     rank 19: 2.30
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.04
     rank  6: 0.05
     rank  7: 0.04
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.03
     rank 11: 0.07
     rank 12: 0.06
     rank 13: 0.06
     rank 14: 0.04
     rank 15: 0.04
     rank 16: 0.05
     rank 17: 0.06
     rank 18: 0.04
     rank 19: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 1.99
     rank  1: 1.98
     rank  2: 1.99
     rank  3: 2.06
     rank  4: 46.33
     rank  5: 46.29
     rank  6: 46.38
     rank  7: 46.30
     rank  8: 42.99
     rank  9: 42.93
     rank 10: 42.98
     rank 11: 43.24
     rank 12: 43.10
     rank 13: 43.08
     rank 14: 43.07
     rank 15: 42.98
     rank 16: 46.23
     rank 17: 46.40
     rank 18: 46.28
     rank 19: 46.25
  optimizer:
     rank  0: 2.65
     rank  1: 2.64
     rank  2: 2.65
     rank  3: 2.72
     rank  4: 46.99
     rank  5: 46.94
     rank  6: 47.04
     rank  7: 46.96
     rank  8: 43.65
     rank  9: 43.58
     rank 10: 43.63
     rank 11: 43.91
     rank 12: 43.76
     rank 13: 43.74
     rank 14: 43.73
     rank 15: 43.63
     rank 16: 46.88
     rank 17: 47.05
     rank 18: 46.93
     rank 19: 46.91
 [2024-12-31 11:57:55] iteration        4/      10 | consumed samples:          128 | elapsed time per iteration (ms): 7679.8 | learning rate: 3.000000E-06 | global batch size:    32 | lm loss: 3.904030E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 7596.18
     rank  1: 7596.11
     rank  2: 7596.09
     rank  3: 7596.11
     rank  4: 7600.38
     rank  5: 7600.29
     rank  6: 7600.27
     rank  7: 7600.27
     rank  8: 7600.13
     rank  9: 7600.06
     rank 10: 7600.05
     rank 11: 7600.02
     rank 12: 7600.08
     rank 13: 7600.03
     rank 14: 7599.97
     rank 15: 7599.96
     rank 16: 7600.40
     rank 17: 7600.33
     rank 18: 7600.22
     rank 19: 7600.24
  forward-compute:
     rank  0: 1796.52
     rank  1: 1828.57
     rank  2: 1801.07
     rank  3: 1817.90
     rank  4: 3041.51
     rank  5: 3062.92
     rank  6: 3049.17
     rank  7: 3056.80
     rank  8: 2904.37
     rank  9: 2912.22
     rank 10: 2911.18
     rank 11: 2901.78
     rank 12: 2920.27
     rank 13: 2920.07
     rank 14: 2926.59
     rank 15: 2936.57
     rank 16: 3091.45
     rank 17: 3093.76
     rank 18: 3100.83
     rank 19: 3108.75
  backward-compute:
     rank  0: 67.05
     rank  1: 51.33
     rank  2: 67.31
     rank  3: 57.82
     rank  4: 3439.49
     rank  5: 3439.52
     rank  6: 3445.24
     rank  7: 3435.92
     rank  8: 3397.08
     rank  9: 3397.23
     rank 10: 3400.91
     rank 11: 3408.14
     rank 12: 3417.86
     rank 13: 3419.45
     rank 14: 3421.58
     rank 15: 3423.64
     rank 16: 3613.84
     rank 17: 3614.07
     rank 18: 3621.74
     rank 19: 3620.08
  pure-backward-compute:
     rank  0: 65.79
     rank  1: 50.31
     rank  2: 66.06
     rank  3: 56.68
     rank  4: 3437.03
     rank  5: 3438.10
     rank  6: 3443.48
     rank  7: 3434.55
     rank  8: 3394.31
     rank  9: 3395.84
     rank 10: 3399.53
     rank 11: 3405.58
     rank 12: 3414.85
     rank 13: 3416.59
     rank 14: 3420.14
     rank 15: 3422.31
     rank 16: 3608.34
     rank 17: 3609.37
     rank 18: 3619.13
     rank 19: 3617.34
  batch-generator:
     rank  0: 140.10
     rank  1: 167.31
     rank  2: 143.91
     rank  3: 161.06
     rank  4: 117.04
     rank  5: 137.51
     rank  6: 118.48
     rank  7: 128.30
     rank  8: 96.56
     rank  9: 104.23
     rank 10: 106.92
     rank 11: 104.33
     rank 12: 103.86
     rank 13: 105.17
     rank 14: 111.46
     rank 15: 122.54
     rank 16: 114.98
     rank 17: 118.01
     rank 18: 120.14
     rank 19: 129.37
  forward-recv:
     rank  4: 63.98
     rank  5: 60.98
     rank  6: 64.01
     rank  7: 62.78
     rank  8: 168.67
     rank  9: 168.04
     rank 10: 170.33
     rank 11: 168.06
     rank 12: 260.00
     rank 13: 259.75
     rank 14: 259.55
     rank 15: 261.04
     rank 16: 348.53
     rank 17: 348.48
     rank 18: 348.18
     rank 19: 347.84
  forward-send:
     rank  0: 141.00
     rank  1: 135.54
     rank  2: 140.42
     rank  3: 137.72
     rank  4: 15.39
     rank  5: 13.65
     rank  6: 15.19
     rank  7: 14.50
     rank  8: 10.14
     rank  9: 9.68
     rank 10: 8.95
     rank 11: 10.34
     rank 12: 5.13
     rank 13: 5.10
     rank 14: 4.71
     rank 15: 4.29
  backward-recv:
     rank  0: 853.64
     rank  1: 856.04
     rank  2: 853.57
     rank  3: 855.14
     rank  4: 316.00
     rank  5: 317.04
     rank  6: 316.91
     rank  7: 317.88
     rank  8: 208.14
     rank  9: 208.54
     rank 10: 208.68
     rank 11: 207.31
     rank 12: 102.72
     rank 13: 102.61
     rank 14: 103.01
     rank 15: 103.60
  backward-send:
     rank  4: 10.76
     rank  5: 10.02
     rank  6: 9.95
     rank  7: 9.76
     rank  8: 15.01
     rank  9: 14.83
     rank 10: 14.53
     rank 11: 14.90
     rank 12: 10.10
     rank 13: 10.04
     rank 14: 9.72
     rank 15: 8.93
     rank 16: 5.25
     rank 17: 5.11
     rank 18: 4.58
     rank 19: 4.74
  forward-send-backward-recv:
     rank  0: 4728.12
     rank  1: 4716.47
     rank  2: 4724.60
     rank  3: 4719.50
     rank  4: 595.24
     rank  5: 595.03
     rank  6: 585.43
     rank  7: 596.93
     rank  8: 591.14
     rank  9: 598.24
     rank 10: 596.62
     rank 11: 582.90
     rank 12: 461.12
     rank 13: 463.32
     rank 14: 468.38
     rank 15: 465.57
  backward-send-forward-recv:
     rank  4: 85.88
     rank  5: 77.30
     rank  6: 86.64
     rank  7: 82.75
     rank  8: 165.47
     rank  9: 160.12
     rank 10: 157.46
     rank 11: 167.40
     rank 12: 171.18
     rank 13: 170.47
     rank 14: 164.63
     rank 15: 154.73
     rank 16: 176.99
     rank 17: 177.60
     rank 18: 171.31
     rank 19: 165.08
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.03
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.07
     rank 17: 0.05
     rank 18: 0.04
     rank 19: 0.05
  all-grads-sync:
     rank  0: 0.28
     rank  1: 0.33
     rank  2: 0.28
     rank  3: 0.28
     rank  4: 2.34
     rank  5: 2.33
     rank  6: 2.29
     rank  7: 2.30
     rank  8: 2.21
     rank  9: 2.15
     rank 10: 2.15
     rank 11: 2.16
     rank 12: 2.19
     rank 13: 2.16
     rank 14: 2.20
     rank 15: 2.15
     rank 16: 2.49
     rank 17: 2.45
     rank 18: 2.30
     rank 19: 2.34
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.04
     rank  6: 0.04
     rank  7: 0.04
     rank  8: 0.05
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.05
     rank 12: 0.05
     rank 13: 0.05
     rank 14: 0.04
     rank 15: 0.03
     rank 16: 0.08
     rank 17: 0.10
     rank 18: 0.04
     rank 19: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 1.99
     rank  1: 2.05
     rank  2: 1.99
     rank  3: 1.99
     rank  4: 46.30
     rank  5: 46.32
     rank  6: 46.31
     rank  7: 46.29
     rank  8: 43.08
     rank  9: 42.96
     rank 10: 43.03
     rank 11: 42.96
     rank 12: 43.10
     rank 13: 43.03
     rank 14: 43.05
     rank 15: 43.00
     rank 16: 46.46
     rank 17: 46.37
     rank 18: 46.33
     rank 19: 46.37
  optimizer:
     rank  0: 2.59
     rank  1: 2.65
     rank  2: 2.59
     rank  3: 2.60
     rank  4: 46.91
     rank  5: 46.92
     rank  6: 46.92
     rank  7: 46.90
     rank  8: 43.69
     rank  9: 43.56
     rank 10: 43.64
     rank 11: 43.58
     rank 12: 43.70
     rank 13: 43.63
     rank 14: 43.65
     rank 15: 43.60
     rank 16: 47.04
     rank 17: 46.97
     rank 18: 46.93
     rank 19: 46.97
 [2024-12-31 11:58:03] iteration        5/      10 | consumed samples:          160 | elapsed time per iteration (ms): 7669.7 | learning rate: 3.750000E-06 | global batch size:    32 | lm loss: 3.054007E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 7585.32
     rank  1: 7585.25
     rank  2: 7585.24
     rank  3: 7585.47
     rank  4: 7589.53
     rank  5: 7589.98
     rank  6: 7589.42
     rank  7: 7589.67
     rank  8: 7589.32
     rank  9: 7589.26
     rank 10: 7589.21
     rank 11: 7589.45
     rank 12: 7589.29
     rank 13: 7589.23
     rank 14: 7589.15
     rank 15: 7589.37
     rank 16: 7589.54
     rank 17: 7589.48
     rank 18: 7589.44
     rank 19: 7590.13
  forward-compute:
     rank  0: 1744.81
     rank  1: 1779.04
     rank  2: 1751.63
     rank  3: 1766.98
     rank  4: 3075.97
     rank  5: 3096.00
     rank  6: 3087.10
     rank  7: 3096.59
     rank  8: 2912.87
     rank  9: 2922.41
     rank 10: 2915.61
     rank 11: 2911.97
     rank 12: 2920.02
     rank 13: 2919.30
     rank 14: 2927.56
     rank 15: 2934.72
     rank 16: 3091.35
     rank 17: 3092.46
     rank 18: 3099.46
     rank 19: 3108.76
  backward-compute:
     rank  0: 66.97
     rank  1: 51.01
     rank  2: 68.04
     rank  3: 57.27
     rank  4: 3448.02
     rank  5: 3448.26
     rank  6: 3448.30
     rank  7: 3443.77
     rank  8: 3402.62
     rank  9: 3397.91
     rank 10: 3407.76
     rank 11: 3413.17
     rank 12: 3420.95
     rank 13: 3423.46
     rank 14: 3424.58
     rank 15: 3429.51
     rank 16: 3603.72
     rank 17: 3604.17
     rank 18: 3610.16
     rank 19: 3609.14
  pure-backward-compute:
     rank  0: 65.58
     rank  1: 49.96
     rank  2: 66.79
     rank  3: 56.11
     rank  4: 3444.80
     rank  5: 3446.37
     rank  6: 3446.53
     rank  7: 3442.41
     rank  8: 3399.75
     rank  9: 3396.56
     rank 10: 3406.40
     rank 11: 3410.41
     rank 12: 3418.07
     rank 13: 3420.91
     rank 14: 3423.23
     rank 15: 3428.02
     rank 16: 3598.44
     rank 17: 3599.29
     rank 18: 3607.62
     rank 19: 3606.53
  batch-generator:
     rank  0: 84.65
     rank  1: 114.65
     rank  2: 89.65
     rank  3: 106.42
     rank  4: 144.71
     rank  5: 157.53
     rank  6: 142.57
     rank  7: 152.24
     rank  8: 105.48
     rank  9: 111.11
     rank 10: 109.01
     rank 11: 112.30
     rank 12: 98.54
     rank 13: 100.01
     rank 14: 108.93
     rank 15: 116.94
     rank 16: 112.37
     rank 17: 110.48
     rank 18: 113.31
     rank 19: 123.94
  forward-recv:
     rank  4: 64.14
     rank  5: 61.15
     rank  6: 64.24
     rank  7: 63.80
     rank  8: 171.88
     rank  9: 170.91
     rank 10: 173.69
     rank 11: 171.60
     rank 12: 260.63
     rank 13: 260.58
     rank 14: 259.72
     rank 15: 261.65
     rank 16: 347.40
     rank 17: 347.39
     rank 18: 347.32
     rank 19: 346.75
  forward-send:
     rank  0: 143.31
     rank  1: 137.52
     rank  2: 143.01
     rank  3: 141.48
     rank  4: 15.43
     rank  5: 13.48
     rank  6: 15.22
     rank  7: 14.78
     rank  8: 10.01
     rank  9: 9.81
     rank 10: 8.74
     rank 11: 10.13
     rank 12: 5.08
     rank 13: 5.01
     rank 14: 4.91
     rank 15: 4.26
  backward-recv:
     rank  0: 848.47
     rank  1: 850.72
     rank  2: 848.40
     rank  3: 850.49
     rank  4: 312.83
     rank  5: 312.24
     rank  6: 313.07
     rank  7: 315.12
     rank  8: 207.03
     rank  9: 208.29
     rank 10: 207.35
     rank 11: 206.28
     rank 12: 101.94
     rank 13: 101.92
     rank 14: 102.59
     rank 15: 102.49
  backward-send:
     rank  4: 10.65
     rank  5: 10.55
     rank  6: 10.37
     rank  7: 8.39
     rank  8: 15.17
     rank  9: 14.19
     rank 10: 14.73
     rank 11: 15.04
     rank 12: 10.21
     rank 13: 10.17
     rank 14: 9.54
     rank 15: 8.86
     rank 16: 5.14
     rank 17: 5.14
     rank 18: 4.85
     rank 19: 4.46
  forward-send-backward-recv:
     rank  0: 4771.55
     rank  1: 4758.11
     rank  2: 4764.65
     rank  3: 4759.89
     rank  4: 543.61
     rank  5: 541.07
     rank  6: 537.11
     rank  7: 542.07
     rank  8: 550.19
     rank  9: 563.10
     rank 10: 556.20
     rank 11: 544.59
     rank 12: 446.95
     rank 13: 447.64
     rank 14: 453.91
     rank 15: 448.82
  backward-send-forward-recv:
     rank  4: 85.00
     rank  5: 80.45
     rank  6: 85.82
     rank  7: 80.32
     rank  8: 177.57
     rank  9: 170.61
     rank 10: 172.81
     rank 11: 176.52
     rank 12: 171.86
     rank 13: 170.58
     rank 14: 163.59
     rank 15: 155.99
     rank 16: 177.31
     rank 17: 177.73
     rank 18: 172.32
     rank 19: 165.07
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.05
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.07
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.05
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.07
     rank 17: 0.05
     rank 18: 0.05
     rank 19: 0.15
  all-grads-sync:
     rank  0: 0.29
     rank  1: 0.26
     rank  2: 0.28
     rank  3: 0.29
     rank  4: 2.34
     rank  5: 2.62
     rank  6: 2.29
     rank  7: 2.35
     rank  8: 2.20
     rank  9: 2.14
     rank 10: 2.17
     rank 11: 2.20
     rank 12: 2.21
     rank 13: 2.23
     rank 14: 2.15
     rank 15: 2.14
     rank 16: 2.45
     rank 17: 2.44
     rank 18: 2.33
     rank 19: 2.74
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.05
     rank  5: 0.10
     rank  6: 0.04
     rank  7: 0.05
     rank  8: 0.05
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.05
     rank 12: 0.06
     rank 13: 0.06
     rank 14: 0.04
     rank 15: 0.04
     rank 16: 0.07
     rank 17: 0.07
     rank 18: 0.04
     rank 19: 0.09
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.03
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.01
     rank 19: 0.03
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.03
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.03
  optimizer-inner-step:
     rank  0: 1.99
     rank  1: 1.98
     rank  2: 1.98
     rank  3: 1.98
     rank  4: 46.37
     rank  5: 46.35
     rank  6: 46.31
     rank  7: 46.37
     rank  8: 43.09
     rank  9: 42.93
     rank 10: 43.03
     rank 11: 43.06
     rank 12: 43.07
     rank 13: 43.12
     rank 14: 43.02
     rank 15: 43.00
     rank 16: 46.36
     rank 17: 46.43
     rank 18: 46.35
     rank 19: 46.69
  optimizer:
     rank  0: 3.12
     rank  1: 3.10
     rank  2: 3.11
     rank  3: 3.10
     rank  4: 47.51
     rank  5: 47.44
     rank  6: 47.44
     rank  7: 47.49
     rank  8: 44.22
     rank  9: 44.06
     rank 10: 44.16
     rank 11: 44.19
     rank 12: 44.20
     rank 13: 44.24
     rank 14: 44.14
     rank 15: 44.12
     rank 16: 47.49
     rank 17: 47.55
     rank 18: 47.48
     rank 19: 47.77
 [2024-12-31 11:58:11] iteration        6/      10 | consumed samples:          192 | elapsed time per iteration (ms): 7672.4 | learning rate: 4.500000E-06 | global batch size:    32 | lm loss: 2.015450E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 7588.90
     rank  1: 7588.90
     rank  2: 7588.90
     rank  3: 7589.00
     rank  4: 7593.05
     rank  5: 7593.06
     rank  6: 7593.06
     rank  7: 7593.19
     rank  8: 7592.86
     rank  9: 7592.83
     rank 10: 7592.84
     rank 11: 7592.97
     rank 12: 7592.80
     rank 13: 7592.79
     rank 14: 7592.79
     rank 15: 7592.90
     rank 16: 7593.06
     rank 17: 7593.10
     rank 18: 7593.02
     rank 19: 7593.19
  forward-compute:
     rank  0: 1733.37
     rank  1: 1767.35
     rank  2: 1737.43
     rank  3: 1756.09
     rank  4: 3085.94
     rank  5: 3107.70
     rank  6: 3092.35
     rank  7: 3103.17
     rank  8: 2925.32
     rank  9: 2941.33
     rank 10: 2926.07
     rank 11: 2928.67
     rank 12: 2935.32
     rank 13: 2934.21
     rank 14: 2945.78
     rank 15: 2951.07
     rank 16: 3083.88
     rank 17: 3085.56
     rank 18: 3098.93
     rank 19: 3088.71
  backward-compute:
     rank  0: 66.82
     rank  1: 50.98
     rank  2: 67.06
     rank  3: 58.09
     rank  4: 3450.63
     rank  5: 3458.74
     rank  6: 3452.80
     rank  7: 3449.81
     rank  8: 3402.23
     rank  9: 3399.37
     rank 10: 3409.84
     rank 11: 3413.29
     rank 12: 3422.84
     rank 13: 3425.46
     rank 14: 3431.94
     rank 15: 3421.83
     rank 16: 3608.54
     rank 17: 3608.50
     rank 18: 3616.04
     rank 19: 3612.98
  pure-backward-compute:
     rank  0: 65.56
     rank  1: 49.98
     rank  2: 65.75
     rank  3: 56.95
     rank  4: 3448.31
     rank  5: 3457.03
     rank  6: 3450.88
     rank  7: 3448.38
     rank  8: 3399.18
     rank  9: 3397.99
     rank 10: 3408.45
     rank 11: 3410.48
     rank 12: 3419.50
     rank 13: 3422.98
     rank 14: 3430.31
     rank 15: 3420.51
     rank 16: 3603.25
     rank 17: 3603.87
     rank 18: 3613.40
     rank 19: 3608.23
  batch-generator:
     rank  0: 86.52
     rank  1: 115.97
     rank  2: 88.47
     rank  3: 107.68
     rank  4: 132.07
     rank  5: 158.11
     rank  6: 134.89
     rank  7: 142.46
     rank  8: 115.79
     rank  9: 123.49
     rank 10: 113.90
     rank 11: 120.60
     rank 12: 111.89
     rank 13: 110.70
     rank 14: 122.51
     rank 15: 128.59
     rank 16: 107.84
     rank 17: 110.80
     rank 18: 120.25
     rank 19: 117.88
  forward-recv:
     rank  4: 65.40
     rank  5: 62.32
     rank  6: 65.25
     rank  7: 65.17
     rank  8: 171.81
     rank  9: 169.89
     rank 10: 174.08
     rank 11: 171.81
     rank 12: 261.54
     rank 13: 262.06
     rank 14: 260.50
     rank 15: 262.44
     rank 16: 350.67
     rank 17: 350.65
     rank 18: 350.44
     rank 19: 350.07
  forward-send:
     rank  0: 145.11
     rank  1: 138.90
     rank  2: 145.03
     rank  3: 143.52
     rank  4: 15.31
     rank  5: 13.44
     rank  6: 15.27
     rank  7: 14.66
     rank  8: 9.54
     rank  9: 8.89
     rank 10: 7.96
     rank 11: 9.55
     rank 12: 5.10
     rank 13: 5.07
     rank 14: 4.81
     rank 15: 4.35
  backward-recv:
     rank  0: 849.91
     rank  1: 852.87
     rank  2: 850.25
     rank  3: 850.92
     rank  4: 311.29
     rank  5: 312.72
     rank  6: 311.51
     rank  7: 312.23
     rank  8: 207.48
     rank  9: 209.15
     rank 10: 208.96
     rank 11: 208.05
     rank 12: 102.51
     rank 13: 102.51
     rank 14: 102.96
     rank 15: 103.42
  backward-send:
     rank  4: 10.77
     rank  5: 9.69
     rank  6: 10.78
     rank  7: 9.75
     rank  8: 15.26
     rank  9: 14.36
     rank 10: 14.77
     rank 11: 14.87
     rank 12: 10.00
     rank 13: 9.48
     rank 14: 9.36
     rank 15: 8.99
     rank 16: 5.21
     rank 17: 5.13
     rank 18: 4.76
     rank 19: 4.93
  forward-send-backward-recv:
     rank  0: 4783.99
     rank  1: 4770.22
     rank  2: 4779.97
     rank  3: 4771.50
     rank  4: 535.47
     rank  5: 525.63
     rank  6: 530.47
     rank  7: 533.94
     rank  8: 502.18
     rank  9: 513.48
     rank 10: 506.33
     rank 11: 493.75
     rank 12: 414.31
     rank 13: 416.53
     rank 14: 419.32
     rank 15: 425.28
  backward-send-forward-recv:
     rank  4: 86.42
     rank  5: 77.83
     rank  6: 86.37
     rank  7: 80.25
     rank  8: 215.34
     rank  9: 204.57
     rank 10: 213.39
     rank 11: 212.95
     rank 12: 187.89
     rank 13: 187.26
     rank 14: 176.49
     rank 15: 172.55
     rank 16: 180.82
     rank 17: 181.63
     rank 18: 168.42
     rank 19: 177.23
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.05
     rank 17: 0.06
     rank 18: 0.04
     rank 19: 0.09
  all-grads-sync:
     rank  0: 0.30
     rank  1: 0.28
     rank  2: 0.29
     rank  3: 0.28
     rank  4: 2.29
     rank  5: 2.29
     rank  6: 2.33
     rank  7: 2.30
     rank  8: 2.20
     rank  9: 2.18
     rank 10: 2.15
     rank 11: 2.23
     rank 12: 2.20
     rank 13: 2.16
     rank 14: 2.20
     rank 15: 2.18
     rank 16: 2.38
     rank 17: 2.40
     rank 18: 2.30
     rank 19: 2.57
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.04
     rank  5: 0.03
     rank  6: 0.05
     rank  7: 0.04
     rank  8: 0.05
     rank  9: 0.04
     rank 10: 0.03
     rank 11: 0.06
     rank 12: 0.05
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.04
     rank 16: 0.06
     rank 17: 0.06
     rank 18: 0.04
     rank 19: 0.07
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 1.99
     rank  1: 1.99
     rank  2: 2.00
     rank  3: 1.99
     rank  4: 46.25
     rank  5: 46.25
     rank  6: 46.34
     rank  7: 46.33
     rank  8: 43.11
     rank  9: 43.00
     rank 10: 42.99
     rank 11: 43.05
     rank 12: 43.10
     rank 13: 43.01
     rank 14: 43.07
     rank 15: 43.08
     rank 16: 46.25
     rank 17: 46.30
     rank 18: 46.30
     rank 19: 46.50
  optimizer:
     rank  0: 2.57
     rank  1: 2.57
     rank  2: 2.59
     rank  3: 2.57
     rank  4: 46.83
     rank  5: 46.83
     rank  6: 46.92
     rank  7: 46.91
     rank  8: 43.69
     rank  9: 43.59
     rank 10: 43.58
     rank 11: 43.63
     rank 12: 43.68
     rank 13: 43.59
     rank 14: 43.65
     rank 15: 43.66
     rank 16: 46.83
     rank 17: 46.88
     rank 18: 46.89
     rank 19: 47.07
 [2024-12-31 11:58:18] iteration        7/      10 | consumed samples:          224 | elapsed time per iteration (ms): 7696.8 | learning rate: 5.250000E-06 | global batch size:    32 | lm loss: 2.349728E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 7611.59
     rank  1: 7611.57
     rank  2: 7611.74
     rank  3: 7611.57
     rank  4: 7615.75
     rank  5: 7615.73
     rank  6: 7615.97
     rank  7: 7615.73
     rank  8: 7615.53
     rank  9: 7615.51
     rank 10: 7615.72
     rank 11: 7615.59
     rank 12: 7615.50
     rank 13: 7615.47
     rank 14: 7615.64
     rank 15: 7615.43
     rank 16: 7615.86
     rank 17: 7615.86
     rank 18: 7616.38
     rank 19: 7615.81
  forward-compute:
     rank  0: 1926.80
     rank  1: 1962.47
     rank  2: 1932.86
     rank  3: 1947.50
     rank  4: 3078.13
     rank  5: 3103.17
     rank  6: 3082.70
     rank  7: 3091.83
     rank  8: 2915.47
     rank  9: 2925.14
     rank 10: 2921.92
     rank 11: 2913.93
     rank 12: 2949.11
     rank 13: 2949.88
     rank 14: 2960.52
     rank 15: 2967.69
     rank 16: 3101.69
     rank 17: 3103.29
     rank 18: 3122.11
     rank 19: 3107.78
  backward-compute:
     rank  0: 67.33
     rank  1: 51.37
     rank  2: 67.16
     rank  3: 58.73
     rank  4: 3445.30
     rank  5: 3448.00
     rank  6: 3454.36
     rank  7: 3444.51
     rank  8: 3400.76
     rank  9: 3400.03
     rank 10: 3407.28
     rank 11: 3412.61
     rank 12: 3425.09
     rank 13: 3427.36
     rank 14: 3435.01
     rank 15: 3423.92
     rank 16: 3616.99
     rank 17: 3616.79
     rank 18: 3624.41
     rank 19: 3621.94
  pure-backward-compute:
     rank  0: 66.09
     rank  1: 50.29
     rank  2: 65.86
     rank  3: 57.52
     rank  4: 3443.17
     rank  5: 3446.48
     rank  6: 3452.10
     rank  7: 3442.98
     rank  8: 3398.01
     rank  9: 3398.64
     rank 10: 3405.76
     rank 11: 3409.83
     rank 12: 3421.80
     rank 13: 3424.66
     rank 14: 3433.58
     rank 15: 3422.51
     rank 16: 3611.31
     rank 17: 3611.82
     rank 18: 3621.86
     rank 19: 3617.13
  batch-generator:
     rank  0: 215.99
     rank  1: 247.33
     rank  2: 220.21
     rank  3: 235.64
     rank  4: 120.62
     rank  5: 145.41
     rank  6: 135.63
     rank  7: 136.66
     rank  8: 107.37
     rank  9: 113.01
     rank 10: 114.61
     rank 11: 112.88
     rank 12: 122.40
     rank 13: 123.58
     rank 14: 131.31
     rank 15: 139.34
     rank 16: 112.49
     rank 17: 114.66
     rank 18: 127.48
     rank 19: 120.40
  forward-recv:
     rank  4: 65.06
     rank  5: 63.48
     rank  6: 64.10
     rank  7: 64.97
     rank  8: 166.86
     rank  9: 166.38
     rank 10: 168.11
     rank 11: 166.98
     rank 12: 259.18
     rank 13: 259.04
     rank 14: 258.52
     rank 15: 259.93
     rank 16: 348.23
     rank 17: 348.16
     rank 18: 347.93
     rank 19: 347.74
  forward-send:
     rank  0: 140.40
     rank  1: 136.17
     rank  2: 138.11
     rank  3: 139.01
     rank  4: 15.84
     rank  5: 14.28
     rank  6: 14.50
     rank  7: 15.14
     rank  8: 10.12
     rank  9: 9.74
     rank 10: 8.66
     rank 11: 10.09
     rank 12: 5.17
     rank 13: 5.14
     rank 14: 4.75
     rank 15: 4.54
  backward-recv:
     rank  0: 854.97
     rank  1: 857.18
     rank  2: 855.27
     rank  3: 855.75
     rank  4: 317.08
     rank  5: 316.32
     rank  6: 315.84
     rank  7: 317.82
     rank  8: 208.88
     rank  9: 209.95
     rank 10: 209.17
     rank 11: 208.42
     rank 12: 103.52
     rank 13: 103.61
     rank 14: 103.87
     rank 15: 104.07
  backward-send:
     rank  4: 10.03
     rank  5: 9.45
     rank  6: 10.57
     rank  7: 9.68
     rank  8: 15.17
     rank  9: 14.03
     rank 10: 14.68
     rank 11: 15.05
     rank 12: 10.29
     rank 13: 9.92
     rank 14: 9.69
     rank 15: 9.31
     rank 16: 5.19
     rank 17: 5.26
     rank 18: 4.71
     rank 19: 4.57
  forward-send-backward-recv:
     rank  0: 4611.46
     rank  1: 4595.20
     rank  2: 4608.47
     rank  3: 4601.57
     rank  4: 566.37
     rank  5: 564.13
     rank  6: 555.71
     rank  7: 567.00
     rank  8: 588.53
     rank  9: 597.42
     rank 10: 593.55
     rank 11: 580.63
     rank 12: 435.76
     rank 13: 437.01
     rank 14: 437.74
     rank 15: 448.04
  backward-send-forward-recv:
     rank  4: 86.56
     rank  5: 71.67
     rank  6: 87.52
     rank  7: 81.10
     rank  8: 167.34
     rank  9: 159.98
     rank 10: 159.58
     rank 11: 167.18
     rank 12: 172.16
     rank 13: 170.31
     rank 14: 161.86
     rank 15: 154.60
     rank 16: 176.89
     rank 17: 177.59
     rank 18: 160.59
     rank 19: 173.02
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.03
     rank 17: 0.03
     rank 18: 0.06
     rank 19: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.07
     rank 17: 0.07
     rank 18: 0.15
     rank 19: 0.07
  all-grads-sync:
     rank  0: 0.28
     rank  1: 0.28
     rank  2: 0.28
     rank  3: 0.33
     rank  4: 2.28
     rank  5: 2.28
     rank  6: 2.35
     rank  7: 2.29
     rank  8: 2.17
     rank  9: 2.13
     rank 10: 2.14
     rank 11: 2.26
     rank 12: 2.21
     rank 13: 2.15
     rank 14: 2.15
     rank 15: 2.15
     rank 16: 2.47
     rank 17: 2.47
     rank 18: 2.73
     rank 19: 2.44
  optimizer-copy-to-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.04
     rank  5: 0.03
     rank  6: 0.05
     rank  7: 0.04
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.03
     rank 11: 0.14
     rank 12: 0.05
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.04
     rank 16: 0.07
     rank 17: 0.07
     rank 18: 0.08
     rank 19: 0.06
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.03
     rank 19: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.03
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 2.00
     rank  1: 1.99
     rank  2: 1.99
     rank  3: 2.06
     rank  4: 46.24
     rank  5: 46.22
     rank  6: 46.39
     rank  7: 46.30
     rank  8: 43.02
     rank  9: 42.95
     rank 10: 42.98
     rank 11: 43.11
     rank 12: 43.11
     rank 13: 43.01
     rank 14: 42.98
     rank 15: 43.03
     rank 16: 46.40
     rank 17: 46.39
     rank 18: 46.65
     rank 19: 46.50
  optimizer:
     rank  0: 3.00
     rank  1: 3.00
     rank  2: 3.00
     rank  3: 3.07
     rank  4: 47.25
     rank  5: 47.23
     rank  6: 47.41
     rank  7: 47.30
     rank  8: 44.03
     rank  9: 43.96
     rank 10: 43.99
     rank 11: 44.13
     rank 12: 44.12
     rank 13: 44.01
     rank 14: 43.98
     rank 15: 44.04
     rank 16: 47.41
     rank 17: 47.41
     rank 18: 47.66
     rank 19: 47.51
 [2024-12-31 11:58:26] iteration        8/      10 | consumed samples:          256 | elapsed time per iteration (ms): 7691.4 | learning rate: 6.000000E-06 | global batch size:    32 | lm loss: 2.005119E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 7605.92
     rank  1: 7605.83
     rank  2: 7605.82
     rank  3: 7605.86
     rank  4: 7610.15
     rank  5: 7610.03
     rank  6: 7610.06
     rank  7: 7610.02
     rank  8: 7609.89
     rank  9: 7609.77
     rank 10: 7609.75
     rank 11: 7609.81
     rank 12: 7609.82
     rank 13: 7609.73
     rank 14: 7609.73
     rank 15: 7609.72
     rank 16: 7610.14
     rank 17: 7610.00
     rank 18: 7609.97
     rank 19: 7609.94
  forward-compute:
     rank  0: 1740.64
     rank  1: 1777.83
     rank  2: 1745.08
     rank  3: 1762.29
     rank  4: 3060.84
     rank  5: 3087.42
     rank  6: 3066.22
     rank  7: 3075.03
     rank  8: 2909.03
     rank  9: 2919.91
     rank 10: 2915.00
     rank 11: 2907.62
     rank 12: 2923.40
     rank 13: 2923.24
     rank 14: 2930.60
     rank 15: 2938.68
     rank 16: 3096.64
     rank 17: 3097.74
     rank 18: 3106.00
     rank 19: 3105.33
  backward-compute:
     rank  0: 67.63
     rank  1: 50.48
     rank  2: 67.62
     rank  3: 57.87
     rank  4: 3444.99
     rank  5: 3449.19
     rank  6: 3452.78
     rank  7: 3444.31
     rank  8: 3399.27
     rank  9: 3397.57
     rank 10: 3402.28
     rank 11: 3409.06
     rank 12: 3424.02
     rank 13: 3425.57
     rank 14: 3427.16
     rank 15: 3425.98
     rank 16: 3617.42
     rank 17: 3618.85
     rank 18: 3623.67
     rank 19: 3622.66
  pure-backward-compute:
     rank  0: 66.39
     rank  1: 49.50
     rank  2: 66.36
     rank  3: 56.75
     rank  4: 3442.69
     rank  5: 3447.71
     rank  6: 3450.64
     rank  7: 3442.99
     rank  8: 3396.97
     rank  9: 3396.18
     rank 10: 3400.89
     rank 11: 3405.89
     rank 12: 3421.48
     rank 13: 3422.89
     rank 14: 3425.68
     rank 15: 3424.65
     rank 16: 3611.90
     rank 17: 3614.28
     rank 18: 3620.14
     rank 19: 3618.53
  batch-generator:
     rank  0: 86.02
     rank  1: 118.46
     rank  2: 87.96
     rank  3: 105.71
     rank  4: 115.31
     rank  5: 145.92
     rank  6: 127.37
     rank  7: 128.35
     rank  8: 93.82
     rank  9: 104.82
     rank 10: 104.36
     rank 11: 105.34
     rank 12: 98.76
     rank 13: 103.21
     rank 14: 109.51
     rank 15: 119.38
     rank 16: 109.58
     rank 17: 110.15
     rank 18: 114.82
     rank 19: 120.96
  forward-recv:
     rank  4: 63.51
     rank  5: 60.20
     rank  6: 63.33
     rank  7: 63.04
     rank  8: 168.15
     rank  9: 167.14
     rank 10: 170.58
     rank 11: 168.01
     rank 12: 258.06
     rank 13: 257.88
     rank 14: 256.98
     rank 15: 259.09
     rank 16: 348.03
     rank 17: 348.01
     rank 18: 347.95
     rank 19: 347.39
  forward-send:
     rank  0: 141.76
     rank  1: 135.66
     rank  2: 141.81
     rank  3: 139.85
     rank  4: 15.17
     rank  5: 13.15
     rank  6: 15.29
     rank  7: 14.67
     rank  8: 9.97
     rank  9: 9.64
     rank 10: 8.28
     rank 11: 10.08
     rank 12: 5.10
     rank 13: 5.05
     rank 14: 4.77
     rank 15: 4.30
  backward-recv:
     rank  0: 852.61
     rank  1: 854.95
     rank  2: 852.72
     rank  3: 853.92
     rank  4: 316.89
     rank  5: 318.12
     rank  6: 316.12
     rank  7: 318.22
     rank  8: 209.07
     rank  9: 209.99
     rank 10: 209.52
     rank 11: 208.86
     rank 12: 103.56
     rank 13: 103.30
     rank 14: 103.94
     rank 15: 103.81
  backward-send:
     rank  4: 10.63
     rank  5: 9.04
     rank  6: 10.70
     rank  7: 9.40
     rank  8: 15.23
     rank  9: 14.37
     rank 10: 14.71
     rank 11: 14.88
     rank 12: 10.17
     rank 13: 9.91
     rank 14: 9.61
     rank 15: 9.28
     rank 16: 5.00
     rank 17: 5.04
     rank 18: 4.68
     rank 19: 4.27
  forward-send-backward-recv:
     rank  0: 4793.40
     rank  1: 4778.28
     rank  2: 4789.50
     rank  3: 4783.65
     rank  4: 579.01
     rank  5: 574.77
     rank  6: 568.82
     rank  7: 580.03
     rank  8: 589.58
     rank  9: 596.96
     rank 10: 595.56
     rank 11: 581.70
     rank 12: 462.23
     rank 13: 463.17
     rank 14: 468.83
     rank 15: 470.07
  backward-send-forward-recv:
     rank  4: 87.20
     rank  5: 73.63
     rank  6: 86.84
     rank  7: 82.29
     rank  8: 169.59
     rank  9: 162.48
     rank 10: 162.20
     rank 11: 169.15
     rank 12: 172.08
     rank 13: 170.72
     rank 14: 165.40
     rank 15: 156.32
     rank 16: 179.26
     rank 17: 179.12
     rank 18: 171.88
     rank 19: 172.50
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
     rank 16: 0.03
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.08
     rank 17: 0.05
     rank 18: 0.05
     rank 19: 0.05
  all-grads-sync:
     rank  0: 0.30
     rank  1: 0.28
     rank  2: 0.28
     rank  3: 0.29
     rank  4: 2.35
     rank  5: 2.33
     rank  6: 2.36
     rank  7: 2.31
     rank  8: 2.18
     rank  9: 2.14
     rank 10: 2.14
     rank 11: 2.29
     rank 12: 2.16
     rank 13: 2.15
     rank 14: 2.21
     rank 15: 2.14
     rank 16: 2.51
     rank 17: 2.39
     rank 18: 2.37
     rank 19: 2.37
  optimizer-copy-to-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.04
     rank  8: 0.04
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.06
     rank 12: 0.05
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.03
     rank 16: 0.08
     rank 17: 0.07
     rank 18: 0.05
     rank 19: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 1.98
     rank  1: 1.98
     rank  2: 1.99
     rank  3: 1.98
     rank  4: 46.37
     rank  5: 46.34
     rank  6: 46.42
     rank  7: 46.33
     rank  8: 43.05
     rank  9: 42.95
     rank 10: 42.96
     rank 11: 43.06
     rank 12: 43.03
     rank 13: 43.02
     rank 14: 43.05
     rank 15: 43.00
     rank 16: 46.54
     rank 17: 46.33
     rank 18: 46.42
     rank 19: 46.39
  optimizer:
     rank  0: 2.81
     rank  1: 2.81
     rank  2: 2.82
     rank  3: 2.81
     rank  4: 47.21
     rank  5: 47.17
     rank  6: 47.26
     rank  7: 47.15
     rank  8: 43.88
     rank  9: 43.78
     rank 10: 43.78
     rank 11: 43.89
     rank 12: 43.86
     rank 13: 43.85
     rank 14: 43.88
     rank 15: 43.82
     rank 16: 47.36
     rank 17: 47.16
     rank 18: 47.26
     rank 19: 47.22
 [2024-12-31 11:58:34] iteration        9/      10 | consumed samples:          288 | elapsed time per iteration (ms): 7677.8 | learning rate: 6.750000E-06 | global batch size:    32 | lm loss: 2.058950E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 7596.13
     rank  1: 7596.09
     rank  2: 7596.12
     rank  3: 7596.07
     rank  4: 7600.29
     rank  5: 7600.24
     rank  6: 7600.32
     rank  7: 7600.22
     rank  8: 7600.03
     rank  9: 7600.03
     rank 10: 7600.03
     rank 11: 7600.00
     rank 12: 7600.04
     rank 13: 7600.00
     rank 14: 7600.00
     rank 15: 7599.93
     rank 16: 7600.22
     rank 17: 7600.24
     rank 18: 7600.21
     rank 19: 7600.19
  forward-compute:
     rank  0: 1745.13
     rank  1: 1781.66
     rank  2: 1748.78
     rank  3: 1763.98
     rank  4: 3063.05
     rank  5: 3088.43
     rank  6: 3066.27
     rank  7: 3072.06
     rank  8: 2906.99
     rank  9: 2917.34
     rank 10: 2913.42
     rank 11: 2905.43
     rank 12: 2917.92
     rank 13: 2916.74
     rank 14: 2922.95
     rank 15: 2931.86
     rank 16: 3087.61
     rank 17: 3088.53
     rank 18: 3095.61
     rank 19: 3108.32
  backward-compute:
     rank  0: 67.73
     rank  1: 50.86
     rank  2: 67.39
     rank  3: 57.14
     rank  4: 3442.88
     rank  5: 3446.73
     rank  6: 3451.15
     rank  7: 3443.66
     rank  8: 3401.36
     rank  9: 3400.03
     rank 10: 3404.64
     rank 11: 3409.46
     rank 12: 3426.25
     rank 13: 3426.77
     rank 14: 3429.15
     rank 15: 3435.16
     rank 16: 3619.70
     rank 17: 3620.41
     rank 18: 3626.19
     rank 19: 3625.44
  pure-backward-compute:
     rank  0: 66.41
     rank  1: 49.87
     rank  2: 66.15
     rank  3: 56.04
     rank  4: 3441.11
     rank  5: 3445.41
     rank  6: 3448.69
     rank  7: 3442.34
     rank  8: 3399.06
     rank  9: 3398.64
     rank 10: 3403.27
     rank 11: 3406.75
     rank 12: 3423.51
     rank 13: 3424.18
     rank 14: 3427.68
     rank 15: 3433.83
     rank 16: 3614.20
     rank 17: 3615.74
     rank 18: 3623.13
     rank 19: 3622.81
  batch-generator:
     rank  0: 84.35
     rank  1: 116.41
     rank  2: 86.09
     rank  3: 101.63
     rank  4: 110.90
     rank  5: 137.01
     rank  6: 124.24
     rank  7: 121.46
     rank  8: 101.00
     rank  9: 109.78
     rank 10: 109.78
     rank 11: 108.41
     rank 12: 96.57
     rank 13: 99.68
     rank 14: 105.52
     rank 15: 115.10
     rank 16: 108.31
     rank 17: 109.14
     rank 18: 112.58
     rank 19: 126.23
  forward-recv:
     rank  4: 63.51
     rank  5: 60.18
     rank  6: 63.54
     rank  7: 62.85
     rank  8: 171.70
     rank  9: 170.47
     rank 10: 173.66
     rank 11: 171.46
     rank 12: 261.02
     rank 13: 260.87
     rank 14: 260.25
     rank 15: 261.88
     rank 16: 347.32
     rank 17: 347.35
     rank 18: 347.21
     rank 19: 346.76
  forward-send:
     rank  0: 137.79
     rank  1: 131.22
     rank  2: 137.58
     rank  3: 135.15
     rank  4: 15.38
     rank  5: 13.00
     rank  6: 15.19
     rank  7: 14.48
     rank  8: 10.11
     rank  9: 9.71
     rank 10: 8.77
     rank 11: 10.12
     rank 12: 5.12
     rank 13: 5.07
     rank 14: 4.83
     rank 15: 4.36
  backward-recv:
     rank  0: 850.56
     rank  1: 852.52
     rank  2: 850.48
     rank  3: 851.46
     rank  4: 314.69
     rank  5: 315.89
     rank  6: 313.47
     rank  7: 315.32
     rank  8: 206.93
     rank  9: 207.77
     rank 10: 207.58
     rank 11: 206.64
     rank 12: 103.23
     rank 13: 103.28
     rank 14: 103.83
     rank 15: 104.07
  backward-send:
     rank  4: 10.54
     rank  5: 9.15
     rank  6: 10.89
     rank  7: 9.72
     rank  8: 15.19
     rank  9: 14.65
     rank 10: 14.55
     rank 11: 14.78
     rank 12: 10.16
     rank 13: 9.90
     rank 14: 9.60
     rank 15: 9.18
     rank 16: 5.15
     rank 17: 5.21
     rank 18: 4.88
     rank 19: 4.59
  forward-send-backward-recv:
     rank  0: 4785.22
     rank  1: 4771.58
     rank  2: 4782.87
     rank  3: 4780.25
     rank  4: 571.13
     rank  5: 568.34
     rank  6: 560.02
     rank  7: 572.13
     rank  8: 581.13
     rank  9: 588.29
     rank 10: 585.77
     rank 11: 575.52
     rank 12: 453.59
     rank 13: 456.34
     rank 14: 463.02
     rank 15: 455.75
  backward-send-forward-recv:
     rank  4: 88.94
     rank  5: 74.81
     rank  6: 89.04
     rank  7: 86.99
     rank  8: 167.75
     rank  9: 160.86
     rank 10: 160.24
     rank 11: 168.21
     rank 12: 171.59
     rank 13: 170.89
     rank 14: 165.07
     rank 15: 156.52
     rank 16: 177.23
     rank 17: 177.85
     rank 18: 171.73
     rank 19: 161.30
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.05
     rank 17: 0.05
     rank 18: 0.05
     rank 19: 0.04
  all-grads-sync:
     rank  0: 0.32
     rank  1: 0.34
     rank  2: 0.31
     rank  3: 0.27
     rank  4: 2.33
     rank  5: 2.30
     rank  6: 2.35
     rank  7: 2.29
     rank  8: 2.15
     rank  9: 2.14
     rank 10: 2.18
     rank 11: 2.15
     rank 12: 2.23
     rank 13: 2.25
     rank 14: 2.17
     rank 15: 2.15
     rank 16: 2.38
     rank 17: 2.39
     rank 18: 2.36
     rank 19: 2.31
  optimizer-copy-to-main-grad:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.04
     rank  6: 0.05
     rank  7: 0.04
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.06
     rank 13: 0.05
     rank 14: 0.08
     rank 15: 0.04
     rank 16: 0.06
     rank 17: 0.06
     rank 18: 0.05
     rank 19: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 2.07
     rank  1: 2.04
     rank  2: 2.06
     rank  3: 1.98
     rank  4: 46.32
     rank  5: 46.23
     rank  6: 46.39
     rank  7: 46.30
     rank  8: 42.98
     rank  9: 42.99
     rank 10: 43.00
     rank 11: 42.96
     rank 12: 43.16
     rank 13: 43.12
     rank 14: 43.01
     rank 15: 42.99
     rank 16: 46.31
     rank 17: 46.36
     rank 18: 46.36
     rank 19: 46.26
  optimizer:
     rank  0: 2.65
     rank  1: 2.63
     rank  2: 2.64
     rank  3: 2.57
     rank  4: 46.90
     rank  5: 46.81
     rank  6: 46.98
     rank  7: 46.88
     rank  8: 43.56
     rank  9: 43.58
     rank 10: 43.59
     rank 11: 43.54
     rank 12: 43.75
     rank 13: 43.71
     rank 14: 43.59
     rank 15: 43.58
     rank 16: 46.90
     rank 17: 46.94
     rank 18: 46.94
     rank 19: 46.84
 [2024-12-31 11:58:41] iteration       10/      10 | consumed samples:          320 | elapsed time per iteration (ms): 7733.4 | learning rate: 7.500000E-06 | global batch size:    32 | lm loss: 2.903756E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 7650.29
     rank  1: 7650.22
     rank  2: 7650.25
     rank  3: 7650.22
     rank  4: 7654.49
     rank  5: 7654.39
     rank  6: 7654.41
     rank  7: 7654.39
     rank  8: 7654.20
     rank  9: 7654.16
     rank 10: 7654.17
     rank 11: 7654.17
     rank 12: 7654.14
     rank 13: 7654.10
     rank 14: 7654.12
     rank 15: 7654.08
     rank 16: 7654.53
     rank 17: 7654.41
     rank 18: 7654.40
     rank 19: 7654.37
  forward-compute:
     rank  0: 1856.28
     rank  1: 1881.98
     rank  2: 1851.84
     rank  3: 1867.76
     rank  4: 3079.91
     rank  5: 3101.34
     rank  6: 3085.02
     rank  7: 3092.66
     rank  8: 2903.44
     rank  9: 2913.79
     rank 10: 2906.92
     rank 11: 2902.34
     rank 12: 2914.63
     rank 13: 2915.42
     rank 14: 2919.75
     rank 15: 2927.38
     rank 16: 3122.57
     rank 17: 3126.15
     rank 18: 3132.72
     rank 19: 3145.12
  backward-compute:
     rank  0: 56.40
     rank  1: 50.52
     rank  2: 67.04
     rank  3: 57.40
     rank  4: 3450.94
     rank  5: 3454.61
     rank  6: 3454.62
     rank  7: 3451.01
     rank  8: 3400.20
     rank  9: 3398.65
     rank 10: 3403.73
     rank 11: 3408.24
     rank 12: 3422.89
     rank 13: 3423.23
     rank 14: 3426.56
     rank 15: 3432.69
     rank 16: 3616.77
     rank 17: 3617.25
     rank 18: 3623.98
     rank 19: 3622.73
  pure-backward-compute:
     rank  0: 55.08
     rank  1: 49.54
     rank  2: 65.80
     rank  3: 56.30
     rank  4: 3448.59
     rank  5: 3453.06
     rank  6: 3452.49
     rank  7: 3449.62
     rank  8: 3397.82
     rank  9: 3397.29
     rank 10: 3402.36
     rank 11: 3405.92
     rank 12: 3420.27
     rank 13: 3420.74
     rank 14: 3424.96
     rank 15: 3431.24
     rank 16: 3611.33
     rank 17: 3612.91
     rank 18: 3620.75
     rank 19: 3619.77
  batch-generator:
     rank  0: 97.11
     rank  1: 115.58
     rank  2: 88.33
     rank  3: 104.20
     rank  4: 121.19
     rank  5: 146.95
     rank  6: 131.03
     rank  7: 131.54
     rank  8: 95.47
     rank  9: 105.00
     rank 10: 102.31
     rank 11: 103.32
     rank 12: 96.23
     rank 13: 98.46
     rank 14: 104.01
     rank 15: 113.68
     rank 16: 130.51
     rank 17: 128.48
     rank 18: 130.72
     rank 19: 143.96
  forward-recv:
     rank  4: 84.11
     rank  5: 80.42
     rank  6: 83.92
     rank  7: 83.77
     rank  8: 190.17
     rank  9: 189.09
     rank 10: 192.33
     rank 11: 190.23
     rank 12: 279.55
     rank 13: 279.47
     rank 14: 278.88
     rank 15: 280.46
     rank 16: 367.70
     rank 17: 367.64
     rank 18: 367.42
     rank 19: 367.16
  forward-send:
     rank  0: 141.22
     rank  1: 134.94
     rank  2: 141.38
     rank  3: 139.70
     rank  4: 15.19
     rank  5: 13.11
     rank  6: 15.24
     rank  7: 14.66
     rank  8: 10.09
     rank  9: 9.72
     rank 10: 8.55
     rank 11: 10.06
     rank 12: 5.16
     rank 13: 5.10
     rank 14: 4.73
     rank 15: 4.42
  backward-recv:
     rank  0: 858.03
     rank  1: 858.71
     rank  2: 856.52
     rank  3: 857.50
     rank  4: 317.98
     rank  5: 319.31
     rank  6: 318.41
     rank  7: 318.63
     rank  8: 211.78
     rank  9: 213.21
     rank 10: 211.98
     rank 11: 211.38
     rank 12: 104.95
     rank 13: 104.95
     rank 14: 105.11
     rank 15: 105.91
  backward-send:
     rank  4: 10.75
     rank  5: 9.06
     rank  6: 10.39
     rank  7: 9.99
     rank  8: 15.13
     rank  9: 14.03
     rank 10: 14.80
     rank 11: 14.89
     rank 12: 9.91
     rank 13: 10.54
     rank 14: 9.48
     rank 15: 9.03
     rank 16: 5.16
     rank 17: 5.12
     rank 18: 4.69
     rank 19: 5.01
  forward-send-backward-recv:
     rank  0: 4728.00
     rank  1: 4715.94
     rank  2: 4724.60
     rank  3: 4719.77
     rank  4: 574.30
     rank  5: 574.44
     rank  6: 568.19
     rank  7: 576.51
     rank  8: 613.55
     rank  9: 620.98
     rank 10: 620.03
     rank 11: 607.48
     rank 12: 494.09
     rank 13: 494.51
     rank 14: 501.39
     rank 15: 492.89
  backward-send-forward-recv:
     rank  4: 89.18
     rank  5: 78.60
     rank  6: 88.60
     rank  7: 84.04
     rank  8: 170.49
     rank  9: 163.22
     rank 10: 164.61
     rank 11: 170.97
     rank 12: 171.85
     rank 13: 171.56
     rank 14: 165.69
     rank 15: 158.55
     rank 16: 177.89
     rank 17: 176.92
     rank 18: 170.92
     rank 19: 160.74
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.02
     rank 17: 0.02
     rank 18: 0.02
     rank 19: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
     rank 16: 0.07
     rank 17: 0.05
     rank 18: 0.05
     rank 19: 0.05
  all-grads-sync:
     rank  0: 0.33
     rank  1: 0.26
     rank  2: 0.30
     rank  3: 0.27
     rank  4: 2.33
     rank  5: 2.28
     rank  6: 2.34
     rank  7: 2.28
     rank  8: 2.15
     rank  9: 2.15
     rank 10: 2.15
     rank 11: 2.15
     rank 12: 2.16
     rank 13: 2.16
     rank 14: 2.19
     rank 15: 2.16
     rank 16: 2.43
     rank 17: 2.46
     rank 18: 2.38
     rank 19: 2.35
  optimizer-copy-to-main-grad:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.03
     rank  6: 0.05
     rank  7: 0.04
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.05
     rank 12: 0.04
     rank 13: 0.05
     rank 14: 0.04
     rank 15: 0.04
     rank 16: 0.06
     rank 17: 0.06
     rank 18: 0.05
     rank 19: 0.05
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.02
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
     rank 16: 0.01
     rank 17: 0.01
     rank 18: 0.01
     rank 19: 0.01
  optimizer-inner-step:
     rank  0: 2.05
     rank  1: 1.98
     rank  2: 2.00
     rank  3: 1.98
     rank  4: 46.34
     rank  5: 46.22
     rank  6: 46.39
     rank  7: 46.31
     rank  8: 42.94
     rank  9: 42.95
     rank 10: 42.97
     rank 11: 42.97
     rank 12: 43.00
     rank 13: 43.02
     rank 14: 43.05
     rank 15: 43.01
     rank 16: 46.36
     rank 17: 46.35
     rank 18: 46.36
     rank 19: 46.32
  optimizer:
     rank  0: 2.66
     rank  1: 2.58
     rank  2: 2.61
     rank  3: 2.59
     rank  4: 46.94
     rank  5: 46.82
     rank  6: 47.00
     rank  7: 46.91
     rank  8: 43.54
     rank  9: 43.55
     rank 10: 43.57
     rank 11: 43.58
     rank 12: 43.61
     rank 13: 43.63
     rank 14: 43.65
     rank 15: 43.61
     rank 16: 46.96
     rank 17: 46.96
     rank 18: 46.97
     rank 19: 46.93
