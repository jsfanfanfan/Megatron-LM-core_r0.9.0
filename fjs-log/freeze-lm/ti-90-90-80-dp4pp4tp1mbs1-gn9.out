examples/multimodal/pretrain-freeze-llm-hete-2080tifirst.sh: line 4: activate: No such file or directory
3
[2024-12-30 22:20:56,682] torch.distributed.run: [WARNING] 
[2024-12-30 22:20:56,682] torch.distributed.run: [WARNING] *****************************************
[2024-12-30 22:20:56,682] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-12-30 22:20:56,682] torch.distributed.run: [WARNING] *****************************************
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
> setting tensorboard ...
WARNING: one_logger package is required to enable e2e metrics tracking. please go to https://confluence.nvidia.com/display/MLWFO/Package+Repositories for details to install it
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
---Rank 13---Tensor Parallel Group GPUs: [0]
---Rank 13---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
---Rank 14---Tensor Parallel Group GPUs: [0]
---Rank 15---Tensor Parallel Group GPUs: [0]
---Rank 14---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
[rank13]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
---Rank 15---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
---Rank 12---Tensor Parallel Group GPUs: [0]
---Rank 12---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
[rank14]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank15]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank12]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
 > number of parameters on (tensor, pipeline) model parallel rank (0, 3): 352333824
rank=1, worker=0: shard_range=[pretrain-2.tar[5000, 5100), pretrain-2.tar[5100, 5200), pretrain-2.tar[5200, 5300), ...<619>, pretrain-25.tar[7200, 7300), pretrain-25.tar[7300, 7400), pretrain-25.tar[7400, 7500)] sum(count)=62500
rank=1, worker=1: shard_range=[pretrain-25.tar[7500, 7600), pretrain-25.tar[7600, 7700), pretrain-25.tar[7700, 7800), ...<619>, pretrain-30.tar[9700, 9800), pretrain-30.tar[9800, 9900), pretrain-30.tar[9900, 10000)] sum(count)=62500
rank=2, worker=0: shard_range=[pretrain-31.tar[0, 100), pretrain-31.tar[100, 200), pretrain-31.tar[200, 300), ...<619>, pretrain-37.tar[2200, 2300), pretrain-37.tar[2300, 2400), pretrain-37.tar[2400, 2500)] sum(count)=62500
rank=2, worker=1: shard_range=[pretrain-37.tar[2500, 2600), pretrain-37.tar[2600, 2700), pretrain-37.tar[2700, 2800), ...<619>, pretrain-42.tar[4700, 4800), pretrain-42.tar[4800, 4900), pretrain-42.tar[4900, 5000)] sum(count)=62500
rank=0, worker=0: shard_range=[pretrain-0.tar[0, 100), pretrain-0.tar[100, 200), pretrain-0.tar[200, 300), ...<619>, pretrain-14.tar[2200, 2300), pretrain-14.tar[2300, 2400), pretrain-14.tar[2400, 2500)] sum(count)=62500
rank=0, worker=1: shard_range=[pretrain-14.tar[2500, 2600), pretrain-14.tar[2600, 2700), pretrain-14.tar[2700, 2800), ...<619>, pretrain-2.tar[4700, 4800), pretrain-2.tar[4800, 4900), pretrain-2.tar[4900, 5000)] sum(count)=62500
rank=3, worker=0: shard_range=[pretrain-42.tar[5000, 5100), pretrain-42.tar[5100, 5200), pretrain-42.tar[5200, 5300), ...<619>, pretrain-48.tar[7200, 7300), pretrain-48.tar[7300, 7400), pretrain-48.tar[7400, 7500)] sum(count)=62500
rank=3, worker=1: shard_range=[pretrain-48.tar[7500, 7600), pretrain-48.tar[7600, 7700), pretrain-48.tar[7700, 7800), ...<619>, pretrain-53.tar[9700, 9800), pretrain-53.tar[9800, 9900), pretrain-53.tar[9900, 10000)] sum(count)=62500
rank=2, worker=0: shard_range=[pretrain-7.tar[936, 8202)] sum(count)=7266
rank=2, worker=1: shard_range=[pretrain-7.tar[8202, 10000), pretrain-8.tar[0, 5468)] sum(count)=7266
rank=3, worker=0: shard_range=[pretrain-8.tar[5468, 10000), pretrain-9.tar[0, 2734)] sum(count)=7266
rank=3, worker=1: shard_range=[pretrain-9.tar[2734, 10000)] sum(count)=7266
rank=1, worker=0: shard_range=[pretrain-55.tar[4532, 8128), pretrain-6.tar[0, 3670)] sum(count)=7266
rank=1, worker=1: shard_range=[pretrain-6.tar[3670, 10000), pretrain-7.tar[0, 936)] sum(count)=7266
rank=0, worker=0: shard_range=[pretrain-54.tar[0, 7266)] sum(count)=7266
rank=0, worker=1: shard_range=[pretrain-54.tar[7266, 10000), pretrain-55.tar[0, 4532)] sum(count)=7266
times across ranks (ms):
  model-and-optimizer-setup:
     rank  0: 94.05
     rank  1: 67.57
     rank  2: 72.95
     rank  3: 69.17
     rank  4: 64.97
     rank  5: 84.50
     rank  6: 68.74
     rank  7: 68.51
     rank  8: 43.41
     rank  9: 33.40
     rank 10: 33.12
     rank 11: 40.58
     rank 12: 42.42
     rank 13: 42.42
     rank 14: 42.44
     rank 15: 42.47
  train/valid/test-data-iterators-setup:
     rank  0: 1504.21
     rank  1: 1503.91
     rank  2: 1504.10
     rank  3: 1503.92
     rank  4: 1503.95
     rank  5: 1503.91
     rank  6: 1503.98
     rank  7: 1503.93
     rank  8: 1504.03
     rank  9: 1504.35
     rank 10: 1504.22
     rank 11: 1504.02
     rank 12: 1504.07
     rank 13: 1504.10
     rank 14: 1504.07
     rank 15: 1504.08
 [2024-12-30 22:21:29] iteration        1/      10 | consumed samples:           32 | elapsed time per iteration (ms): 13406.3 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 7.235335E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
stage4 GPU utialization:17.536475441672586 %
[Rank 12] (after 1 iterations) memory (MB) | allocated: 1397.2998046875 | max allocated: 1975.30859375 | reserved: 2142.0 | max reserved: 2142.0
times across ranks (ms):
  forward-backward:
     rank  0: 13202.05
     rank  1: 13202.01
     rank  2: 13203.00
     rank  3: 13201.94
     rank  4: 13197.93
     rank  5: 13197.87
     rank  6: 13197.97
     rank  7: 13197.91
     rank  8: 13351.95
     rank  9: 13352.40
     rank 10: 13352.25
     rank 11: 13352.02
     rank 12: 13196.28
     rank 13: 13196.42
     rank 14: 13196.14
     rank 15: 13196.20
  forward-compute:
     rank  0: 2755.58
     rank  1: 2811.87
     rank  2: 2905.94
     rank  3: 2716.91
     rank  4: 3796.22
     rank  5: 3323.95
     rank  6: 3471.84
     rank  7: 3718.77
     rank  8: 3102.28
     rank  9: 3149.43
     rank 10: 3032.67
     rank 11: 3114.90
     rank 12: 2510.71
     rank 13: 2240.98
     rank 14: 2113.55
     rank 15: 1956.94
  backward-compute:
     rank  0: 1379.72
     rank  1: 1462.49
     rank  2: 1399.89
     rank  3: 1422.55
     rank  4: 1516.47
     rank  5: 1665.79
     rank  6: 1720.36
     rank  7: 1711.06
     rank  8: 928.43
     rank  9: 934.10
     rank 10: 927.67
     rank 11: 937.93
     rank 12: 639.13
     rank 13: 639.22
     rank 14: 649.65
     rank 15: 642.55
  pure-backward-compute:
     rank  0: 1378.63
     rank  1: 1461.72
     rank  2: 1399.20
     rank  3: 1421.94
     rank  4: 1515.81
     rank  5: 1665.25
     rank  6: 1719.51
     rank  7: 1710.52
     rank  8: 927.23
     rank  9: 933.05
     rank 10: 926.49
     rank 11: 936.97
     rank 12: 637.76
     rank 13: 637.76
     rank 14: 647.83
     rank 15: 640.73
  batch-generator:
     rank  0: 1196.69
     rank  1: 1223.99
     rank  2: 1251.40
     rank  3: 1223.83
     rank  4: 1011.39
     rank  5: 859.92
     rank  6: 950.91
     rank  7: 1045.31
     rank  8: 1060.22
     rank  9: 1110.73
     rank 10: 1008.46
     rank 11: 1103.32
     rank 12: 1054.35
     rank 13: 1028.85
     rank 14: 1048.69
     rank 15: 969.68
  forward-recv:
     rank  4: 2483.44
     rank  5: 2599.86
     rank  6: 2670.80
     rank  7: 2473.21
     rank  8: 5537.68
     rank  9: 5218.33
     rank 10: 5359.02
     rank 11: 5456.90
     rank 12: 7983.55
     rank 13: 7699.00
     rank 14: 7747.12
     rank 15: 7910.93
  forward-send:
     rank  0: 5514.80
     rank  1: 5151.93
     rank  2: 5124.88
     rank  3: 5460.31
     rank  4: 2360.15
     rank  5: 2401.01
     rank  6: 2295.22
     rank  7: 2363.37
     rank  8: 33.18
     rank  9: 23.60
     rank 10: 32.99
     rank 11: 25.76
  backward-recv:
     rank  0: 549.88
     rank  1: 477.41
     rank  2: 476.71
     rank  3: 484.01
     rank  4: 227.46
     rank  5: 155.71
     rank  6: 132.31
     rank  7: 151.06
     rank  8: 120.27
     rank  9: 58.02
     rank 10: 43.63
     rank 11: 53.73
  backward-send:
     rank  4: 0.99
     rank  5: 0.91
     rank  6: 1.35
     rank  7: 1.03
     rank  8: 6.49
     rank  9: 6.87
     rank 10: 5.65
     rank 11: 6.47
     rank 12: 4.70
     rank 13: 4.77
     rank 14: 4.86
     rank 15: 4.91
  forward-send-backward-recv:
     rank  0: 2685.28
     rank  1: 2975.96
     rank  2: 2971.19
     rank  3: 2799.48
     rank  4: 1576.93
     rank  5: 1727.39
     rank  6: 1676.32
     rank  7: 1509.15
     rank  8: 1487.90
     rank  9: 1613.85
     rank 10: 1573.87
     rank 11: 1403.71
  backward-send-forward-recv:
     rank  4: 871.71
     rank  5: 960.55
     rank  6: 866.48
     rank  7: 907.71
     rank  8: 1496.84
     rank  9: 1707.64
     rank 10: 1736.12
     rank 11: 1714.15
     rank 12: 1455.08
     rank 13: 2009.33
     rank 14: 2078.61
     rank 15: 2077.83
  layernorm-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.04
     rank  2: 0.19
     rank  3: 0.20
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.04
     rank  8: 0.06
     rank  9: 0.06
     rank 10: 0.04
     rank 11: 0.05
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.04
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.03
     rank  2: 0.05
     rank  3: 0.04
     rank  4: 0.08
     rank  5: 0.06
     rank  6: 0.10
     rank  7: 0.10
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.09
     rank 13: 0.10
     rank 14: 0.08
     rank 15: 0.07
  all-grads-sync:
     rank  0: 269.19
     rank  1: 269.25
     rank  2: 269.28
     rank  3: 269.26
     rank  4: 300.70
     rank  5: 300.77
     rank  6: 300.70
     rank  7: 300.65
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.04
     rank 13: 0.05
     rank 14: 0.03
     rank 15: 0.03
  optimizer-copy-to-main-grad:
     rank  0: 0.41
     rank  1: 0.19
     rank  2: 0.24
     rank  3: 0.23
     rank  4: 0.13
     rank  5: 0.11
     rank  6: 0.14
     rank  7: 0.14
     rank  8: 0.04
     rank  9: 0.06
     rank 10: 0.03
     rank 11: 0.05
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.04
     rank  9: 0.05
     rank 10: 0.03
     rank 11: 0.04
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.03
     rank  9: 0.04
     rank 10: 0.01
     rank 11: 0.03
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 48.49
     rank  1: 46.90
     rank  2: 47.88
     rank  3: 46.67
     rank  4: 24.25
     rank  5: 23.25
     rank  6: 24.54
     rank  7: 24.47
     rank  8: 0.32
     rank  9: 0.33
     rank 10: 0.16
     rank 11: 0.25
     rank 12: 0.11
     rank 13: 0.13
     rank 14: 0.10
     rank 15: 0.11
  optimizer:
     rank  0: 50.29
     rank  1: 49.11
     rank  2: 50.04
     rank  3: 48.82
     rank  4: 26.41
     rank  5: 25.41
     rank  6: 26.68
     rank  7: 26.62
     rank  8: 2.46
     rank  9: 2.54
     rank 10: 2.30
     rank 11: 2.40
     rank 12: 2.25
     rank 13: 2.25
     rank 14: 2.24
     rank 15: 2.24
 [2024-12-30 22:21:31] iteration        2/      10 | consumed samples:           64 | elapsed time per iteration (ms): 2545.1 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 7.077762E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2481.50
     rank  1: 2481.35
     rank  2: 2481.50
     rank  3: 2481.31
     rank  4: 2480.69
     rank  5: 2480.65
     rank  6: 2480.66
     rank  7: 2480.65
     rank  8: 2480.10
     rank  9: 2480.11
     rank 10: 2480.11
     rank 11: 2480.67
     rank 12: 2478.80
     rank 13: 2478.77
     rank 14: 2478.79
     rank 15: 2478.84
  forward-compute:
     rank  0: 411.30
     rank  1: 434.71
     rank  2: 457.89
     rank  3: 409.64
     rank  4: 871.98
     rank  5: 829.84
     rank  6: 883.77
     rank  7: 877.09
     rank  8: 779.67
     rank  9: 780.44
     rank 10: 772.48
     rank 11: 778.02
     rank 12: 686.46
     rank 13: 734.44
     rank 14: 622.93
     rank 15: 673.81
  backward-compute:
     rank  0: 401.80
     rank  1: 390.32
     rank  2: 395.22
     rank  3: 387.40
     rank  4: 966.73
     rank  5: 977.15
     rank  6: 990.05
     rank  7: 978.79
     rank  8: 932.53
     rank  9: 934.87
     rank 10: 930.35
     rank 11: 939.00
     rank 12: 628.08
     rank 13: 627.58
     rank 14: 628.86
     rank 15: 629.23
  pure-backward-compute:
     rank  0: 400.99
     rank  1: 389.68
     rank  2: 394.59
     rank  3: 386.78
     rank  4: 966.23
     rank  5: 976.61
     rank  6: 989.56
     rank  7: 978.34
     rank  8: 931.52
     rank  9: 933.20
     rank 10: 929.38
     rank 11: 937.81
     rank 12: 626.67
     rank 13: 626.07
     rank 14: 627.20
     rank 15: 627.65
  batch-generator:
     rank  0: 42.75
     rank  1: 43.60
     rank  2: 40.37
     rank  3: 38.45
     rank  4: 25.84
     rank  5: 25.66
     rank  6: 27.53
     rank  7: 28.78
     rank  8: 30.43
     rank  9: 32.93
     rank 10: 32.13
     rank 11: 29.56
     rank 12: 30.41
     rank 13: 36.23
     rank 14: 28.81
     rank 15: 32.08
  forward-recv:
     rank  4: 50.57
     rank  5: 45.50
     rank  6: 61.59
     rank  7: 43.01
     rank  8: 171.19
     rank  9: 153.64
     rank 10: 191.33
     rank 11: 167.36
     rank 12: 261.23
     rank 13: 249.90
     rank 14: 273.99
     rank 15: 255.32
  forward-send:
     rank  0: 126.63
     rank  1: 109.37
     rank  2: 107.33
     rank  3: 129.82
     rank  4: 3.13
     rank  5: 3.13
     rank  6: 3.44
     rank  7: 3.26
     rank  8: 2.76
     rank  9: 3.00
     rank 10: 1.81
     rank 11: 1.86
  backward-recv:
     rank  0: 489.33
     rank  1: 493.48
     rank  2: 466.15
     rank  3: 477.29
     rank  4: 154.21
     rank  5: 166.93
     rank  6: 136.15
     rank  7: 145.71
     rank  8: 53.69
     rank  9: 69.01
     rank 10: 42.79
     rank 11: 49.74
  backward-send:
     rank  4: 0.94
     rank  5: 1.20
     rank  6: 1.02
     rank  7: 1.07
     rank  8: 6.45
     rank  9: 6.68
     rank 10: 6.94
     rank 11: 6.75
     rank 12: 5.24
     rank 13: 4.71
     rank 14: 5.25
     rank 15: 5.33
  forward-send-backward-recv:
     rank  0: 857.07
     rank  1: 860.59
     rank  2: 871.33
     rank  3: 886.26
     rank  4: 191.29
     rank  5: 216.56
     rank  6: 166.21
     rank  7: 192.42
     rank  8: 105.98
     rank  9: 122.22
     rank 10: 79.04
     rank 11: 102.44
  backward-send-forward-recv:
     rank  4: 3.53
     rank  5: 4.07
     rank  6: 3.39
     rank  7: 3.32
     rank  8: 69.62
     rank  9: 51.64
     rank 10: 96.14
     rank 11: 77.49
     rank 12: 421.84
     rank 13: 385.45
     rank 14: 471.66
     rank 15: 439.18
  layernorm-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.03
     rank  2: 0.04
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.04
     rank  9: 0.03
     rank 10: 0.04
     rank 11: 0.27
     rank 12: 0.08
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.05
  embedding-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.13
     rank 12: 0.12
     rank 13: 0.07
     rank 14: 0.08
     rank 15: 0.13
  all-grads-sync:
     rank  0: 144.18
     rank  1: 144.20
     rank  2: 144.26
     rank  3: 144.20
     rank  4: 171.91
     rank  5: 171.97
     rank  6: 171.94
     rank  7: 171.87
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.04
     rank 15: 0.05
  optimizer-copy-to-main-grad:
     rank  0: 0.31
     rank  1: 0.14
     rank  2: 0.25
     rank  3: 0.14
     rank  4: 0.08
     rank  5: 0.08
     rank  6: 0.10
     rank  7: 0.09
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.13
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.15
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.03
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 27.28
     rank  1: 26.71
     rank  2: 27.35
     rank  3: 26.54
     rank  4: 21.13
     rank  5: 21.13
     rank  6: 21.25
     rank  7: 21.18
     rank  8: 0.11
     rank  9: 0.12
     rank 10: 0.10
     rank 11: 1.08
     rank 12: 0.07
     rank 13: 0.04
     rank 14: 0.08
     rank 15: 0.09
  optimizer:
     rank  0: 31.08
     rank  1: 30.52
     rank  2: 31.16
     rank  3: 30.35
     rank  4: 24.93
     rank  5: 24.93
     rank  6: 25.04
     rank  7: 24.97
     rank  8: 3.90
     rank  9: 3.99
     rank 10: 3.89
     rank 11: 4.90
     rank 12: 3.87
     rank 13: 3.84
     rank 14: 3.88
     rank 15: 3.88
 [2024-12-30 22:21:34] iteration        3/      10 | consumed samples:           96 | elapsed time per iteration (ms): 2497.2 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 7.128724E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2437.60
     rank  1: 2437.74
     rank  2: 2437.59
     rank  3: 2437.57
     rank  4: 2436.95
     rank  5: 2436.99
     rank  6: 2436.95
     rank  7: 2436.96
     rank  8: 2435.21
     rank  9: 2435.33
     rank 10: 2435.27
     rank 11: 2435.23
     rank 12: 2434.98
     rank 13: 2435.05
     rank 14: 2435.00
     rank 15: 2434.98
  forward-compute:
     rank  0: 368.02
     rank  1: 402.87
     rank  2: 451.01
     rank  3: 396.53
     rank  4: 819.85
     rank  5: 826.52
     rank  6: 840.03
     rank  7: 836.68
     rank  8: 780.61
     rank  9: 784.50
     rank 10: 777.01
     rank 11: 787.51
     rank 12: 704.43
     rank 13: 675.17
     rank 14: 629.19
     rank 15: 635.80
  backward-compute:
     rank  0: 395.94
     rank  1: 388.85
     rank  2: 398.96
     rank  3: 382.61
     rank  4: 966.60
     rank  5: 976.85
     rank  6: 988.63
     rank  7: 979.74
     rank  8: 932.78
     rank  9: 936.45
     rank 10: 931.69
     rank 11: 938.55
     rank 12: 629.17
     rank 13: 627.06
     rank 14: 630.84
     rank 15: 629.87
  pure-backward-compute:
     rank  0: 395.41
     rank  1: 388.40
     rank  2: 398.32
     rank  3: 382.06
     rank  4: 966.23
     rank  5: 976.47
     rank  6: 988.22
     rank  7: 979.30
     rank  8: 931.95
     rank  9: 935.39
     rank 10: 929.68
     rank 11: 937.05
     rank 12: 627.78
     rank 13: 625.55
     rank 14: 628.93
     rank 15: 628.53
  batch-generator:
     rank  0: 40.56
     rank  1: 44.50
     rank  2: 44.37
     rank  3: 34.23
     rank  4: 21.31
     rank  5: 20.69
     rank  6: 22.31
     rank  7: 23.65
     rank  8: 33.08
     rank  9: 34.06
     rank 10: 33.86
     rank 11: 35.22
     rank 12: 33.79
     rank 13: 41.07
     rank 14: 28.14
     rank 15: 28.60
  forward-recv:
     rank  4: 44.13
     rank  5: 53.09
     rank  6: 53.97
     rank  7: 43.77
     rank  8: 151.21
     rank  9: 160.92
     rank 10: 170.07
     rank 11: 150.43
     rank 12: 246.59
     rank 13: 256.25
     rank 14: 259.55
     rank 15: 252.52
  forward-send:
     rank  0: 115.10
     rank  1: 116.74
     rank  2: 119.93
     rank  3: 121.53
     rank  4: 3.25
     rank  5: 3.12
     rank  6: 3.18
     rank  7: 3.35
     rank  8: 2.71
     rank  9: 2.88
     rank 10: 1.72
     rank 11: 4.14
  backward-recv:
     rank  0: 484.99
     rank  1: 479.65
     rank  2: 476.02
     rank  3: 475.64
     rank  4: 160.89
     rank  5: 154.64
     rank  6: 136.35
     rank  7: 144.09
     rank  8: 64.11
     rank  9: 54.20
     rank 10: 44.48
     rank 11: 48.96
  backward-send:
     rank  4: 1.08
     rank  5: 1.03
     rank  6: 1.08
     rank  7: 1.23
     rank  8: 3.53
     rank  9: 5.16
     rank 10: 5.28
     rank 11: 5.10
     rank 12: 3.86
     rank 13: 4.89
     rank 14: 4.91
     rank 15: 4.86
  forward-send-backward-recv:
     rank  0: 886.15
     rank  1: 868.31
     rank  2: 809.15
     rank  3: 879.74
     rank  4: 206.88
     rank  5: 192.62
     rank  6: 184.73
     rank  7: 198.23
     rank  8: 107.77
     rank  9: 99.13
     rank 10: 94.52
     rank 11: 102.11
  backward-send-forward-recv:
     rank  4: 2.96
     rank  5: 3.15
     rank  6: 3.14
     rank  7: 3.11
     rank  8: 41.91
     rank  9: 42.92
     rank 10: 62.48
     rank 11: 49.87
     rank 12: 384.15
     rank 13: 406.24
     rank 14: 445.12
     rank 15: 446.61
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.06
     rank  2: 0.04
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.04
     rank 10: 0.03
     rank 11: 0.05
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.05
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.06
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.04
     rank 12: 0.06
     rank 13: 0.07
     rank 14: 0.07
     rank 15: 0.07
  all-grads-sync:
     rank  0: 143.26
     rank  1: 143.44
     rank  2: 143.33
     rank  3: 143.30
     rank  4: 170.94
     rank  5: 171.01
     rank  6: 170.97
     rank  7: 170.91
     rank  8: 0.02
     rank  9: 0.04
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.15
     rank  1: 0.16
     rank  2: 0.25
     rank  3: 0.13
     rank  4: 0.08
     rank  5: 0.07
     rank  6: 0.09
     rank  7: 0.10
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.06
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 26.88
     rank  1: 26.95
     rank  2: 26.93
     rank  3: 26.46
     rank  4: 21.12
     rank  5: 21.14
     rank  6: 21.18
     rank  7: 21.25
     rank  8: 0.06
     rank  9: 0.13
     rank 10: 0.12
     rank 11: 0.14
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.07
     rank 15: 0.05
  optimizer:
     rank  0: 27.98
     rank  1: 28.06
     rank  2: 28.04
     rank  3: 27.58
     rank  4: 22.22
     rank  5: 22.23
     rank  6: 22.27
     rank  7: 22.35
     rank  8: 1.15
     rank  9: 1.22
     rank 10: 1.22
     rank 11: 1.23
     rank 12: 1.13
     rank 13: 1.14
     rank 14: 1.17
     rank 15: 1.14
 [2024-12-30 22:21:36] iteration        4/      10 | consumed samples:          128 | elapsed time per iteration (ms): 2506.7 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 6.964386E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2445.54
     rank  1: 2445.48
     rank  2: 2445.47
     rank  3: 2445.49
     rank  4: 2444.95
     rank  5: 2444.92
     rank  6: 2444.92
     rank  7: 2444.96
     rank  8: 2443.29
     rank  9: 2443.29
     rank 10: 2443.30
     rank 11: 2443.52
     rank 12: 2443.08
     rank 13: 2443.10
     rank 14: 2443.07
     rank 15: 2443.07
  forward-compute:
     rank  0: 360.74
     rank  1: 389.22
     rank  2: 402.29
     rank  3: 392.96
     rank  4: 831.18
     rank  5: 835.78
     rank  6: 838.68
     rank  7: 842.68
     rank  8: 780.31
     rank  9: 781.13
     rank 10: 772.14
     rank 11: 777.99
     rank 12: 664.15
     rank 13: 640.54
     rank 14: 635.49
     rank 15: 627.77
  backward-compute:
     rank  0: 391.78
     rank  1: 392.85
     rank  2: 403.63
     rank  3: 370.73
     rank  4: 969.24
     rank  5: 982.54
     rank  6: 989.99
     rank  7: 983.98
     rank  8: 933.91
     rank  9: 936.85
     rank 10: 929.63
     rank 11: 938.10
     rank 12: 630.79
     rank 13: 630.83
     rank 14: 630.73
     rank 15: 629.86
  pure-backward-compute:
     rank  0: 391.35
     rank  1: 392.32
     rank  2: 403.05
     rank  3: 370.28
     rank  4: 968.79
     rank  5: 982.10
     rank  6: 989.45
     rank  7: 983.49
     rank  8: 933.02
     rank  9: 935.58
     rank 10: 928.65
     rank 11: 937.16
     rank 12: 629.36
     rank 13: 629.39
     rank 14: 629.11
     rank 15: 628.55
  batch-generator:
     rank  0: 33.85
     rank  1: 36.00
     rank  2: 32.01
     rank  3: 31.58
     rank  4: 24.22
     rank  5: 25.23
     rank  6: 22.17
     rank  7: 25.78
     rank  8: 31.57
     rank  9: 31.53
     rank 10: 29.11
     rank 11: 28.88
     rank 12: 29.89
     rank 13: 37.77
     rank 14: 29.83
     rank 15: 26.01
  forward-recv:
     rank  4: 43.62
     rank  5: 51.96
     rank  6: 48.47
     rank  7: 48.28
     rank  8: 151.56
     rank  9: 160.64
     rank 10: 165.06
     rank 11: 163.67
     rank 12: 246.82
     rank 13: 258.95
     rank 14: 253.95
     rank 15: 255.00
  forward-send:
     rank  0: 110.33
     rank  1: 119.03
     rank  2: 119.98
     rank  3: 122.99
     rank  4: 3.14
     rank  5: 6.03
     rank  6: 6.77
     rank  7: 6.84
     rank  8: 2.78
     rank  9: 3.46
     rank 10: 2.21
     rank 11: 2.29
  backward-recv:
     rank  0: 478.69
     rank  1: 476.94
     rank  2: 463.89
     rank  3: 474.09
     rank  4: 157.45
     rank  5: 142.98
     rank  6: 138.87
     rank  7: 139.89
     rank  8: 57.91
     rank  9: 45.78
     rank 10: 44.80
     rank 11: 42.08
  backward-send:
     rank  4: 0.99
     rank  5: 0.96
     rank  6: 1.66
     rank  7: 0.99
     rank  8: 5.64
     rank  9: 6.46
     rank 10: 6.52
     rank 11: 6.57
     rank 12: 4.56
     rank 13: 4.86
     rank 14: 4.37
     rank 15: 4.21
  forward-send-backward-recv:
     rank  0: 920.47
     rank  1: 886.98
     rank  2: 876.77
     rank  3: 904.19
     rank  4: 207.50
     rank  5: 195.87
     rank  6: 192.81
     rank  7: 192.54
     rank  8: 114.11
     rank  9: 105.62
     rank 10: 104.95
     rank 11: 103.64
  backward-send-forward-recv:
     rank  4: 3.79
     rank  5: 3.27
     rank  6: 3.37
     rank  7: 3.45
     rank  8: 49.34
     rank  9: 56.21
     rank 10: 70.29
     rank 11: 61.22
     rank 12: 430.01
     rank 13: 441.54
     rank 14: 452.73
     rank 15: 459.06
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.11
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.06
     rank 11: 0.06
     rank 12: 0.07
     rank 13: 0.07
     rank 14: 0.07
     rank 15: 0.08
  all-grads-sync:
     rank  0: 143.05
     rank  1: 143.06
     rank  2: 143.10
     rank  3: 143.09
     rank  4: 167.95
     rank  5: 167.99
     rank  6: 167.97
     rank  7: 167.89
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.04
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.04
  optimizer-copy-to-main-grad:
     rank  0: 0.14
     rank  1: 0.13
     rank  2: 0.22
     rank  3: 0.14
     rank  4: 0.08
     rank  5: 0.08
     rank  6: 0.08
     rank  7: 0.08
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.06
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.08
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 26.54
     rank  1: 26.55
     rank  2: 26.52
     rank  3: 26.48
     rank  4: 21.14
     rank  5: 21.14
     rank  6: 21.17
     rank  7: 21.18
     rank  8: 0.06
     rank  9: 0.06
     rank 10: 0.05
     rank 11: 0.57
     rank 12: 0.05
     rank 13: 0.04
     rank 14: 0.05
     rank 15: 0.04
  optimizer:
     rank  0: 27.88
     rank  1: 27.90
     rank  2: 27.86
     rank  3: 27.82
     rank  4: 22.48
     rank  5: 22.48
     rank  6: 22.51
     rank  7: 22.53
     rank  8: 1.39
     rank  9: 1.39
     rank 10: 1.38
     rank 11: 1.91
     rank 12: 1.39
     rank 13: 1.38
     rank 14: 1.38
     rank 15: 1.38
 [2024-12-30 22:21:39] iteration        5/      10 | consumed samples:          160 | elapsed time per iteration (ms): 2510.4 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 6.469573E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2450.36
     rank  1: 2450.34
     rank  2: 2450.47
     rank  3: 2450.32
     rank  4: 2449.68
     rank  5: 2449.67
     rank  6: 2449.69
     rank  7: 2449.68
     rank  8: 2448.07
     rank  9: 2448.07
     rank 10: 2448.07
     rank 11: 2448.23
     rank 12: 2447.79
     rank 13: 2447.88
     rank 14: 2447.85
     rank 15: 2447.79
  forward-compute:
     rank  0: 335.73
     rank  1: 388.41
     rank  2: 403.46
     rank  3: 393.50
     rank  4: 827.16
     rank  5: 834.17
     rank  6: 844.43
     rank  7: 839.54
     rank  8: 783.75
     rank  9: 782.25
     rank 10: 772.65
     rank 11: 791.93
     rank 12: 700.10
     rank 13: 658.64
     rank 14: 640.49
     rank 15: 628.19
  backward-compute:
     rank  0: 402.27
     rank  1: 388.55
     rank  2: 387.03
     rank  3: 373.25
     rank  4: 970.92
     rank  5: 981.52
     rank  6: 993.11
     rank  7: 984.41
     rank  8: 937.59
     rank  9: 936.32
     rank 10: 931.23
     rank 11: 939.96
     rank 12: 630.34
     rank 13: 629.87
     rank 14: 632.14
     rank 15: 630.39
  pure-backward-compute:
     rank  0: 401.84
     rank  1: 388.05
     rank  2: 386.38
     rank  3: 372.75
     rank  4: 970.48
     rank  5: 981.13
     rank  6: 992.68
     rank  7: 983.99
     rank  8: 936.58
     rank  9: 935.28
     rank 10: 930.08
     rank 11: 938.94
     rank 12: 628.92
     rank 13: 628.44
     rank 14: 630.67
     rank 15: 628.98
  batch-generator:
     rank  0: 29.05
     rank  1: 31.09
     rank  2: 38.78
     rank  3: 33.36
     rank  4: 21.01
     rank  5: 23.07
     rank  6: 22.86
     rank  7: 22.22
     rank  8: 32.08
     rank  9: 31.26
     rank 10: 29.71
     rank 11: 37.65
     rank 12: 32.47
     rank 13: 39.89
     rank 14: 32.00
     rank 15: 28.81
  forward-recv:
     rank  4: 39.42
     rank  5: 46.66
     rank  6: 47.46
     rank  7: 47.86
     rank  8: 148.25
     rank  9: 158.43
     rank 10: 166.14
     rank 11: 159.12
     rank 12: 243.41
     rank 13: 249.77
     rank 14: 251.31
     rank 15: 258.33
  forward-send:
     rank  0: 128.19
     rank  1: 110.93
     rank  2: 115.93
     rank  3: 115.53
     rank  4: 3.18
     rank  5: 3.22
     rank  6: 4.78
     rank  7: 4.80
     rank  8: 2.64
     rank  9: 2.93
     rank 10: 1.64
     rank 11: 1.62
  backward-recv:
     rank  0: 478.66
     rank  1: 475.51
     rank  2: 471.59
     rank  3: 477.07
     rank  4: 161.19
     rank  5: 150.06
     rank  6: 136.94
     rank  7: 145.68
     rank  8: 62.72
     rank  9: 51.96
     rank 10: 43.59
     rank 11: 46.21
  backward-send:
     rank  4: 1.13
     rank  5: 1.09
     rank  6: 1.00
     rank  7: 0.98
     rank  8: 5.06
     rank  9: 6.18
     rank 10: 5.94
     rank 11: 6.00
     rank 12: 4.26
     rank 13: 5.04
     rank 14: 5.11
     rank 15: 4.95
  forward-send-backward-recv:
     rank  0: 918.39
     rank  1: 902.91
     rank  2: 888.79
     rank  3: 907.33
     rank  4: 210.51
     rank  5: 200.93
     rank  6: 190.86
     rank  7: 193.44
     rank  8: 110.12
     rank  9: 106.29
     rank 10: 101.99
     rank 11: 103.31
  backward-send-forward-recv:
     rank  4: 3.23
     rank  5: 3.12
     rank  6: 2.93
     rank  7: 3.08
     rank  8: 45.98
     rank  9: 53.59
     rank 10: 74.38
     rank 11: 49.42
     rank 12: 399.44
     rank 13: 435.20
     rank 14: 449.90
     rank 15: 456.71
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.04
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.04
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.09
     rank 13: 0.11
     rank 14: 0.12
     rank 15: 0.07
  all-grads-sync:
     rank  0: 144.04
     rank  1: 144.05
     rank  2: 144.13
     rank  3: 144.08
     rank  4: 172.76
     rank  5: 172.83
     rank  6: 171.93
     rank  7: 172.72
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.06
     rank 14: 0.06
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.16
     rank  1: 0.15
     rank  2: 0.50
     rank  3: 0.15
     rank  4: 0.20
     rank  5: 0.09
     rank  6: 0.09
     rank  7: 0.09
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.05
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 26.73
     rank  1: 26.61
     rank  2: 26.89
     rank  3: 26.52
     rank  4: 21.21
     rank  5: 21.22
     rank  6: 21.23
     rank  7: 21.20
     rank  8: 0.05
     rank  9: 0.05
     rank 10: 0.05
     rank 11: 0.17
     rank 12: 0.04
     rank 13: 0.08
     rank 14: 0.08
     rank 15: 0.07
  optimizer:
     rank  0: 28.09
     rank  1: 27.97
     rank  2: 28.24
     rank  3: 27.88
     rank  4: 22.57
     rank  5: 22.58
     rank  6: 22.59
     rank  7: 22.57
     rank  8: 1.40
     rank  9: 1.40
     rank 10: 1.40
     rank 11: 1.52
     rank 12: 1.39
     rank 13: 1.43
     rank 14: 1.43
     rank 15: 1.43
 [2024-12-30 22:21:41] iteration        6/      10 | consumed samples:          192 | elapsed time per iteration (ms): 2545.2 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 5.412633E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2484.38
     rank  1: 2484.39
     rank  2: 2484.79
     rank  3: 2484.38
     rank  4: 2483.62
     rank  5: 2483.63
     rank  6: 2483.71
     rank  7: 2483.66
     rank  8: 2481.91
     rank  9: 2481.93
     rank 10: 2482.03
     rank 11: 2481.91
     rank 12: 2481.59
     rank 13: 2481.67
     rank 14: 2481.63
     rank 15: 2481.58
  forward-compute:
     rank  0: 343.05
     rank  1: 381.35
     rank  2: 402.40
     rank  3: 382.71
     rank  4: 829.35
     rank  5: 831.55
     rank  6: 842.76
     rank  7: 876.66
     rank  8: 786.11
     rank  9: 783.49
     rank 10: 778.88
     rank 11: 785.57
     rank 12: 710.43
     rank 13: 689.94
     rank 14: 663.73
     rank 15: 631.89
  backward-compute:
     rank  0: 383.69
     rank  1: 389.19
     rank  2: 412.27
     rank  3: 398.33
     rank  4: 971.55
     rank  5: 981.27
     rank  6: 994.56
     rank  7: 986.26
     rank  8: 938.54
     rank  9: 938.75
     rank 10: 935.27
     rank 11: 941.61
     rank 12: 631.12
     rank 13: 629.79
     rank 14: 631.82
     rank 15: 630.24
  pure-backward-compute:
     rank  0: 383.27
     rank  1: 388.75
     rank  2: 411.59
     rank  3: 397.96
     rank  4: 971.08
     rank  5: 980.88
     rank  6: 994.10
     rank  7: 985.73
     rank  8: 937.64
     rank  9: 937.53
     rank 10: 934.38
     rank 11: 940.53
     rank 12: 629.65
     rank 13: 628.30
     rank 14: 630.42
     rank 15: 628.95
  batch-generator:
     rank  0: 27.87
     rank  1: 30.37
     rank  2: 34.17
     rank  3: 28.63
     rank  4: 22.99
     rank  5: 21.74
     rank  6: 22.12
     rank  7: 28.89
     rank  8: 34.92
     rank  9: 31.24
     rank 10: 33.48
     rank 11: 32.25
     rank 12: 35.62
     rank 13: 38.83
     rank 14: 26.66
     rank 15: 30.15
  forward-recv:
     rank  4: 43.89
     rank  5: 47.84
     rank  6: 51.45
     rank  7: 47.05
     rank  8: 152.32
     rank  9: 160.45
     rank 10: 167.34
     rank 11: 159.64
     rank 12: 245.79
     rank 13: 251.47
     rank 14: 253.68
     rank 15: 251.62
  forward-send:
     rank  0: 125.26
     rank  1: 118.70
     rank  2: 117.33
     rank  3: 117.01
     rank  4: 3.12
     rank  5: 5.24
     rank  6: 3.09
     rank  7: 4.86
     rank  8: 2.71
     rank  9: 3.12
     rank 10: 2.12
     rank 11: 2.93
  backward-recv:
     rank  0: 513.22
     rank  1: 517.74
     rank  2: 485.04
     rank  3: 493.78
     rank  4: 184.19
     rank  5: 182.34
     rank  6: 168.05
     rank  7: 135.09
     rank  8: 87.01
     rank  9: 82.80
     rank 10: 75.86
     rank 11: 41.64
  backward-send:
     rank  4: 1.18
     rank  5: 1.04
     rank  6: 1.24
     rank  7: 1.07
     rank  8: 3.66
     rank  9: 5.74
     rank 10: 5.50
     rank 11: 5.04
     rank 12: 3.79
     rank 13: 4.94
     rank 14: 4.96
     rank 15: 4.88
  forward-send-backward-recv:
     rank  0: 922.03
     rank  1: 889.09
     rank  2: 880.13
     rank  3: 904.14
     rank  4: 204.44
     rank  5: 194.58
     rank  6: 183.48
     rank  7: 190.80
     rank  8: 105.95
     rank  9: 102.51
     rank 10: 88.83
     rank 11: 93.78
  backward-send-forward-recv:
     rank  4: 3.26
     rank  5: 3.17
     rank  6: 3.12
     rank  7: 3.45
     rank  8: 43.02
     rank  9: 46.14
     rank 10: 68.67
     rank 11: 93.36
     rank 12: 412.13
     rank 13: 428.43
     rank 14: 450.75
     rank 15: 486.28
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.12
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.04
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.04
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.05
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.06
     rank  6: 0.05
     rank  7: 0.07
     rank  8: 0.04
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.06
     rank 13: 0.07
     rank 14: 0.08
     rank 15: 0.06
  all-grads-sync:
     rank  0: 144.00
     rank  1: 144.02
     rank  2: 144.03
     rank  3: 144.02
     rank  4: 174.05
     rank  5: 174.01
     rank  6: 174.08
     rank  7: 174.00
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.14
     rank  1: 0.14
     rank  2: 0.26
     rank  3: 0.13
     rank  4: 0.08
     rank  5: 0.09
     rank  6: 0.09
     rank  7: 0.10
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 26.48
     rank  1: 26.55
     rank  2: 27.92
     rank  3: 26.49
     rank  4: 21.14
     rank  5: 21.24
     rank  6: 21.22
     rank  7: 21.32
     rank  8: 0.07
     rank  9: 0.11
     rank 10: 0.11
     rank 11: 0.05
     rank 12: 0.07
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.04
  optimizer:
     rank  0: 27.69
     rank  1: 27.76
     rank  2: 29.13
     rank  3: 27.70
     rank  4: 22.35
     rank  5: 22.44
     rank  6: 22.43
     rank  7: 22.54
     rank  8: 1.26
     rank  9: 1.31
     rank 10: 1.30
     rank 11: 1.25
     rank 12: 1.28
     rank 13: 1.26
     rank 14: 1.25
     rank 15: 1.24
 [2024-12-30 22:21:44] iteration        7/      10 | consumed samples:          224 | elapsed time per iteration (ms): 2515.4 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 4.978873E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2457.23
     rank  1: 2457.21
     rank  2: 2457.20
     rank  3: 2457.25
     rank  4: 2456.68
     rank  5: 2456.68
     rank  6: 2456.69
     rank  7: 2456.76
     rank  8: 2454.99
     rank  9: 2454.89
     rank 10: 2454.90
     rank 11: 2454.98
     rank 12: 2454.73
     rank 13: 2454.80
     rank 14: 2454.72
     rank 15: 2454.72
  forward-compute:
     rank  0: 351.93
     rank  1: 377.43
     rank  2: 423.23
     rank  3: 406.96
     rank  4: 841.27
     rank  5: 836.13
     rank  6: 847.11
     rank  7: 847.40
     rank  8: 784.34
     rank  9: 779.74
     rank 10: 775.13
     rank 11: 783.82
     rank 12: 675.75
     rank 13: 647.96
     rank 14: 624.02
     rank 15: 637.33
  backward-compute:
     rank  0: 403.27
     rank  1: 387.66
     rank  2: 419.92
     rank  3: 395.98
     rank  4: 974.42
     rank  5: 982.31
     rank  6: 995.53
     rank  7: 987.47
     rank  8: 938.82
     rank  9: 940.89
     rank 10: 936.63
     rank 11: 941.86
     rank 12: 632.74
     rank 13: 630.57
     rank 14: 633.48
     rank 15: 631.66
  pure-backward-compute:
     rank  0: 402.78
     rank  1: 387.20
     rank  2: 418.99
     rank  3: 395.41
     rank  4: 973.82
     rank  5: 981.85
     rank  6: 995.04
     rank  7: 987.06
     rank  8: 937.94
     rank  9: 939.60
     rank 10: 935.74
     rank 11: 940.83
     rank 12: 631.42
     rank 13: 629.06
     rank 14: 632.06
     rank 15: 630.42
  batch-generator:
     rank  0: 32.91
     rank  1: 29.30
     rank  2: 47.58
     rank  3: 40.74
     rank  4: 30.77
     rank  5: 25.31
     rank  6: 24.04
     rank  7: 23.30
     rank  8: 31.97
     rank  9: 28.57
     rank 10: 27.51
     rank 11: 29.06
     rank 12: 34.45
     rank 13: 37.11
     rank 14: 27.02
     rank 15: 32.38
  forward-recv:
     rank  4: 39.61
     rank  5: 46.54
     rank  6: 52.95
     rank  7: 47.38
     rank  8: 146.41
     rank  9: 157.35
     rank 10: 170.48
     rank 11: 173.91
     rank 12: 242.65
     rank 13: 249.75
     rank 14: 260.00
     rank 15: 260.19
  forward-send:
     rank  0: 123.94
     rank  1: 114.12
     rank  2: 113.95
     rank  3: 125.46
     rank  4: 3.08
     rank  5: 3.14
     rank  6: 4.35
     rank  7: 4.34
     rank  8: 2.85
     rank  9: 3.09
     rank 10: 2.75
     rank 11: 2.90
  backward-recv:
     rank  0: 472.75
     rank  1: 477.39
     rank  2: 462.03
     rank  3: 478.99
     rank  4: 145.40
     rank  5: 145.86
     rank  6: 139.68
     rank  7: 145.04
     rank  8: 40.55
     rank  9: 40.63
     rank 10: 40.09
     rank 11: 40.96
  backward-send:
     rank  4: 1.14
     rank  5: 0.95
     rank  6: 1.06
     rank  7: 0.93
     rank  8: 9.08
     rank  9: 9.82
     rank 10: 9.93
     rank 11: 9.75
     rank 12: 4.70
     rank 13: 5.22
     rank 14: 4.73
     rank 15: 4.84
  forward-send-backward-recv:
     rank  0: 919.32
     rank  1: 913.86
     rank  2: 855.58
     rank  3: 863.71
     rank  4: 212.44
     rank  5: 205.85
     rank  6: 180.57
     rank  7: 187.89
     rank  8: 113.15
     rank  9: 111.16
     rank 10: 92.68
     rank 11: 91.46
  backward-send-forward-recv:
     rank  4: 4.39
     rank  5: 3.49
     rank  6: 3.60
     rank  7: 2.91
     rank  8: 65.12
     rank  9: 59.29
     rank 10: 73.44
     rank 11: 56.60
     rank 12: 425.26
     rank 13: 447.98
     rank 14: 458.73
     rank 15: 447.95
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.06
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.06
     rank 13: 0.07
     rank 14: 0.07
     rank 15: 0.06
  all-grads-sync:
     rank  0: 143.24
     rank  1: 143.27
     rank  2: 143.26
     rank  3: 143.30
     rank  4: 170.52
     rank  5: 170.57
     rank  6: 170.53
     rank  7: 170.51
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.15
     rank  1: 0.25
     rank  2: 0.22
     rank  3: 0.14
     rank  4: 0.08
     rank  5: 0.08
     rank  6: 0.09
     rank  7: 0.09
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 26.62
     rank  1: 26.68
     rank  2: 26.55
     rank  3: 26.67
     rank  4: 21.14
     rank  5: 21.13
     rank  6: 21.26
     rank  7: 21.27
     rank  8: 0.10
     rank  9: 0.06
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.04
  optimizer:
     rank  0: 27.66
     rank  1: 27.71
     rank  2: 27.61
     rank  3: 27.71
     rank  4: 22.18
     rank  5: 22.17
     rank  6: 22.30
     rank  7: 22.31
     rank  8: 1.13
     rank  9: 1.09
     rank 10: 1.08
     rank 11: 1.08
     rank 12: 1.07
     rank 13: 1.08
     rank 14: 1.07
     rank 15: 1.08
 [2024-12-30 22:21:46] iteration        8/      10 | consumed samples:          256 | elapsed time per iteration (ms): 2533.9 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 3.926314E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2475.45
     rank  1: 2475.50
     rank  2: 2475.48
     rank  3: 2475.51
     rank  4: 2474.95
     rank  5: 2474.95
     rank  6: 2474.95
     rank  7: 2475.01
     rank  8: 2474.06
     rank  9: 2473.77
     rank 10: 2473.78
     rank 11: 2473.78
     rank 12: 2473.06
     rank 13: 2473.13
     rank 14: 2473.07
     rank 15: 2473.12
  forward-compute:
     rank  0: 347.01
     rank  1: 420.89
     rank  2: 407.84
     rank  3: 403.24
     rank  4: 844.11
     rank  5: 838.45
     rank  6: 843.66
     rank  7: 869.63
     rank  8: 784.90
     rank  9: 783.88
     rank 10: 778.99
     rank 11: 786.97
     rank 12: 691.64
     rank 13: 675.43
     rank 14: 651.07
     rank 15: 637.27
  backward-compute:
     rank  0: 411.60
     rank  1: 428.28
     rank  2: 413.65
     rank  3: 418.07
     rank  4: 975.24
     rank  5: 988.20
     rank  6: 993.93
     rank  7: 988.66
     rank  8: 940.74
     rank  9: 941.66
     rank 10: 936.76
     rank 11: 944.94
     rank 12: 632.37
     rank 13: 632.88
     rank 14: 633.27
     rank 15: 632.38
  pure-backward-compute:
     rank  0: 411.11
     rank  1: 427.75
     rank  2: 412.90
     rank  3: 417.46
     rank  4: 974.57
     rank  5: 987.75
     rank  6: 993.44
     rank  7: 988.00
     rank  8: 939.79
     rank  9: 940.50
     rank 10: 935.88
     rank 11: 943.75
     rank 12: 631.01
     rank 13: 631.31
     rank 14: 631.85
     rank 15: 631.01
  batch-generator:
     rank  0: 31.10
     rank  1: 44.23
     rank  2: 42.05
     rank  3: 35.31
     rank  4: 29.99
     rank  5: 24.58
     rank  6: 23.06
     rank  7: 30.56
     rank  8: 31.85
     rank  9: 30.77
     rank 10: 30.07
     rank 11: 30.41
     rank 12: 31.21
     rank 13: 42.39
     rank 14: 26.92
     rank 15: 32.69
  forward-recv:
     rank  4: 40.33
     rank  5: 48.61
     rank  6: 48.13
     rank  7: 48.26
     rank  8: 149.20
     rank  9: 159.63
     rank 10: 164.49
     rank 11: 161.68
     rank 12: 242.49
     rank 13: 251.68
     rank 14: 252.93
     rank 15: 254.12
  forward-send:
     rank  0: 123.54
     rank  1: 114.02
     rank  2: 117.46
     rank  3: 117.52
     rank  4: 3.11
     rank  5: 3.07
     rank  6: 4.43
     rank  7: 4.35
     rank  8: 2.69
     rank  9: 3.06
     rank 10: 2.22
     rank 11: 2.14
  backward-recv:
     rank  0: 492.41
     rank  1: 497.19
     rank  2: 481.29
     rank  3: 482.87
     rank  4: 168.12
     rank  5: 168.45
     rank  6: 158.51
     rank  7: 138.12
     rank  8: 65.43
     rank  9: 68.72
     rank 10: 65.30
     rank 11: 42.20
  backward-send:
     rank  4: 1.63
     rank  5: 0.99
     rank  6: 1.35
     rank  7: 1.18
     rank  8: 6.54
     rank  9: 5.57
     rank 10: 4.68
     rank 11: 5.69
     rank 12: 4.37
     rank 13: 4.98
     rank 14: 4.17
     rank 15: 4.83
  forward-send-backward-recv:
     rank  0: 919.45
     rank  1: 833.25
     rank  2: 869.57
     rank  3: 871.92
     rank  4: 204.12
     rank  5: 193.28
     rank  6: 187.55
     rank  7: 189.03
     rank  8: 112.85
     rank  9: 103.44
     rank 10: 96.18
     rank 11: 91.09
  backward-send-forward-recv:
     rank  4: 4.34
     rank  5: 3.38
     rank  6: 2.99
     rank  7: 3.81
     rank  8: 57.81
     rank  9: 54.53
     rank 10: 68.38
     rank 11: 86.12
     rank 12: 429.10
     rank 13: 436.03
     rank 14: 458.33
     rank 15: 472.13
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.06
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.06
     rank  7: 0.07
     rank  8: 0.04
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.06
     rank 13: 0.07
     rank 14: 0.06
     rank 15: 0.09
  all-grads-sync:
     rank  0: 143.35
     rank  1: 143.35
     rank  2: 143.41
     rank  3: 143.38
     rank  4: 171.51
     rank  5: 171.57
     rank  6: 171.56
     rank  7: 171.46
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.03
  optimizer-copy-to-main-grad:
     rank  0: 0.13
     rank  1: 0.13
     rank  2: 0.20
     rank  3: 0.14
     rank  4: 0.08
     rank  5: 0.08
     rank  6: 0.09
     rank  7: 0.09
     rank  8: 0.04
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.04
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.04
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 26.45
     rank  1: 26.62
     rank  2: 26.43
     rank  3: 26.58
     rank  4: 21.19
     rank  5: 21.17
     rank  6: 21.19
     rank  7: 21.28
     rank  8: 0.10
     rank  9: 0.05
     rank 10: 0.05
     rank 11: 0.11
     rank 12: 0.05
     rank 13: 0.05
     rank 14: 0.04
     rank 15: 0.08
  optimizer:
     rank  0: 27.75
     rank  1: 27.92
     rank  2: 27.73
     rank  3: 27.88
     rank  4: 22.49
     rank  5: 22.46
     rank  6: 22.48
     rank  7: 22.59
     rank  8: 1.43
     rank  9: 1.34
     rank 10: 1.34
     rank 11: 1.40
     rank 12: 1.34
     rank 13: 1.34
     rank 14: 1.33
     rank 15: 1.38
 [2024-12-30 22:21:49] iteration        9/      10 | consumed samples:          288 | elapsed time per iteration (ms): 2508.4 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 4.371341E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2449.93
     rank  1: 2450.10
     rank  2: 2450.02
     rank  3: 2450.01
     rank  4: 2449.45
     rank  5: 2449.44
     rank  6: 2449.50
     rank  7: 2449.48
     rank  8: 2448.17
     rank  9: 2448.16
     rank 10: 2448.16
     rank 11: 2448.48
     rank 12: 2447.62
     rank 13: 2447.63
     rank 14: 2447.59
     rank 15: 2447.58
  forward-compute:
     rank  0: 344.79
     rank  1: 375.17
     rank  2: 381.60
     rank  3: 391.12
     rank  4: 825.13
     rank  5: 833.17
     rank  6: 836.50
     rank  7: 855.45
     rank  8: 785.12
     rank  9: 782.78
     rank 10: 782.13
     rank 11: 784.35
     rank 12: 672.47
     rank 13: 640.94
     rank 14: 688.62
     rank 15: 645.18
  backward-compute:
     rank  0: 412.72
     rank  1: 389.12
     rank  2: 412.37
     rank  3: 393.66
     rank  4: 977.54
     rank  5: 988.23
     rank  6: 988.45
     rank  7: 987.69
     rank  8: 941.10
     rank  9: 940.57
     rank 10: 940.22
     rank 11: 945.61
     rank 12: 633.28
     rank 13: 634.01
     rank 14: 632.51
     rank 15: 633.13
  pure-backward-compute:
     rank  0: 412.33
     rank  1: 388.68
     rank  2: 411.67
     rank  3: 393.06
     rank  4: 977.16
     rank  5: 987.76
     rank  6: 988.06
     rank  7: 987.19
     rank  8: 940.00
     rank  9: 939.57
     rank 10: 939.25
     rank 11: 944.62
     rank 12: 631.94
     rank 13: 632.52
     rank 14: 631.15
     rank 15: 631.77
  batch-generator:
     rank  0: 32.35
     rank  1: 29.59
     rank  2: 30.47
     rank  3: 36.58
     rank  4: 20.47
     rank  5: 21.82
     rank  6: 21.96
     rank  7: 23.38
     rank  8: 32.33
     rank  9: 30.22
     rank 10: 31.51
     rank 11: 27.41
     rank 12: 32.19
     rank 13: 30.18
     rank 14: 49.57
     rank 15: 29.01
  forward-recv:
     rank  4: 45.05
     rank  5: 47.19
     rank  6: 47.50
     rank  7: 48.47
     rank  8: 154.45
     rank  9: 157.01
     rank 10: 160.37
     rank 11: 175.77
     rank 12: 247.42
     rank 13: 250.14
     rank 14: 251.07
     rank 15: 260.24
  forward-send:
     rank  0: 126.51
     rank  1: 113.24
     rank  2: 116.90
     rank  3: 132.49
     rank  4: 3.06
     rank  5: 3.03
     rank  6: 3.19
     rank  7: 3.33
     rank  8: 2.67
     rank  9: 2.86
     rank 10: 2.27
     rank 11: 1.84
  backward-recv:
     rank  0: 468.81
     rank  1: 471.10
     rank  2: 470.98
     rank  3: 468.17
     rank  4: 153.06
     rank  5: 140.63
     rank  6: 146.13
     rank  7: 143.21
     rank  8: 54.50
     rank  9: 43.39
     rank 10: 48.32
     rank 11: 44.60
  backward-send:
     rank  4: 1.01
     rank  5: 0.99
     rank  6: 1.04
     rank  7: 1.32
     rank  8: 5.85
     rank  9: 6.98
     rank 10: 6.71
     rank 11: 6.56
     rank 12: 4.43
     rank 13: 5.12
     rank 14: 5.07
     rank 15: 5.13
  forward-send-backward-recv:
     rank  0: 916.08
     rank  1: 918.35
     rank  2: 882.47
     rank  3: 879.76
     rank  4: 209.05
     rank  5: 202.66
     rank  6: 193.20
     rank  7: 176.20
     rank  8: 113.46
     rank  9: 113.43
     rank 10: 93.69
     rank 11: 92.20
  backward-send-forward-recv:
     rank  4: 3.10
     rank  5: 3.63
     rank  6: 3.15
     rank  7: 2.96
     rank  8: 37.04
     rank  9: 49.35
     rank 10: 61.98
     rank 11: 45.90
     rank 12: 417.33
     rank 13: 445.51
     rank 14: 398.43
     rank 15: 432.34
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.06
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.04
     rank 12: 0.08
     rank 13: 0.07
     rank 14: 0.08
     rank 15: 0.07
  all-grads-sync:
     rank  0: 143.22
     rank  1: 143.29
     rank  2: 143.30
     rank  3: 143.30
     rank  4: 172.36
     rank  5: 172.43
     rank  6: 172.39
     rank  7: 172.29
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.14
     rank  1: 0.15
     rank  2: 0.24
     rank  3: 0.16
     rank  4: 0.08
     rank  5: 0.07
     rank  6: 0.09
     rank  7: 0.08
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.04
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.04
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.04
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 26.58
     rank  1: 26.73
     rank  2: 26.48
     rank  3: 26.42
     rank  4: 21.13
     rank  5: 21.14
     rank  6: 21.18
     rank  7: 21.18
     rank  8: 0.06
     rank  9: 0.05
     rank 10: 0.05
     rank 11: 0.10
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.04
  optimizer:
     rank  0: 27.97
     rank  1: 28.12
     rank  2: 27.87
     rank  3: 27.82
     rank  4: 22.52
     rank  5: 22.53
     rank  6: 22.57
     rank  7: 22.56
     rank  8: 1.44
     rank  9: 1.43
     rank 10: 1.43
     rank 11: 1.48
     rank 12: 1.42
     rank 13: 1.43
     rank 14: 1.43
     rank 15: 1.42
 [2024-12-30 22:21:51] iteration       10/      10 | consumed samples:          320 | elapsed time per iteration (ms): 2513.4 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 3.452110E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2454.90
     rank  1: 2454.91
     rank  2: 2455.00
     rank  3: 2454.90
     rank  4: 2454.33
     rank  5: 2454.33
     rank  6: 2454.36
     rank  7: 2454.34
     rank  8: 2452.64
     rank  9: 2452.60
     rank 10: 2452.61
     rank 11: 2452.69
     rank 12: 2452.41
     rank 13: 2452.46
     rank 14: 2452.41
     rank 15: 2452.41
  forward-compute:
     rank  0: 329.00
     rank  1: 385.87
     rank  2: 385.02
     rank  3: 376.78
     rank  4: 825.58
     rank  5: 842.08
     rank  6: 844.14
     rank  7: 844.11
     rank  8: 787.07
     rank  9: 780.59
     rank 10: 779.47
     rank 11: 787.78
     rank 12: 724.49
     rank 13: 631.11
     rank 14: 646.82
     rank 15: 637.19
  backward-compute:
     rank  0: 410.17
     rank  1: 378.81
     rank  2: 389.56
     rank  3: 376.65
     rank  4: 977.94
     rank  5: 990.25
     rank  6: 987.74
     rank  7: 988.84
     rank  8: 942.14
     rank  9: 939.50
     rank 10: 939.35
     rank 11: 948.46
     rank 12: 632.62
     rank 13: 633.76
     rank 14: 634.72
     rank 15: 633.47
  pure-backward-compute:
     rank  0: 409.68
     rank  1: 378.28
     rank  2: 388.87
     rank  3: 376.27
     rank  4: 977.57
     rank  5: 989.72
     rank  6: 987.13
     rank  7: 988.40
     rank  8: 941.01
     rank  9: 938.64
     rank 10: 938.42
     rank 11: 947.19
     rank 12: 631.34
     rank 13: 632.33
     rank 14: 633.42
     rank 15: 632.22
  batch-generator:
     rank  0: 26.85
     rank  1: 31.91
     rank  2: 32.61
     rank  3: 27.34
     rank  4: 21.17
     rank  5: 28.33
     rank  6: 28.03
     rank  7: 25.61
     rank  8: 32.75
     rank  9: 27.13
     rank 10: 29.03
     rank 11: 29.03
     rank 12: 27.85
     rank 13: 30.26
     rank 14: 32.65
     rank 15: 27.01
  forward-recv:
     rank  4: 39.22
     rank  5: 48.04
     rank  6: 47.99
     rank  7: 47.01
     rank  8: 147.37
     rank  9: 160.17
     rank 10: 163.34
     rank 11: 162.08
     rank 12: 240.84
     rank 13: 254.55
     rank 14: 254.24
     rank 15: 255.08
  forward-send:
     rank  0: 125.95
     rank  1: 119.60
     rank  2: 120.01
     rank  3: 122.42
     rank  4: 3.10
     rank  5: 5.00
     rank  6: 6.50
     rank  7: 6.54
     rank  8: 2.74
     rank  9: 3.88
     rank 10: 3.56
     rank 11: 3.76
  backward-recv:
     rank  0: 479.78
     rank  1: 479.14
     rank  2: 478.43
     rank  3: 479.39
     rank  4: 163.57
     rank  5: 140.42
     rank  6: 140.46
     rank  7: 141.38
     rank  8: 67.36
     rank  9: 44.33
     rank 10: 45.78
     rank 11: 41.54
  backward-send:
     rank  4: 0.95
     rank  5: 0.97
     rank  6: 1.49
     rank  7: 0.86
     rank  8: 3.55
     rank  9: 5.74
     rank 10: 5.78
     rank 11: 5.73
     rank 12: 3.74
     rank 13: 4.79
     rank 14: 4.69
     rank 15: 4.45
  forward-send-backward-recv:
     rank  0: 926.14
     rank  1: 907.62
     rank  2: 898.18
     rank  3: 915.74
     rank  4: 206.81
     rank  5: 192.20
     rank  6: 192.79
     rank  7: 193.13
     rank  8: 104.18
     rank  9: 99.29
     rank 10: 96.13
     rank 11: 96.16
  backward-send-forward-recv:
     rank  4: 3.45
     rank  5: 4.00
     rank  6: 3.64
     rank  7: 3.16
     rank  8: 43.41
     rank  9: 68.78
     rank 10: 68.18
     rank 11: 55.31
     rank 12: 378.93
     rank 13: 458.27
     rank 14: 441.67
     rank 15: 451.38
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.04
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.05
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.06
     rank 13: 0.07
     rank 14: 0.07
     rank 15: 0.06
  all-grads-sync:
     rank  0: 143.47
     rank  1: 143.47
     rank  2: 143.50
     rank  3: 143.50
     rank  4: 172.99
     rank  5: 173.05
     rank  6: 173.02
     rank  7: 172.94
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.04
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.13
     rank  1: 0.14
     rank  2: 0.32
     rank  3: 0.14
     rank  4: 0.08
     rank  5: 0.08
     rank  6: 0.08
     rank  7: 0.08
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 26.42
     rank  1: 26.57
     rank  2: 26.69
     rank  3: 26.44
     rank  4: 21.15
     rank  5: 21.14
     rank  6: 21.18
     rank  7: 21.19
     rank  8: 0.11
     rank  9: 0.05
     rank 10: 0.05
     rank 11: 0.12
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.04
  optimizer:
     rank  0: 27.56
     rank  1: 27.71
     rank  2: 27.83
     rank  3: 27.58
     rank  4: 22.29
     rank  5: 22.28
     rank  6: 22.32
     rank  7: 22.32
     rank  8: 1.24
     rank  9: 1.18
     rank 10: 1.18
     rank 11: 1.25
     rank 12: 1.17
     rank 13: 1.18
     rank 14: 1.17
     rank 15: 1.17
