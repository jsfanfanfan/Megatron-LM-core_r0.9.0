examples/multimodal/pretrain-freeze-llm-hete-3090first.sh: line 4: activate: No such file or directory
3
[2024-12-24 22:07:57,061] torch.distributed.run: [WARNING] 
[2024-12-24 22:07:57,061] torch.distributed.run: [WARNING] *****************************************
[2024-12-24 22:07:57,061] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-12-24 22:07:57,061] torch.distributed.run: [WARNING] *****************************************
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
> setting tensorboard ...
WARNING: one_logger package is required to enable e2e metrics tracking. please go to https://confluence.nvidia.com/display/MLWFO/Package+Repositories for details to install it
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
---Rank 13---Tensor Parallel Group GPUs: [0]---Rank 15---Tensor Parallel Group GPUs: [0]

---Rank 13---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
---Rank 15---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
[rank13]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
---Rank 14---Tensor Parallel Group GPUs: [0][rank15]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())

---Rank 12---Tensor Parallel Group GPUs: [0]
---Rank 14---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
---Rank 12---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
[rank14]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank12]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
 > number of parameters on (tensor, pipeline) model parallel rank (0, 3): 570445824
rank=1, worker=0: shard_range=[pretrain-2.tar[5000, 5100), pretrain-2.tar[5100, 5200), pretrain-2.tar[5200, 5300), ...<619>, pretrain-25.tar[7200, 7300), pretrain-25.tar[7300, 7400), pretrain-25.tar[7400, 7500)] sum(count)=62500
rank=1, worker=1: shard_range=[pretrain-25.tar[7500, 7600), pretrain-25.tar[7600, 7700), pretrain-25.tar[7700, 7800), ...<619>, pretrain-30.tar[9700, 9800), pretrain-30.tar[9800, 9900), pretrain-30.tar[9900, 10000)] sum(count)=62500
rank=2, worker=0: shard_range=[pretrain-31.tar[0, 100), pretrain-31.tar[100, 200), pretrain-31.tar[200, 300), ...<619>, pretrain-37.tar[2200, 2300), pretrain-37.tar[2300, 2400), pretrain-37.tar[2400, 2500)] sum(count)=62500
rank=2, worker=1: shard_range=[pretrain-37.tar[2500, 2600), pretrain-37.tar[2600, 2700), pretrain-37.tar[2700, 2800), ...<619>, pretrain-42.tar[4700, 4800), pretrain-42.tar[4800, 4900), pretrain-42.tar[4900, 5000)] sum(count)=62500
rank=0, worker=0: shard_range=[pretrain-0.tar[0, 100), pretrain-0.tar[100, 200), pretrain-0.tar[200, 300), ...<619>, pretrain-14.tar[2200, 2300), pretrain-14.tar[2300, 2400), pretrain-14.tar[2400, 2500)] sum(count)=62500
rank=0, worker=1: shard_range=[pretrain-14.tar[2500, 2600), pretrain-14.tar[2600, 2700), pretrain-14.tar[2700, 2800), ...<619>, pretrain-2.tar[4700, 4800), pretrain-2.tar[4800, 4900), pretrain-2.tar[4900, 5000)] sum(count)=62500
rank=3, worker=0: shard_range=[pretrain-42.tar[5000, 5100), pretrain-42.tar[5100, 5200), pretrain-42.tar[5200, 5300), ...<619>, pretrain-48.tar[7200, 7300), pretrain-48.tar[7300, 7400), pretrain-48.tar[7400, 7500)] sum(count)=62500
rank=3, worker=1: shard_range=[pretrain-48.tar[7500, 7600), pretrain-48.tar[7600, 7700), pretrain-48.tar[7700, 7800), ...<619>, pretrain-53.tar[9700, 9800), pretrain-53.tar[9800, 9900), pretrain-53.tar[9900, 10000)] sum(count)=62500
rank=3, worker=0: shard_range=[pretrain-8.tar[5468, 10000), pretrain-9.tar[0, 2734)] sum(count)=7266
rank=3, worker=1: shard_range=[pretrain-9.tar[2734, 10000)] sum(count)=7266
rank=1, worker=0: shard_range=[pretrain-55.tar[4532, 8128), pretrain-6.tar[0, 3670)] sum(count)=7266
rank=1, worker=1: shard_range=[pretrain-6.tar[3670, 10000), pretrain-7.tar[0, 936)] sum(count)=7266
rank=2, worker=0: shard_range=[pretrain-7.tar[936, 8202)] sum(count)=7266
rank=2, worker=1: shard_range=[pretrain-7.tar[8202, 10000), pretrain-8.tar[0, 5468)] sum(count)=7266
rank=0, worker=0: shard_range=[pretrain-54.tar[0, 7266)] sum(count)=7266
rank=0, worker=1: shard_range=[pretrain-54.tar[7266, 10000), pretrain-55.tar[0, 4532)] sum(count)=7266
times across ranks (ms):
  model-and-optimizer-setup:
     rank  0: 109.44
     rank  1: 82.17
     rank  2: 80.26
     rank  3: 77.06
     rank  4: 28.46
     rank  5: 26.57
     rank  6: 26.00
     rank  7: 30.76
     rank  8: 53.66
     rank  9: 51.96
     rank 10: 48.54
     rank 11: 50.81
     rank 12: 44.94
     rank 13: 43.54
     rank 14: 44.69
     rank 15: 42.98
  train/valid/test-data-iterators-setup:
     rank  0: 1024.75
     rank  1: 1024.73
     rank  2: 1025.13
     rank  3: 1024.72
     rank  4: 1036.05
     rank  5: 1036.09
     rank  6: 1144.71
     rank  7: 1331.92
     rank  8: 1355.08
     rank  9: 1355.51
     rank 10: 1338.78
     rank 11: 1354.98
     rank 12: 1356.16
     rank 13: 1356.24
     rank 14: 1356.15
     rank 15: 1356.24
 [2024-12-24 22:08:33] iteration        1/      10 | consumed samples:           16 | elapsed time per iteration (ms): 11684.8 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 7.261258E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
stage4 GPU utialization:29.370966824618254 %
[Rank 12] (after 1 iterations) memory (MB) | allocated: 2352.3310546875 | max allocated: 3308.345703125 | reserved: 3478.0 | max reserved: 3478.0
times across ranks (ms):
  forward-backward:
     rank  0: 11512.47
     rank  1: 11512.52
     rank  2: 11512.58
     rank  3: 11512.47
     rank  4: 11634.76
     rank  5: 11634.77
     rank  6: 11635.29
     rank  7: 11635.23
     rank  8: 11628.37
     rank  9: 11628.95
     rank 10: 11629.44
     rank 11: 11628.74
     rank 12: 11509.26
     rank 13: 11509.11
     rank 14: 11509.36
     rank 15: 11509.11
  forward-compute:
     rank  0: 4344.37
     rank  1: 4127.49
     rank  2: 3951.66
     rank  3: 4135.28
     rank  4: 2751.85
     rank  5: 2721.56
     rank  6: 2704.55
     rank  7: 2682.10
     rank  8: 1759.11
     rank  9: 1969.76
     rank 10: 2155.41
     rank 11: 2067.24
     rank 12: 1762.09
     rank 13: 1824.73
     rank 14: 1833.26
     rank 15: 1746.42
  backward-compute:
     rank  0: 1145.35
     rank  1: 1084.02
     rank  2: 1090.48
     rank  3: 1259.51
     rank  4: 474.60
     rank  5: 479.40
     rank  6: 474.58
     rank  7: 469.01
     rank  8: 471.22
     rank  9: 507.49
     rank 10: 507.50
     rank 11: 500.78
     rank 12: 492.16
     rank 13: 489.88
     rank 14: 488.80
     rank 15: 491.52
  pure-backward-compute:
     rank  0: 1144.88
     rank  1: 1083.52
     rank  2: 1089.96
     rank  3: 1259.06
     rank  4: 474.21
     rank  5: 479.08
     rank  6: 474.33
     rank  7: 468.75
     rank  8: 470.57
     rank  9: 506.92
     rank 10: 506.94
     rank 11: 500.22
     rank 12: 491.39
     rank 13: 489.22
     rank 14: 488.17
     rank 15: 490.83
  batch-generator:
     rank  0: 985.36
     rank  1: 1001.97
     rank  2: 1040.08
     rank  3: 999.19
     rank  4: 1021.46
     rank  5: 992.75
     rank  6: 1011.49
     rank  7: 1004.78
     rank  8: 1201.45
     rank  9: 1374.19
     rank 10: 1566.98
     rank 11: 1505.52
     rank 12: 1006.53
     rank 13: 1049.46
     rank 14: 1030.21
     rank 15: 966.63
  forward-recv:
     rank  4: 4209.60
     rank  5: 3949.76
     rank  6: 3785.91
     rank  7: 3961.09
     rank  8: 6602.67
     rank  9: 6311.20
     rank 10: 6129.87
     rank 11: 6290.32
     rank 12: 8025.25
     rank 13: 7925.70
     rank 14: 7921.45
     rank 15: 8025.84
  forward-send:
     rank  0: 3795.05
     rank  1: 3911.71
     rank  2: 4087.59
     rank  3: 4005.17
     rank  4: 1328.61
     rank  5: 1519.79
     rank  6: 1693.99
     rank  7: 1643.52
     rank  8: 23.60
     rank  9: 22.49
     rank 10: 22.35
     rank 11: 34.30
  backward-recv:
     rank  0: 8.78
     rank  1: 24.95
     rank  2: 21.74
     rank  3: 17.68
     rank  4: 3.32
     rank  5: 11.00
     rank  6: 10.73
     rank  7: 10.59
     rank  8: 1.75
     rank  9: 2.37
     rank 10: 1.74
     rank 11: 1.71
  backward-send:
     rank  4: 549.15
     rank  5: 493.97
     rank  6: 502.81
     rank  7: 673.32
     rank  8: 429.66
     rank  9: 365.25
     rank 10: 373.28
     rank 11: 544.02
     rank 12: 286.09
     rank 13: 247.43
     rank 14: 249.34
     rank 15: 408.70
  forward-send-backward-recv:
     rank  0: 1644.34
     rank  1: 1757.12
     rank  2: 1753.03
     rank  3: 1647.11
     rank  4: 1495.55
     rank  5: 1605.27
     rank  6: 1610.91
     rank  7: 1502.68
     rank  8: 1374.73
     rank  9: 1469.83
     rank 10: 1467.41
     rank 11: 1374.95
  backward-send-forward-recv:
     rank  4: 13.12
     rank  5: 16.48
     rank  6: 12.71
     rank  7: 12.15
     rank  8: 42.71
     rank  9: 26.84
     rank 10: 18.94
     rank 11: 22.85
     rank 12: 23.48
     rank 13: 62.22
     rank 14: 59.02
     rank 15: 40.35
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.04
     rank  3: 0.03
     rank  4: 0.04
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.04
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.04
     rank 14: 0.05
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.08
     rank  1: 0.09
     rank  2: 0.08
     rank  3: 0.06
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.08
     rank 13: 0.08
     rank 14: 0.10
     rank 15: 0.07
  all-grads-sync:
     rank  0: 436.94
     rank  1: 437.04
     rank  2: 436.95
     rank  3: 436.82
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.27
     rank  1: 0.28
     rank  2: 0.29
     rank  3: 0.22
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.06
     rank  7: 0.06
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.07
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.04
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.04
     rank  5: 0.04
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.04
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 42.71
     rank  1: 43.21
     rank  2: 43.21
     rank  3: 41.64
     rank  4: 0.15
     rank  5: 0.16
     rank  6: 0.26
     rank  7: 0.30
     rank  8: 0.19
     rank  9: 0.22
     rank 10: 0.22
     rank 11: 0.16
     rank 12: 0.11
     rank 13: 0.11
     rank 14: 0.11
     rank 15: 0.11
  optimizer:
     rank  0: 45.84
     rank  1: 46.33
     rank  2: 46.34
     rank  3: 44.76
     rank  4: 3.28
     rank  5: 3.27
     rank  6: 3.40
     rank  7: 3.43
     rank  8: 3.28
     rank  9: 3.34
     rank 10: 2.11
     rank 11: 3.24
     rank 12: 3.23
     rank 13: 3.23
     rank 14: 3.23
     rank 15: 3.23
 [2024-12-24 22:08:35] iteration        2/      10 | consumed samples:           32 | elapsed time per iteration (ms): 2131.4 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 7.287670E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2051.53
     rank  1: 2051.60
     rank  2: 2051.54
     rank  3: 2051.53
     rank  4: 2047.88
     rank  5: 2047.87
     rank  6: 2047.89
     rank  7: 2047.98
     rank  8: 2047.80
     rank  9: 2047.73
     rank 10: 2047.89
     rank 11: 2047.78
     rank 12: 2047.63
     rank 13: 2047.61
     rank 14: 2047.68
     rank 15: 2047.61
  forward-compute:
     rank  0: 459.41
     rank  1: 455.51
     rank  2: 465.88
     rank  3: 407.15
     rank  4: 512.91
     rank  5: 520.84
     rank  6: 521.79
     rank  7: 508.02
     rank  8: 452.44
     rank  9: 479.38
     rank 10: 484.34
     rank 11: 481.49
     rank 12: 507.15
     rank 13: 493.25
     rank 14: 488.89
     rank 15: 524.93
  backward-compute:
     rank  0: 451.02
     rank  1: 442.67
     rank  2: 445.15
     rank  3: 451.75
     rank  4: 466.69
     rank  5: 472.42
     rank  6: 473.04
     rank  7: 464.89
     rank  8: 458.12
     rank  9: 503.04
     rank 10: 501.91
     rank 11: 499.40
     rank 12: 494.67
     rank 13: 489.57
     rank 14: 490.16
     rank 15: 492.41
  pure-backward-compute:
     rank  0: 450.79
     rank  1: 442.51
     rank  2: 444.67
     rank  3: 451.61
     rank  4: 466.34
     rank  5: 472.12
     rank  6: 472.65
     rank  7: 464.24
     rank  8: 457.76
     rank  9: 502.71
     rank 10: 501.49
     rank 11: 499.00
     rank 12: 493.89
     rank 13: 488.96
     rank 14: 489.37
     rank 15: 491.75
  batch-generator:
     rank  0: 13.35
     rank  1: 16.47
     rank  2: 15.61
     rank  3: 11.29
     rank  4: 13.41
     rank  5: 11.35
     rank  6: 14.27
     rank  7: 14.40
     rank  8: 17.70
     rank  9: 13.98
     rank 10: 17.49
     rank 11: 14.35
     rank 12: 16.77
     rank 13: 13.22
     rank 14: 14.99
     rank 15: 14.52
  forward-recv:
     rank  4: 113.85
     rank  5: 114.95
     rank  6: 116.27
     rank  7: 102.50
     rank  8: 253.18
     rank  9: 255.94
     rank 10: 255.81
     rank 11: 238.01
     rank 12: 363.10
     rank 13: 367.94
     rank 14: 372.27
     rank 15: 347.54
  forward-send:
     rank  0: 43.80
     rank  1: 44.70
     rank  2: 42.32
     rank  3: 59.50
     rank  4: 3.68
     rank  5: 5.26
     rank  6: 3.59
     rank  7: 3.57
     rank  8: 2.92
     rank  9: 3.39
     rank 10: 1.74
     rank 11: 1.71
  backward-recv:
     rank  0: 416.10
     rank  1: 424.64
     rank  2: 422.84
     rank  3: 423.19
     rank  4: 262.08
     rank  5: 257.16
     rank  6: 262.20
     rank  7: 271.43
     rank  8: 140.08
     rank  9: 119.17
     rank 10: 121.91
     rank 11: 128.09
  backward-send:
     rank  4: 4.60
     rank  5: 5.05
     rank  6: 4.90
     rank  7: 4.91
     rank  8: 3.36
     rank  9: 3.56
     rank 10: 3.80
     rank 11: 3.69
     rank 12: 4.70
     rank 13: 3.60
     rank 14: 4.62
     rank 15: 4.67
  forward-send-backward-recv:
     rank  0: 356.53
     rank  1: 371.19
     rank  2: 364.21
     rank  3: 402.00
     rank  4: 248.92
     rank  5: 250.75
     rank  6: 247.62
     rank  7: 271.39
     rank  8: 183.80
     rank  9: 139.36
     rank 10: 136.62
     rank 11: 154.56
  backward-send-forward-recv:
     rank  4: 1.93
     rank  5: 2.31
     rank  6: 2.29
     rank  7: 2.01
     rank  8: 4.84
     rank  9: 6.82
     rank 10: 6.99
     rank 11: 5.24
     rank 12: 17.15
     rank 13: 30.30
     rank 14: 29.98
     rank 15: 17.37
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.05
     rank  6: 0.02
     rank  7: 0.05
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.11
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.05
     rank  2: 0.05
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.05
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.04
     rank 12: 0.06
     rank 13: 0.06
     rank 14: 0.07
     rank 15: 0.06
  all-grads-sync:
     rank  0: 300.09
     rank  1: 300.03
     rank  2: 300.07
     rank  3: 300.16
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.22
     rank  1: 0.22
     rank  2: 0.22
     rank  3: 0.17
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.05
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.02
     rank  9: 0.05
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 38.12
     rank  1: 38.30
     rank  2: 37.95
     rank  3: 37.81
     rank  4: 0.05
     rank  5: 0.04
     rank  6: 0.09
     rank  7: 0.20
     rank  8: 0.16
     rank  9: 0.25
     rank 10: 0.07
     rank 11: 0.08
     rank 12: 0.05
     rank 13: 0.04
     rank 14: 0.07
     rank 15: 0.04
  optimizer:
     rank  0: 39.03
     rank  1: 39.18
     rank  2: 38.81
     rank  3: 38.67
     rank  4: 0.90
     rank  5: 0.89
     rank  6: 0.95
     rank  7: 1.05
     rank  8: 1.01
     rank  9: 1.09
     rank 10: 0.92
     rank 11: 0.93
     rank 12: 0.90
     rank 13: 0.88
     rank 14: 0.93
     rank 15: 0.89
 [2024-12-24 22:08:37] iteration        3/      10 | consumed samples:           48 | elapsed time per iteration (ms): 2114.3 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 7.025959E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2049.60
     rank  1: 2049.61
     rank  2: 2049.66
     rank  3: 2049.62
     rank  4: 2046.22
     rank  5: 2046.15
     rank  6: 2046.18
     rank  7: 2046.16
     rank  8: 2046.35
     rank  9: 2046.28
     rank 10: 2046.39
     rank 11: 2046.29
     rank 12: 2046.12
     rank 13: 2046.10
     rank 14: 2046.12
     rank 15: 2046.10
  forward-compute:
     rank  0: 416.41
     rank  1: 415.51
     rank  2: 413.32
     rank  3: 407.83
     rank  4: 512.83
     rank  5: 522.29
     rank  6: 518.09
     rank  7: 510.24
     rank  8: 448.92
     rank  9: 481.74
     rank 10: 482.21
     rank 11: 480.30
     rank 12: 504.87
     rank 13: 489.11
     rank 14: 496.57
     rank 15: 512.11
  backward-compute:
     rank  0: 454.84
     rank  1: 443.65
     rank  2: 446.53
     rank  3: 453.31
     rank  4: 470.01
     rank  5: 474.70
     rank  6: 471.21
     rank  7: 464.76
     rank  8: 465.59
     rank  9: 503.76
     rank 10: 501.68
     rank 11: 501.61
     rank 12: 495.69
     rank 13: 490.29
     rank 14: 491.48
     rank 15: 491.48
  pure-backward-compute:
     rank  0: 454.63
     rank  1: 443.43
     rank  2: 446.07
     rank  3: 453.08
     rank  4: 469.46
     rank  5: 474.37
     rank  6: 470.86
     rank  7: 464.35
     rank  8: 465.23
     rank  9: 503.36
     rank 10: 501.07
     rank 11: 501.27
     rank 12: 494.97
     rank 13: 489.67
     rank 14: 490.86
     rank 15: 490.82
  batch-generator:
     rank  0: 11.89
     rank  1: 15.72
     rank  2: 14.55
     rank  3: 12.62
     rank  4: 13.81
     rank  5: 11.86
     rank  6: 16.60
     rank  7: 15.17
     rank  8: 14.82
     rank  9: 12.82
     rank 10: 14.87
     rank 11: 14.58
     rank 12: 16.43
     rank 13: 12.78
     rank 14: 15.66
     rank 15: 16.22
  forward-recv:
     rank  4: 114.11
     rank  5: 108.31
     rank  6: 106.98
     rank  7: 102.02
     rank  8: 261.26
     rank  9: 253.71
     rank 10: 246.81
     rank 11: 240.60
     rank 12: 354.92
     rank 13: 361.57
     rank 14: 355.89
     rank 15: 347.91
  forward-send:
     rank  0: 61.78
     rank  1: 68.88
     rank  2: 60.82
     rank  3: 61.04
     rank  4: 5.43
     rank  5: 5.74
     rank  6: 3.42
     rank  7: 3.63
     rank  8: 2.74
     rank  9: 3.21
     rank 10: 2.16
     rank 11: 1.63
  backward-recv:
     rank  0: 420.75
     rank  1: 426.16
     rank  2: 421.37
     rank  3: 423.91
     rank  4: 268.48
     rank  5: 261.00
     rank  6: 263.61
     rank  7: 269.59
     rank  8: 137.97
     rank  9: 120.23
     rank 10: 120.24
     rank 11: 126.89
  backward-send:
     rank  4: 4.70
     rank  5: 5.43
     rank  6: 5.49
     rank  7: 5.90
     rank  8: 3.44
     rank  9: 4.76
     rank 10: 4.30
     rank 11: 4.41
     rank 12: 4.58
     rank 13: 4.61
     rank 14: 3.51
     rank 15: 4.64
  forward-send-backward-recv:
     rank  0: 371.94
     rank  1: 379.02
     rank  2: 387.62
     rank  3: 388.55
     rank  4: 235.23
     rank  5: 243.59
     rank  6: 250.49
     rank  7: 263.62
     rank  8: 169.72
     rank  9: 129.29
     rank 10: 137.78
     rank 11: 142.51
  backward-send-forward-recv:
     rank  4: 2.05
     rank  5: 2.53
     rank  6: 2.08
     rank  7: 2.03
     rank  8: 4.79
     rank  9: 6.64
     rank 10: 6.80
     rank 11: 5.72
     rank 12: 16.51
     rank 13: 30.54
     rank 14: 27.10
     rank 15: 20.23
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.05
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.05
     rank  2: 0.05
     rank  3: 0.06
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.07
     rank 13: 0.06
     rank 14: 0.06
     rank 15: 0.06
  all-grads-sync:
     rank  0: 306.91
     rank  1: 306.79
     rank  2: 306.81
     rank  3: 306.93
     rank  4: 0.03
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.19
     rank  1: 0.19
     rank  2: 0.20
     rank  3: 0.22
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.04
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 37.70
     rank  1: 37.85
     rank  2: 37.86
     rank  3: 37.95
     rank  4: 0.10
     rank  5: 0.06
     rank  6: 0.04
     rank  7: 0.05
     rank  8: 0.12
     rank  9: 0.05
     rank 10: 0.12
     rank 11: 0.04
     rank 12: 0.07
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.05
  optimizer:
     rank  0: 38.50
     rank  1: 38.66
     rank  2: 38.67
     rank  3: 38.77
     rank  4: 0.91
     rank  5: 0.86
     rank  6: 0.85
     rank  7: 0.85
     rank  8: 0.92
     rank  9: 0.85
     rank 10: 0.92
     rank 11: 0.84
     rank 12: 0.88
     rank 13: 0.84
     rank 14: 0.85
     rank 15: 0.85
 [2024-12-24 22:08:39] iteration        4/      10 | consumed samples:           64 | elapsed time per iteration (ms): 2113.3 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 7.280986E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2048.30
     rank  1: 2048.31
     rank  2: 2048.36
     rank  3: 2048.31
     rank  4: 2044.89
     rank  5: 2044.90
     rank  6: 2044.90
     rank  7: 2044.97
     rank  8: 2045.26
     rank  9: 2045.11
     rank 10: 2045.11
     rank 11: 2045.12
     rank 12: 2044.83
     rank 13: 2044.83
     rank 14: 2044.83
     rank 15: 2044.82
  forward-compute:
     rank  0: 400.96
     rank  1: 404.27
     rank  2: 409.24
     rank  3: 406.10
     rank  4: 512.98
     rank  5: 517.22
     rank  6: 517.08
     rank  7: 508.99
     rank  8: 443.49
     rank  9: 483.59
     rank 10: 482.38
     rank 11: 481.81
     rank 12: 514.03
     rank 13: 492.91
     rank 14: 494.00
     rank 15: 491.76
  backward-compute:
     rank  0: 452.62
     rank  1: 443.93
     rank  2: 445.18
     rank  3: 452.12
     rank  4: 468.52
     rank  5: 471.45
     rank  6: 472.07
     rank  7: 466.22
     rank  8: 466.95
     rank  9: 506.40
     rank 10: 505.50
     rank 11: 498.20
     rank 12: 493.76
     rank 13: 490.78
     rank 14: 491.37
     rank 15: 492.99
  pure-backward-compute:
     rank  0: 452.40
     rank  1: 443.77
     rank  2: 444.77
     rank  3: 451.95
     rank  4: 468.12
     rank  5: 471.05
     rank  6: 471.68
     rank  7: 465.77
     rank  8: 466.45
     rank  9: 506.08
     rank 10: 505.01
     rank 11: 497.86
     rank 12: 493.06
     rank 13: 490.20
     rank 14: 490.77
     rank 15: 492.32
  batch-generator:
     rank  0: 11.26
     rank  1: 11.91
     rank  2: 12.25
     rank  3: 11.44
     rank  4: 14.90
     rank  5: 12.10
     rank  6: 12.73
     rank  7: 14.53
     rank  8: 14.40
     rank  9: 12.93
     rank 10: 15.16
     rank 11: 16.67
     rank 12: 15.96
     rank 13: 13.65
     rank 14: 15.47
     rank 15: 13.42
  forward-recv:
     rank  4: 103.92
     rank  5: 103.37
     rank  6: 106.61
     rank  7: 112.36
     rank  8: 250.27
     rank  9: 245.59
     rank 10: 246.15
     rank 11: 249.82
     rank 12: 345.72
     rank 13: 353.54
     rank 14: 357.11
     rank 15: 354.76
  forward-send:
     rank  0: 65.33
     rank  1: 67.71
     rank  2: 65.48
     rank  3: 67.80
     rank  4: 4.83
     rank  5: 6.43
     rank  6: 5.79
     rank  7: 6.20
     rank  8: 2.75
     rank  9: 2.88
     rank 10: 1.72
     rank 11: 1.79
  backward-recv:
     rank  0: 424.70
     rank  1: 431.82
     rank  2: 428.42
     rank  3: 424.41
     rank  4: 274.03
     rank  5: 265.36
     rank  6: 267.53
     rank  7: 266.44
     rank  8: 140.06
     rank  9: 119.95
     rank 10: 122.52
     rank 11: 124.11
  backward-send:
     rank  4: 4.77
     rank  5: 5.39
     rank  6: 6.86
     rank  7: 6.13
     rank  8: 3.61
     rank  9: 5.13
     rank 10: 6.38
     rank 11: 5.33
     rank 12: 4.96
     rank 13: 4.81
     rank 14: 4.12
     rank 15: 4.94
  forward-send-backward-recv:
     rank  0: 378.87
     rank  1: 384.98
     rank  2: 383.10
     rank  3: 380.84
     rank  4: 239.57
     rank  5: 249.33
     rank  6: 244.48
     rank  7: 249.24
     rank  8: 180.97
     rank  9: 131.72
     rank 10: 130.55
     rank 11: 132.24
  backward-send-forward-recv:
     rank  4: 2.00
     rank  5: 4.00
     rank  6: 2.53
     rank  7: 2.11
     rank  8: 4.81
     rank  9: 7.58
     rank 10: 6.95
     rank 11: 7.74
     rank 12: 15.89
     rank 13: 31.89
     rank 14: 26.43
     rank 15: 30.01
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.16
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.05
     rank  2: 0.05
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.07
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.06
     rank 13: 0.07
     rank 14: 0.06
     rank 15: 0.06
  all-grads-sync:
     rank  0: 306.52
     rank  1: 306.45
     rank  2: 306.43
     rank  3: 306.57
     rank  4: 0.02
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.09
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.19
     rank  1: 0.19
     rank  2: 0.20
     rank  3: 0.19
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.05
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.04
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 37.68
     rank  1: 37.71
     rank  2: 37.73
     rank  3: 37.67
     rank  4: 0.05
     rank  5: 0.07
     rank  6: 0.05
     rank  7: 0.09
     rank  8: 0.17
     rank  9: 0.04
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.05
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.04
  optimizer:
     rank  0: 39.56
     rank  1: 39.59
     rank  2: 39.61
     rank  3: 39.55
     rank  4: 2.02
     rank  5: 1.95
     rank  6: 1.93
     rank  7: 1.97
     rank  8: 2.05
     rank  9: 1.92
     rank 10: 1.92
     rank 11: 1.93
     rank 12: 1.93
     rank 13: 1.92
     rank 14: 1.92
     rank 15: 1.92
 [2024-12-24 22:08:41] iteration        5/      10 | consumed samples:           80 | elapsed time per iteration (ms): 2105.8 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 7.195778E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2041.09
     rank  1: 2041.12
     rank  2: 2041.23
     rank  3: 2041.10
     rank  4: 2037.58
     rank  5: 2037.60
     rank  6: 2037.64
     rank  7: 2037.60
     rank  8: 2037.86
     rank  9: 2037.79
     rank 10: 2037.77
     rank 11: 2037.78
     rank 12: 2037.65
     rank 13: 2037.63
     rank 14: 2037.69
     rank 15: 2037.63
  forward-compute:
     rank  0: 404.49
     rank  1: 396.98
     rank  2: 406.19
     rank  3: 400.64
     rank  4: 513.93
     rank  5: 516.28
     rank  6: 520.14
     rank  7: 513.24
     rank  8: 456.70
     rank  9: 482.57
     rank 10: 481.77
     rank 11: 479.97
     rank 12: 507.55
     rank 13: 491.38
     rank 14: 498.39
     rank 15: 495.03
  backward-compute:
     rank  0: 457.16
     rank  1: 444.18
     rank  2: 451.32
     rank  3: 452.80
     rank  4: 468.18
     rank  5: 471.51
     rank  6: 473.84
     rank  7: 470.88
     rank  8: 467.92
     rank  9: 504.82
     rank 10: 504.50
     rank 11: 503.76
     rank 12: 496.04
     rank 13: 491.67
     rank 14: 490.10
     rank 15: 493.79
  pure-backward-compute:
     rank  0: 456.94
     rank  1: 444.03
     rank  2: 450.90
     rank  3: 452.64
     rank  4: 467.95
     rank  5: 471.21
     rank  6: 473.61
     rank  7: 470.63
     rank  8: 467.01
     rank  9: 504.01
     rank 10: 504.16
     rank 11: 503.36
     rank 12: 495.29
     rank 13: 491.08
     rank 14: 489.43
     rank 15: 493.14
  batch-generator:
     rank  0: 11.30
     rank  1: 11.79
     rank  2: 11.47
     rank  3: 11.46
     rank  4: 13.47
     rank  5: 12.17
     rank  6: 12.94
     rank  7: 14.03
     rank  8: 20.17
     rank  9: 14.14
     rank 10: 13.92
     rank 11: 13.65
     rank 12: 17.62
     rank 13: 13.38
     rank 14: 18.24
     rank 15: 13.12
  forward-recv:
     rank  4: 108.40
     rank  5: 107.14
     rank  6: 106.58
     rank  7: 106.48
     rank  8: 252.63
     rank  9: 248.76
     rank 10: 251.21
     rank 11: 244.46
     rank 12: 351.34
     rank 13: 354.27
     rank 14: 356.03
     rank 15: 352.09
  forward-send:
     rank  0: 69.70
     rank  1: 75.12
     rank  2: 70.82
     rank  3: 64.85
     rank  4: 5.76
     rank  5: 6.75
     rank  6: 4.25
     rank  7: 4.42
     rank  8: 2.95
     rank  9: 3.01
     rank 10: 1.57
     rank 11: 2.84
  backward-recv:
     rank  0: 418.25
     rank  1: 429.74
     rank  2: 421.79
     rank  3: 422.77
     rank  4: 274.25
     rank  5: 265.56
     rank  6: 268.71
     rank  7: 264.27
     rank  8: 140.51
     rank  9: 120.76
     rank 10: 125.44
     rank 11: 122.40
  backward-send:
     rank  4: 4.47
     rank  5: 5.96
     rank  6: 5.81
     rank  7: 5.44
     rank  8: 3.46
     rank  9: 5.33
     rank 10: 5.30
     rank 11: 4.77
     rank 12: 4.47
     rank 13: 4.48
     rank 14: 2.75
     rank 15: 4.44
  forward-send-backward-recv:
     rank  0: 371.96
     rank  1: 386.32
     rank  2: 380.16
     rank  3: 392.64
     rank  4: 231.48
     rank  5: 244.73
     rank  6: 238.96
     rank  7: 251.32
     rank  8: 162.96
     rank  9: 128.06
     rank 10: 125.29
     rank 11: 133.94
  backward-send-forward-recv:
     rank  4: 1.99
     rank  5: 3.50
     rank  6: 3.18
     rank  7: 3.81
     rank  8: 5.04
     rank  9: 7.97
     rank 10: 6.12
     rank 11: 8.17
     rank 12: 14.54
     rank 13: 31.62
     rank 14: 23.51
     rank 15: 28.03
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.05
     rank  2: 0.06
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.06
     rank 13: 0.06
     rank 14: 0.08
     rank 15: 0.06
  all-grads-sync:
     rank  0: 300.15
     rank  1: 300.08
     rank  2: 300.10
     rank  3: 300.21
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.18
     rank  1: 0.20
     rank  2: 0.23
     rank  3: 0.18
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 37.70
     rank  1: 37.72
     rank  2: 37.98
     rank  3: 37.69
     rank  4: 0.04
     rank  5: 0.03
     rank  6: 0.07
     rank  7: 0.03
     rank  8: 0.05
     rank  9: 0.06
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.05
     rank 15: 0.04
  optimizer:
     rank  0: 38.53
     rank  1: 38.55
     rank  2: 38.81
     rank  3: 38.52
     rank  4: 0.87
     rank  5: 0.86
     rank  6: 0.89
     rank  7: 0.86
     rank  8: 0.88
     rank  9: 0.88
     rank 10: 0.87
     rank 11: 0.90
     rank 12: 0.87
     rank 13: 0.87
     rank 14: 0.88
     rank 15: 0.87
 [2024-12-24 22:08:43] iteration        6/      10 | consumed samples:           96 | elapsed time per iteration (ms): 2103.7 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 6.553204E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2037.88
     rank  1: 2037.90
     rank  2: 2037.97
     rank  3: 2037.87
     rank  4: 2034.34
     rank  5: 2034.35
     rank  6: 2034.38
     rank  7: 2034.35
     rank  8: 2034.39
     rank  9: 2034.39
     rank 10: 2034.43
     rank 11: 2034.40
     rank 12: 2034.23
     rank 13: 2034.22
     rank 14: 2034.23
     rank 15: 2034.23
  forward-compute:
     rank  0: 407.77
     rank  1: 399.92
     rank  2: 449.56
     rank  3: 402.67
     rank  4: 511.88
     rank  5: 516.68
     rank  6: 514.74
     rank  7: 513.73
     rank  8: 450.38
     rank  9: 483.11
     rank 10: 483.48
     rank 11: 478.53
     rank 12: 519.49
     rank 13: 499.94
     rank 14: 490.30
     rank 15: 517.66
  backward-compute:
     rank  0: 458.83
     rank  1: 445.37
     rank  2: 452.55
     rank  3: 452.65
     rank  4: 470.46
     rank  5: 473.66
     rank  6: 472.26
     rank  7: 469.50
     rank  8: 468.46
     rank  9: 506.41
     rank 10: 504.75
     rank 11: 504.26
     rank 12: 494.97
     rank 13: 492.24
     rank 14: 492.41
     rank 15: 492.94
  pure-backward-compute:
     rank  0: 458.68
     rank  1: 445.21
     rank  2: 452.13
     rank  3: 452.50
     rank  4: 470.23
     rank  5: 473.32
     rank  6: 472.02
     rank  7: 469.24
     rank  8: 468.12
     rank  9: 506.03
     rank 10: 504.34
     rank 11: 503.93
     rank 12: 494.10
     rank 13: 491.65
     rank 14: 491.71
     rank 15: 492.26
  batch-generator:
     rank  0: 11.76
     rank  1: 11.16
     rank  2: 13.79
     rank  3: 11.21
     rank  4: 10.92
     rank  5: 11.21
     rank  6: 10.29
     rank  7: 12.56
     rank  8: 14.97
     rank  9: 14.63
     rank 10: 13.11
     rank 11: 15.18
     rank 12: 16.37
     rank 13: 13.97
     rank 14: 13.48
     rank 15: 14.32
  forward-recv:
     rank  4: 103.93
     rank  5: 103.41
     rank  6: 114.04
     rank  7: 101.81
     rank  8: 246.43
     rank  9: 242.81
     rank 10: 255.45
     rank 11: 240.47
     rank 12: 345.39
     rank 13: 354.26
     rank 14: 361.51
     rank 15: 348.20
  forward-send:
     rank  0: 59.87
     rank  1: 67.55
     rank  2: 39.64
     rank  3: 57.90
     rank  4: 3.99
     rank  5: 5.45
     rank  6: 3.27
     rank  7: 3.86
     rank  8: 2.66
     rank  9: 2.90
     rank 10: 1.64
     rank 11: 1.60
  backward-recv:
     rank  0: 418.99
     rank  1: 428.57
     rank  2: 416.38
     rank  3: 425.87
     rank  4: 272.48
     rank  5: 263.58
     rank  6: 262.71
     rank  7: 271.27
     rank  8: 138.96
     rank  9: 119.80
     rank 10: 118.57
     rank 11: 128.21
  backward-send:
     rank  4: 4.47
     rank  5: 4.91
     rank  6: 4.37
     rank  7: 4.75
     rank  8: 3.43
     rank  9: 5.45
     rank 10: 4.43
     rank 11: 4.37
     rank 12: 4.59
     rank 13: 4.61
     rank 14: 3.67
     rank 15: 4.70
  forward-send-backward-recv:
     rank  0: 385.77
     rank  1: 396.87
     rank  2: 375.73
     rank  3: 399.53
     rank  4: 247.75
     rank  5: 256.65
     rank  6: 250.06
     rank  7: 258.91
     rank  8: 183.12
     rank  9: 138.95
     rank 10: 128.70
     rank 11: 143.88
  backward-send-forward-recv:
     rank  4: 1.85
     rank  5: 2.85
     rank  6: 2.46
     rank  7: 1.94
     rank  8: 4.86
     rank  9: 8.10
     rank 10: 7.94
     rank 11: 5.88
     rank 12: 15.31
     rank 13: 27.88
     rank 14: 29.75
     rank 15: 15.96
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.11
     rank  2: 0.09
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.06
     rank 13: 0.06
     rank 14: 0.06
     rank 15: 0.06
  all-grads-sync:
     rank  0: 291.57
     rank  1: 291.60
     rank  2: 291.63
     rank  3: 291.68
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.18
     rank  1: 0.25
     rank  2: 0.32
     rank  3: 0.18
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.06
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 37.70
     rank  1: 37.91
     rank  2: 38.00
     rank  3: 37.68
     rank  4: 0.05
     rank  5: 0.07
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.07
     rank 15: 0.04
  optimizer:
     rank  0: 38.62
     rank  1: 38.83
     rank  2: 38.94
     rank  3: 38.60
     rank  4: 0.97
     rank  5: 0.99
     rank  6: 0.95
     rank  7: 0.95
     rank  8: 0.96
     rank  9: 0.95
     rank 10: 0.96
     rank 11: 0.96
     rank 12: 0.96
     rank 13: 0.96
     rank 14: 0.99
     rank 15: 0.96
 [2024-12-24 22:08:45] iteration        7/      10 | consumed samples:          112 | elapsed time per iteration (ms): 2105.0 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 5.927121E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2039.06
     rank  1: 2038.94
     rank  2: 2038.98
     rank  3: 2038.95
     rank  4: 2035.38
     rank  5: 2035.34
     rank  6: 2035.35
     rank  7: 2035.37
     rank  8: 2035.49
     rank  9: 2035.40
     rank 10: 2035.40
     rank 11: 2035.42
     rank 12: 2035.33
     rank 13: 2035.32
     rank 14: 2035.33
     rank 15: 2035.32
  forward-compute:
     rank  0: 432.48
     rank  1: 403.39
     rank  2: 457.81
     rank  3: 400.29
     rank  4: 511.56
     rank  5: 518.41
     rank  6: 515.85
     rank  7: 513.15
     rank  8: 454.09
     rank  9: 481.00
     rank 10: 474.63
     rank 11: 482.80
     rank 12: 516.61
     rank 13: 501.19
     rank 14: 493.60
     rank 15: 500.64
  backward-compute:
     rank  0: 457.01
     rank  1: 446.52
     rank  2: 453.11
     rank  3: 453.15
     rank  4: 466.43
     rank  5: 475.29
     rank  6: 472.35
     rank  7: 471.62
     rank  8: 467.57
     rank  9: 508.71
     rank 10: 505.08
     rank 11: 504.99
     rank 12: 495.78
     rank 13: 492.49
     rank 14: 490.75
     rank 15: 494.60
  pure-backward-compute:
     rank  0: 456.62
     rank  1: 446.37
     rank  2: 452.68
     rank  3: 452.93
     rank  4: 466.20
     rank  5: 475.02
     rank  6: 472.07
     rank  7: 471.30
     rank  8: 467.24
     rank  9: 508.37
     rank 10: 504.59
     rank 11: 504.62
     rank 12: 495.03
     rank 13: 491.82
     rank 14: 490.15
     rank 15: 493.91
  batch-generator:
     rank  0: 13.21
     rank  1: 12.20
     rank  2: 14.59
     rank  3: 11.28
     rank  4: 10.82
     rank  5: 11.28
     rank  6: 10.31
     rank  7: 11.66
     rank  8: 13.69
     rank  9: 15.24
     rank 10: 13.33
     rank 11: 13.63
     rank 12: 15.60
     rank 13: 15.55
     rank 14: 14.10
     rank 15: 12.86
  forward-recv:
     rank  4: 104.56
     rank  5: 104.26
     rank  6: 119.52
     rank  7: 102.93
     rank  8: 248.61
     rank  9: 246.51
     rank 10: 269.21
     rank 11: 242.20
     rank 12: 345.11
     rank 13: 354.89
     rank 14: 360.23
     rank 15: 350.09
  forward-send:
     rank  0: 46.42
     rank  1: 67.62
     rank  2: 39.15
     rank  3: 64.42
     rank  4: 5.29
     rank  5: 5.08
     rank  6: 3.40
     rank  7: 5.20
     rank  8: 2.63
     rank  9: 2.78
     rank 10: 1.66
     rank 11: 1.64
  backward-recv:
     rank  0: 419.93
     rank  1: 429.80
     rank  2: 418.20
     rank  3: 425.09
     rank  4: 273.58
     rank  5: 265.67
     rank  6: 262.34
     rank  7: 262.93
     rank  8: 141.28
     rank  9: 119.64
     rank 10: 119.34
     rank 11: 119.23
  backward-send:
     rank  4: 4.48
     rank  5: 7.08
     rank  6: 6.00
     rank  7: 7.69
     rank  8: 3.37
     rank  9: 5.28
     rank 10: 3.95
     rank 11: 5.10
     rank 12: 3.91
     rank 13: 4.31
     rank 14: 2.85
     rank 15: 4.29
  forward-send-backward-recv:
     rank  0: 371.72
     rank  1: 392.77
     rank  2: 366.33
     rank  3: 397.65
     rank  4: 249.43
     rank  5: 250.22
     rank  6: 241.61
     rank  7: 261.32
     rank  8: 178.38
     rank  9: 138.31
     rank 10: 124.68
     rank 11: 144.16
  backward-send-forward-recv:
     rank  4: 2.21
     rank  5: 3.24
     rank  6: 3.62
     rank  7: 3.05
     rank  8: 4.85
     rank  9: 7.43
     rank 10: 7.90
     rank 11: 8.24
     rank 12: 20.32
     rank 13: 28.34
     rank 14: 31.67
     rank 15: 31.60
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.08
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.10
     rank  1: 0.04
     rank  2: 0.06
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.07
     rank 13: 0.06
     rank 14: 0.06
     rank 15: 0.06
  all-grads-sync:
     rank  0: 289.71
     rank  1: 289.70
     rank  2: 289.67
     rank  3: 289.68
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.03
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.30
     rank  1: 0.18
     rank  2: 0.22
     rank  3: 0.18
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 38.03
     rank  1: 37.69
     rank  2: 38.09
     rank  3: 37.67
     rank  4: 0.04
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.07
     rank  8: 0.14
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.08
     rank 12: 0.07
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.04
  optimizer:
     rank  0: 38.93
     rank  1: 38.59
     rank  2: 38.99
     rank  3: 38.57
     rank  4: 0.93
     rank  5: 0.93
     rank  6: 0.93
     rank  7: 0.96
     rank  8: 1.03
     rank  9: 0.93
     rank 10: 0.94
     rank 11: 0.98
     rank 12: 0.96
     rank 13: 0.93
     rank 14: 0.94
     rank 15: 0.93
 [2024-12-24 22:08:47] iteration        8/      10 | consumed samples:          128 | elapsed time per iteration (ms): 2128.6 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 4.866138E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2063.32
     rank  1: 2063.30
     rank  2: 2063.32
     rank  3: 2063.25
     rank  4: 2059.75
     rank  5: 2059.80
     rank  6: 2059.78
     rank  7: 2059.76
     rank  8: 2059.90
     rank  9: 2059.83
     rank 10: 2059.81
     rank 11: 2059.81
     rank 12: 2059.83
     rank 13: 2059.89
     rank 14: 2059.83
     rank 15: 2059.83
  forward-compute:
     rank  0: 462.93
     rank  1: 399.67
     rank  2: 448.47
     rank  3: 399.16
     rank  4: 510.27
     rank  5: 517.55
     rank  6: 516.22
     rank  7: 515.62
     rank  8: 454.44
     rank  9: 486.22
     rank 10: 482.60
     rank 11: 478.20
     rank 12: 509.16
     rank 13: 518.46
     rank 14: 505.86
     rank 15: 519.89
  backward-compute:
     rank  0: 458.55
     rank  1: 446.67
     rank  2: 449.85
     rank  3: 454.80
     rank  4: 469.24
     rank  5: 473.86
     rank  6: 472.12
     rank  7: 471.25
     rank  8: 468.83
     rank  9: 510.09
     rank 10: 505.56
     rank 11: 506.75
     rank 12: 495.95
     rank 13: 492.71
     rank 14: 492.21
     rank 15: 493.47
  pure-backward-compute:
     rank  0: 458.31
     rank  1: 446.51
     rank  2: 449.44
     rank  3: 454.65
     rank  4: 468.99
     rank  5: 473.55
     rank  6: 471.76
     rank  7: 471.03
     rank  8: 468.19
     rank  9: 509.75
     rank 10: 505.21
     rank 11: 506.42
     rank 12: 495.13
     rank 13: 492.11
     rank 14: 491.47
     rank 15: 492.81
  batch-generator:
     rank  0: 14.53
     rank  1: 11.10
     rank  2: 15.02
     rank  3: 10.92
     rank  4: 11.66
     rank  5: 10.95
     rank  6: 10.97
     rank  7: 11.97
     rank  8: 17.31
     rank  9: 13.12
     rank 10: 13.64
     rank 11: 13.35
     rank 12: 14.52
     rank 13: 13.35
     rank 14: 13.92
     rank 15: 13.99
  forward-recv:
     rank  4: 135.03
     rank  5: 100.30
     rank  6: 114.37
     rank  7: 102.08
     rank  8: 276.42
     rank  9: 241.35
     rank 10: 255.62
     rank 11: 241.94
     rank 12: 376.22
     rank 13: 350.31
     rank 14: 363.49
     rank 15: 350.60
  forward-send:
     rank  0: 39.66
     rank  1: 68.37
     rank  2: 42.27
     rank  3: 66.12
     rank  4: 3.79
     rank  5: 5.63
     rank  6: 3.48
     rank  7: 5.08
     rank  8: 2.69
     rank  9: 2.95
     rank 10: 1.90
     rank 11: 2.89
  backward-recv:
     rank  0: 423.92
     rank  1: 430.56
     rank  2: 422.29
     rank  3: 423.95
     rank  4: 279.30
     rank  5: 266.31
     rank  6: 265.34
     rank  7: 267.84
     rank  8: 144.28
     rank  9: 119.98
     rank 10: 120.54
     rank 11: 121.70
  backward-send:
     rank  4: 4.46
     rank  5: 4.76
     rank  6: 5.65
     rank  7: 5.67
     rank  8: 3.41
     rank  9: 4.55
     rank 10: 3.23
     rank 11: 4.28
     rank 12: 4.26
     rank 13: 4.20
     rank 14: 2.49
     rank 15: 4.35
  forward-send-backward-recv:
     rank  0: 365.21
     rank  1: 413.59
     rank  2: 390.47
     rank  3: 415.79
     rank  4: 233.64
     rank  5: 275.52
     rank  6: 263.56
     rank  7: 275.41
     rank  8: 164.75
     rank  9: 155.98
     rank 10: 146.88
     rank 11: 163.69
  backward-send-forward-recv:
     rank  4: 1.94
     rank  5: 4.22
     rank  6: 4.23
     rank  7: 3.96
     rank  8: 4.85
     rank  9: 8.09
     rank 10: 9.31
     rank 11: 9.36
     rank 12: 15.39
     rank 13: 34.58
     rank 14: 33.68
     rank 15: 32.45
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.04
     rank 14: 0.02
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.07
     rank  1: 0.05
     rank  2: 0.06
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.06
     rank 13: 0.08
     rank 14: 0.06
     rank 15: 0.06
  all-grads-sync:
     rank  0: 296.03
     rank  1: 296.01
     rank  2: 296.02
     rank  3: 296.10
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.22
     rank  1: 0.18
     rank  2: 0.21
     rank  3: 0.18
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 38.10
     rank  1: 37.73
     rank  2: 37.76
     rank  3: 37.73
     rank  4: 0.03
     rank  5: 0.07
     rank  6: 0.07
     rank  7: 0.04
     rank  8: 0.09
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.04
  optimizer:
     rank  0: 38.90
     rank  1: 38.52
     rank  2: 38.54
     rank  3: 38.52
     rank  4: 0.81
     rank  5: 0.85
     rank  6: 0.85
     rank  7: 0.82
     rank  8: 0.88
     rank  9: 0.82
     rank 10: 0.82
     rank 11: 0.82
     rank 12: 0.83
     rank 13: 0.83
     rank 14: 0.82
     rank 15: 0.83
 [2024-12-24 22:08:50] iteration        9/      10 | consumed samples:          144 | elapsed time per iteration (ms): 2113.7 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 3.997449E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2048.25
     rank  1: 2048.25
     rank  2: 2048.34
     rank  3: 2048.24
     rank  4: 2044.73
     rank  5: 2044.70
     rank  6: 2044.71
     rank  7: 2044.71
     rank  8: 2044.88
     rank  9: 2044.90
     rank 10: 2044.98
     rank 11: 2044.88
     rank 12: 2044.74
     rank 13: 2044.73
     rank 14: 2044.77
     rank 15: 2044.74
  forward-compute:
     rank  0: 422.61
     rank  1: 404.46
     rank  2: 444.86
     rank  3: 401.21
     rank  4: 510.28
     rank  5: 520.47
     rank  6: 514.34
     rank  7: 515.07
     rank  8: 453.00
     rank  9: 484.86
     rank 10: 485.03
     rank 11: 485.74
     rank 12: 507.22
     rank 13: 498.06
     rank 14: 491.47
     rank 15: 505.78
  backward-compute:
     rank  0: 457.86
     rank  1: 446.74
     rank  2: 453.32
     rank  3: 454.89
     rank  4: 468.20
     rank  5: 474.87
     rank  6: 472.60
     rank  7: 468.29
     rank  8: 469.68
     rank  9: 507.10
     rank 10: 506.79
     rank 11: 504.72
     rank 12: 497.05
     rank 13: 492.35
     rank 14: 491.12
     rank 15: 493.51
  pure-backward-compute:
     rank  0: 457.70
     rank  1: 446.58
     rank  2: 452.91
     rank  3: 454.74
     rank  4: 467.94
     rank  5: 474.61
     rank  6: 472.32
     rank  7: 468.03
     rank  8: 469.30
     rank  9: 506.75
     rank 10: 506.16
     rank 11: 504.39
     rank 12: 496.36
     rank 13: 491.72
     rank 14: 490.52
     rank 15: 492.82
  batch-generator:
     rank  0: 12.41
     rank  1: 11.34
     rank  2: 13.97
     rank  3: 11.15
     rank  4: 10.50
     rank  5: 11.96
     rank  6: 11.48
     rank  7: 11.57
     rank  8: 13.94
     rank  9: 13.67
     rank 10: 15.33
     rank 11: 14.72
     rank 12: 13.88
     rank 13: 13.79
     rank 14: 12.95
     rank 15: 13.91
  forward-recv:
     rank  4: 117.29
     rank  5: 103.76
     rank  6: 113.61
     rank  7: 103.25
     rank  8: 259.63
     rank  9: 245.32
     rank 10: 253.51
     rank 11: 242.50
     rank 12: 357.80
     rank 13: 355.82
     rank 14: 361.35
     rank 15: 350.80
  forward-send:
     rank  0: 56.27
     rank  1: 66.85
     rank  2: 41.71
     rank  3: 66.58
     rank  4: 3.98
     rank  5: 4.89
     rank  6: 3.53
     rank  7: 3.41
     rank  8: 3.21
     rank  9: 2.82
     rank 10: 1.63
     rank 11: 1.69
  backward-recv:
     rank  0: 423.70
     rank  1: 432.58
     rank  2: 418.70
     rank  3: 428.04
     rank  4: 276.31
     rank  5: 265.04
     rank  6: 264.70
     rank  7: 271.12
     rank  8: 141.02
     rank  9: 119.96
     rank 10: 119.62
     rank 11: 123.24
  backward-send:
     rank  4: 4.48
     rank  5: 5.06
     rank  6: 4.36
     rank  7: 4.64
     rank  8: 3.54
     rank  9: 4.50
     rank 10: 3.53
     rank 11: 4.42
     rank 12: 4.25
     rank 13: 4.30
     rank 14: 2.70
     rank 15: 4.37
  forward-send-backward-recv:
     rank  0: 374.03
     rank  1: 390.85
     rank  2: 377.74
     rank  3: 391.81
     rank  4: 238.14
     rank  5: 254.89
     rank  6: 251.68
     rank  7: 261.79
     rank  8: 167.99
     rank  9: 138.95
     rank 10: 131.16
     rank 11: 142.46
  backward-send-forward-recv:
     rank  4: 1.95
     rank  5: 2.12
     rank  6: 2.07
     rank  7: 2.02
     rank  8: 4.95
     rank  9: 7.39
     rank 10: 7.34
     rank 11: 6.11
     rank 12: 17.56
     rank 13: 32.56
     rank 14: 34.16
     rank 15: 28.91
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.05
     rank  2: 0.06
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.06
     rank 13: 0.06
     rank 14: 0.06
     rank 15: 0.06
  all-grads-sync:
     rank  0: 298.30
     rank  1: 298.15
     rank  2: 298.24
     rank  3: 298.38
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.04
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.19
     rank  1: 0.18
     rank  2: 0.21
     rank  3: 0.18
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 37.67
     rank  1: 37.68
     rank  2: 38.26
     rank  3: 37.58
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.04
     rank  7: 0.03
     rank  8: 0.04
     rank  9: 0.09
     rank 10: 0.11
     rank 11: 0.04
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.04
  optimizer:
     rank  0: 38.51
     rank  1: 38.52
     rank  2: 39.09
     rank  3: 38.41
     rank  4: 0.87
     rank  5: 0.87
     rank  6: 0.87
     rank  7: 0.87
     rank  8: 0.87
     rank  9: 0.92
     rank 10: 0.95
     rank 11: 0.87
     rank 12: 0.88
     rank 13: 0.88
     rank 14: 0.87
     rank 15: 0.87
 [2024-12-24 22:08:52] iteration       10/      10 | consumed samples:          160 | elapsed time per iteration (ms): 2120.1 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 4.261037E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2054.74
     rank  1: 2054.75
     rank  2: 2054.81
     rank  3: 2054.74
     rank  4: 2051.19
     rank  5: 2051.12
     rank  6: 2051.16
     rank  7: 2051.13
     rank  8: 2051.20
     rank  9: 2051.18
     rank 10: 2051.22
     rank 11: 2051.24
     rank 12: 2051.24
     rank 13: 2051.23
     rank 14: 2051.30
     rank 15: 2051.23
  forward-compute:
     rank  0: 403.75
     rank  1: 401.92
     rank  2: 446.64
     rank  3: 402.05
     rank  4: 516.74
     rank  5: 519.42
     rank  6: 515.94
     rank  7: 515.52
     rank  8: 451.77
     rank  9: 488.90
     rank 10: 485.56
     rank 11: 485.67
     rank 12: 519.31
     rank 13: 501.28
     rank 14: 497.45
     rank 15: 498.61
  backward-compute:
     rank  0: 458.53
     rank  1: 445.36
     rank  2: 453.15
     rank  3: 455.36
     rank  4: 472.15
     rank  5: 472.62
     rank  6: 473.29
     rank  7: 468.59
     rank  8: 469.33
     rank  9: 508.81
     rank 10: 505.91
     rank 11: 508.58
     rank 12: 496.23
     rank 13: 493.65
     rank 14: 494.22
     rank 15: 495.87
  pure-backward-compute:
     rank  0: 458.38
     rank  1: 445.20
     rank  2: 452.74
     rank  3: 455.14
     rank  4: 471.74
     rank  5: 472.35
     rank  6: 473.04
     rank  7: 468.36
     rank  8: 469.00
     rank  9: 508.52
     rank 10: 505.58
     rank 11: 508.23
     rank 12: 495.49
     rank 13: 493.04
     rank 14: 493.55
     rank 15: 495.22
  batch-generator:
     rank  0: 11.33
     rank  1: 12.06
     rank  2: 13.78
     rank  3: 11.28
     rank  4: 14.34
     rank  5: 11.83
     rank  6: 10.56
     rank  7: 11.26
     rank  8: 13.30
     rank  9: 14.13
     rank 10: 14.14
     rank 11: 14.30
     rank 12: 14.54
     rank 13: 14.49
     rank 14: 15.67
     rank 15: 13.05
  forward-recv:
     rank  4: 106.38
     rank  5: 104.27
     rank  6: 113.57
     rank  7: 105.13
     rank  8: 254.29
     rank  9: 243.48
     rank 10: 249.60
     rank 11: 247.00
     rank 12: 349.38
     rank 13: 355.89
     rank 14: 362.32
     rank 15: 356.15
  forward-send:
     rank  0: 68.14
     rank  1: 68.63
     rank  2: 40.19
     rank  3: 69.94
     rank  4: 6.34
     rank  5: 5.41
     rank  6: 3.29
     rank  7: 6.66
     rank  8: 2.73
     rank  9: 2.82
     rank 10: 1.63
     rank 11: 2.90
  backward-recv:
     rank  0: 427.43
     rank  1: 438.02
     rank  2: 422.45
     rank  3: 427.07
     rank  4: 274.11
     rank  5: 266.95
     rank  6: 266.98
     rank  7: 270.26
     rank  8: 142.88
     rank  9: 119.79
     rank 10: 126.65
     rank 11: 120.84
  backward-send:
     rank  4: 4.65
     rank  5: 6.49
     rank  6: 4.93
     rank  7: 6.78
     rank  8: 3.48
     rank  9: 4.78
     rank 10: 3.23
     rank 11: 4.62
     rank 12: 4.50
     rank 13: 4.49
     rank 14: 3.58
     rank 15: 4.51
  forward-send-backward-recv:
     rank  0: 381.12
     rank  1: 391.41
     rank  2: 378.14
     rank  3: 391.98
     rank  4: 240.65
     rank  5: 256.86
     rank  6: 250.05
     rank  7: 258.65
     rank  8: 175.99
     rank  9: 138.15
     rank 10: 132.77
     rank 11: 137.12
  backward-send-forward-recv:
     rank  4: 2.11
     rank  5: 2.49
     rank  6: 2.65
     rank  7: 2.94
     rank  8: 4.87
     rank  9: 6.97
     rank 10: 6.62
     rank 11: 7.94
     rank 12: 17.09
     rank 13: 30.28
     rank 14: 26.87
     rank 15: 31.19
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.06
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.06
     rank 13: 0.06
     rank 14: 0.08
     rank 15: 0.06
  all-grads-sync:
     rank  0: 300.12
     rank  1: 300.05
     rank  2: 300.06
     rank  3: 300.14
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.18
     rank  1: 0.18
     rank  2: 0.22
     rank  3: 0.19
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.03
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 37.68
     rank  1: 37.72
     rank  2: 38.14
     rank  3: 37.68
     rank  4: 0.05
     rank  5: 0.04
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.05
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.05
     rank 15: 0.04
  optimizer:
     rank  0: 38.52
     rank  1: 38.55
     rank  2: 38.92
     rank  3: 38.51
     rank  4: 0.88
     rank  5: 0.86
     rank  6: 0.84
     rank  7: 0.85
     rank  8: 0.87
     rank  9: 0.87
     rank 10: 0.87
     rank 11: 0.87
     rank 12: 0.87
     rank 13: 0.87
     rank 14: 0.88
     rank 15: 0.87
