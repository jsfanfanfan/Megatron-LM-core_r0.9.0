examples/multimodal/pretrain-freeze-llm-hete-2080first.sh: line 4: activate: No such file or directory
3
[2024-12-25 13:54:26,274] torch.distributed.run: [WARNING] 
[2024-12-25 13:54:26,274] torch.distributed.run: [WARNING] *****************************************
[2024-12-25 13:54:26,274] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-12-25 13:54:26,274] torch.distributed.run: [WARNING] *****************************************
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
> setting tensorboard ...
WARNING: one_logger package is required to enable e2e metrics tracking. please go to https://confluence.nvidia.com/display/MLWFO/Package+Repositories for details to install it
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
---Rank 15---Tensor Parallel Group GPUs: [0]---Rank 12---Tensor Parallel Group GPUs: [0]
---Rank 14---Tensor Parallel Group GPUs: [0]---Rank 13---Tensor Parallel Group GPUs: [0]


---Rank 15---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
---Rank 12---Pipeline Parallel Group GPUs: [3, 3, 3, 3]---Rank 14---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
---Rank 13---Pipeline Parallel Group GPUs: [3, 3, 3, 3]

[rank15]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank13]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank12]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank14]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
 > number of parameters on (tensor, pipeline) model parallel rank (0, 3): 1442893824
rank=0, worker=0: shard_range=[pretrain-0.tar[0, 100), pretrain-0.tar[100, 200), pretrain-0.tar[200, 300), ...<619>, pretrain-14.tar[2200, 2300), pretrain-14.tar[2300, 2400), pretrain-14.tar[2400, 2500)] sum(count)=62500
rank=0, worker=1: shard_range=[pretrain-14.tar[2500, 2600), pretrain-14.tar[2600, 2700), pretrain-14.tar[2700, 2800), ...<619>, pretrain-2.tar[4700, 4800), pretrain-2.tar[4800, 4900), pretrain-2.tar[4900, 5000)] sum(count)=62500
rank=2, worker=0: shard_range=[pretrain-31.tar[0, 100), pretrain-31.tar[100, 200), pretrain-31.tar[200, 300), ...<619>, pretrain-37.tar[2200, 2300), pretrain-37.tar[2300, 2400), pretrain-37.tar[2400, 2500)] sum(count)=62500
rank=2, worker=1: shard_range=[pretrain-37.tar[2500, 2600), pretrain-37.tar[2600, 2700), pretrain-37.tar[2700, 2800), ...<619>, pretrain-42.tar[4700, 4800), pretrain-42.tar[4800, 4900), pretrain-42.tar[4900, 5000)] sum(count)=62500
rank=1, worker=0: shard_range=[pretrain-2.tar[5000, 5100), pretrain-2.tar[5100, 5200), pretrain-2.tar[5200, 5300), ...<619>, pretrain-25.tar[7200, 7300), pretrain-25.tar[7300, 7400), pretrain-25.tar[7400, 7500)] sum(count)=62500
rank=1, worker=1: shard_range=[pretrain-25.tar[7500, 7600), pretrain-25.tar[7600, 7700), pretrain-25.tar[7700, 7800), ...<619>, pretrain-30.tar[9700, 9800), pretrain-30.tar[9800, 9900), pretrain-30.tar[9900, 10000)] sum(count)=62500
rank=3, worker=0: shard_range=[pretrain-42.tar[5000, 5100), pretrain-42.tar[5100, 5200), pretrain-42.tar[5200, 5300), ...<619>, pretrain-48.tar[7200, 7300), pretrain-48.tar[7300, 7400), pretrain-48.tar[7400, 7500)] sum(count)=62500
rank=3, worker=1: shard_range=[pretrain-48.tar[7500, 7600), pretrain-48.tar[7600, 7700), pretrain-48.tar[7700, 7800), ...<619>, pretrain-53.tar[9700, 9800), pretrain-53.tar[9800, 9900), pretrain-53.tar[9900, 10000)] sum(count)=62500
rank=0, worker=0: shard_range=[pretrain-54.tar[0, 7266)] sum(count)=7266
rank=0, worker=1: shard_range=[pretrain-54.tar[7266, 10000), pretrain-55.tar[0, 4532)] sum(count)=7266
rank=2, worker=0: shard_range=[pretrain-7.tar[936, 8202)] sum(count)=7266
rank=2, worker=1: shard_range=[pretrain-7.tar[8202, 10000), pretrain-8.tar[0, 5468)] sum(count)=7266
rank=1, worker=0: shard_range=[pretrain-55.tar[4532, 8128), pretrain-6.tar[0, 3670)] sum(count)=7266
rank=1, worker=1: shard_range=[pretrain-6.tar[3670, 10000), pretrain-7.tar[0, 936)] sum(count)=7266
rank=3, worker=0: shard_range=[pretrain-8.tar[5468, 10000), pretrain-9.tar[0, 2734)] sum(count)=7266
rank=3, worker=1: shard_range=[pretrain-9.tar[2734, 10000)] sum(count)=7266
times across ranks (ms):
  model-and-optimizer-setup:
     rank  0: 66.02
     rank  1: 62.33
     rank  2: 59.91
     rank  3: 62.31
     rank  4: 103.33
     rank  5: 100.76
     rank  6: 84.72
     rank  7: 75.06
     rank  8: 51.17
     rank  9: 44.92
     rank 10: 42.22
     rank 11: 45.04
     rank 12: 34.58
     rank 13: 42.57
     rank 14: 38.60
     rank 15: 42.58
  train/valid/test-data-iterators-setup:
     rank  0: 1076.43
     rank  1: 1076.34
     rank  2: 1315.98
     rank  3: 1076.34
     rank  4: 1079.12
     rank  5: 1132.43
     rank  6: 1132.74
     rank  7: 1132.33
     rank  8: 1276.46
     rank  9: 1315.32
     rank 10: 1208.75
     rank 11: 1315.49
     rank 12: 1315.47
     rank 13: 1315.47
     rank 14: 1315.47
     rank 15: 1315.51
 [2024-12-25 13:54:57] iteration        1/      10 | consumed samples:           16 | elapsed time per iteration (ms): 12149.4 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 7.177823E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
stage4 GPU utialization:71.24912955544211 %
[Rank 12] (after 1 iterations) memory (MB) | allocated: 5557.4560546875 | max allocated: 8025.501953125 | reserved: 8216.0 | max reserved: 8216.0
times across ranks (ms):
  forward-backward:
     rank  0: 11989.34
     rank  1: 11989.41
     rank  2: 11989.40
     rank  3: 11989.26
     rank  4: 11985.38
     rank  5: 11985.37
     rank  6: 11985.47
     rank  7: 11985.36
     rank  8: 12101.39
     rank  9: 12101.10
     rank 10: 12101.35
     rank 11: 12101.20
     rank 12: 11983.08
     rank 13: 11983.05
     rank 14: 11983.15
     rank 15: 11983.05
  forward-compute:
     rank  0: 2136.28
     rank  1: 2172.35
     rank  2: 2154.09
     rank  3: 2150.82
     rank  4: 3706.29
     rank  5: 3391.94
     rank  6: 3730.26
     rank  7: 3491.52
     rank  8: 1541.17
     rank  9: 1577.63
     rank 10: 1486.17
     rank 11: 1721.15
     rank 12: 2980.20
     rank 13: 3043.12
     rank 14: 2829.23
     rank 15: 2832.57
  backward-compute:
     rank  0: 977.74
     rank  1: 976.97
     rank  2: 976.62
     rank  3: 980.42
     rank  4: 1054.86
     rank  5: 1229.06
     rank  6: 1232.57
     rank  7: 1241.82
     rank  8: 191.65
     rank  9: 188.47
     rank 10: 203.56
     rank 11: 191.22
     rank 12: 524.52
     rank 13: 528.43
     rank 14: 513.78
     rank 15: 516.81
  pure-backward-compute:
     rank  0: 977.36
     rank  1: 976.42
     rank  2: 976.24
     rank  3: 980.06
     rank  4: 1054.42
     rank  5: 1228.61
     rank  6: 1232.20
     rank  7: 1241.43
     rank  8: 190.97
     rank  9: 187.64
     rank 10: 202.98
     rank 11: 190.47
     rank 12: 523.70
     rank 13: 527.54
     rank 14: 512.97
     rank 15: 515.98
  batch-generator:
     rank  0: 993.91
     rank  1: 1054.68
     rank  2: 1023.46
     rank  3: 1025.15
     rank  4: 1071.08
     rank  5: 1045.19
     rank  6: 1086.11
     rank  7: 940.74
     rank  8: 1282.24
     rank  9: 1297.25
     rank 10: 1228.63
     rank 11: 1444.81
     rank 12: 904.43
     rank 13: 1015.71
     rank 14: 1070.53
     rank 15: 807.07
  forward-recv:
     rank  4: 2175.77
     rank  5: 2196.89
     rank  6: 2189.91
     rank  7: 2173.93
     rank  8: 5518.69
     rank  9: 5245.36
     rank 10: 5557.89
     rank 11: 5326.87
     rank 12: 6934.34
     rank 13: 6704.10
     rank 14: 6924.06
     rank 15: 6924.78
  forward-send:
     rank  0: 4844.10
     rank  1: 4574.88
     rank  2: 4814.53
     rank  3: 4819.52
     rank  4: 1301.91
     rank  5: 1345.19
     rank  6: 1253.82
     rank  7: 1495.50
     rank  8: 23.22
     rank  9: 28.80
     rank 10: 23.90
     rank 11: 25.67
  backward-recv:
     rank  0: 166.09
     rank  1: 160.44
     rank  2: 167.07
     rank  3: 160.08
     rank  4: 3.34
     rank  5: 5.84
     rank  6: 5.67
     rank  7: 3.60
     rank  8: 1.85
     rank  9: 2.73
     rank 10: 2.83
     rank 11: 1.72
  backward-send:
     rank  4: 588.42
     rank  5: 591.59
     rank  6: 582.88
     rank  7: 587.38
     rank  8: 725.98
     rank  9: 718.58
     rank 10: 713.21
     rank 11: 718.10
     rank 12: 270.68
     rank 13: 434.20
     rank 14: 433.11
     rank 15: 435.29
  forward-send-backward-recv:
     rank  0: 3341.65
     rank  1: 3749.42
     rank  2: 3520.75
     rank  3: 3525.37
     rank  4: 2572.70
     rank  5: 2815.36
     rank  6: 2582.31
     rank  7: 2585.25
     rank  8: 2694.62
     rank  9: 2926.51
     rank 10: 2704.92
     rank 11: 2699.07
  backward-send-forward-recv:
     rank  4: 18.84
     rank  5: 13.72
     rank  6: 12.42
     rank  7: 13.65
     rank  8: 597.14
     rank  9: 774.41
     rank 10: 769.77
     rank 11: 780.46
     rank 12: 455.93
     rank 13: 625.16
     rank 14: 633.90
     rank 15: 626.80
  layernorm-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.04
     rank  7: 0.02
     rank  8: 0.04
     rank  9: 0.05
     rank 10: 0.04
     rank 11: 0.03
     rank 12: 0.05
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.05
  embedding-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.09
     rank  5: 0.09
     rank  6: 0.10
     rank  7: 0.07
     rank  8: 0.03
     rank  9: 0.04
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.09
     rank 13: 0.09
     rank 14: 0.08
     rank 15: 0.09
  all-grads-sync:
     rank  0: 342.03
     rank  1: 341.93
     rank  2: 341.98
     rank  3: 341.95
     rank  4: 320.88
     rank  5: 320.84
     rank  6: 321.39
     rank  7: 320.89
     rank  8: 0.03
     rank  9: 0.04
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.15
     rank  1: 0.14
     rank  2: 0.15
     rank  3: 0.15
     rank  4: 0.16
     rank  5: 0.15
     rank  6: 0.30
     rank  7: 0.13
     rank  8: 0.06
     rank  9: 0.03
     rank 10: 0.05
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.04
     rank  9: 0.02
     rank 10: 0.04
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
  optimizer-inner-step:
     rank  0: 43.35
     rank  1: 43.71
     rank  2: 43.37
     rank  3: 42.75
     rank  4: 28.57
     rank  5: 28.44
     rank  6: 28.69
     rank  7: 27.41
     rank  8: 0.26
     rank  9: 0.17
     rank 10: 0.27
     rank 11: 0.15
     rank 12: 0.15
     rank 13: 0.11
     rank 14: 0.14
     rank 15: 0.10
  optimizer:
     rank  0: 45.49
     rank  1: 45.85
     rank  2: 45.51
     rank  3: 44.89
     rank  4: 29.78
     rank  5: 30.61
     rank  6: 30.80
     rank  7: 29.55
     rank  8: 2.40
     rank  9: 2.31
     rank 10: 2.41
     rank 11: 2.29
     rank 12: 2.23
     rank 13: 2.22
     rank 14: 2.26
     rank 15: 2.22
 [2024-12-25 13:54:58] iteration        2/      10 | consumed samples:           32 | elapsed time per iteration (ms): 1674.1 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 6.846738E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 1614.39
     rank  1: 1614.43
     rank  2: 1614.39
     rank  3: 1614.38
     rank  4: 1614.39
     rank  5: 1615.38
     rank  6: 1614.49
     rank  7: 1614.41
     rank  8: 1612.63
     rank  9: 1612.81
     rank 10: 1612.60
     rank 11: 1612.72
     rank 12: 1611.98
     rank 13: 1612.01
     rank 14: 1611.99
     rank 15: 1612.03
  forward-compute:
     rank  0: 166.07
     rank  1: 169.52
     rank  2: 154.48
     rank  3: 154.96
     rank  4: 478.69
     rank  5: 469.49
     rank  6: 480.03
     rank  7: 485.37
     rank  8: 158.83
     rank  9: 160.63
     rank 10: 158.24
     rank 11: 159.03
     rank 12: 443.32
     rank 13: 446.11
     rank 14: 455.92
     rank 15: 456.32
  backward-compute:
     rank  0: 178.37
     rank  1: 177.63
     rank  2: 177.35
     rank  3: 172.32
     rank  4: 510.91
     rank  5: 508.52
     rank  6: 508.25
     rank  7: 511.11
     rank  8: 161.93
     rank  9: 164.64
     rank 10: 163.02
     rank 11: 161.97
     rank 12: 519.96
     rank 13: 524.80
     rank 14: 519.65
     rank 15: 519.89
  pure-backward-compute:
     rank  0: 178.20
     rank  1: 177.43
     rank  2: 177.16
     rank  3: 172.15
     rank  4: 510.59
     rank  5: 508.20
     rank  6: 507.79
     rank  7: 510.80
     rank  8: 161.57
     rank  9: 163.82
     rank 10: 162.69
     rank 11: 161.48
     rank 12: 519.24
     rank 13: 524.19
     rank 14: 518.94
     rank 15: 517.48
  batch-generator:
     rank  0: 15.54
     rank  1: 17.23
     rank  2: 15.27
     rank  3: 15.69
     rank  4: 14.17
     rank  5: 13.36
     rank  6: 16.48
     rank  7: 19.00
     rank  8: 15.61
     rank  9: 15.10
     rank 10: 14.57
     rank 11: 14.63
     rank 12: 13.22
     rank 13: 11.51
     rank 14: 13.57
     rank 15: 14.39
  forward-recv:
     rank  4: 46.16
     rank  5: 40.91
     rank  6: 37.62
     rank  7: 36.81
     rank  8: 248.76
     rank  9: 238.62
     rank 10: 240.81
     rank 11: 248.15
     rank 12: 208.66
     rank 13: 201.46
     rank 14: 200.48
     rank 15: 198.98
  forward-send:
     rank  0: 166.36
     rank  1: 158.15
     rank  2: 170.34
     rank  3: 175.50
     rank  4: 3.80
     rank  5: 5.44
     rank  6: 5.82
     rank  7: 5.87
     rank  8: 1.89
     rank  9: 2.00
     rank 10: 2.09
     rank 11: 1.71
  backward-recv:
     rank  0: 597.04
     rank  1: 603.32
     rank  2: 608.47
     rank  3: 615.53
     rank  4: 224.13
     rank  5: 232.32
     rank  6: 234.25
     rank  7: 232.49
     rank  8: 202.92
     rank  9: 201.25
     rank 10: 202.13
     rank 11: 203.58
  backward-send:
     rank  4: 1.30
     rank  5: 1.24
     rank  6: 1.74
     rank  7: 1.22
     rank  8: 3.41
     rank  9: 5.21
     rank 10: 5.40
     rank 11: 5.38
     rank 12: 2.14
     rank 13: 4.01
     rank 14: 3.81
     rank 15: 3.75
  forward-send-backward-recv:
     rank  0: 294.83
     rank  1: 298.82
     rank  2: 295.35
     rank  3: 288.12
     rank  4: 90.03
     rank  5: 102.53
     rank  6: 92.01
     rank  7: 88.19
     rank  8: 439.75
     rank  9: 453.25
     rank 10: 454.26
     rank 11: 448.44
  backward-send-forward-recv:
     rank  4: 2.07
     rank  5: 1.33
     rank  6: 1.04
     rank  7: 1.03
     rank  8: 13.40
     rank  9: 10.88
     rank 10: 9.30
     rank 11: 7.21
     rank 12: 13.50
     rank 13: 15.02
     rank 14: 10.69
     rank 15: 12.83
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.09
     rank  9: 0.05
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.07
     rank  5: 0.07
     rank  6: 0.07
     rank  7: 0.07
     rank  8: 0.03
     rank  9: 0.05
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.06
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.06
  all-grads-sync:
     rank  0: 201.57
     rank  1: 201.53
     rank  2: 201.53
     rank  3: 201.58
     rank  4: 192.61
     rank  5: 192.56
     rank  6: 192.60
     rank  7: 192.63
     rank  8: 0.02
     rank  9: 0.05
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.10
     rank  1: 0.10
     rank  2: 0.10
     rank  3: 0.10
     rank  4: 0.14
     rank  5: 0.27
     rank  6: 0.14
     rank  7: 0.13
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.06
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 24.64
     rank  1: 24.66
     rank  2: 24.73
     rank  3: 24.67
     rank  4: 25.06
     rank  5: 25.06
     rank  6: 25.04
     rank  7: 25.02
     rank  8: 0.18
     rank  9: 0.12
     rank 10: 0.05
     rank 11: 0.45
     rank 12: 0.06
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.04
  optimizer:
     rank  0: 25.64
     rank  1: 25.67
     rank  2: 25.74
     rank  3: 25.67
     rank  4: 26.06
     rank  5: 26.03
     rank  6: 26.04
     rank  7: 26.03
     rank  8: 1.17
     rank  9: 1.12
     rank 10: 1.03
     rank 11: 1.43
     rank 12: 1.05
     rank 13: 1.02
     rank 14: 1.02
     rank 15: 1.04
 [2024-12-25 13:55:00] iteration        3/      10 | consumed samples:           48 | elapsed time per iteration (ms): 1662.5 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 6.921486E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 1605.52
     rank  1: 1605.56
     rank  2: 1605.55
     rank  3: 1605.52
     rank  4: 1605.57
     rank  5: 1605.50
     rank  6: 1605.63
     rank  7: 1605.50
     rank  8: 1603.29
     rank  9: 1603.28
     rank 10: 1603.30
     rank 11: 1603.39
     rank 12: 1603.15
     rank 13: 1603.12
     rank 14: 1603.16
     rank 15: 1603.17
  forward-compute:
     rank  0: 144.73
     rank  1: 158.19
     rank  2: 145.89
     rank  3: 143.69
     rank  4: 482.18
     rank  5: 435.78
     rank  6: 481.17
     rank  7: 454.65
     rank  8: 154.11
     rank  9: 163.82
     rank 10: 158.23
     rank 11: 160.05
     rank 12: 446.93
     rank 13: 453.55
     rank 14: 445.79
     rank 15: 449.21
  backward-compute:
     rank  0: 177.04
     rank  1: 175.14
     rank  2: 175.56
     rank  3: 172.31
     rank  4: 511.38
     rank  5: 507.55
     rank  6: 509.05
     rank  7: 510.77
     rank  8: 162.29
     rank  9: 163.59
     rank 10: 163.72
     rank 11: 161.22
     rank 12: 520.47
     rank 13: 524.16
     rank 14: 520.30
     rank 15: 523.01
  pure-backward-compute:
     rank  0: 176.85
     rank  1: 174.95
     rank  2: 175.40
     rank  3: 172.12
     rank  4: 511.07
     rank  5: 507.36
     rank  6: 508.25
     rank  7: 510.44
     rank  8: 161.78
     rank  9: 163.27
     rank 10: 163.40
     rank 11: 160.88
     rank 12: 519.83
     rank 13: 523.53
     rank 14: 519.32
     rank 15: 522.31
  batch-generator:
     rank  0: 15.64
     rank  1: 16.28
     rank  2: 14.77
     rank  3: 14.44
     rank  4: 14.54
     rank  5: 10.45
     rank  6: 13.90
     rank  7: 11.95
     rank  8: 13.17
     rank  9: 16.13
     rank 10: 13.29
     rank 11: 13.70
     rank 12: 13.25
     rank 13: 11.61
     rank 14: 13.90
     rank 15: 13.04
  forward-recv:
     rank  4: 36.48
     rank  5: 39.94
     rank  6: 37.03
     rank  7: 36.29
     rank  8: 245.75
     rank  9: 219.06
     rank 10: 241.59
     rank 11: 235.28
     rank 12: 200.26
     rank 13: 191.65
     rank 14: 200.68
     rank 15: 195.41
  forward-send:
     rank  0: 178.09
     rank  1: 143.65
     rank  2: 173.49
     rank  3: 168.68
     rank  4: 5.53
     rank  5: 3.62
     rank  6: 5.36
     rank  7: 3.40
     rank  8: 2.42
     rank  9: 1.88
     rank 10: 2.53
     rank 11: 1.62
  backward-recv:
     rank  0: 602.93
     rank  1: 607.50
     rank  2: 600.29
     rank  3: 608.25
     rank  4: 229.79
     rank  5: 237.18
     rank  6: 221.40
     rank  7: 233.85
     rank  8: 202.20
     rank  9: 201.81
     rank 10: 202.14
     rank 11: 201.16
  backward-send:
     rank  4: 1.32
     rank  5: 1.01
     rank  6: 2.13
     rank  7: 1.54
     rank  8: 6.83
     rank  9: 6.63
     rank 10: 3.59
     rank 11: 6.24
     rank 12: 3.92
     rank 13: 2.80
     rank 14: 2.22
     rank 15: 3.67
  forward-send-backward-recv:
     rank  0: 298.53
     rank  1: 317.20
     rank  2: 301.36
     rank  3: 306.93
     rank  4: 87.91
     rank  5: 130.94
     rank  6: 93.80
     rank  7: 114.32
     rank  8: 441.14
     rank  9: 465.28
     rank 10: 437.53
     rank 11: 455.24
  backward-send-forward-recv:
     rank  4: 0.89
     rank  5: 0.84
     rank  6: 1.01
     rank  7: 0.63
     rank  8: 15.02
     rank  9: 8.05
     rank 10: 16.77
     rank 11: 7.81
     rank 12: 13.39
     rank 13: 13.82
     rank 14: 13.31
     rank 15: 13.54
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.04
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.08
     rank  5: 0.05
     rank  6: 0.09
     rank  7: 0.05
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.05
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.06
  all-grads-sync:
     rank  0: 198.43
     rank  1: 198.38
     rank  2: 198.35
     rank  3: 198.39
     rank  4: 193.97
     rank  5: 193.92
     rank  6: 193.95
     rank  7: 194.00
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.10
     rank  1: 0.10
     rank  2: 0.09
     rank  3: 0.09
     rank  4: 0.13
     rank  5: 0.10
     rank  6: 0.14
     rank  7: 0.10
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 24.70
     rank  1: 24.74
     rank  2: 24.66
     rank  3: 24.66
     rank  4: 25.12
     rank  5: 24.88
     rank  6: 25.15
     rank  7: 24.85
     rank  8: 0.04
     rank  9: 0.05
     rank 10: 0.04
     rank 11: 0.05
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.06
     rank 15: 0.04
  optimizer:
     rank  0: 25.46
     rank  1: 25.50
     rank  2: 25.42
     rank  3: 25.44
     rank  4: 25.88
     rank  5: 25.65
     rank  6: 25.93
     rank  7: 25.61
     rank  8: 0.79
     rank  9: 0.80
     rank 10: 0.79
     rank 11: 0.80
     rank 12: 0.78
     rank 13: 0.78
     rank 14: 0.81
     rank 15: 0.79
 [2024-12-25 13:55:02] iteration        4/      10 | consumed samples:           64 | elapsed time per iteration (ms): 1656.2 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 7.069589E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 1599.41
     rank  1: 1599.44
     rank  2: 1599.41
     rank  3: 1599.42
     rank  4: 1599.45
     rank  5: 1599.39
     rank  6: 1599.43
     rank  7: 1599.39
     rank  8: 1597.83
     rank  9: 1597.61
     rank 10: 1597.59
     rank 11: 1597.57
     rank 12: 1597.07
     rank 13: 1597.06
     rank 14: 1597.07
     rank 15: 1597.13
  forward-compute:
     rank  0: 145.51
     rank  1: 158.27
     rank  2: 146.84
     rank  3: 147.40
     rank  4: 477.27
     rank  5: 438.23
     rank  6: 480.21
     rank  7: 438.61
     rank  8: 155.02
     rank  9: 160.61
     rank 10: 158.99
     rank 11: 163.76
     rank 12: 440.50
     rank 13: 451.09
     rank 14: 442.80
     rank 15: 465.88
  backward-compute:
     rank  0: 176.43
     rank  1: 173.91
     rank  2: 174.09
     rank  3: 172.33
     rank  4: 511.97
     rank  5: 507.98
     rank  6: 508.18
     rank  7: 512.44
     rank  8: 160.95
     rank  9: 164.07
     rank 10: 163.62
     rank 11: 162.52
     rank 12: 526.97
     rank 13: 524.57
     rank 14: 522.39
     rank 15: 516.10
  pure-backward-compute:
     rank  0: 176.26
     rank  1: 173.71
     rank  2: 173.90
     rank  3: 172.13
     rank  4: 511.61
     rank  5: 507.72
     rank  6: 507.72
     rank  7: 512.18
     rank  8: 160.65
     rank  9: 163.77
     rank 10: 163.36
     rank 11: 162.16
     rank 12: 526.26
     rank 13: 523.93
     rank 14: 521.80
     rank 15: 515.41
  batch-generator:
     rank  0: 15.04
     rank  1: 15.97
     rank  2: 16.20
     rank  3: 15.78
     rank  4: 14.25
     rank  5: 10.59
     rank  6: 15.29
     rank  7: 10.43
     rank  8: 13.41
     rank  9: 13.54
     rank 10: 13.24
     rank 11: 17.69
     rank 12: 13.23
     rank 13: 10.98
     rank 14: 12.37
     rank 15: 13.95
  forward-recv:
     rank  4: 36.83
     rank  5: 40.16
     rank  6: 36.23
     rank  7: 36.73
     rank  8: 239.97
     rank  9: 222.84
     rank 10: 240.59
     rank 11: 217.65
     rank 12: 196.44
     rank 13: 188.38
     rank 14: 197.45
     rank 15: 185.26
  forward-send:
     rank  0: 171.36
     rank  1: 143.96
     rank  2: 172.38
     rank  3: 149.19
     rank  4: 4.80
     rank  5: 3.74
     rank  6: 5.04
     rank  7: 3.29
     rank  8: 1.95
     rank  9: 1.84
     rank 10: 1.82
     rank 11: 1.62
  backward-recv:
     rank  0: 604.50
     rank  1: 610.20
     rank  2: 602.32
     rank  3: 615.10
     rank  4: 228.92
     rank  5: 238.16
     rank  6: 224.90
     rank  7: 238.07
     rank  8: 202.88
     rank  9: 203.16
     rank 10: 203.97
     rank 11: 208.46
  backward-send:
     rank  4: 1.46
     rank  5: 1.24
     rank  6: 1.76
     rank  7: 1.42
     rank  8: 6.05
     rank  9: 5.64
     rank 10: 3.15
     rank 11: 4.34
     rank 12: 4.48
     rank 13: 4.58
     rank 14: 2.74
     rank 15: 4.55
  forward-send-backward-recv:
     rank  0: 297.73
     rank  1: 309.45
     rank  2: 294.76
     rank  3: 310.80
     rank  4: 87.45
     rank  5: 120.88
     rank  6: 86.94
     rank  7: 119.61
     rank  8: 444.30
     rank  9: 460.48
     rank 10: 434.66
     rank 11: 459.46
  backward-send-forward-recv:
     rank  4: 1.12
     rank  5: 0.84
     rank  6: 1.02
     rank  7: 0.64
     rank  8: 12.71
     rank  9: 5.95
     rank 10: 13.49
     rank 11: 4.94
     rank 12: 11.10
     rank 13: 10.70
     rank 14: 10.94
     rank 15: 7.05
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.04
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.08
     rank  5: 0.05
     rank  6: 0.07
     rank  7: 0.05
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.06
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.07
  all-grads-sync:
     rank  0: 197.23
     rank  1: 197.19
     rank  2: 197.18
     rank  3: 197.20
     rank  4: 197.93
     rank  5: 197.89
     rank  6: 197.92
     rank  7: 197.96
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.09
     rank  1: 0.10
     rank  2: 0.09
     rank  3: 0.10
     rank  4: 0.14
     rank  5: 0.10
     rank  6: 0.14
     rank  7: 0.10
     rank  8: 0.04
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.04
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.03
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 24.60
     rank  1: 24.65
     rank  2: 24.63
     rank  3: 24.69
     rank  4: 25.08
     rank  5: 24.87
     rank  6: 25.05
     rank  7: 24.85
     rank  8: 0.09
     rank  9: 0.06
     rank 10: 0.04
     rank 11: 0.05
     rank 12: 0.07
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.04
  optimizer:
     rank  0: 25.80
     rank  1: 25.85
     rank  2: 25.83
     rank  3: 25.90
     rank  4: 26.27
     rank  5: 26.08
     rank  6: 26.26
     rank  7: 26.05
     rank  8: 1.33
     rank  9: 1.27
     rank 10: 1.24
     rank 11: 1.25
     rank 12: 1.26
     rank 13: 1.22
     rank 14: 1.22
     rank 15: 1.24
 [2024-12-25 13:55:03] iteration        5/      10 | consumed samples:           80 | elapsed time per iteration (ms): 1657.9 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 6.826408E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 1601.35
     rank  1: 1601.42
     rank  2: 1601.38
     rank  3: 1601.35
     rank  4: 1601.29
     rank  5: 1601.31
     rank  6: 1601.29
     rank  7: 1601.29
     rank  8: 1599.11
     rank  9: 1599.10
     rank 10: 1599.11
     rank 11: 1599.25
     rank 12: 1598.94
     rank 13: 1598.97
     rank 14: 1598.92
     rank 15: 1598.99
  forward-compute:
     rank  0: 151.68
     rank  1: 159.49
     rank  2: 151.92
     rank  3: 152.99
     rank  4: 469.52
     rank  5: 436.29
     rank  6: 475.98
     rank  7: 444.02
     rank  8: 156.77
     rank  9: 161.19
     rank 10: 160.29
     rank 11: 164.20
     rank 12: 447.01
     rank 13: 447.52
     rank 14: 440.76
     rank 15: 458.83
  backward-compute:
     rank  0: 175.99
     rank  1: 176.80
     rank  2: 174.69
     rank  3: 171.70
     rank  4: 513.99
     rank  5: 507.35
     rank  6: 508.48
     rank  7: 512.25
     rank  8: 161.39
     rank  9: 163.41
     rank 10: 164.56
     rank 11: 164.47
     rank 12: 519.47
     rank 13: 528.51
     rank 14: 528.35
     rank 15: 517.99
  pure-backward-compute:
     rank  0: 175.83
     rank  1: 176.62
     rank  2: 174.53
     rank  3: 171.54
     rank  4: 513.63
     rank  5: 507.15
     rank  6: 508.21
     rank  7: 512.06
     rank  8: 161.13
     rank  9: 163.09
     rank 10: 164.22
     rank 11: 163.92
     rank 12: 518.85
     rank 13: 527.86
     rank 14: 527.49
     rank 15: 517.34
  batch-generator:
     rank  0: 14.85
     rank  1: 16.15
     rank  2: 15.06
     rank  3: 15.06
     rank  4: 13.37
     rank  5: 10.79
     rank  6: 13.03
     rank  7: 13.14
     rank  8: 14.39
     rank  9: 14.30
     rank 10: 13.65
     rank 11: 17.47
     rank 12: 11.97
     rank 13: 10.66
     rank 14: 11.73
     rank 15: 14.78
  forward-recv:
     rank  4: 35.96
     rank  5: 39.49
     rank  6: 36.45
     rank  7: 37.12
     rank  8: 236.41
     rank  9: 218.52
     rank 10: 238.00
     rank 11: 215.48
     rank 12: 195.75
     rank 13: 189.64
     rank 14: 197.17
     rank 15: 189.49
  forward-send:
     rank  0: 163.06
     rank  1: 141.17
     rank  2: 164.09
     rank  3: 143.28
     rank  4: 3.92
     rank  5: 4.07
     rank  6: 3.52
     rank  7: 3.43
     rank  8: 1.88
     rank  9: 2.98
     rank 10: 1.67
     rank 11: 2.75
  backward-recv:
     rank  0: 599.77
     rank  1: 604.26
     rank  2: 607.14
     rank  3: 613.75
     rank  4: 226.49
     rank  5: 237.38
     rank  6: 233.38
     rank  7: 239.30
     rank  8: 201.88
     rank  9: 202.76
     rank 10: 203.95
     rank 11: 204.43
  backward-send:
     rank  4: 1.38
     rank  5: 1.10
     rank  6: 1.36
     rank  7: 1.04
     rank  8: 4.16
     rank  9: 5.02
     rank 10: 5.63
     rank 11: 6.41
     rank 12: 1.90
     rank 13: 3.85
     rank 14: 3.68
     rank 15: 3.24
  forward-send-backward-recv:
     rank  0: 299.41
     rank  1: 313.07
     rank  2: 298.12
     rank  3: 313.68
     rank  4: 91.54
     rank  5: 123.50
     rank  6: 90.46
     rank  7: 113.82
     rank  8: 447.74
     rank  9: 462.44
     rank 10: 440.80
     rank 11: 460.66
  backward-send-forward-recv:
     rank  4: 1.70
     rank  5: 1.02
     rank  6: 1.38
     rank  7: 0.86
     rank  8: 7.83
     rank  9: 7.31
     rank 10: 10.37
     rank 11: 6.21
     rank 12: 11.20
     rank 13: 10.09
     rank 14: 10.13
     rank 15: 8.19
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.04
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.07
     rank  5: 0.05
     rank  6: 0.07
     rank  7: 0.05
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.05
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.09
  all-grads-sync:
     rank  0: 200.11
     rank  1: 200.07
     rank  2: 200.09
     rank  3: 200.07
     rank  4: 192.09
     rank  5: 192.05
     rank  6: 192.12
     rank  7: 192.13
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.04
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.04
  optimizer-copy-to-main-grad:
     rank  0: 0.10
     rank  1: 0.10
     rank  2: 0.10
     rank  3: 0.10
     rank  4: 0.11
     rank  5: 0.10
     rank  6: 0.11
     rank  7: 0.10
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.03
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 24.62
     rank  1: 24.62
     rank  2: 24.70
     rank  3: 24.64
     rank  4: 25.00
     rank  5: 24.90
     rank  6: 24.90
     rank  7: 24.87
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.12
     rank 12: 0.04
     rank 13: 0.03
     rank 14: 0.04
     rank 15: 0.05
  optimizer:
     rank  0: 25.34
     rank  1: 25.36
     rank  2: 25.42
     rank  3: 25.36
     rank  4: 25.72
     rank  5: 25.62
     rank  6: 25.62
     rank  7: 25.59
     rank  8: 0.76
     rank  9: 0.76
     rank 10: 0.76
     rank 11: 0.84
     rank 12: 0.75
     rank 13: 0.75
     rank 14: 0.76
     rank 15: 0.77
 [2024-12-25 13:55:05] iteration        6/      10 | consumed samples:           96 | elapsed time per iteration (ms): 1652.9 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 6.353725E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 1596.81
     rank  1: 1596.88
     rank  2: 1596.81
     rank  3: 1596.82
     rank  4: 1596.73
     rank  5: 1596.78
     rank  6: 1596.77
     rank  7: 1596.73
     rank  8: 1594.50
     rank  9: 1594.56
     rank 10: 1594.51
     rank 11: 1594.52
     rank 12: 1594.46
     rank 13: 1594.51
     rank 14: 1594.46
     rank 15: 1594.44
  forward-compute:
     rank  0: 143.77
     rank  1: 157.57
     rank  2: 145.93
     rank  3: 147.82
     rank  4: 441.40
     rank  5: 434.94
     rank  6: 442.70
     rank  7: 438.02
     rank  8: 155.40
     rank  9: 160.61
     rank 10: 161.96
     rank 11: 166.95
     rank 12: 445.11
     rank 13: 443.62
     rank 14: 442.21
     rank 15: 454.28
  backward-compute:
     rank  0: 175.63
     rank  1: 173.88
     rank  2: 174.81
     rank  3: 172.68
     rank  4: 512.74
     rank  5: 508.01
     rank  6: 510.30
     rank  7: 512.92
     rank  8: 161.29
     rank  9: 163.91
     rank 10: 163.95
     rank 11: 162.70
     rank 12: 522.11
     rank 13: 525.83
     rank 14: 526.15
     rank 15: 516.41
  pure-backward-compute:
     rank  0: 175.45
     rank  1: 173.66
     rank  2: 174.64
     rank  3: 172.49
     rank  4: 512.48
     rank  5: 507.63
     rank  6: 510.10
     rank  7: 512.66
     rank  8: 161.04
     rank  9: 163.52
     rank 10: 163.63
     rank 11: 162.36
     rank 12: 521.50
     rank 13: 525.04
     rank 14: 525.39
     rank 15: 515.79
  batch-generator:
     rank  0: 15.35
     rank  1: 16.84
     rank  2: 15.62
     rank  3: 15.89
     rank  4: 11.03
     rank  5: 11.56
     rank  6: 11.27
     rank  7: 10.73
     rank  8: 14.27
     rank  9: 14.52
     rank 10: 13.28
     rank 11: 19.84
     rank 12: 11.73
     rank 13: 12.16
     rank 14: 11.31
     rank 15: 13.92
  forward-recv:
     rank  4: 36.19
     rank  5: 40.22
     rank  6: 36.81
     rank  7: 36.15
     rank  8: 220.85
     rank  9: 219.33
     rank 10: 218.55
     rank 11: 211.94
     rank 12: 192.53
     rank 13: 192.61
     rank 14: 193.14
     rank 15: 190.83
  forward-send:
     rank  0: 156.85
     rank  1: 144.17
     rank  2: 154.78
     rank  3: 148.75
     rank  4: 6.81
     rank  5: 5.27
     rank  6: 6.32
     rank  7: 3.47
     rank  8: 4.10
     rank  9: 4.24
     rank 10: 4.58
     rank 11: 3.31
  backward-recv:
     rank  0: 599.58
     rank  1: 604.34
     rank  2: 604.22
     rank  3: 602.20
     rank  4: 229.61
     rank  5: 233.72
     rank  6: 231.79
     rank  7: 230.03
     rank  8: 203.41
     rank  9: 203.70
     rank 10: 201.38
     rank 11: 203.56
  backward-send:
     rank  4: 1.13
     rank  5: 1.50
     rank  6: 1.07
     rank  7: 1.31
     rank  8: 3.28
     rank  9: 4.45
     rank 10: 4.47
     rank 11: 3.13
     rank 12: 2.46
     rank 13: 2.24
     rank 14: 2.87
     rank 15: 1.64
  forward-send-backward-recv:
     rank  0: 314.43
     rank  1: 312.87
     rank  2: 312.76
     rank  3: 315.95
     rank  4: 116.57
     rank  5: 123.34
     rank  6: 118.26
     rank  7: 120.41
     rank  8: 461.09
     rank  9: 456.51
     rank 10: 456.52
     rank 11: 456.56
  backward-send-forward-recv:
     rank  4: 1.06
     rank  5: 1.40
     rank  6: 0.72
     rank  7: 0.65
     rank  8: 9.52
     rank  9: 9.33
     rank 10: 10.12
     rank 11: 7.58
     rank 12: 13.88
     rank 13: 14.10
     rank 14: 12.80
     rank 15: 10.03
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.06
     rank 13: 0.08
     rank 14: 0.05
     rank 15: 0.05
  all-grads-sync:
     rank  0: 198.32
     rank  1: 198.27
     rank  2: 198.31
     rank  3: 198.28
     rank  4: 191.24
     rank  5: 191.21
     rank  6: 191.21
     rank  7: 191.22
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.09
     rank  1: 0.10
     rank  2: 0.09
     rank  3: 0.10
     rank  4: 0.09
     rank  5: 0.10
     rank  6: 0.10
     rank  7: 0.10
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 24.59
     rank  1: 24.70
     rank  2: 24.63
     rank  3: 24.69
     rank  4: 24.90
     rank  5: 24.84
     rank  6: 24.88
     rank  7: 24.89
     rank  8: 0.04
     rank  9: 0.09
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.07
     rank 13: 0.05
     rank 14: 0.03
     rank 15: 0.06
  optimizer:
     rank  0: 25.28
     rank  1: 25.38
     rank  2: 25.31
     rank  3: 25.37
     rank  4: 25.57
     rank  5: 25.51
     rank  6: 25.55
     rank  7: 25.56
     rank  8: 0.71
     rank  9: 0.76
     rank 10: 0.71
     rank 11: 0.72
     rank 12: 0.73
     rank 13: 0.72
     rank 14: 0.69
     rank 15: 0.72
 [2024-12-25 13:55:07] iteration        7/      10 | consumed samples:          112 | elapsed time per iteration (ms): 1665.9 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 6.206797E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 1602.18
     rank  1: 1602.26
     rank  2: 1602.18
     rank  3: 1602.19
     rank  4: 1602.09
     rank  5: 1602.11
     rank  6: 1602.13
     rank  7: 1602.08
     rank  8: 1599.79
     rank  9: 1599.87
     rank 10: 1599.86
     rank 11: 1599.82
     rank 12: 1599.77
     rank 13: 1599.82
     rank 14: 1599.82
     rank 15: 1599.77
  forward-compute:
     rank  0: 144.10
     rank  1: 158.60
     rank  2: 144.84
     rank  3: 146.22
     rank  4: 442.07
     rank  5: 435.81
     rank  6: 442.08
     rank  7: 439.34
     rank  8: 159.50
     rank  9: 160.63
     rank 10: 160.38
     rank 11: 161.52
     rank 12: 452.83
     rank 13: 445.53
     rank 14: 452.47
     rank 15: 462.23
  backward-compute:
     rank  0: 173.72
     rank  1: 175.36
     rank  2: 173.00
     rank  3: 171.99
     rank  4: 512.17
     rank  5: 508.88
     rank  6: 508.47
     rank  7: 511.36
     rank  8: 162.62
     rank  9: 162.19
     rank 10: 163.93
     rank 11: 163.37
     rank 12: 518.93
     rank 13: 527.09
     rank 14: 521.07
     rank 15: 515.92
  pure-backward-compute:
     rank  0: 173.56
     rank  1: 175.16
     rank  2: 172.84
     rank  3: 171.83
     rank  4: 511.91
     rank  5: 508.62
     rank  6: 508.21
     rank  7: 511.18
     rank  8: 162.27
     rank  9: 161.88
     rank 10: 163.62
     rank 11: 163.04
     rank 12: 518.21
     rank 13: 526.23
     rank 14: 520.45
     rank 15: 515.40
  batch-generator:
     rank  0: 15.08
     rank  1: 16.66
     rank  2: 15.25
     rank  3: 15.67
     rank  4: 11.57
     rank  5: 11.23
     rank  6: 11.00
     rank  7: 11.23
     rank  8: 17.14
     rank  9: 13.58
     rank 10: 13.85
     rank 11: 16.16
     rank 12: 12.03
     rank 13: 13.40
     rank 14: 12.09
     rank 15: 12.00
  forward-recv:
     rank  4: 35.79
     rank  5: 40.65
     rank  6: 36.49
     rank  7: 35.91
     rank  8: 220.33
     rank  9: 220.37
     rank 10: 223.83
     rank 11: 217.28
     rank 12: 189.89
     rank 13: 190.96
     rank 14: 188.59
     rank 15: 184.74
  forward-send:
     rank  0: 155.54
     rank  1: 143.73
     rank  2: 156.09
     rank  3: 149.45
     rank  4: 6.05
     rank  5: 4.95
     rank  6: 6.37
     rank  7: 3.47
     rank  8: 2.76
     rank  9: 2.31
     rank 10: 1.96
     rank 11: 1.61
  backward-recv:
     rank  0: 615.98
     rank  1: 611.75
     rank  2: 614.48
     rank  3: 618.10
     rank  4: 235.06
     rank  5: 237.30
     rank  6: 236.66
     rank  7: 236.29
     rank  8: 206.91
     rank  9: 204.59
     rank 10: 205.10
     rank 11: 208.01
  backward-send:
     rank  4: 1.24
     rank  5: 1.43
     rank  6: 1.36
     rank  7: 0.94
     rank  8: 6.72
     rank  9: 6.76
     rank 10: 6.38
     rank 11: 6.21
     rank 12: 4.73
     rank 13: 4.06
     rank 14: 4.53
     rank 15: 4.27
  forward-send-backward-recv:
     rank  0: 307.86
     rank  1: 307.12
     rank  2: 307.14
     rank  3: 309.86
     rank  4: 118.95
     rank  5: 122.50
     rank  6: 119.26
     rank  7: 123.91
     rank  8: 456.30
     rank  9: 458.94
     rank 10: 453.21
     rank 11: 457.66
  backward-send-forward-recv:
     rank  4: 0.89
     rank  5: 0.86
     rank  6: 0.66
     rank  7: 0.64
     rank  8: 9.77
     rank  9: 9.63
     rank 10: 9.64
     rank 11: 8.67
     rank 12: 12.25
     rank 13: 11.33
     rank 14: 11.33
     rank 15: 10.52
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.05
     rank 13: 0.07
     rank 14: 0.06
     rank 15: 0.05
  all-grads-sync:
     rank  0: 198.48
     rank  1: 198.48
     rank  2: 198.45
     rank  3: 198.48
     rank  4: 199.67
     rank  5: 199.61
     rank  6: 199.68
     rank  7: 199.69
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
  optimizer-copy-to-main-grad:
     rank  0: 0.09
     rank  1: 0.10
     rank  2: 0.09
     rank  3: 0.10
     rank  4: 0.10
     rank  5: 0.11
     rank  6: 0.12
     rank  7: 0.10
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 24.62
     rank  1: 24.69
     rank  2: 24.62
     rank  3: 24.63
     rank  4: 24.86
     rank  5: 24.94
     rank  6: 24.89
     rank  7: 24.95
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.04
     rank 13: 0.08
     rank 14: 0.03
     rank 15: 0.03
  optimizer:
     rank  0: 25.26
     rank  1: 25.36
     rank  2: 25.26
     rank  3: 25.27
     rank  4: 25.50
     rank  5: 25.57
     rank  6: 25.53
     rank  7: 25.59
     rank  8: 0.67
     rank  9: 0.67
     rank 10: 0.67
     rank 11: 0.67
     rank 12: 0.67
     rank 13: 0.71
     rank 14: 0.66
     rank 15: 0.66
 [2024-12-25 13:55:08] iteration        8/      10 | consumed samples:          128 | elapsed time per iteration (ms): 1658.8 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 4.818991E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 1602.79
     rank  1: 1602.82
     rank  2: 1602.80
     rank  3: 1602.77
     rank  4: 1602.72
     rank  5: 1602.70
     rank  6: 1602.76
     rank  7: 1602.69
     rank  8: 1600.74
     rank  9: 1600.62
     rank 10: 1600.63
     rank 11: 1600.66
     rank 12: 1600.41
     rank 13: 1600.42
     rank 14: 1600.47
     rank 15: 1600.39
  forward-compute:
     rank  0: 144.77
     rank  1: 157.60
     rank  2: 145.44
     rank  3: 145.75
     rank  4: 442.25
     rank  5: 437.26
     rank  6: 441.38
     rank  7: 438.31
     rank  8: 159.98
     rank  9: 160.04
     rank 10: 164.13
     rank 11: 161.47
     rank 12: 456.51
     rank 13: 446.86
     rank 14: 450.23
     rank 15: 455.38
  backward-compute:
     rank  0: 175.33
     rank  1: 173.94
     rank  2: 174.93
     rank  3: 173.03
     rank  4: 519.11
     rank  5: 508.81
     rank  6: 509.40
     rank  7: 511.32
     rank  8: 163.62
     rank  9: 162.61
     rank 10: 164.45
     rank 11: 163.65
     rank 12: 518.84
     rank 13: 529.09
     rank 14: 522.37
     rank 15: 519.83
  pure-backward-compute:
     rank  0: 175.15
     rank  1: 173.74
     rank  2: 174.75
     rank  3: 172.84
     rank  4: 518.87
     rank  5: 508.60
     rank  6: 508.90
     rank  7: 511.12
     rank  8: 163.09
     rank  9: 162.27
     rank 10: 164.13
     rank 11: 163.21
     rank 12: 518.24
     rank 13: 528.43
     rank 14: 521.56
     rank 15: 519.31
  batch-generator:
     rank  0: 15.43
     rank  1: 16.59
     rank  2: 15.07
     rank  3: 15.21
     rank  4: 13.03
     rank  5: 11.85
     rank  6: 11.64
     rank  7: 10.87
     rank  8: 17.20
     rank  9: 13.14
     rank 10: 13.64
     rank 11: 15.59
     rank 12: 13.54
     rank 13: 15.22
     rank 14: 13.52
     rank 15: 11.39
  forward-recv:
     rank  4: 36.13
     rank  5: 40.13
     rank  6: 36.71
     rank  7: 36.52
     rank  8: 221.25
     rank  9: 222.39
     rank 10: 220.27
     rank 11: 214.62
     rank 12: 189.32
     rank 13: 191.52
     rank 14: 190.72
     rank 15: 190.23
  forward-send:
     rank  0: 154.84
     rank  1: 147.03
     rank  2: 154.80
     rank  3: 150.27
     rank  4: 6.94
     rank  5: 5.35
     rank  6: 7.51
     rank  7: 4.38
     rank  8: 3.15
     rank  9: 2.70
     rank 10: 4.05
     rank 11: 3.77
  backward-recv:
     rank  0: 613.73
     rank  1: 613.75
     rank  2: 608.77
     rank  3: 615.97
     rank  4: 230.56
     rank  5: 239.41
     rank  6: 234.13
     rank  7: 238.13
     rank  8: 207.52
     rank  9: 205.69
     rank 10: 204.26
     rank 11: 209.97
  backward-send:
     rank  4: 0.95
     rank  5: 1.09
     rank  6: 1.70
     rank  7: 0.94
     rank  8: 4.59
     rank  9: 5.68
     rank 10: 4.30
     rank 11: 4.87
     rank 12: 4.27
     rank 13: 3.55
     rank 14: 3.23
     rank 15: 4.34
  forward-send-backward-recv:
     rank  0: 309.90
     rank  1: 306.80
     rank  2: 311.35
     rank  3: 314.54
     rank  4: 117.04
     rank  5: 122.08
     rank  6: 118.91
     rank  7: 125.54
     rank  8: 458.04
     rank  9: 459.25
     rank 10: 453.40
     rank 11: 458.56
  backward-send-forward-recv:
     rank  4: 1.18
     rank  5: 0.71
     rank  6: 0.75
     rank  7: 0.66
     rank  8: 8.74
     rank  9: 9.91
     rank 10: 9.58
     rank 11: 11.69
     rank 12: 12.80
     rank 13: 12.09
     rank 14: 13.94
     rank 15: 12.70
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.06
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.07
     rank  7: 0.05
     rank  8: 0.04
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.06
     rank 13: 0.06
     rank 14: 0.07
     rank 15: 0.05
  all-grads-sync:
     rank  0: 197.82
     rank  1: 197.80
     rank  2: 197.78
     rank  3: 197.78
     rank  4: 193.31
     rank  5: 192.76
     rank  6: 192.81
     rank  7: 192.89
     rank  8: 0.05
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
  optimizer-copy-to-main-grad:
     rank  0: 0.09
     rank  1: 0.09
     rank  2: 0.09
     rank  3: 0.09
     rank  4: 0.11
     rank  5: 0.10
     rank  6: 0.12
     rank  7: 0.10
     rank  8: 0.03
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 24.61
     rank  1: 24.66
     rank  2: 24.68
     rank  3: 24.67
     rank  4: 24.91
     rank  5: 24.87
     rank  6: 25.03
     rank  7: 24.89
     rank  8: 0.12
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.12
     rank 12: 0.07
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.03
  optimizer:
     rank  0: 25.35
     rank  1: 25.43
     rank  2: 25.42
     rank  3: 25.42
     rank  4: 25.64
     rank  5: 25.61
     rank  6: 25.76
     rank  7: 25.63
     rank  8: 0.85
     rank  9: 0.78
     rank 10: 0.77
     rank 11: 0.86
     rank 12: 0.80
     rank 13: 0.79
     rank 14: 0.78
     rank 15: 0.76
 [2024-12-25 13:55:10] iteration        9/      10 | consumed samples:          144 | elapsed time per iteration (ms): 1659.8 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 4.289155E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 1602.52
     rank  1: 1602.58
     rank  2: 1602.56
     rank  3: 1602.52
     rank  4: 1602.55
     rank  5: 1602.48
     rank  6: 1602.51
     rank  7: 1602.49
     rank  8: 1600.39
     rank  9: 1600.40
     rank 10: 1600.57
     rank 11: 1600.46
     rank 12: 1600.16
     rank 13: 1600.17
     rank 14: 1600.21
     rank 15: 1600.15
  forward-compute:
     rank  0: 143.81
     rank  1: 157.05
     rank  2: 144.94
     rank  3: 146.71
     rank  4: 451.55
     rank  5: 442.01
     rank  6: 446.67
     rank  7: 441.71
     rank  8: 158.32
     rank  9: 158.96
     rank 10: 161.07
     rank 11: 163.77
     rank 12: 455.72
     rank 13: 445.68
     rank 14: 445.73
     rank 15: 463.62
  backward-compute:
     rank  0: 175.39
     rank  1: 175.23
     rank  2: 173.68
     rank  3: 172.09
     rank  4: 514.31
     rank  5: 510.64
     rank  6: 508.78
     rank  7: 512.59
     rank  8: 162.70
     rank  9: 162.48
     rank 10: 164.74
     rank 11: 163.34
     rank 12: 518.91
     rank 13: 527.10
     rank 14: 525.35
     rank 15: 515.40
  pure-backward-compute:
     rank  0: 175.19
     rank  1: 175.03
     rank  2: 173.51
     rank  3: 171.92
     rank  4: 514.04
     rank  5: 510.43
     rank  6: 508.51
     rank  7: 512.38
     rank  8: 162.39
     rank  9: 162.11
     rank 10: 164.38
     rank 11: 162.99
     rank 12: 518.22
     rank 13: 526.51
     rank 14: 524.64
     rank 15: 514.85
  batch-generator:
     rank  0: 14.63
     rank  1: 16.52
     rank  2: 14.71
     rank  3: 15.73
     rank  4: 18.13
     rank  5: 11.44
     rank  6: 12.08
     rank  7: 10.96
     rank  8: 15.73
     rank  9: 13.03
     rank 10: 13.35
     rank 11: 15.72
     rank 12: 12.00
     rank 13: 12.99
     rank 14: 13.65
     rank 15: 11.27
  forward-recv:
     rank  4: 35.82
     rank  5: 40.17
     rank  6: 36.95
     rank  7: 36.18
     rank  8: 218.26
     rank  9: 226.81
     rank 10: 224.35
     rank 11: 217.76
     rank 12: 190.61
     rank 13: 193.37
     rank 14: 193.64
     rank 15: 188.42
  forward-send:
     rank  0: 154.54
     rank  1: 150.31
     rank  2: 158.68
     rank  3: 150.92
     rank  4: 3.72
     rank  5: 4.79
     rank  6: 4.33
     rank  7: 3.54
     rank  8: 1.85
     rank  9: 2.55
     rank 10: 2.76
     rank 11: 1.65
  backward-recv:
     rank  0: 612.49
     rank  1: 610.93
     rank  2: 610.95
     rank  3: 614.83
     rank  4: 233.18
     rank  5: 236.56
     rank  6: 236.40
     rank  7: 237.18
     rank  8: 206.82
     rank  9: 204.75
     rank 10: 205.37
     rank 11: 207.21
  backward-send:
     rank  4: 1.36
     rank  5: 1.12
     rank  6: 1.40
     rank  7: 0.95
     rank  8: 5.16
     rank  9: 5.51
     rank 10: 5.32
     rank 11: 3.79
     rank 12: 4.59
     rank 13: 4.20
     rank 14: 4.76
     rank 15: 3.57
  forward-send-backward-recv:
     rank  0: 310.58
     rank  1: 304.08
     rank  2: 308.41
     rank  3: 308.87
     rank  4: 111.10
     rank  5: 116.39
     rank  6: 116.52
     rank  7: 116.41
     rank  8: 462.59
     rank  9: 456.54
     rank 10: 454.59
     rank 11: 460.02
  backward-send-forward-recv:
     rank  4: 0.85
     rank  5: 0.79
     rank  6: 0.67
     rank  7: 0.67
     rank  8: 8.53
     rank  9: 8.14
     rank 10: 7.93
     rank 11: 4.88
     rank 12: 9.77
     rank 13: 10.24
     rank 14: 10.34
     rank 15: 7.24
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.10
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.08
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.05
     rank 13: 0.06
     rank 14: 0.06
     rank 15: 0.05
  all-grads-sync:
     rank  0: 197.82
     rank  1: 197.73
     rank  2: 197.76
     rank  3: 197.77
     rank  4: 199.04
     rank  5: 198.95
     rank  6: 199.01
     rank  7: 199.06
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
  optimizer-copy-to-main-grad:
     rank  0: 0.09
     rank  1: 0.09
     rank  2: 0.09
     rank  3: 0.09
     rank  4: 0.11
     rank  5: 0.10
     rank  6: 0.11
     rank  7: 0.11
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.04
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 24.67
     rank  1: 24.64
     rank  2: 24.70
     rank  3: 24.63
     rank  4: 25.02
     rank  5: 24.91
     rank  6: 24.96
     rank  7: 24.94
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.11
     rank 11: 0.12
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.03
  optimizer:
     rank  0: 26.32
     rank  1: 26.30
     rank  2: 26.35
     rank  3: 26.28
     rank  4: 26.67
     rank  5: 26.56
     rank  6: 26.61
     rank  7: 26.59
     rank  8: 1.69
     rank  9: 1.69
     rank 10: 1.75
     rank 11: 1.76
     rank 12: 1.68
     rank 13: 1.69
     rank 14: 1.69
     rank 15: 1.68
 [2024-12-25 13:55:12] iteration       10/      10 | consumed samples:          160 | elapsed time per iteration (ms): 1657.0 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 3.858606E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 1600.45
     rank  1: 1600.46
     rank  2: 1600.50
     rank  3: 1600.45
     rank  4: 1600.37
     rank  5: 1600.37
     rank  6: 1600.43
     rank  7: 1600.37
     rank  8: 1598.23
     rank  9: 1598.12
     rank 10: 1598.17
     rank 11: 1598.12
     rank 12: 1598.06
     rank 13: 1598.04
     rank 14: 1598.13
     rank 15: 1598.04
  forward-compute:
     rank  0: 143.89
     rank  1: 156.96
     rank  2: 145.95
     rank  3: 148.33
     rank  4: 441.51
     rank  5: 439.24
     rank  6: 441.99
     rank  7: 439.39
     rank  8: 156.72
     rank  9: 162.08
     rank 10: 164.25
     rank 11: 161.06
     rank 12: 456.57
     rank 13: 445.38
     rank 14: 447.38
     rank 15: 460.29
  backward-compute:
     rank  0: 176.57
     rank  1: 173.98
     rank  2: 173.53
     rank  3: 172.29
     rank  4: 513.47
     rank  5: 510.13
     rank  6: 509.64
     rank  7: 513.42
     rank  8: 163.10
     rank  9: 163.03
     rank 10: 166.13
     rank 11: 162.65
     rank 12: 518.62
     rank 13: 527.34
     rank 14: 524.65
     rank 15: 519.48
  pure-backward-compute:
     rank  0: 176.39
     rank  1: 173.75
     rank  2: 173.33
     rank  3: 172.11
     rank  4: 513.22
     rank  5: 509.81
     rank  6: 509.21
     rank  7: 513.22
     rank  8: 162.69
     rank  9: 162.69
     rank 10: 165.67
     rank 11: 162.31
     rank 12: 518.08
     rank 13: 526.67
     rank 14: 523.95
     rank 15: 518.95
  batch-generator:
     rank  0: 15.62
     rank  1: 16.39
     rank  2: 15.55
     rank  3: 16.10
     rank  4: 11.37
     rank  5: 11.60
     rank  6: 11.28
     rank  7: 10.78
     rank  8: 15.18
     rank  9: 13.08
     rank 10: 15.84
     rank 11: 13.88
     rank 12: 12.03
     rank 13: 13.04
     rank 14: 13.37
     rank 15: 11.81
  forward-recv:
     rank  4: 36.22
     rank  5: 41.06
     rank  6: 36.63
     rank  7: 36.27
     rank  8: 221.65
     rank  9: 223.38
     rank 10: 216.88
     rank 11: 217.43
     rank 12: 188.50
     rank 13: 192.17
     rank 14: 191.94
     rank 15: 184.59
  forward-send:
     rank  0: 155.54
     rank  1: 147.40
     rank  2: 153.34
     rank  3: 149.33
     rank  4: 5.06
     rank  5: 4.16
     rank  6: 4.82
     rank  7: 3.38
     rank  8: 1.83
     rank  9: 2.75
     rank 10: 2.61
     rank 11: 1.61
  backward-recv:
     rank  0: 608.75
     rank  1: 610.53
     rank  2: 612.60
     rank  3: 615.93
     rank  4: 231.34
     rank  5: 234.27
     rank  6: 234.52
     rank  7: 231.45
     rank  8: 203.85
     rank  9: 203.97
     rank 10: 202.97
     rank 11: 205.44
  backward-send:
     rank  4: 1.35
     rank  5: 1.66
     rank  6: 2.05
     rank  7: 0.97
     rank  8: 4.08
     rank  9: 4.49
     rank 10: 4.85
     rank 11: 4.23
     rank 12: 2.51
     rank 13: 4.08
     rank 14: 4.22
     rank 15: 3.93
  forward-send-backward-recv:
     rank  0: 308.90
     rank  1: 306.91
     rank  2: 311.06
     rank  3: 308.01
     rank  4: 118.23
     rank  5: 119.86
     rank  6: 121.27
     rank  7: 124.88
     rank  8: 462.84
     rank  9: 455.89
     rank 10: 458.91
     rank 11: 462.36
  backward-send-forward-recv:
     rank  4: 0.85
     rank  5: 0.86
     rank  6: 0.69
     rank  7: 0.62
     rank  8: 6.66
     rank  9: 8.92
     rank 10: 8.65
     rank 11: 7.94
     rank 12: 11.48
     rank 13: 11.89
     rank 14: 12.29
     rank 15: 11.71
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.06
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.06
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.09
     rank 13: 0.06
     rank 14: 0.08
     rank 15: 0.05
  all-grads-sync:
     rank  0: 197.77
     rank  1: 197.80
     rank  2: 197.72
     rank  3: 197.81
     rank  4: 196.83
     rank  5: 196.78
     rank  6: 196.80
     rank  7: 196.86
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.01
  optimizer-copy-to-main-grad:
     rank  0: 0.10
     rank  1: 0.09
     rank  2: 0.10
     rank  3: 0.10
     rank  4: 0.09
     rank  5: 0.10
     rank  6: 0.11
     rank  7: 0.10
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 24.64
     rank  1: 24.65
     rank  2: 24.65
     rank  3: 24.62
     rank  4: 25.77
     rank  5: 24.95
     rank  6: 24.90
     rank  7: 24.88
     rank  8: 0.06
     rank  9: 0.04
     rank 10: 0.05
     rank 11: 0.04
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.05
     rank 15: 0.04
  optimizer:
     rank  0: 25.33
     rank  1: 25.35
     rank  2: 25.33
     rank  3: 25.30
     rank  4: 26.46
     rank  5: 25.63
     rank  6: 25.57
     rank  7: 25.55
     rank  8: 0.71
     rank  9: 0.70
     rank 10: 0.71
     rank 11: 0.69
     rank 12: 0.71
     rank 13: 0.72
     rank 14: 0.72
     rank 15: 0.71
