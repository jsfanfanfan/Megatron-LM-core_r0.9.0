examples/multimodal/pretrain-freeze-llm-homo.sh: line 4: activate: No such file or directory
[2024-12-25 14:29:21,653] torch.distributed.run: [WARNING] 
[2024-12-25 14:29:21,653] torch.distributed.run: [WARNING] *****************************************
[2024-12-25 14:29:21,653] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-12-25 14:29:21,653] torch.distributed.run: [WARNING] *****************************************
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
> setting tensorboard ...
WARNING: one_logger package is required to enable e2e metrics tracking. please go to https://confluence.nvidia.com/display/MLWFO/Package+Repositories for details to install it
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
---Rank 13---Tensor Parallel Group GPUs: [0]
---Rank 15---Tensor Parallel Group GPUs: [0]---Rank 13---Pipeline Parallel Group GPUs: [3, 3, 3, 3]

---Rank 14---Tensor Parallel Group GPUs: [0]---Rank 12---Tensor Parallel Group GPUs: [0]
---Rank 15---Pipeline Parallel Group GPUs: [3, 3, 3, 3]

---Rank 14---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
---Rank 12---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
[rank13]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank15]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank14]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank12]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
 > number of parameters on (tensor, pipeline) model parallel rank (0, 3): 1442893824
rank=1, worker=0: shard_range=[pretrain-2.tar[5000, 5100), pretrain-2.tar[5100, 5200), pretrain-2.tar[5200, 5300), ...<619>, pretrain-25.tar[7200, 7300), pretrain-25.tar[7300, 7400), pretrain-25.tar[7400, 7500)] sum(count)=62500
rank=1, worker=1: shard_range=[pretrain-25.tar[7500, 7600), pretrain-25.tar[7600, 7700), pretrain-25.tar[7700, 7800), ...<619>, pretrain-30.tar[9700, 9800), pretrain-30.tar[9800, 9900), pretrain-30.tar[9900, 10000)] sum(count)=62500
rank=0, worker=0: shard_range=[pretrain-0.tar[0, 100), pretrain-0.tar[100, 200), pretrain-0.tar[200, 300), ...<619>, pretrain-14.tar[2200, 2300), pretrain-14.tar[2300, 2400), pretrain-14.tar[2400, 2500)] sum(count)=62500
rank=0, worker=1: shard_range=[pretrain-14.tar[2500, 2600), pretrain-14.tar[2600, 2700), pretrain-14.tar[2700, 2800), ...<619>, pretrain-2.tar[4700, 4800), pretrain-2.tar[4800, 4900), pretrain-2.tar[4900, 5000)] sum(count)=62500
rank=2, worker=0: shard_range=[pretrain-31.tar[0, 100), pretrain-31.tar[100, 200), pretrain-31.tar[200, 300), ...<619>, pretrain-37.tar[2200, 2300), pretrain-37.tar[2300, 2400), pretrain-37.tar[2400, 2500)] sum(count)=62500
rank=2, worker=1: shard_range=[pretrain-37.tar[2500, 2600), pretrain-37.tar[2600, 2700), pretrain-37.tar[2700, 2800), ...<619>, pretrain-42.tar[4700, 4800), pretrain-42.tar[4800, 4900), pretrain-42.tar[4900, 5000)] sum(count)=62500
rank=3, worker=0: shard_range=[pretrain-42.tar[5000, 5100), pretrain-42.tar[5100, 5200), pretrain-42.tar[5200, 5300), ...<619>, pretrain-48.tar[7200, 7300), pretrain-48.tar[7300, 7400), pretrain-48.tar[7400, 7500)] sum(count)=62500
rank=3, worker=1: shard_range=[pretrain-48.tar[7500, 7600), pretrain-48.tar[7600, 7700), pretrain-48.tar[7700, 7800), ...<619>, pretrain-53.tar[9700, 9800), pretrain-53.tar[9800, 9900), pretrain-53.tar[9900, 10000)] sum(count)=62500
rank=0, worker=0: shard_range=[pretrain-54.tar[0, 7266)] sum(count)=7266
rank=0, worker=1: shard_range=[pretrain-54.tar[7266, 10000), pretrain-55.tar[0, 4532)] sum(count)=7266
rank=3, worker=0: shard_range=[pretrain-8.tar[5468, 10000), pretrain-9.tar[0, 2734)] sum(count)=7266
rank=3, worker=1: shard_range=[pretrain-9.tar[2734, 10000)] sum(count)=7266
rank=1, worker=0: shard_range=[pretrain-55.tar[4532, 8128), pretrain-6.tar[0, 3670)] sum(count)=7266
rank=1, worker=1: shard_range=[pretrain-6.tar[3670, 10000), pretrain-7.tar[0, 936)] sum(count)=7266
rank=2, worker=0: shard_range=[pretrain-7.tar[936, 8202)] sum(count)=7266
rank=2, worker=1: shard_range=[pretrain-7.tar[8202, 10000), pretrain-8.tar[0, 5468)] sum(count)=7266
times across ranks (ms):
  model-and-optimizer-setup:
     rank  0: 147.06
     rank  1: 142.49
     rank  2: 149.18
     rank  3: 146.81
     rank  4: 7.14
     rank  5: 6.87
     rank  6: 6.92
     rank  7: 6.59
     rank  8: 54.83
     rank  9: 55.03
     rank 10: 53.62
     rank 11: 53.85
     rank 12: 54.67
     rank 13: 51.14
     rank 14: 54.75
     rank 15: 59.84
  train/valid/test-data-iterators-setup:
     rank  0: 1143.05
     rank  1: 1143.02
     rank  2: 1204.91
     rank  3: 1227.71
     rank  4: 1234.70
     rank  5: 1234.61
     rank  6: 1234.61
     rank  7: 1234.67
     rank  8: 1234.77
     rank  9: 1234.69
     rank 10: 1234.74
     rank 11: 1234.70
     rank 12: 1234.68
     rank 13: 1234.67
     rank 14: 1256.68
     rank 15: 1256.25
 [2024-12-25 14:29:56] iteration        1/      10 | consumed samples:           16 | elapsed time per iteration (ms): 12258.7 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 7.252599E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
stage4 GPU utialization:71.24912955544211 %
[Rank 12] (after 1 iterations) memory (MB) | allocated: 5557.4560546875 | max allocated: 8025.501953125 | reserved: 8216.0 | max reserved: 8216.0
times across ranks (ms):
  forward-backward:
     rank  0: 12085.40
     rank  1: 12085.40
     rank  2: 12085.57
     rank  3: 12085.53
     rank  4: 12083.44
     rank  5: 12083.27
     rank  6: 12083.28
     rank  7: 12083.30
     rank  8: 12219.82
     rank  9: 12219.76
     rank 10: 12219.70
     rank 11: 12219.81
     rank 12: 12082.39
     rank 13: 12082.39
     rank 14: 12082.49
     rank 15: 12082.49
  forward-compute:
     rank  0: 3219.85
     rank  1: 3652.38
     rank  2: 3651.17
     rank  3: 3971.67
     rank  4: 2056.48
     rank  5: 1716.59
     rank  6: 1897.96
     rank  7: 1559.27
     rank  8: 2816.59
     rank  9: 2546.63
     rank 10: 2724.31
     rank 11: 2654.20
     rank 12: 2776.07
     rank 13: 2993.52
     rank 14: 2630.32
     rank 15: 2726.16
  backward-compute:
     rank  0: 917.51
     rank  1: 1082.72
     rank  2: 851.45
     rank  3: 1060.77
     rank  4: 77.42
     rank  5: 85.16
     rank  6: 87.11
     rank  7: 81.53
     rank  8: 478.65
     rank  9: 479.74
     rank 10: 474.83
     rank 11: 479.05
     rank 12: 528.11
     rank 13: 511.69
     rank 14: 519.62
     rank 15: 526.10
  pure-backward-compute:
     rank  0: 917.00
     rank  1: 1082.22
     rank  2: 851.02
     rank  3: 1060.29
     rank  4: 77.06
     rank  5: 84.82
     rank  6: 86.75
     rank  7: 81.18
     rank  8: 478.24
     rank  9: 479.29
     rank 10: 474.47
     rank 11: 478.55
     rank 12: 527.34
     rank 13: 510.99
     rank 14: 518.87
     rank 15: 525.23
  batch-generator:
     rank  0: 885.43
     rank  1: 847.74
     rank  2: 1114.40
     rank  3: 1053.12
     rank  4: 1062.60
     rank  5: 992.42
     rank  6: 953.27
     rank  7: 838.40
     rank  8: 1094.62
     rank  9: 911.49
     rank 10: 1041.65
     rank 11: 969.52
     rank 12: 985.10
     rank 13: 991.43
     rank 14: 840.59
     rank 15: 1010.73
  forward-recv:
     rank  4: 3204.11
     rank  5: 3608.19
     rank  6: 3617.98
     rank  7: 3923.43
     rank  8: 5259.69
     rank  9: 5327.46
     rank 10: 5511.24
     rank 11: 5479.72
     rank 12: 7785.41
     rank 13: 7583.08
     rank 14: 7941.04
     rank 15: 7842.32
  forward-send:
     rank  0: 4627.75
     rank  1: 3993.58
     rank  2: 4353.27
     rank  3: 3939.56
     rank  4: 2543.11
     rank  5: 2274.20
     rank  6: 2446.75
     rank  7: 2376.66
     rank  8: 22.04
     rank  9: 30.01
     rank 10: 21.13
     rank 11: 22.49
  backward-recv:
     rank  0: 17.05
     rank  1: 19.45
     rank  2: 21.92
     rank  3: 17.18
     rank  4: 64.80
     rank  5: 66.31
     rank  6: 66.67
     rank  7: 64.86
     rank  8: 1.66
     rank  9: 1.66
     rank 10: 1.66
     rank 11: 1.65
  backward-send:
     rank  4: 641.56
     rank  5: 802.43
     rank  6: 582.18
     rank  7: 784.90
     rank  8: 359.45
     rank  9: 524.54
     rank 10: 300.11
     rank 11: 503.87
     rank 12: 235.59
     rank 13: 397.25
     rank 14: 173.57
     rank 15: 377.88
  forward-send-backward-recv:
     rank  0: 2742.14
     rank  1: 2939.90
     rank  2: 2583.06
     rank  3: 2677.95
     rank  4: 2870.65
     rank  5: 3070.28
     rank  6: 2700.60
     rank  7: 2810.34
     rank  8: 2515.26
     rank  9: 2703.21
     rank 10: 2360.82
     rank 11: 2455.36
  backward-send-forward-recv:
     rank  4: 15.16
     rank  5: 11.95
     rank  6: 13.85
     rank  7: 15.92
     rank  8: 12.63
     rank  9: 13.90
     rank 10: 11.43
     rank 11: 12.41
     rank 12: 23.07
     rank 13: 24.67
     rank 14: 23.96
     rank 15: 19.46
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.05
     rank  4: 0.04
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.05
     rank  9: 0.08
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.04
     rank 13: 0.02
     rank 14: 0.04
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.04
     rank  4: 0.09
     rank  5: 0.07
     rank  6: 0.08
     rank  7: 0.08
     rank  8: 0.03
     rank  9: 0.04
     rank 10: 0.03
     rank 11: 0.04
     rank 12: 0.08
     rank 13: 0.05
     rank 14: 0.08
     rank 15: 0.08
  all-grads-sync:
     rank  0: 387.90
     rank  1: 387.88
     rank  2: 387.88
     rank  3: 387.94
     rank  4: 177.71
     rank  5: 177.74
     rank  6: 177.75
     rank  7: 177.75
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.24
     rank  1: 0.26
     rank  2: 0.29
     rank  3: 0.29
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.05
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 33.76
     rank  1: 34.18
     rank  2: 34.56
     rank  3: 34.81
     rank  4: 9.11
     rank  5: 8.83
     rank  6: 8.85
     rank  7: 8.85
     rank  8: 0.22
     rank  9: 0.15
     rank 10: 0.14
     rank 11: 0.21
     rank 12: 0.12
     rank 13: 0.06
     rank 14: 0.12
     rank 15: 0.13
  optimizer:
     rank  0: 35.08
     rank  1: 35.51
     rank  2: 35.89
     rank  3: 36.14
     rank  4: 10.45
     rank  5: 10.13
     rank  6: 10.18
     rank  7: 10.18
     rank  8: 1.55
     rank  9: 1.49
     rank 10: 1.47
     rank 11: 1.54
     rank 12: 1.45
     rank 13: 1.36
     rank 14: 1.45
     rank 15: 1.45
 [2024-12-25 14:29:58] iteration        2/      10 | consumed samples:           32 | elapsed time per iteration (ms): 1652.4 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 6.941295E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 1592.95
     rank  1: 1592.96
     rank  2: 1592.98
     rank  3: 1592.96
     rank  4: 1590.83
     rank  5: 1590.82
     rank  6: 1590.85
     rank  7: 1590.84
     rank  8: 1590.26
     rank  9: 1590.27
     rank 10: 1590.32
     rank 11: 1590.26
     rank 12: 1590.25
     rank 13: 1590.26
     rank 14: 1590.35
     rank 15: 1590.27
  forward-compute:
     rank  0: 241.96
     rank  1: 304.95
     rank  2: 292.43
     rank  3: 295.24
     rank  4: 25.77
     rank  5: 22.29
     rank  6: 24.04
     rank  7: 23.57
     rank  8: 405.00
     rank  9: 400.22
     rank 10: 391.71
     rank 11: 405.83
     rank 12: 462.81
     rank 13: 441.85
     rank 14: 448.76
     rank 15: 446.15
  backward-compute:
     rank  0: 211.10
     rank  1: 210.73
     rank  2: 196.55
     rank  3: 228.18
     rank  4: 26.93
     rank  5: 25.08
     rank  6: 24.62
     rank  7: 26.71
     rank  8: 469.43
     rank  9: 466.03
     rank 10: 463.04
     rank 11: 467.65
     rank 12: 515.65
     rank 13: 527.07
     rank 14: 519.45
     rank 15: 518.38
  pure-backward-compute:
     rank  0: 210.94
     rank  1: 210.46
     rank  2: 196.39
     rank  3: 227.97
     rank  4: 26.68
     rank  5: 24.89
     rank  6: 24.43
     rank  7: 26.48
     rank  8: 469.09
     rank  9: 465.53
     rank 10: 462.69
     rank 11: 467.23
     rank 12: 514.98
     rank 13: 526.17
     rank 14: 518.58
     rank 15: 517.36
  batch-generator:
     rank  0: 11.68
     rank  1: 13.39
     rank  2: 15.24
     rank  3: 13.84
     rank  4: 13.48
     rank  5: 10.70
     rank  6: 12.38
     rank  7: 11.88
     rank  8: 17.30
     rank  9: 18.64
     rank 10: 12.70
     rank 11: 20.16
     rank 12: 15.71
     rank 13: 11.26
     rank 14: 15.20
     rank 15: 14.98
  forward-recv:
     rank  4: 109.09
     rank  5: 173.06
     rank  6: 154.50
     rank  7: 158.37
     rank  8: 61.77
     rank  9: 75.87
     rank 10: 75.16
     rank 11: 74.81
     rank 12: 163.07
     rank 13: 176.17
     rank 14: 174.59
     rank 15: 175.74
  forward-send:
     rank  0: 1.39
     rank  1: 1.34
     rank  2: 1.54
     rank  3: 1.19
     rank  4: 49.43
     rank  5: 33.23
     rank  6: 39.72
     rank  7: 39.09
     rank  8: 1.72
     rank  9: 3.09
     rank 10: 2.50
     rank 11: 3.26
  backward-recv:
     rank  0: 579.08
     rank  1: 576.65
     rank  2: 587.31
     rank  3: 566.24
     rank  4: 473.90
     rank  5: 477.89
     rank  6: 481.97
     rank  7: 474.12
     rank  8: 125.55
     rank  9: 126.94
     rank 10: 129.33
     rank 11: 125.60
  backward-send:
     rank  4: 1.08
     rank  5: 0.92
     rank  6: 0.92
     rank  7: 1.06
     rank  8: 1.98
     rank  9: 2.74
     rank 10: 2.14
     rank 11: 2.19
     rank 12: 2.10
     rank 13: 2.65
     rank 14: 2.86
     rank 15: 2.67
  forward-send-backward-recv:
     rank  0: 298.88
     rank  1: 239.39
     rank  2: 249.94
     rank  3: 247.95
     rank  4: 594.78
     rank  5: 550.79
     rank  6: 556.02
     rank  7: 558.43
     rank  8: 202.97
     rank  9: 195.72
     rank 10: 207.22
     rank 11: 189.93
  backward-send-forward-recv:
     rank  4: 0.71
     rank  5: 0.57
     rank  6: 0.48
     rank  7: 0.57
     rank  8: 3.77
     rank  9: 4.45
     rank 10: 2.72
     rank 11: 3.91
     rank 12: 10.76
     rank 13: 10.35
     rank 14: 11.36
     rank 15: 12.27
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.08
     rank 15: 0.04
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.08
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.07
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.07
     rank 13: 0.05
     rank 14: 0.13
     rank 15: 0.08
  all-grads-sync:
     rank  0: 247.44
     rank  1: 247.38
     rank  2: 247.42
     rank  3: 247.45
     rank  4: 60.97
     rank  5: 60.89
     rank  6: 60.93
     rank  7: 60.99
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.17
     rank  1: 0.21
     rank  2: 0.18
     rank  3: 0.18
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 30.57
     rank  1: 30.83
     rank  2: 30.54
     rank  3: 30.61
     rank  4: 7.49
     rank  5: 7.36
     rank  6: 7.36
     rank  7: 7.54
     rank  8: 0.05
     rank  9: 0.05
     rank 10: 0.05
     rank 11: 0.06
     rank 12: 0.04
     rank 13: 0.03
     rank 14: 0.06
     rank 15: 0.05
  optimizer:
     rank  0: 31.51
     rank  1: 31.73
     rank  2: 31.48
     rank  3: 31.55
     rank  4: 8.43
     rank  5: 8.30
     rank  6: 8.31
     rank  7: 8.48
     rank  8: 0.98
     rank  9: 0.97
     rank 10: 0.98
     rank 11: 0.99
     rank 12: 0.98
     rank 13: 0.96
     rank 14: 0.99
     rank 15: 0.99
 [2024-12-25 14:30:00] iteration        3/      10 | consumed samples:           48 | elapsed time per iteration (ms): 1647.6 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 7.018970E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 1589.46
     rank  1: 1589.45
     rank  2: 1589.52
     rank  3: 1589.55
     rank  4: 1587.32
     rank  5: 1587.30
     rank  6: 1587.32
     rank  7: 1587.36
     rank  8: 1586.77
     rank  9: 1586.82
     rank 10: 1586.77
     rank 11: 1586.81
     rank 12: 1586.68
     rank 13: 1586.68
     rank 14: 1586.73
     rank 15: 1586.75
  forward-compute:
     rank  0: 206.61
     rank  1: 248.87
     rank  2: 204.81
     rank  3: 208.70
     rank  4: 23.68
     rank  5: 22.66
     rank  6: 23.12
     rank  7: 23.97
     rank  8: 399.09
     rank  9: 407.89
     rank 10: 393.82
     rank 11: 397.82
     rank 12: 460.06
     rank 13: 440.66
     rank 14: 460.61
     rank 15: 461.10
  backward-compute:
     rank  0: 221.43
     rank  1: 215.66
     rank  2: 209.41
     rank  3: 228.87
     rank  4: 25.76
     rank  5: 25.07
     rank  6: 25.97
     rank  7: 26.50
     rank  8: 470.54
     rank  9: 467.78
     rank 10: 465.58
     rank 11: 469.21
     rank 12: 517.54
     rank 13: 526.66
     rank 14: 519.06
     rank 15: 515.25
  pure-backward-compute:
     rank  0: 221.21
     rank  1: 215.44
     rank  2: 209.25
     rank  3: 228.71
     rank  4: 25.57
     rank  5: 24.87
     rank  6: 25.74
     rank  7: 26.27
     rank  8: 470.07
     rank  9: 467.12
     rank 10: 465.25
     rank 11: 468.80
     rank 12: 516.89
     rank 13: 525.97
     rank 14: 518.27
     rank 15: 514.43
  batch-generator:
     rank  0: 12.88
     rank  1: 12.59
     rank  2: 11.39
     rank  3: 11.50
     rank  4: 11.88
     rank  5: 11.04
     rank  6: 11.52
     rank  7: 12.13
     rank  8: 14.08
     rank  9: 20.52
     rank 10: 13.52
     rank 11: 14.18
     rank 12: 15.12
     rank 13: 10.83
     rank 14: 15.30
     rank 15: 15.04
  forward-recv:
     rank  4: 96.67
     rank  5: 151.12
     rank  6: 94.99
     rank  7: 95.95
     rank  8: 58.60
     rank  9: 72.17
     rank 10: 55.86
     rank 11: 57.94
     rank 12: 159.27
     rank 13: 171.83
     rank 14: 155.32
     rank 15: 158.48
  forward-send:
     rank  0: 5.87
     rank  1: 1.15
     rank  2: 3.93
     rank  3: 4.13
     rank  4: 51.63
     rank  5: 34.70
     rank  6: 50.33
     rank  7: 51.55
     rank  8: 2.21
     rank  9: 1.77
     rank 10: 1.66
     rank 11: 2.09
  backward-recv:
     rank  0: 572.06
     rank  1: 573.45
     rank  2: 579.17
     rank  3: 566.00
     rank  4: 479.84
     rank  5: 479.69
     rank  6: 480.04
     rank  7: 473.09
     rank  8: 127.34
     rank  9: 127.08
     rank 10: 129.61
     rank 11: 126.84
  backward-send:
     rank  4: 0.97
     rank  5: 0.96
     rank  6: 1.00
     rank  7: 1.07
     rank  8: 3.45
     rank  9: 3.99
     rank 10: 2.07
     rank 11: 1.86
     rank 12: 3.65
     rank 13: 3.78
     rank 14: 3.96
     rank 15: 1.61
  forward-send-backward-recv:
     rank  0: 324.36
     rank  1: 290.67
     rank  2: 328.74
     rank  3: 325.44
     rank  4: 601.53
     rank  5: 565.73
     rank  6: 603.45
     rank  7: 601.88
     rank  8: 206.53
     rank  9: 186.46
     rank 10: 219.16
     rank 11: 206.48
  backward-send-forward-recv:
     rank  4: 0.60
     rank  5: 0.56
     rank  6: 0.51
     rank  7: 0.58
     rank  8: 3.91
     rank  9: 4.44
     rank 10: 3.14
     rank 11: 3.74
     rank 12: 12.15
     rank 13: 10.29
     rank 14: 13.81
     rank 15: 11.35
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.06
     rank 10: 0.03
     rank 11: 0.04
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.04
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.08
     rank  7: 0.08
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.07
     rank 13: 0.05
     rank 14: 0.07
     rank 15: 0.07
  all-grads-sync:
     rank  0: 249.88
     rank  1: 249.83
     rank  2: 249.92
     rank  3: 249.92
     rank  4: 61.14
     rank  5: 61.09
     rank  6: 61.10
     rank  7: 61.15
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.18
     rank  1: 0.18
     rank  2: 0.23
     rank  3: 0.23
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.03
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 30.43
     rank  1: 30.43
     rank  2: 30.71
     rank  3: 30.69
     rank  4: 7.39
     rank  5: 7.36
     rank  6: 7.47
     rank  7: 7.50
     rank  8: 0.05
     rank  9: 0.10
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.04
     rank 13: 0.03
     rank 14: 0.09
     rank 15: 0.05
  optimizer:
     rank  0: 31.38
     rank  1: 31.39
     rank  2: 31.66
     rank  3: 31.61
     rank  4: 8.35
     rank  5: 8.32
     rank  6: 8.43
     rank  7: 8.45
     rank  8: 1.00
     rank  9: 1.04
     rank 10: 0.99
     rank 11: 1.00
     rank 12: 1.00
     rank 13: 0.98
     rank 14: 1.04
     rank 15: 1.00
 [2024-12-25 14:30:01] iteration        4/      10 | consumed samples:           64 | elapsed time per iteration (ms): 1646.8 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 7.158314E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 1589.27
     rank  1: 1589.25
     rank  2: 1589.27
     rank  3: 1589.31
     rank  4: 1587.14
     rank  5: 1587.12
     rank  6: 1587.16
     rank  7: 1587.16
     rank  8: 1586.48
     rank  9: 1586.46
     rank 10: 1586.42
     rank 11: 1586.47
     rank 12: 1586.50
     rank 13: 1586.50
     rank 14: 1586.58
     rank 15: 1586.54
  forward-compute:
     rank  0: 212.25
     rank  1: 209.61
     rank  2: 215.02
     rank  3: 217.89
     rank  4: 23.75
     rank  5: 23.02
     rank  6: 23.43
     rank  7: 23.98
     rank  8: 398.49
     rank  9: 407.35
     rank 10: 393.00
     rank 11: 395.93
     rank 12: 458.00
     rank 13: 454.89
     rank 14: 449.59
     rank 15: 447.26
  backward-compute:
     rank  0: 219.07
     rank  1: 210.61
     rank  2: 211.37
     rank  3: 213.60
     rank  4: 26.54
     rank  5: 25.07
     rank  6: 25.32
     rank  7: 25.43
     rank  8: 470.40
     rank  9: 466.54
     rank 10: 465.25
     rank 11: 468.28
     rank 12: 517.71
     rank 13: 525.17
     rank 14: 522.99
     rank 15: 525.38
  pure-backward-compute:
     rank  0: 218.80
     rank  1: 210.46
     rank  2: 211.16
     rank  3: 213.36
     rank  4: 26.33
     rank  5: 24.87
     rank  6: 25.12
     rank  7: 25.23
     rank  8: 469.94
     rank  9: 466.01
     rank 10: 464.94
     rank 11: 467.89
     rank 12: 517.11
     rank 13: 524.47
     rank 14: 521.81
     rank 15: 524.17
  batch-generator:
     rank  0: 11.60
     rank  1: 11.55
     rank  2: 13.55
     rank  3: 13.10
     rank  4: 11.80
     rank  5: 11.27
     rank  6: 11.74
     rank  7: 12.11
     rank  8: 14.06
     rank  9: 20.46
     rank 10: 13.23
     rank 11: 12.66
     rank 12: 16.16
     rank 13: 11.86
     rank 14: 14.25
     rank 15: 15.27
  forward-recv:
     rank  4: 102.94
     rank  5: 102.25
     rank  6: 102.09
     rank  7: 104.86
     rank  8: 58.80
     rank  9: 57.14
     rank 10: 61.87
     rank 11: 63.20
     rank 12: 162.05
     rank 13: 157.86
     rank 14: 162.35
     rank 15: 163.52
  forward-send:
     rank  0: 1.98
     rank  1: 1.06
     rank  2: 1.40
     rank  3: 1.38
     rank  4: 48.93
     rank  5: 46.90
     rank  6: 49.92
     rank  7: 49.45
     rank  8: 2.79
     rank  9: 1.77
     rank 10: 3.09
     rank 11: 2.31
  backward-recv:
     rank  0: 573.98
     rank  1: 583.79
     rank  2: 584.42
     rank  3: 579.25
     rank  4: 480.07
     rank  5: 481.84
     rank  6: 480.11
     rank  7: 481.64
     rank  8: 128.06
     rank  9: 128.80
     rank 10: 128.58
     rank 11: 128.39
  backward-send:
     rank  4: 1.04
     rank  5: 0.95
     rank  6: 0.90
     rank  7: 1.01
     rank  8: 1.95
     rank  9: 3.34
     rank 10: 2.03
     rank 11: 3.14
     rank 12: 1.60
     rank 13: 3.28
     rank 14: 2.47
     rank 15: 3.33
  forward-send-backward-recv:
     rank  0: 324.92
     rank  1: 325.64
     rank  2: 320.49
     rank  3: 319.15
     rank  4: 592.40
     rank  5: 600.47
     rank  6: 595.92
     rank  7: 594.01
     rank  8: 204.09
     rank  9: 203.58
     rank 10: 213.50
     rank 11: 208.15
  backward-send-forward-recv:
     rank  4: 0.59
     rank  5: 0.54
     rank  6: 0.48
     rank  7: 0.61
     rank  8: 3.32
     rank  9: 3.78
     rank 10: 3.05
     rank 11: 3.67
     rank 12: 10.10
     rank 13: 13.02
     rank 14: 14.42
     rank 15: 14.00
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.04
     rank  7: 0.02
     rank  8: 0.05
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.05
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.06
     rank  5: 0.05
     rank  6: 0.07
     rank  7: 0.05
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.07
     rank 13: 0.05
     rank 14: 0.07
     rank 15: 0.07
  all-grads-sync:
     rank  0: 250.26
     rank  1: 250.22
     rank  2: 250.30
     rank  3: 250.30
     rank  4: 57.72
     rank  5: 57.71
     rank  6: 57.72
     rank  7: 57.70
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.03
  optimizer-copy-to-main-grad:
     rank  0: 0.17
     rank  1: 0.16
     rank  2: 0.19
     rank  3: 0.19
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 30.42
     rank  1: 30.53
     rank  2: 30.65
     rank  3: 30.53
     rank  4: 7.42
     rank  5: 7.36
     rank  6: 7.39
     rank  7: 7.38
     rank  8: 0.07
     rank  9: 0.05
     rank 10: 0.03
     rank 11: 0.04
     rank 12: 0.04
     rank 13: 0.03
     rank 14: 0.05
     rank 15: 0.10
  optimizer:
     rank  0: 31.09
     rank  1: 31.21
     rank  2: 31.29
     rank  3: 31.19
     rank  4: 8.10
     rank  5: 8.04
     rank  6: 8.06
     rank  7: 8.05
     rank  8: 0.74
     rank  9: 0.72
     rank 10: 0.70
     rank 11: 0.71
     rank 12: 0.73
     rank 13: 0.70
     rank 14: 0.72
     rank 15: 0.76
 [2024-12-25 14:30:03] iteration        5/      10 | consumed samples:           80 | elapsed time per iteration (ms): 1637.9 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 6.564245E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 1579.96
     rank  1: 1579.95
     rank  2: 1580.05
     rank  3: 1579.99
     rank  4: 1577.89
     rank  5: 1577.94
     rank  6: 1577.89
     rank  7: 1577.89
     rank  8: 1577.22
     rank  9: 1577.30
     rank 10: 1577.22
     rank 11: 1577.23
     rank 12: 1577.18
     rank 13: 1577.17
     rank 14: 1577.24
     rank 15: 1577.23
  forward-compute:
     rank  0: 218.20
     rank  1: 214.04
     rank  2: 208.58
     rank  3: 196.31
     rank  4: 22.79
     rank  5: 23.07
     rank  6: 24.37
     rank  7: 26.03
     rank  8: 396.39
     rank  9: 407.27
     rank 10: 396.00
     rank 11: 393.79
     rank 12: 456.61
     rank 13: 449.80
     rank 14: 447.07
     rank 15: 445.73
  backward-compute:
     rank  0: 208.58
     rank  1: 209.12
     rank  2: 196.34
     rank  3: 221.95
     rank  4: 25.92
     rank  5: 25.20
     rank  6: 25.74
     rank  7: 25.75
     rank  8: 469.28
     rank  9: 468.32
     rank 10: 464.07
     rank 11: 468.03
     rank 12: 516.89
     rank 13: 524.59
     rank 14: 525.10
     rank 15: 522.19
  pure-backward-compute:
     rank  0: 208.19
     rank  1: 208.90
     rank  2: 196.12
     rank  3: 221.73
     rank  4: 25.73
     rank  5: 25.01
     rank  6: 25.54
     rank  7: 25.54
     rank  8: 468.98
     rank  9: 467.75
     rank 10: 463.87
     rank 11: 467.75
     rank 12: 516.25
     rank 13: 523.98
     rank 14: 524.16
     rank 15: 521.38
  batch-generator:
     rank  0: 11.61
     rank  1: 11.64
     rank  2: 11.44
     rank  3: 11.02
     rank  4: 11.12
     rank  5: 11.46
     rank  6: 12.41
     rank  7: 12.10
     rank  8: 12.21
     rank  9: 19.15
     rank 10: 13.31
     rank 11: 11.76
     rank 12: 15.92
     rank 13: 12.16
     rank 14: 14.76
     rank 15: 13.29
  forward-recv:
     rank  4: 103.89
     rank  5: 102.08
     rank  6: 89.99
     rank  7: 91.48
     rank  8: 59.32
     rank  9: 57.42
     rank 10: 59.25
     rank 11: 59.30
     rank 12: 160.39
     rank 13: 158.34
     rank 14: 157.78
     rank 15: 160.15
  forward-send:
     rank  0: 1.26
     rank  1: 1.14
     rank  2: 14.17
     rank  3: 13.32
     rank  4: 49.32
     rank  5: 48.19
     rank  6: 57.40
     rank  7: 57.83
     rank  8: 3.29
     rank  9: 3.11
     rank 10: 3.30
     rank 11: 3.62
  backward-recv:
     rank  0: 580.03
     rank  1: 581.52
     rank  2: 590.01
     rank  3: 564.55
     rank  4: 478.69
     rank  5: 480.56
     rank  6: 480.49
     rank  7: 475.43
     rank  8: 130.85
     rank  9: 129.65
     rank 10: 129.12
     rank 11: 123.95
  backward-send:
     rank  4: 0.97
     rank  5: 0.87
     rank  6: 0.93
     rank  7: 0.96
     rank  8: 1.76
     rank  9: 2.53
     rank 10: 1.97
     rank 11: 2.10
     rank 12: 2.00
     rank 13: 2.76
     rank 14: 2.66
     rank 15: 1.85
  forward-send-backward-recv:
     rank  0: 312.74
     rank  1: 318.24
     rank  2: 309.61
     rank  3: 324.18
     rank  4: 588.41
     rank  5: 593.97
     rank  6: 593.47
     rank  7: 591.34
     rank  8: 198.32
     rank  9: 193.21
     rank 10: 208.64
     rank 11: 206.91
  backward-send-forward-recv:
     rank  4: 0.64
     rank  5: 0.66
     rank  6: 0.65
     rank  7: 0.79
     rank  8: 3.54
     rank  9: 4.67
     rank 10: 3.12
     rank 11: 3.92
     rank 12: 8.88
     rank 13: 12.92
     rank 14: 13.63
     rank 15: 13.65
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.08
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.02
     rank  9: 0.04
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.11
     rank  6: 0.06
     rank  7: 0.06
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.07
     rank 13: 0.05
     rank 14: 0.07
     rank 15: 0.07
  all-grads-sync:
     rank  0: 249.64
     rank  1: 249.60
     rank  2: 249.66
     rank  3: 249.67
     rank  4: 61.18
     rank  5: 61.12
     rank  6: 61.16
     rank  7: 61.20
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.03
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.18
     rank  1: 0.17
     rank  2: 0.24
     rank  3: 0.19
     rank  4: 0.02
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.03
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 30.42
     rank  1: 30.48
     rank  2: 30.78
     rank  3: 30.55
     rank  4: 7.40
     rank  5: 7.52
     rank  6: 7.44
     rank  7: 7.41
     rank  8: 0.04
     rank  9: 0.05
     rank 10: 0.03
     rank 11: 0.07
     rank 12: 0.04
     rank 13: 0.03
     rank 14: 0.09
     rank 15: 0.05
  optimizer:
     rank  0: 31.21
     rank  1: 31.28
     rank  2: 31.59
     rank  3: 31.31
     rank  4: 8.24
     rank  5: 8.31
     rank  6: 8.24
     rank  7: 8.21
     rank  8: 0.83
     rank  9: 0.84
     rank 10: 0.83
     rank 11: 0.86
     rank 12: 0.84
     rank 13: 0.82
     rank 14: 0.88
     rank 15: 0.84
 [2024-12-25 14:30:05] iteration        6/      10 | consumed samples:           96 | elapsed time per iteration (ms): 1646.0 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 5.751046E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 1588.80
     rank  1: 1588.80
     rank  2: 1588.86
     rank  3: 1589.03
     rank  4: 1586.65
     rank  5: 1586.64
     rank  6: 1586.67
     rank  7: 1586.68
     rank  8: 1586.21
     rank  9: 1586.41
     rank 10: 1586.19
     rank 11: 1586.20
     rank 12: 1586.02
     rank 13: 1586.02
     rank 14: 1586.04
     rank 15: 1586.11
  forward-compute:
     rank  0: 205.41
     rank  1: 201.22
     rank  2: 235.81
     rank  3: 210.13
     rank  4: 23.72
     rank  5: 23.47
     rank  6: 23.05
     rank  7: 23.51
     rank  8: 394.60
     rank  9: 407.54
     rank 10: 389.24
     rank 11: 392.79
     rank 12: 463.30
     rank 13: 470.31
     rank 14: 445.69
     rank 15: 463.31
  backward-compute:
     rank  0: 215.01
     rank  1: 230.07
     rank  2: 204.67
     rank  3: 213.64
     rank  4: 25.79
     rank  5: 25.22
     rank  6: 25.30
     rank  7: 26.13
     rank  8: 469.66
     rank  9: 468.49
     rank 10: 464.75
     rank 11: 467.57
     rank 12: 521.11
     rank 13: 517.81
     rank 14: 527.20
     rank 15: 521.86
  pure-backward-compute:
     rank  0: 214.78
     rank  1: 229.85
     rank  2: 204.51
     rank  3: 213.48
     rank  4: 25.59
     rank  5: 25.01
     rank  6: 25.09
     rank  7: 25.89
     rank  8: 469.34
     rank  9: 467.94
     rank 10: 464.48
     rank 11: 467.29
     rank 12: 520.51
     rank 13: 517.20
     rank 14: 526.46
     rank 15: 521.05
  batch-generator:
     rank  0: 11.00
     rank  1: 10.83
     rank  2: 14.05
     rank  3: 11.46
     rank  4: 11.71
     rank  5: 11.70
     rank  6: 11.44
     rank  7: 11.83
     rank  8: 10.60
     rank  9: 21.20
     rank 10: 10.46
     rank 11: 10.85
     rank 12: 14.12
     rank 13: 13.32
     rank 14: 13.92
     rank 15: 13.87
  forward-recv:
     rank  4: 97.10
     rank  5: 95.06
     rank  6: 131.11
     rank  7: 96.53
     rank  8: 58.24
     rank  9: 56.88
     rank 10: 74.29
     rank 11: 57.60
     rank 12: 158.47
     rank 13: 157.90
     rank 14: 171.92
     rank 15: 157.37
  forward-send:
     rank  0: 6.28
     rank  1: 7.79
     rank  2: 1.52
     rank  3: 2.76
     rank  4: 51.46
     rank  5: 52.24
     rank  6: 38.93
     rank  7: 50.30
     rank  8: 2.96
     rank  9: 3.52
     rank 10: 1.49
     rank 11: 2.95
  backward-recv:
     rank  0: 580.16
     rank  1: 569.17
     rank  2: 586.96
     rank  3: 583.43
     rank  4: 483.51
     rank  5: 485.12
     rank  6: 483.44
     rank  7: 483.40
     rank  8: 129.31
     rank  9: 128.08
     rank 10: 129.80
     rank 11: 128.98
  backward-send:
     rank  4: 0.91
     rank  5: 0.94
     rank  6: 0.89
     rank  7: 1.05
     rank  8: 4.27
     rank  9: 3.55
     rank 10: 3.55
     rank 11: 4.21
     rank 12: 4.51
     rank 13: 3.07
     rank 14: 4.60
     rank 15: 4.61
  forward-send-backward-recv:
     rank  0: 330.84
     rank  1: 331.44
     rank  2: 304.89
     rank  3: 328.77
     rank  4: 605.08
     rank  5: 602.77
     rank  6: 584.27
     rank  7: 607.25
     rank  8: 217.74
     rank  9: 205.01
     rank 10: 212.68
     rank 11: 221.90
  backward-send-forward-recv:
     rank  4: 0.64
     rank  5: 0.55
     rank  6: 0.61
     rank  7: 0.53
     rank  8: 3.88
     rank  9: 3.52
     rank 10: 3.24
     rank 11: 4.13
     rank 12: 13.66
     rank 13: 10.11
     rank 14: 11.64
     rank 15: 13.77
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.04
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.04
     rank  7: 0.04
     rank  8: 0.02
     rank  9: 0.08
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.10
     rank  7: 0.08
     rank  8: 0.02
     rank  9: 0.05
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.07
     rank 13: 0.05
     rank 14: 0.07
     rank 15: 0.08
  all-grads-sync:
     rank  0: 242.80
     rank  1: 242.76
     rank  2: 242.84
     rank  3: 242.82
     rank  4: 57.68
     rank  5: 57.68
     rank  6: 57.54
     rank  7: 57.67
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.03
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.17
     rank  1: 0.16
     rank  2: 0.20
     rank  3: 0.19
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.09
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.06
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 30.34
     rank  1: 30.43
     rank  2: 30.77
     rank  3: 30.66
     rank  4: 7.42
     rank  5: 7.36
     rank  6: 7.49
     rank  7: 7.48
     rank  8: 0.03
     rank  9: 0.40
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.04
     rank 13: 0.03
     rank 14: 0.04
     rank 15: 0.05
  optimizer:
     rank  0: 31.25
     rank  1: 31.35
     rank  2: 31.68
     rank  3: 31.51
     rank  4: 8.34
     rank  5: 8.27
     rank  6: 8.40
     rank  7: 8.39
     rank  8: 0.94
     rank  9: 1.31
     rank 10: 0.94
     rank 11: 0.94
     rank 12: 0.95
     rank 13: 0.94
     rank 14: 0.95
     rank 15: 0.95
 [2024-12-25 14:30:06] iteration        7/      10 | consumed samples:          112 | elapsed time per iteration (ms): 1643.6 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 5.798668E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 1587.12
     rank  1: 1587.12
     rank  2: 1587.17
     rank  3: 1587.15
     rank  4: 1585.01
     rank  5: 1584.98
     rank  6: 1585.00
     rank  7: 1585.00
     rank  8: 1584.64
     rank  9: 1584.74
     rank 10: 1584.63
     rank 11: 1584.64
     rank 12: 1584.35
     rank 13: 1584.35
     rank 14: 1584.44
     rank 15: 1584.37
  forward-compute:
     rank  0: 215.95
     rank  1: 212.81
     rank  2: 215.68
     rank  3: 221.69
     rank  4: 22.43
     rank  5: 22.18
     rank  6: 22.55
     rank  7: 23.83
     rank  8: 395.43
     rank  9: 409.39
     rank 10: 396.07
     rank 11: 392.81
     rank 12: 463.06
     rank 13: 445.22
     rank 14: 446.79
     rank 15: 449.99
  backward-compute:
     rank  0: 208.90
     rank  1: 224.64
     rank  2: 201.50
     rank  3: 226.19
     rank  4: 25.37
     rank  5: 25.21
     rank  6: 25.11
     rank  7: 25.33
     rank  8: 469.96
     rank  9: 468.89
     rank 10: 465.46
     rank 11: 469.61
     rank 12: 518.23
     rank 13: 529.05
     rank 14: 527.44
     rank 15: 523.55
  pure-backward-compute:
     rank  0: 208.74
     rank  1: 224.43
     rank  2: 201.35
     rank  3: 226.02
     rank  4: 25.17
     rank  5: 25.01
     rank  6: 24.91
     rank  7: 25.12
     rank  8: 469.61
     rank  9: 468.37
     rank 10: 465.25
     rank 11: 469.26
     rank 12: 517.60
     rank 13: 528.19
     rank 14: 526.70
     rank 15: 522.80
  batch-generator:
     rank  0: 11.57
     rank  1: 12.70
     rank  2: 12.68
     rank  3: 12.54
     rank  4: 10.81
     rank  5: 10.62
     rank  6: 10.82
     rank  7: 11.94
     rank  8: 11.44
     rank  9: 22.74
     rank 10: 13.08
     rank 11: 11.17
     rank 12: 16.18
     rank 13: 11.49
     rank 14: 13.83
     rank 15: 13.93
  forward-recv:
     rank  4: 109.20
     rank  5: 100.36
     rank  6: 100.30
     rank  7: 101.02
     rank  8: 56.88
     rank  9: 56.61
     rank 10: 60.74
     rank 11: 60.51
     rank 12: 155.00
     rank 13: 159.75
     rank 14: 159.61
     rank 15: 159.59
  forward-send:
     rank  0: 1.17
     rank  1: 1.06
     rank  2: 1.48
     rank  3: 1.38
     rank  4: 43.79
     rank  5: 50.44
     rank  6: 49.97
     rank  7: 49.33
     rank  8: 1.64
     rank  9: 4.44
     rank 10: 3.86
     rank 11: 3.84
  backward-recv:
     rank  0: 584.27
     rank  1: 573.79
     rank  2: 594.63
     rank  3: 573.89
     rank  4: 480.74
     rank  5: 480.57
     rank  6: 480.99
     rank  7: 482.10
     rank  8: 129.56
     rank  9: 127.96
     rank 10: 130.62
     rank 11: 126.99
  backward-send:
     rank  4: 0.99
     rank  5: 0.91
     rank  6: 0.93
     rank  7: 0.93
     rank  8: 1.85
     rank  9: 2.36
     rank 10: 2.23
     rank 11: 2.10
     rank 12: 1.84
     rank 13: 3.63
     rank 14: 3.44
     rank 15: 3.48
  forward-send-backward-recv:
     rank  0: 311.17
     rank  1: 319.53
     rank  2: 313.73
     rank  3: 307.13
     rank  4: 588.31
     rank  5: 594.75
     rank  6: 593.84
     rank  7: 590.90
     rank  8: 205.68
     rank  9: 191.60
     rank 10: 205.23
     rank 11: 207.84
  backward-send-forward-recv:
     rank  4: 0.63
     rank  5: 0.55
     rank  6: 0.53
     rank  7: 0.56
     rank  8: 2.73
     rank  9: 3.79
     rank 10: 2.25
     rank 11: 2.37
     rank 12: 6.66
     rank 13: 10.60
     rank 14: 11.16
     rank 15: 10.59
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.04
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.07
     rank 13: 0.05
     rank 14: 0.08
     rank 15: 0.07
  all-grads-sync:
     rank  0: 249.15
     rank  1: 249.11
     rank  2: 249.18
     rank  3: 249.19
     rank  4: 57.81
     rank  5: 57.83
     rank  6: 57.79
     rank  7: 57.79
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.17
     rank  1: 0.16
     rank  2: 0.18
     rank  3: 0.18
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.07
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 30.46
     rank  1: 30.45
     rank  2: 30.51
     rank  3: 30.59
     rank  4: 7.36
     rank  5: 7.37
     rank  6: 7.36
     rank  7: 7.38
     rank  8: 0.04
     rank  9: 0.10
     rank 10: 0.03
     rank 11: 0.04
     rank 12: 0.05
     rank 13: 0.05
     rank 14: 0.06
     rank 15: 0.06
  optimizer:
     rank  0: 31.18
     rank  1: 31.16
     rank  2: 31.21
     rank  3: 31.30
     rank  4: 8.08
     rank  5: 8.08
     rank  6: 8.08
     rank  7: 8.09
     rank  8: 0.74
     rank  9: 0.82
     rank 10: 0.71
     rank 11: 0.75
     rank 12: 0.75
     rank 13: 0.74
     rank 14: 0.77
     rank 15: 0.76
 [2024-12-25 14:30:08] iteration        8/      10 | consumed samples:          128 | elapsed time per iteration (ms): 1641.9 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 4.342718E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 1584.58
     rank  1: 1584.59
     rank  2: 1584.59
     rank  3: 1584.62
     rank  4: 1582.46
     rank  5: 1582.45
     rank  6: 1582.46
     rank  7: 1582.46
     rank  8: 1582.13
     rank  9: 1581.69
     rank 10: 1582.13
     rank 11: 1582.13
     rank 12: 1581.86
     rank 13: 1581.86
     rank 14: 1581.87
     rank 15: 1581.97
  forward-compute:
     rank  0: 215.12
     rank  1: 210.03
     rank  2: 201.93
     rank  3: 201.80
     rank  4: 23.76
     rank  5: 22.29
     rank  6: 21.60
     rank  7: 23.35
     rank  8: 396.36
     rank  9: 409.78
     rank 10: 394.12
     rank 11: 395.85
     rank 12: 459.26
     rank 13: 448.00
     rank 14: 446.90
     rank 15: 453.13
  backward-compute:
     rank  0: 215.40
     rank  1: 231.93
     rank  2: 209.88
     rank  3: 224.25
     rank  4: 25.93
     rank  5: 25.25
     rank  6: 25.22
     rank  7: 25.34
     rank  8: 471.91
     rank  9: 472.72
     rank 10: 465.81
     rank 11: 468.60
     rank 12: 520.86
     rank 13: 527.98
     rank 14: 526.37
     rank 15: 524.81
  pure-backward-compute:
     rank  0: 215.18
     rank  1: 231.65
     rank  2: 209.72
     rank  3: 224.08
     rank  4: 25.71
     rank  5: 25.05
     rank  6: 25.03
     rank  7: 25.10
     rank  8: 471.58
     rank  9: 472.11
     rank 10: 465.53
     rank 11: 468.30
     rank 12: 520.23
     rank 13: 527.30
     rank 14: 525.45
     rank 15: 523.71
  batch-generator:
     rank  0: 11.71
     rank  1: 11.30
     rank  2: 14.42
     rank  3: 11.19
     rank  4: 11.88
     rank  5: 10.65
     rank  6: 10.12
     rank  7: 11.71
     rank  8: 12.14
     rank  9: 22.45
     rank 10: 13.35
     rank 11: 13.67
     rank 12: 15.78
     rank 13: 11.46
     rank 14: 13.86
     rank 15: 14.61
  forward-recv:
     rank  4: 108.04
     rank  5: 101.01
     rank  6: 98.98
     rank  7: 94.43
     rank  8: 59.92
     rank  9: 58.05
     rank 10: 63.93
     rank 11: 58.27
     rank 12: 158.83
     rank 13: 160.15
     rank 14: 161.66
     rank 15: 156.85
  forward-send:
     rank  0: 1.31
     rank  1: 2.58
     rank  2: 10.29
     rank  3: 8.46
     rank  4: 43.90
     rank  5: 49.42
     rank  6: 53.08
     rank  7: 52.22
     rank  8: 1.56
     rank  9: 1.89
     rank 10: 1.58
     rank 11: 1.64
  backward-recv:
     rank  0: 580.15
     rank  1: 568.76
     rank  2: 586.31
     rank  3: 570.60
     rank  4: 485.32
     rank  5: 481.94
     rank  6: 482.31
     rank  7: 483.22
     rank  8: 132.91
     rank  9: 130.37
     rank 10: 130.87
     rank 11: 130.57
  backward-send:
     rank  4: 1.01
     rank  5: 0.84
     rank  6: 0.96
     rank  7: 0.84
     rank  8: 2.11
     rank  9: 2.34
     rank 10: 1.71
     rank 11: 1.76
     rank 12: 4.52
     rank 13: 4.64
     rank 14: 4.54
     rank 15: 4.94
  forward-send-backward-recv:
     rank  0: 317.49
     rank  1: 324.33
     rank  2: 322.45
     rank  3: 324.06
     rank  4: 591.13
     rank  5: 599.54
     rank  6: 595.33
     rank  7: 599.22
     rank  8: 204.14
     rank  9: 191.52
     rank 10: 208.28
     rank 11: 210.67
  backward-send-forward-recv:
     rank  4: 0.65
     rank  5: 0.57
     rank  6: 0.63
     rank  7: 0.55
     rank  8: 3.11
     rank  9: 4.01
     rank 10: 3.90
     rank 11: 3.86
     rank 12: 8.61
     rank 13: 12.57
     rank 14: 12.38
     rank 15: 12.94
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.06
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.27
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.06
     rank  5: 0.05
     rank  6: 0.10
     rank  7: 0.05
     rank  8: 0.02
     rank  9: 0.05
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.07
     rank 13: 0.05
     rank 14: 0.07
     rank 15: 0.09
  all-grads-sync:
     rank  0: 240.45
     rank  1: 240.43
     rank  2: 240.47
     rank  3: 240.47
     rank  4: 57.74
     rank  5: 57.72
     rank  6: 57.62
     rank  7: 57.72
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.03
  optimizer-copy-to-main-grad:
     rank  0: 0.17
     rank  1: 0.17
     rank  2: 0.19
     rank  3: 0.19
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.21
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.10
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.03
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 30.46
     rank  1: 30.49
     rank  2: 30.53
     rank  3: 30.53
     rank  4: 7.43
     rank  5: 7.35
     rank  6: 7.48
     rank  7: 7.36
     rank  8: 0.03
     rank  9: 0.71
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.04
     rank 13: 0.03
     rank 14: 0.04
     rank 15: 0.09
  optimizer:
     rank  0: 32.54
     rank  1: 32.57
     rank  2: 32.61
     rank  3: 32.59
     rank  4: 9.51
     rank  5: 9.44
     rank  6: 9.56
     rank  7: 9.44
     rank  8: 2.11
     rank  9: 2.83
     rank 10: 2.11
     rank 11: 2.11
     rank 12: 2.11
     rank 13: 2.10
     rank 14: 2.11
     rank 15: 2.17
 [2024-12-25 14:30:10] iteration        9/      10 | consumed samples:          144 | elapsed time per iteration (ms): 1630.9 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 3.387608E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 1573.47
     rank  1: 1573.49
     rank  2: 1573.50
     rank  3: 1573.56
     rank  4: 1571.35
     rank  5: 1571.32
     rank  6: 1571.34
     rank  7: 1571.35
     rank  8: 1570.73
     rank  9: 1570.80
     rank 10: 1570.77
     rank 11: 1570.73
     rank 12: 1570.76
     rank 13: 1570.75
     rank 14: 1570.85
     rank 15: 1570.78
  forward-compute:
     rank  0: 207.29
     rank  1: 204.41
     rank  2: 203.13
     rank  3: 206.97
     rank  4: 22.69
     rank  5: 22.00
     rank  6: 23.46
     rank  7: 22.80
     rank  8: 395.69
     rank  9: 409.53
     rank 10: 389.92
     rank 11: 397.55
     rank 12: 454.96
     rank 13: 444.40
     rank 14: 451.46
     rank 15: 454.79
  backward-compute:
     rank  0: 204.80
     rank  1: 221.41
     rank  2: 198.29
     rank  3: 222.46
     rank  4: 25.54
     rank  5: 25.29
     rank  6: 25.66
     rank  7: 25.33
     rank  8: 471.33
     rank  9: 468.73
     rank 10: 466.52
     rank 11: 469.86
     rank 12: 521.57
     rank 13: 529.61
     rank 14: 525.27
     rank 15: 524.31
  pure-backward-compute:
     rank  0: 204.59
     rank  1: 221.26
     rank  2: 198.13
     rank  3: 222.31
     rank  4: 25.35
     rank  5: 25.08
     rank  6: 25.45
     rank  7: 25.12
     rank  8: 470.97
     rank  9: 468.18
     rank 10: 466.24
     rank 11: 469.58
     rank 12: 520.92
     rank 13: 529.03
     rank 14: 524.44
     rank 15: 523.49
  batch-generator:
     rank  0: 11.50
     rank  1: 11.31
     rank  2: 11.34
     rank  3: 11.01
     rank  4: 11.04
     rank  5: 10.46
     rank  6: 11.64
     rank  7: 11.12
     rank  8: 11.01
     rank  9: 19.90
     rank 10: 11.00
     rank 11: 13.48
     rank 12: 14.87
     rank 13: 11.72
     rank 14: 13.94
     rank 15: 15.18
  forward-recv:
     rank  4: 100.50
     rank  5: 99.12
     rank  6: 94.35
     rank  7: 97.43
     rank  8: 60.04
     rank  9: 58.67
     rank 10: 56.89
     rank 11: 56.75
     rank 12: 158.94
     rank 13: 160.92
     rank 14: 154.79
     rank 15: 155.50
  forward-send:
     rank  0: 2.83
     rank  1: 6.95
     rank  2: 2.95
     rank  3: 1.15
     rank  4: 48.26
     rank  5: 51.90
     rank  6: 49.79
     rank  7: 48.67
     rank  8: 1.51
     rank  9: 1.89
     rank 10: 2.17
     rank 11: 2.30
  backward-recv:
     rank  0: 586.61
     rank  1: 571.79
     rank  2: 593.07
     rank  3: 575.56
     rank  4: 484.75
     rank  5: 483.36
     rank  6: 483.45
     rank  7: 483.76
     rank  8: 131.36
     rank  9: 128.84
     rank 10: 129.11
     rank 11: 129.27
  backward-send:
     rank  4: 0.93
     rank  5: 0.84
     rank  6: 0.96
     rank  7: 0.95
     rank  8: 2.51
     rank  9: 3.22
     rank 10: 3.09
     rank 11: 2.95
     rank 12: 3.62
     rank 13: 3.89
     rank 14: 4.13
     rank 15: 4.30
  forward-send-backward-recv:
     rank  0: 324.42
     rank  1: 322.43
     rank  2: 325.58
     rank  3: 320.92
     rank  4: 593.28
     rank  5: 594.96
     rank  6: 598.33
     rank  7: 598.01
     rank  8: 201.74
     rank  9: 192.54
     rank 10: 218.63
     rank 11: 208.48
  backward-send-forward-recv:
     rank  4: 0.55
     rank  5: 0.54
     rank  6: 0.51
     rank  7: 0.57
     rank  8: 4.27
     rank  9: 5.20
     rank 10: 2.32
     rank 11: 2.38
     rank 12: 9.53
     rank 13: 12.03
     rank 14: 13.01
     rank 15: 11.06
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.09
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.04
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.06
     rank 13: 0.05
     rank 14: 0.12
     rank 15: 0.07
  all-grads-sync:
     rank  0: 240.12
     rank  1: 240.12
     rank  2: 240.11
     rank  3: 240.13
     rank  4: 57.49
     rank  5: 57.53
     rank  6: 57.49
     rank  7: 57.49
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.04
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.17
     rank  1: 0.17
     rank  2: 0.18
     rank  3: 0.18
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.03
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 30.56
     rank  1: 30.67
     rank  2: 30.50
     rank  3: 30.47
     rank  4: 7.37
     rank  5: 7.36
     rank  6: 7.36
     rank  7: 7.36
     rank  8: 0.03
     rank  9: 0.04
     rank 10: 0.08
     rank 11: 0.03
     rank 12: 0.04
     rank 13: 0.03
     rank 14: 0.09
     rank 15: 0.05
  optimizer:
     rank  0: 31.33
     rank  1: 31.42
     rank  2: 31.26
     rank  3: 31.21
     rank  4: 8.15
     rank  5: 8.11
     rank  6: 8.12
     rank  7: 8.11
     rank  8: 0.78
     rank  9: 0.83
     rank 10: 0.83
     rank 11: 0.78
     rank 12: 0.79
     rank 13: 0.78
     rank 14: 0.84
     rank 15: 0.80
 [2024-12-25 14:30:11] iteration       10/      10 | consumed samples:          160 | elapsed time per iteration (ms): 1653.1 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 3.404236E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 1597.27
     rank  1: 1597.24
     rank  2: 1597.24
     rank  3: 1597.27
     rank  4: 1595.16
     rank  5: 1595.12
     rank  6: 1595.13
     rank  7: 1595.13
     rank  8: 1594.52
     rank  9: 1594.47
     rank 10: 1594.46
     rank 11: 1594.46
     rank 12: 1594.51
     rank 13: 1594.46
     rank 14: 1594.52
     rank 15: 1594.48
  forward-compute:
     rank  0: 208.23
     rank  1: 221.81
     rank  2: 208.55
     rank  3: 213.22
     rank  4: 22.99
     rank  5: 22.20
     rank  6: 22.57
     rank  7: 22.39
     rank  8: 398.46
     rank  9: 413.58
     rank 10: 398.38
     rank 11: 395.91
     rank 12: 477.65
     rank 13: 445.58
     rank 14: 473.76
     rank 15: 469.03
  backward-compute:
     rank  0: 210.67
     rank  1: 226.61
     rank  2: 201.36
     rank  3: 219.03
     rank  4: 26.34
     rank  5: 25.29
     rank  6: 25.56
     rank  7: 25.47
     rank  8: 471.68
     rank  9: 470.02
     rank 10: 467.60
     rank 11: 469.89
     rank 12: 515.45
     rank 13: 529.98
     rank 14: 519.87
     rank 15: 525.99
  pure-backward-compute:
     rank  0: 210.50
     rank  1: 226.43
     rank  2: 201.21
     rank  3: 218.88
     rank  4: 26.13
     rank  5: 25.10
     rank  6: 25.38
     rank  7: 25.24
     rank  8: 471.38
     rank  9: 469.54
     rank 10: 467.30
     rank 11: 469.60
     rank 12: 514.83
     rank 13: 529.26
     rank 14: 519.03
     rank 15: 525.27
  batch-generator:
     rank  0: 11.86
     rank  1: 11.85
     rank  2: 11.38
     rank  3: 11.44
     rank  4: 11.23
     rank  5: 10.64
     rank  6: 11.00
     rank  7: 10.79
     rank  8: 12.45
     rank  9: 22.11
     rank 10: 13.79
     rank 11: 10.90
     rank 12: 15.77
     rank 13: 11.96
     rank 14: 14.77
     rank 15: 14.26
  forward-recv:
     rank  4: 95.64
     rank  5: 109.99
     rank  6: 99.37
     rank  7: 101.75
     rank  8: 57.19
     rank  9: 71.99
     rank 10: 54.85
     rank 11: 56.61
     rank 12: 156.56
     rank 13: 176.48
     rank 14: 153.77
     rank 15: 155.40
  forward-send:
     rank  0: 2.50
     rank  1: 9.11
     rank  2: 1.38
     rank  3: 1.22
     rank  4: 50.38
     rank  5: 56.49
     rank  6: 46.97
     rank  7: 47.13
     rank  8: 1.94
     rank  9: 1.85
     rank 10: 1.58
     rank 11: 1.83
  backward-recv:
     rank  0: 582.62
     rank  1: 574.58
     rank  2: 589.46
     rank  3: 584.13
     rank  4: 480.13
     rank  5: 481.72
     rank  6: 482.25
     rank  7: 483.24
     rank  8: 129.71
     rank  9: 129.83
     rank 10: 127.70
     rank 11: 128.83
  backward-send:
     rank  4: 0.98
     rank  5: 0.82
     rank  6: 0.97
     rank  7: 0.92
     rank  8: 1.76
     rank  9: 2.89
     rank 10: 2.03
     rank 11: 2.25
     rank 12: 1.67
     rank 13: 3.24
     rank 14: 2.69
     rank 15: 3.24
  forward-send-backward-recv:
     rank  0: 332.43
     rank  1: 316.42
     rank  2: 332.49
     rank  3: 329.21
     rank  4: 609.55
     rank  5: 593.34
     rank  6: 609.35
     rank  7: 608.72
     rank  8: 213.68
     rank  9: 187.06
     rank 10: 224.41
     rank 11: 224.52
  backward-send-forward-recv:
     rank  4: 0.57
     rank  5: 0.53
     rank  6: 0.54
     rank  7: 0.56
     rank  8: 3.38
     rank  9: 3.16
     rank 10: 2.92
     rank 11: 2.54
     rank 12: 8.18
     rank 13: 8.03
     rank 14: 11.32
     rank 15: 9.75
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.04
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.06
     rank  9: 0.04
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.08
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.09
     rank 13: 0.05
     rank 14: 0.08
     rank 15: 0.07
  all-grads-sync:
     rank  0: 242.43
     rank  1: 242.39
     rank  2: 242.38
     rank  3: 242.40
     rank  4: 57.45
     rank  5: 57.45
     rank  6: 57.43
     rank  7: 57.43
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.04
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.17
     rank  1: 0.17
     rank  2: 0.18
     rank  3: 0.18
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 30.47
     rank  1: 30.46
     rank  2: 30.50
     rank  3: 30.53
     rank  4: 7.48
     rank  5: 7.34
     rank  6: 7.35
     rank  7: 7.38
     rank  8: 0.08
     rank  9: 0.08
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.04
     rank 13: 0.03
     rank 14: 0.05
     rank 15: 0.04
  optimizer:
     rank  0: 31.12
     rank  1: 31.13
     rank  2: 31.17
     rank  3: 31.19
     rank  4: 8.14
     rank  5: 8.01
     rank  6: 8.01
     rank  7: 8.04
     rank  8: 0.74
     rank  9: 0.76
     rank 10: 0.69
     rank 11: 0.69
     rank 12: 0.70
     rank 13: 0.68
     rank 14: 0.71
     rank 15: 0.70
