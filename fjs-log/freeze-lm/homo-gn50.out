examples/multimodal/pretrain-freeze-llm-homo.sh: line 4: activate: No such file or directory
[2024-12-24 22:58:59,837] torch.distributed.run: [WARNING] 
[2024-12-24 22:58:59,837] torch.distributed.run: [WARNING] *****************************************
[2024-12-24 22:58:59,837] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-12-24 22:58:59,837] torch.distributed.run: [WARNING] *****************************************
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
> setting tensorboard ...
WARNING: one_logger package is required to enable e2e metrics tracking. please go to https://confluence.nvidia.com/display/MLWFO/Package+Repositories for details to install it
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
---Rank 15---Tensor Parallel Group GPUs: [0]---Rank 14---Tensor Parallel Group GPUs: [0]

---Rank 15---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
---Rank 14---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
---Rank 13---Tensor Parallel Group GPUs: [0]
---Rank 13---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
---Rank 12---Tensor Parallel Group GPUs: [0]
[rank15]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
---Rank 12---Pipeline Parallel Group GPUs: [3, 3, 3, 3][rank14]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())

[rank13]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank12]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
 > number of parameters on (tensor, pipeline) model parallel rank (0, 3): 1006669824
rank=2, worker=0: shard_range=[pretrain-31.tar[0, 100), pretrain-31.tar[100, 200), pretrain-31.tar[200, 300), ...<619>, pretrain-37.tar[2200, 2300), pretrain-37.tar[2300, 2400), pretrain-37.tar[2400, 2500)] sum(count)=62500
rank=2, worker=1: shard_range=[pretrain-37.tar[2500, 2600), pretrain-37.tar[2600, 2700), pretrain-37.tar[2700, 2800), ...<619>, pretrain-42.tar[4700, 4800), pretrain-42.tar[4800, 4900), pretrain-42.tar[4900, 5000)] sum(count)=62500
rank=0, worker=0: shard_range=[pretrain-0.tar[0, 100), pretrain-0.tar[100, 200), pretrain-0.tar[200, 300), ...<619>, pretrain-14.tar[2200, 2300), pretrain-14.tar[2300, 2400), pretrain-14.tar[2400, 2500)] sum(count)=62500
rank=0, worker=1: shard_range=[pretrain-14.tar[2500, 2600), pretrain-14.tar[2600, 2700), pretrain-14.tar[2700, 2800), ...<619>, pretrain-2.tar[4700, 4800), pretrain-2.tar[4800, 4900), pretrain-2.tar[4900, 5000)] sum(count)=62500
rank=3, worker=0: shard_range=[pretrain-42.tar[5000, 5100), pretrain-42.tar[5100, 5200), pretrain-42.tar[5200, 5300), ...<619>, pretrain-48.tar[7200, 7300), pretrain-48.tar[7300, 7400), pretrain-48.tar[7400, 7500)] sum(count)=62500
rank=3, worker=1: shard_range=[pretrain-48.tar[7500, 7600), pretrain-48.tar[7600, 7700), pretrain-48.tar[7700, 7800), ...<619>, pretrain-53.tar[9700, 9800), pretrain-53.tar[9800, 9900), pretrain-53.tar[9900, 10000)] sum(count)=62500
rank=1, worker=0: shard_range=[pretrain-2.tar[5000, 5100), pretrain-2.tar[5100, 5200), pretrain-2.tar[5200, 5300), ...<619>, pretrain-25.tar[7200, 7300), pretrain-25.tar[7300, 7400), pretrain-25.tar[7400, 7500)] sum(count)=62500
rank=1, worker=1: shard_range=[pretrain-25.tar[7500, 7600), pretrain-25.tar[7600, 7700), pretrain-25.tar[7700, 7800), ...<619>, pretrain-30.tar[9700, 9800), pretrain-30.tar[9800, 9900), pretrain-30.tar[9900, 10000)] sum(count)=62500
rank=3, worker=0: shard_range=[pretrain-8.tar[5468, 10000), pretrain-9.tar[0, 2734)] sum(count)=7266
rank=3, worker=1: shard_range=[pretrain-9.tar[2734, 10000)] sum(count)=7266
rank=2, worker=0: shard_range=[pretrain-7.tar[936, 8202)] sum(count)=7266
rank=2, worker=1: shard_range=[pretrain-7.tar[8202, 10000), pretrain-8.tar[0, 5468)] sum(count)=7266
rank=1, worker=0: shard_range=[pretrain-55.tar[4532, 8128), pretrain-6.tar[0, 3670)] sum(count)=7266
rank=1, worker=1: shard_range=[pretrain-6.tar[3670, 10000), pretrain-7.tar[0, 936)] sum(count)=7266
rank=0, worker=0: shard_range=[pretrain-54.tar[0, 7266)] sum(count)=7266
rank=0, worker=1: shard_range=[pretrain-54.tar[7266, 10000), pretrain-55.tar[0, 4532)] sum(count)=7266
times across ranks (ms):
  model-and-optimizer-setup:
     rank  0: 98.69
     rank  1: 98.66
     rank  2: 100.25
     rank  3: 92.91
     rank  4: 24.85
     rank  5: 28.79
     rank  6: 21.70
     rank  7: 21.77
     rank  8: 27.75
     rank  9: 19.18
     rank 10: 26.26
     rank 11: 27.35
     rank 12: 29.99
     rank 13: 28.62
     rank 14: 27.51
     rank 15: 21.71
  train/valid/test-data-iterators-setup:
     rank  0: 1057.76
     rank  1: 1067.94
     rank  2: 1089.17
     rank  3: 1123.75
     rank  4: 1130.88
     rank  5: 1130.88
     rank  6: 1130.92
     rank  7: 1130.94
     rank  8: 1131.17
     rank  9: 1131.09
     rank 10: 1130.90
     rank 11: 1131.01
     rank 12: 1131.10
     rank 13: 1131.13
     rank 14: 1131.06
     rank 15: 1130.90
 [2024-12-24 22:59:35] iteration        1/      10 | consumed samples:           16 | elapsed time per iteration (ms): 13034.5 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 7.388188E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
stage4 GPU utialization:50.856035405939274 %
[Rank 12] (after 1 iterations) memory (MB) | allocated: 4016.3935546875 | max allocated: 5728.423828125 | reserved: 5914.0 | max reserved: 5914.0
times across ranks (ms):
  forward-backward:
     rank  0: 12865.91
     rank  1: 12866.05
     rank  2: 12866.05
     rank  3: 12865.98
     rank  4: 12986.27
     rank  5: 12986.29
     rank  6: 12986.25
     rank  7: 12986.30
     rank  8: 12979.48
     rank  9: 12979.40
     rank 10: 12979.52
     rank 11: 12979.49
     rank 12: 12862.22
     rank 13: 12862.27
     rank 14: 12862.29
     rank 15: 12862.33
  forward-compute:
     rank  0: 4040.02
     rank  1: 4318.86
     rank  2: 3723.11
     rank  3: 4030.00
     rank  4: 2418.89
     rank  5: 2271.67
     rank  6: 2183.32
     rank  7: 2414.95
     rank  8: 2601.05
     rank  9: 2655.24
     rank 10: 2523.91
     rank 11: 2568.51
     rank 12: 2681.49
     rank 13: 2539.24
     rank 14: 3350.23
     rank 15: 2773.35
  backward-compute:
     rank  0: 1078.36
     rank  1: 983.73
     rank  2: 1198.36
     rank  3: 1214.19
     rank  4: 397.64
     rank  5: 399.37
     rank  6: 399.95
     rank  7: 413.89
     rank  8: 369.93
     rank  9: 376.89
     rank 10: 385.78
     rank 11: 376.89
     rank 12: 426.45
     rank 13: 424.38
     rank 14: 418.39
     rank 15: 426.79
  pure-backward-compute:
     rank  0: 1077.95
     rank  1: 983.26
     rank  2: 1197.92
     rank  3: 1213.75
     rank  4: 397.17
     rank  5: 398.93
     rank  6: 399.51
     rank  7: 413.44
     rank  8: 369.54
     rank  9: 376.49
     rank 10: 385.36
     rank 11: 376.53
     rank 12: 425.80
     rank 13: 423.59
     rank 14: 417.70
     rank 15: 426.04
  batch-generator:
     rank  0: 996.51
     rank  1: 985.58
     rank  2: 1039.55
     rank  3: 1050.83
     rank  4: 943.30
     rank  5: 784.26
     rank  6: 951.53
     rank  7: 896.66
     rank  8: 949.96
     rank  9: 1020.63
     rank 10: 992.91
     rank 11: 979.59
     rank 12: 796.81
     rank 13: 961.32
     rank 14: 976.56
     rank 15: 935.37
  forward-recv:
     rank  4: 4009.39
     rank  5: 4272.91
     rank  6: 3696.57
     rank  7: 4003.18
     rank  8: 6130.70
     rank  9: 6246.65
     rank 10: 5579.09
     rank 11: 6097.98
     rank 12: 8472.12
     rank 13: 8618.12
     rank 14: 7815.02
     rank 15: 8381.76
  forward-send:
     rank  0: 4495.00
     rank  1: 4359.13
     rank  2: 4156.35
     rank  3: 4412.46
     rank  4: 2262.55
     rank  5: 2298.78
     rank  6: 2154.79
     rank  7: 2193.46
     rank  8: 46.13
     rank  9: 28.35
     rank 10: 30.47
     rank 11: 23.54
  backward-recv:
     rank  0: 66.21
     rank  1: 65.42
     rank  2: 68.37
     rank  3: 77.65
     rank  4: 3.46
     rank  5: 3.26
     rank  6: 3.29
     rank  7: 3.28
     rank  8: 1.67
     rank  9: 1.66
     rank 10: 1.66
     rank 11: 1.63
  backward-send:
     rank  4: 663.63
     rank  5: 569.51
     rank  6: 787.58
     rank  7: 797.33
     rank  8: 546.99
     rank  9: 453.25
     rank 10: 671.09
     rank 11: 694.66
     rank 12: 407.42
     rank 13: 317.22
     rank 14: 537.99
     rank 15: 554.19
  forward-send-backward-recv:
     rank  0: 2597.27
     rank  1: 2457.30
     rank  2: 3257.27
     rank  3: 2695.40
     rank  4: 2442.17
     rank  5: 2289.48
     rank  6: 3097.73
     rank  7: 2524.99
     rank  8: 2390.42
     rank  9: 2230.81
     rank 10: 3019.12
     rank 11: 2468.00
  backward-send-forward-recv:
     rank  4: 13.45
     rank  5: 16.27
     rank  6: 17.89
     rank  7: 15.24
     rank  8: 22.72
     rank  9: 26.26
     rank 10: 27.73
     rank 11: 30.26
     rank 12: 25.59
     rank 13: 24.22
     rank 14: 20.20
     rank 15: 24.11
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.04
     rank  3: 0.03
     rank  4: 0.04
     rank  5: 0.03
     rank  6: 0.04
     rank  7: 0.04
     rank  8: 0.03
     rank  9: 0.04
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.04
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.09
     rank  2: 0.10
     rank  3: 0.06
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.04
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.06
     rank 13: 0.08
     rank 14: 0.08
     rank 15: 0.08
  all-grads-sync:
     rank  0: 426.38
     rank  1: 426.46
     rank  2: 426.38
     rank  3: 426.28
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.23
     rank  1: 0.29
     rank  2: 0.28
     rank  3: 0.23
     rank  4: 0.03
     rank  5: 0.05
     rank  6: 0.04
     rank  7: 0.04
     rank  8: 0.06
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.05
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.04
     rank  5: 0.04
     rank  6: 0.04
     rank  7: 0.03
     rank  8: 0.04
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.04
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.03
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 41.59
     rank  1: 43.81
     rank  2: 43.69
     rank  3: 41.56
     rank  4: 0.15
     rank  5: 0.28
     rank  6: 0.14
     rank  7: 0.22
     rank  8: 0.15
     rank  9: 0.10
     rank 10: 0.08
     rank 11: 0.11
     rank 12: 0.07
     rank 13: 0.13
     rank 14: 0.11
     rank 15: 0.13
  optimizer:
     rank  0: 42.98
     rank  1: 45.21
     rank  2: 45.09
     rank  3: 42.94
     rank  4: 1.54
     rank  5: 1.68
     rank  6: 1.53
     rank  7: 1.57
     rank  8: 1.53
     rank  9: 2.15
     rank 10: 1.47
     rank 11: 1.50
     rank 12: 1.46
     rank 13: 1.51
     rank 14: 1.41
     rank 15: 1.53
 [2024-12-24 22:59:37] iteration        2/      10 | consumed samples:           32 | elapsed time per iteration (ms): 1852.6 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 7.108107E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 1786.02
     rank  1: 1786.07
     rank  2: 1786.03
     rank  3: 1786.03
     rank  4: 1782.27
     rank  5: 1782.27
     rank  6: 1782.27
     rank  7: 1782.33
     rank  8: 1782.81
     rank  9: 1782.84
     rank 10: 1782.83
     rank 11: 1783.06
     rank 12: 1782.39
     rank 13: 1782.40
     rank 14: 1782.43
     rank 15: 1782.52
  forward-compute:
     rank  0: 228.23
     rank  1: 264.66
     rank  2: 273.83
     rank  3: 227.20
     rank  4: 440.64
     rank  5: 443.20
     rank  6: 440.61
     rank  7: 462.79
     rank  8: 402.48
     rank  9: 409.21
     rank 10: 427.91
     rank 11: 415.48
     rank 12: 506.85
     rank 13: 489.16
     rank 14: 486.12
     rank 15: 491.24
  backward-compute:
     rank  0: 266.25
     rank  1: 261.44
     rank  2: 257.84
     rank  3: 260.15
     rank  4: 385.13
     rank  5: 386.85
     rank  6: 385.35
     rank  7: 400.73
     rank  8: 365.52
     rank  9: 371.61
     rank 10: 381.73
     rank 11: 374.42
     rank 12: 426.05
     rank 13: 429.13
     rank 14: 426.14
     rank 15: 432.67
  pure-backward-compute:
     rank  0: 266.10
     rank  1: 261.26
     rank  2: 257.46
     rank  3: 260.00
     rank  4: 384.72
     rank  5: 386.58
     rank  6: 384.88
     rank  7: 400.46
     rank  8: 365.12
     rank  9: 371.21
     rank 10: 381.18
     rank 11: 374.07
     rank 12: 425.36
     rank 13: 428.33
     rank 14: 425.37
     rank 15: 431.64
  batch-generator:
     rank  0: 12.57
     rank  1: 13.81
     rank  2: 14.47
     rank  3: 13.43
     rank  4: 13.11
     rank  5: 12.91
     rank  6: 12.92
     rank  7: 13.14
     rank  8: 13.42
     rank  9: 11.45
     rank 10: 14.99
     rank 11: 13.85
     rank 12: 13.69
     rank 13: 13.47
     rank 14: 17.88
     rank 15: 14.20
  forward-recv:
     rank  4: 52.07
     rank  5: 61.22
     rank  6: 62.00
     rank  7: 52.13
     rank  8: 172.27
     rank  9: 183.03
     rank 10: 175.17
     rank 11: 182.25
     rank 12: 260.14
     rank 13: 272.53
     rank 14: 279.37
     rank 15: 269.15
  forward-send:
     rank  0: 119.34
     rank  1: 105.76
     rank  2: 107.34
     rank  3: 133.08
     rank  4: 3.24
     rank  5: 5.14
     rank  6: 4.60
     rank  7: 3.48
     rank  8: 1.67
     rank  9: 1.52
     rank 10: 1.54
     rank 11: 1.61
  backward-recv:
     rank  0: 506.87
     rank  1: 502.90
     rank  2: 500.08
     rank  3: 503.74
     rank  4: 271.81
     rank  5: 268.69
     rank  6: 267.52
     rank  7: 261.31
     rank  8: 137.36
     rank  9: 135.56
     rank 10: 135.75
     rank 11: 136.02
  backward-send:
     rank  4: 2.85
     rank  5: 2.71
     rank  6: 3.05
     rank  7: 2.79
     rank  8: 4.27
     rank  9: 5.71
     rank 10: 4.82
     rank 11: 4.60
     rank 12: 2.87
     rank 13: 3.35
     rank 14: 1.65
     rank 15: 3.05
  forward-send-backward-recv:
     rank  0: 347.04
     rank  1: 331.44
     rank  2: 324.14
     rank  3: 345.92
     rank  4: 243.52
     rank  5: 232.73
     rank  6: 236.82
     rank  7: 221.26
     rank  8: 215.36
     rank  9: 192.62
     rank 10: 172.59
     rank 11: 186.58
  backward-send-forward-recv:
     rank  4: 1.39
     rank  5: 1.50
     rank  6: 1.42
     rank  7: 1.47
     rank  8: 3.99
     rank  9: 5.88
     rank 10: 4.70
     rank 11: 5.60
     rank 12: 12.67
     rank 13: 14.99
     rank 14: 11.99
     rank 15: 13.44
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.09
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.06
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.05
     rank  2: 0.06
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.07
     rank 12: 0.05
     rank 13: 0.07
     rank 14: 0.07
     rank 15: 0.14
  all-grads-sync:
     rank  0: 307.98
     rank  1: 308.03
     rank  2: 307.92
     rank  3: 307.85
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.05
  optimizer-copy-to-main-grad:
     rank  0: 0.18
     rank  1: 0.20
     rank  2: 0.23
     rank  3: 0.18
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 37.61
     rank  1: 38.25
     rank  2: 38.06
     rank  3: 37.75
     rank  4: 0.04
     rank  5: 0.04
     rank  6: 0.04
     rank  7: 0.05
     rank  8: 0.04
     rank  9: 0.07
     rank 10: 0.10
     rank 11: 0.04
     rank 12: 0.06
     rank 13: 0.04
     rank 14: 0.09
     rank 15: 0.11
  optimizer:
     rank  0: 38.45
     rank  1: 39.13
     rank  2: 38.89
     rank  3: 38.59
     rank  4: 0.88
     rank  5: 0.88
     rank  6: 0.88
     rank  7: 0.88
     rank  8: 0.88
     rank  9: 0.91
     rank 10: 0.94
     rank 11: 0.89
     rank 12: 0.90
     rank 13: 0.88
     rank 14: 0.92
     rank 15: 0.94
 [2024-12-24 22:59:39] iteration        3/      10 | consumed samples:           48 | elapsed time per iteration (ms): 1831.2 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 7.098954E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 1766.61
     rank  1: 1766.67
     rank  2: 1766.60
     rank  3: 1766.61
     rank  4: 1763.12
     rank  5: 1763.13
     rank  6: 1763.12
     rank  7: 1763.11
     rank  8: 1763.16
     rank  9: 1763.18
     rank 10: 1763.39
     rank 11: 1763.15
     rank 12: 1763.14
     rank 13: 1763.20
     rank 14: 1763.14
     rank 15: 1763.14
  forward-compute:
     rank  0: 204.25
     rank  1: 196.41
     rank  2: 238.44
     rank  3: 202.92
     rank  4: 436.05
     rank  5: 444.81
     rank  6: 443.49
     rank  7: 457.79
     rank  8: 406.40
     rank  9: 407.74
     rank 10: 427.28
     rank 11: 419.15
     rank 12: 494.92
     rank 13: 491.55
     rank 14: 489.85
     rank 15: 481.65
  backward-compute:
     rank  0: 266.41
     rank  1: 257.15
     rank  2: 252.84
     rank  3: 259.94
     rank  4: 384.98
     rank  5: 386.24
     rank  6: 393.34
     rank  7: 401.75
     rank  8: 366.74
     rank  9: 372.09
     rank 10: 384.94
     rank 11: 377.74
     rank 12: 429.66
     rank 13: 429.97
     rank 14: 425.30
     rank 15: 434.99
  pure-backward-compute:
     rank  0: 266.26
     rank  1: 257.00
     rank  2: 252.63
     rank  3: 259.73
     rank  4: 384.63
     rank  5: 386.05
     rank  6: 392.96
     rank  7: 401.56
     rank  8: 366.40
     rank  9: 371.73
     rank 10: 384.59
     rank 11: 377.23
     rank 12: 428.82
     rank 13: 429.21
     rank 14: 424.64
     rank 15: 434.07
  batch-generator:
     rank  0: 13.29
     rank  1: 15.29
     rank  2: 16.62
     rank  3: 12.30
     rank  4: 10.72
     rank  5: 12.54
     rank  6: 12.95
     rank  7: 11.69
     rank  8: 14.54
     rank  9: 12.06
     rank 10: 14.38
     rank 11: 14.97
     rank 12: 13.72
     rank 13: 14.84
     rank 14: 15.73
     rank 15: 14.77
  forward-recv:
     rank  4: 52.52
     rank  5: 49.50
     rank  6: 59.62
     rank  7: 52.39
     rank  8: 168.53
     rank  9: 170.20
     rank 10: 173.27
     rank 11: 176.71
     rank 12: 264.08
     rank 13: 264.01
     rank 14: 274.03
     rank 15: 271.60
  forward-send:
     rank  0: 121.30
     rank  1: 130.12
     rank  2: 99.18
     rank  3: 132.98
     rank  4: 3.82
     rank  5: 3.75
     rank  6: 3.06
     rank  7: 3.10
     rank  8: 2.78
     rank  9: 2.80
     rank 10: 1.53
     rank 11: 1.75
  backward-recv:
     rank  0: 504.56
     rank  1: 505.69
     rank  2: 503.84
     rank  3: 499.42
     rank  4: 273.98
     rank  5: 267.11
     rank  6: 264.91
     rank  7: 259.72
     rank  8: 139.61
     rank  9: 135.73
     rank 10: 135.50
     rank 11: 136.10
  backward-send:
     rank  4: 2.79
     rank  5: 2.60
     rank  6: 3.14
     rank  7: 2.66
     rank  8: 5.25
     rank  9: 3.96
     rank 10: 4.99
     rank 11: 4.42
     rank 12: 3.03
     rank 13: 2.71
     rank 14: 1.57
     rank 15: 3.24
  forward-send-backward-recv:
     rank  0: 367.02
     rank  1: 368.56
     rank  2: 364.98
     rank  3: 368.38
     rank  4: 241.83
     rank  5: 239.50
     rank  6: 228.88
     rank  7: 222.16
     rank  8: 205.40
     rank  9: 199.40
     rank 10: 164.91
     rank 11: 177.82
  backward-send-forward-recv:
     rank  4: 1.49
     rank  5: 1.27
     rank  6: 1.23
     rank  7: 1.28
     rank  8: 4.17
     rank  9: 5.39
     rank 10: 6.39
     rank 11: 6.67
     rank 12: 12.45
     rank 13: 13.85
     rank 14: 8.41
     rank 15: 11.76
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.05
     rank 11: 0.04
     rank 12: 0.03
     rank 13: 0.05
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.05
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.06
     rank 13: 0.12
     rank 14: 0.08
     rank 15: 0.07
  all-grads-sync:
     rank  0: 295.35
     rank  1: 295.49
     rank  2: 295.42
     rank  3: 295.28
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.17
     rank  1: 0.18
     rank  2: 0.17
     rank  3: 0.17
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 37.63
     rank  1: 37.72
     rank  2: 37.60
     rank  3: 37.63
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.04
     rank  7: 0.03
     rank  8: 0.09
     rank  9: 0.04
     rank 10: 0.06
     rank 11: 0.09
     rank 12: 0.04
     rank 13: 0.10
     rank 14: 0.06
     rank 15: 0.04
  optimizer:
     rank  0: 38.45
     rank  1: 38.45
     rank  2: 38.37
     rank  3: 38.39
     rank  4: 0.79
     rank  5: 0.79
     rank  6: 0.80
     rank  7: 0.79
     rank  8: 0.85
     rank  9: 0.80
     rank 10: 0.82
     rank 11: 0.84
     rank 12: 0.79
     rank 13: 0.85
     rank 14: 0.82
     rank 15: 0.80
 [2024-12-24 22:59:41] iteration        4/      10 | consumed samples:           64 | elapsed time per iteration (ms): 1832.2 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 7.136047E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 1767.79
     rank  1: 1767.68
     rank  2: 1767.68
     rank  3: 1767.67
     rank  4: 1764.21
     rank  5: 1764.19
     rank  6: 1764.19
     rank  7: 1764.20
     rank  8: 1764.28
     rank  9: 1764.25
     rank 10: 1764.25
     rank 11: 1764.25
     rank 12: 1764.23
     rank 13: 1764.04
     rank 14: 1764.24
     rank 15: 1764.22
  forward-compute:
     rank  0: 261.90
     rank  1: 208.85
     rank  2: 187.18
     rank  3: 202.48
     rank  4: 435.95
     rank  5: 441.68
     rank  6: 454.66
     rank  7: 456.43
     rank  8: 410.85
     rank  9: 410.20
     rank 10: 426.56
     rank 11: 420.64
     rank 12: 491.35
     rank 13: 480.57
     rank 14: 497.47
     rank 15: 482.11
  backward-compute:
     rank  0: 269.69
     rank  1: 260.44
     rank  2: 254.76
     rank  3: 262.06
     rank  4: 384.40
     rank  5: 387.88
     rank  6: 395.47
     rank  7: 398.61
     rank  8: 366.56
     rank  9: 375.82
     rank 10: 381.14
     rank 11: 377.02
     rank 12: 428.54
     rank 13: 432.90
     rank 14: 423.69
     rank 15: 435.62
  pure-backward-compute:
     rank  0: 269.17
     rank  1: 260.24
     rank  2: 254.60
     rank  3: 261.84
     rank  4: 384.12
     rank  5: 387.64
     rank  6: 395.17
     rank  7: 398.41
     rank  8: 366.17
     rank  9: 375.56
     rank 10: 380.71
     rank 11: 376.58
     rank 12: 427.82
     rank 13: 432.24
     rank 14: 423.06
     rank 15: 434.65
  batch-generator:
     rank  0: 15.68
     rank  1: 13.11
     rank  2: 11.48
     rank  3: 12.18
     rank  4: 10.52
     rank  5: 10.86
     rank  6: 15.51
     rank  7: 10.38
     rank  8: 17.94
     rank  9: 11.26
     rank 10: 15.84
     rank 11: 14.64
     rank 12: 11.39
     rank 13: 14.45
     rank 14: 16.23
     rank 15: 11.09
  forward-recv:
     rank  4: 52.77
     rank  5: 62.07
     rank  6: 47.97
     rank  7: 52.51
     rank  8: 164.24
     rank  9: 181.42
     rank 10: 166.13
     rank 11: 175.94
     rank 12: 266.54
     rank 13: 271.90
     rank 14: 267.06
     rank 15: 270.60
  forward-send:
     rank  0: 91.00
     rank  1: 125.34
     rank  2: 137.22
     rank  3: 132.31
     rank  4: 3.50
     rank  5: 3.11
     rank  6: 3.25
     rank  7: 3.15
     rank  8: 2.25
     rank  9: 1.65
     rank 10: 2.41
     rank 11: 1.72
  backward-recv:
     rank  0: 491.28
     rank  1: 500.08
     rank  2: 504.14
     rank  3: 500.79
     rank  4: 268.97
     rank  5: 269.30
     rank  6: 261.76
     rank  7: 262.23
     rank  8: 137.16
     rank  9: 135.83
     rank 10: 136.58
     rank 11: 135.69
  backward-send:
     rank  4: 2.62
     rank  5: 2.65
     rank  6: 2.81
     rank  7: 2.61
     rank  8: 3.12
     rank  9: 4.64
     rank 10: 3.28
     rank 11: 4.74
     rank 12: 2.31
     rank 13: 2.86
     rank 14: 1.64
     rank 15: 2.14
  forward-send-backward-recv:
     rank  0: 338.96
     rank  1: 364.99
     rank  2: 373.90
     rank  3: 366.86
     rank  4: 240.58
     rank  5: 228.20
     rank  6: 226.54
     rank  7: 222.16
     rank  8: 204.70
     rank  9: 184.06
     rank 10: 173.63
     rank 11: 176.76
  backward-send-forward-recv:
     rank  4: 1.32
     rank  5: 1.43
     rank  6: 1.32
     rank  7: 1.40
     rank  8: 4.20
     rank  9: 5.56
     rank 10: 4.32
     rank 11: 5.71
     rank 12: 11.51
     rank 13: 12.46
     rank 14: 7.92
     rank 15: 11.59
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.06
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.09
     rank  1: 0.05
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.05
     rank 13: 0.07
     rank 14: 0.07
     rank 15: 0.06
  all-grads-sync:
     rank  0: 295.71
     rank  1: 295.91
     rank  2: 295.84
     rank  3: 295.65
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.04
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.25
     rank  1: 0.18
     rank  2: 0.18
     rank  3: 0.18
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 38.10
     rank  1: 37.66
     rank  2: 37.64
     rank  3: 37.61
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.04
     rank  7: 0.07
     rank  8: 0.04
     rank  9: 0.07
     rank 10: 0.09
     rank 11: 0.09
     rank 12: 0.04
     rank 13: 0.05
     rank 14: 0.04
     rank 15: 0.04
  optimizer:
     rank  0: 38.91
     rank  1: 38.51
     rank  2: 38.49
     rank  3: 38.46
     rank  4: 0.88
     rank  5: 0.88
     rank  6: 0.90
     rank  7: 0.92
     rank  8: 0.89
     rank  9: 0.92
     rank 10: 0.93
     rank 11: 0.94
     rank 12: 0.88
     rank 13: 0.90
     rank 14: 0.89
     rank 15: 0.88
 [2024-12-24 22:59:42] iteration        5/      10 | consumed samples:           80 | elapsed time per iteration (ms): 1848.2 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 6.751261E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 1783.02
     rank  1: 1782.91
     rank  2: 1782.89
     rank  3: 1782.90
     rank  4: 1779.34
     rank  5: 1779.32
     rank  6: 1779.32
     rank  7: 1779.32
     rank  8: 1779.34
     rank  9: 1779.33
     rank 10: 1779.37
     rank 11: 1779.34
     rank 12: 1777.58
     rank 13: 1777.59
     rank 14: 1777.63
     rank 15: 1777.58
  forward-compute:
     rank  0: 249.71
     rank  1: 209.88
     rank  2: 188.62
     rank  3: 203.29
     rank  4: 434.28
     rank  5: 443.36
     rank  6: 452.42
     rank  7: 456.68
     rank  8: 403.90
     rank  9: 416.87
     rank 10: 429.06
     rank 11: 414.27
     rank 12: 482.70
     rank 13: 481.48
     rank 14: 506.75
     rank 15: 487.81
  backward-compute:
     rank  0: 265.46
     rank  1: 263.28
     rank  2: 257.61
     rank  3: 259.59
     rank  4: 384.46
     rank  5: 386.40
     rank  6: 395.58
     rank  7: 398.74
     rank  8: 365.75
     rank  9: 374.95
     rank 10: 382.64
     rank 11: 373.90
     rank 12: 432.05
     rank 13: 432.65
     rank 14: 422.41
     rank 15: 436.68
  pure-backward-compute:
     rank  0: 265.03
     rank  1: 263.08
     rank  2: 257.44
     rank  3: 259.38
     rank  4: 384.06
     rank  5: 386.15
     rank  6: 395.29
     rank  7: 398.54
     rank  8: 365.43
     rank  9: 374.63
     rank 10: 382.18
     rank 11: 373.55
     rank 12: 431.36
     rank 13: 431.95
     rank 14: 421.79
     rank 15: 435.84
  batch-generator:
     rank  0: 15.88
     rank  1: 13.46
     rank  2: 11.42
     rank  3: 11.74
     rank  4: 11.10
     rank  5: 10.84
     rank  6: 14.68
     rank  7: 11.35
     rank  8: 12.98
     rank  9: 11.91
     rank 10: 16.04
     rank 11: 13.38
     rank 12: 12.31
     rank 13: 13.59
     rank 14: 16.35
     rank 15: 13.16
  forward-recv:
     rank  4: 65.93
     rank  5: 62.92
     rank  6: 49.37
     rank  7: 51.58
     rank  8: 181.92
     rank  9: 181.42
     rank 10: 168.02
     rank 11: 178.45
     rank 12: 275.09
     rank 13: 276.03
     rank 14: 266.99
     rank 15: 268.88
  forward-send:
     rank  0: 98.71
     rank  1: 127.05
     rank  2: 137.08
     rank  3: 133.76
     rank  4: 3.74
     rank  5: 3.11
     rank  6: 3.20
     rank  7: 3.45
     rank  8: 1.72
     rank  9: 1.87
     rank 10: 1.67
     rank 11: 1.65
  backward-recv:
     rank  0: 495.31
     rank  1: 500.36
     rank  2: 505.58
     rank  3: 505.95
     rank  4: 266.63
     rank  5: 267.68
     rank  6: 265.04
     rank  7: 264.60
     rank  8: 136.62
     rank  9: 136.13
     rank 10: 136.65
     rank 11: 136.05
  backward-send:
     rank  4: 2.93
     rank  5: 2.99
     rank  6: 2.81
     rank  7: 2.58
     rank  8: 3.53
     rank  9: 4.90
     rank 10: 3.04
     rank 11: 4.61
     rank 12: 2.41
     rank 13: 2.87
     rank 14: 1.57
     rank 15: 1.99
  forward-send-backward-recv:
     rank  0: 350.18
     rank  1: 365.21
     rank  2: 376.34
     rank  3: 367.94
     rank  4: 235.80
     rank  5: 232.19
     rank  6: 228.93
     rank  7: 225.74
     rank  8: 199.99
     rank  9: 182.26
     rank 10: 173.73
     rank 11: 189.22
  backward-send-forward-recv:
     rank  4: 1.26
     rank  5: 1.74
     rank  6: 2.00
     rank  7: 1.35
     rank  8: 5.40
     rank  9: 5.44
     rank 10: 5.22
     rank 11: 5.76
     rank 12: 13.83
     rank 13: 13.60
     rank 14: 5.74
     rank 15: 12.26
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.10
     rank  1: 0.05
     rank  2: 0.04
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.06
     rank 13: 0.07
     rank 14: 0.07
     rank 15: 0.06
  all-grads-sync:
     rank  0: 303.26
     rank  1: 303.39
     rank  2: 303.32
     rank  3: 303.18
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.05
     rank 15: 0.01
  optimizer-copy-to-main-grad:
     rank  0: 0.23
     rank  1: 0.19
     rank  2: 0.18
     rank  3: 0.18
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 37.93
     rank  1: 37.69
     rank  2: 37.65
     rank  3: 37.68
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.04
     rank  7: 0.04
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.09
     rank 11: 0.05
     rank 12: 0.06
     rank 13: 0.05
     rank 14: 0.04
     rank 15: 0.07
  optimizer:
     rank  0: 38.73
     rank  1: 38.51
     rank  2: 38.46
     rank  3: 38.49
     rank  4: 0.84
     rank  5: 0.84
     rank  6: 0.86
     rank  7: 0.85
     rank  8: 0.85
     rank  9: 0.85
     rank 10: 0.91
     rank 11: 0.86
     rank 12: 0.88
     rank 13: 0.86
     rank 14: 0.86
     rank 15: 0.88
 [2024-12-24 22:59:44] iteration        6/      10 | consumed samples:           96 | elapsed time per iteration (ms): 1838.2 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 6.212509E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 1773.53
     rank  1: 1773.58
     rank  2: 1773.55
     rank  3: 1773.54
     rank  4: 1770.08
     rank  5: 1770.14
     rank  6: 1770.06
     rank  7: 1770.06
     rank  8: 1770.45
     rank  9: 1770.46
     rank 10: 1770.50
     rank 11: 1770.79
     rank 12: 1769.94
     rank 13: 1769.97
     rank 14: 1769.92
     rank 15: 1769.93
  forward-compute:
     rank  0: 249.40
     rank  1: 193.00
     rank  2: 188.00
     rank  3: 205.32
     rank  4: 440.38
     rank  5: 442.11
     rank  6: 453.54
     rank  7: 457.33
     rank  8: 401.26
     rank  9: 414.84
     rank 10: 424.48
     rank 11: 421.72
     rank 12: 478.98
     rank 13: 497.01
     rank 14: 505.37
     rank 15: 485.09
  backward-compute:
     rank  0: 265.06
     rank  1: 263.80
     rank  2: 257.90
     rank  3: 260.01
     rank  4: 386.34
     rank  5: 387.43
     rank  6: 393.74
     rank  7: 400.42
     rank  8: 367.66
     rank  9: 375.43
     rank 10: 383.16
     rank 11: 378.09
     rank 12: 432.88
     rank 13: 428.65
     rank 14: 422.99
     rank 15: 436.07
  pure-backward-compute:
     rank  0: 264.76
     rank  1: 263.64
     rank  2: 257.73
     rank  3: 259.80
     rank  4: 385.90
     rank  5: 387.24
     rank  6: 393.39
     rank  7: 400.23
     rank  8: 367.33
     rank  9: 375.11
     rank 10: 382.77
     rank 11: 377.66
     rank 12: 432.23
     rank 13: 427.99
     rank 14: 422.33
     rank 15: 435.37
  batch-generator:
     rank  0: 17.71
     rank  1: 12.07
     rank  2: 12.13
     rank  3: 12.09
     rank  4: 14.62
     rank  5: 11.03
     rank  6: 16.47
     rank  7: 10.63
     rank  8: 11.58
     rank  9: 10.90
     rank 10: 13.85
     rank 11: 13.29
     rank 12: 11.19
     rank 13: 11.59
     rank 14: 15.01
     rank 15: 11.51
  forward-recv:
     rank  4: 70.81
     rank  5: 48.15
     rank  6: 47.29
     rank  7: 51.93
     rank  8: 188.61
     rank  9: 166.09
     rank 10: 166.60
     rank 11: 176.08
     rank 12: 276.96
     rank 13: 262.29
     rank 14: 263.78
     rank 15: 270.49
  forward-send:
     rank  0: 101.59
     rank  1: 131.06
     rank  2: 135.94
     rank  3: 130.10
     rank  4: 3.13
     rank  5: 3.68
     rank  6: 3.88
     rank  7: 3.15
     rank  8: 1.48
     rank  9: 1.62
     rank 10: 1.61
     rank 11: 1.60
  backward-recv:
     rank  0: 494.66
     rank  1: 499.77
     rank  2: 504.16
     rank  3: 504.47
     rank  4: 268.35
     rank  5: 267.08
     rank  6: 261.05
     rank  7: 259.86
     rank  8: 136.83
     rank  9: 134.62
     rank 10: 134.42
     rank 11: 135.56
  backward-send:
     rank  4: 3.58
     rank  5: 2.93
     rank  6: 3.34
     rank  7: 2.65
     rank  8: 5.77
     rank  9: 5.83
     rank 10: 4.18
     rank 11: 3.82
     rank 12: 2.89
     rank 13: 2.15
     rank 14: 1.51
     rank 15: 2.49
  forward-send-backward-recv:
     rank  0: 348.77
     rank  1: 375.60
     rank  2: 375.62
     rank  3: 367.35
     rank  4: 220.93
     rank  5: 243.32
     rank  6: 230.13
     rank  7: 223.98
     rank  8: 189.99
     rank  9: 193.67
     rank 10: 175.58
     rank 11: 178.31
  backward-send-forward-recv:
     rank  4: 2.18
     rank  5: 2.22
     rank  6: 2.10
     rank  7: 1.36
     rank  8: 7.52
     rank  9: 7.47
     rank 10: 6.68
     rank 11: 5.68
     rank 12: 11.93
     rank 13: 12.24
     rank 14: 6.14
     rank 15: 10.27
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.08
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.05
     rank 11: 0.17
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.07
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.04
     rank 12: 0.05
     rank 13: 0.06
     rank 14: 0.05
     rank 15: 0.05
  all-grads-sync:
     rank  0: 298.42
     rank  1: 298.65
     rank  2: 298.38
     rank  3: 298.27
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
  optimizer-copy-to-main-grad:
     rank  0: 0.23
     rank  1: 0.26
     rank  2: 0.19
     rank  3: 0.19
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.06
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.04
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.03
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 37.89
     rank  1: 37.78
     rank  2: 37.65
     rank  3: 37.66
     rank  4: 0.04
     rank  5: 0.07
     rank  6: 0.04
     rank  7: 0.03
     rank  8: 0.04
     rank  9: 0.03
     rank 10: 0.11
     rank 11: 0.16
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
  optimizer:
     rank  0: 39.03
     rank  1: 38.84
     rank  2: 38.79
     rank  3: 38.80
     rank  4: 1.18
     rank  5: 1.21
     rank  6: 1.18
     rank  7: 1.17
     rank  8: 1.17
     rank  9: 1.17
     rank 10: 1.25
     rank 11: 1.38
     rank 12: 1.16
     rank 13: 1.17
     rank 14: 1.17
     rank 15: 1.17
 [2024-12-24 22:59:46] iteration        7/      10 | consumed samples:          112 | elapsed time per iteration (ms): 1849.8 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 6.098219E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 1785.06
     rank  1: 1785.11
     rank  2: 1785.07
     rank  3: 1785.07
     rank  4: 1781.52
     rank  5: 1781.55
     rank  6: 1781.59
     rank  7: 1781.55
     rank  8: 1781.63
     rank  9: 1781.64
     rank 10: 1781.65
     rank 11: 1781.45
     rank 12: 1781.49
     rank 13: 1781.51
     rank 14: 1781.53
     rank 15: 1781.52
  forward-compute:
     rank  0: 242.76
     rank  1: 209.56
     rank  2: 185.85
     rank  3: 202.15
     rank  4: 437.20
     rank  5: 442.89
     rank  6: 454.94
     rank  7: 458.48
     rank  8: 402.63
     rank  9: 416.83
     rank 10: 424.97
     rank 11: 421.49
     rank 12: 487.18
     rank 13: 478.25
     rank 14: 509.36
     rank 15: 488.90
  backward-compute:
     rank  0: 265.31
     rank  1: 259.49
     rank  2: 254.30
     rank  3: 255.33
     rank  4: 383.51
     rank  5: 387.37
     rank  6: 391.18
     rank  7: 396.76
     rank  8: 367.07
     rank  9: 375.51
     rank 10: 382.39
     rank 11: 379.39
     rank 12: 430.82
     rank 13: 434.40
     rank 14: 421.36
     rank 15: 435.84
  pure-backward-compute:
     rank  0: 265.08
     rank  1: 259.32
     rank  2: 254.01
     rank  3: 255.18
     rank  4: 383.32
     rank  5: 387.12
     rank  6: 390.91
     rank  7: 396.57
     rank  8: 366.73
     rank  9: 375.09
     rank 10: 382.00
     rank 11: 378.70
     rank 12: 430.27
     rank 13: 433.80
     rank 14: 420.80
     rank 15: 434.78
  batch-generator:
     rank  0: 14.36
     rank  1: 15.13
     rank  2: 11.41
     rank  3: 11.89
     rank  4: 12.00
     rank  5: 11.60
     rank  6: 15.94
     rank  7: 10.40
     rank  8: 11.48
     rank  9: 11.08
     rank 10: 14.69
     rank 11: 13.83
     rank 12: 11.34
     rank 13: 10.80
     rank 14: 15.15
     rank 15: 12.02
  forward-recv:
     rank  4: 63.02
     rank  5: 63.49
     rank  6: 47.44
     rank  7: 52.10
     rank  8: 183.46
     rank  9: 182.38
     rank 10: 167.97
     rank 11: 178.13
     rank 12: 271.95
     rank 13: 278.30
     rank 14: 264.45
     rank 15: 270.11
  forward-send:
     rank  0: 103.94
     rank  1: 127.04
     rank  2: 137.87
     rank  3: 135.81
     rank  4: 4.15
     rank  5: 3.14
     rank  6: 3.16
     rank  7: 4.46
     rank  8: 1.57
     rank  9: 1.55
     rank 10: 1.59
     rank 11: 1.59
  backward-recv:
     rank  0: 499.17
     rank  1: 501.22
     rank  2: 508.20
     rank  3: 507.70
     rank  4: 273.29
     rank  5: 266.84
     rank  6: 266.18
     rank  7: 265.28
     rank  8: 138.61
     rank  9: 135.97
     rank 10: 136.94
     rank 11: 136.31
  backward-send:
     rank  4: 2.98
     rank  5: 2.83
     rank  6: 3.25
     rank  7: 2.63
     rank  8: 4.18
     rank  9: 4.31
     rank 10: 3.81
     rank 11: 4.27
     rank 12: 2.52
     rank 13: 2.98
     rank 14: 1.53
     rank 15: 2.32
  forward-send-backward-recv:
     rank  0: 353.15
     rank  1: 365.69
     rank  2: 374.25
     rank  3: 366.19
     rank  4: 232.95
     rank  5: 231.34
     rank  6: 230.70
     rank  7: 224.08
     rank  8: 198.62
     rank  9: 180.68
     rank 10: 178.04
     rank 11: 177.37
  backward-send-forward-recv:
     rank  4: 1.44
     rank  5: 1.49
     rank  6: 1.31
     rank  7: 1.33
     rank  8: 5.29
     rank  9: 5.45
     rank 10: 4.50
     rank 11: 5.83
     rank 12: 13.76
     rank 13: 13.14
     rank 14: 5.83
     rank 15: 10.60
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.04
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.06
     rank  2: 0.05
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.05
     rank 13: 0.06
     rank 14: 0.05
     rank 15: 0.06
  all-grads-sync:
     rank  0: 310.61
     rank  1: 310.81
     rank  2: 310.65
     rank  3: 310.59
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.04
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.18
     rank  1: 0.19
     rank  2: 0.18
     rank  3: 0.18
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 37.70
     rank  1: 37.77
     rank  2: 37.63
     rank  3: 37.65
     rank  4: 0.03
     rank  5: 0.04
     rank  6: 0.04
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.04
     rank 11: 0.10
     rank 12: 0.04
     rank 13: 0.03
     rank 14: 0.06
     rank 15: 0.03
  optimizer:
     rank  0: 38.48
     rank  1: 38.52
     rank  2: 38.42
     rank  3: 38.43
     rank  4: 0.81
     rank  5: 0.82
     rank  6: 0.82
     rank  7: 0.81
     rank  8: 0.81
     rank  9: 0.81
     rank 10: 0.83
     rank 11: 0.89
     rank 12: 0.81
     rank 13: 0.81
     rank 14: 0.84
     rank 15: 0.81
 [2024-12-24 22:59:48] iteration        8/      10 | consumed samples:          128 | elapsed time per iteration (ms): 1864.7 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 4.658841E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 1802.27
     rank  1: 1802.36
     rank  2: 1802.26
     rank  3: 1802.24
     rank  4: 1798.74
     rank  5: 1798.74
     rank  6: 1798.76
     rank  7: 1798.78
     rank  8: 1799.07
     rank  9: 1799.07
     rank 10: 1799.06
     rank 11: 1799.19
     rank 12: 1798.77
     rank 13: 1798.73
     rank 14: 1798.72
     rank 15: 1798.72
  forward-compute:
     rank  0: 202.54
     rank  1: 259.79
     rank  2: 186.11
     rank  3: 201.14
     rank  4: 434.07
     rank  5: 444.12
     rank  6: 452.68
     rank  7: 456.37
     rank  8: 404.70
     rank  9: 416.19
     rank 10: 426.92
     rank 11: 419.38
     rank 12: 530.44
     rank 13: 480.96
     rank 14: 535.84
     rank 15: 518.79
  backward-compute:
     rank  0: 264.67
     rank  1: 258.52
     rank  2: 260.19
     rank  3: 255.06
     rank  4: 384.28
     rank  5: 386.47
     rank  6: 395.44
     rank  7: 398.59
     rank  8: 367.55
     rank  9: 378.05
     rank 10: 382.40
     rank 11: 376.32
     rank 12: 424.83
     rank 13: 432.71
     rank 14: 419.73
     rank 15: 431.69
  pure-backward-compute:
     rank  0: 264.47
     rank  1: 258.24
     rank  2: 260.04
     rank  3: 254.90
     rank  4: 383.90
     rank  5: 386.27
     rank  6: 395.16
     rank  7: 398.34
     rank  8: 367.19
     rank  9: 377.49
     rank 10: 381.96
     rank 11: 375.89
     rank 12: 424.11
     rank 13: 431.99
     rank 14: 419.10
     rank 15: 430.51
  batch-generator:
     rank  0: 11.98
     rank  1: 17.87
     rank  2: 11.47
     rank  3: 12.10
     rank  4: 10.82
     rank  5: 12.06
     rank  6: 14.79
     rank  7: 10.88
     rank  8: 11.32
     rank  9: 12.17
     rank 10: 13.54
     rank 11: 14.76
     rank 12: 11.71
     rank 13: 12.02
     rank 14: 13.95
     rank 15: 15.14
  forward-recv:
     rank  4: 51.44
     rank  5: 90.12
     rank  6: 48.05
     rank  7: 51.13
     rank  8: 168.23
     rank  9: 209.01
     rank 10: 167.02
     rank 11: 173.99
     rank 12: 260.29
     rank 13: 303.59
     rank 14: 265.58
     rank 15: 269.35
  forward-send:
     rank  0: 120.54
     rank  1: 112.08
     rank  2: 138.04
     rank  3: 132.39
     rank  4: 3.64
     rank  5: 3.29
     rank  6: 3.41
     rank  7: 3.13
     rank  8: 1.62
     rank  9: 1.61
     rank 10: 1.56
     rank 11: 1.65
  backward-recv:
     rank  0: 499.32
     rank  1: 503.83
     rank  2: 503.28
     rank  3: 509.60
     rank  4: 269.23
     rank  5: 271.06
     rank  6: 265.18
     rank  7: 265.54
     rank  8: 137.33
     rank  9: 137.19
     rank 10: 136.93
     rank 11: 136.67
  backward-send:
     rank  4: 2.65
     rank  5: 2.57
     rank  6: 3.02
     rank  7: 2.65
     rank  8: 3.06
     rank  9: 4.27
     rank 10: 3.19
     rank 11: 4.25
     rank 12: 2.02
     rank 13: 2.93
     rank 14: 1.60
     rank 15: 2.45
  forward-send-backward-recv:
     rank  0: 396.38
     rank  1: 355.79
     rank  2: 401.27
     rank  3: 394.41
     rank  4: 274.07
     rank  5: 227.99
     rank  6: 255.96
     rank  7: 250.82
     rank  8: 237.10
     rank  9: 179.55
     rank 10: 201.08
     rank 11: 211.09
  backward-send-forward-recv:
     rank  4: 1.54
     rank  5: 1.74
     rank  6: 1.34
     rank  7: 1.81
     rank  8: 4.63
     rank  9: 5.06
     rank 10: 6.62
     rank 11: 6.36
     rank 12: 13.48
     rank 13: 12.44
     rank 14: 6.36
     rank 15: 11.02
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.13
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.06
     rank  2: 0.04
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.06
     rank 12: 0.05
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.05
  all-grads-sync:
     rank  0: 302.05
     rank  1: 302.12
     rank  2: 302.03
     rank  3: 301.98
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.04
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.07
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.18
     rank  1: 0.18
     rank  2: 0.17
     rank  3: 0.17
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 37.66
     rank  1: 37.68
     rank  2: 37.61
     rank  3: 37.66
     rank  4: 0.03
     rank  5: 0.04
     rank  6: 0.04
     rank  7: 0.03
     rank  8: 0.04
     rank  9: 0.06
     rank 10: 0.07
     rank 11: 0.12
     rank 12: 0.03
     rank 13: 0.06
     rank 14: 0.03
     rank 15: 0.07
  optimizer:
     rank  0: 38.44
     rank  1: 38.44
     rank  2: 38.38
     rank  3: 38.45
     rank  4: 0.80
     rank  5: 0.81
     rank  6: 0.82
     rank  7: 0.81
     rank  8: 0.81
     rank  9: 0.84
     rank 10: 0.85
     rank 11: 0.91
     rank 12: 0.80
     rank 13: 0.83
     rank 14: 0.80
     rank 15: 0.83
 [2024-12-24 22:59:50] iteration        9/      10 | consumed samples:          144 | elapsed time per iteration (ms): 1834.6 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 3.792625E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 1768.67
     rank  1: 1768.57
     rank  2: 1768.58
     rank  3: 1768.58
     rank  4: 1765.03
     rank  5: 1764.99
     rank  6: 1764.99
     rank  7: 1764.99
     rank  8: 1766.41
     rank  9: 1766.40
     rank 10: 1766.40
     rank 11: 1766.88
     rank 12: 1764.98
     rank 13: 1764.96
     rank 14: 1764.96
     rank 15: 1764.95
  forward-compute:
     rank  0: 204.32
     rank  1: 195.40
     rank  2: 191.97
     rank  3: 200.04
     rank  4: 434.01
     rank  5: 437.42
     rank  6: 454.05
     rank  7: 456.40
     rank  8: 405.31
     rank  9: 417.88
     rank 10: 423.61
     rank 11: 419.69
     rank 12: 491.54
     rank 13: 488.66
     rank 14: 498.74
     rank 15: 478.62
  backward-compute:
     rank  0: 267.28
     rank  1: 264.59
     rank  2: 258.96
     rank  3: 252.51
     rank  4: 384.10
     rank  5: 384.53
     rank  6: 395.82
     rank  7: 399.22
     rank  8: 368.16
     rank  9: 376.60
     rank 10: 384.14
     rank 11: 377.13
     rank 12: 430.46
     rank 13: 431.99
     rank 14: 424.64
     rank 15: 438.52
  pure-backward-compute:
     rank  0: 266.97
     rank  1: 264.44
     rank  2: 258.81
     rank  3: 252.36
     rank  4: 383.91
     rank  5: 384.29
     rank  6: 395.54
     rank  7: 398.99
     rank  8: 367.86
     rank  9: 376.19
     rank 10: 383.89
     rank 11: 376.70
     rank 12: 429.57
     rank 13: 431.36
     rank 14: 424.05
     rank 15: 437.75
  batch-generator:
     rank  0: 15.42
     rank  1: 11.81
     rank  2: 11.51
     rank  3: 12.09
     rank  4: 11.10
     rank  5: 11.07
     rank  6: 15.47
     rank  7: 10.41
     rank  8: 12.09
     rank  9: 11.83
     rank 10: 11.54
     rank 11: 14.87
     rank 12: 12.00
     rank 13: 11.49
     rank 14: 14.37
     rank 15: 11.33
  forward-recv:
     rank  4: 51.42
     rank  5: 49.16
     rank  6: 48.57
     rank  7: 50.70
     rank  8: 168.85
     rank  9: 164.43
     rank 10: 170.67
     rank 11: 173.69
     rank 12: 260.46
     rank 13: 262.00
     rank 14: 264.37
     rank 15: 270.03
  forward-send:
     rank  0: 121.18
     rank  1: 125.89
     rank  2: 133.95
     rank  3: 134.04
     rank  4: 4.12
     rank  5: 3.50
     rank  6: 3.69
     rank  7: 3.12
     rank  8: 1.65
     rank  9: 1.60
     rank 10: 1.51
     rank 11: 1.57
  backward-recv:
     rank  0: 499.52
     rank  1: 500.97
     rank  2: 502.28
     rank  3: 508.34
     rank  4: 269.43
     rank  5: 269.03
     rank  6: 264.41
     rank  7: 264.06
     rank  8: 138.60
     rank  9: 136.60
     rank 10: 136.38
     rank 11: 136.08
  backward-send:
     rank  4: 2.78
     rank  5: 3.40
     rank  6: 3.78
     rank  7: 2.69
     rank  8: 3.99
     rank  9: 4.28
     rank 10: 4.15
     rank 11: 4.44
     rank 12: 3.50
     rank 13: 3.28
     rank 14: 1.60
     rank 15: 3.13
  forward-send-backward-recv:
     rank  0: 364.75
     rank  1: 374.52
     rank  2: 370.40
     rank  3: 366.01
     rank  4: 244.46
     rank  5: 244.89
     rank  6: 222.40
     rank  7: 221.36
     rank  8: 203.47
     rank  9: 189.48
     rank 10: 170.59
     rank 11: 178.74
  backward-send-forward-recv:
     rank  4: 1.32
     rank  5: 1.90
     rank  6: 1.61
     rank  7: 1.34
     rank  8: 5.02
     rank  9: 6.95
     rank 10: 4.47
     rank 11: 6.18
     rank 12: 14.76
     rank 13: 14.52
     rank 14: 7.13
     rank 15: 11.18
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.54
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.09
     rank  1: 0.05
     rank  2: 0.04
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.22
     rank 12: 0.07
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.05
  all-grads-sync:
     rank  0: 297.40
     rank  1: 297.30
     rank  2: 297.41
     rank  3: 297.42
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.01
  optimizer-copy-to-main-grad:
     rank  0: 0.23
     rank  1: 0.20
     rank  2: 0.20
     rank  3: 0.17
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.09
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.01
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.06
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 38.11
     rank  1: 37.75
     rank  2: 37.66
     rank  3: 37.87
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.04
     rank  7: 0.03
     rank  8: 0.05
     rank  9: 0.04
     rank 10: 0.03
     rank 11: 0.52
     rank 12: 0.06
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.03
  optimizer:
     rank  0: 39.39
     rank  1: 39.08
     rank  2: 39.00
     rank  3: 39.21
     rank  4: 1.37
     rank  5: 1.36
     rank  6: 1.38
     rank  7: 1.37
     rank  8: 1.38
     rank  9: 1.37
     rank 10: 1.36
     rank 11: 1.87
     rank 12: 1.39
     rank 13: 1.37
     rank 14: 1.37
     rank 15: 1.36
 [2024-12-24 22:59:52] iteration       10/      10 | consumed samples:          160 | elapsed time per iteration (ms): 1857.8 | learning rate: 1.000000E-05 | global batch size:    16 | lm loss: 3.704117E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 1790.15
     rank  1: 1790.04
     rank  2: 1790.05
     rank  3: 1790.04
     rank  4: 1786.39
     rank  5: 1786.31
     rank  6: 1786.35
     rank  7: 1786.34
     rank  8: 1786.77
     rank  9: 1786.78
     rank 10: 1786.78
     rank 11: 1786.94
     rank 12: 1786.27
     rank 13: 1786.25
     rank 14: 1786.29
     rank 15: 1786.29
  forward-compute:
     rank  0: 251.74
     rank  1: 193.21
     rank  2: 189.46
     rank  3: 203.79
     rank  4: 442.90
     rank  5: 438.71
     rank  6: 453.72
     rank  7: 457.85
     rank  8: 403.16
     rank  9: 423.47
     rank 10: 425.24
     rank 11: 430.31
     rank 12: 487.72
     rank 13: 496.94
     rank 14: 506.31
     rank 15: 480.38
  backward-compute:
     rank  0: 266.96
     rank  1: 264.73
     rank  2: 255.51
     rank  3: 256.19
     rank  4: 386.10
     rank  5: 385.37
     rank  6: 394.57
     rank  7: 401.02
     rank  8: 368.03
     rank  9: 377.03
     rank 10: 383.50
     rank 11: 376.78
     rank 12: 431.06
     rank 13: 431.65
     rank 14: 424.73
     rank 15: 438.26
  pure-backward-compute:
     rank  0: 266.64
     rank  1: 264.58
     rank  2: 255.35
     rank  3: 255.98
     rank  4: 385.63
     rank  5: 385.12
     rank  6: 394.20
     rank  7: 400.76
     rank  8: 367.72
     rank  9: 376.66
     rank 10: 383.25
     rank 11: 376.30
     rank 12: 430.45
     rank 13: 431.06
     rank 14: 424.05
     rank 15: 437.49
  batch-generator:
     rank  0: 15.10
     rank  1: 11.94
     rank  2: 12.48
     rank  3: 11.89
     rank  4: 15.08
     rank  5: 10.98
     rank  6: 16.73
     rank  7: 10.98
     rank  8: 11.88
     rank  9: 16.06
     rank 10: 11.82
     rank 11: 20.33
     rank 12: 11.59
     rank 13: 11.44
     rank 14: 14.03
     rank 15: 11.16
  forward-recv:
     rank  4: 66.50
     rank  5: 50.65
     rank  6: 49.81
     rank  7: 52.76
     rank  8: 183.07
     rank  9: 161.48
     rank 10: 168.52
     rank 11: 165.74
     rank 12: 275.41
     rank 13: 267.56
     rank 14: 267.07
     rank 15: 280.11
  forward-send:
     rank  0: 95.91
     rank  1: 127.94
     rank  2: 134.96
     rank  3: 129.38
     rank  4: 3.07
     rank  5: 3.28
     rank  6: 3.23
     rank  7: 3.04
     rank  8: 1.53
     rank  9: 2.52
     rank 10: 2.22
     rank 11: 1.76
  backward-recv:
     rank  0: 494.86
     rank  1: 501.05
     rank  2: 505.34
     rank  3: 506.94
     rank  4: 265.62
     rank  5: 271.18
     rank  6: 262.82
     rank  7: 262.13
     rank  8: 137.33
     rank  9: 137.14
     rank 10: 134.40
     rank 11: 136.45
  backward-send:
     rank  4: 3.42
     rank  5: 2.58
     rank  6: 3.03
     rank  7: 2.55
     rank  8: 3.18
     rank  9: 4.74
     rank 10: 3.84
     rank 11: 4.74
     rank 12: 1.58
     rank 13: 2.75
     rank 14: 1.54
     rank 15: 2.60
  forward-send-backward-recv:
     rank  0: 352.34
     rank  1: 381.57
     rank  2: 380.26
     rank  3: 373.99
     rank  4: 229.52
     rank  5: 251.50
     rank  6: 233.21
     rank  7: 227.57
     rank  8: 200.35
     rank  9: 194.40
     rank 10: 179.51
     rank 11: 185.34
  backward-send-forward-recv:
     rank  4: 1.52
     rank  5: 1.36
     rank  6: 1.70
     rank  7: 1.45
     rank  8: 5.73
     rank  9: 6.66
     rank 10: 6.63
     rank 11: 6.22
     rank 12: 12.80
     rank 13: 12.74
     rank 14: 7.48
     rank 15: 9.85
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.05
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.32
     rank 12: 0.04
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.08
     rank  1: 0.06
     rank  2: 0.05
     rank  3: 0.05
     rank  4: 0.03
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.06
     rank 12: 0.06
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.05
  all-grads-sync:
     rank  0: 310.76
     rank  1: 310.91
     rank  2: 310.84
     rank  3: 310.69
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.32
     rank  1: 0.21
     rank  2: 0.21
     rank  3: 0.15
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.05
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 38.22
     rank  1: 37.73
     rank  2: 37.68
     rank  3: 37.62
     rank  4: 0.05
     rank  5: 0.03
     rank  6: 0.04
     rank  7: 0.07
     rank  8: 0.03
     rank  9: 0.04
     rank 10: 0.06
     rank 11: 0.15
     rank 12: 0.04
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.03
  optimizer:
     rank  0: 39.24
     rank  1: 38.76
     rank  2: 38.71
     rank  3: 38.65
     rank  4: 1.08
     rank  5: 1.05
     rank  6: 1.07
     rank  7: 1.09
     rank  8: 1.06
     rank  9: 1.07
     rank 10: 1.09
     rank 11: 1.18
     rank 12: 1.06
     rank 13: 1.06
     rank 14: 1.06
     rank 15: 1.06
