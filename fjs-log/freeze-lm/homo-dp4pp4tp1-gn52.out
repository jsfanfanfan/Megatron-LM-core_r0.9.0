examples/multimodal/pretrain-freeze-llm-homo.sh: line 4: activate: No such file or directory
[2024-12-30 21:28:58,129] torch.distributed.run: [WARNING] 
[2024-12-30 21:28:58,129] torch.distributed.run: [WARNING] *****************************************
[2024-12-30 21:28:58,129] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-12-30 21:28:58,129] torch.distributed.run: [WARNING] *****************************************
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
> setting tensorboard ...
WARNING: one_logger package is required to enable e2e metrics tracking. please go to https://confluence.nvidia.com/display/MLWFO/Package+Repositories for details to install it
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
---Rank 13---Tensor Parallel Group GPUs: [0]
---Rank 13---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
---Rank 12---Tensor Parallel Group GPUs: [0]
---Rank 12---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
[rank13]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank12]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
---Rank 15---Tensor Parallel Group GPUs: [0]
---Rank 14---Tensor Parallel Group GPUs: [0]
---Rank 15---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
---Rank 14---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
[rank15]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank14]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
 > number of parameters on (tensor, pipeline) model parallel rank (0, 3): 1006669824
rank=0, worker=0: shard_range=[pretrain-0.tar[0, 100), pretrain-0.tar[100, 200), pretrain-0.tar[200, 300), ...<619>, pretrain-14.tar[2200, 2300), pretrain-14.tar[2300, 2400), pretrain-14.tar[2400, 2500)] sum(count)=62500
rank=0, worker=1: shard_range=[pretrain-14.tar[2500, 2600), pretrain-14.tar[2600, 2700), pretrain-14.tar[2700, 2800), ...<619>, pretrain-2.tar[4700, 4800), pretrain-2.tar[4800, 4900), pretrain-2.tar[4900, 5000)] sum(count)=62500
rank=1, worker=0: shard_range=[pretrain-2.tar[5000, 5100), pretrain-2.tar[5100, 5200), pretrain-2.tar[5200, 5300), ...<619>, pretrain-25.tar[7200, 7300), pretrain-25.tar[7300, 7400), pretrain-25.tar[7400, 7500)] sum(count)=62500
rank=1, worker=1: shard_range=[pretrain-25.tar[7500, 7600), pretrain-25.tar[7600, 7700), pretrain-25.tar[7700, 7800), ...<619>, pretrain-30.tar[9700, 9800), pretrain-30.tar[9800, 9900), pretrain-30.tar[9900, 10000)] sum(count)=62500
rank=2, worker=0: shard_range=[pretrain-31.tar[0, 100), pretrain-31.tar[100, 200), pretrain-31.tar[200, 300), ...<619>, pretrain-37.tar[2200, 2300), pretrain-37.tar[2300, 2400), pretrain-37.tar[2400, 2500)] sum(count)=62500
rank=2, worker=1: shard_range=[pretrain-37.tar[2500, 2600), pretrain-37.tar[2600, 2700), pretrain-37.tar[2700, 2800), ...<619>, pretrain-42.tar[4700, 4800), pretrain-42.tar[4800, 4900), pretrain-42.tar[4900, 5000)] sum(count)=62500
rank=3, worker=0: shard_range=[pretrain-42.tar[5000, 5100), pretrain-42.tar[5100, 5200), pretrain-42.tar[5200, 5300), ...<619>, pretrain-48.tar[7200, 7300), pretrain-48.tar[7300, 7400), pretrain-48.tar[7400, 7500)] sum(count)=62500
rank=3, worker=1: shard_range=[pretrain-48.tar[7500, 7600), pretrain-48.tar[7600, 7700), pretrain-48.tar[7700, 7800), ...<619>, pretrain-53.tar[9700, 9800), pretrain-53.tar[9800, 9900), pretrain-53.tar[9900, 10000)] sum(count)=62500
rank=0, worker=0: shard_range=[pretrain-54.tar[0, 7266)] sum(count)=7266
rank=0, worker=1: shard_range=[pretrain-54.tar[7266, 10000), pretrain-55.tar[0, 4532)] sum(count)=7266
rank=3, worker=0: shard_range=[pretrain-8.tar[5468, 10000), pretrain-9.tar[0, 2734)] sum(count)=7266
rank=3, worker=1: shard_range=[pretrain-9.tar[2734, 10000)] sum(count)=7266
rank=1, worker=0: shard_range=[pretrain-55.tar[4532, 8128), pretrain-6.tar[0, 3670)] sum(count)=7266
rank=1, worker=1: shard_range=[pretrain-6.tar[3670, 10000), pretrain-7.tar[0, 936)] sum(count)=7266
rank=2, worker=0: shard_range=[pretrain-7.tar[936, 8202)] sum(count)=7266
rank=2, worker=1: shard_range=[pretrain-7.tar[8202, 10000), pretrain-8.tar[0, 5468)] sum(count)=7266
times across ranks (ms):
  model-and-optimizer-setup:
     rank  0: 86.41
     rank  1: 131.18
     rank  2: 125.36
     rank  3: 128.46
     rank  4: 31.71
     rank  5: 32.79
     rank  6: 26.51
     rank  7: 32.97
     rank  8: 38.80
     rank  9: 39.18
     rank 10: 36.88
     rank 11: 35.28
     rank 12: 24.88
     rank 13: 28.36
     rank 14: 25.08
     rank 15: 23.56
  train/valid/test-data-iterators-setup:
     rank  0: 1134.88
     rank  1: 1169.22
     rank  2: 1169.34
     rank  3: 1202.86
     rank  4: 1205.81
     rank  5: 1206.14
     rank  6: 1205.83
     rank  7: 1205.81
     rank  8: 1266.45
     rank  9: 1328.74
     rank 10: 1328.52
     rank 11: 1328.53
     rank 12: 1328.40
     rank 13: 1328.58
     rank 14: 1328.51
     rank 15: 1328.60
 [2024-12-30 21:29:35] iteration        1/      10 | consumed samples:           32 | elapsed time per iteration (ms): 13894.9 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 7.114373E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
stage4 GPU utialization:49.76407831365412 %
[Rank 12] (after 1 iterations) memory (MB) | allocated: 3893.3935546875 | max allocated: 5605.42578125 | reserved: 5780.0 | max reserved: 5780.0
times across ranks (ms):
  forward-backward:
     rank  0: 13691.78
     rank  1: 13691.84
     rank  2: 13691.99
     rank  3: 13691.79
     rank  4: 13811.57
     rank  5: 13811.73
     rank  6: 13811.61
     rank  7: 13811.89
     rank  8: 13846.27
     rank  9: 13846.32
     rank 10: 13846.40
     rank 11: 13846.15
     rank 12: 13688.33
     rank 13: 13688.28
     rank 14: 13688.32
     rank 15: 13688.46
  forward-compute:
     rank  0: 4451.64
     rank  1: 4277.45
     rank  2: 4279.17
     rank  3: 4336.20
     rank  4: 2556.34
     rank  5: 2392.91
     rank  6: 2235.21
     rank  7: 2588.63
     rank  8: 2594.82
     rank  9: 2415.86
     rank 10: 2393.73
     rank 11: 2606.44
     rank 12: 3165.63
     rank 13: 3597.27
     rank 14: 3898.42
     rank 15: 3157.72
  backward-compute:
     rank  0: 1194.22
     rank  1: 1432.82
     rank  2: 1181.72
     rank  3: 1305.61
     rank  4: 636.83
     rank  5: 639.98
     rank  6: 635.51
     rank  7: 637.53
     rank  8: 637.99
     rank  9: 637.58
     rank 10: 628.80
     rank 11: 634.41
     rank 12: 726.57
     rank 13: 740.01
     rank 14: 738.77
     rank 15: 743.55
  pure-backward-compute:
     rank  0: 1193.43
     rank  1: 1432.15
     rank  2: 1180.99
     rank  3: 1305.05
     rank  4: 635.95
     rank  5: 638.86
     rank  6: 634.56
     rank  7: 636.51
     rank  8: 637.08
     rank  9: 636.66
     rank 10: 627.93
     rank 11: 633.66
     rank 12: 724.97
     rank 13: 738.52
     rank 14: 737.37
     rank 15: 741.89
  batch-generator:
     rank  0: 961.13
     rank  1: 1111.04
     rank  2: 1049.92
     rank  3: 1070.55
     rank  4: 979.86
     rank  5: 1035.12
     rank  6: 870.08
     rank  7: 992.38
     rank  8: 967.02
     rank  9: 1008.57
     rank 10: 1036.16
     rank 11: 1028.35
     rank 12: 981.54
     rank 13: 1035.81
     rank 14: 850.59
     rank 15: 1015.16
  forward-recv:
     rank  4: 4226.13
     rank  5: 3909.79
     rank  6: 3979.11
     rank  7: 4001.58
     rank  8: 6319.44
     rank  9: 5836.14
     rank 10: 5753.74
     rank 11: 6127.86
     rank 12: 8455.34
     rank 13: 7803.58
     rank 14: 7701.20
     rank 15: 8282.99
  forward-send:
     rank  0: 4331.03
     rank  1: 3913.29
     rank  2: 3750.54
     rank  3: 4300.37
     rank  4: 2085.56
     rank  5: 1916.70
     rank  6: 1902.90
     rank  7: 2114.63
     rank  8: 22.20
     rank  9: 26.61
     rank 10: 25.75
     rank 11: 26.43
  backward-recv:
     rank  0: 354.10
     rank  1: 342.70
     rank  2: 359.34
     rank  3: 367.35
     rank  4: 197.36
     rank  5: 198.30
     rank  6: 198.78
     rank  7: 196.63
     rank  8: 97.83
     rank  9: 96.70
     rank 10: 98.67
     rank 11: 96.59
  backward-send:
     rank  4: 2.59
     rank  5: 3.29
     rank  6: 2.71
     rank  7: 3.54
     rank  8: 3.26
     rank  9: 6.61
     rank 10: 5.23
     rank 11: 6.47
     rank 12: 1.78
     rank 13: 3.84
     rank 14: 3.71
     rank 15: 3.90
  forward-send-backward-recv:
     rank  0: 2906.00
     rank  1: 3276.82
     rank  2: 3660.86
     rank  3: 2930.23
     rank  4: 2769.94
     rank  5: 3196.06
     rank  6: 3520.29
     rank  7: 2786.10
     rank  8: 2735.10
     rank  9: 3182.85
     rank 10: 3498.69
     rank 11: 2755.34
  backward-send-forward-recv:
     rank  4: 703.66
     rank  5: 926.19
     rank  6: 707.84
     rank  7: 855.37
     rank  8: 688.01
     rank  9: 901.68
     rank 10: 698.62
     rank 11: 849.76
     rank 12: 669.72
     rank 13: 878.36
     rank 14: 680.38
     rank 15: 833.64
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.05
     rank  2: 0.08
     rank  3: 0.04
     rank  4: 0.03
     rank  5: 0.04
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.16
     rank  9: 0.06
     rank 10: 0.15
     rank 11: 0.05
     rank 12: 0.04
     rank 13: 0.03
     rank 14: 0.04
     rank 15: 0.05
  embedding-grads-all-reduce:
     rank  0: 0.07
     rank  1: 0.09
     rank  2: 0.16
     rank  3: 0.06
     rank  4: 0.02
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.06
     rank  9: 0.04
     rank 10: 0.06
     rank 11: 0.03
     rank 12: 0.08
     rank 13: 0.05
     rank 14: 0.07
     rank 15: 0.11
  all-grads-sync:
     rank  0: 434.86
     rank  1: 435.01
     rank  2: 435.03
     rank  3: 434.86
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.05
     rank 10: 0.07
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.04
  optimizer-copy-to-main-grad:
     rank  0: 0.23
     rank  1: 0.30
     rank  2: 0.43
     rank  3: 0.23
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.07
     rank  9: 0.06
     rank 10: 0.06
     rank 11: 0.04
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.03
     rank  9: 0.04
     rank 10: 0.03
     rank 11: 0.04
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.03
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-inner-step:
     rank  0: 41.55
     rank  1: 43.18
     rank  2: 43.18
     rank  3: 41.67
     rank  4: 0.07
     rank  5: 0.08
     rank  6: 0.07
     rank  7: 0.10
     rank  8: 0.21
     rank  9: 0.25
     rank 10: 0.24
     rank 11: 0.16
     rank 12: 0.13
     rank 13: 0.09
     rank 14: 0.09
     rank 15: 0.15
  optimizer:
     rank  0: 43.42
     rank  1: 45.01
     rank  2: 45.05
     rank  3: 43.52
     rank  4: 1.92
     rank  5: 1.88
     rank  6: 1.92
     rank  7: 1.95
     rank  8: 2.06
     rank  9: 2.12
     rank 10: 2.08
     rank 11: 2.02
     rank 12: 1.96
     rank 13: 1.95
     rank 14: 1.96
     rank 15: 1.80
 [2024-12-30 21:29:37] iteration        2/      10 | consumed samples:           64 | elapsed time per iteration (ms): 2257.5 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 7.105109E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2187.50
     rank  1: 2187.46
     rank  2: 2187.39
     rank  3: 2187.45
     rank  4: 2183.99
     rank  5: 2183.96
     rank  6: 2183.96
     rank  7: 2183.95
     rank  8: 2184.11
     rank  9: 2184.05
     rank 10: 2184.05
     rank 11: 2184.06
     rank 12: 2184.16
     rank 13: 2184.06
     rank 14: 2184.05
     rank 15: 2184.08
  forward-compute:
     rank  0: 472.64
     rank  1: 597.32
     rank  2: 598.44
     rank  3: 454.36
     rank  4: 535.07
     rank  5: 548.92
     rank  6: 536.08
     rank  7: 560.56
     rank  8: 536.81
     rank  9: 527.58
     rank 10: 538.90
     rank 11: 529.24
     rank 12: 691.38
     rank 13: 652.01
     rank 14: 652.11
     rank 15: 672.77
  backward-compute:
     rank  0: 479.89
     rank  1: 499.74
     rank  2: 511.47
     rank  3: 454.87
     rank  4: 623.96
     rank  5: 620.59
     rank  6: 617.84
     rank  7: 624.26
     rank  8: 627.86
     rank  9: 623.40
     rank 10: 621.87
     rank 11: 625.10
     rank 12: 725.79
     rank 13: 743.87
     rank 14: 741.07
     rank 15: 734.45
  pure-backward-compute:
     rank  0: 479.47
     rank  1: 499.18
     rank  2: 510.95
     rank  3: 454.54
     rank  4: 623.38
     rank  5: 619.97
     rank  6: 617.32
     rank  7: 623.42
     rank  8: 627.04
     rank  9: 622.38
     rank 10: 620.86
     rank 11: 624.23
     rank 12: 724.17
     rank 13: 742.59
     rank 14: 739.71
     rank 15: 732.78
  batch-generator:
     rank  0: 29.00
     rank  1: 45.09
     rank  2: 34.65
     rank  3: 23.91
     rank  4: 25.62
     rank  5: 31.54
     rank  6: 28.90
     rank  7: 39.47
     rank  8: 32.89
     rank  9: 28.17
     rank 10: 40.36
     rank 11: 27.78
     rank 12: 31.81
     rank 13: 24.65
     rank 14: 30.22
     rank 15: 32.56
  forward-recv:
     rank  4: 54.61
     rank  5: 124.71
     rank  6: 92.36
     rank  7: 54.45
     rank  8: 121.39
     rank  9: 178.57
     rank 10: 148.92
     rank 11: 133.56
     rank 12: 189.02
     rank 13: 208.84
     rank 14: 210.85
     rank 15: 196.67
  forward-send:
     rank  0: 25.40
     rank  1: 3.48
     rank  2: 3.09
     rank  3: 39.65
     rank  4: 4.74
     rank  5: 3.52
     rank  6: 3.55
     rank  7: 3.37
     rank  8: 1.72
     rank  9: 1.66
     rank 10: 1.69
     rank 11: 1.53
  backward-recv:
     rank  0: 356.92
     rank  1: 356.99
     rank  2: 345.74
     rank  3: 366.25
     rank  4: 203.84
     rank  5: 200.54
     rank  6: 202.84
     rank  7: 199.56
     rank  8: 97.09
     rank  9: 96.15
     rank 10: 97.20
     rank 11: 96.47
  backward-send:
     rank  4: 2.90
     rank  5: 3.77
     rank  6: 4.02
     rank  7: 4.63
     rank  8: 7.49
     rank  9: 9.27
     rank 10: 9.28
     rank 11: 9.22
     rank 12: 3.97
     rank 13: 4.42
     rank 14: 4.41
     rank 15: 4.74
  forward-send-backward-recv:
     rank  0: 520.16
     rank  1: 398.64
     rank  2: 404.75
     rank  3: 543.60
     rank  4: 364.98
     rank  5: 287.68
     rank  6: 338.15
     rank  7: 345.21
     rank  8: 306.32
     rank  9: 260.07
     rank 10: 279.13
     rank 11: 305.12
  backward-send-forward-recv:
     rank  4: 9.58
     rank  5: 10.60
     rank  6: 7.63
     rank  7: 9.59
     rank  8: 21.28
     rank  9: 24.18
     rank 10: 24.50
     rank 11: 21.74
     rank 12: 27.44
     rank 13: 29.75
     rank 14: 31.22
     rank 15: 30.14
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.04
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.10
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.04
  embedding-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.06
     rank  2: 0.07
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.17
     rank 13: 0.05
     rank 14: 0.07
     rank 15: 0.09
  all-grads-sync:
     rank  0: 312.03
     rank  1: 312.18
     rank  2: 312.14
     rank  3: 312.03
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.07
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.03
  optimizer-copy-to-main-grad:
     rank  0: 0.19
     rank  1: 0.21
     rank  2: 0.25
     rank  3: 0.18
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 37.92
     rank  1: 38.01
     rank  2: 38.34
     rank  3: 38.14
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.05
     rank  8: 0.05
     rank  9: 0.06
     rank 10: 0.06
     rank 11: 0.05
     rank 12: 0.10
     rank 13: 0.03
     rank 14: 0.04
     rank 15: 0.05
  optimizer:
     rank  0: 38.94
     rank  1: 39.03
     rank  2: 39.36
     rank  3: 39.07
     rank  4: 1.04
     rank  5: 1.04
     rank  6: 1.04
     rank  7: 1.06
     rank  8: 1.06
     rank  9: 1.07
     rank 10: 1.07
     rank 11: 1.06
     rank 12: 1.12
     rank 13: 1.04
     rank 14: 1.06
     rank 15: 1.06
 [2024-12-30 21:29:39] iteration        3/      10 | consumed samples:           96 | elapsed time per iteration (ms): 2238.0 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 7.036287E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2171.90
     rank  1: 2171.89
     rank  2: 2171.93
     rank  3: 2171.93
     rank  4: 2168.45
     rank  5: 2168.46
     rank  6: 2168.45
     rank  7: 2168.52
     rank  8: 2168.90
     rank  9: 2168.87
     rank 10: 2168.91
     rank 11: 2169.17
     rank 12: 2168.75
     rank 13: 2168.73
     rank 14: 2168.74
     rank 15: 2168.86
  forward-compute:
     rank  0: 432.47
     rank  1: 481.13
     rank  2: 508.70
     rank  3: 437.29
     rank  4: 533.41
     rank  5: 535.38
     rank  6: 530.34
     rank  7: 555.56
     rank  8: 531.28
     rank  9: 526.81
     rank 10: 528.67
     rank 11: 531.02
     rank 12: 686.31
     rank 13: 674.87
     rank 14: 658.62
     rank 15: 675.89
  backward-compute:
     rank  0: 478.58
     rank  1: 503.79
     rank  2: 485.41
     rank  3: 492.15
     rank  4: 621.74
     rank  5: 622.39
     rank  6: 618.88
     rank  7: 624.70
     rank  8: 627.52
     rank  9: 623.25
     rank 10: 621.56
     rank 11: 622.95
     rank 12: 728.31
     rank 13: 735.13
     rank 14: 745.70
     rank 15: 736.96
  pure-backward-compute:
     rank  0: 478.21
     rank  1: 503.18
     rank  2: 484.87
     rank  3: 491.75
     rank  4: 621.18
     rank  5: 621.86
     rank  6: 618.39
     rank  7: 623.98
     rank  8: 625.99
     rank  9: 621.91
     rank 10: 619.87
     rank 11: 622.13
     rank 12: 726.80
     rank 13: 734.00
     rank 14: 744.40
     rank 15: 733.78
  batch-generator:
     rank  0: 23.58
     rank  1: 39.31
     rank  2: 28.32
     rank  3: 24.45
     rank  4: 23.92
     rank  5: 22.96
     rank  6: 24.51
     rank  7: 36.71
     rank  8: 29.94
     rank  9: 29.31
     rank 10: 31.68
     rank 11: 30.27
     rank 12: 31.53
     rank 13: 24.08
     rank 14: 26.72
     rank 15: 32.59
  forward-recv:
     rank  4: 54.54
     rank  5: 55.89
     rank  6: 78.06
     rank  7: 55.01
     rank  8: 123.29
     rank  9: 125.60
     rank 10: 144.85
     rank 11: 126.52
     rank 12: 188.36
     rank 13: 191.03
     rank 14: 204.00
     rank 15: 191.07
  forward-send:
     rank  0: 31.18
     rank  1: 32.87
     rank  2: 3.60
     rank  3: 33.58
     rank  4: 3.73
     rank  5: 5.11
     rank  6: 3.16
     rank  7: 5.36
     rank  8: 1.70
     rank  9: 2.89
     rank 10: 1.62
     rank 11: 2.82
  backward-recv:
     rank  0: 371.31
     rank  1: 356.25
     rank  2: 370.48
     rank  3: 354.46
     rank  4: 206.66
     rank  5: 199.26
     rank  6: 206.41
     rank  7: 203.42
     rank  8: 99.65
     rank  9: 97.12
     rank 10: 102.00
     rank 11: 99.75
  backward-send:
     rank  4: 3.79
     rank  5: 3.48
     rank  6: 2.81
     rank  7: 4.44
     rank  8: 7.66
     rank  9: 7.47
     rank 10: 6.80
     rank 11: 8.12
     rank 12: 3.85
     rank 13: 2.10
     rank 14: 3.97
     rank 15: 3.49
  forward-send-backward-recv:
     rank  0: 543.49
     rank  1: 477.09
     rank  2: 487.98
     rank  3: 544.05
     rank  4: 367.41
     rank  5: 364.49
     rank  6: 352.96
     rank  7: 345.90
     rank  8: 304.36
     rank  9: 303.55
     rank 10: 286.80
     rank 11: 308.05
  backward-send-forward-recv:
     rank  4: 9.96
     rank  5: 10.61
     rank  6: 9.62
     rank  7: 7.61
     rank  8: 25.84
     rank  9: 30.07
     rank 10: 29.21
     rank 11: 23.66
     rank 12: 33.12
     rank 13: 35.02
     rank 14: 28.52
     rank 15: 31.61
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.05
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.14
     rank  9: 0.04
     rank 10: 0.14
     rank 11: 0.07
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.08
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.05
     rank  2: 0.07
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.06
     rank  9: 0.03
     rank 10: 0.06
     rank 11: 0.04
     rank 12: 0.07
     rank 13: 0.05
     rank 14: 0.08
     rank 15: 0.17
  all-grads-sync:
     rank  0: 299.28
     rank  1: 299.33
     rank  2: 299.19
     rank  3: 299.18
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.13
  optimizer-copy-to-main-grad:
     rank  0: 0.19
     rank  1: 0.19
     rank  2: 0.24
     rank  3: 0.18
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.04
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.03
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-inner-step:
     rank  0: 37.83
     rank  1: 37.77
     rank  2: 38.23
     rank  3: 37.96
     rank  4: 0.04
     rank  5: 0.04
     rank  6: 0.03
     rank  7: 0.05
     rank  8: 0.11
     rank  9: 0.11
     rank 10: 0.12
     rank 11: 0.09
     rank 12: 0.05
     rank 13: 0.03
     rank 14: 0.05
     rank 15: 0.16
  optimizer:
     rank  0: 39.01
     rank  1: 38.94
     rank  2: 39.38
     rank  3: 39.13
     rank  4: 1.21
     rank  5: 1.20
     rank  6: 1.20
     rank  7: 1.22
     rank  8: 1.28
     rank  9: 1.28
     rank 10: 1.29
     rank 11: 1.32
     rank 12: 1.22
     rank 13: 1.20
     rank 14: 1.21
     rank 15: 1.32
 [2024-12-30 21:29:41] iteration        4/      10 | consumed samples:          128 | elapsed time per iteration (ms): 2247.1 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 7.029027E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2177.68
     rank  1: 2177.66
     rank  2: 2177.64
     rank  3: 2177.69
     rank  4: 2174.21
     rank  5: 2174.22
     rank  6: 2174.21
     rank  7: 2174.29
     rank  8: 2174.71
     rank  9: 2174.70
     rank 10: 2174.71
     rank 11: 2174.99
     rank 12: 2174.31
     rank 13: 2174.23
     rank 14: 2174.21
     rank 15: 2173.94
  forward-compute:
     rank  0: 431.42
     rank  1: 468.01
     rank  2: 544.70
     rank  3: 429.12
     rank  4: 532.67
     rank  5: 548.96
     rank  6: 527.65
     rank  7: 557.88
     rank  8: 539.33
     rank  9: 527.37
     rank 10: 532.38
     rank 11: 537.30
     rank 12: 666.97
     rank 13: 669.32
     rank 14: 653.71
     rank 15: 667.18
  backward-compute:
     rank  0: 519.86
     rank  1: 506.59
     rank  2: 445.90
     rank  3: 523.38
     rank  4: 623.38
     rank  5: 624.17
     rank  6: 618.28
     rank  7: 626.32
     rank  8: 626.84
     rank  9: 623.53
     rank 10: 625.34
     rank 11: 625.63
     rank 12: 736.50
     rank 13: 736.75
     rank 14: 742.89
     rank 15: 737.26
  pure-backward-compute:
     rank  0: 519.53
     rank  1: 506.11
     rank  2: 445.47
     rank  3: 523.05
     rank  4: 622.62
     rank  5: 623.42
     rank  6: 617.72
     rank  7: 625.28
     rank  8: 625.97
     rank  9: 622.51
     rank 10: 624.33
     rank 11: 624.68
     rank 12: 734.79
     rank 13: 735.50
     rank 14: 741.48
     rank 15: 735.52
  batch-generator:
     rank  0: 23.59
     rank  1: 32.02
     rank  2: 28.96
     rank  3: 22.86
     rank  4: 22.70
     rank  5: 31.88
     rank  6: 22.23
     rank  7: 38.22
     rank  8: 31.79
     rank  9: 29.19
     rank 10: 30.22
     rank 11: 32.03
     rank 12: 31.51
     rank 13: 23.94
     rank 14: 28.22
     rank 15: 29.78
  forward-recv:
     rank  4: 56.22
     rank  5: 56.45
     rank  6: 78.51
     rank  7: 56.16
     rank  8: 124.47
     rank  9: 125.86
     rank 10: 141.75
     rank 11: 127.53
     rank 12: 193.12
     rank 13: 191.30
     rank 14: 206.33
     rank 15: 192.82
  forward-send:
     rank  0: 35.40
     rank  1: 26.93
     rank  2: 2.98
     rank  3: 36.99
     rank  4: 7.71
     rank  5: 4.06
     rank  6: 3.12
     rank  7: 4.76
     rank  8: 3.30
     rank  9: 2.22
     rank 10: 1.65
     rank 11: 3.22
  backward-recv:
     rank  0: 352.81
     rank  1: 347.76
     rank  2: 376.98
     rank  3: 352.67
     rank  4: 198.75
     rank  5: 196.22
     rank  6: 200.78
     rank  7: 196.64
     rank  8: 97.81
     rank  9: 100.31
     rank 10: 97.00
     rank 11: 97.72
  backward-send:
     rank  4: 5.44
     rank  5: 2.72
     rank  6: 4.41
     rank  7: 6.16
     rank  8: 7.23
     rank  9: 3.23
     rank 10: 7.87
     rank 11: 6.84
     rank 12: 3.34
     rank 13: 1.77
     rank 14: 2.70
     rank 15: 3.53
  forward-send-backward-recv:
     rank  0: 514.78
     rank  1: 498.06
     rank  2: 478.85
     rank  3: 512.62
     rank  4: 363.22
     rank  5: 346.47
     rank  6: 357.74
     rank  7: 337.28
     rank  8: 289.24
     rank  9: 301.37
     rank 10: 283.92
     rank 11: 291.10
  backward-send-forward-recv:
     rank  4: 12.05
     rank  5: 13.54
     rank  6: 8.52
     rank  7: 11.69
     rank  8: 30.05
     rank  9: 29.01
     rank 10: 27.77
     rank 11: 27.63
     rank 12: 36.50
     rank 13: 34.74
     rank 14: 31.82
     rank 15: 35.06
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.04
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.27
     rank 12: 0.04
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.05
     rank  2: 0.05
     rank  3: 0.06
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.04
     rank 12: 0.08
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.07
  all-grads-sync:
     rank  0: 312.03
     rank  1: 312.11
     rank  2: 312.11
     rank  3: 312.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.18
     rank  1: 0.22
     rank  2: 0.22
     rank  3: 0.18
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.05
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 37.80
     rank  1: 37.90
     rank  2: 37.77
     rank  3: 37.86
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.04
     rank  8: 0.06
     rank  9: 0.05
     rank 10: 0.07
     rank 11: 0.11
     rank 12: 0.05
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.05
  optimizer:
     rank  0: 39.06
     rank  1: 39.16
     rank  2: 39.03
     rank  3: 39.13
     rank  4: 1.29
     rank  5: 1.29
     rank  6: 1.29
     rank  7: 1.31
     rank  8: 1.10
     rank  9: 1.31
     rank 10: 1.33
     rank 11: 1.37
     rank 12: 1.31
     rank 13: 1.29
     rank 14: 1.29
     rank 15: 1.30
 [2024-12-30 21:29:44] iteration        5/      10 | consumed samples:          160 | elapsed time per iteration (ms): 2232.1 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 6.176864E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2162.76
     rank  1: 2162.83
     rank  2: 2162.76
     rank  3: 2162.75
     rank  4: 2159.17
     rank  5: 2159.22
     rank  6: 2159.17
     rank  7: 2159.18
     rank  8: 2159.70
     rank  9: 2159.70
     rank 10: 2159.69
     rank 11: 2159.94
     rank 12: 2159.28
     rank 13: 2159.20
     rank 14: 2159.21
     rank 15: 2159.22
  forward-compute:
     rank  0: 443.72
     rank  1: 501.49
     rank  2: 458.77
     rank  3: 444.61
     rank  4: 530.17
     rank  5: 543.83
     rank  6: 534.57
     rank  7: 555.89
     rank  8: 533.33
     rank  9: 526.98
     rank 10: 535.73
     rank 11: 533.93
     rank 12: 652.25
     rank 13: 645.30
     rank 14: 646.74
     rank 15: 656.52
  backward-compute:
     rank  0: 488.31
     rank  1: 510.36
     rank  2: 447.51
     rank  3: 491.60
     rank  4: 622.73
     rank  5: 623.66
     rank  6: 621.00
     rank  7: 627.00
     rank  8: 627.44
     rank  9: 625.15
     rank 10: 623.94
     rank 11: 627.68
     rank 12: 739.58
     rank 13: 746.29
     rank 14: 745.22
     rank 15: 736.39
  pure-backward-compute:
     rank  0: 487.91
     rank  1: 509.86
     rank  2: 447.02
     rank  3: 491.18
     rank  4: 622.18
     rank  5: 622.92
     rank  6: 620.41
     rank  7: 626.16
     rank  8: 626.00
     rank  9: 624.21
     rank 10: 622.94
     rank 11: 626.56
     rank 12: 737.98
     rank 13: 744.90
     rank 14: 744.07
     rank 15: 734.94
  batch-generator:
     rank  0: 23.21
     rank  1: 28.47
     rank  2: 26.44
     rank  3: 23.28
     rank  4: 22.66
     rank  5: 29.21
     rank  6: 25.22
     rank  7: 36.01
     rank  8: 30.62
     rank  9: 28.75
     rank 10: 35.27
     rank 11: 30.95
     rank 12: 26.76
     rank 13: 24.40
     rank 14: 22.73
     rank 15: 29.12
  forward-recv:
     rank  4: 54.83
     rank  5: 56.16
     rank  6: 55.64
     rank  7: 55.85
     rank  8: 122.25
     rank  9: 124.66
     rank 10: 123.61
     rank 11: 126.95
     rank 12: 189.47
     rank 13: 192.14
     rank 14: 191.21
     rank 15: 192.62
  forward-send:
     rank  0: 24.60
     rank  1: 26.74
     rank  2: 26.83
     rank  3: 30.69
     rank  4: 4.28
     rank  5: 4.84
     rank  6: 6.90
     rank  7: 3.57
     rank  8: 2.42
     rank  9: 3.59
     rank 10: 3.43
     rank 11: 2.82
  backward-recv:
     rank  0: 353.13
     rank  1: 353.78
     rank  2: 366.00
     rank  3: 352.80
     rank  4: 198.99
     rank  5: 198.25
     rank  6: 198.98
     rank  7: 199.95
     rank  8: 96.48
     rank  9: 96.41
     rank 10: 96.00
     rank 11: 98.41
  backward-send:
     rank  4: 4.34
     rank  5: 4.90
     rank  6: 3.86
     rank  7: 3.01
     rank  8: 7.68
     rank  9: 7.48
     rank 10: 7.41
     rank 11: 3.35
     rank 12: 4.44
     rank 13: 4.15
     rank 14: 4.13
     rank 15: 3.08
  forward-send-backward-recv:
     rank  0: 530.36
     rank  1: 451.29
     rank  2: 534.54
     rank  3: 522.19
     rank  4: 357.62
     rank  5: 340.86
     rank  6: 351.98
     rank  7: 326.21
     rank  8: 283.24
     rank  9: 289.34
     rank 10: 283.30
     rank 11: 289.42
  backward-send-forward-recv:
     rank  4: 12.62
     rank  5: 12.68
     rank  6: 11.15
     rank  7: 8.13
     rank  8: 31.48
     rank  9: 29.53
     rank 10: 29.85
     rank 11: 18.79
     rank 12: 36.82
     rank 13: 35.57
     rank 14: 34.98
     rank 15: 31.79
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.04
     rank  9: 0.03
     rank 10: 0.04
     rank 11: 0.07
     rank 12: 0.09
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.04
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.10
     rank  2: 0.05
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.05
     rank 12: 0.12
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.07
  all-grads-sync:
     rank  0: 307.04
     rank  1: 307.16
     rank  2: 307.07
     rank  3: 306.98
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.18
     rank  1: 0.35
     rank  2: 0.21
     rank  3: 0.18
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.03
     rank  8: 0.04
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-inner-step:
     rank  0: 37.83
     rank  1: 38.48
     rank  2: 37.99
     rank  3: 37.89
     rank  4: 0.03
     rank  5: 0.06
     rank  6: 0.03
     rank  7: 0.09
     rank  8: 0.10
     rank  9: 0.06
     rank 10: 0.06
     rank 11: 0.10
     rank 12: 0.06
     rank 13: 0.03
     rank 14: 0.06
     rank 15: 0.05
  optimizer:
     rank  0: 40.05
     rank  1: 40.70
     rank  2: 40.21
     rank  3: 40.11
     rank  4: 2.25
     rank  5: 2.28
     rank  6: 2.25
     rank  7: 2.31
     rank  8: 2.31
     rank  9: 2.27
     rank 10: 2.27
     rank 11: 2.35
     rank 12: 2.28
     rank 13: 2.25
     rank 14: 2.27
     rank 15: 2.26
 [2024-12-30 21:29:46] iteration        6/      10 | consumed samples:          192 | elapsed time per iteration (ms): 2239.6 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 5.854715E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2172.12
     rank  1: 2172.06
     rank  2: 2172.06
     rank  3: 2172.10
     rank  4: 2168.58
     rank  5: 2168.59
     rank  6: 2168.60
     rank  7: 2168.64
     rank  8: 2169.15
     rank  9: 2169.17
     rank 10: 2169.19
     rank 11: 2169.52
     rank 12: 2168.56
     rank 13: 2168.54
     rank 14: 2168.55
     rank 15: 2168.65
  forward-compute:
     rank  0: 478.67
     rank  1: 565.90
     rank  2: 453.12
     rank  3: 456.27
     rank  4: 539.78
     rank  5: 540.93
     rank  6: 541.66
     rank  7: 547.54
     rank  8: 542.66
     rank  9: 537.85
     rank 10: 537.33
     rank 11: 544.05
     rank 12: 658.44
     rank 13: 645.22
     rank 14: 660.59
     rank 15: 678.19
  backward-compute:
     rank  0: 483.65
     rank  1: 488.33
     rank  2: 449.78
     rank  3: 487.92
     rank  4: 624.42
     rank  5: 622.70
     rank  6: 621.22
     rank  7: 628.25
     rank  8: 626.88
     rank  9: 626.65
     rank 10: 625.70
     rank 11: 629.95
     rank 12: 742.30
     rank 13: 743.89
     rank 14: 747.85
     rank 15: 731.54
  pure-backward-compute:
     rank  0: 483.13
     rank  1: 487.94
     rank  2: 449.26
     rank  3: 487.40
     rank  4: 623.81
     rank  5: 622.21
     rank  6: 620.66
     rank  7: 627.47
     rank  8: 625.92
     rank  9: 625.63
     rank 10: 624.29
     rank 11: 628.68
     rank 12: 740.71
     rank 13: 742.32
     rank 14: 746.61
     rank 15: 730.13
  batch-generator:
     rank  0: 27.50
     rank  1: 29.62
     rank  2: 26.41
     rank  3: 26.03
     rank  4: 25.83
     rank  5: 26.85
     rank  6: 30.26
     rank  7: 28.53
     rank  8: 37.43
     rank  9: 36.97
     rank 10: 35.46
     rank 11: 39.20
     rank 12: 27.94
     rank 13: 23.01
     rank 14: 22.45
     rank 15: 33.56
  forward-recv:
     rank  4: 58.51
     rank  5: 84.07
     rank  6: 55.47
     rank  7: 58.83
     rank  8: 126.29
     rank  9: 151.40
     rank 10: 121.90
     rank 11: 128.29
     rank 12: 192.79
     rank 13: 206.33
     rank 14: 189.01
     rank 15: 195.07
  forward-send:
     rank  0: 29.04
     rank  1: 3.26
     rank  2: 29.46
     rank  3: 31.83
     rank  4: 3.29
     rank  5: 3.18
     rank  6: 4.23
     rank  7: 3.35
     rank  8: 1.64
     rank  9: 1.64
     rank 10: 1.78
     rank 11: 1.55
  backward-recv:
     rank  0: 352.45
     rank  1: 349.02
     rank  2: 368.26
     rank  3: 365.14
     rank  4: 197.46
     rank  5: 198.94
     rank  6: 199.22
     rank  7: 205.42
     rank  8: 95.99
     rank  9: 96.43
     rank 10: 96.39
     rank 11: 101.91
  backward-send:
     rank  4: 4.85
     rank  5: 4.45
     rank  6: 5.28
     rank  7: 3.72
     rank  8: 7.96
     rank  9: 7.81
     rank 10: 8.21
     rank 11: 6.31
     rank 12: 4.05
     rank 13: 4.52
     rank 14: 4.53
     rank 15: 4.62
  forward-send-backward-recv:
     rank  0: 504.47
     rank  1: 443.69
     rank  2: 546.74
     rank  3: 510.69
     rank  4: 356.32
     rank  5: 329.82
     rank  6: 358.87
     rank  7: 340.86
     rank  8: 285.80
     rank  9: 263.93
     rank 10: 294.14
     rank 11: 287.14
  backward-send-forward-recv:
     rank  4: 10.51
     rank  5: 11.58
     rank  6: 10.13
     rank  7: 7.90
     rank  8: 27.22
     rank  9: 28.38
     rank 10: 29.07
     rank 11: 15.81
     rank 12: 34.02
     rank 13: 32.72
     rank 14: 31.58
     rank 15: 21.00
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.04
     rank  9: 0.06
     rank 10: 0.03
     rank 11: 0.14
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.09
  embedding-grads-all-reduce:
     rank  0: 0.10
     rank  1: 0.05
     rank  2: 0.05
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.08
     rank 12: 0.07
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.12
  all-grads-sync:
     rank  0: 308.91
     rank  1: 309.04
     rank  2: 308.98
     rank  3: 308.84
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.03
  optimizer-copy-to-main-grad:
     rank  0: 0.33
     rank  1: 0.20
     rank  2: 0.19
     rank  3: 0.18
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.05
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.05
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.03
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 38.22
     rank  1: 37.61
     rank  2: 37.82
     rank  3: 37.66
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.04
     rank  7: 0.04
     rank  8: 0.05
     rank  9: 0.11
     rank 10: 0.11
     rank 11: 0.20
     rank 12: 0.09
     rank 13: 0.03
     rank 14: 0.04
     rank 15: 0.14
  optimizer:
     rank  0: 39.80
     rank  1: 39.12
     rank  2: 39.36
     rank  3: 39.18
     rank  4: 1.54
     rank  5: 1.54
     rank  6: 1.56
     rank  7: 1.56
     rank  8: 1.56
     rank  9: 1.62
     rank 10: 1.62
     rank 11: 1.72
     rank 12: 1.60
     rank 13: 1.54
     rank 14: 1.55
     rank 15: 1.65
 [2024-12-30 21:29:48] iteration        7/      10 | consumed samples:          224 | elapsed time per iteration (ms): 2240.3 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 4.885483E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2173.69
     rank  1: 2173.65
     rank  2: 2173.63
     rank  3: 2173.65
     rank  4: 2170.15
     rank  5: 2170.19
     rank  6: 2170.14
     rank  7: 2170.17
     rank  8: 2170.33
     rank  9: 2170.29
     rank 10: 2170.26
     rank 11: 2170.28
     rank 12: 2170.19
     rank 13: 2170.14
     rank 14: 2170.14
     rank 15: 2170.20
  forward-compute:
     rank  0: 581.45
     rank  1: 447.54
     rank  2: 444.34
     rank  3: 437.04
     rank  4: 535.31
     rank  5: 533.94
     rank  6: 543.83
     rank  7: 546.70
     rank  8: 534.35
     rank  9: 535.96
     rank 10: 537.10
     rank 11: 540.26
     rank 12: 650.58
     rank 13: 658.71
     rank 14: 658.12
     rank 15: 675.06
  backward-compute:
     rank  0: 488.10
     rank  1: 488.40
     rank  2: 450.28
     rank  3: 480.00
     rank  4: 625.43
     rank  5: 621.54
     rank  6: 621.11
     rank  7: 626.69
     rank  8: 627.57
     rank  9: 626.99
     rank 10: 624.79
     rank 11: 628.37
     rank 12: 742.84
     rank 13: 744.74
     rank 14: 752.04
     rank 15: 737.35
  pure-backward-compute:
     rank  0: 487.39
     rank  1: 488.04
     rank  2: 449.88
     rank  3: 479.64
     rank  4: 624.85
     rank  5: 621.05
     rank  6: 620.45
     rank  7: 626.10
     rank  8: 626.62
     rank  9: 625.84
     rank 10: 623.71
     rank 11: 627.47
     rank 12: 741.20
     rank 13: 743.41
     rank 14: 750.90
     rank 15: 735.89
  batch-generator:
     rank  0: 41.43
     rank  1: 26.84
     rank  2: 27.73
     rank  3: 23.25
     rank  4: 22.83
     rank  5: 23.14
     rank  6: 30.95
     rank  7: 29.08
     rank  8: 28.58
     rank  9: 33.77
     rank 10: 34.11
     rank 11: 35.64
     rank 12: 27.29
     rank 13: 24.94
     rank 14: 23.06
     rank 15: 31.41
  forward-recv:
     rank  4: 76.33
     rank  5: 58.22
     rank  6: 57.73
     rank  7: 56.03
     rank  8: 144.81
     rank  9: 128.53
     rank 10: 128.83
     rank 11: 129.77
     rank 12: 206.49
     rank 13: 194.16
     rank 14: 194.16
     rank 15: 192.34
  forward-send:
     rank  0: 3.54
     rank  1: 40.48
     rank  2: 39.75
     rank  3: 41.11
     rank  4: 3.13
     rank  5: 8.13
     rank  6: 7.83
     rank  7: 7.07
     rank  8: 1.64
     rank  9: 3.43
     rank 10: 3.41
     rank 11: 2.25
  backward-recv:
     rank  0: 351.16
     rank  1: 353.25
     rank  2: 368.02
     rank  3: 372.02
     rank  4: 195.49
     rank  5: 192.02
     rank  6: 197.97
     rank  7: 202.41
     rank  8: 94.24
     rank  9: 90.60
     rank 10: 94.49
     rank 11: 100.79
  backward-send:
     rank  4: 2.69
     rank  5: 3.44
     rank  6: 3.64
     rank  7: 3.22
     rank  8: 4.10
     rank  9: 5.08
     rank 10: 6.27
     rank 11: 4.13
     rank 12: 1.84
     rank 13: 1.55
     rank 14: 2.48
     rank 15: 2.90
  forward-send-backward-recv:
     rank  0: 423.98
     rank  1: 524.06
     rank  2: 547.62
     rank  3: 523.77
     rank  4: 343.79
     rank  5: 362.44
     rank  6: 353.21
     rank  7: 346.13
     rank  8: 278.70
     rank  9: 292.26
     rank 10: 293.84
     rank 11: 288.80
  backward-send-forward-recv:
     rank  4: 12.90
     rank  5: 13.32
     rank  6: 12.66
     rank  7: 10.18
     rank  8: 29.77
     rank  9: 30.46
     rank 10: 29.46
     rank 11: 23.55
     rank 12: 34.16
     rank 13: 35.35
     rank 14: 32.08
     rank 15: 29.98
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.07
     rank  1: 0.04
     rank  2: 0.05
     rank  3: 0.04
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.07
     rank 13: 0.06
     rank 14: 0.05
     rank 15: 0.07
  all-grads-sync:
     rank  0: 309.24
     rank  1: 309.38
     rank  2: 309.29
     rank  3: 309.21
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.22
     rank  1: 0.19
     rank  2: 0.20
     rank  3: 0.18
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.04
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 38.23
     rank  1: 37.83
     rank  2: 37.90
     rank  3: 37.88
     rank  4: 0.03
     rank  5: 0.04
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.10
     rank  9: 0.05
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.05
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.05
  optimizer:
     rank  0: 39.17
     rank  1: 38.77
     rank  2: 38.84
     rank  3: 38.83
     rank  4: 0.97
     rank  5: 0.98
     rank  6: 0.98
     rank  7: 0.98
     rank  8: 1.04
     rank  9: 0.99
     rank 10: 0.99
     rank 11: 0.99
     rank 12: 0.99
     rank 13: 0.97
     rank 14: 0.96
     rank 15: 0.99
 [2024-12-30 21:29:50] iteration        8/      10 | consumed samples:          256 | elapsed time per iteration (ms): 2239.8 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 3.873352E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2172.93
     rank  1: 2172.86
     rank  2: 2172.86
     rank  3: 2172.91
     rank  4: 2169.31
     rank  5: 2169.30
     rank  6: 2169.30
     rank  7: 2169.34
     rank  8: 2169.54
     rank  9: 2169.52
     rank 10: 2169.56
     rank 11: 2169.61
     rank 12: 2169.41
     rank 13: 2169.35
     rank 14: 2169.34
     rank 15: 2169.39
  forward-compute:
     rank  0: 563.56
     rank  1: 543.78
     rank  2: 442.18
     rank  3: 459.17
     rank  4: 534.06
     rank  5: 542.42
     rank  6: 536.50
     rank  7: 549.73
     rank  8: 539.91
     rank  9: 535.44
     rank 10: 535.22
     rank 11: 544.57
     rank 12: 650.07
     rank 13: 677.86
     rank 14: 670.26
     rank 15: 662.51
  backward-compute:
     rank  0: 496.02
     rank  1: 486.79
     rank  2: 459.45
     rank  3: 437.51
     rank  4: 625.21
     rank  5: 626.52
     rank  6: 622.00
     rank  7: 625.72
     rank  8: 623.53
     rank  9: 627.81
     rank 10: 624.60
     rank 11: 627.84
     rank 12: 744.37
     rank 13: 734.37
     rank 14: 743.84
     rank 15: 741.95
  pure-backward-compute:
     rank  0: 495.47
     rank  1: 486.30
     rank  2: 459.11
     rank  3: 437.10
     rank  4: 624.69
     rank  5: 625.93
     rank  6: 621.41
     rank  7: 625.16
     rank  8: 622.40
     rank  9: 626.93
     rank 10: 623.64
     rank 11: 626.64
     rank 12: 742.49
     rank 13: 733.18
     rank 14: 742.76
     rank 15: 740.46
  batch-generator:
     rank  0: 36.98
     rank  1: 30.25
     rank  2: 29.20
     rank  3: 23.36
     rank  4: 22.54
     rank  5: 26.61
     rank  6: 29.13
     rank  7: 30.24
     rank  8: 35.78
     rank  9: 34.06
     rank 10: 33.52
     rank 11: 40.24
     rank 12: 27.03
     rank 13: 25.50
     rank 14: 24.59
     rank 15: 28.86
  forward-recv:
     rank  4: 74.27
     rank  5: 65.48
     rank  6: 55.34
     rank  7: 55.32
     rank  8: 141.93
     rank  9: 132.79
     rank 10: 122.96
     rank 11: 124.40
     rank 12: 203.26
     rank 13: 191.39
     rank 14: 188.00
     rank 15: 191.53
  forward-send:
     rank  0: 3.06
     rank  1: 3.91
     rank  2: 30.48
     rank  3: 33.42
     rank  4: 3.18
     rank  5: 4.50
     rank  6: 3.49
     rank  7: 4.75
     rank  8: 1.61
     rank  9: 2.72
     rank 10: 1.73
     rank 11: 2.87
  backward-recv:
     rank  0: 356.29
     rank  1: 348.92
     rank  2: 369.81
     rank  3: 374.66
     rank  4: 195.94
     rank  5: 196.51
     rank  6: 197.73
     rank  7: 197.21
     rank  8: 96.98
     rank  9: 98.02
     rank 10: 96.77
     rank 11: 96.17
  backward-send:
     rank  4: 3.97
     rank  5: 2.54
     rank  6: 4.63
     rank  7: 4.91
     rank  8: 5.23
     rank  9: 3.25
     rank 10: 6.90
     rank 11: 6.82
     rank 12: 3.63
     rank 13: 1.57
     rank 14: 3.26
     rank 15: 3.70
  forward-send-backward-recv:
     rank  0: 431.36
     rank  1: 464.14
     rank  2: 552.10
     rank  3: 548.59
     rank  4: 350.25
     rank  5: 346.28
     rank  6: 370.99
     rank  7: 351.26
     rank  8: 277.37
     rank  9: 290.36
     rank 10: 304.89
     rank 11: 288.89
  backward-send-forward-recv:
     rank  4: 10.20
     rank  5: 8.76
     rank  6: 7.67
     rank  7: 10.06
     rank  8: 29.65
     rank  9: 22.99
     rank 10: 24.99
     rank 11: 26.53
     rank 12: 34.88
     rank 13: 28.71
     rank 14: 32.82
     rank 15: 37.09
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.06
     rank  1: 0.05
     rank  2: 0.05
     rank  3: 0.06
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.07
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.07
  all-grads-sync:
     rank  0: 308.13
     rank  1: 308.23
     rank  2: 308.21
     rank  3: 308.09
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.22
     rank  1: 0.20
     rank  2: 0.20
     rank  3: 0.22
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 38.12
     rank  1: 37.83
     rank  2: 37.95
     rank  3: 38.20
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.06
     rank  7: 0.05
     rank  8: 0.05
     rank  9: 0.05
     rank 10: 0.05
     rank 11: 0.10
     rank 12: 0.05
     rank 13: 0.03
     rank 14: 0.04
     rank 15: 0.05
  optimizer:
     rank  0: 40.21
     rank  1: 39.93
     rank  2: 40.05
     rank  3: 40.30
     rank  4: 2.13
     rank  5: 2.13
     rank  6: 2.15
     rank  7: 2.15
     rank  8: 2.14
     rank  9: 2.14
     rank 10: 1.07
     rank 11: 2.20
     rank 12: 2.14
     rank 13: 2.13
     rank 14: 2.13
     rank 15: 2.14
 [2024-12-30 21:29:53] iteration        9/      10 | consumed samples:          288 | elapsed time per iteration (ms): 2250.2 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 3.744639E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2183.69
     rank  1: 2183.73
     rank  2: 2183.69
     rank  3: 2183.70
     rank  4: 2180.18
     rank  5: 2180.17
     rank  6: 2180.17
     rank  7: 2180.21
     rank  8: 2180.73
     rank  9: 2180.56
     rank 10: 2180.56
     rank 11: 2180.69
     rank 12: 2180.30
     rank 13: 2180.23
     rank 14: 2180.24
     rank 15: 2180.25
  forward-compute:
     rank  0: 465.67
     rank  1: 443.42
     rank  2: 448.96
     rank  3: 523.61
     rank  4: 535.38
     rank  5: 535.83
     rank  6: 544.49
     rank  7: 544.30
     rank  8: 542.15
     rank  9: 531.76
     rank 10: 537.94
     rank 11: 535.81
     rank 12: 665.31
     rank 13: 668.36
     rank 14: 674.58
     rank 15: 648.20
  backward-compute:
     rank  0: 472.84
     rank  1: 510.45
     rank  2: 452.05
     rank  3: 441.98
     rank  4: 623.74
     rank  5: 623.16
     rank  6: 621.20
     rank  7: 626.96
     rank  8: 625.80
     rank  9: 627.46
     rank 10: 628.90
     rank 11: 627.83
     rank 12: 734.13
     rank 13: 746.32
     rank 14: 746.53
     rank 15: 748.20
  pure-backward-compute:
     rank  0: 472.50
     rank  1: 509.97
     rank  2: 451.60
     rank  3: 441.56
     rank  4: 623.30
     rank  5: 622.60
     rank  6: 620.35
     rank  7: 626.26
     rank  8: 624.88
     rank  9: 626.34
     rank 10: 627.72
     rank 11: 626.61
     rank 12: 732.60
     rank 13: 745.16
     rank 14: 745.47
     rank 15: 746.56
  batch-generator:
     rank  0: 24.02
     rank  1: 23.22
     rank  2: 29.62
     rank  3: 32.49
     rank  4: 21.82
     rank  5: 22.67
     rank  6: 31.03
     rank  7: 26.25
     rank  8: 39.76
     rank  9: 29.34
     rank 10: 33.99
     rank 11: 32.31
     rank 12: 28.53
     rank 13: 24.60
     rank 14: 25.19
     rank 15: 26.54
  forward-recv:
     rank  4: 72.42
     rank  5: 57.02
     rank  6: 54.01
     rank  7: 74.48
     rank  8: 142.57
     rank  9: 125.23
     rank 10: 120.86
     rank 11: 143.92
     rank 12: 207.82
     rank 13: 190.22
     rank 14: 186.44
     rank 15: 208.38
  forward-send:
     rank  0: 19.76
     rank  1: 28.06
     rank  2: 27.00
     rank  3: 4.49
     rank  4: 4.35
     rank  5: 3.19
     rank  6: 3.18
     rank  7: 4.42
     rank  8: 2.23
     rank  9: 1.64
     rank 10: 1.72
     rank 11: 2.35
  backward-recv:
     rank  0: 360.42
     rank  1: 355.18
     rank  2: 366.53
     rank  3: 369.57
     rank  4: 198.45
     rank  5: 201.81
     rank  6: 203.76
     rank  7: 200.00
     rank  8: 98.31
     rank  9: 98.01
     rank 10: 96.79
     rank 11: 97.12
  backward-send:
     rank  4: 2.62
     rank  5: 3.47
     rank  6: 3.95
     rank  7: 4.43
     rank  8: 3.15
     rank  9: 6.78
     rank 10: 7.64
     rank 11: 7.33
     rank 12: 1.61
     rank 13: 3.96
     rank 14: 3.80
     rank 15: 3.91
  forward-send-backward-recv:
     rank  0: 533.48
     rank  1: 523.66
     rank  2: 560.84
     rank  3: 515.73
     rank  4: 353.96
     rank  5: 371.44
     rank  6: 365.31
     rank  7: 341.37
     rank  8: 286.63
     rank  9: 308.39
     rank 10: 308.56
     rank 11: 286.90
  backward-send-forward-recv:
     rank  4: 7.18
     rank  5: 9.40
     rank  6: 8.41
     rank  7: 9.40
     rank  8: 17.13
     rank  9: 25.32
     rank 10: 21.76
     rank 11: 23.46
     rank 12: 29.63
     rank 13: 34.34
     rank 14: 31.68
     rank 15: 33.62
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.08
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.05
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.04
     rank  1: 0.06
     rank  2: 0.05
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.05
     rank  9: 0.03
     rank 10: 0.04
     rank 11: 0.05
     rank 12: 0.08
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.07
  all-grads-sync:
     rank  0: 311.62
     rank  1: 311.73
     rank  2: 311.69
     rank  3: 311.58
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.18
     rank  1: 0.25
     rank  2: 0.21
     rank  3: 0.17
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.05
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.04
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.03
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-inner-step:
     rank  0: 37.71
     rank  1: 38.09
     rank  2: 37.89
     rank  3: 37.86
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.04
     rank  7: 0.04
     rank  8: 0.16
     rank  9: 0.05
     rank 10: 0.12
     rank 11: 0.08
     rank 12: 0.05
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.05
  optimizer:
     rank  0: 38.94
     rank  1: 39.31
     rank  2: 39.12
     rank  3: 39.10
     rank  4: 1.26
     rank  5: 1.26
     rank  6: 1.26
     rank  7: 1.27
     rank  8: 1.39
     rank  9: 1.28
     rank 10: 1.34
     rank 11: 1.31
     rank 12: 1.28
     rank 13: 1.26
     rank 14: 1.26
     rank 15: 1.27
 [2024-12-30 21:29:55] iteration       10/      10 | consumed samples:          320 | elapsed time per iteration (ms): 2268.5 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 3.496022E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2180.70
     rank  1: 2180.69
     rank  2: 2180.70
     rank  3: 2180.74
     rank  4: 2177.20
     rank  5: 2177.23
     rank  6: 2177.20
     rank  7: 2177.24
     rank  8: 2177.34
     rank  9: 2177.40
     rank 10: 2177.46
     rank 11: 2177.44
     rank 12: 2177.28
     rank 13: 2177.24
     rank 14: 2177.24
     rank 15: 2177.29
  forward-compute:
     rank  0: 495.43
     rank  1: 547.88
     rank  2: 452.82
     rank  3: 444.42
     rank  4: 544.65
     rank  5: 545.37
     rank  6: 531.62
     rank  7: 541.23
     rank  8: 530.93
     rank  9: 536.33
     rank 10: 534.91
     rank 11: 533.45
     rank 12: 663.07
     rank 13: 654.92
     rank 14: 670.14
     rank 15: 678.60
  backward-compute:
     rank  0: 471.31
     rank  1: 477.43
     rank  2: 491.30
     rank  3: 471.90
     rank  4: 625.02
     rank  5: 625.15
     rank  6: 621.92
     rank  7: 627.96
     rank  8: 624.55
     rank  9: 627.21
     rank 10: 627.23
     rank 11: 624.73
     rank 12: 748.35
     rank 13: 743.35
     rank 14: 744.87
     rank 15: 735.06
  pure-backward-compute:
     rank  0: 470.92
     rank  1: 477.01
     rank  2: 490.96
     rank  3: 471.51
     rank  4: 624.45
     rank  5: 624.62
     rank  6: 621.34
     rank  7: 627.45
     rank  8: 623.51
     rank  9: 626.30
     rank 10: 626.14
     rank 11: 623.31
     rank 12: 746.73
     rank 13: 741.78
     rank 14: 743.64
     rank 15: 733.69
  batch-generator:
     rank  0: 25.86
     rank  1: 28.07
     rank  2: 24.32
     rank  3: 23.57
     rank  4: 28.02
     rank  5: 29.14
     rank  6: 22.65
     rank  7: 25.24
     rank  8: 29.84
     rank  9: 33.02
     rank 10: 30.79
     rank 11: 30.09
     rank 12: 26.72
     rank 13: 24.26
     rank 14: 25.51
     rank 15: 32.96
  forward-recv:
     rank  4: 60.28
     rank  5: 74.02
     rank  6: 56.06
     rank  7: 58.10
     rank  8: 128.61
     rank  9: 142.64
     rank 10: 123.02
     rank 11: 126.13
     rank 12: 193.14
     rank 13: 205.01
     rank 14: 188.80
     rank 15: 193.89
  forward-send:
     rank  0: 3.14
     rank  1: 4.21
     rank  2: 22.50
     rank  3: 27.97
     rank  4: 3.92
     rank  5: 3.12
     rank  6: 3.17
     rank  7: 4.13
     rank  8: 2.13
     rank  9: 1.66
     rank 10: 1.77
     rank 11: 2.36
  backward-recv:
     rank  0: 353.73
     rank  1: 364.97
     rank  2: 349.55
     rank  3: 352.16
     rank  4: 197.40
     rank  5: 197.59
     rank  6: 198.20
     rank  7: 198.46
     rank  8: 96.53
     rank  9: 96.17
     rank 10: 97.02
     rank 11: 99.57
  backward-send:
     rank  4: 5.13
     rank  5: 4.15
     rank  6: 4.83
     rank  7: 2.71
     rank  8: 6.93
     rank  9: 6.24
     rank 10: 7.16
     rank 11: 3.18
     rank 12: 3.39
     rank 13: 2.98
     rank 14: 3.31
     rank 15: 1.55
  forward-send-backward-recv:
     rank  0: 532.90
     rank  1: 456.90
     rank  2: 545.43
     rank  3: 552.93
     rank  4: 353.57
     rank  5: 338.70
     rank  6: 376.92
     rank  7: 352.57
     rank  8: 301.61
     rank  9: 279.78
     rank 10: 299.41
     rank 11: 304.05
  backward-send-forward-recv:
     rank  4: 11.59
     rank  5: 12.10
     rank  6: 9.19
     rank  7: 8.73
     rank  8: 28.36
     rank  9: 29.14
     rank 10: 30.32
     rank 11: 20.64
     rank 12: 31.61
     rank 13: 32.26
     rank 14: 32.58
     rank 15: 26.39
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.05
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  embedding-grads-all-reduce:
     rank  0: 0.05
     rank  1: 0.05
     rank  2: 0.05
     rank  3: 0.05
     rank  4: 0.02
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.06
     rank 13: 0.05
     rank 14: 0.05
     rank 15: 0.06
  all-grads-sync:
     rank  0: 308.61
     rank  1: 308.77
     rank  2: 308.70
     rank  3: 308.57
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.19
     rank  1: 0.20
     rank  2: 0.19
     rank  3: 0.18
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 37.84
     rank  1: 37.86
     rank  2: 37.88
     rank  3: 37.87
     rank  4: 0.03
     rank  5: 0.05
     rank  6: 0.03
     rank  7: 0.03
     rank  8: 0.05
     rank  9: 0.05
     rank 10: 0.05
     rank 11: 0.11
     rank 12: 0.04
     rank 13: 0.03
     rank 14: 0.03
     rank 15: 0.05
  optimizer:
     rank  0: 38.81
     rank  1: 38.82
     rank  2: 38.85
     rank  3: 38.83
     rank  4: 1.00
     rank  5: 1.02
     rank  6: 1.00
     rank  7: 1.00
     rank  8: 1.02
     rank  9: 1.02
     rank 10: 1.02
     rank 11: 1.08
     rank 12: 1.02
     rank 13: 1.00
     rank 14: 1.00
     rank 15: 1.02
