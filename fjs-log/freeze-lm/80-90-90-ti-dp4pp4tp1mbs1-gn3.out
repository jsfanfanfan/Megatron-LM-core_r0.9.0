examples/multimodal/pretrain-freeze-llm-hete-2080first.sh: line 4: activate: No such file or directory
3
[2024-12-30 22:08:11,204] torch.distributed.run: [WARNING] 
[2024-12-30 22:08:11,204] torch.distributed.run: [WARNING] *****************************************
[2024-12-30 22:08:11,204] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-12-30 22:08:11,204] torch.distributed.run: [WARNING] *****************************************
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
You set `add_prefix_space`. The tokenizer needs to be converted from the slow tokenizers
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
> setting tensorboard ...
WARNING: one_logger package is required to enable e2e metrics tracking. please go to https://confluence.nvidia.com/display/MLWFO/Package+Repositories for details to install it
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
------pipeline_parallel_model_size:4------
------world_size:16------
------total_model_size:4------
------num_pipeline_model_parallel_groups:4------
---Rank 14---Tensor Parallel Group GPUs: [0]
---Rank 15---Tensor Parallel Group GPUs: [0]
---Rank 14---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
---Rank 15---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
[rank14]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
---Rank 12---Tensor Parallel Group GPUs: [0]
---Rank 12---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
[rank15]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
[rank12]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
---Rank 13---Tensor Parallel Group GPUs: [0]
---Rank 13---Pipeline Parallel Group GPUs: [3, 3, 3, 3]
[rank13]:[W init.cpp:767] Warning: nvfuser is no longer supported in torch script, use _jit_set_nvfuser_enabled is deprecated and a no-op (function operator())
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
WARNING:megatron.core.models.multimodal.llava_model:LLaVA model is under active development. It may be missing features and its methods may change.
 > number of parameters on (tensor, pipeline) model parallel rank (0, 3): 352333824
rank=2, worker=0: shard_range=[pretrain-31.tar[0, 100), pretrain-31.tar[100, 200), pretrain-31.tar[200, 300), ...<619>, pretrain-37.tar[2200, 2300), pretrain-37.tar[2300, 2400), pretrain-37.tar[2400, 2500)] sum(count)=62500
rank=2, worker=1: shard_range=[pretrain-37.tar[2500, 2600), pretrain-37.tar[2600, 2700), pretrain-37.tar[2700, 2800), ...<619>, pretrain-42.tar[4700, 4800), pretrain-42.tar[4800, 4900), pretrain-42.tar[4900, 5000)] sum(count)=62500
rank=1, worker=0: shard_range=[pretrain-2.tar[5000, 5100), pretrain-2.tar[5100, 5200), pretrain-2.tar[5200, 5300), ...<619>, pretrain-25.tar[7200, 7300), pretrain-25.tar[7300, 7400), pretrain-25.tar[7400, 7500)] sum(count)=62500
rank=1, worker=1: shard_range=[pretrain-25.tar[7500, 7600), pretrain-25.tar[7600, 7700), pretrain-25.tar[7700, 7800), ...<619>, pretrain-30.tar[9700, 9800), pretrain-30.tar[9800, 9900), pretrain-30.tar[9900, 10000)] sum(count)=62500
rank=0, worker=0: shard_range=[pretrain-0.tar[0, 100), pretrain-0.tar[100, 200), pretrain-0.tar[200, 300), ...<619>, pretrain-14.tar[2200, 2300), pretrain-14.tar[2300, 2400), pretrain-14.tar[2400, 2500)] sum(count)=62500
rank=0, worker=1: shard_range=[pretrain-14.tar[2500, 2600), pretrain-14.tar[2600, 2700), pretrain-14.tar[2700, 2800), ...<619>, pretrain-2.tar[4700, 4800), pretrain-2.tar[4800, 4900), pretrain-2.tar[4900, 5000)] sum(count)=62500
rank=3, worker=0: shard_range=[pretrain-42.tar[5000, 5100), pretrain-42.tar[5100, 5200), pretrain-42.tar[5200, 5300), ...<619>, pretrain-48.tar[7200, 7300), pretrain-48.tar[7300, 7400), pretrain-48.tar[7400, 7500)] sum(count)=62500
rank=3, worker=1: shard_range=[pretrain-48.tar[7500, 7600), pretrain-48.tar[7600, 7700), pretrain-48.tar[7700, 7800), ...<619>, pretrain-53.tar[9700, 9800), pretrain-53.tar[9800, 9900), pretrain-53.tar[9900, 10000)] sum(count)=62500
rank=2, worker=0: shard_range=[pretrain-7.tar[936, 8202)] sum(count)=7266
rank=2, worker=1: shard_range=[pretrain-7.tar[8202, 10000), pretrain-8.tar[0, 5468)] sum(count)=7266
rank=3, worker=0: shard_range=[pretrain-8.tar[5468, 10000), pretrain-9.tar[0, 2734)] sum(count)=7266
rank=3, worker=1: shard_range=[pretrain-9.tar[2734, 10000)] sum(count)=7266
rank=0, worker=0: shard_range=[pretrain-54.tar[0, 7266)] sum(count)=7266
rank=0, worker=1: shard_range=[pretrain-54.tar[7266, 10000), pretrain-55.tar[0, 4532)] sum(count)=7266
rank=1, worker=0: shard_range=[pretrain-55.tar[4532, 8128), pretrain-6.tar[0, 3670)] sum(count)=7266
rank=1, worker=1: shard_range=[pretrain-6.tar[3670, 10000), pretrain-7.tar[0, 936)] sum(count)=7266
times across ranks (ms):
  model-and-optimizer-setup:
     rank  0: 54.96
     rank  1: 53.18
     rank  2: 54.40
     rank  3: 53.15
     rank  4: 125.56
     rank  5: 114.97
     rank  6: 116.17
     rank  7: 118.68
     rank  8: 43.98
     rank  9: 42.82
     rank 10: 42.95
     rank 11: 31.45
     rank 12: 46.52
     rank 13: 46.77
     rank 14: 46.98
     rank 15: 46.49
  train/valid/test-data-iterators-setup:
     rank  0: 1067.40
     rank  1: 1089.64
     rank  2: 1333.37
     rank  3: 1089.57
     rank  4: 1092.73
     rank  5: 1093.07
     rank  6: 1092.74
     rank  7: 1203.89
     rank  8: 1210.96
     rank  9: 1210.97
     rank 10: 1210.97
     rank 11: 1211.08
     rank 12: 1294.40
     rank 13: 1333.58
     rank 14: 1211.13
     rank 15: 1333.26
 [2024-12-30 22:08:44] iteration        1/      10 | consumed samples:           32 | elapsed time per iteration (ms): 13274.5 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 7.197387E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
stage4 GPU utialization:17.536475441672586 %
[Rank 12] (after 1 iterations) memory (MB) | allocated: 1397.2998046875 | max allocated: 1975.30859375 | reserved: 2142.0 | max reserved: 2142.0
times across ranks (ms):
  forward-backward:
     rank  0: 13107.11
     rank  1: 13107.56
     rank  2: 13107.62
     rank  3: 13110.34
     rank  4: 13103.59
     rank  5: 13103.58
     rank  6: 13103.59
     rank  7: 13103.67
     rank  8: 13228.44
     rank  9: 13228.45
     rank 10: 13228.79
     rank 11: 13228.40
     rank 12: 13101.89
     rank 13: 13101.79
     rank 14: 13101.81
     rank 15: 13101.68
  forward-compute:
     rank  0: 2308.13
     rank  1: 2330.69
     rank  2: 2326.82
     rank  3: 2322.60
     rank  4: 3991.29
     rank  5: 4140.41
     rank  6: 4116.83
     rank  7: 3995.37
     rank  8: 2589.17
     rank  9: 2810.55
     rank 10: 2905.91
     rank 11: 2830.32
     rank 12: 2505.03
     rank 13: 2850.49
     rank 14: 2816.87
     rank 15: 2298.15
  backward-compute:
     rank  0: 1181.85
     rank  1: 1160.23
     rank  2: 1157.84
     rank  3: 1166.51
     rank  4: 1738.69
     rank  5: 1580.61
     rank  6: 1587.11
     rank  7: 1769.28
     rank  8: 940.77
     rank  9: 927.47
     rank 10: 925.56
     rank 11: 937.43
     rank 12: 539.85
     rank 13: 526.54
     rank 14: 528.60
     rank 15: 543.45
  pure-backward-compute:
     rank  0: 1181.32
     rank  1: 1159.67
     rank  2: 1157.32
     rank  3: 1166.02
     rank  4: 1737.95
     rank  5: 1579.91
     rank  6: 1586.41
     rank  7: 1768.63
     rank  8: 939.99
     rank  9: 926.56
     rank 10: 924.35
     rank 11: 936.44
     rank 12: 537.91
     rank 13: 524.76
     rank 14: 527.22
     rank 15: 541.92
  batch-generator:
     rank  0: 1021.58
     rank  1: 1048.70
     rank  2: 1058.73
     rank  3: 1050.77
     rank  4: 906.11
     rank  5: 1088.20
     rank  6: 1043.03
     rank  7: 1043.51
     rank  8: 1013.19
     rank  9: 1001.59
     rank 10: 1027.88
     rank 11: 955.14
     rank 12: 1207.57
     rank 13: 1218.34
     rank 14: 1249.93
     rank 15: 1281.11
  forward-recv:
     rank  4: 2198.34
     rank  5: 2216.53
     rank  6: 2219.00
     rank  7: 2214.75
     rank  8: 5350.10
     rank  9: 5593.64
     rank 10: 5532.05
     rank 11: 5456.71
     rank 12: 7283.11
     rank 13: 7751.20
     rank 14: 7777.21
     rank 15: 7622.98
  forward-send:
     rank  0: 5156.75
     rank  1: 5615.14
     rank  2: 5642.41
     rank  3: 5486.33
     rank  4: 1820.46
     rank  5: 2078.97
     rank  6: 2133.49
     rank  7: 2093.59
     rank  8: 26.83
     rank  9: 21.90
     rank 10: 23.77
     rank 11: 23.39
  backward-recv:
     rank  0: 483.77
     rank  1: 649.13
     rank  2: 647.48
     rank  3: 510.13
     rank  4: 91.15
     rank  5: 251.89
     rank  6: 244.84
     rank  7: 126.06
     rank  8: 12.92
     rank  9: 138.74
     rank 10: 138.00
     rank 11: 50.28
  backward-send:
     rank  4: 1.16
     rank  5: 1.03
     rank  6: 1.34
     rank  7: 1.08
     rank  8: 4.47
     rank  9: 4.45
     rank 10: 3.26
     rank 11: 3.24
     rank 12: 3.73
     rank 13: 3.69
     rank 14: 2.94
     rank 15: 3.70
  forward-send-backward-recv:
     rank  0: 3627.72
     rank  1: 3003.12
     rank  2: 2980.94
     rank  3: 3270.97
     rank  4: 2172.62
     rank  5: 1789.03
     rank  6: 1757.09
     rank  7: 1815.89
     rank  8: 2057.93
     rank  9: 1779.54
     rank 10: 1748.44
     rank 11: 1702.03
  backward-send-forward-recv:
     rank  4: 702.13
     rank  5: 659.03
     rank  6: 655.51
     rank  7: 698.58
     rank  8: 1608.05
     rank  9: 1314.03
     rank 10: 1308.27
     rank 11: 1583.83
     rank 12: 2140.42
     rank 13: 1339.14
     rank 14: 1344.72
     rank 15: 2001.83
  layernorm-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.04
     rank  2: 0.04
     rank  3: 0.33
     rank  4: 0.03
     rank  5: 0.03
     rank  6: 0.03
     rank  7: 0.04
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.04
     rank 11: 0.04
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.04
  embedding-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.08
     rank  4: 0.09
     rank  5: 0.11
     rank  6: 0.09
     rank  7: 0.13
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.04
     rank 11: 0.03
     rank 12: 0.10
     rank 13: 0.08
     rank 14: 0.10
     rank 15: 0.09
  all-grads-sync:
     rank  0: 311.99
     rank  1: 311.91
     rank  2: 311.92
     rank  3: 311.91
     rank  4: 335.17
     rank  5: 335.23
     rank  6: 335.20
     rank  7: 335.18
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.05
     rank 15: 0.04
  optimizer-copy-to-main-grad:
     rank  0: 0.14
     rank  1: 0.14
     rank  2: 0.13
     rank  3: 0.14
     rank  4: 0.16
     rank  5: 0.15
     rank  6: 0.18
     rank  7: 0.24
     rank  8: 0.03
     rank  9: 0.04
     rank 10: 0.07
     rank 11: 0.05
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.08
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.04
     rank  9: 0.03
     rank 10: 0.05
     rank 11: 0.04
     rank 12: 0.02
     rank 13: 0.06
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.04
     rank 11: 0.03
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 41.45
     rank  1: 41.02
     rank  2: 41.15
     rank  3: 41.49
     rank  4: 29.77
     rank  5: 28.85
     rank  6: 29.64
     rank  7: 30.12
     rank  8: 0.14
     rank  9: 0.16
     rank 10: 0.37
     rank 11: 0.20
     rank 12: 0.14
     rank 13: 0.13
     rank 14: 0.13
     rank 15: 0.20
  optimizer:
     rank  0: 43.02
     rank  1: 42.60
     rank  2: 42.73
     rank  3: 43.07
     rank  4: 31.36
     rank  5: 30.41
     rank  6: 31.23
     rank  7: 31.55
     rank  8: 1.73
     rank  9: 1.74
     rank 10: 1.95
     rank 11: 1.78
     rank 12: 1.64
     rank 13: 1.70
     rank 14: 1.70
     rank 15: 1.77
 [2024-12-30 22:08:46] iteration        2/      10 | consumed samples:           64 | elapsed time per iteration (ms): 2609.3 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 7.161038E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2554.87
     rank  1: 2554.83
     rank  2: 2554.82
     rank  3: 2554.88
     rank  4: 2555.15
     rank  5: 2555.16
     rank  6: 2555.14
     rank  7: 2555.14
     rank  8: 2552.78
     rank  9: 2552.78
     rank 10: 2552.80
     rank 11: 2552.88
     rank 12: 2552.76
     rank 13: 2552.73
     rank 14: 2552.73
     rank 15: 2552.76
  forward-compute:
     rank  0: 271.40
     rank  1: 273.56
     rank  2: 274.55
     rank  3: 296.78
     rank  4: 950.36
     rank  5: 875.54
     rank  6: 1004.67
     rank  7: 949.63
     rank  8: 773.25
     rank  9: 771.11
     rank 10: 766.70
     rank 11: 774.29
     rank 12: 716.25
     rank 13: 829.78
     rank 14: 538.17
     rank 15: 656.31
  backward-compute:
     rank  0: 321.41
     rank  1: 319.72
     rank  2: 311.33
     rank  3: 319.25
     rank  4: 1020.20
     rank  5: 1035.32
     rank  6: 1044.54
     rank  7: 1037.18
     rank  8: 935.46
     rank  9: 932.03
     rank 10: 928.57
     rank 11: 942.20
     rank 12: 488.46
     rank 13: 512.32
     rank 14: 542.93
     rank 15: 527.76
  pure-backward-compute:
     rank  0: 321.02
     rank  1: 319.32
     rank  2: 310.96
     rank  3: 318.88
     rank  4: 1019.51
     rank  5: 1034.78
     rank  6: 1043.69
     rank  7: 1036.62
     rank  8: 934.65
     rank  9: 930.99
     rank 10: 927.51
     rank 11: 941.17
     rank 12: 487.02
     rank 13: 510.90
     rank 14: 541.59
     rank 15: 526.35
  batch-generator:
     rank  0: 30.89
     rank  1: 31.98
     rank  2: 31.81
     rank  3: 33.61
     rank  4: 32.33
     rank  5: 21.49
     rank  6: 38.76
     rank  7: 37.03
     rank  8: 29.64
     rank  9: 28.64
     rank 10: 30.60
     rank 11: 29.27
     rank 12: 30.83
     rank 13: 27.64
     rank 14: 27.50
     rank 15: 33.80
  forward-recv:
     rank  4: 33.16
     rank  5: 33.58
     rank  6: 33.51
     rank  7: 43.56
     rank  8: 178.00
     rank  9: 160.42
     rank 10: 200.99
     rank 11: 207.25
     rank 12: 250.35
     rank 13: 243.17
     rank 14: 252.43
     rank 15: 267.16
  forward-send:
     rank  0: 176.30
     rank  1: 156.71
     rank  2: 198.14
     rank  3: 187.72
     rank  4: 3.18
     rank  5: 3.16
     rank  6: 3.16
     rank  7: 3.28
     rank  8: 1.59
     rank  9: 1.69
     rank 10: 1.71
     rank 11: 1.63
  backward-recv:
     rank  0: 521.19
     rank  1: 552.80
     rank  2: 487.83
     rank  3: 525.36
     rank  4: 131.63
     rank  5: 169.64
     rank  6: 87.89
     rank  7: 134.19
     rank  8: 51.33
     rank  9: 94.95
     rank 10: 17.52
     rank 11: 53.14
  backward-send:
     rank  4: 1.29
     rank  5: 1.47
     rank  6: 1.31
     rank  7: 1.09
     rank  8: 3.95
     rank  9: 3.26
     rank 10: 3.07
     rank 11: 4.22
     rank 12: 2.06
     rank 13: 2.48
     rank 14: 1.64
     rank 15: 2.11
  forward-send-backward-recv:
     rank  0: 1029.87
     rank  1: 1021.88
     rank  2: 1058.95
     rank  3: 995.41
     rank  4: 131.96
     rank  5: 157.78
     rank  6: 107.32
     rank  7: 109.54
     rank  8: 40.09
     rank  9: 58.27
     rank 10: 18.60
     rank 11: 17.43
  backward-send-forward-recv:
     rank  4: 5.22
     rank  5: 4.41
     rank  6: 5.01
     rank  7: 4.11
     rank  8: 169.05
     rank  9: 131.98
     rank 10: 221.14
     rank 11: 154.67
     rank 12: 578.50
     rank 13: 449.71
     rank 14: 709.95
     rank 15: 585.12
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.04
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.05
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.07
     rank  5: 0.10
     rank  6: 0.07
     rank  7: 0.05
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.10
     rank 13: 0.07
     rank 14: 0.06
     rank 15: 0.07
  all-grads-sync:
     rank  0: 180.11
     rank  1: 180.05
     rank  2: 180.05
     rank  3: 180.04
     rank  4: 216.46
     rank  5: 216.49
     rank  6: 216.50
     rank  7: 216.43
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.04
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.03
  optimizer-copy-to-main-grad:
     rank  0: 0.09
     rank  1: 0.10
     rank  2: 0.10
     rank  3: 0.10
     rank  4: 0.12
     rank  5: 0.20
     rank  6: 0.15
     rank  7: 0.12
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.02
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 22.17
     rank  1: 22.25
     rank  2: 22.20
     rank  3: 22.25
     rank  4: 26.22
     rank  5: 26.41
     rank  6: 26.42
     rank  7: 26.22
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.10
     rank 11: 0.10
     rank 12: 0.10
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.05
  optimizer:
     rank  0: 23.05
     rank  1: 23.13
     rank  2: 23.08
     rank  3: 23.12
     rank  4: 27.13
     rank  5: 27.28
     rank  6: 27.36
     rank  7: 27.11
     rank  8: 0.92
     rank  9: 0.92
     rank 10: 0.97
     rank 11: 0.97
     rank 12: 0.97
     rank 13: 0.91
     rank 14: 0.91
     rank 15: 0.92
 [2024-12-30 22:08:49] iteration        3/      10 | consumed samples:           96 | elapsed time per iteration (ms): 2578.6 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 7.237505E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2526.45
     rank  1: 2526.44
     rank  2: 2526.44
     rank  3: 2526.51
     rank  4: 2526.67
     rank  5: 2526.69
     rank  6: 2526.69
     rank  7: 2526.74
     rank  8: 2524.35
     rank  9: 2524.34
     rank 10: 2524.39
     rank 11: 2524.41
     rank 12: 2524.29
     rank 13: 2524.29
     rank 14: 2524.30
     rank 15: 2524.37
  forward-compute:
     rank  0: 268.27
     rank  1: 272.29
     rank  2: 267.48
     rank  3: 277.80
     rank  4: 933.99
     rank  5: 885.63
     rank  6: 973.69
     rank  7: 893.43
     rank  8: 771.06
     rank  9: 776.68
     rank 10: 767.65
     rank 11: 777.01
     rank 12: 668.16
     rank 13: 702.45
     rank 14: 520.07
     rank 15: 672.05
  backward-compute:
     rank  0: 319.32
     rank  1: 316.57
     rank  2: 311.43
     rank  3: 314.57
     rank  4: 1021.25
     rank  5: 1038.56
     rank  6: 1043.93
     rank  7: 1038.78
     rank  8: 936.14
     rank  9: 935.59
     rank 10: 928.90
     rank 11: 940.51
     rank 12: 491.93
     rank 13: 514.59
     rank 14: 548.43
     rank 15: 523.95
  pure-backward-compute:
     rank  0: 318.96
     rank  1: 316.18
     rank  2: 311.06
     rank  3: 314.19
     rank  4: 1020.71
     rank  5: 1038.10
     rank  6: 1043.19
     rank  7: 1038.36
     rank  8: 935.42
     rank  9: 934.89
     rank 10: 927.93
     rank 11: 939.63
     rank 12: 490.05
     rank 13: 513.19
     rank 14: 547.13
     rank 15: 522.54
  batch-generator:
     rank  0: 32.49
     rank  1: 34.60
     rank  2: 31.89
     rank  3: 34.61
     rank  4: 25.67
     rank  5: 23.83
     rank  6: 31.77
     rank  7: 26.60
     rank  8: 26.47
     rank  9: 31.19
     rank 10: 29.24
     rank 11: 29.37
     rank 12: 28.95
     rank 13: 27.74
     rank 14: 28.02
     rank 15: 36.72
  forward-recv:
     rank  4: 33.08
     rank  5: 34.37
     rank  6: 33.18
     rank  7: 33.52
     rank  8: 174.27
     rank  9: 161.88
     rank 10: 180.97
     rank 11: 155.51
     rank 12: 250.49
     rank 13: 243.65
     rank 14: 251.51
     rank 15: 242.62
  forward-send:
     rank  0: 175.32
     rank  1: 159.99
     rank  2: 180.58
     rank  3: 156.82
     rank  4: 3.17
     rank  5: 3.15
     rank  6: 3.14
     rank  7: 3.36
     rank  8: 1.92
     rank  9: 2.19
     rank 10: 2.08
     rank 11: 3.68
  backward-recv:
     rank  0: 507.43
     rank  1: 525.82
     rank  2: 487.79
     rank  3: 523.30
     rank  4: 130.82
     rank  5: 141.50
     rank  6: 87.47
     rank  7: 138.38
     rank  8: 51.63
     rank  9: 65.03
     rank 10: 16.19
     rank 11: 60.79
  backward-send:
     rank  4: 1.36
     rank  5: 1.00
     rank  6: 1.26
     rank  7: 1.07
     rank  8: 3.13
     rank  9: 4.00
     rank 10: 3.22
     rank 11: 4.18
     rank 12: 1.69
     rank 13: 2.63
     rank 14: 1.61
     rank 15: 2.80
  forward-send-backward-recv:
     rank  0: 1021.45
     rank  1: 1022.97
     rank  2: 1057.13
     rank  3: 1024.96
     rank  4: 120.65
     rank  5: 146.13
     rank  6: 114.56
     rank  7: 143.97
     rank  8: 27.37
     rank  9: 39.04
     rank 10: 27.51
     rank 11: 45.32
  backward-send-forward-recv:
     rank  4: 4.63
     rank  5: 4.69
     rank  6: 4.36
     rank  7: 3.40
     rank  8: 159.09
     rank  9: 144.14
     rank 10: 206.29
     rank 11: 140.85
     rank 12: 595.38
     rank 13: 546.91
     rank 14: 696.07
     rank 15: 568.97
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.06
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.07
     rank  7: 0.05
     rank  8: 0.03
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.08
     rank 13: 0.07
     rank 14: 0.07
     rank 15: 0.08
  all-grads-sync:
     rank  0: 180.44
     rank  1: 180.37
     rank  2: 180.38
     rank  3: 180.34
     rank  4: 214.50
     rank  5: 214.57
     rank  6: 214.51
     rank  7: 214.47
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.04
  optimizer-copy-to-main-grad:
     rank  0: 0.09
     rank  1: 0.10
     rank  2: 0.09
     rank  3: 0.10
     rank  4: 0.10
     rank  5: 0.11
     rank  6: 0.13
     rank  7: 0.12
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.04
  optimizer-clip-main-grad:
     rank  0: 0.02
     rank  1: 0.01
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 22.19
     rank  1: 22.22
     rank  2: 22.21
     rank  3: 22.26
     rank  4: 26.11
     rank  5: 26.10
     rank  6: 26.31
     rank  7: 26.23
     rank  8: 0.05
     rank  9: 0.03
     rank 10: 0.06
     rank 11: 0.04
     rank 12: 0.09
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.08
  optimizer:
     rank  0: 22.93
     rank  1: 22.93
     rank  2: 22.97
     rank  3: 22.97
     rank  4: 26.81
     rank  5: 26.81
     rank  6: 27.01
     rank  7: 26.94
     rank  8: 0.75
     rank  9: 0.74
     rank 10: 0.77
     rank 11: 0.75
     rank 12: 0.80
     rank 13: 0.74
     rank 14: 0.74
     rank 15: 0.79
 [2024-12-30 22:08:51] iteration        4/      10 | consumed samples:          128 | elapsed time per iteration (ms): 2574.0 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 7.077136E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2520.49
     rank  1: 2520.53
     rank  2: 2520.49
     rank  3: 2520.53
     rank  4: 2520.76
     rank  5: 2520.79
     rank  6: 2520.77
     rank  7: 2520.78
     rank  8: 2518.39
     rank  9: 2518.40
     rank 10: 2518.41
     rank 11: 2518.45
     rank 12: 2518.42
     rank 13: 2518.56
     rank 14: 2518.43
     rank 15: 2518.44
  forward-compute:
     rank  0: 268.14
     rank  1: 267.92
     rank  2: 265.79
     rank  3: 272.01
     rank  4: 883.52
     rank  5: 892.43
     rank  6: 966.14
     rank  7: 888.28
     rank  8: 772.62
     rank  9: 767.95
     rank 10: 771.67
     rank 11: 776.88
     rank 12: 766.83
     rank 13: 702.19
     rank 14: 515.20
     rank 15: 694.50
  backward-compute:
     rank  0: 316.87
     rank  1: 315.41
     rank  2: 311.17
     rank  3: 314.62
     rank  4: 1026.71
     rank  5: 1039.27
     rank  6: 1046.83
     rank  7: 1040.09
     rank  8: 937.19
     rank  9: 935.48
     rank 10: 932.19
     rank 11: 942.69
     rank 12: 487.72
     rank 13: 513.36
     rank 14: 552.70
     rank 15: 520.43
  pure-backward-compute:
     rank  0: 316.49
     rank  1: 315.02
     rank  2: 310.78
     rank  3: 314.27
     rank  4: 1026.18
     rank  5: 1038.71
     rank  6: 1046.14
     rank  7: 1039.71
     rank  8: 936.42
     rank  9: 934.77
     rank 10: 931.19
     rank 11: 941.73
     rank 12: 486.27
     rank 13: 511.94
     rank 14: 551.30
     rank 15: 518.67
  batch-generator:
     rank  0: 30.64
     rank  1: 32.21
     rank  2: 31.45
     rank  3: 32.60
     rank  4: 26.00
     rank  5: 25.80
     rank  6: 28.97
     rank  7: 21.67
     rank  8: 26.64
     rank  9: 23.65
     rank 10: 30.15
     rank 11: 28.44
     rank 12: 28.82
     rank 13: 27.60
     rank 14: 26.10
     rank 15: 30.96
  forward-recv:
     rank  4: 32.74
     rank  5: 34.48
     rank  6: 33.12
     rank  7: 33.72
     rank  8: 158.03
     rank  9: 165.22
     rank 10: 178.55
     rank 11: 163.97
     rank 12: 238.71
     rank 13: 243.66
     rank 14: 254.10
     rank 15: 244.55
  forward-send:
     rank  0: 157.31
     rank  1: 162.68
     rank  2: 180.84
     rank  3: 163.13
     rank  4: 3.06
     rank  5: 5.37
     rank  6: 3.14
     rank  7: 5.40
     rank  8: 1.67
     rank  9: 1.98
     rank 10: 1.64
     rank 11: 2.18
  backward-recv:
     rank  0: 531.96
     rank  1: 522.32
     rank  2: 489.44
     rank  3: 529.32
     rank  4: 157.45
     rank  5: 137.27
     rank  6: 89.91
     rank  7: 142.13
     rank  8: 78.46
     rank  9: 62.15
     rank 10: 17.88
     rank 11: 65.08
  backward-send:
     rank  4: 1.02
     rank  5: 1.28
     rank  6: 1.22
     rank  7: 1.07
     rank  8: 3.16
     rank  9: 3.59
     rank 10: 3.09
     rank 11: 3.89
     rank 12: 1.78
     rank 13: 3.17
     rank 14: 1.62
     rank 15: 3.04
  forward-send-backward-recv:
     rank  0: 1018.91
     rank  1: 1029.09
     rank  2: 1057.64
     rank  3: 1020.09
     rank  4: 142.74
     rank  5: 141.01
     rank  6: 118.15
     rank  7: 141.80
     rank  8: 41.87
     rank  9: 40.24
     rank 10: 29.91
     rank 11: 41.69
  backward-send-forward-recv:
     rank  4: 4.95
     rank  5: 4.59
     rank  6: 3.96
     rank  7: 3.57
     rank  8: 132.65
     rank  9: 152.48
     rank 10: 198.51
     rank 11: 131.90
     rank 12: 513.28
     rank 13: 548.87
     rank 14: 694.18
     rank 15: 548.55
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.03
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.11
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.04
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.07
     rank  7: 0.05
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.07
     rank 13: 0.17
     rank 14: 0.09
     rank 15: 0.10
  all-grads-sync:
     rank  0: 179.48
     rank  1: 179.42
     rank  2: 179.41
     rank  3: 179.39
     rank  4: 207.77
     rank  5: 207.81
     rank  6: 207.78
     rank  7: 207.74
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.04
     rank 14: 0.03
     rank 15: 0.04
  optimizer-copy-to-main-grad:
     rank  0: 0.09
     rank  1: 0.09
     rank  2: 0.10
     rank  3: 0.09
     rank  4: 0.11
     rank  5: 0.11
     rank  6: 0.13
     rank  7: 0.11
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.10
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 22.13
     rank  1: 22.14
     rank  2: 22.13
     rank  3: 22.30
     rank  4: 26.09
     rank  5: 26.14
     rank  6: 26.32
     rank  7: 26.13
     rank  8: 0.04
     rank  9: 0.04
     rank 10: 0.07
     rank 11: 0.04
     rank 12: 0.05
     rank 13: 0.10
     rank 14: 0.04
     rank 15: 0.13
  optimizer:
     rank  0: 23.01
     rank  1: 23.01
     rank  2: 23.00
     rank  3: 23.17
     rank  4: 26.96
     rank  5: 27.02
     rank  6: 27.16
     rank  7: 26.99
     rank  8: 0.91
     rank  9: 0.90
     rank 10: 0.94
     rank 11: 0.91
     rank 12: 0.91
     rank 13: 0.97
     rank 14: 0.91
     rank 15: 1.00
 [2024-12-30 22:08:54] iteration        5/      10 | consumed samples:          160 | elapsed time per iteration (ms): 2565.2 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 6.441694E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2511.16
     rank  1: 2511.15
     rank  2: 2511.16
     rank  3: 2511.21
     rank  4: 2511.48
     rank  5: 2511.57
     rank  6: 2511.49
     rank  7: 2511.58
     rank  8: 2509.15
     rank  9: 2509.16
     rank 10: 2509.16
     rank 11: 2509.22
     rank 12: 2509.07
     rank 13: 2509.05
     rank 14: 2509.06
     rank 15: 2509.13
  forward-compute:
     rank  0: 263.97
     rank  1: 267.99
     rank  2: 266.76
     rank  3: 270.99
     rank  4: 881.07
     rank  5: 877.51
     rank  6: 929.51
     rank  7: 955.08
     rank  8: 773.00
     rank  9: 770.08
     rank 10: 770.44
     rank 11: 775.12
     rank 12: 712.93
     rank 13: 699.21
     rank 14: 616.04
     rank 15: 521.90
  backward-compute:
     rank  0: 317.76
     rank  1: 316.68
     rank  2: 311.30
     rank  3: 313.18
     rank  4: 1024.74
     rank  5: 1038.73
     rank  6: 1045.75
     rank  7: 1039.18
     rank  8: 938.49
     rank  9: 934.96
     rank 10: 932.35
     rank 11: 943.34
     rank 12: 490.47
     rank 13: 522.22
     rank 14: 524.13
     rank 15: 555.23
  pure-backward-compute:
     rank  0: 317.37
     rank  1: 316.34
     rank  2: 310.95
     rank  3: 312.84
     rank  4: 1024.21
     rank  5: 1038.22
     rank  6: 1045.16
     rank  7: 1038.51
     rank  8: 937.73
     rank  9: 934.15
     rank 10: 931.45
     rank 11: 942.57
     rank 12: 489.03
     rank 13: 520.78
     rank 14: 522.83
     rank 15: 553.85
  batch-generator:
     rank  0: 30.81
     rank  1: 31.95
     rank  2: 31.17
     rank  3: 32.47
     rank  4: 24.62
     rank  5: 20.42
     rank  6: 26.70
     rank  7: 30.70
     rank  8: 26.43
     rank  9: 23.70
     rank 10: 28.89
     rank 11: 27.99
     rank 12: 29.79
     rank 13: 29.09
     rank 14: 27.90
     rank 15: 33.44
  forward-recv:
     rank  4: 32.69
     rank  5: 33.18
     rank  6: 33.43
     rank  7: 34.42
     rank  8: 156.98
     rank  9: 158.52
     rank 10: 183.21
     rank 11: 191.08
     rank 12: 238.94
     rank 13: 240.81
     rank 14: 254.49
     rank 15: 261.42
  forward-send:
     rank  0: 156.44
     rank  1: 157.03
     rank  2: 182.55
     rank  3: 189.76
     rank  4: 3.18
     rank  5: 3.24
     rank  6: 3.27
     rank  7: 3.38
     rank  8: 1.70
     rank  9: 1.63
     rank 10: 1.66
     rank 11: 1.58
  backward-recv:
     rank  0: 512.51
     rank  1: 510.43
     rank  2: 498.66
     rank  3: 489.63
     rank  4: 132.67
     rank  5: 126.17
     rank  6: 106.07
     rank  7: 91.17
     rank  8: 54.30
     rank  9: 49.00
     rank 10: 32.67
     rank 11: 15.61
  backward-send:
     rank  4: 1.39
     rank  5: 1.31
     rank  6: 0.89
     rank  7: 1.67
     rank  8: 3.20
     rank  9: 3.54
     rank 10: 3.83
     rank 11: 2.96
     rank 12: 1.67
     rank 13: 1.65
     rank 14: 1.79
     rank 15: 1.67
  forward-send-backward-recv:
     rank  0: 1026.93
     rank  1: 1029.81
     rank  2: 1024.46
     rank  3: 1025.72
     rank  4: 154.22
     rank  5: 155.07
     rank  6: 119.44
     rank  7: 117.08
     rank  8: 52.25
     rank  9: 53.77
     rank 10: 31.66
     rank 11: 24.50
  backward-send-forward-recv:
     rank  4: 4.71
     rank  5: 4.41
     rank  6: 3.92
     rank  7: 4.53
     rank  8: 129.69
     rank  9: 141.58
     rank 10: 157.28
     rank 11: 165.36
     rank 12: 547.77
     rank 13: 530.80
     rank 14: 599.92
     rank 15: 661.50
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.04
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.06
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.07
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.07
     rank 13: 0.06
     rank 14: 0.07
     rank 15: 0.10
  all-grads-sync:
     rank  0: 177.68
     rank  1: 177.63
     rank  2: 177.63
     rank  3: 177.60
     rank  4: 214.34
     rank  5: 214.27
     rank  6: 214.30
     rank  7: 214.38
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.09
     rank  1: 0.09
     rank  2: 0.09
     rank  3: 0.09
     rank  4: 0.12
     rank  5: 0.12
     rank  6: 0.13
     rank  7: 0.13
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 22.12
     rank  1: 22.10
     rank  2: 22.16
     rank  3: 22.16
     rank  4: 26.16
     rank  5: 26.17
     rank  6: 26.27
     rank  7: 26.31
     rank  8: 0.05
     rank  9: 0.05
     rank 10: 0.06
     rank 11: 0.05
     rank 12: 0.08
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.12
  optimizer:
     rank  0: 23.05
     rank  1: 23.03
     rank  2: 23.10
     rank  3: 23.08
     rank  4: 27.09
     rank  5: 27.09
     rank  6: 27.19
     rank  7: 27.24
     rank  8: 0.97
     rank  9: 0.96
     rank 10: 0.98
     rank 11: 0.97
     rank 12: 1.01
     rank 13: 0.96
     rank 14: 0.96
     rank 15: 1.04
 [2024-12-30 22:08:57] iteration        6/      10 | consumed samples:          192 | elapsed time per iteration (ms): 2584.4 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 5.158577E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2528.37
     rank  1: 2528.33
     rank  2: 2528.34
     rank  3: 2528.38
     rank  4: 2528.74
     rank  5: 2528.74
     rank  6: 2528.74
     rank  7: 2528.82
     rank  8: 2526.50
     rank  9: 2526.49
     rank 10: 2526.56
     rank 11: 2526.61
     rank 12: 2526.35
     rank 13: 2526.27
     rank 14: 2526.28
     rank 15: 2526.34
  forward-compute:
     rank  0: 266.93
     rank  1: 267.69
     rank  2: 265.86
     rank  3: 270.52
     rank  4: 873.27
     rank  5: 883.35
     rank  6: 895.47
     rank  7: 968.17
     rank  8: 781.36
     rank  9: 778.24
     rank 10: 772.75
     rank 11: 781.86
     rank 12: 824.48
     rank 13: 727.40
     rank 14: 711.22
     rank 15: 517.46
  backward-compute:
     rank  0: 319.70
     rank  1: 313.71
     rank  2: 311.37
     rank  3: 316.08
     rank  4: 1024.59
     rank  5: 1040.01
     rank  6: 1045.36
     rank  7: 1038.05
     rank  8: 940.80
     rank  9: 940.13
     rank 10: 933.58
     rank 11: 945.84
     rank 12: 491.39
     rank 13: 514.19
     rank 14: 519.35
     rank 15: 561.42
  pure-backward-compute:
     rank  0: 319.32
     rank  1: 313.34
     rank  2: 311.01
     rank  3: 315.71
     rank  4: 1024.19
     rank  5: 1039.40
     rank  6: 1044.83
     rank  7: 1037.28
     rank  8: 939.95
     rank  9: 939.16
     rank 10: 932.56
     rank 11: 944.78
     rank 12: 490.02
     rank 13: 512.74
     rank 14: 517.86
     rank 15: 559.94
  batch-generator:
     rank  0: 32.53
     rank  1: 31.57
     rank  2: 31.41
     rank  3: 32.02
     rank  4: 20.84
     rank  5: 22.38
     rank  6: 21.84
     rank  7: 30.21
     rank  8: 30.86
     rank  9: 30.15
     rank 10: 29.56
     rank 11: 31.04
     rank 12: 27.44
     rank 13: 26.93
     rank 14: 27.84
     rank 15: 29.86
  forward-recv:
     rank  4: 33.65
     rank  5: 33.88
     rank  6: 33.67
     rank  7: 33.89
     rank  8: 156.92
     rank  9: 161.09
     rank 10: 162.55
     rank 11: 178.73
     rank 12: 244.20
     rank 13: 246.96
     rank 14: 245.96
     rank 15: 254.15
  forward-send:
     rank  0: 158.43
     rank  1: 162.59
     rank  2: 162.81
     rank  3: 179.75
     rank  4: 3.06
     rank  5: 4.51
     rank  6: 4.27
     rank  7: 3.23
     rank  8: 1.85
     rank  9: 2.45
     rank 10: 2.41
     rank 11: 1.88
  backward-recv:
     rank  0: 553.86
     rank  1: 534.79
     rank  2: 528.61
     rank  3: 493.03
     rank  4: 177.82
     rank  5: 149.68
     rank  6: 138.70
     rank  7: 94.75
     rank  8: 94.10
     rank  9: 73.03
     rank 10: 66.25
     rank 11: 15.08
  backward-send:
     rank  4: 1.08
     rank  5: 1.12
     rank  6: 1.25
     rank  7: 1.48
     rank  8: 3.71
     rank  9: 3.19
     rank 10: 4.01
     rank 11: 3.27
     rank 12: 1.67
     rank 13: 1.64
     rank 14: 1.67
     rank 15: 1.64
  forward-send-backward-recv:
     rank  0: 1001.11
     rank  1: 1024.39
     rank  2: 1033.41
     rank  3: 1050.60
     rank  4: 140.72
     rank  5: 143.66
     rank  6: 138.43
     rank  7: 122.50
     rank  8: 41.32
     rank  9: 43.15
     rank 10: 41.75
     rank 11: 28.83
  backward-send-forward-recv:
     rank  4: 4.37
     rank  5: 5.18
     rank  6: 3.68
     rank  7: 4.55
     rank  8: 110.98
     rank  9: 132.80
     rank 10: 148.50
     rank 11: 183.77
     rank 12: 452.19
     rank 13: 526.94
     rank 14: 537.27
     rank 15: 686.00
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.05
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.04
     rank 11: 0.03
     rank 12: 0.04
     rank 13: 0.02
     rank 14: 0.03
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.07
     rank  5: 0.06
     rank  6: 0.05
     rank  7: 0.13
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.08
     rank 13: 0.06
     rank 14: 0.07
     rank 15: 0.07
  all-grads-sync:
     rank  0: 178.26
     rank  1: 178.20
     rank  2: 178.21
     rank  3: 178.18
     rank  4: 210.91
     rank  5: 210.95
     rank  6: 210.91
     rank  7: 210.75
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.09
     rank  1: 0.09
     rank  2: 0.09
     rank  3: 0.09
     rank  4: 0.11
     rank  5: 0.12
     rank  6: 0.11
     rank  7: 0.15
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.02
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.02
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 22.13
     rank  1: 22.13
     rank  2: 22.11
     rank  3: 22.19
     rank  4: 26.17
     rank  5: 26.24
     rank  6: 26.17
     rank  7: 26.53
     rank  8: 0.05
     rank  9: 0.05
     rank 10: 0.06
     rank 11: 0.11
     rank 12: 0.06
     rank 13: 0.04
     rank 14: 0.08
     rank 15: 0.09
  optimizer:
     rank  0: 23.14
     rank  1: 23.14
     rank  2: 23.12
     rank  3: 23.20
     rank  4: 27.18
     rank  5: 27.24
     rank  6: 27.17
     rank  7: 27.53
     rank  8: 1.05
     rank  9: 1.05
     rank 10: 1.05
     rank 11: 1.11
     rank 12: 1.06
     rank 13: 1.04
     rank 14: 1.08
     rank 15: 1.09
 [2024-12-30 22:08:59] iteration        7/      10 | consumed samples:          224 | elapsed time per iteration (ms): 2591.7 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 4.328577E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2536.28
     rank  1: 2536.15
     rank  2: 2536.22
     rank  3: 2536.24
     rank  4: 2536.55
     rank  5: 2536.50
     rank  6: 2536.48
     rank  7: 2536.48
     rank  8: 2534.26
     rank  9: 2534.19
     rank 10: 2534.29
     rank 11: 2534.20
     rank 12: 2534.27
     rank 13: 2534.18
     rank 14: 2534.18
     rank 15: 2534.19
  forward-compute:
     rank  0: 266.78
     rank  1: 272.66
     rank  2: 269.67
     rank  3: 274.83
     rank  4: 882.71
     rank  5: 938.03
     rank  6: 904.23
     rank  7: 962.72
     rank  8: 781.80
     rank  9: 780.27
     rank 10: 778.01
     rank 11: 785.06
     rank 12: 777.74
     rank 13: 541.07
     rank 14: 704.10
     rank 15: 527.68
  backward-compute:
     rank  0: 318.89
     rank  1: 314.31
     rank  2: 311.58
     rank  3: 318.72
     rank  4: 1027.65
     rank  5: 1044.41
     rank  6: 1050.06
     rank  7: 1043.57
     rank  8: 940.23
     rank  9: 939.62
     rank 10: 937.09
     rank 11: 945.47
     rank 12: 493.20
     rank 13: 547.76
     rank 14: 517.57
     rank 15: 554.67
  pure-backward-compute:
     rank  0: 318.53
     rank  1: 313.93
     rank  2: 311.21
     rank  3: 318.36
     rank  4: 1027.27
     rank  5: 1043.70
     rank  6: 1049.53
     rank  7: 1043.08
     rank  8: 939.37
     rank  9: 938.58
     rank 10: 935.97
     rank 11: 944.64
     rank 12: 491.73
     rank 13: 546.32
     rank 14: 516.15
     rank 15: 553.16
  batch-generator:
     rank  0: 31.72
     rank  1: 35.49
     rank  2: 32.33
     rank  3: 32.26
     rank  4: 23.58
     rank  5: 28.67
     rank  6: 25.06
     rank  7: 27.29
     rank  8: 30.14
     rank  9: 31.67
     rank 10: 31.79
     rank 11: 31.32
     rank 12: 32.73
     rank 13: 26.87
     rank 14: 26.50
     rank 15: 30.51
  forward-recv:
     rank  4: 32.91
     rank  5: 34.11
     rank  6: 33.35
     rank  7: 33.63
     rank  8: 156.77
     rank  9: 158.07
     rank 10: 159.91
     rank 11: 182.48
     rank 12: 243.15
     rank 13: 244.36
     rank 14: 245.77
     rank 15: 259.20
  forward-send:
     rank  0: 157.18
     rank  1: 159.13
     rank  2: 162.89
     rank  3: 186.12
     rank  4: 3.54
     rank  5: 4.23
     rank  6: 3.32
     rank  7: 3.27
     rank  8: 1.97
     rank  9: 2.06
     rank 10: 2.07
     rank 11: 2.79
  backward-recv:
     rank  0: 537.50
     rank  1: 489.35
     rank  2: 522.97
     rank  3: 487.07
     rank  4: 160.16
     rank  5: 90.62
     rank  6: 123.92
     rank  7: 100.00
     rank  8: 79.70
     rank  9: 15.71
     rank 10: 50.47
     rank 11: 22.20
  backward-send:
     rank  4: 0.89
     rank  5: 1.20
     rank  6: 1.15
     rank  7: 0.97
     rank  8: 3.13
     rank  9: 3.09
     rank 10: 3.19
     rank 11: 3.14
     rank 12: 1.71
     rank 13: 1.58
     rank 14: 1.66
     rank 15: 1.60
  forward-send-backward-recv:
     rank  0: 1022.69
     rank  1: 1079.84
     rank  2: 1040.18
     rank  3: 1045.39
     rank  4: 149.51
     rank  5: 154.22
     rank  6: 145.87
     rank  7: 122.47
     rank  8: 45.78
     rank  9: 50.76
     rank 10: 47.27
     rank 11: 28.30
  backward-send-forward-recv:
     rank  4: 4.32
     rank  5: 5.37
     rank  6: 4.34
     rank  7: 3.79
     rank  8: 124.93
     rank  9: 194.20
     rank 10: 158.06
     rank 11: 172.13
     rank 12: 501.25
     rank 13: 692.11
     rank 14: 550.61
     rank 15: 681.36
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.02
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.09
     rank 11: 0.03
     rank 12: 0.06
     rank 13: 0.03
     rank 14: 0.04
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.03
     rank  4: 0.05
     rank  5: 0.06
     rank  6: 0.05
     rank  7: 0.06
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.05
     rank 11: 0.02
     rank 12: 0.16
     rank 13: 0.07
     rank 14: 0.07
     rank 15: 0.07
  all-grads-sync:
     rank  0: 180.40
     rank  1: 180.32
     rank  2: 180.31
     rank  3: 180.32
     rank  4: 212.95
     rank  5: 213.05
     rank  6: 213.01
     rank  7: 212.95
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.07
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.09
     rank  1: 0.10
     rank  2: 0.10
     rank  3: 0.09
     rank  4: 0.12
     rank  5: 0.13
     rank  6: 0.11
     rank  7: 0.10
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.03
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 22.14
     rank  1: 22.24
     rank  2: 22.22
     rank  3: 22.23
     rank  4: 26.11
     rank  5: 26.22
     rank  6: 26.20
     rank  7: 26.19
     rank  8: 0.05
     rank  9: 0.05
     rank 10: 0.12
     rank 11: 0.06
     rank 12: 0.10
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.05
  optimizer:
     rank  0: 23.14
     rank  1: 23.23
     rank  2: 23.21
     rank  3: 23.23
     rank  4: 27.10
     rank  5: 27.19
     rank  6: 27.20
     rank  7: 27.18
     rank  8: 1.03
     rank  9: 1.03
     rank 10: 1.10
     rank 11: 1.04
     rank 12: 1.09
     rank 13: 1.03
     rank 14: 1.03
     rank 15: 1.03
 [2024-12-30 22:09:02] iteration        8/      10 | consumed samples:          256 | elapsed time per iteration (ms): 2583.7 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 3.390171E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2528.17
     rank  1: 2528.12
     rank  2: 2528.12
     rank  3: 2528.13
     rank  4: 2528.44
     rank  5: 2528.46
     rank  6: 2528.39
     rank  7: 2528.40
     rank  8: 2526.18
     rank  9: 2526.10
     rank 10: 2526.11
     rank 11: 2526.11
     rank 12: 2526.10
     rank 13: 2526.15
     rank 14: 2526.07
     rank 15: 2526.07
  forward-compute:
     rank  0: 265.61
     rank  1: 267.32
     rank  2: 266.83
     rank  3: 270.65
     rank  4: 875.08
     rank  5: 962.50
     rank  6: 902.17
     rank  7: 885.82
     rank  8: 778.92
     rank  9: 781.04
     rank 10: 783.59
     rank 11: 779.86
     rank 12: 803.55
     rank 13: 519.55
     rank 14: 636.24
     rank 15: 687.97
  backward-compute:
     rank  0: 318.83
     rank  1: 318.18
     rank  2: 311.25
     rank  3: 313.62
     rank  4: 1030.39
     rank  5: 1041.03
     rank  6: 1051.83
     rank  7: 1042.58
     rank  8: 941.31
     rank  9: 939.31
     rank 10: 939.48
     rank 11: 945.97
     rank 12: 491.48
     rank 13: 550.57
     rank 14: 527.12
     rank 15: 524.03
  pure-backward-compute:
     rank  0: 318.43
     rank  1: 317.83
     rank  2: 310.90
     rank  3: 313.26
     rank  4: 1030.02
     rank  5: 1040.41
     rank  6: 1051.42
     rank  7: 1042.02
     rank  8: 940.45
     rank  9: 938.31
     rank 10: 938.65
     rank 11: 944.98
     rank 12: 489.99
     rank 13: 549.18
     rank 14: 525.84
     rank 15: 522.63
  batch-generator:
     rank  0: 31.20
     rank  1: 32.15
     rank  2: 31.99
     rank  3: 31.83
     rank  4: 21.54
     rank  5: 28.69
     rank  6: 23.46
     rank  7: 21.91
     rank  8: 27.77
     rank  9: 31.81
     rank 10: 34.08
     rank 11: 27.79
     rank 12: 28.81
     rank 13: 27.02
     rank 14: 27.20
     rank 15: 32.92
  forward-recv:
     rank  4: 32.87
     rank  5: 33.40
     rank  6: 33.20
     rank  7: 33.67
     rank  8: 157.04
     rank  9: 177.05
     rank 10: 158.19
     rank 11: 161.04
     rank 12: 241.29
     rank 13: 252.36
     rank 14: 244.96
     rank 15: 245.12
  forward-send:
     rank  0: 158.41
     rank  1: 178.37
     rank  2: 159.78
     rank  3: 162.18
     rank  4: 3.20
     rank  5: 3.18
     rank  6: 2.99
     rank  7: 3.39
     rank  8: 1.91
     rank  9: 1.98
     rank 10: 2.90
     rank 11: 3.07
  backward-recv:
     rank  0: 545.17
     rank  1: 488.34
     rank  2: 513.80
     rank  3: 527.83
     rank  4: 165.65
     rank  5: 93.32
     rank  6: 119.88
     rank  7: 140.66
     rank  8: 86.55
     rank  9: 16.43
     rank 10: 42.44
     rank 11: 61.42
  backward-send:
     rank  4: 0.95
     rank  5: 1.16
     rank  6: 1.03
     rank  7: 1.36
     rank  8: 3.26
     rank  9: 3.17
     rank 10: 3.74
     rank 11: 3.69
     rank 12: 2.04
     rank 13: 1.61
     rank 14: 1.68
     rank 15: 1.97
  forward-send-backward-recv:
     rank  0: 1006.75
     rank  1: 1052.94
     rank  2: 1048.36
     rank  3: 1024.23
     rank  4: 141.24
     rank  5: 122.35
     rank  6: 143.01
     rank  7: 144.19
     rank  8: 40.40
     rank  9: 29.60
     rank 10: 44.11
     rank 11: 44.59
  backward-send-forward-recv:
     rank  4: 4.19
     rank  5: 5.17
     rank  6: 3.62
     rank  7: 4.62
     rank  8: 116.66
     rank  9: 185.26
     rank 10: 154.62
     rank 11: 128.42
     rank 12: 470.46
     rank 13: 693.17
     rank 14: 602.08
     rank 15: 551.32
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.03
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.03
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.03
     rank 13: 0.04
     rank 14: 0.02
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.03
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.07
     rank  6: 0.05
     rank  7: 0.06
     rank  8: 0.03
     rank  9: 0.03
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.12
     rank 13: 0.10
     rank 14: 0.06
     rank 15: 0.08
  all-grads-sync:
     rank  0: 179.80
     rank  1: 179.75
     rank  2: 179.75
     rank  3: 179.71
     rank  4: 215.20
     rank  5: 215.87
     rank  6: 215.23
     rank  7: 215.13
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.04
     rank 13: 0.04
     rank 14: 0.02
     rank 15: 0.03
  optimizer-copy-to-main-grad:
     rank  0: 0.09
     rank  1: 0.09
     rank  2: 0.09
     rank  3: 0.09
     rank  4: 0.11
     rank  5: 0.14
     rank  6: 0.11
     rank  7: 0.11
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.02
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 22.14
     rank  1: 22.15
     rank  2: 22.12
     rank  3: 22.12
     rank  4: 26.11
     rank  5: 26.27
     rank  6: 26.24
     rank  7: 26.22
     rank  8: 0.05
     rank  9: 0.05
     rank 10: 0.05
     rank 11: 0.05
     rank 12: 0.06
     rank 13: 0.06
     rank 14: 0.04
     rank 15: 0.08
  optimizer:
     rank  0: 23.08
     rank  1: 23.09
     rank  2: 23.06
     rank  3: 23.06
     rank  4: 27.04
     rank  5: 27.21
     rank  6: 27.17
     rank  7: 27.15
     rank  8: 0.98
     rank  9: 0.98
     rank 10: 0.97
     rank 11: 0.97
     rank 12: 0.98
     rank 13: 0.98
     rank 14: 0.97
     rank 15: 1.01
 [2024-12-30 22:09:04] iteration        9/      10 | consumed samples:          288 | elapsed time per iteration (ms): 2543.6 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 4.049011E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2488.34
     rank  1: 2488.35
     rank  2: 2488.34
     rank  3: 2488.38
     rank  4: 2488.63
     rank  5: 2488.63
     rank  6: 2488.63
     rank  7: 2488.69
     rank  8: 2486.40
     rank  9: 2486.52
     rank 10: 2486.42
     rank 11: 2486.41
     rank 12: 2486.40
     rank 13: 2486.33
     rank 14: 2486.32
     rank 15: 2486.33
  forward-compute:
     rank  0: 267.69
     rank  1: 266.06
     rank  2: 267.70
     rank  3: 269.69
     rank  4: 878.05
     rank  5: 888.78
     rank  6: 905.30
     rank  7: 886.91
     rank  8: 780.68
     rank  9: 781.31
     rank 10: 779.75
     rank 11: 783.62
     rank 12: 671.71
     rank 13: 572.46
     rank 14: 541.29
     rank 15: 559.94
  backward-compute:
     rank  0: 317.90
     rank  1: 316.89
     rank  2: 311.76
     rank  3: 313.44
     rank  4: 1032.76
     rank  5: 1042.56
     rank  6: 1052.06
     rank  7: 1042.15
     rank  8: 943.21
     rank  9: 939.18
     rank 10: 938.71
     rank 11: 946.55
     rank 12: 495.22
     rank 13: 540.32
     rank 14: 547.27
     rank 15: 560.69
  pure-backward-compute:
     rank  0: 317.53
     rank  1: 316.51
     rank  2: 311.34
     rank  3: 313.09
     rank  4: 1032.38
     rank  5: 1042.19
     rank  6: 1051.50
     rank  7: 1041.70
     rank  8: 942.43
     rank  9: 938.27
     rank 10: 937.85
     rank 11: 945.68
     rank 12: 493.61
     rank 13: 538.94
     rank 14: 545.92
     rank 15: 559.15
  batch-generator:
     rank  0: 32.05
     rank  1: 31.23
     rank  2: 32.50
     rank  3: 31.49
     rank  4: 21.13
     rank  5: 21.43
     rank  6: 25.75
     rank  7: 23.52
     rank  8: 28.57
     rank  9: 30.82
     rank 10: 32.07
     rank 11: 29.52
     rank 12: 28.40
     rank 13: 28.84
     rank 14: 27.69
     rank 15: 30.61
  forward-recv:
     rank  4: 32.95
     rank  5: 33.53
     rank  6: 33.69
     rank  7: 33.66
     rank  8: 155.43
     rank  9: 167.95
     rank 10: 162.40
     rank 11: 160.27
     rank 12: 241.12
     rank 13: 252.52
     rank 14: 245.42
     rank 15: 247.30
  forward-send:
     rank  0: 156.65
     rank  1: 168.49
     rank  2: 162.79
     rank  3: 161.92
     rank  4: 3.10
     rank  5: 3.09
     rank  6: 3.47
     rank  7: 3.65
     rank  8: 1.68
     rank  9: 1.83
     rank 10: 1.71
     rank 11: 1.66
  backward-recv:
     rank  0: 504.25
     rank  1: 491.54
     rank  2: 482.21
     rank  3: 493.37
     rank  4: 124.30
     rank  5: 107.36
     rank  6: 88.76
     rank  7: 104.64
     rank  8: 44.06
     rank  9: 30.19
     rank 10: 16.15
     rank 11: 26.56
  backward-send:
     rank  4: 1.10
     rank  5: 0.91
     rank  6: 1.31
     rank  7: 0.97
     rank  8: 3.24
     rank  9: 3.07
     rank 10: 3.19
     rank 11: 3.20
     rank 12: 1.70
     rank 13: 1.63
     rank 14: 1.68
     rank 15: 1.65
  forward-send-backward-recv:
     rank  0: 1013.28
     rank  1: 1021.58
     rank  2: 1046.07
     rank  3: 1028.30
     rank  4: 142.18
     rank  5: 142.65
     rank  6: 140.51
     rank  7: 148.28
     rank  8: 42.50
     rank  9: 40.28
     rank 10: 42.12
     rank 11: 47.77
  backward-send-forward-recv:
     rank  4: 4.11
     rank  5: 4.12
     rank  6: 3.89
     rank  7: 3.88
     rank  8: 119.86
     rank  9: 131.38
     rank 10: 154.51
     rank 11: 126.71
     rank 12: 563.21
     rank 13: 610.79
     rank 14: 646.89
     rank 15: 609.81
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.03
     rank  8: 0.03
     rank  9: 0.06
     rank 10: 0.04
     rank 11: 0.03
     rank 12: 0.06
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.02
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.05
     rank  5: 0.05
     rank  6: 0.05
     rank  7: 0.08
     rank  8: 0.03
     rank  9: 0.04
     rank 10: 0.03
     rank 11: 0.03
     rank 12: 0.10
     rank 13: 0.08
     rank 14: 0.07
     rank 15: 0.07
  all-grads-sync:
     rank  0: 183.55
     rank  1: 183.50
     rank  2: 183.49
     rank  3: 183.46
     rank  4: 209.76
     rank  5: 209.67
     rank  6: 209.72
     rank  7: 209.82
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.04
  optimizer-copy-to-main-grad:
     rank  0: 0.09
     rank  1: 0.09
     rank  2: 0.09
     rank  3: 0.09
     rank  4: 0.11
     rank  5: 0.11
     rank  6: 0.10
     rank  7: 0.11
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.02
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.02
     rank 14: 0.01
     rank 15: 0.01
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.02
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 22.10
     rank  1: 22.12
     rank  2: 22.10
     rank  3: 22.14
     rank  4: 26.09
     rank  5: 26.12
     rank  6: 26.12
     rank  7: 26.26
     rank  8: 0.05
     rank  9: 0.07
     rank 10: 0.07
     rank 11: 0.05
     rank 12: 0.10
     rank 13: 0.08
     rank 14: 0.04
     rank 15: 0.06
  optimizer:
     rank  0: 22.99
     rank  1: 23.02
     rank  2: 22.99
     rank  3: 23.03
     rank  4: 26.98
     rank  5: 27.00
     rank  6: 27.01
     rank  7: 27.15
     rank  8: 0.93
     rank  9: 0.94
     rank 10: 0.94
     rank 11: 0.93
     rank 12: 0.99
     rank 13: 0.97
     rank 14: 0.92
     rank 15: 0.94
 [2024-12-30 22:09:07] iteration       10/      10 | consumed samples:          320 | elapsed time per iteration (ms): 2583.5 | learning rate: 1.000000E-05 | global batch size:    32 | lm loss: 3.370360E+00 | loss scale: 1.0 | number of skipped iterations:   0 | number of nan iterations:   0 |
times across ranks (ms):
  forward-backward:
     rank  0: 2528.16
     rank  1: 2528.14
     rank  2: 2528.10
     rank  3: 2528.12
     rank  4: 2528.41
     rank  5: 2528.42
     rank  6: 2528.38
     rank  7: 2528.39
     rank  8: 2526.06
     rank  9: 2526.04
     rank 10: 2525.99
     rank 11: 2526.02
     rank 12: 2526.20
     rank 13: 2526.09
     rank 14: 2526.10
     rank 15: 2526.09
  forward-compute:
     rank  0: 268.23
     rank  1: 268.35
     rank  2: 266.98
     rank  3: 269.16
     rank  4: 877.74
     rank  5: 937.87
     rank  6: 906.95
     rank  7: 890.35
     rank  8: 779.35
     rank  9: 781.70
     rank 10: 776.31
     rank 11: 785.56
     rank 12: 775.50
     rank 13: 516.95
     rank 14: 645.47
     rank 15: 653.84
  backward-compute:
     rank  0: 319.55
     rank  1: 316.09
     rank  2: 312.88
     rank  3: 316.55
     rank  4: 1032.45
     rank  5: 1045.13
     rank  6: 1052.19
     rank  7: 1043.37
     rank  8: 943.18
     rank  9: 939.63
     rank 10: 940.78
     rank 11: 949.79
     rank 12: 492.14
     rank 13: 560.26
     rank 14: 529.71
     rank 15: 537.21
  pure-backward-compute:
     rank  0: 319.20
     rank  1: 315.69
     rank  2: 312.53
     rank  3: 316.23
     rank  4: 1032.08
     rank  5: 1044.47
     rank  6: 1051.65
     rank  7: 1042.84
     rank  8: 942.33
     rank  9: 938.63
     rank 10: 939.87
     rank 11: 948.85
     rank 12: 490.26
     rank 13: 558.89
     rank 14: 528.41
     rank 15: 535.79
  batch-generator:
     rank  0: 33.52
     rank  1: 31.91
     rank  2: 32.64
     rank  3: 31.07
     rank  4: 20.51
     rank  5: 27.30
     rank  6: 26.55
     rank  7: 26.65
     rank  8: 28.97
     rank  9: 30.65
     rank 10: 28.26
     rank 11: 27.70
     rank 12: 32.49
     rank 13: 27.21
     rank 14: 27.70
     rank 15: 28.36
  forward-recv:
     rank  4: 32.93
     rank  5: 33.68
     rank  6: 33.50
     rank  7: 33.61
     rank  8: 151.57
     rank  9: 158.83
     rank 10: 163.68
     rank 11: 162.32
     rank 12: 244.85
     rank 13: 248.46
     rank 14: 246.39
     rank 15: 248.05
  forward-send:
     rank  0: 156.38
     rank  1: 161.57
     rank  2: 163.91
     rank  3: 164.98
     rank  4: 3.12
     rank  5: 5.30
     rank  6: 6.12
     rank  7: 6.67
     rank  8: 5.93
     rank  9: 3.05
     rank 10: 2.46
     rank 11: 3.15
  backward-recv:
     rank  0: 541.69
     rank  1: 489.79
     rank  2: 514.78
     rank  3: 527.05
     rank  4: 161.71
     rank  5: 92.88
     rank  6: 122.60
     rank  7: 139.65
     rank  8: 81.68
     rank  9: 16.67
     rank 10: 49.07
     rank 11: 60.87
  backward-send:
     rank  4: 0.93
     rank  5: 1.19
     rank  6: 1.24
     rank  7: 1.30
     rank  8: 3.10
     rank  9: 3.15
     rank 10: 4.14
     rank 11: 4.35
     rank 12: 1.67
     rank 13: 1.61
     rank 14: 2.24
     rank 15: 2.06
  forward-send-backward-recv:
     rank  0: 1009.92
     rank  1: 1071.83
     rank  2: 1043.97
     rank  3: 1023.80
     rank  4: 141.18
     rank  5: 143.97
     rank  6: 134.05
     rank  7: 140.52
     rank  8: 39.41
     rank  9: 41.24
     rank 10: 36.94
     rank 11: 37.70
  backward-send-forward-recv:
     rank  4: 4.31
     rank  5: 5.14
     rank  6: 4.03
     rank  7: 3.82
     rank  8: 122.53
     rank  9: 192.14
     rank 10: 157.97
     rank 11: 127.61
     rank 12: 494.65
     rank 13: 692.54
     rank 14: 589.65
     rank 15: 571.15
  layernorm-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.02
     rank  4: 0.02
     rank  5: 0.02
     rank  6: 0.02
     rank  7: 0.02
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.03
     rank 14: 0.02
     rank 15: 0.03
  embedding-grads-all-reduce:
     rank  0: 0.02
     rank  1: 0.03
     rank  2: 0.02
     rank  3: 0.03
     rank  4: 0.05
     rank  5: 0.07
     rank  6: 0.05
     rank  7: 0.05
     rank  8: 0.02
     rank  9: 0.03
     rank 10: 0.02
     rank 11: 0.02
     rank 12: 0.10
     rank 13: 0.07
     rank 14: 0.06
     rank 15: 0.07
  all-grads-sync:
     rank  0: 180.29
     rank  1: 180.20
     rank  2: 180.25
     rank  3: 180.21
     rank  4: 212.30
     rank  5: 212.37
     rank  6: 211.75
     rank  7: 213.08
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.04
     rank 13: 0.02
     rank 14: 0.02
     rank 15: 0.02
  optimizer-copy-to-main-grad:
     rank  0: 0.09
     rank  1: 0.10
     rank  2: 0.09
     rank  3: 0.08
     rank  4: 0.11
     rank  5: 0.14
     rank  6: 0.10
     rank  7: 0.11
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.03
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.03
  optimizer-clip-main-grad:
     rank  0: 0.01
     rank  1: 0.02
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.02
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.02
     rank  9: 0.02
     rank 10: 0.01
     rank 11: 0.02
     rank 12: 0.02
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.02
  optimizer-count-zeros:
     rank  0: 0.01
     rank  1: 0.01
     rank  2: 0.01
     rank  3: 0.01
     rank  4: 0.01
     rank  5: 0.01
     rank  6: 0.01
     rank  7: 0.01
     rank  8: 0.01
     rank  9: 0.01
     rank 10: 0.01
     rank 11: 0.01
     rank 12: 0.01
     rank 13: 0.01
     rank 14: 0.01
     rank 15: 0.01
  optimizer-inner-step:
     rank  0: 22.10
     rank  1: 22.31
     rank  2: 22.17
     rank  3: 22.15
     rank  4: 26.08
     rank  5: 26.37
     rank  6: 26.12
     rank  7: 26.17
     rank  8: 0.04
     rank  9: 0.09
     rank 10: 0.03
     rank 11: 0.04
     rank 12: 0.10
     rank 13: 0.04
     rank 14: 0.04
     rank 15: 0.08
  optimizer:
     rank  0: 22.94
     rank  1: 23.15
     rank  2: 23.01
     rank  3: 23.00
     rank  4: 27.00
     rank  5: 27.22
     rank  6: 26.97
     rank  7: 27.01
     rank  8: 0.89
     rank  9: 0.93
     rank 10: 0.87
     rank 11: 0.88
     rank 12: 0.95
     rank 13: 0.88
     rank 14: 0.88
     rank 15: 0.92
