Before all-reduce on rank 3: tensor([[-2.2138, -4.2976,  5.4670,  ..., -6.8247, -9.5866,  1.7875],
        [-1.0112,  8.2094,  3.5756,  ..., -0.7539, -6.2469, -5.1547],
        [-0.8574,  3.2211, -2.5168,  ..., -5.1651, -5.4600,  2.1375],
        ...,
        [ 2.6089, -0.2700,  1.4950,  ...,  3.8094,  2.3032, -2.8356],
        [-4.1469, -3.1627,  3.4867,  ..., -3.8240,  5.9529, -1.0807],
        [-3.2325,  0.6283,  0.4990,  ..., -0.9132,  1.6546,  3.8834]],
       device='cuda:3')
After all-reduce on rank 3: tensor([[  2.4760,   1.3885,  10.4373,  ..., -10.6131,  -5.3420,   4.6090],
        [ -0.3660,   6.3207,   4.9183,  ...,  -0.9904,  -4.8249,  -8.7286],
        [ -7.5088,  -0.1143,  -0.8848,  ...,  -5.6819,  -3.1186,  -0.8103],
        ...,
        [  2.8935,  -0.3010,  -1.6937,  ...,   5.6289,  -1.4182,  -0.8599],
        [  1.2527,  -5.4348,   5.1628,  ...,  -3.7847,   2.4740,  -1.8010],
        [ -4.1511,   3.7611,   6.0098,  ...,   1.3599,   1.5982,   2.8786]],
       device='cuda:3')
Before all-reduce on rank 2: tensor([[ 5.2076,  3.7958,  6.5358,  ..., -2.9528,  2.0613, -0.0473],
        [-0.4600, -0.2448,  1.4888,  ...,  1.9470, -0.1916, -3.3376],
        [-5.6288, -2.0268,  1.3019,  ..., -0.7327,  2.7362, -1.8712],
        ...,
        [ 0.1816, -1.2759, -1.8293,  ...,  0.9572, -0.0915,  3.8479],
        [ 1.6799, -2.3084,  2.8621,  ..., -2.9743, -1.4525,  1.3417],
        [ 1.9283,  2.8642,  4.4689,  ...,  1.6561,  2.4761,  1.5990]],
       device='cuda:2')
After all-reduce on rank 2: tensor([[  2.4760,   1.3885,  10.4373,  ..., -10.6131,  -5.3420,   4.6090],
        [ -0.3660,   6.3207,   4.9183,  ...,  -0.9904,  -4.8249,  -8.7286],
        [ -7.5088,  -0.1143,  -0.8848,  ...,  -5.6819,  -3.1186,  -0.8103],
        ...,
        [  2.8935,  -0.3010,  -1.6937,  ...,   5.6289,  -1.4182,  -0.8599],
        [  1.2527,  -5.4348,   5.1628,  ...,  -3.7847,   2.4740,  -1.8010],
        [ -4.1511,   3.7611,   6.0098,  ...,   1.3599,   1.5982,   2.8786]],
       device='cuda:2')
Before all-reduce on rank 0: tensor([[ 0.0260,  1.2361,  0.4774,  ..., -0.8856, -0.1685, -1.4499],
        [-0.2195, -0.9030,  1.3898,  ..., -0.0962, -1.2809, -0.7558],
        [ 0.7459, -0.1109,  1.7892,  ...,  1.7219, -0.8646, -1.1925],
        ...,
        [-0.4949,  0.4677,  0.4195,  ..., -0.8452, -1.5325,  0.1751],
        [ 0.0035, -0.7905, -0.5836,  ...,  1.8657, -0.6802, -1.1954],
        [-0.9852, -1.2249, -0.3529,  ...,  1.1319, -2.5112, -0.2709]],
       device='cuda:0')
After all-reduce on rank 0: tensor([[  2.4760,   1.3885,  10.4373,  ..., -10.6131,  -5.3420,   4.6090],
        [ -0.3660,   6.3207,   4.9183,  ...,  -0.9904,  -4.8249,  -8.7286],
        [ -7.5088,  -0.1143,  -0.8848,  ...,  -5.6819,  -3.1186,  -0.8103],
        ...,
        [  2.8935,  -0.3010,  -1.6937,  ...,   5.6289,  -1.4182,  -0.8599],
        [  1.2527,  -5.4348,   5.1628,  ...,  -3.7847,   2.4740,  -1.8010],
        [ -4.1511,   3.7611,   6.0098,  ...,   1.3599,   1.5982,   2.8786]],
       device='cuda:0')
Before all-reduce on rank 1: tensor([[-0.5438,  0.6542, -2.0428,  ...,  0.0500,  2.3519,  4.3187],
        [ 1.3246, -0.7409, -1.5358,  ..., -2.0873,  2.8945,  0.5195],
        [-1.7685, -1.1977, -1.4591,  ..., -1.5060,  0.4698,  0.1158],
        ...,
        [ 0.5979,  0.7772, -1.7789,  ...,  1.7074, -2.0974, -2.0473],
        [ 3.7161,  0.8268, -0.6024,  ...,  1.1480, -1.3462, -0.8665],
        [-1.8618,  1.4936,  1.3948,  ..., -0.5149, -0.0213, -2.3329]],
       device='cuda:1')
After all-reduce on rank 1: tensor([[  2.4760,   1.3885,  10.4373,  ..., -10.6131,  -5.3420,   4.6090],
        [ -0.3660,   6.3207,   4.9183,  ...,  -0.9904,  -4.8249,  -8.7286],
        [ -7.5088,  -0.1143,  -0.8848,  ...,  -5.6819,  -3.1186,  -0.8103],
        ...,
        [  2.8935,  -0.3010,  -1.6937,  ...,   5.6289,  -1.4182,  -0.8599],
        [  1.2527,  -5.4348,   5.1628,  ...,  -3.7847,   2.4740,  -1.8010],
        [ -4.1511,   3.7611,   6.0098,  ...,   1.3599,   1.5982,   2.8786]],
       device='cuda:1')
